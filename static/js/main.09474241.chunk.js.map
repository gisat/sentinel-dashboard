{"version":3,"sources":["components/WorldWindMap/utils/KML.worker.js","components/WorldWindMap/utils/togeojson.js","worldwind/www-overrides/SurfaceShape.js","worldwind/www-overrides/DrawContext.js","worldwind/framebuffer/FramebufferTexture.js","worldwind/framebuffer/Framebuffer.js","worldwind/www-overrides/SurfaceShapeTileBuilder.js","worldwind/www-overrides/SurfaceShapeTile.js","worldwind/www-overrides/TiledImageLayer.js","context/types.js","context/selectors/_common.js","context/selectors/data/satellites.js","context/selectors/map/index.js","context/selectors/data/layers.js","context/selectors/data/acquisitionPlans.js","context/selectors/data/orbits.js","context/selectors/components/search.js","utils/acquisitionPlans.js","utils/swath.js","utils/satellites.js","context/satData.js","context/selectors/rootSelectors.js","context/selectors/components/satellitesSelect.js","utils/date.js","context/selectors/components/timeline.js","context/selectors/components/timeWidget.js","context/selectors/components/searchToolbar.js","context/selectors/components/navigatorBackup.js","context/selectors/index.js","utils/arrayManipulation.js","utils/objectManipulation.js","context/reducer.js","utils/period.js","context/context.js","context/actions/map/index.js","utils/tle.js","context/actions.js","components/atoms/Icon/components/AngleDoubleDown.js","components/atoms/Icon/components/AngleDoubleLeft.js","components/atoms/Icon/components/AngleDoubleRight.js","components/atoms/Icon/components/AngleDoubleUp.js","components/atoms/Icon/components/ArrowLeft.js","components/atoms/Icon/components/Circle.js","components/atoms/Icon/components/ChevronLeft.js","components/atoms/Icon/components/ChevronRight.js","components/atoms/Icon/components/Delete.js","components/atoms/Icon/components/Dots.js","components/atoms/Icon/components/Download.js","components/atoms/Icon/components/Edit.js","components/atoms/Icon/components/Expand.js","components/atoms/Icon/components/ExpandRow.js","components/atoms/Icon/components/Filter.js","components/atoms/Icon/components/Info.js","components/atoms/Icon/components/Opacity.js","components/atoms/Icon/components/Layers.js","components/atoms/Icon/components/Legend.js","components/atoms/Icon/components/MapPin.js","components/atoms/Icon/components/Minus.js","components/atoms/Icon/components/MinusThick.js","components/atoms/Icon/components/NorthArrow.js","components/atoms/Icon/components/Plus.js","components/atoms/Icon/components/PlusThick.js","components/atoms/Icon/components/Pushpin.js","components/atoms/Icon/components/Restore.js","components/atoms/Icon/components/RotateLeft.js","components/atoms/Icon/components/RotateRight.js","components/atoms/Icon/components/Search.js","components/atoms/Icon/components/Share.js","components/atoms/Icon/components/TiltMore.js","components/atoms/Icon/components/TiltLess.js","components/atoms/Icon/components/Times.js","components/atoms/Icon/components/TriangleDown.js","components/atoms/Icon/components/Upload.js","components/atoms/Icon/components/Loader-oval.js","components/atoms/Icon/components/Location.js","components/atoms/Icon/components/Warning.js","components/atoms/Icon/components/Clock.js","components/atoms/Icon/components/satellites/Sentinel1.js","components/atoms/Icon/components/satellites/Sentinel2.js","components/atoms/Icon/components/satellites/Sentinel3.js","components/atoms/Icon/components/satellites/Sentinel4.js","components/atoms/Icon/components/satellites/Sentinel5.js","components/atoms/Icon/index.js","components/Modal/index.js","components/form/FormGroup.js","components/form/Form.js","components/atoms/Button/index.js","utils/product.js","components/productInformation/presentation.js","worldwind/collada/ColladaScene.js","worldwind/Model.js","components/WorldWindMap/SatelliteModelLayer.js","components/WorldWindMap/utils/Orbit.js","components/WorldWindMap/OrbitLayer.js","components/WorldWindMap/SentinelCloudlessLayer.js","components/WorldWindMap/SentinelTopologyLayer.js","components/WorldWindMap/utils/AcquisitionPlansParser.js","worldwind/textured/libtess.js","worldwind/textured/ScreenColorProgram.js","worldwind/textured/ScreenTextureProgram.js","worldwind/textured/TexturedSurfaceShape.js","worldwind/textured/TexturedSurfacePolygon.js","components/WorldWindMap/AcquisitionPlanLayer.js","components/WorldWindMap/Statistics/Distribution.js","components/WorldWindMap/Statistics/Extruded.js","components/WorldWindMap/Statistics/config.js","components/WorldWindMap/Statistics/Products.js","worldwind/layer/heatmap/HeatMapTile.js","worldwind/layer/heatmap/HeatMapColoredTile.js","worldwind/layer/heatmap/HeatMapLayer.js","components/WorldWindMap/Statistics/StatisticsLayer.js","components/WorldWindMap/MultiRangeLayer.js","components/WorldWindMap/utils/SciHubServices.js","components/WorldWindMap/FootPrintWMSWrapperLayer.js","components/WorldWindMap/FootPrintLayer.js","components/WorldWindMap/utils/eo/satellite.js","components/WorldWindMap/utils/eo/utils.js","components/WorldWindMap/SwathLayer.js","components/WorldWindMap/satellitesModels.js","worldwind/products/QuickLook.js","worldwind/products/WKTParser.js","worldwind/products/SciHubJSONParser.js","worldwind/products/Product.js","worldwind/products/Query.js","worldwind/products/Products.js","config.js","components/WorldWindMap/layers.js","components/productInformation/index.js","context/withContext.js","components/ProductsModal/presentation.js","components/ProductsModal/index.js","components/atoms/Select/Key.js","utils/utils.js","components/atoms/Select/Select.js","components/SearchModal/components/searchForm/presentation.js","context/actions/components/searchForm/actions.js","components/SearchModal/components/searchForm/index.js","components/SearchModal/components/result/presentation.js","components/SearchModal/components/result/index.js","components/SearchModal/presentation.js","components/SearchModal/index.js","worldwind/WorldWindow.js","components/WorldWindMap/utils/ClickPickController.js","components/WorldWindMap/controllers/WorldWindowControllerDecorator/index.js","components/WorldWindMap/navigator/helpers.js","worldwind/FixedPointController.js","worldwind/EnabledController.js","worldwind/FreeCamera.js","worldwind/Animator.js","components/WorldWindMap/presentation.js","context/actions/components/searchToolbar/index.js","components/WorldWindMap/index.js","context/actions/data/satellites/actions.js","components/SatelliteSelect/SatelliteGroupOption.js","components/SatelliteSelect/Loader.js","components/NotificationBadge/index.js","components/SatelliteSelect/LayerOption.js","components/SatelliteSelect/AcquisitionPlanOption.js","components/SatelliteSelect/StatisticsOption.js","components/SatelliteSelect/OptionFactory.js","components/SatelliteSelect/SatelliteGroupHeading.js","components/SatelliteSelect/presentation.js","components/SatelliteSelect/index.js","components/HoverHandler/context.js","components/TimeLine/TimeLineHover.js","components/HoverHandler/position.js","components/HoverHandler/Popup/Popup.js","components/HoverHandler/HoverHandler.js","components/TimeLine/centerPicker/index.js","components/TimeLine/mouse/index.js","components/TimeLine/utils/interval.js","components/TimeLine/overlay/index.js","components/TimeLine/periodLimit/index.js","components/TimeLine/utils/textLabel.js","components/TimeLine/utils/dash.js","components/TimeLine/years/YearDash.js","components/TimeLine/months/MonthDash.js","components/TimeLine/years/index.js","components/TimeLine/months/index.js","components/TimeLine/hours/HourDash.js","components/TimeLine/days/DayDash.js","components/TimeLine/days/index.js","components/TimeLine/minutes/MinuteDash.js","components/TimeLine/hours/index.js","components/TimeLine/minutes/index.js","components/TimeLine/context.js","components/TimeLine/TimelineEventsWrapper.js","components/TimeLine/timelineContent.js","components/TimeLine/index.js","components/MapsTimeline/presentation.js","components/MapsTimeline/index.js","components/TimeWidget/presentation.js","components/TimeWidget/index.js","components/SearchToolbar/presentation.js","utils/hooks/usePrevious.js","components/SearchToolbar/index.js","App.js","serviceWorker.js","index.js","utils/events.js"],"names":["module","exports","Worker","__webpack_public_path__","toGeoJSON","serializer","removeSpace","trimSpace","splitSpace","okhash","x","length","i","h","charCodeAt","get","y","getElementsByTagName","attr","getAttribute","attrf","parseFloat","get1","n","numarray","j","o","nodeVal","el","normalize","textContent","coord1","v","replace","split","coord","coords","push","coordPair","e","ll","ele","heartRate","time","isNaN","coordinates","xml2str","str","undefined","xml","serializeToString","XMLSerializer","process","browser","kml","doc","gj","type","features","styleIndex","geotypes","placemarks","styles","styleMaps","k","st","l","toString","concat","getPlacemark","kmlColor","color","opacity","substr","parseInt","gxCoords","root","elems","times","timeElems","geomsAndTimes","getGeometry","geomNode","geomNodes","geoms","coordTimes","gasit","rings","outerArr","track","properties","name","styleUrl","description","timeSpan","extendedData","lineStyle","polyStyle","a","node","lTextContent","querySelector","lColor","pTextCOntent","polySyle","pColor","lineColor","polyColor","parseStyle","begin","end","timespan","linestyles","width","stroke","polystyles","pcolor","popacity","fill","outline","datas","simpleDatas","feature","geometry","geometries","id","gpx","tracks","routes","waypoints","getTrack","getRoute","getPoint","getPoints","pointname","pts","line","heartRates","c","segments","getProperties","prop","sym","meta","clean","AbstractError","WorldWind","Angle","Location","Logger","NotYetImplementedError","PickedObject","PolygonSplitter","Renderable","Sector","ShapeAttributes","Vec3","MemoryCache","BoundingBox","SurfaceShape","attributes","call","this","_displayName","_attributes","_highlightAttributes","_highlighted","_enabled","_pathType","GREAT_CIRCLE","_maximumNumEdgeIntervals","DEFAULT_NUM_EDGE_INTERVALS","_polarThrottle","DEFAULT_POLAR_THROTTLE","_sector","pickDelegate","_sectors","_locations","_boundaries","_interiorGeometry","_outlineGeometry","_isInteriorInhibited","stateKeyInvalid","_attributesStateKey","boundariesArePrepared","layer","pickColor","contours","containsPole","crossesAntiMeridian","expirationInterval","shapeDataCache","currentData","prototype","Object","create","defineProperties","stateKey","currentAttributesStateKey","_stateKey","computeStateKey","displayName","set","value","highlightAttributes","highlighted","enabled","pathType","resetBoundaries","maximumNumEdgeIntervals","polarThrottle","sector","staticStateKey","shape","minLatitude","maxLatitude","minLongitude","maxLongitude","area","globe","terrainConformant","logMessage","LEVEL_SEVERE","computeBoundaries","intersectsFrustum","dc","extent","pickingMode","pickFrustum","frustumInModelCoordinates","isShapeDataCurrent","shapeData","verticalExaggeration","expiryTime","Date","now","createShapeDataObject","resetExpiration","Math","random","establishCurrentData","entryForKey","globeStateKey","putEntry","isExpired","render","currentLayer","prepareBoundaries","computeExtent","surfaceShapeTileBuilder","insertSurfaceShape","interpolateLocations","locations","prev","idx","len","first","next","isNextFirst","isPrevFirst","countFirst","isInterpolated","latitude","longitude","interpolateEdge","start","dt","location","distanceRadians","greatCircleDistance","steps","round","PI","t","throttledStep","interpolateAlongPath","cosLat","cos","DEGREES_TO_RADIANS","weight","newBoundaries","formatBoundaries","normalizeAngles","interpolateBoundaries","contoursInfo","doesCross","splitContours","prepareGeometry","prepareSectors","clear","boundaries","polygon","lenP","point","normalizedDegreesLongitude","normalizedDegreesLatitude","contour","slice","computeSectors","boxPoints","computeBoundingPoints","setToVec3Points","boxCorners","box","corners","getCorners","computeShiftedLocations","oldLocation","newLocation","newLocations","result","newPos","Position","oldPoint","computePointFromLocation","newPoint","is2D","delta","subtract","add","computePositionFromPoint","delta_lat","delta_long","max","min","new_lat","new_long","determineSectors","sectorsOverAntiMeridian","sectorsNotOverAntiMeridian","polygons","sectors","setToBoundingSector","extremes","greatCircleArcExtremeLocations","eastSector","westSector","lenS","union","interiorPolygons","outlinePolygons","poleIndex","lenC","iMap","pole","poles","NONE","outlineForPole","outlineForSplit","outlinePolygon","pCount","intersection","forPole","iCount","resetPickColor","renderToTexture","ctx2D","xScale","yScale","dx","dy","drawInterior","drawOutline","outlineWidth","uniquePickColor","toHexString","draw","fillStyle","interiorColor","toRGBAString","lineWidth","strokeStyle","outlineColor","po","clone","resolvePick","beginPath","moveTo","lineTo","DrawContext","pickableObject","userObject","deepPicking","regionPicking","addPickedObject","readPickColor","pickPoint","equals","FramebufferTexture","textureId","height","imageWidth","imageHeight","size","originalImageWidth","originalImageHeight","creationTime","currentGlContext","bindTexture","TEXTURE_2D","frameStatistics","incrementTextureLoadCount","gl","deleteTexture","Framebuffer","framebufferId","texture","createTexture","framebufferTexture2D","FRAMEBUFFER","COLOR_ATTACHMENT0","createFramebuffer","bindFramebuffer","viewport","clearColor","COLOR_BUFFER_BIT","fbo","canvas","console","log","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","ArgumentError","SurfaceShapeTileBuilder","buildTiles","surfaceShapes","assembleTiles","__fboBound__","getFbo","unbind","currentFramebuffer","splice","surfaceShapeTiles","clearShapes","addTile","tile","pickSequence","needsUpdate","bind","tileWidth","tileHeight","updateTexture","doRender","savedTiles","savedTopLevelTiles","topLevelTiles","doDeepPickingRender","surfaceTileRenderer","renderTiles","idxTile","lenTiles","idxShape","lenShapes","idxPick","lenPicks","deepPickShapes","objectsAtPickPoint","objects","indexOf","resolvablePickObjects","setShapes","gpuResourceCache","resourceForKey","putResource","__frameStart__","SurfaceShapeTile","deltaLongitude","deltaLatitude","xOffset","yOffset","asRenderedSurfaceShapeStateKeys","attachTexture","surfaceShapeStateKeys","gpuCacheKey","getCacheKey","TiledImageLayer","retrieveTileImage","suppressRedraw","pendingRequests","MAX_REQUESTS","currentRetrievals","imagePath","some","absentResourceList","isResourceAbsent","resourceUrlForTile","retrievalImageFormat","shift","fetchMoreImages","currentTilesInvalid","before","filter","pendingTile","isTileVisible","url","cache","fetchImage","err","image","removeFromCurrentRetrievals","markResourceAbsent","unmarkResourceAbsent","document","createEvent","initEvent","REDRAW_EVENT_TYPE","window","dispatchEvent","cb","Image","onload","onerror","Error","crossOrigin","webkit","AndroidApp","src","doRender_","terrain","lasTtMVP","navigatorState","modelviewProjection","lastGlobeStateKey","currentTiles","surfaceOpacity","incrementImageTileCount","inCurrentFrame","cleanCache","getSubstate","createSelector","state","substate","getByPath","path","getByKey","key","common","getSatelliteByKey","satKey","find","s","getVisibleAcquisitionsPlans","acquisitionPlans","getVisibleStatistics","statistics","map","getLoadingStatistics","loading","isVisibleAcquisitionPlanByKey","acquisitionsPlans","includes","isVisibleStatisticsByKey","getView","createCachedSelector","view","validHeadingCorrection","hasOwnProperty","headingCorrection","validHeading","heading","center","lon","lat","altitude","boxRange","roll","tilt","getViewKey","getPureView","getPlansForDate","date","dateString","moment","format","getDateString","satAps","plans","aps","startDate","endDate","apsForTime","getLoadingAcquisitionsPlans","reduce","acc","loadingPlans","plan","getActiveResultIndex","getResults","getFilterTime","getSearchLayer","activeResultIndex","results","Number","isInteger","getSatAPSUrl","getSatIntervalAPSUrl","toUpperCase","satellites","Map","getPlansKeys","getPlanKey","join","parseAPSfiles","kmlName","satName","getAcquisitionPlans","has","then","request","fetch","response","text","getAllAcquisitionPlans","Promise","all","Color","satellitesSwathColors","s1a","IW","EW","SM","WV","RFC","s1b","s2a","NOBS","VIC","s2b","DARK","s3a","s3b","isSatelliteReleaseBeforeDate","satellite","satData","launchDate","getTime","orbit","activeSatelliteKey","shortName","satIndex","swathTypes","swathColors","colorFromKmlHex","swatModes","tleLineOne","tleLineTwo","hasModel","filePath","fileName","rotations","z","headingAxis","headingAdd","headingMultiply","preRotations","scale","translations","ignoreLocalTransforms","groundPosition","getSatDataByKey","getDefaultSatOrbitBySatKey","sat","specs","getSelectTimePastOrCurrent","getCurrentTime","currentTime","getPreventReloadLayers","getActiveInfoModalKey","getInfoModal","infoModalKey","getSelectTime","selectTime","getBeginDataTime","momentjs","toDate","getPureActiveLayers","activeLayers","layerKey","getFollowNow","getTrackTimeActive","getPeriodLimit","getLandscape","getFocusedSatellite","getBeginTime","productsTimeWindow","getSatelliteForLayer","satellitesSubstate","getOrbitForLayer","orbitsSubstate","orbitKey","getActiveSatProductsPairs","mergedBySatellite","entries","getActiveLayers","getOrbitsSubstate","getSatellitesSubstate","selectTimePastOrCurrent","visibleAcquisitionsPlans","visibleStatistics","focusedSatellite","searchLayer","activeSentinelLayers","forEach","beginTime","endTime","disabled","satellitesUtils","searchLayers","orbitLayers","satellitesLayers","model","tle","acquisitionPlanLayers","p","range","acquisitionPlanTimeWindow","swathLayers","acqPlanLayerConfig","apsKey","apsIDKey","sentinelLayer","totalCount","sentinelLayerKey","statisticsLayers","sensornames","statisticsKey","stringSelectTime","orbitSubstate","orbitKeys","satellitesKeys","activeLayersKeys","cacheKey","getActiveLayerByKey","getVisible","visible","getSatelitesSelectOptions","getLayersSubstate","layersSubState","acquisitionPlansData","loadingAcquisitionsPlans","loadingStatistics","satConfig","hasAPS","hasStatistics","activeAPS","activeStatistics","satOption","groupData","icon","iconClass","active","label","options","loadedCount","visiblePlans","layers","getLayerByKey","activeLayerCfg","status","message","getLayerOption","convertToUTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getNowUTCString","toUTCString","addItemToIndex","array","index","item","removeItemByIndex","getActiveTimeLevel","activeTimeLevel","getOverlays","overlays","overlayIndex","findIndex","nowOverlay","nowOverlayPlusSecond","withoutOverlay","backdroundColor","getOrderedResults","getLoading","getLastResultIndex","orderedResults","getActiveResult","getResultByIndex","rootSelectors","data","orbits","components","satelliteSelect","timeline","timeWidget","search","searchToolbar","navigatorBackup","replaceItemOnIndex","removeItemByKey","object","deactivateLayer","WorldWindX","EoUtils","action","payload","select","activeIndex","activateLayer","setHelper","remainingPath","currentKey","updateInfoModal","modalKey","modalState","infoModalState","modalPath","modal","updateModal","updateMapView","types","focus","focusSatelite","toggleLayer","preventReloadLayers","setPreventReloadLayers","followNow","selectTimeMoment","isAfter","setSelectTime","setCurrentTime","setActiveTimeLevel","setFollowNow","trackTime","setTrackTime","landscape","setLandscape","UPDATE","component","update","updateComponent","SET","setComponent","CLEAR","clearComponent","change","layerIndex","changed","layerInfo","updateActiveLayer","infoModal","setActiveInfoModal","setOrbits","setAcquisitionPlans","acquisitionPlansKeyIndex","acquisitionPlanUrlIndex","acquisitionPlan","updatedAcquisitionPlan","merge","cloneDeep","updatedAcquisitionPlans","dataUpdateAcquisitionPlan","count","setVisibleAcquisitionPlan","SATELLITES","SET_HEADING","satelliteIndex","setSatelliteHeading","SET_HEADING_AND_UPDATE_VIEW_HEADING_CORRECTION","setSatelliteHeadingAndUpdateViewHeadingCorrection","UPDATE_VIEW_HEADING_CORRECTION_FROM_FOCUSED_SATELLITE","updateViewHeadingCorrectionFromFocusedSatellite","acquisitionPlanKey","mapAddVisibleAcquisitionPlan","acquisitionPlanKeyIndex","mapRemoveVisibleAcquisitionPlan","ADD_STATISTICS_LAYER","mapAddVisibleStatisticsLayer","REMOVE_STATISTICS_LAYER","keyIndex","statistic","mapRemoveVisibleStatisticsLayer","UPDATE_STATISTICS","updatedStatistic","updatedStatistics","mapUpdateStatisticsLayer","SET_VIEW","setMapView","UPDATE_VIEW","SEARCH_TOOLBAR","initialState","componentsSearchToolbarClear","parseOne","string","match","endOf","source","parse","dates","periodLimit","period","stringPeriodLimit","Context","createContext","viewFocused","open","moving","mouseTime","dayWidth","classes","top","activeOrderedResultIndex","mapView","getUrl","SENTINELTLENAMES","SENTINELTLEKEYSPAIRS","parseSatellitesData","lines","trim","line1","line2","transformTleFormat","getTle","WordWindX","DEFAULT_NAVIGATOR","lookAtLocation","intervalKeyZoom","intervalKeyScroll","focusSatellite","satelliteId","setNavigatorFromOrbit","orbitInfo","prevMapView","respectHeading","respectRoll","respectTilt","satrec","computeSatrec","position","getOrbitPosition","navigator","updateNavigator","prevNavigator","updatedNavigator","setNavigator","setViewFromNavigator","scrollToTime","dispatch","newTime","callback","clearInterval","timeInPeriod","isBefore","getInside","peace","diff","setInterval","newSelectedTime","selectedTime","changeSelectTime","selectYearDay","year","dayOfYear","momentTime","updateTleData","viewFixed","isReleased","setView","nowTick","stopTimer","stopFollowNow","nowTimeMoment","updateApsData","props","className","d","points","strokeWidth","strokeLinejoin","strokeLinecap","cx","cy","r","transform","fillRule","strokeOpacity","attributeName","from","to","dur","repeatCount","fontFamily","fontSize","letterSpacing","wordSpacing","style","fontFeatureSettings","fontVariantCaps","fontVariantLigatures","fontVariantNumeric","lineHeight","version","xmlns","xmlnsXlink","viewBox","xmlSpace","AngleDoubleRight","AngleDoubleLeft","AngleDoubleUp","AngleDoubleDown","ArrowLeft","Circle","ChevronLeft","ChevronRight","Delete","Dots","Download","Edit","Expand","ExpandRow","Filter","Info","Legend","MapPin","Minus","MinusThick","NorthArrow","Opacity","Plus","PlusThick","Pushpin","Restore","RotateLeft","RotateRight","Search","Share","TiltLess","TiltMore","Times","TriangleDown","Warning","Upload","Sentinel1","Sentinel2","Sentinel3","Sentinel4","Sentinel5","Clock","strokeMiterlimit","x1","y1","x2","y2","ReactModal","setAppElement","innerContentStyle","css","closeStyle","display","flexFlow","cursor","right","closeIconStyle","headerStyle","borderBottom","visibleOverlayStyle","backgroundColor","zIndex","hiddenOverlayStyle","contentStyle","border","overflow","isOpen","content","onClose","header","sided","displayOverlay","sidedStyle","bottom","left","getSidedStyle","contentLabel","overlay","onClick","Icon","title","readOnly","classnames","htmlFor","children","Button","focused","menuOpen","onBlur","onKeyPress","setState","charCode","iconInsert","hasContent","React","Children","child","Fragment","isValidElement","cloneElement","classNames","circular","ghost","invisible","inverted","large","primary","secondary","side","small","tabIndex","unfocusable","PureComponent","defaultProps","productBounds","Polygon","addBoundariesAltitude","bs","Array","isArray","altitudeMode","ABSOLUTE","extrude","polygonAttributes","BLUE","drawVerticals","applyLighting","getBoundaries","product","Heading","isOnline","DownloadIcon","getDownloadIcon","link","rel","href","getProductDownloadUrl","getDataList","FormGroup","ProductInformation","online","int","summary","dateList","intList","strList","summaryItem","titleItem","platformname","producttype","Form","BasicTextureProgram","Matrix","ColladaScene","sceneData","_position","_nodes","_meshes","_materials","_images","_upAxis","_dirPath","_xRotation","_yRotation","_zRotation","preX","preY","preZ","_xTranslation","_yTranslation","_zTranslation","_scale","_altitudeMode","_localTransforms","_useTexturePaths","_nodesToHide","_hideNodes","_placePoint","_transformationMatrix","fromIdentity","_mvpMatrix","_normalTransformMatrix","_normalMatrix","_texCoordMatrix","setToUnitYFlip","_entities","_activeTexture","_tmpVector","_tmpColor","_vboCacheKey","_iboCacheKey","setSceneData","constructor","nodes","meshes","materials","images","upAxis","dirPath","xRotation","yRotation","zRotation","xTranslation","yTranslation","zTranslation","placePoint","transformationMatrix","normalMatrix","localTransforms","useTexturePaths","nodesToHide","hideNodes","metadata","up_axis","flattenModel","nodesLen","flattenNode","sort","b","va","imageKey","vb","mesh","meshKey","buffers","bufLen","materialBuf","material","symbol","materialKey","textures","uvs","diffuse","mapId","reflective","orderedScene","frustum","lastFrameTime","timestamp","makeOrderedRenderable","containsPoint","addOrderedRenderable","surfacePointForMode","eyeDistance","eyePoint","distanceTo","renderOrdered","drawOrderedScene","beginDrawing","endDrawing","vboId","iboId","setupBuffers","bindBuffer","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","findAndBindProgram","enableVertexAttribArray","computeTransformationMatrix","mustRenderNode","sizeOfFloat32","Float32Array","BYTES_PER_ELEMENT","sizeOfUint16","Uint16Array","sizeOfUint32","Uint32Array","is32BitIndices","numIndices","numVertices","indexedRendering","indices","vertices","normals","vbo","createBuffer","bufferData","STATIC_DRAW","offset","vertexOffset","bufferSubData","uvOffset","normalOffset","uIntExt","indexSize","indexBufferSize","getExtension","ibo","indexOffset","generateCacheKey","entity","program","currentProgram","nodeWorldMatrix","worldMatrix","nodeNormalMatrix","hasLighting","applyColor","filename","textureCacheKey","wrapMode","isClamp","REPEAT","retrieveTexture","loadTextureEnabled","vertexAttribPointer","FLOAT","loadModulateColor","disableVertexAttribArray","loadApplyLighting","applyMatrix","indexOffsetBytes","drawElements","TRIANGLES","UNSIGNED_INT","UNSIGNED_SHORT","drawArrays","floor","techniqueType","g","depthMask","loadColor","loadOpacity","hasTexture","copy","multiplyMatrix","modelviewNormalTransform","loadModelviewInverse","loadTextureMatrix","loadModelviewProjection","setToIdentity","multiplyByLocalCoordinateTransform","multiplyByRotation","multiplyByScale","multiplyByTranslation","computeNormalMatrix","extractRotationAngles","nodeId","Model","_satellite","satelliteModel","_model","modelData","satShortName","jsonData","eVertices","eNormals","eUvs","eIndices","info","RenderableLayer","DEFAULT_MODEL_OPTIONS","SatelliteModelLayer","satelliteOptions","_satelliteOptions","_rerenderMap","Tle","onLayerChanged","removeAllRenderables","addRenderable","doRerender","setPosition","alignWithOrbit","currentPosition","nextPosition","headingRad","headingAngleRadians","rad2deg","angle","rerenderer","Path","Orbits","startTime","orbitPoints","_satrec","_orbitPoints","_trail","trail","trailAttributes","_currentEndTime","_previousEndTime","_currentStartTime","_previousStartTime","populate","satelliteRecord","preventPopulate","preventUpdate","force","previousStartTime","previousTime","changeStart","previousEndTime","changeEnd","timeWindow","tick","positionsToReplace","ceil","abs","positions","positionIndex","getOrbitPositionWithPositionalData","pop","numSubSegments","OrbitLayer","satRec","isFinite","_beforeCurrentOrbit","Orbit","_afterCurrentOrbit","setSatRec","setTime","removeRenderable","SentinelCloudlessLayer","host","service","layerNames","levelZeroDelta","numLevels","WmsLayer","SentinelTopologyLayer","AcquisitionPlansParser","workers","InteriorCtor","SurfacePolygon","OutlineCtor","ShapeAttributesCtor","PositionCtor","ColorCtor","domParser","shapeAttributesMap","fileInfo","filterDate","toISOString","parsedShapes","outlines","interiors","interval","shapes","parseSync","error","makeRenderables","formatOutput","kmlString","DOMParser","kmlDoc","parseFromString","isSentinel2","nowDate","isInTheFuture","Mode","Timeliness","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","makePositions","pathAttributes","makePathAttributes","outlineAlpha","followTerrain","setTimeInterval","kmlProps","interior","surfacePolygonAttributes","makeSurfacePolygonAttributes","interiorAlpha","surfacePolygon","makeSurfacePolygonHighlightAttributes","highlightAlpha","pos","hexColor","alpha","makeColor","blue","substring","green","red","renderable","dateStringToUTC","ObservationTimeStart","ObservationTimeStop","startTimeMs","endTimeMs","toLowerCase","libtess","condition","opt_message","DEBUG","GLU_TESS_WINDING_ODD","GLU_TESS_WINDING_NONZERO","GLU_TESS_WINDING_POSITIVE","GLU_TESS_WINDING_NEGATIVE","GLU_TESS_WINDING_ABS_GEQ_TWO","GL_LINE_LOOP","GL_TRIANGLES","GL_TRIANGLE_STRIP","GL_TRIANGLE_FAN","GLU_TESS_MISSING_BEGIN_POLYGON","GLU_TESS_MISSING_END_POLYGON","GLU_TESS_MISSING_BEGIN_CONTOUR","GLU_TESS_MISSING_END_CONTOUR","GLU_TESS_COORD_TOO_LARGE","GLU_TESS_NEED_COMBINE_CALLBACK","GLU_TESS_BEGIN","GLU_TESS_VERTEX","GLU_TESS_END","GLU_TESS_ERROR","GLU_TESS_EDGE_FLAG","GLU_TESS_COMBINE","GLU_TESS_BEGIN_DATA","GLU_TESS_VERTEX_DATA","GLU_TESS_END_DATA","GLU_TESS_ERROR_DATA","GLU_TESS_EDGE_FLAG_DATA","GLU_TESS_COMBINE_DATA","GLU_TESS_MESH","GLU_TESS_TOLERANCE","GLU_TESS_WINDING_RULE","GLU_TESS_BOUNDARY_ONLY","GLU_INVALID_ENUM","GLU_INVALID_VALUE","geom","vertEq","u","vertLeq","edgeEval","w","gapL","gapR","edgeSign","transLeq","transEval","transSign","edgeGoesLeft","dst","org","edgeGoesRight","vertL1dist","vertCCW","interpolate_","edgeIntersect","o1","d1","o2","d2","z1","z2","tmp","makeEdge","makeEdgePair_","eHead","makeVertex_","vHead","makeFace_","fHead","meshSplice","eOrg","eDst","joiningLoops","joiningVertices","killVertex_","lFace","killFace_","splice_","anEdge","deleteEdge","eDel","eDelSym","rFace","oNext","oPrev","killEdge_","addEdgeVertex","eNew","eNewSym","lNext","splitEdge","winding","connect","zapFace","fZap","eStart","eNext","eSym","fPrev","fNext","meshUnion","mesh1","mesh2","f1","v1","e1","f2","v2","e2","deleteMesh","GluHalfEdge","ePrev","aONext","bONext","eOrig","vNext","vPrev","vNew","GluVertex","fNew","GluFace","inside","vDel","newOrg","fDel","newLFace","normal","S_UNIT_X_","S_UNIT_Y_","projectPolygon","tess","computedNormal","norm","computeNormal_","sUnit","tUnit","longAxis_","TRUE_PROJECT","normalize_","dot_","checkOrientation_","sqrt","maxVal","GLU_TESS_MAX_COORD","minVal","maxVert","minVert","maxLen2","tNorm","tLen2","f","renderMesh","flagEdges","beginOrBeginDataCalled","edgeState","callBeginOrBeginData","primitiveType","newState","callEdgeFlagOrEdgeFlagData","callVertexOrVertexData","callEndOrEndData","renderBoundary","sweep","SENTINEL_COORD_","TOLERANCE_NONZERO_","computeInterior","fatalError","removeDegenerateEdges_","initPriorityQ_","initEdgeDict_","pq","extractMin","minimum","spliceMergeVertices_","sweepEvent_","minRegion","dict","getMin","getKey","event","eUp","doneEdgeDict_","donePriorityQ_","removeDegenerateFaces_","checkMesh","addWinding_","eSrc","edgeLeq_","reg1","reg2","deleteRegion_","reg","fixUpperEdge","activeRegion","deleteNode","nodeUp","fixUpperEdge_","newEdge","topLeftRegion_","regionAbove","regionBelow","topRightRegion_","addRegionBelow_","regAbove","eNewUp","regNew","ActiveRegion","insertBefore","isWindingInside_","windingRule","computeWinding_","windingNumber","finishRegion_","finishLeftRegions_","regFirst","regLast","regPrev","lPrev","addRightEdges_","regUp","eFirst","eLast","eTopLeft","cleanUp","firstTime","rPrev","dirty","checkForRightSplice_","walkDirtyRegions_","callCombine_","isect","weights","needed","callCombineOrCombineData","callErrorOrErrorData","errorType","vertexWeights_","weightIndex","t1","t2","i0","i1","getIntersectData_","orgUp","dstUp","orgLo","dstLo","regLo","eLo","remove","pqHandle","checkForLeftSplice_","checkForIntersect_","orgMin","insert","connectRightVertex_","eBottomLeft","degenerate","connectLeftDegenerate_","vEvent","eTopRight","connectLeftVertex_","dNext","addSentinel_","sentinel","Dict","eLNext","PriorityQ","init","deleteQ","tessmono","tessellateMonoRegion_","face","up","tempHalfEdge","lo","tessellateInterior","discardExterior","setWindingNumber","keepOnlyBoundary","frame","leq","head_","DictNode","frame_","leq_","deleteDict_","newNode","getMax","opt_key","opt_nextNode","opt_prevNode","getSuccessor","getPredecessor","CachedVertex","GluTesselator","tessState_","T_DORMANT","lastEdge_","callError_","relTolerance","GLU_TESS_DEFAULT_TOLERANCE","boundaryOnly","callBegin_","callEdgeFlag_","callVertex_","callEnd_","callMesh_","callBeginData_","callEdgeFlagData_","callVertexData_","callEndData_","callErrorData_","callCombineData_","polygonData_","emptyCache","cacheCount","TESS_MAX_CACHE","T_IN_POLYGON","T_IN_CONTOUR","gluDeleteTess","requireState_","gluTessProperty","which","gluEnum","gluGetTessProperty","gluTessNormal","gluTessCallback","opt_fn","fn","gluTessVertex","tooLarge","clamped","emptyCache_","cacheVertex_","addVertex_","gluTessBeginPolygon","gluTessBeginContour","gluTessEndContour","gluTessEndPolygon","makeDormant_","gotoState_","GluMesh","flag","interpData","errno","opt_nextFace","opt_prevFace","opt_nextEdge","dPrev","rNext","eHeadSym","opt_nextVertex","opt_prevVertex","PQHandleElem","realloc","oldArray","newArray","PQNode","handle","keys_","PQKeyRealloc_","INIT_SIZE_","order_","size_","max_","initialized_","heap_","PriorityQHeap","deleteHeap","keys","comparator","keyNew","curr","keyLessThan_","keyX","keyY","keyGreaterThan_","sortMin","isEmpty","heapMin","isEmpty_","nodes_","handles_","freeList_","floatDown_","free","floatUp_","hMin","hCurr","hChild","parent","hParent","ScreenColorProgram","resolutionLocation","uniformLocation","colorLocation","localCache","resolution","uniform2f","cacheColor","uniform4f","GpuProgram","ScreenTextureProgram","texUnitLocation","textureUnit","unit","uniform1i","TEXTURE0","Texture","TexturedSurfaceShape","_image","_imageUUID","_interiorVboCacheKey","_outlineVboCacheKey","_contoursPrepered","_contoursInfo","_id","nextId","_nextId","interiorGeometry","mapGeometry","wo","windingOrder_all","renderColor","anglesMap","topLeftIndex","computeUvs","tessGeom","tessellate_p1","tessIndices","px","py","iboData","vboData","renderTexture","tessellate","tessTris","loadResolution","RADIANS_TO_DEGREES","bindInteriorVbo","frontFace","CW","CCW","loadTextureUnit","imageTextureKey","imageTexture","bindInteriorIbo","valuesPerVertex","locations1","uv","nextSide","sideStart","sideEnd","jIndex","sideDistance","distance","vboUsage","bindVbo","vboEntry","vboSize","iboUsage","_interiorIboCacheKey","bindIbo","iboSize","tesselator","triangles","prim","newCoords","tris","vertex","bbox","minX","maxX","minY","maxY","angles","prevX","prevY","currentX","currentY","nextX","nextY","atan2","p0","p1","p2","p3","findWhichCorners","userProps","userProperties","identifier","cornerLocations","c0","c1","newCorners","corner","reindexCorners","isEqualPoints","getBbox","getSlope","list","sum","p1x","p1y","img","TexturedSurfacePolygon","removeDuplicateLocations","removeDuplicateLocationsFromContour","loc","loc2","isPrepared","Workers","AcquisitionPlans","numWorkers","getCoreCount","KMLWorker","parser","filterPlansByUrl","cachedPlans","cachedPlan","AcquisitionPlanLayer","Set","updateId","crypto","getRandomValues","filteredPlans","unloadedPlans","pHash","catch","delete","terminateWorkers","getFootprints","addRenderables","Distribution","_hexs","prepareClasses","palettes","palette","isHex","amountOfClasses","oneLevel","chroma","colors","hex","rgb","TriangleMesh","WWUtil","Extruded","guid","products","_data","createElement","ctx","getContext","globalAlpha","fillRect","transparentImage","imagery","aggregatedMissions","containsLocation","mission","amount","dataForDrawingPolygons","filterGeographically","missions","currentAltitude","extentSizeLatitude","extentSizeLongitude","normalizedAmount","shapeAttributes","center1","a1","b1","g1","h1","center2","a2","b2","c2","g2","h2","outlineIndices","assemblePolygonsForTile","Products","_url","config","_cache","month","LEVEL_INFO","resolve","prepareCache","self","ajax","responseType","models","parseProductsFromRemote","boxes","bbox2Lat","bbox1Lat","bbox2Lon","bbox1Lon","acquisitionMoment","reject","xhr","XMLHttpRequest","onreadystatechange","readyState","LEVEL_WARNING","statusText","ontimeout","send","HeatMapTile","_canvas","createCanvas","_width","_height","_radius","radius","_incrementPerIntensity","incrementPerIntensity","toDataURL","clearRect","measure","drawImage","longitudeInSector","latitudeInSector","r2","gradient","createRadialGradient","addColorStop","arc","closePath","sizeOfArea","locationInArea","HeatMapColoredTile","_extendedWidth","extendedWidth","_extendedHeight","extendedHeight","_gradient","intensityGradient","_opacity","colored","getImageData","colorize","putImageData","createLinearGradient","pixels","HeatMapIntervalType","MeasuredLocation","HeatMapLayer","measuredLocations","MIN_VALUE","measured","pow","amountAtTile","_measuredLocations","_intervalType","CONTINUOUS","_max","setGradient","intervalType","extraLongitudeBefore","extraLongitudeAfter","gatherGeographical","beforeSector","afterSector","adaptLongitude","element","QUANTILES","item1","item2","extended","calculateExtendedSector","extensionFactorWidth","extensionFactorHeight","createHeatMapTile","latitudeChange","longitudeChange","StatisticsLayer","_products","strMonthTime","getMonthTimeString","_missionScale","_instrumentsScale","_choropleth","_extruded","updateStrMonthTime","newStrMonthTime","momTime","paletteKey","selected","getPallete","redraw","distribution","startValue","endValue","dataToDownload","colorScale","spacecraftnames","chosenMonths","allPromises","dataset","chosenMonth","retrieve","legend","aggregateAndFilter","getChoropleth","showExtrudedPolygons","getExtruded","heatMap","MultiRangeLayer","intervals","layerOption","rangeInterval","getLayerByRange","wmsConfigOnda","coordinateSystem","FootPrintWMSWrapperLayer","renderables","timeRange","SciHubServices","getLayerFromRenderable","selectedTimeRange","minTime","maxTime","minSelectedTime","maxSelectedTime","FootPrint","solveTimeVisibility","pi","twoPi","deg2rad","xke","earthRadius","vkmpersec","tumin","j2","j3","j4","j3oj2","days2mdhms","days","lmonth","dayofyr","inttemp","mon","day","temp","hr","minute","sec","jdayInternal","msec","arguments","jday","getUTCMilliseconds","dpper","alfdp","betdp","cosip","sinip","cosop","sinop","f3","pe","pgh","ph","pinc","pl","sinzf","xls","xnoh","zf","zm","e3","ee2","peo","pgho","pho","pinco","plo","se2","se3","sgh2","sgh3","sgh4","sh2","sh3","si2","si3","sl2","sl3","sl4","xgh2","xgh3","xgh4","xh2","xh3","xi2","xi3","xl2","xl3","xl4","zmol","zmos","opsmode","ep","inclp","nodep","argpp","mp","sin","ses","sis","sls","sghs","shs","gstimeInternal","jdut1","tut1","gstime","apply","sgp4","tsince","coseo1","sineo1","cosisq","delomg","eo1","argpm","su","t3","t4","tc","tem5","tempa","tempe","templ","inclm","mm","nm","nodem","xincp","xlm","xmdf","mo","mdot","argpdf","argpo","argpdot","nodedf","nodeo","nodedot","nodecf","cc1","bstar","cc4","t2cof","isimp","omgcof","delmtemp","eta","xmcof","delmo","d3","d4","cc5","sinmao","t3cof","t4cof","t5cof","no","em","ecco","inclo","method","dspaceResult","delt","x2li","x2omi","xl","xldot","xnddt","xndt","xomi","irez","d2201","d2211","d3210","d3222","d4410","d4422","d5220","d5232","d5421","d5433","dedt","del1","del2","del3","didt","dmdt","dnodt","domdt","gsto","xfact","xlamo","atime","xli","xni","g22","g32","g44","g52","g54","dndt","ft","theta","iretn","dspace","am","dpperResult","operationmode","aycof","xlcof","axnl","aynl","ktr","ecose","esine","el2","rl","rdotl","rvdotl","betal","sinu","cosu","sin2u","cos2u","temp1","temp2","con41","x1mth2","x7thm1","mrt","velocity","xnode","xinc","mvt","rvdot","sinsu","cossu","snod","cnod","sini","cosi","xmx","xmy","ux","uy","uz","sgp4init","cosim","sinim","cc1sq","cc2","cc3","coef","coef1","cosio4","emsq","eeta","etasq","perige","pinvsq","psisq","qzms24","s1","s2","s3","s4","s5","sfour","ss1","ss2","ss3","ss4","ss5","sz1","sz3","sz11","sz13","sz21","sz23","sz31","sz33","temp3","tsi","xpidot","xhdot1","z3","z11","z13","z21","z23","z31","z33","satn","epoch","xbstar","xecco","xargpo","xinclo","xmo","xno","xnodeo","initlResult","eccsq","omeosq","rteosq","cosio","cosio2","ak","delPrime","adel","ao","sinio","con42","ainv","posq","rp","ts70","ds70","initl","qzms2ttemp","qzms24temp","delmotemp","dscomResult","a3","a4","a5","a6","a7","a8","a9","a10","cc","x3","x4","x5","x6","x7","x8","zcosg","zsing","zcosh","zsinh","zcosi","zsini","ss6","ss7","sz2","sz12","sz22","sz32","s6","s7","z12","z22","z32","np","snodm","cnodm","sinomm","cosomm","betasq","rtemsq","xnodce","stem","ctem","zcosil","zsinil","zsinhl","zcoshl","gam","zx","zy","zcosgl","zsingl","xnoi","lsflg","dscom","dsinitResult","f220","f330","g211","g310","g322","g410","g422","g520","g521","g532","g533","sini2","aonv","eoc","rptim","znl","zns","shll","emo","emsqo","dsinit","_toConsumableArray","arr","arr2","_arrayWithoutHoles","iter","Symbol","iterator","_iterableToArray","TypeError","_nonIterableSpread","radiansToDegrees","radians","degreesLat","RangeError","degreesLong","eciToGeodetic","eci","gmst","R","C","topocentric","observerGeodetic","satelliteEcf","observerEcf","geodetic","geodeticToEcf","rx","ry","rz","topS","topE","topZ","ecfToLookAngles","rangeSat","El","asin","azimuth","elevation","topocentricToLookAngles","deg","getPositionEci","_len","args","_key","m","jdsatepoch","getGmst","pointToPointDistance","point1","point2","lat1","lon1","lat2","lon2","dLat","dLon","getDistanceFromLatLonInKm","tleLine1","tleLine2","longstr1","longstr2","xpdotp","satnum","epochyr","epochdays","ndot","nddot","alta","altp","mdhmsResult","getElevationWithPositionalData","position_eci","observerGd","position_gd","positionEci","latStart","longStart","latEnd","longEnd","headingAngle","northPoleCurrentPositionDiff","nextPositionCurrentPositionDiff","northPoleNextPositionDiff","cosAngleCurrentPosition","acos","projectPosition","origin","coordinate","rtd","dtr","brng","toPrecision","fmod","rad","SwathCone","SwathLayer","swath","RED","utils","nNextPosition","currentHeading","nextHeadingRad","nextHeading","params","swathWidth","translateDistance","swathHeight","getParams","modelsCache","QuickLook","iconUrl","_icon","_fetch","headers","ok","blob","blobData","URL","createObjectURL","createImage","revokeObjectURL","flipImage","base64src","imageOfQuickLook","addEventListener","srcBase64","parseWKT","parsePolygon","geometryString","startIndex","opened","char","splitMultiPolygon","geo","res","currentPolygon","pair","lonLat","parseEntry","entryObj","double","quickLook","footprint","tileid","tileId","Product","entry","_entry","_footprint","icons","footprintAttributes","Query","_shortName","_location","_beginTime","_endTime","_startIndex","toSerialize","serializeLocation","serializeTime","platformNameQuery","serializeFileName","productsQuery","serializeProductType","queryValue","encodeURIComponent","shortSatName","getCacheID","hour","parsedEntry","searchCache","baseUrl","_baseUrl","_searchCache","hours","filteredProducts","processed","processProducts","startDateMoment","utc","endDateMoment","beginpositionDate","beginposition","endpositionDate","endposition","isBetween","getProductsInTime","hourLoader","loadSearchByHour","promises","searchResults","momentBeginTime","startOf","momentEndTime","duration","durationInHours","asHours","getChachedSearch","loadSearch","hoursString","firstHour","lastHour","beforeFirstHour","afterLastHour","marginHours","parseSearchResults","resultsPerPage","load","currentPage","productsLocal","errors","productIndex","total","feed","cached","query","JSON","json","totalResults","itemsPerPage","stringify","parsed","sciHubUrl","configuration","pathname","StarFieldLayer","AtmosphereLayer","csiRenderablesCache","layersCache","productsScihub","SciHubProducts","Authorization","btoa","defaultBackgroundLayer","defaultStarfieldLayer","defaultAtmosphereLayer","multiRangeAtmosphereLayer","productsRequests","multiRangeTopologyLayer","getLayerKeySCIHubResult","layerConfig","getLayerKeyFromConfig","getLayerIdFromConfig","getProductByKey","productKey","filterOrbitLayersConfigs","layersConfig","filterAcquisitionPlanLayersConfigs","filterStatisticsLayersConfigs","filterSwathLayersConfigs","filterSatelliteLayersConfigs","filterSentinelDataLayersConfigs","filterSearchLayersConfigs","getLayerByName","getSentinelLayer","cacheLayer","getSwathLayer","wwd","setTle","layerAcquisitionKey","setType","setColor","setVisible","intersectedProduct","timeMoment","productIntersectTime","sensoroperationalmode","swatMode","getColorForSatType","setRerender","getSatelliteLayer","setModel","getLayers","sentinelLayers","forceUpdate","getOrbitLayer","satelliteLayers","setPlans","getAcquisitionPlanLayer","getStatisticsLayer","searchResult","FootPrintLayer","getFootprintLayer","stringTime","stringCurrentTime","sentinelDataLayersConfigs","orbitLayersConfigs","satellitesLayersConfigs","swathLayersConfigs","staticticsLayersConfigs","acquisitionPlanLayersKeys","swathLayersKeys","swathCfg","getSwathKey","statisticsLayersKeys","searchLayerKey","getSciProducts","getSciProductByKey","loadProduct","loadLatestProducts","setRenderablesFromConfig","redrawCallback","cancelled","onRenderableAdd","rejected","msg","requests","productsIDs","renderablesToRemove","renderedRenderables","newRenderables","productID","uncompleateBoundaries","setRenderables","changedLayer","startLoading","setTimeout","reloadLayer","layerCfg","wwdLayer","activeRequestReject","dispatchChange","stack","reloadFootprint","reloadLayersRenderable","wwdLayers","useState","productOnline","setProductOnline","useEffect","productMetadata","fetchData","Online","withContext","Component","Consumer","contexts","ProductsModal","showProducts","productInformations","Modal","activeInfoModalKey","activeInfoModal","clipboard","writeText","stopPropagation","shortKey","Uint8Array","Select","getLabel","onChange","onCreate","option","optionValue","_","optionLabel","isDisabled","selectedObject","originalObject","values","getFormattedOptions","valueIsTitle","clearable","multi","renderCreatable","renderBase","placeholder","classNamePrefix","formatOptionLabel","hideSelectedOptions","isClearable","isOptionDisabled","isMulti","menuPortal","base","rest","menuPortalTarget","getElementById","onCreateOption","opt","labelPrefix","labelText","withKeyPrefix","Key","SearchForm","previousResultIndex","nextResultIndex","changeActiveResultIndex","selectedSatellite","setSelectedSatellite","selectedProduct","setSelectedProduct","satellitesOptions","productsOptions","displayMoveButtons","setSearchResults","setSearchTime","setActiveResultIndex","resetSearchComponent","curIndex","maxIndex","filterTime","minIndex","getPreviousIndex","searchCoords","productId","statrIndex","setYear","Result","parsedResult","vertical","ArcBallCamera","BasicWorldWindowController","EarthElevationModel","FrameStatistics","Frustum","Globe","GoToAnimator","Globe2D","Line","GpuResourceCache","LookAtNavigator","Navigator","PickedObjectList","Rectangle","Vec2","Terrain","WWMath","WorldWindow","canvasElem","elevationModel","controllerConstructor","cameraConstructor","WebGLRenderingContext","HTMLCanvasElement","preventDefaultListener","preventDefault","drawContext","eventListeners","redrawRequested","redrawRequestId","scratchModelview","scratchProjection","hasStencilBuffer","getContextAttributes","stencil","depthBits","getParameter","DEPTH_BITS","drawingBufferWidth","drawingBufferHeight","worldWindowController","subsurfaceMode","goToAnimator","_redrawCallbacks","_orderedRenderingFilters","thisWindow","declutter","pixelScale","onGestureEvent","handleRedrawEvent","PointerEvent","setProperty","handleContextLost","handleContextRestored","animationFrameLoop","getBoundingClientRect","xc","clientLeft","yc","clientTop","listener","thisWorldWindow","listeners","worldWindow","removeEventListener","isContextLost","resize","resetDrawContext","pickRay","rayThroughScreenPoint","drawFrame","pickTerrainOnly","rectangle","pickRectangle","glAttrs","antialias","statusMessage","contextLost","cancelAnimationFrame","contextRestored","redrawIfNeeded","requestAnimationFrame","previousRedrawTimestamp","callRedrawCallbacks","BEFORE_REDRAW","AFTER_REDRAW","clientWidth","clientHeight","projection","modelview","camera","createViewMatrix","globeRadius","equatorialRadius","polarRadius","extractEyePoint","eyePos","eyeHorizon","horizonDistanceForGlobeRadius","atmosphereHorizon","farDistance","nearDistance","perspectiveNearDistanceForFarDistance","distanceToSurface","elevationAtLocation","maxNearDistance","perspectiveNearDistance","setToPerspectiveProjection","projectionInv","invertMatrix","nbl","ntr","fbl","ftr","multiplyByMatrix","nrRectWidth","fabs","frRectWidth","nrDistance","frustumWidthScale","frustumWidthOffset","pixelSizeFactor","pixelSizeOffset","computeViewingTransform","pixelMetrics","computePixelMetrics","setToMultiply","modelviewInv","invertOrthonormalMatrix","setToTransposeOfMatrix","upper3By3","modelviewTranspose","fromProjectionMatrix","transformByMatrix","reset","screenCreditController","computeDrawContext","beginFrame","continuous","do2DContiguousRepaint","doNormalRepaint","endFrame","createTerrain","clearFrame","deferOrderedRendering","makePickFrustum","doPick","doDraw","redrawSurface","drawScreenRenderables","createTerrain2DContiguous","pick2DContiguous","draw2DContiguous","resolveTerrainPick","resolveRegionPick","resolveTopPick","enable","BLEND","CULL_FACE","DEPTH_TEST","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","depthFunc","LEQUAL","makePickFramebuffer","pickFramebuffer","disable","ZERO","LESS","bindProgram","DEPTH_BUFFER_BIT","renderShapes","STENCIL_TEST","drawLayers","drawSurfaceRenderables","STENCIL_BUFFER_BIT","stencilFunc","ALWAYS","stencilOp","REPLACE","drawOrderedRenderables","EQUAL","KEEP","pick","tessellator","setTerrainTileCount","surfaceGeometry","terrainLeft","terrainCenter","terrainRight","makeCurrent","accumulateOrderedRenderables","layerRenderingTime","indexOfLayer","sr","reverseSurfaceRenderables","popSurfaceRenderable","renderSurface","or","sortOrderedRenderables","orderedRenderingMode","popOrderedRenderable","orderedRenderingTime","nextScreenRenderable","pickedObjects","topObject","terrainObject","isTerrain","isOnTop","uniquePickColors","readPickColors","toByteString","stage","completionCallback","goTo","groupId","declutterables","orderedRenderables","orderedRenderable","declutterGroup","rects","declutterable","screenBounds","intersectsRectangles","targetVisibility","screenPoint","nearPoint","farPoint","modelviewProjectionInv","unProject","direction","ClickPickController","clickDelay","minClickTime","clickTimeout","mouseDown","tpCache","clickTimeoutKey","eventListener","events","onTouchMove","onMouseMove","onTouchStart","onMouseDown","onTouchEnd","onMouseUp","pickList","canvasCoordinates","getClickTime","evt","getRenderablesByMouse","ev","evts","clearTimeout","clickKey","resetClickTimeout","setClickTimeout","changedTouches","clientX","clientY","couldClick","touches","removeTouchEventByIdentifier","cacheEvents","setPointerDownTimeout","clearTouchEventCache","basicController","applyLimits","clamp","MAX_VALUE","normalizedDegrees","enable2DLimits","maxRange","onNavigatorChanged","getChangedViewParams","getViewParamsFromWorldWindNavigator","wwdUpdate","getWorldWindNavigatorFromViewParams","shouldRedraw","updateFixedView","_isFixed","BEGAN","CHANGED","FixedPointController","lookAt","recognizers","lastPoint","beginRange","sign","animate","animationId","isAnimating","lastDegrees","preventContinuousInnertial","beginPoint","beginHeading","beginTilt","lastRotation","touchStart","startTimestamp","panEnd","touchStartPosition","touchEndPosition","recognizer","handlePanOrDrag3D","tx","translationX","ty","translationY","stopAnimation","metersPerPixel","perspectivePixelSize","forwardMeters","sideMeters","forwardDegrees","sideDegrees","ENDED","isContinuous","isContinuousInertial","animated","animationDuration","Infinity","currentTween","TWEEN","Tween","easing","Easing","Sinusoidal","Out","onStart","onUpdate","onComplete","onStop","headingDegrees","tiltDegrees","longPressTime","travelTime","normalizedDelta","deltaMode","WheelEvent","DOM_DELTA_PIXEL","deltaY","DOM_DELTA_LINE","DOM_DELTA_PAGE","removeAll","stop","EnabledController","handlePanOrDrag","fixedController","handleFling","handlePinch","handleSecondaryDrag","handleRotation","handleTilt","handleWheelEvent","sinHeading","cosHeading","FreeCamera","Animator","animationFrequency","finalRange","rotation","targetPosition","startPosition","rangeDistance","panDistance","pA","pB","maxAltitude","viewportSize","pixelSizeAtDistance","maxAltitudeReachedTime","animationDistance","panVelocity","rangeVelocity","headingVelocity","rotationVelocity","tiltVelocity","thisAnimator","timerCallback","continueAnimation","updateRange","updateLocation","updateTilt","updateHeading","updateRotation","nextRange","elapsedTime","distanceTravelled","distanceRemaining","azimuthToTarget","greatCircleAzimuth","distanceForNow","nextDistance","nextLocation","greatCircleLocation","locationReached","defaultMapView","wwdCreated","prevProps","preventReload","updateViewFixed","enabledLayersKeys","prevVisibleLayers","visibleLayers","prevLayers","Layers","disabledPrevLayers","disabledLayers","visibilityChanged","isEqual","newlyEnabledLayersKeys","lk","handleLayers","newlyEnabledLayersCfg","cfg","onRendarableAdd","notDisabledLayers","disabledLayersKeys","disabledPrevLayersKeys","nextLayersData","searchOnCoords","terrainPick","pickTerrain","terrainCoords","clickedRenderables","reverse","onProductsClick","viewParams","changedViewParams","onViewChange","decorateWorldWindowController","onNavigatorChange","animator","pickController","clickHandler","longClickPickController","longClickHandler","enabledLayers","defaultView","currentView","nextView","onUpdateNavigator","propsTypes","PropTypes","func","bool","setActiveIndex","setLoading","setActiveIndexAndUpdateTime","productTime","getResultMiddleDate","getResultBeginDate","beginPositionIndex","strDate","beginDate","getResultEndDate","middleTime","saveResults","orderResults","allResults","flat","aTime","bTime","updateSearch","activeSatProductsPairs","searchProducts","satResults","setVisibility","timelineState","satId","updateStatistics","activeModalKey","setGeometry","updateView","SatelliteGroupOption","getStyles","headingProps","theme","selectProps","group","memo","WebkitTransition","MozTransition","msTransition","transition","minWidth","padding","fontWeight","textAlign","whiteSpace","verticalAlign","borderRadius","NotificationBadge","badgeStyle","containerStyle","obj1","obj2","obj","attrname1","attrname2","LayerOption","innerProps","onMouseOver","badgeLabel","CountBadge","data-satkey","data-id","Option","isFocused","justifyContent","flex","maxHeight","alignItems","marginLeft","textOverflow","lkey","AcquisitionPlanOption","StatisticsOption","getOption","onLayerClick","onAcquisitionPlanClick","onStatisticsClick","SatelliteGroupHeading","restProps","availableAPS","activeStyle","activeAPSStyle","satIconStyle","maxWidth","labelStyle","posIconStyle","ValueContainer","SelectContainer","onCollapsClick","onSatelliteClick","activeColor","customStyles","menu","provided","menuList","container","valueContainer","control","borderColor","groupHeading","disabledStyle","dropdownIndicator","paddingTop","paddingBottom","GroupHeading","Group","menuIsOpen","closeMenuOnSelect","blurInputOnSelect","onMenuClose","onMenuOpen","nextProps","shalowEqual","satelliteSelectState","sateliteOptions","mapViewRef","useRef","current","selectTimeRef","satelliteKey","currentTarget","satkey","toggleAcquisitionPlan","toggleStatistics","TimelineHover","onHover","context","popup","getHoverContent","onHoverOut","contextType","hoverContext","getAbsoluteElementPosition","rect","docEl","documentElement","pageYOffset","pageXOffset","checkBoundatiesConflict","innerBoundingRect","BBox","topInside","rightInside","bottomInside","leftInside","getTootlipPosition","referencePoint","getPosition","origPosX","origPosY","hoveredElemen","topPos","posX","posXIncrement","posY","posYAbsoplute","overflowRight","overflowLeft","boundingRect","getTopPossition","conflict","bottomPos","offsetHeight","getBottomPossition","leftPos","posYIncrement","posXAbsoplute","overflowTop","overflowBottom","getLeftPossition","rightPos","offsetWidth","getRightPossition","validPosition","Popup","ref","createRef","getStyle","windowScrollTop","scrollTop","windowScrollLeft","scrollLeft","windowHeight","windowWidth","getTooltipStyle","HoverHandler","hoveredItems","Provider","renderPopup","Picker","eHeight","indicatorWidth","eWidth","Mouse","mouseX","mouseBufferWidth","getYears","years","getMonths","months","getDays","getHours","getMinutes","minutes","Overlay","getX","overlaysCfg","periodStart","periodEnd","periodLimitStart","periodLimitEnd","backgound","overlaysElms","yL","yR","PeriodLimit","periodLimitCfg","periodStartMom","periodEndMom","periodLimitStartMom","periodLimitEndMom","periodLimitsCfg","getPeriodLimits","periodLimitsElms","limit","TextLabel","elHeight","elWidth","xTransform","yTransform","D1","dHeight","D2","D3","YearsDash","MonthDash","Years","yearsCfg","YearDash","monthsCfg","Months","HoursDash","DaysDash","Days","daysCfg","DayDash","hoursCfg","HourDash","MinutesDash","Hours","minutesCfg","MinuteDash","Minutes","updateContext","centerTime","centerTimeUtc","getActiveLevel","maxDayWidth","minDayWidth","activeLevel","periodLimitVisible","periodLimitOnCenter","selectMode","ContextProvider","propsWithoutChildren","getPageXFromEvent","targetBoudingBox","touch","pageY","pageX","calculateEventDistance","hypot","cachedEvents","targetTouches","evIndex","TimelineEventsWrapper","_drag","_lastX","_mouseDownX","decelerating","_pointerLastX","multiplier","friction","stopThreshold","targetX","trackingPoints","decVelX","onWheel","onPinch","onDrag","onMouseLeave","start_handler","end_handler","move_handler","prevDiff","onPointerUp","resetMouseTouchProps","onPointerDown","handle_pinch_zoom","onPointerMove","registerMovements","setMoving","addTrackingPoint","isClick","stopTracking","found","prevPoint1","prevPoint2","prevDist","dist","targetBox","centerPoint","dragInfo","allDays","halfDays","periodLimitCenter","daysChange","widthOfTimeline","widthOfResult","daysNeededToUpdate","pointerChangeX","startDecelAnim","firstPoint","D","requestAnimFrame","stepDecelAnim","clearScroll","newDayWidth","zoom","zoomX","centerX","beforeMouseDays","lockCenter","TimeLineContext","webkitRequestAnimationFrame","mozRequestAnimationFrame","TimelineContent","elementWidth","elementHeight","childrenWithProps","LEVELS","level","Timeline","getStateUpdate","getPeriodLimitByTime","xAxis","getXAxisWidth","minPeriodDayWidth","getDayWidthForPeriod","axesWidth","unix","diffDays","levels","getMaxDayWidth","halfMouseDays","stateUpdate","assign","getPeriodLimitByDayWidth","utcTime","getTimezoneOffset","lastLevel","contentHeight","activeDayWidth","getContentHeight","withResizeDetector","LevelElement","MapsTimeline","onTimeClick","hoveredOverlaysContent","isInside","overlaysContent","getOverlaysContent","containerWidth","containerHeight","initialPeriod","TimeLineHover","selectedDate","onTimelineChange","prevActiveLevel","prevVertical","prevPeriod","prevInitialPeriod","prevTime","prevOverlays","prevLEVELS","prevDayWidth","initialTimelinePeriod","strInitialTimelinePeriod","timelineOverlays","curTimelineState","toGMTString","TimeWidget","timer","startTimer","onSetTime","trackTimeActive","onStopTimer","onStopFollowNow","nowActive","onStartTimer","onSelectActive","onStartFollowNow","mouseTimeMom","timeMom","prevActive","prevNowActive","prevTrackTimeActive","prevMouseTime","timeLevelDayWidth","levelDayWidth","currentDayWidth","zoomToTimeLevel","scrollTime","getSatPairsInString","satPairs","SearchToolbarPresentation","onPreviousResultClick","onNextResultClick","displayNoProductsActive","onSearchParamsChanged","activeProduct","prevAmount","usePrevious","activeSatProductsPairsSame","geometryChanged","lastResultIndex","noProductsActive","App","onResize","startTrackNowTime","initTime","innerHeight","innerWidth","setOrientation","satelliteSelectVisible","mapsTimelineVisible","timeWidgetVisible","searchToolbarVisible","maxSelectHeight","getMaxSatelliteSelectHeight","handleWidth","handleHeight","SatelliteSelect","horizontal","Boolean","hostname","classList","PASSIVE_EVENTS","checkType","boolean","capture","passive","wantsUntrusted","forceSetPassiveEvents","ReactDOM","useReducer","reducer","vh","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.09474241.chunk.js","sourcesContent":["module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"b9232d3625614bd14794.worker.js\");\n};","var toGeoJSON = (function () {\n    'use strict';\n\n    var removeSpace = (/\\s*/g),\n        trimSpace = (/^\\s*|\\s*$/g),\n        splitSpace = (/\\s+/);\n    // generate a short, numeric hash of a string\n    function okhash(x) {\n        if (!x || !x.length) {\n            return 0;\n        }\n        for (var i = 0, h = 0; i < x.length; i++) {\n            h = ((h << 5) - h) + x.charCodeAt(i) | 0;\n        }\n        return h;\n    }\n\n    // all Y children of X\n    function get(x, y) {\n        return x.getElementsByTagName(y);\n    }\n\n    function attr(x, y) {\n        return x.getAttribute(y);\n    }\n\n    function attrf(x, y) {\n        return parseFloat(attr(x, y));\n    }\n\n    // one Y child of X, if any, otherwise null\n    function get1(x, y) {\n        var n = get(x, y);\n        return n.length ? n[0] : null;\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/Node.normalize\n    function norm(el) {\n        if (el.normalize) {\n            el.normalize();\n        }\n        return el;\n    }\n\n    // cast array x into numbers\n    function numarray(x) {\n        for (var j = 0, o = []; j < x.length; j++) {\n            o[j] = parseFloat(x[j]);\n        }\n        return o;\n    }\n\n    function clean(x) {\n        var o = {};\n        for (var i in x) {\n            if (x[i]) {\n                o[i] = x[i];\n            }\n        }\n        return o;\n    }\n\n    // get the content of a text node, if any\n    function nodeVal(x) {\n        if (x) {\n            norm(x);\n        }\n        return (x && x.textContent) || '';\n    }\n\n    // get one coordinate from a coordinate array, if any\n    function coord1(v) {\n        return numarray(v.replace(removeSpace, '').split(','));\n    }\n\n    // get all coordinates from a coordinate array as [[],[]]\n    function coord(v) {\n        var coords = v.replace(trimSpace, '').split(splitSpace),\n            o = [];\n        for (var i = 0; i < coords.length; i++) {\n            o.push(coord1(coords[i]));\n        }\n        return o;\n    }\n\n    function coordPair(x) {\n        var ll = [attrf(x, 'lon'), attrf(x, 'lat')],\n            ele = get1(x, 'ele'),\n            // handle namespaced attribute in browser\n            heartRate = get1(x, 'gpxtpx:hr') || get1(x, 'hr'),\n            time = get1(x, 'time'),\n            e;\n        if (ele) {\n            e = parseFloat(nodeVal(ele));\n            if (!isNaN(e)) {\n                ll.push(e);\n            }\n        }\n        return {\n            coordinates: ll,\n            time: time ? nodeVal(time) : null,\n            heartRate: heartRate ? parseFloat(nodeVal(heartRate)) : null\n        };\n    }\n\n    // create a new feature collection parent object\n    function fc() {\n        return {\n            type: 'FeatureCollection',\n            features: []\n        };\n    }\n\n    var serializer;\n    if (typeof XMLSerializer !== 'undefined') {\n        /* istanbul ignore next */\n        serializer = new XMLSerializer();\n        // only require xmldom in a node environment\n    }\n    else if (typeof exports === 'object' && typeof process === 'object' && !process.browser) {\n        //serializer = new (require('xmldom').XMLSerializer)();\n    }\n    function xml2str(str) {\n        // IE9 will create a new XMLSerializer but it'll crash immediately.\n        // This line is ignored because we don't run coverage tests in IE9\n        /* istanbul ignore next */\n        if (str.xml !== undefined) {\n            return str.xml;\n        }\n        return serializer.serializeToString(str);\n    }\n\n    function parseStyle(node) {\n\n        var lineStyle = node.querySelector('LineStyle');\n        var lTextContent;\n        if (lineStyle) {\n            var lColor = lineStyle.querySelector('color');\n            var lWidth = lineStyle.querySelector('width');\n            if (!lColor) {\n                lTextContent = \"ffffffff\";\n            }\n            else {\n                lTextContent = lColor.textContent;\n            }\n\n        }\n        var polySyle = node.querySelector('PolyStyle');\n        var pTextCOntent;\n        if (polySyle) {\n            var pColor = polySyle.querySelector('color');\n            var pFill = polySyle.querySelector('fill');\n            pTextCOntent = pColor.textContent;\n        }\n        var lineColor = lTextContent,\n            polyColor = pTextCOntent;\n        return {\n            lineColor: lineColor,\n            polyColor: polyColor\n        };\n    }\n\n    var t = {\n        kml: function (doc) {\n\n            var gj = fc(),\n                // styleindex keeps track of hashed styles in order to match features\n                styleIndex = {},\n                // atomic geospatial types supported by KML - MultiGeometry is\n                // handled separately\n                geotypes = ['Polygon', 'LineString', 'Point', 'Track', 'gx:Track', 'LinearRing'],\n                // all root placemarks in the file\n                placemarks = get(doc, 'Placemark'),\n                styles = get(doc, 'Style'),\n                styleMaps = get(doc, 'StyleMap');\n\n            for (var k = 0; k < styles.length; k++) {\n                var st = styles[k];\n\n                var strSt = xml2str(styles[k]);\n                var hash = okhash(strSt);\n                //styleIndex['#' + attr(styles[k], 'id')] = okhash(xml2str(styles[k])).toString(16);\n                styleIndex['#' + attr(styles[k], 'id')] = st;\n\n            }\n            for (var l = 0; l < styleMaps.length; l++) {\n                styleIndex['#' + attr(styleMaps[l], 'id')] = okhash(xml2str(styleMaps[l])).toString(16);\n            }\n            for (var j = 0; j < placemarks.length; j++) {\n                gj.features = gj.features.concat(getPlacemark(placemarks[j]));\n            }\n            function kmlColor(v) {\n                var color, opacity;\n                v = v || '';\n                if (v.substr(0, 1) === '#') {\n                    v = v.substr(1);\n                }\n                if (v.length === 6 || v.length === 3) {\n                    color = v;\n                }\n                if (v.length === 8) {\n                    opacity = parseInt(v.substr(0, 2), 16) / 255;\n                    color = '#' + v.substr(2);\n                }\n                return [color, isNaN(opacity) ? undefined : opacity];\n            }\n\n            function gxCoord(v) {\n                return numarray(v.split(' '));\n            }\n\n            function gxCoords(root) {\n                var elems = get(root, 'coord', 'gx'), coords = [], times = [];\n                if (elems.length === 0) {\n                    elems = get(root, 'gx:coord');\n                }\n                for (var i = 0; i < elems.length; i++) {\n                    coords.push(gxCoord(nodeVal(elems[i])));\n                }\n                var timeElems = get(root, 'when');\n                for (var j = 0; j < timeElems.length; j++) {\n                    times.push(nodeVal(timeElems[j]));\n                }\n                return {\n                    coords: coords,\n                    times: times\n                };\n            }\n\n            function getGeometry(root) {\n                var geomNode, geomNodes, i, j, k, geoms = [], coordTimes = [];\n                if (get1(root, 'MultiGeometry')) {\n                    return getGeometry(get1(root, 'MultiGeometry'));\n                }\n                if (get1(root, 'MultiTrack')) {\n                    return getGeometry(get1(root, 'MultiTrack'));\n                }\n                if (get1(root, 'gx:MultiTrack')) {\n                    return getGeometry(get1(root, 'gx:MultiTrack'));\n                }\n                var gasit = false;\n                for (i = 0; i < geotypes.length; i++) {\n                    geomNodes = get(root, geotypes[i]);\n                    if (geomNodes) {\n                        for (j = 0; j < geomNodes.length; j++) {\n                            geomNode = geomNodes[j];\n                            if (geotypes[i] === 'Point') {\n                                geoms.push({\n                                    type: 'Point',\n                                    coordinates: coord1(nodeVal(get1(geomNode, 'coordinates')))\n                                });\n                                gasit = true;\n                            }\n                            else if (geotypes[i] === 'Polygon') {\n                                var rings = get(geomNode, 'LinearRing'),\n                                    coords = [];\n                                for (k = 0; k < rings.length; k++) {\n                                    coords.push(coord(nodeVal(get1(rings[k], 'coordinates'))));\n                                }\n                                geoms.push({\n                                    type: 'Polygon',\n                                    coordinates: coords\n                                });\n                                gasit = true;\n                            }\n                            else if (geotypes[i] === 'LineString' /*|| geotypes[i] === 'LinearRing'*/) {\n                                geoms.push({\n                                    type: 'LineString',\n                                    coordinates: coord(nodeVal(get1(geomNode, 'coordinates')))\n                                });\n                                gasit = true;\n                            }\n                            else if (geotypes[i] === 'LinearRing') {\n                                //console.log('here');\n                                var coords1 = [];\n                                coords1 = coord(nodeVal(get1(geomNode, 'coordinates')));\n                                var outerArr = [coords1];\n                                geoms.push({\n                                    type: 'LinearRing',\n                                    coordinates: outerArr\n                                });\n                                gasit = true;\n                            }\n                            else if (geotypes[i] === 'Track' ||\n                                geotypes[i] === 'gx:Track') {\n                                var track = gxCoords(geomNode);\n                                geoms.push({\n                                    type: 'LineString',\n                                    coordinates: track.coords\n                                });\n                                if (track.times.length) {\n                                    coordTimes.push(track.times);\n                                }\n                                gasit = true;\n                            }\n                        }\n                        if (gasit) {\n                            break;\n                        }\n                    }\n                }\n                return {\n                    geoms: geoms,\n                    coordTimes: coordTimes\n                };\n            }\n\n            function getPlacemark(root) {\n                var geomsAndTimes = getGeometry(root), i, properties = {},\n                    name = nodeVal(get1(root, 'name')),\n                    styleUrl = nodeVal(get1(root, 'styleUrl')),\n                    description = nodeVal(get1(root, 'description')),\n                    timeSpan = get1(root, 'TimeSpan'),\n                    extendedData = get1(root, 'ExtendedData'),\n                    lineStyle = get1(root, 'LineStyle'),\n                    polyStyle = get1(root, 'PolyStyle');\n\n                if (!geomsAndTimes.geoms.length) {\n                    return [];\n                }\n                if (name) {\n                    properties.name = name;\n                }\n                if (styleUrl[0] !== '#') {\n                    styleUrl = '#' + styleUrl;\n                }\n                if (styleUrl && styleIndex[styleUrl]) {\n                    properties.styleUrl = styleUrl;\n                    //properties.styleHash = styleIndex[styleUrl];\n                    var styleDoc = styleIndex[styleUrl];\n                    var a = parseStyle(styleDoc);\n                    properties.lineColor = a.lineColor;\n                    properties.polyColor = a.polyColor;\n                }\n                if (description) {\n                    properties.description = description;\n                }\n                if (timeSpan) {\n                    var begin = nodeVal(get1(timeSpan, 'begin'));\n                    var end = nodeVal(get1(timeSpan, 'end'));\n                    properties.timespan = {begin: begin, end: end};\n                }\n                if (lineStyle) {\n                    var linestyles = kmlColor(nodeVal(get1(lineStyle, 'color'))),\n                        color = linestyles[0],\n                        opacity = linestyles[1],\n                        width = parseFloat(nodeVal(get1(lineStyle, 'width')));\n                    if (color) {\n                        properties.stroke = color;\n                    }\n                    if (!isNaN(opacity)) {\n                        properties['stroke-opacity'] = opacity;\n                    }\n                    if (!isNaN(width)) {\n                        properties['stroke-width'] = width;\n                    }\n                }\n                if (polyStyle) {\n                    var polystyles = kmlColor(nodeVal(get1(polyStyle, 'color'))),\n                        pcolor = polystyles[0],\n                        popacity = polystyles[1],\n                        fill = nodeVal(get1(polyStyle, 'fill')),\n                        outline = nodeVal(get1(polyStyle, 'outline'));\n                    if (pcolor) {\n                        properties.fill = pcolor;\n                    }\n                    if (!isNaN(popacity)) {\n                        properties['fill-opacity'] = popacity;\n                    }\n                    if (fill) {\n                        properties['fill-opacity'] = fill === '1' ? 1 : 0;\n                    }\n                    if (outline) {\n                        properties['stroke-opacity'] = outline === '1' ? 1 : 0;\n                    }\n                }\n                if (extendedData) {\n                    var datas = get(extendedData, 'Data'),\n                        simpleDatas = get(extendedData, 'SimpleData');\n\n                    for (i = 0; i < datas.length; i++) {\n                        properties[datas[i].getAttribute('name')] = nodeVal(get1(datas[i], 'value'));\n                    }\n                    for (i = 0; i < simpleDatas.length; i++) {\n                        properties[simpleDatas[i].getAttribute('name')] = nodeVal(simpleDatas[i]);\n                    }\n                }\n                if (geomsAndTimes.coordTimes.length) {\n                    properties.coordTimes = (geomsAndTimes.coordTimes.length === 1) ?\n                        geomsAndTimes.coordTimes[0] : geomsAndTimes.coordTimes;\n                }\n                var feature = {\n                    type: 'Feature',\n                    geometry: (geomsAndTimes.geoms.length === 1) ? geomsAndTimes.geoms[0] : {\n                            type: 'GeometryCollection',\n                            geometries: geomsAndTimes.geoms\n                        },\n                    properties: properties\n                };\n                if (attr(root, 'id')) {\n                    feature.id = attr(root, 'id');\n                }\n                return [feature];\n            }\n\n            return gj;\n        },\n        gpx: function (doc) {\n            var i,\n                tracks = get(doc, 'trk'),\n                routes = get(doc, 'rte'),\n                waypoints = get(doc, 'wpt'),\n                // a feature collection\n                gj = fc(),\n                feature;\n            for (i = 0; i < tracks.length; i++) {\n                feature = getTrack(tracks[i]);\n                if (feature) {\n                    gj.features.push(feature);\n                }\n            }\n            for (i = 0; i < routes.length; i++) {\n                feature = getRoute(routes[i]);\n                if (feature) {\n                    gj.features.push(feature);\n                }\n            }\n            for (i = 0; i < waypoints.length; i++) {\n                gj.features.push(getPoint(waypoints[i]));\n            }\n            function getPoints(node, pointname) {\n                var pts = get(node, pointname),\n                    line = [],\n                    times = [],\n                    heartRates = [],\n                    l = pts.length;\n                if (l < 2) {\n                    return {};\n                }  // Invalid line in GeoJSON\n                for (var i = 0; i < l; i++) {\n                    var c = coordPair(pts[i]);\n                    line.push(c.coordinates);\n                    if (c.time) {\n                        times.push(c.time);\n                    }\n                    if (c.heartRate) {\n                        heartRates.push(c.heartRate);\n                    }\n                }\n                return {\n                    line: line,\n                    times: times,\n                    heartRates: heartRates\n                };\n            }\n\n            function getTrack(node) {\n                var segments = get(node, 'trkseg'),\n                    track = [],\n                    times = [],\n                    heartRates = [],\n                    line;\n                for (var i = 0; i < segments.length; i++) {\n                    line = getPoints(segments[i], 'trkpt');\n                    if (line.line) {\n                        track.push(line.line);\n                    }\n                    if (line.times && line.times.length) {\n                        times.push(line.times);\n                    }\n                    if (line.heartRates && line.heartRates.length) {\n                        heartRates.push(line.heartRates);\n                    }\n                }\n                if (track.length === 0) {\n                    return;\n                }\n                var properties = getProperties(node);\n                if (times.length) {\n                    properties.coordTimes = track.length === 1 ? times[0] : times;\n                }\n                if (heartRates.length) {\n                    properties.heartRates = track.length === 1 ? heartRates[0] : heartRates;\n                }\n                return {\n                    type: 'Feature',\n                    properties: properties,\n                    geometry: {\n                        type: track.length === 1 ? 'LineString' : 'MultiLineString',\n                        coordinates: track.length === 1 ? track[0] : track\n                    }\n                };\n            }\n\n            function getRoute(node) {\n                var line = getPoints(node, 'rtept');\n                if (!line.line) {\n                    return;\n                }\n                var routeObj = {\n                    type: 'Feature',\n                    properties: getProperties(node),\n                    geometry: {\n                        type: 'LineString',\n                        coordinates: line.line\n                    }\n                };\n                return routeObj;\n            }\n\n            function getPoint(node) {\n                var prop = getProperties(node);\n                prop.sym = nodeVal(get1(node, 'sym'));\n                return {\n                    type: 'Feature',\n                    properties: prop,\n                    geometry: {\n                        type: 'Point',\n                        coordinates: coordPair(node).coordinates\n                    }\n                };\n            }\n\n            function getProperties(node) {\n                var meta = ['name', 'desc', 'author', 'copyright', 'link',\n                        'time', 'keywords'],\n                    prop = {},\n                    k;\n                for (k = 0; k < meta.length; k++) {\n                    prop[meta[k]] = nodeVal(get1(node, meta[k]));\n                }\n                return clean(prop);\n            }\n\n            return gj;\n        }\n    };\n    return t;\n})();\n\nexport default toGeoJSON;","/*\n * Copyright (C) 2014 United States Government as represented by the Administrator of the\n * National Aeronautics and Space Administration. All Rights Reserved.\n */\n/**\n * @exports SurfaceShape\n * @version $Id: SurfaceShape.js 3191 2015-06-15 19:35:57Z tgaskins $\n */\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    AbstractError,\n    Angle,\n    Location,\n    Logger,\n    NotYetImplementedError,\n    PickedObject,\n    PolygonSplitter,\n    Renderable,\n    Sector,\n    ShapeAttributes,\n    Vec3,\n    MemoryCache,\n    BoundingBox,\n    // SurfaceShape,\n} = WorldWind;\n\nlet SurfaceShape = WorldWind.SurfaceShape;\n\n\n/**\n * Constructs a surface shape with an optionally specified bundle of default attributes.\n * @alias SurfaceShape\n * @constructor\n * @augments Renderable\n * @abstract\n * @classdesc Represents a surface shape. This is an abstract base class and is meant to be instantiated\n * only by subclasses.\n * <p>\n * Surface shapes other than SurfacePolyline {@link SurfacePolyline} have an interior and an outline and utilize\n * the corresponding attributes in their associated ShapeAttributes {@link ShapeAttributes}. They do not\n * utilize image-related attributes.\n *\n * @param {ShapeAttributes} attributes The attributes to apply to this shape. May be null, in which case\n * attributes must be set directly before the shape is drawn.\n */\nSurfaceShape = function (attributes) {\n\n    Renderable.call(this);\n\n    // All these are documented with their property accessors below.\n    this._displayName = \"Surface Shape\";\n    this._attributes = attributes ? attributes : new ShapeAttributes(null);\n    this._highlightAttributes = null;\n    this._highlighted = false;\n    this._enabled = true;\n    this._pathType = WorldWind.GREAT_CIRCLE;\n    this._maximumNumEdgeIntervals = SurfaceShape.DEFAULT_NUM_EDGE_INTERVALS;\n    this._polarThrottle = SurfaceShape.DEFAULT_POLAR_THROTTLE;\n    this._sector = null;\n\n    /**\n     * Indicates the object to return as the owner of this shape when picked.\n     * @type {Object}\n     * @default null\n     */\n    this.pickDelegate = null;\n\n    /*\n     * The bounding sectors for this tile, which may be needed for crossing the dateline.\n     * @type {Sector[]}\n     * @protected\n     */\n    this._sectors = [];\n\n    /*\n     * The raw collection of locations defining this shape and are explicitly specified by the client of this class.\n     * @type {Location[]}\n     * @protected\n     */\n    this._locations = null;\n\n    /*\n     * Boundaries that are either the user specified locations or locations that are algorithmically generated.\n     * @type {Location[]}\n     * @protected\n     */\n    this._boundaries = null;\n\n    /*\n     * The collection of locations that describes a closed curve which can be filled.\n     * @type {Location[][]}\n     * @protected\n     */\n    this._interiorGeometry = null;\n\n    /*\n     * The collection of locations that describe the outline of the shape.\n     * @type {Location[][]}\n     * @protected\n     */\n    this._outlineGeometry = null;\n\n    /*\n     * Internal use only.\n     * Inhibit the filling of the interior. This is to be used ONLY by polylines.\n     * @type {Boolean}\n     * @protected\n     */\n    this._isInteriorInhibited = false;\n\n    /*\n     * Indicates whether this object's state key is invalid. Subclasses must set this value to true when their\n     * attributes change. The state key will be automatically computed the next time it's requested. This flag\n     * will be set to false when that occurs.\n     * @type {Boolean}\n     * @protected\n     */\n    this.stateKeyInvalid = true;\n\n    // Internal use only. Intentionally not documented.\n    this._attributesStateKey = null;\n\n    // Internal use only. Intentionally not documented.\n    this.boundariesArePrepared = false;\n\n    // Internal use only. Intentionally not documented.\n    this.layer = null;\n\n    // Internal use only. Intentionally not documented.\n    this.pickColor = null;\n\n    //the split contours returned from polygon splitter\n    this.contours = [];\n    this.containsPole = false;\n    this.crossesAntiMeridian = false;\n\n    /**\n     * Indicates how long to use terrain-specific shape data before regenerating it, in milliseconds. A value\n     * of zero specifies that shape data should be regenerated every frame. While this causes the shape to\n     * adapt more frequently to the terrain, it decreases performance.\n     * @type {Number}\n     * @default 2000 (milliseconds)\n     */\n    this.expirationInterval = 2000;\n\n    // Internal use only. Intentionally not documented.\n    // Holds the per-globe data\n    this.shapeDataCache = new MemoryCache(3, 2);\n\n    // Internal use only. Intentionally not documented.\n    // The shape-data-cache data that is for the currently active globe.\n    this.currentData = null;\n};\n\nSurfaceShape.prototype = Object.create(Renderable.prototype);\n\nObject.defineProperties(SurfaceShape.prototype, {\n    stateKey: {\n        /**\n         * A hash key of the total visible external state of the surface shape.\n         * @memberof SurfaceShape.prototype\n         * @type {String}\n         */\n        get: function () {\n            // If we don't have a state key for the shape attributes, consider this state key to be invalid.\n            if (!this._attributesStateKey) {\n                // Update the state key for the appropriate attributes for future\n                if (this._highlighted) {\n                    if (!!this._highlightAttributes) {\n                        this._attributesStateKey = this._highlightAttributes.stateKey;\n                    }\n                } else {\n                    if (!!this._attributes) {\n                        this._attributesStateKey = this._attributes.stateKey;\n                    }\n                }\n\n                // If we now actually have a state key for the attributes, it was previously invalid.\n                if (!!this._attributesStateKey) {\n                    this.stateKeyInvalid = true;\n                }\n            } else {\n                // Detect a change in the appropriate attributes.\n                var currentAttributesStateKey = null;\n\n                if (this._highlighted) {\n                    // If there are highlight attributes associated with this shape, ...\n                    if (!!this._highlightAttributes) {\n                        currentAttributesStateKey = this._highlightAttributes.stateKey;\n                    }\n                } else {\n                    if (!!this._attributes) {\n                        currentAttributesStateKey = this._attributes.stateKey;\n                    }\n                }\n\n                // If the attributes state key changed, ...\n                if (currentAttributesStateKey != this._attributesStateKey) {\n                    this._attributesStateKey = currentAttributesStateKey;\n                    this.stateKeyInvalid = true;\n                }\n            }\n\n            if (this.stateKeyInvalid) {\n                this._stateKey = this.computeStateKey();\n            }\n\n            return this._stateKey;\n        }\n    },\n\n    /**\n     * The shape's display name and label text.\n     * @memberof SurfaceShape.prototype\n     * @type {String}\n     * @default Surface Shape\n     */\n    displayName: {\n        get: function () {\n            return this._displayName;\n        },\n        set: function (value) {\n            this.stateKeyInvalid = true;\n            this._displayName = value;\n        }\n    },\n\n    /**\n     * The shape's attributes. If null and this shape is not highlighted, this shape is not drawn.\n     * @memberof SurfaceShape.prototype\n     * @type {ShapeAttributes}\n     * @default see [ShapeAttributes]{@link ShapeAttributes}\n     */\n    attributes: {\n        get: function () {\n            return this._attributes;\n        },\n        set: function (value) {\n            this.stateKeyInvalid = true;\n            this._attributes = value;\n            this._attributesStateKey = value.stateKey;\n        }\n    },\n\n    /**\n     * The attributes used when this shape's highlighted flag is true. If null and the\n     * highlighted flag is true, this shape's normal attributes are used. If they, too, are null, this\n     * shape is not drawn.\n     * @memberof SurfaceShape.prototype\n     * @type {ShapeAttributes}\n     * @default null\n     */\n    highlightAttributes: {\n        get: function () {\n            return this._highlightAttributes;\n        },\n        set: function (value) {\n            this.stateKeyInvalid = true;\n            this._highlightAttributes = value;\n        }\n    },\n\n    /**\n     * Indicates whether this shape displays with its highlight attributes rather than its normal attributes.\n     * @memberof SurfaceShape.prototype\n     * @type {Boolean}\n     * @default false\n     */\n    highlighted: {\n        get: function () {\n            return this._highlighted;\n        },\n        set: function (value) {\n            this.stateKeyInvalid = true;\n            this._highlighted = value;\n        }\n    },\n\n    /**\n     * Indicates whether this shape is drawn.\n     * @memberof SurfaceShape.prototype\n     * @type {Boolean}\n     * @default true\n     */\n    enabled: {\n        get: function () {\n            return this._enabled;\n        },\n        set: function (value) {\n            this.stateKeyInvalid = true;\n            this._enabled = value;\n        }\n    },\n\n    /**\n     * The path type to used to interpolate between locations on this shape. Recognized values are:\n     * <ul>\n     * <li>WorldWind.GREAT_CIRCLE</li>\n     * <li>WorldWind.RHUMB_LINE</li>\n     * <li>WorldWind.LINEAR</li>\n     * </ul>\n     * @memberof SurfaceShape.prototype\n     * @type {String}\n     * @default WorldWind.GREAT_CIRCLE\n     */\n    pathType: {\n        get: function () {\n            return this._pathType;\n        },\n        set: function (value) {\n            this.stateKeyInvalid = true;\n            this.resetBoundaries();\n            this._pathType = value;\n        }\n    },\n\n    /**\n     * The maximum number of intervals an edge will be broken into. This is the number of intervals that an\n     * edge that spans to opposite side of the globe would be broken into. This is strictly an upper bound\n     * and the number of edge intervals may be lower if this resolution is not needed.\n     * @memberof SurfaceShape.prototype\n     * @type {Number}\n     * @default SurfaceShape.DEFAULT_NUM_EDGE_INTERVALS\n     */\n    maximumNumEdgeIntervals: {\n        get: function () {\n            return this._maximumNumEdgeIntervals;\n        },\n        set: function (value) {\n            this.stateKeyInvalid = true;\n            this.resetBoundaries();\n            this._maximumNumEdgeIntervals = value;\n        }\n    },\n\n    /**\n     * A dimensionless number that controls throttling of edge traversal near the poles where edges need to be\n     * sampled more closely together.\n     * A value of 0 indicates that no polar throttling is to be performed.\n     * @memberof SurfaceShape.prototype\n     * @type {Number}\n     * @default SurfaceShape.DEFAULT_POLAR_THROTTLE\n     */\n    polarThrottle: {\n        get: function () {\n            return this._polarThrottle;\n        },\n        set: function (value) {\n            this.stateKeyInvalid = true;\n            this.resetBoundaries();\n            this._polarThrottle = value;\n        }\n    },\n\n    /**\n     * Defines the extent of the shape in latitude and longitude.\n     * This sector only has valid data once the boundary is defined. Prior to this, it is null.\n     * @memberof SurfaceShape.prototype\n     * @type {Sector}\n     */\n    sector: {\n        get: function () {\n            return this._sector;\n        }\n    }\n});\n\nSurfaceShape.staticStateKey = function (shape) {\n    shape.stateKeyInvalid = false;\n\n    if (shape.highlighted) {\n        if (!shape._highlightAttributes) {\n            if (!shape._attributes) {\n                shape._attributesStateKey = null;\n            } else {\n                shape._attributesStateKey = shape._attributes.stateKey;\n            }\n        } else {\n            shape._attributesStateKey = shape._highlightAttributes.stateKey;\n        }\n    } else {\n        if (!shape._attributes) {\n            shape._attributesStateKey = null;\n        } else {\n            shape._attributesStateKey = shape._attributes.stateKey;\n        }\n    }\n\n    return \"dn \" + shape.displayName +\n        \" at \" + (!shape._attributesStateKey ? \"null\" : shape._attributesStateKey) +\n        \" hi \" + shape.highlighted +\n        \" en \" + shape.enabled +\n        \" pt \" + shape.pathType +\n        \" ne \" + shape.maximumNumEdgeIntervals +\n        \" po \" + shape.polarThrottle +\n        \" se \" + \"[\" +\n        shape.sector.minLatitude + \",\" +\n        shape.sector.maxLatitude + \",\" +\n        shape.sector.minLongitude + \",\" +\n        shape.sector.maxLongitude +\n        \"]\";\n};\n\nSurfaceShape.prototype.computeStateKey = function () {\n    return SurfaceShape.staticStateKey(this);\n};\n\n/**\n * Returns this shape's area in square meters.\n * @param {Globe} globe The globe on which to compute the area.\n * @param {Boolean} terrainConformant If true, the returned area is that of the terrain,\n * including its hillsides and other undulations. If false, the returned area is the shape's\n * projected area.\n */\nSurfaceShape.prototype.area = function (globe, terrainConformant) {\n    throw new NotYetImplementedError(\n        Logger.logMessage(Logger.LEVEL_SEVERE, \"SurfaceShape\", \"area\", \"notYetImplemented\"));\n};\n\n// Internal function. Intentionally not documented.\nSurfaceShape.prototype.computeBoundaries = function (globe) {\n    // This method is in the base class and should be overridden if the boundaries are generated.\n    // It should be called only if the geometry has been provided by the user and does not need to be generated.\n    // assert(!this._boundaries);\n\n    throw new AbstractError(\n        Logger.logMessage(Logger.LEVEL_SEVERE, \"SurfaceShape\", \"computeBoundaries\", \"abstractInvocation\"));\n};\n\n\n// Internal. Intentionally not documented.\nSurfaceShape.prototype.intersectsFrustum = function (dc) {\n\n    if (this.currentData && this.currentData.extent) {\n        if (dc.pickingMode) {\n            return this.currentData.extent.intersectsFrustum(dc.pickFrustum);\n        } else {\n            return this.currentData.extent.intersectsFrustum(dc.frustumInModelCoordinates);\n        }\n    } else {\n        return true;\n    }\n};\n\n/**\n * Indicates whether a specified shape data object is current. Subclasses may override this method to add\n * criteria indicating whether the shape data object is current, but must also call this method on this base\n * class. Applications do not call this method.\n * @param {DrawContext} dc The current draw context.\n * @param {Object} shapeData The object to validate.\n * @returns {Boolean} true if the object is current, otherwise false.\n * @protected\n */\nSurfaceShape.prototype.isShapeDataCurrent = function (dc, shapeData) {\n    return shapeData.verticalExaggeration === dc.verticalExaggeration\n        && shapeData.expiryTime > Date.now();\n};\n\n/**\n * Creates a new shape data object for the current globe state. Subclasses may override this method to\n * modify the shape data object that this method creates, but must also call this method on this base class.\n * Applications do not call this method.\n * @returns {Object} The shape data object.\n * @protected\n */\nSurfaceShape.prototype.createShapeDataObject = function () {\n    return {};\n};\n\n// Intentionally not documented.\nSurfaceShape.prototype.resetExpiration = function (shapeData) {\n    // The random addition in the line below prevents all shapes from regenerating during the same frame.\n    shapeData.expiryTime = Date.now() + this.expirationInterval + 1e3 * Math.random();\n};\n\n// Internal. Intentionally not documented.\nSurfaceShape.prototype.establishCurrentData = function (dc) {\n    this.currentData = this.shapeDataCache.entryForKey(dc.globeStateKey);\n    if (!this.currentData) {\n        this.currentData = this.createShapeDataObject();\n        this.resetExpiration(this.currentData);\n        this.shapeDataCache.putEntry(dc.globeStateKey, this.currentData, 1);\n    }\n\n    this.currentData.isExpired = !this.isShapeDataCurrent(dc, this.currentData);\n};\n\n // Internal function. Intentionally not documented.\n SurfaceShape.prototype.render = function (dc) {\n    if (!this.enabled) {\n        return;\n    }\n\n    this.layer = dc.currentLayer;\n\n    this.prepareBoundaries(dc);\n\n    this.establishCurrentData(dc);\n\n    if (this.currentData.isExpired || !this.currentData.extent) {\n        this.computeExtent(dc);\n        this.currentData.verticalExaggeration = dc.verticalExaggeration;\n        this.resetExpiration(this.currentData);\n    }\n\n    // Use the last computed extent to see if this shape is out of view.\n    if (this.currentData && this.currentData.extent && !this.intersectsFrustum(dc)) {\n        return;\n    }\n\n    dc.surfaceShapeTileBuilder.insertSurfaceShape(this);\n};\n\n\n// Internal function. Intentionally not documented.\nSurfaceShape.prototype.interpolateLocations = function (locations) {\n    var first = locations[0],\n        next = first,\n        prev,\n        isNextFirst = true,\n        isPrevFirst = true,// Don't care initially, this will get set in first iteration.\n        countFirst = 0,\n        isInterpolated = true,\n        idx, len;\n\n    this._locations = [first];\n\n    for (idx = 1, len = locations.length; idx < len; idx += 1) {\n        // Advance to next location, retaining previous location.\n        prev = next;\n        isPrevFirst = isNextFirst;\n\n        next = locations[idx];\n\n        // Detect whether the next location and the first location are the same.\n        isNextFirst = next.latitude == first.latitude && next.longitude == first.longitude;\n\n        // Inhibit interpolation if either endpoint if the first location,\n        // except for the first segement which will be the actual first location or that location\n        // as the polygon closes the first time.\n        // All subsequent encounters of the first location are used to connected secondary domains with the\n        // primary domain in multiply-connected geometry (an outer ring with multiple inner rings).\n        isInterpolated = true;\n        if (isNextFirst || isPrevFirst) {\n            countFirst += 1;\n\n            if (countFirst > 2) {\n                isInterpolated = false;\n            }\n        }\n\n        if (isInterpolated) {\n            this.interpolateEdge(prev, next, this._locations);\n        }\n\n        this._locations.push(next);\n\n        prev = next;\n    }\n\n    // Force the closing of the border.\n    if (!this._isInteriorInhibited) {\n        // Avoid duplication if the first endpoint was already emitted.\n        if (prev.latitude != first.latitude || prev.longitude != first.longitude) {\n            this.interpolateEdge(prev, first, this._locations);\n            this._locations.push(first);\n        }\n    }\n};\n\n// Internal function. Intentionally not documented.\nSurfaceShape.prototype.interpolateEdge = function (start, end, locations) {\n    var distanceRadians = Location.greatCircleDistance(start, end),\n        steps = Math.round(this._maximumNumEdgeIntervals * distanceRadians / Math.PI),\n        dt,\n        location;\n\n    if (steps > 0) {\n        dt = 1 / steps;\n        location = start;\n\n        for (var t = this.throttledStep(dt, location); t < 1; t += this.throttledStep(dt, location)) {\n            location = new Location(0, 0);\n            Location.interpolateAlongPath(this._pathType, t, start, end, location);\n\n            //florin: ensure correct longitude sign and decimal error for anti-meridian\n            if (start.longitude === 180 && end.longitude === 180) {\n                location.longitude = 180;\n            }\n            else if (start.longitude === -180 && end.longitude === -180) {\n                location.longitude = -180;\n            }\n\n            locations.push(location);\n        }\n    }\n};\n\n// Internal function. Intentionally not documented.\n// Return a throttled step size when near the poles.\nSurfaceShape.prototype.throttledStep = function (dt, location) {\n    var cosLat = Math.cos(location.latitude * Angle.DEGREES_TO_RADIANS);\n    cosLat *= cosLat; // Square cos to emphasize poles and de-emphasize equator.\n\n    // Remap polarThrotle:\n    //  0 .. INF => 0 .. 1\n    // This acts as a weight between no throttle and fill throttle.\n    var weight = this._polarThrottle / (1 + this._polarThrottle);\n\n    return dt * ((1 - weight) + weight * cosLat);\n};\n\n// Internal function. Intentionally not documented.\nSurfaceShape.prototype.prepareBoundaries = function (dc) {\n    if (this.boundariesArePrepared) {\n        return;\n    }\n\n    if (!this._boundaries) {\n        this.computeBoundaries(dc);\n    }\n\n    var newBoundaries = this.formatBoundaries();\n    this.normalizeAngles(newBoundaries);\n    newBoundaries = this.interpolateBoundaries(newBoundaries);\n\n    var contoursInfo = [];\n    var doesCross = PolygonSplitter.splitContours(newBoundaries, contoursInfo);\n    this.contours = contoursInfo;\n    this.crossesAntiMeridian = doesCross;\n\n    this.prepareGeometry(dc, contoursInfo);\n\n    this.prepareSectors();\n\n    this.boundariesArePrepared = true;\n};\n\n// Internal. Resets boundaries for SurfaceShape recomputing.\nSurfaceShape.prototype.resetBoundaries = function () {\n    this.boundariesArePrepared = false;\n    this.shapeDataCache.clear(false);\n};\n\n//Internal. Formats the boundaries of a surface shape to be a multi dimensional array\nSurfaceShape.prototype.formatBoundaries = function () {\n    var boundaries = [];\n    if (!this._boundaries.length) {\n        return boundaries;\n    }\n    if (this._boundaries[0].latitude != null) {\n        //not multi dim array\n        boundaries.push(this._boundaries);\n    }\n    else {\n        boundaries = this._boundaries;\n    }\n    return boundaries;\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.normalizeAngles = function (boundaries) {\n    for (var i = 0, len = boundaries.length; i < len; i++) {\n        var polygon = boundaries[i];\n        for (var j = 0, lenP = polygon.length; j < lenP; j++) {\n            var point = polygon[j];\n            if (point.longitude < -180 || point.longitude > 180) {\n                point.longitude = Angle.normalizedDegreesLongitude(point.longitude);\n            }\n            if (point.latitude < -90 || point.latitude > 90) {\n                point.latitude = Angle.normalizedDegreesLatitude(point.latitude);\n            }\n        }\n    }\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.interpolateBoundaries = function (boundaries) {\n    var newBoundaries = [];\n    for (var i = 0, len = boundaries.length; i < len; i++) {\n        var contour = boundaries[i];\n        this.interpolateLocations(contour);\n        newBoundaries.push(this._locations.slice());\n        this._locations.length = 0;\n    }\n    return newBoundaries;\n};\n\n/**\n * Computes the bounding sectors for the shape. There will be more than one if the shape crosses the date line,\n * but does not enclose a pole.\n *\n * @param {DrawContext} dc The drawing context containing a globe.\n *\n * @return {Sector[]}  Bounding sectors for the shape.\n */\nSurfaceShape.prototype.computeSectors = function (dc) {\n    // Return a previously computed value if it already exists.\n    if (this._sectors && this._sectors.length > 0) {\n        return this._sectors;\n    }\n\n    this.prepareBoundaries(dc);\n\n    return this._sectors;\n};\n\n\n/**\n * Computes the extent for the shape based on its sectors.\n *\n * @param {DrawContext} dc The drawing context containing a globe.\n *\n * @return {BoundingBox} The extent for the shape.\n */\nSurfaceShape.prototype.computeExtent = function (dc) {\n\n    if (!this._sectors || this._sectors.length === 0) {\n        return null;\n    }\n\n    if (!this.currentData) {\n        return null;\n    }\n\n    if (!this.currentData.extent) {\n        this.currentData.extent = new BoundingBox();\n    }\n\n\n    var boxPoints;\n    // This surface shape does not cross the international dateline, and therefore has a single bounding sector.\n    // Return the box which contains that sector.\n    if (this._sectors.length === 1) {\n        boxPoints = this._sectors[0].computeBoundingPoints(dc.globe, dc.verticalExaggeration);\n        this.currentData.extent.setToVec3Points(boxPoints);\n    }\n    // This surface crosses the international dateline, and its bounding sectors are split along the dateline.\n    // Return a box which contains the corners of the boxes bounding each sector.\n    else {\n        var boxCorners = [];\n\n        for (var i = 0; i < this._sectors.length; i++) {\n            boxPoints = this._sectors[i].computeBoundingPoints(dc.globe, dc.verticalExaggeration);\n            var box = new BoundingBox();\n            box.setToVec3Points(boxPoints);\n            var corners = box.getCorners();\n            for (var j = 0; j < corners.length; j++) {\n                boxCorners.push(corners[j]);\n            }\n        }\n        this.currentData.extent.setToVec3Points(boxCorners);\n    }\n\n    return this.currentData.extent;\n\n};\n\n /**\n * Computes a new set of locations translated from a specified location to a new location for a shape.\n *\n * @param {Globe} globe The globe on which to compute a new set of locations.\n * @param {Location} oldLocation The original reference location.\n * @param {Location} newLocation The new reference location.\n * @param {Location[]} locations The locations to translate.\n *\n * @return {Location[]} The translated locations.\n */\nSurfaceShape.prototype.computeShiftedLocations = function(globe, oldLocation, newLocation, locations) {\n    var newLocations = [];\n    var result = new Vec3(0, 0, 0);\n    var newPos = new WorldWind.Position(0, 0, 0);\n\n    var oldPoint = globe.computePointFromLocation(oldLocation.latitude, oldLocation.longitude,\n        new Vec3(0, 0, 0));\n    var newPoint = globe.computePointFromLocation(newLocation.latitude, newLocation.longitude,\n        new Vec3(0, 0, 0));\n\n    if(globe.is2D()){\n        var delta = newPoint.subtract(oldPoint);\n\n        for (var i = 0, len = locations.length; i < len; i++) {\n            globe.computePointFromLocation(locations[i].latitude, locations[i].longitude, result);\n            result.add(delta);\n            globe.computePositionFromPoint(result[0], result[1], result[2], newPos);\n            newLocations.push(new Location(newPos.latitude, newPos.longitude));\n        }\n    } else {\n        // Euler method\n\n        // var xVecOld = new Vec3(0, oldPoint[1], oldPoint[2]);\n        // var yVecOld =  new Vec3(oldPoint[0], 0, oldPoint[2]);\n        // var zVecOld =  new Vec3(oldPoint[0], oldPoint[1], 0);\n        // var xVecNew = new Vec3(0, newPoint[1], newPoint[2]);\n        // var yVecNew =  new Vec3(newPoint[0], 0, newPoint[2]);\n        // var zVecNew =  new Vec3(newPoint[0], newPoint[1], 0);\n        //\n        //\n        // var alpha = Math.acos(xVecOld.dot(xVecNew) / (xVecOld.magnitude() * xVecNew.magnitude()));\n        // var beta = Math.acos(yVecOld.dot(yVecNew) / (yVecOld.magnitude() * yVecNew.magnitude()));\n        // var gama = Math.acos(zVecOld.dot(zVecNew) / (zVecOld.magnitude() * zVecNew.magnitude()));\n        //\n        // var alpha = Math.atan2()\n        //\n        // var crossX = xVecOld.cross(xVecNew);\n        // var crossY = yVecOld.cross(yVecNew);\n        // var crossZ = zVecOld.cross(zVecNew);\n        //\n        // if(new Vec3(1, 0, 0).dot(crossX) < 0){\n        //      alpha = -alpha;\n        // }\n        //\n        // if(new Vec3(0, 1, 0).dot(crossY) < 0){\n        //     beta = -beta;\n        // }\n        //\n        // if(new Vec3(0, 0, 1).dot(crossZ) < 0){\n        //     gama = -gama;\n        // }\n        //\n        // for (var i = 0, len = locations.length; i < len; i++) {\n        //     globe.computePointFromLocation(locations[i].latitude, locations[i].longitude, result);\n        //     var newX = result[0] * Math.cos(beta) * Math.cos(gama) +\n        //                result[1] * (Math.cos(beta) * (-Math.sin(gama))) +\n        //                result[2] * Math.sin(beta);\n        //\n        //     var newY = result[0] * ((-Math.sin(alpha)) * (-Math.sin(beta)) * (Math.cos(gama)) + Math.cos(alpha) * Math.sin(gama)) +\n        //                result[1] * ( (-Math.sin(alpha)) * (-Math.sin(beta)) * (-Math.sin(gama)) + Math.cos(alpha) * Math.cos(gama) ) +\n        //                result[2] * Math.sin(alpha) * Math.cos(beta);\n        //\n        //     var newZ = result[0] * (Math.cos(alpha) * (-Math.sin(beta)) * Math.cos(gama) + Math.sin(alpha) * Math.sin(gama)) +\n        //                result[1] * (Math.cos(alpha) * (-Math.sin(beta)) * (-Math.sin(gama)) + Math.sin(alpha) * Math.cos(gama)) +\n        //                result[2] * Math.cos(alpha) * Math.cos(beta);\n        //\n        //     globe.computePositionFromPoint(newX, newY, newZ, newPos);\n        //     newLocations.push(new Location(newPos.latitude, newPos.longitude));\n        // }\n\n        var delta_lat = newLocation.latitude - oldLocation.latitude;\n        var delta_long = newLocation.longitude - oldLocation.longitude;\n        var max = -90;\n        var min = 90;\n\n        for (var i = 0, len = locations.length; i < len; i++) {\n            var new_lat = locations[i].latitude + delta_lat;\n            var new_long = locations[i].longitude + delta_long;\n\n\n            if (new_lat > 90) {\n                new_lat = 180 - new_lat;\n                new_long += 180;\n            } else if (new_lat < -90) {\n                new_lat = -180 - new_lat;\n                new_long += 180;\n            }\n\n            if (new_long < -180) {\n                new_long += 360;\n            } else if (new_long > 180) {\n                new_long -= 360;\n            }\n\n\n            if (new_lat > max) {\n                max = new_lat;\n            }\n\n            if (new_lat < min) {\n                min = new_lat;\n            }\n\n            newLocations.push(new Location(new_lat, new_long));\n        }\n\n        if (max > 90) {\n            var delta = max - 90;\n            for (var i = 0, len = newLocations.length; i < len; i++) {\n                newLocations[i].latitude -= delta;\n            }\n        }\n    }\n\n    return newLocations;\n};\n\n\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.prepareSectors = function () {\n    this.determineSectors();\n    if (this.crossesAntiMeridian) {\n        this.sectorsOverAntiMeridian();\n    }\n    else {\n        this.sectorsNotOverAntiMeridian();\n    }\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.determineSectors = function () {\n    for (var i = 0, len = this.contours.length; i < len; i++) {\n        var contour = this.contours[i];\n        var polygons = contour.polygons;\n        contour.sectors = [];\n        for (var j = 0, lenP = polygons.length; j < lenP; j++) {\n            var polygon = polygons[j];\n            var sector = new Sector(0, 0, 0, 0);\n            sector.setToBoundingSector(polygon);\n            if (this._pathType === WorldWind.GREAT_CIRCLE) {\n                var extremes = Location.greatCircleArcExtremeLocations(polygon);\n                var minLatitude = Math.min(sector.minLatitude, extremes[0].latitude);\n                var maxLatitude = Math.max(sector.maxLatitude, extremes[1].latitude);\n                sector.minLatitude = minLatitude;\n                sector.maxLatitude = maxLatitude;\n            }\n            contour.sectors.push(sector);\n        }\n    }\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.sectorsOverAntiMeridian = function () {\n    var eastSector = new Sector(90, -90, 180, -180); //positive\n    var westSector = new Sector(90, -90, 180, -180); //negative\n    for (var i = 0, len = this.contours.length; i < len; i++) {\n        var sectors = this.contours[i].sectors;\n        for (var j = 0, lenS = sectors.length; j < lenS; j++) {\n            var sector = sectors[j];\n            if (sector.minLongitude < 0 && sector.maxLongitude > 0) {\n                westSector.union(sector);\n                eastSector.union(sector);\n            }\n            else if (sector.minLongitude < 0) {\n                westSector.union(sector);\n            }\n            else {\n                eastSector.union(sector);\n            }\n        }\n    }\n    var minLatitude = Math.min(eastSector.minLatitude, westSector.minLatitude);\n    var maxLatitude = Math.max(eastSector.maxLatitude, eastSector.maxLatitude);\n    this._sector = new Sector(minLatitude, maxLatitude, -180, 180);\n    this._sectors = [eastSector, westSector];\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.sectorsNotOverAntiMeridian = function () {\n    this._sector = new Sector(90, -90, 180, -180);\n    for (var i = 0, len = this.contours.length; i < len; i++) {\n        var sectors = this.contours[i].sectors;\n        for (var j = 0, lenS = sectors.length; j < lenS; j++) {\n            this._sector.union(sectors[j]);\n        }\n    }\n    this._sectors = [this._sector];\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.prepareGeometry = function (dc, contours) {\n    var interiorPolygons = [];\n    var outlinePolygons = [];\n\n    for (var i = 0, len = contours.length; i < len; i++) {\n        var contour = contours[i];\n        var poleIndex = contour.poleIndex;\n\n        for (var j = 0, lenC = contour.polygons.length; j < lenC; j++) {\n            var polygon = contour.polygons[j];\n            var iMap = contour.iMap[j];\n            interiorPolygons.push(polygon);\n\n            if (contour.pole !== Location.poles.NONE && lenC > 1) {\n                //split with pole\n                if (j === poleIndex) {\n                    this.outlineForPole(polygon, iMap, outlinePolygons);\n                }\n                else {\n                    this.outlineForSplit(polygon, iMap, outlinePolygons);\n                }\n            }\n            else if (contour.pole !== Location.poles.NONE && lenC === 1) {\n                //only pole\n                this.outlineForPole(polygon, iMap, outlinePolygons);\n            }\n            else if (contour.pole === Location.poles.NONE && lenC > 1) {\n                //only split\n                this.outlineForSplit(polygon, iMap, outlinePolygons);\n            }\n            else if (contour.pole === Location.poles.NONE && lenC === 1) {\n                //no pole, no split\n                outlinePolygons.push(polygon);\n            }\n        }\n    }\n\n    this._interiorGeometry = interiorPolygons;\n    this._outlineGeometry = outlinePolygons;\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.outlineForPole = function (polygon, iMap, outlinePolygons) {\n    this.containsPole = true;\n    var outlinePolygon = [];\n    var pCount = 0;\n    for (var k = 0, lenP = polygon.length; k < lenP; k++) {\n        var point = polygon[k];\n        var intersection = iMap.get(k);\n        if (intersection && intersection.forPole) {\n            pCount++;\n            if (pCount % 2 === 1) {\n                outlinePolygon.push(point);\n                outlinePolygons.push(outlinePolygon);\n                outlinePolygon = [];\n            }\n        }\n        if (pCount % 2 === 0) {\n            outlinePolygon.push(point);\n        }\n    }\n    if (outlinePolygon.length) {\n        outlinePolygons.push(outlinePolygon);\n    }\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.outlineForSplit = function (polygon, iMap, outlinePolygons) {\n    var outlinePolygon = [];\n    var iCount = 0;\n    for (var k = 0, lenP = polygon.length; k < lenP; k++) {\n        var point = polygon[k];\n        var intersection = iMap.get(k);\n        if (intersection && !intersection.forPole) {\n            iCount++;\n            if (iCount % 2 === 0) {\n                outlinePolygon.push(point);\n                outlinePolygons.push(outlinePolygon);\n                outlinePolygon = [];\n            }\n        }\n        if (iCount % 2 === 1) {\n            outlinePolygon.push(point);\n        }\n    }\n};\n\n// Internal use only. Intentionally not documented.\nSurfaceShape.prototype.resetPickColor = function () {\n    this.pickColor = null;\n};\n\n/**\n * Internal use only.\n * Render the shape onto the texture map of the tile.\n * @param {DrawContext} dc The draw context to render onto.\n * @param {CanvasRenderingContext2D} ctx2D The rendering context for SVG.\n * @param {Number} xScale The multiplicative scale factor in the horizontal direction.\n * @param {Number} yScale The multiplicative scale factor in the vertical direction.\n * @param {Number} dx The additive offset in the horizontal direction.\n * @param {Number} dy The additive offset in the vertical direction.\n */\nSurfaceShape.prototype.renderToTexture = function (dc, ctx2D, xScale, yScale, dx, dy) {\n    var attributes = (this._highlighted ? (this._highlightAttributes || this._attributes) : this._attributes);\n    var drawInterior = (!this._isInteriorInhibited && attributes.drawInterior);\n    var drawOutline = (attributes.drawOutline && attributes.outlineWidth > 0);\n\n    if (!drawInterior && !drawOutline) {\n        return;\n    }\n\n    if (dc.pickingMode && !this.pickColor) {\n        this.pickColor = dc.uniquePickColor();\n    }\n\n    if (dc.pickingMode) {\n        var pickColor = this.pickColor.toHexString();\n    }\n\n    if (this.crossesAntiMeridian || this.containsPole) {\n        if (drawInterior) {\n            this.draw(this._interiorGeometry, ctx2D, xScale, yScale, dx, dy);\n            ctx2D.fillStyle = dc.pickingMode ? pickColor : attributes.interiorColor.toRGBAString();\n            ctx2D.fill();\n        }\n        if (drawOutline) {\n            this.draw(this._outlineGeometry, ctx2D, xScale, yScale, dx, dy);\n            ctx2D.lineWidth = 4 * attributes.outlineWidth;\n            ctx2D.strokeStyle = dc.pickingMode ? pickColor : attributes.outlineColor.toRGBAString();\n            ctx2D.stroke();\n        }\n    }\n    else {\n        this.draw(this._interiorGeometry, ctx2D, xScale, yScale, dx, dy);\n        if (drawInterior) {\n            ctx2D.fillStyle = dc.pickingMode ? pickColor : attributes.interiorColor.toRGBAString();\n            ctx2D.fill();\n        }\n        if (drawOutline) {\n            ctx2D.lineWidth = 4 * attributes.outlineWidth;\n            ctx2D.strokeStyle = dc.pickingMode ? pickColor : attributes.outlineColor.toRGBAString();\n            ctx2D.stroke();\n        }\n    }\n\n    if (dc.pickingMode) {\n        var po = new PickedObject(this.pickColor.clone(), this.pickDelegate ? this.pickDelegate : this,\n            null, this.layer, false);\n        dc.resolvePick(po);\n    }\n};\n\nSurfaceShape.prototype.draw = function (contours, ctx2D, xScale, yScale, dx, dy) {\n    ctx2D.beginPath();\n    for (var i = 0, len = contours.length; i < len; i++) {\n        var contour = contours[i];\n        var point = contour[0];\n        var x = point.longitude * xScale + dx;\n        var y = point.latitude * yScale + dy;\n        ctx2D.moveTo(x, y);\n        for (var j = 1, lenC = contour.length; j < lenC; j++) {\n            point = contour[j];\n            x = point.longitude * xScale + dx;\n            y = point.latitude * yScale + dy;\n            ctx2D.lineTo(x, y);\n        }\n    }\n};\n\n/**\n * Default value for the maximum number of edge intervals. This results in a maximum error of 480 m for an arc\n * that spans the entire globe.\n *\n * Other values for this parameter have the associated errors below:\n * Intervals        Maximum error (meters)\n *      2           1280253.5\n *      4           448124.5\n *      8           120837.6\n *      16          30628.3\n *      32          7677.9\n *      64          1920.6\n *      128         480.2\n *      256         120.0\n *      512         30.0\n *      1024        7.5\n *      2048        1.8\n * The errors cited above are upper bounds and the actual error may be lower.\n * @type {Number}\n */\nSurfaceShape.DEFAULT_NUM_EDGE_INTERVALS = 128;\n\n/**\n * The defualt value for the polar throttle, which slows edge traversal near the poles.\n * @type {Number}\n */\nSurfaceShape.DEFAULT_POLAR_THROTTLE = 10;\n\nWorldWind.SurfaceShape = SurfaceShape;\n\nexport default SurfaceShape;","import WorldWind from 'webworldwind-esa';\nimport SurfaceShape from './SurfaceShape';\n\nconst {\n    DrawContext,\n    // SurfaceShape,\n} = WorldWind;\n\n/**\n * Determines whether a specified picked object is under the pick point, and if it is adds it to this draw\n * context's list of picked objects. This method should be called by shapes during ordered rendering\n * after the shape is drawn. If this draw context is in single-picking mode, the specified pickable object\n * is added to the list of picked objects whether or not it is under the pick point.\n * @param pickableObject\n * @returns {null}\n */\nDrawContext.prototype.resolvePick = function (pickableObject) {\n    if (!(pickableObject.userObject instanceof SurfaceShape) && this.deepPicking && !this.regionPicking) {\n        var color = this.readPickColor(this.pickPoint);\n        if (!color) { // getPickColor returns null if the pick point selects the clear color\n            return null;\n        }\n\n        if (pickableObject.color.equals(color)) {\n            this.addPickedObject(pickableObject);\n        }\n    } else {\n        // Don't resolve. Just add the object to the pick list. It will be resolved later.\n        this.addPickedObject(pickableObject);\n    }\n};","export default class FramebufferTexture {\n\n    constructor(textureId, width, height) {\n        this.textureId = textureId || null;\n        this.imageWidth = width;\n        this.imageHeight = height;\n        this.size = width * height * 4;\n        this.originalImageWidth = width;\n        this.originalImageHeight = height;\n        this.creationTime = new Date();\n    }\n\n    bind(dc) {\n        dc.currentGlContext.bindTexture(dc.currentGlContext.TEXTURE_2D, this.textureId);\n        dc.frameStatistics.incrementTextureLoadCount(1);\n        return true;\n    }\n\n    dispose(gl) {\n        gl.deleteTexture(this.textureId);\n        delete this.textureId;\n    }\n\n}\n","import FramebufferTexture from './FramebufferTexture';\n\nexport default class Framebuffer {\n\n    constructor() {\n        this.framebufferId = null;\n        this.textureId = null;\n        this.width = 0;\n        this.height = 0;\n        this.texture = null;\n    }\n\n    attachTexture(gl, width, height) {\n        this.textureId = this.createTexture(gl, width, height);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.textureId, 0);\n\n        /*const e = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n        if (e !== gl.FRAMEBUFFER_COMPLETE) {\n            console.log('bind Error creating framebuffer', e);\n            this.framebufferId = null;\n            this.textureId = null;\n            return false;\n        }*/\n\n        this.texture = new FramebufferTexture(this.textureId, width, height);\n\n        return true;\n    }\n\n    bind(gl, width, height) {\n        if(!this.framebufferId) {\n            this.framebufferId = gl.createFramebuffer();\n        }\n\n        this.width = width;\n        this.height = height;\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebufferId);\n        gl.viewport(0, 0, width, height);\n    }\n\n    bind_or(gl, width, height) {\n        /*if (!this.framebufferId) {\n            return false;\n        }*/\n\n        if(!this.framebufferId) {\n            this.framebufferId = gl.createFramebuffer();\n        }\n\n        this.width = width;\n        this.height = height;\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebufferId);\n        gl.viewport(0, 0, width, height);\n        this.textureId = this.createTexture(gl, width, height);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.textureId, 0);\n\n        /*const e = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n        if (e !== gl.FRAMEBUFFER_COMPLETE) {\n            console.log('bind Error creating framebuffer', e);\n            this.framebufferId = null;\n            this.textureId = null;\n            return false;\n        }*/\n\n        this.texture = new FramebufferTexture(this.textureId, width, height);\n\n        return true;\n    }\n\n    clear(gl) {\n        gl.clearColor(0, 0, 0, 0);\n        gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n\n    unbind(gl, fbo) {\n        if (!fbo) {\n            gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n            gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n        }\n        else {\n            gl.bindFramebuffer(gl.FRAMEBUFFER, fbo.framebufferId);\n            gl.viewport(0, 0, fbo.width, fbo.height);\n\n        }\n    }\n\n    createTexture(gl, width, height) {\n        if (width !== 256) {\n            console.log('width', width);\n        }\n        if (height !== 256) {\n            console.log('width', height);\n        }\n        const textureId = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, textureId);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n\n        /*var ext = (\n            gl.getExtension(\"EXT_texture_filter_anisotropic\") ||\n            gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\"));\n        if (ext) {\n            gl.texParameteri(gl.TEXTURE_2D, ext.TEXTURE_MAX_ANISOTROPY_EXT, 16);\n        }*/\n\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\n        //gl.generateMipmap(gl.TEXTURE_2D);\n        //gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, textureId, 0);\n        return textureId;\n    }\n\n}","import Framebuffer from '../framebuffer/Framebuffer';\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    ArgumentError,\n    Logger,\n    SurfaceShapeTileBuilder,\n    SurfaceShape,\n    PickedObject\n} = WorldWind;\n\nconst fboCacheKey = 'SurfaceShapeFBO';\n\nSurfaceShapeTileBuilder.prototype.buildTiles = function (dc) {\n    if (!dc) {\n        throw new ArgumentError(\n            Logger.logMessage(Logger.LEVEL_SEVERE, 'SurfaceShapeTileBuilder', 'buildTiles', 'missingDc'));\n    }\n\n    if (!this.surfaceShapes || this.surfaceShapes.length < 1) {\n        return;\n    }\n\n    // Assemble the current visible tiles and update their associated textures if necessary.\n    this.assembleTiles(dc);\n\n    if (SurfaceShapeTileBuilder.__fboBound__) {\n        const fbo = SurfaceShapeTileBuilder.getFbo(dc);\n        fbo.unbind(dc.currentGlContext, dc.currentFramebuffer);\n        SurfaceShapeTileBuilder.__fboBound__ = false;\n    }\n\n    // Clean up references to all surface shapes to avoid dangling references. The surface shape list is no\n    // longer needed, now that the shapes are held by each tile.\n    this.surfaceShapes.splice(0, this.surfaceShapes.length);\n    for (var idx = 0, len = this.surfaceShapeTiles.length; idx < len; idx += 1) {\n        var tile = this.surfaceShapeTiles[idx];\n        tile.clearShapes();\n    }\n};\n\n\nSurfaceShapeTileBuilder.prototype.addTile = function (dc, tile) {\n    if (dc.pickingMode) {\n        tile.pickSequence = SurfaceShapeTileBuilder.pickSequence;\n    }\n\n    if (tile.needsUpdate(dc)) {\n\n        const fbo = SurfaceShapeTileBuilder.getFbo(dc);\n        if (!SurfaceShapeTileBuilder.__fboBound__) {\n            fbo.bind(dc.currentGlContext, this.tileWidth, this.tileHeight);\n            SurfaceShapeTileBuilder.__fboBound__ = true;\n        }\n\n        tile.updateTexture(dc);\n    }\n\n    this.surfaceShapeTiles.push(tile);\n};\n\n\n/**\n * Perform the rendering of any accumulated surface shapes by building the surface shape tiles that contain these\n * shapes and then rendering those tiles.\n *\n * @param {DrawContext} dc The drawing context.\n */\nSurfaceShapeTileBuilder.prototype.doRender = function (dc) {\n    if (dc.pickingMode) {\n        // Picking rendering strategy:\n        //  1) save all tiles created prior to picking,\n        //  2) construct and render new tiles with pick-based contents (colored with pick IDs),\n        //  3) restore all prior tiles.\n        // This has a big potential win for normal rendering, since there is a lot of coherence\n        // from frame to frame if no picking is occurring.\n        for (var idx = 0, len = this.surfaceShapes.length; idx < len; idx += 1) {\n            this.surfaceShapes[idx].resetPickColor();\n        }\n\n        SurfaceShapeTileBuilder.pickSequence += 1;\n\n        var savedTiles = this.surfaceShapeTiles;\n        var savedTopLevelTiles = this.topLevelTiles;\n\n        this.surfaceShapeTiles = [];\n        this.topLevelTiles = [];\n\n        this.buildTiles(dc);\n\n        if (dc.deepPicking) {\n            // Normally, we render all shapes together in one tile (or a small number, but this detail\n            // doesn't matter). For deep picking, we need to render each shape individually.\n            this.doDeepPickingRender(dc);\n\n        } else {\n            dc.surfaceTileRenderer.renderTiles(dc, this.surfaceShapeTiles, 1);\n        }\n\n        this.surfaceShapeTiles = savedTiles;\n        this.topLevelTiles = savedTopLevelTiles;\n    } else {\n        this.buildTiles(dc);\n\n        dc.surfaceTileRenderer.renderTiles(dc, this.surfaceShapeTiles, 1);\n    }\n};\n\nSurfaceShapeTileBuilder.prototype.doDeepPickingRender = function (dc) {\n    var idxTile, lenTiles, idxShape, lenShapes, idxPick, lenPicks, po, shape, tile;\n\n    // Determine the shapes that were drawn during buildTiles. These shapes may not actually be\n    // at the pick point, but they are candidates for deep picking.\n    var deepPickShapes = [];\n    for (idxPick = 0, lenPicks = dc.objectsAtPickPoint.objects.length; idxPick < lenPicks; idxPick += 1) {\n        po = dc.objectsAtPickPoint.objects[idxPick];\n        if (po.userObject instanceof SurfaceShape) {\n            shape = po.userObject;\n\n            // If the shape was not already in the collection of deep picked shapes, ...\n            if (deepPickShapes.indexOf(shape) < 0) {\n                deepPickShapes.push(shape);\n\n                // Delete the shape that was drawn during buildTiles from the pick list.\n                dc.objectsAtPickPoint.objects.splice(idxPick, 1);\n\n                // Update the index and length to reflect the deletion.\n                idxPick -= 1;\n                lenPicks -= 1;\n            }\n        }\n    }\n\n    if (deepPickShapes.length <= 0) {\n        return;\n    }\n\n    // For all shapes,\n    //  1) force that shape to be the only shape in a tile,\n    //  2) re-render the tile, and\n    //  3) use the surfaceTileRenderer to render the tile on the terrain,\n    //  4) read the color to see if it is attributable to the current shape.\n    var resolvablePickObjects = [];\n    for (idxShape = 0, lenShapes = deepPickShapes.length; idxShape < lenShapes; idxShape += 1) {\n        shape = deepPickShapes[idxShape];\n\n        const fbo = SurfaceShapeTileBuilder.getFbo(dc);\n        if (!SurfaceShapeTileBuilder.__fboBound__) {\n            fbo.bind(dc.currentGlContext, this.tileWidth, this.tileHeight);\n            SurfaceShapeTileBuilder.__fboBound__ = true;\n        }\n\n        for (idxTile = 0, lenTiles = this.surfaceShapeTiles.length; idxTile < lenTiles; idxTile += 1) {\n            tile = this.surfaceShapeTiles[idxTile];\n            tile.setShapes([shape]);\n\n            tile.updateTexture(dc);\n        }\n\n        if (SurfaceShapeTileBuilder.__fboBound__) {\n            const fbo = SurfaceShapeTileBuilder.getFbo(dc);\n            fbo.unbind(dc.currentGlContext, dc.currentFramebuffer);\n            SurfaceShapeTileBuilder.__fboBound__ = false;\n        }\n\n        dc.surfaceTileRenderer.renderTiles(dc, this.surfaceShapeTiles, 1);\n\n        var pickColor = dc.readPickColor(dc.pickPoint);\n        if (!!pickColor && shape.pickColor.equals(pickColor)) {\n            po = new PickedObject(shape.pickColor.clone(),\n                shape.pickDelegate ? shape.pickDelegate : shape, null, shape.layer, false);\n            resolvablePickObjects.push(po);\n        }\n    }\n\n    // Flush surface shapes that have accumulated in the updateTexture pass just completed on all shapes.\n    for (idxPick = 0, lenPicks = dc.objectsAtPickPoint.objects.length; idxPick < lenPicks; idxPick += 1) {\n        po = dc.objectsAtPickPoint.objects[idxPick];\n        if (po.userObject instanceof SurfaceShape) {\n            // Delete the shape that was picked in the most recent pass.\n            dc.objectsAtPickPoint.objects.splice(idxPick, 1);\n\n            // Update the index and length to reflect the deletion.\n            idxPick -= 1;\n            lenPicks -= 1;\n        }\n    }\n\n    // Add the resolvable pick objects for surface shapes that were actually visible at the pick point\n    // to the pick list.\n    for (idxPick = 0, lenPicks = resolvablePickObjects.length; idxPick < lenPicks; idxPick += 1) {\n        po = resolvablePickObjects[idxPick];\n        dc.objectsAtPickPoint.objects.push(po);\n    }\n};\n\nSurfaceShapeTileBuilder.getFbo = function (dc) {\n    let fbo = dc.gpuResourceCache.resourceForKey(fboCacheKey);\n    if (!fbo) {\n        fbo = new Framebuffer();\n        dc.gpuResourceCache.putResource(fboCacheKey, fbo, 1);\n    }\n    return fbo;\n};\n\nSurfaceShapeTileBuilder.__frameStart__ = false;\nSurfaceShapeTileBuilder.__fboBound__ = false;","import Framebuffer from '../framebuffer/Framebuffer';\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    SurfaceShapeTile\n} = WorldWind;\n\nSurfaceShapeTile.prototype.updateTexture = function (dc) {\n    var gl = dc.currentGlContext;\n    // Mapping from lat/lon to x/y:\n    //  lon = minlon => x = 0\n    //  lon = maxLon => x = 256\n    //  lat = minLat => y = 256\n    //  lat = maxLat => y = 0\n    //  (assuming texture size is 256)\n    // So:\n    //  x = 256 / sector.dlon * (lon - minLon)\n    //  y = -256 / sector.dlat * (lat - maxLat)\n    var xScale = this.tileWidth / this.sector.deltaLongitude(),\n        yScale = -this.tileHeight / this.sector.deltaLatitude(),\n        xOffset = -this.sector.minLongitude * xScale,\n        yOffset = -this.sector.maxLatitude * yScale;\n\n    // Reset the surface shape state keys\n    this.asRenderedSurfaceShapeStateKeys = [];\n\n    var fbo = dc.gpuResourceCache.resourceForKey('SurfaceShapeFBO');\n    fbo.attachTexture(gl, this.tileWidth, this.tileHeight);\n    fbo.clear(gl);\n\n    for (var idx = 0, len = this.surfaceShapes.length; idx < len; idx += 1) {\n        var shape = this.surfaceShapes[idx];\n        this.asRenderedSurfaceShapeStateKeys.push(this.surfaceShapeStateKeys[idx]);\n\n        shape.renderToTexture(dc, fbo, xScale, yScale, xOffset, yOffset);\n    }\n\n    this.gpuCacheKey = this.getCacheKey();\n\n    var gpuResourceCache = dc.gpuResourceCache;\n    var texture = fbo.texture;\n    gpuResourceCache.putResource(this.gpuCacheKey, texture, texture.size);\n\n    return texture;\n};","import WorldWind from 'webworldwind-esa';\n\nconst {\n    TiledImageLayer\n} = WorldWind;\n\nvar index = 0;\n\nTiledImageLayer.prototype.retrieveTileImage = function (dc, tile, suppressRedraw) {\n    if (!this.pendingRequests) {\n        this.pendingRequests = [];\n    }\n    if (!this.MAX_REQUESTS) {\n        this.MAX_REQUESTS = 16;\n    }\n\n    const isBeingRetrieved = this.currentRetrievals.indexOf(tile.imagePath) >= 0;\n    if (isBeingRetrieved) {\n        return;\n    }\n\n    const isPending = this.pendingRequests.some(t => t.imagePath === tile.imagePath);\n    if (isPending) {\n        return;\n    }\n\n    if (this.absentResourceList.isResourceAbsent(tile.imagePath)) {\n        return;\n    }\n\n    const url = this.resourceUrlForTile(tile, this.retrievalImageFormat);\n    //const imagePath = tile.imagePath;\n\n    if (!url) {\n        this.currentTilesInvalid = true;\n        return;\n    }\n\n    /*this.pendingRequests.push(tile);\n    if (this.pendingRequests.length === 100) {\n        console.log('pendingRequests', this.pendingRequests.length, 'currentRetrievals', this.currentRetrievals.length);\n        //console.log('pendingRequests', this.pendingRequests.slice());\n\n        this.pendingRequests = this.pendingRequests.slice(80);\n\n        console.log('pendingRequests', this.pendingRequests.length, 'currentRetrievals', this.currentRetrievals.length);\n    }*/\n    if (this.pendingRequests.length === 20) {\n        //console.log(20);\n        this.pendingRequests.shift();\n    }\n    this.pendingRequests.push(tile);\n\n    if (this.currentRetrievals.length <= this.MAX_REQUESTS) {\n        this.fetchMoreImages(dc, this);\n    }\n};\n\nTiledImageLayer.prototype.fetchMoreImages = function (dc, layer) {\n    const before = layer.pendingRequests.length;\n    layer.pendingRequests = layer.pendingRequests.filter(pendingTile => layer.isTileVisible(dc, pendingTile));\n    if (!layer.pendingRequests.length) {\n        return;\n    }\n\n    const skip = before - layer.pendingRequests.length\n\n    //if (skip) console.log('skip tiles', skip);\n\n    var pendingTile = layer.pendingRequests.shift();\n    var imagePath = pendingTile.imagePath;\n    var url = layer.resourceUrlForTile(pendingTile, layer.retrievalImageFormat);\n\n    if (!imagePath || !url) {\n        return;\n    }\n\n    const cache = dc.gpuResourceCache;\n    //const layer = self;\n\n    layer.fetchImage(url, function (err, image) {\n        if (err) {\n            layer.removeFromCurrentRetrievals(imagePath);\n            layer.absentResourceList.markResourceAbsent(imagePath);\n\n            if (layer.currentRetrievals.length <= layer.MAX_REQUESTS) {\n                layer.fetchMoreImages(dc, layer);\n            }\n            return;\n        }\n\n        var texture = layer.createTexture(dc, null, image);\n        layer.removeFromCurrentRetrievals(imagePath);\n\n        if (texture) {\n            cache.putResource(imagePath, texture, texture.size);\n\n            layer.currentTilesInvalid = true;\n            layer.absentResourceList.unmarkResourceAbsent(imagePath);\n\n            var e = document.createEvent('Event');\n            e.initEvent(WorldWind.REDRAW_EVENT_TYPE, true, true);\n            window.dispatchEvent(e);\n        }\n\n        if (layer.currentRetrievals.length <= layer.MAX_REQUESTS) {\n            layer.fetchMoreImages(dc, layer);\n        }\n    });\n\n    layer.currentRetrievals.push(imagePath);\n};\n\nTiledImageLayer.prototype.fetchImage = function (url, cb) {\n    const image = new Image();\n\n    image.onload = function () {\n        cb(null, image);\n    };\n\n    image.onerror = function () {\n        cb(new Error('Image retrieval failed'), null);\n    };\n\n    image.crossOrigin = 'anonymous';\n\n    if (window.webkit) {\n        // url = '/proxy?url=' + encodeURIComponent(url);\n    }\n    else if (!window.webkit && !window.AndroidApp) {\n        // url = '/proxy?url=' + encodeURIComponent(url);\n    }\n\n    image.src = url;\n};\n\nTiledImageLayer.prototype.doRender_ = function (dc) {\n    if (!dc.terrain)\n        return;\n\n    if (this.currentTilesInvalid\n        || !this.lasTtMVP || !dc.navigatorState.modelviewProjection.equals(this.lasTtMVP)\n        || dc.globeStateKey !== this.lastGlobeStateKey) {\n        this.currentTilesInvalid = false;\n\n        this.assembleTiles(dc);\n\n        // Tile fading works visually only when the surface tiles are opaque, otherwise the surface flashes\n        // when two tiles are drawn over the same area, even though one of them is semi-transparent.\n        // So do not provide fading when the surface opacity is less than 1;\n        /*if (dc.surfaceOpacity >= 1 && this.opacity >= 1) {\n            // Fading of outgoing tiles requires determination of the those tiles. Prepare an object with all of\n            // the preceding frame's tiles so that we can subsequently compare the list of newly selected tiles\n            // with the previously selected tiles.\n            this.previousTiles = {};\n            for (var j = 0; j < this.currentTiles.length; j++) {\n                this.previousTiles[this.currentTiles[j].imagePath] = this.currentTiles[j];\n            }\n\n            this.assembleTiles(dc);\n            this.fadeOutgoingTiles(dc);\n        } else {\n            this.assembleTiles(dc);\n        }*/\n\n    }\n\n    this.lasTtMVP = dc.navigatorState.modelviewProjection;\n    this.lastGlobeStateKey = dc.globeStateKey;\n\n    //this.cleanCache(dc);\n\n    if (this.currentTiles.length > 0) {\n        dc.surfaceTileRenderer.renderTiles(dc, this.currentTiles, this.opacity, dc.surfaceOpacity >= 1);\n        dc.frameStatistics.incrementImageTileCount(this.currentTiles.length);\n        this.inCurrentFrame = true;\n    }\n};\n\nTiledImageLayer.prototype.cleanCache = function () {\n\n};","\nexport default {\n    'CHANGE_LANDSCAPE': 'CHANGE_LANDSCAPE',\n    'FOCUS_SATELLITE': 'FOCUS_SATELLITE',\n    'TOGGLE_LAYER': 'TOGGLE_LAYER',\n    'PREVENT_RELOAD_LAYERS': 'PREVENT_RELOAD_LAYERS',\n    'DEACTIVATE_LAYER': 'DEACTIVATE_LAYER',\n    'ACTIVATE_LAYER': 'ACTIVATE_LAYER',\n    'UPDATE_ACTIVE_LAYER': 'UPDATE_ACTIVE_LAYER',\n    'CHANGE_SELECTTIME': 'CHANGE_SELECTTIME',\n    'CHANGE_CURRENTTIME': 'CHANGE_CURRENTTIME',\n    'CHANGE_ACTIVE_TIME_LEVEL': 'CHANGE_ACTIVE_TIME_LEVEL',\n    'FOLLOW_NOW': 'FOLLOW_NOW',\n    'TRACK_TIME': 'TRACK_TIME',\n    'UPDATE_INFO_MODAL': 'UPDATE_INFO_MODAL',\n    'SET_ACTIVE_INFO_MODAL': 'SET_ACTIVE_INFO_MODAL',\n    'SET_ORBITS': 'SET_ORBITS',\n    'SET_ACQUISITION_PLANS': 'SET_ACQUISITION_PLANS',\n    'MAP_ADD_VISIBLE_ACQUISITION_PLAN': 'MAP_ADD_VISIBLE_ACQUISITION_PLAN',\n    'DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT': 'DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT',\n    'MAP_REMOVE_VISIBLE_ACQUISITION_PLAN': 'MAP_REMOVE_VISIBLE_ACQUISITION_PLAN',\n    'DATA_UPDATE_ACQUISITIONPLANS': 'DATA_UPDATE_ACQUISITIONPLANS',\n    'DATA': {\n        'SATELLITES': {\n            'SET_HEADING': 'DATA.SATELLITES.SET_HEADING',\n            'SET_HEADING_AND_UPDATE_VIEW_HEADING_CORRECTION': 'DATA.SATELLITES.SET_HEADING_AND_UPDATE_VIEW_HEADING_CORRECTION',\n        }\n    },\n    'COMPONENT': {\n        'SET': 'COMPONENT.SET',\n        'UPDATE': 'COMPONENT.UPDATE',\n        'CLEAR': 'COMPONENT.CLEAR',\n    },\n    'COMPONENTS' :{\n        'SEARCH': {\n            'SET_PRODUCTS': 'COMPONENTS.SEARCH.SET_PRODUCTS',\n        },\n        'SEARCH_TOOLBAR': {\n            'CLEAR': 'COMPONENTS.SEARCH_TOOLBAR.CLEAR',\n        }\n    },\n    'MAP': {\n        'SET_VIEW': 'MAP.SET_VIEW',\n        'UPDATE_VIEW': 'MAP.UPDATE_VIEW',\n        'SET_NAVIGATOR': 'MAP.SET_NAVIGATOR',\n        'REMOVE_STATISTICS_LAYER': 'REMOVE_STATISTICS_LAYER',\n        'ADD_STATISTICS_LAYER': 'ADD_STATISTICS_LAYER',\n        'UPDATE_STATISTICS': 'UPDATE_STATISTICS',\n        'UPDATE_VIEW_HEADING_CORRECTION_FROM_FOCUSED_SATELLITE': 'MAP.UPDATE_VIEW_HEADING_CORRECTION_FROM_FOCUSED_SATELLITE',\n    },\n}","import { createSelector } from 'reselect'\nimport {get} from 'lodash';\n\nconst getSubstate = createSelector([\n        state => state,\n        (state, substate) => substate,\n    ], (state, substate) => state[substate]\n)\n\nconst getByPath = createSelector([\n        state => state,\n        (state, path) => path,\n    ], (state, path) => get(state, path, null));\n\nconst getByKey = createSelector([\n        state => state,\n        (state, key) => key,\n    ], (state, key) => state[key]\n)\n\nexport default{\n    getSubstate,\n    getByPath,\n    getByKey,\n}","import common from '../_common';\n\nconst getSubstate = (state) => common.getByPath(state, ['data', 'satellites']);\nconst getSatelliteByKey = (state, satKey) => getSubstate(state).find(s => s.id === satKey);\n\nexport {\n    getSubstate,\n    getSatelliteByKey,\n}","import common from '../_common';\nimport { createSelector } from 'reselect'\nimport createCachedSelector from 're-reselect'\n\nconst getViewKey = (view) => {\n    return `${view.center.lon}${view.center.lat}${view.center.altitude}${view.boxRange}${view.heading}${view.headingCorrection}${view.roll}${view.tilt}`\n} \n\n\nconst getSubstate = (state) => common.getByPath(state, ['map']);\nconst getVisibleAcquisitionsPlans = createSelector([getSubstate],(substate) => substate.acquisitionPlans);\nconst getVisibleStatistics = createSelector([getSubstate],(substate) => substate.statistics.map(s => s.key));\nconst getLoadingStatistics = createSelector([getSubstate],(substate) => substate.statistics.filter(s => s.loading));\nconst isVisibleAcquisitionPlanByKey = (state, key) => {\n    const acquisitionsPlans = getVisibleAcquisitionsPlans(state);\n    return acquisitionsPlans && acquisitionsPlans.includes(key);\n};\n\nconst isVisibleStatisticsByKey = (state, key) => {\n    const statistics = getVisibleStatistics(state);\n    return statistics && statistics.includes(key);\n};\n\nconst getView = createCachedSelector([state => state],(state) => {\n    const view = getSubstate(state)['view'];\n    const validHeadingCorrection = view.hasOwnProperty('headingCorrection') && (view.headingCorrection >= 0 || view.headingCorrection <= 0)\n    const validHeading = view.hasOwnProperty('heading') && (view.heading >= 0 || view.heading <= 0)\n\n    if(validHeadingCorrection && validHeading) {\n        return {\n            ...view,\n            heading: view.heading - view.headingCorrection\n        }\n    } else {\n        return view;\n    }\n})((state) => {\n    const view = getSubstate(state)['view'];\n    const viewKey = getViewKey(view);\n    return viewKey;\n    \n})\n\nconst getPureView = (state) => getSubstate(state)['view'];\n\nexport {\n    getSubstate,\n    getView,\n    getPureView,\n    getVisibleAcquisitionsPlans,\n    getVisibleStatistics,\n    getLoadingStatistics,\n    isVisibleAcquisitionPlanByKey,\n    isVisibleStatisticsByKey,\n}","import common from '../_common';\nimport createCachedSelector from 're-reselect';\n\nconst getSubstate = (state) => common.getByPath(state, ['data', 'layers']);\nconst getByKey = createCachedSelector([\n    state => state,\n    (state, key) => key\n], (state, key) => common.getByKey(state, key))((state, key) => key);\n\nexport {\n    getSubstate,\n    getByKey,\n}","import common from '../_common';\nimport moment from 'moment';\nimport { createSelector } from 'reselect'\n\n\nconst getSubstate = (state) => common.getByPath(state, ['data', 'acquisitionPlans']);\n\nconst getDateString = (date) => moment(date).format('YYYYMMDD');\n\n/**\n * \n * @param {Array.<object>} aps \n * @param {string} dateString - Date string like \"20190405\"\n */\nconst apsForTime = (aps, dateString) => {\n    const startDate = aps.start;\n    const endDate = aps.end;\n\n    const start = dateString;\n    const end = dateString;\n\n    const fullyInside = startDate > start && endDate < end;\n    const partiallyBefore = startDate < start && endDate > start;\n    const partiallyAfter = startDate < end && endDate > end;\n    \n    return fullyInside || partiallyBefore || partiallyAfter;\n}\n\n/**\n * @param {Date} date - Date string like \"20190405\"\n */\nconst getPlansForDate = createSelector([\n    getSubstate,\n    (state, date) => date\n], (substate, date) => {\n    const dateString = getDateString(date);\n    \n    if(substate && substate.length) {\n        return substate.map(satAps => {\n            return {\n                ...satAps,\n                plans:  satAps.plans.filter(aps => apsForTime(aps, dateString))\n            }\n        })\n    } else {\n        return [];\n    }\n})\n\nconst getLoadingAcquisitionsPlans = createSelector(\n    [\n        getSubstate\n    ],\n    (substate) => {\n    if(substate && substate.length) {\n        return substate.reduce((acc, satAps) => {\n            const loadingPlans = satAps.plans.reduce((acc, plan) => {\n                if(plan.loading) {\n                    return [...acc, plan];\n                } else {\n                    return acc;\n                }\n            }, []);\n\n            if(loadingPlans && loadingPlans.length > 0) {\n                return [...acc, {key: satAps.key, plans: loadingPlans}]\n            } else {\n                return acc;\n            }\n        }, [])\n    } else {\n        return [];\n    }\n\n})\n\nexport {\n    getSubstate,\n    getPlansForDate,\n    getLoadingAcquisitionsPlans,\n}","import common from '../_common';\nimport createCachedSelector from 're-reselect';\n\nconst getSubstate = (state) => common.getByPath(state, ['data', 'orbits']);\nconst getByKey = (state, key) => getSubstate(state).find(o => o.key === key);\n\nexport {\n    getSubstate,\n    getByKey,\n}","import { createSelector } from 'reselect'\nimport moment from 'moment';\nimport common from '../_common';\nimport {getCurrentTime} from '../rootSelectors';\n\n// export const addItemToIndex = (array, index, item) => [...array.slice(0, index), item, ...array.slice(index)];\n// export const removeItemByIndex = (array, index) => [...array.slice(0, index), ...array.slice(index + 1)];\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'search']);\nconst getActiveResultIndex = (state) => common.getByPath(state, ['components', 'search', 'activeResultIndex']);\nconst getResults = (state) => common.getByPath(state, ['components', 'search', 'results']);\nconst getFilterTime = (state) => common.getByPath(state, ['components', 'search', 'filterTime']);\n\nconst getSearchLayer = (state) => {\n    const activeResultIndex = getActiveResultIndex(state);\n    const results = getResults(state);\n    if(Number.isInteger(activeResultIndex) && results && results.length > 0 && activeResultIndex <= results.length) {\n        return results[activeResultIndex];\n    } else {\n        return null;\n    }\n}\n\nexport {\n    getActiveResultIndex,\n    getFilterTime,\n    getResults,\n    getSubstate,\n    getSearchLayer,\n}","const getSatAPSUrl = (satKey) => `https://eoapps.solenix.ch/aps/${satKey}/`;\nconst getSatIntervalAPSUrl = (satKey, start, end) => `https://eoapps.solenix.ch/aps/${satKey}/${satKey.toUpperCase()}_${start}_${end}.kml`;\n// const satellites = ['s1a', 's1b', 's2a', 's2b', 's3a', 's3b', 's5p'];\nconst satellites = ['s1a', 's1b', 's2a', 's2b'];\n//cache tle in Map\nconst cache = new Map();\n\nexport const getPlanKey = (aps) => aps ? `${aps.start}_${aps.end}` : '';\nexport const getPlansKeys = (aps) => aps && aps.length ? aps.map(a => getPlanKey(a)).join('') : '';\n\nconst parseAPSfiles = (result, satKey) => {\n        const kmls = result.split('\\n');\n\n        return kmls.reduce((acc, kmlName) => {\n            if (kmlName === '') {\n                return acc;\n            } else {\n                let kml = kmlName.replace('.kml', '').split('_');\n                return [...acc, {\n                    start: kml[1],\n                    end: kml[2],\n                    name: kmlName,\n                    satName: satKey,\n                    url: getSatIntervalAPSUrl(satKey, kml[1], kml[2]),\n                }];\n            }\n        }, [])\n}\n\n/**\n * @param {string} satKey - Satellite key for acquisition plans\n */\nexport const getAcquisitionPlans = async (satKey) => {\n    \n    let aps = null;\n\n    if(cache.has(satKey)) {\n        aps = cache.get(satKey);\n        //check if aps is Promise\n        if(aps && typeof aps.then == 'function') {\n            aps = await aps;\n            return aps;\n        } else {\n            return aps;\n        }\n    } else {\n        const request = fetch(getSatAPSUrl(satKey)).then(response => response.text()).then(text => parseAPSfiles(text, satKey));\n        cache.set(satKey, request);\n        return await request;\n    }\n}\n\nexport const getAllAcquisitionPlans = async () => {\n    return await Promise.all(\n        satellites.map(async (satKey) => {\n            const aps = await getAcquisitionPlans(satKey);\n            return {\n                key: satKey,\n                plans: aps,\n            }\n        })\n    );\n};","import WorldWind from 'webworldwind-esa';\nconst {\n    Color\n} = WorldWind;\n\nexport const getSwathKeysFromAPS = (aps) => aps && aps.length ? aps.map(a => `swath_${a.start}_${a.end}`).join('') : '';\n\nexport const getSwathKey = (swathCfg) => {\n    //identify swath for past or current future\n    if(swathCfg && swathCfg.apsIDKey) {\n        return swathCfg.apsIDKey;\n    } else if(swathCfg && swathCfg.sentinelLayerKey) {\n        return `swath-${swathCfg.sentinelLayerKey}-${swathCfg.satName}`\n    }\n};\n\nconst satellitesSwathColors = {\n    s1a: {\n        IW: 'FF0000FF',\n        EW: 'FF00FF00',\n        SM: 'FF000000',\n        WV: 'FFFFFFFF',\n        RFC: 'FF000000'\n    },\n    s1b: {\n        IW: 'FF0000FF',\n        EW: 'FF00FF00',\n        SM: 'FF000000',\n        WV: 'FFFFFFFF',\n        RFC: 'FF000000'\n    },\n    s2a: {\n        'DARK-O': '407f7f7f',\n        NOBS: '4000ff00',\n        VIC: 'ffff00ff'\n    },\n    s2b: {\n        DARK: '407f7f7f',\n        NOBS: '40ffff00',\n        VIC: '40ff00ff'\n    },\n    s3a: {\n        \"Earth Observation\": 'FF0000FF',\n    },\n    s3b: {\n        \"Earth Observation\": 'FF0000FF',\n    }\n}\n\nexport const getColorForSatType = (satKey, swatMode) => {\n    const hex = satellitesSwathColors[satKey][swatMode];\n    return Color.colorFromKmlHex(hex);\n}","\n/**\n * Compare release date from satData to given date. If date of release is before given date, then return true.\n * @param {Object} satellite Satellite data for questioned satellite\n * @param {Date} date Date that is compared\n */\nconst isSatelliteReleaseBeforeDate = (satellite, date) => {\n    return satellite.satData.launchDate.getTime() < new Date(date).getTime();\n}\n\n/**\n * Find satellite by given orbit by orbit key, then check if is satellite released.\n * @param {Object} orbit Orbit of questioned satellite\n * @param {Array.<Object>} satellites Array of satellite data \n * @param {Date} date Date that is compared\n */\nconst filterByReleasedSatellite = (orbit, satellites, date) => {\n    const satKey = orbit.key.split(\"orbit-\")[1];\n    const satellite = satellites.find((s) => s.id === satKey);\n    return isSatelliteReleaseBeforeDate(satellite, date);\n};\n\nconst filterByActiveSatellite = (orbit, activeSatelliteKey) => {\n    if(activeSatelliteKey) {\n        const satKey = orbit.key.split(\"orbit-\")[1];\n        return satKey === activeSatelliteKey;\n    } else {\n        return true;\n    }\n};\n\nexport default {\n    isSatelliteReleaseBeforeDate,\n    filterByReleasedSatellite,\n    filterByActiveSatellite,\n}","import WorldWind from 'webworldwind-esa';\nconst {\n    Color\n} = WorldWind;\n\nconst satData = [\n    {\n        key: 's1a',\n        name: 'SENTINEL-1A',\n        shortName: 'S-1A',\n        satIndex: 0,\n        swathTypes: ['black', 'red', 'green', 'white'],\n        swathColors: [\n            Color.colorFromKmlHex('ff000000'), //black\n            Color.colorFromKmlHex('ff0000ff'), //red\n            Color.colorFromKmlHex('ff00ff00'), //green\n            Color.colorFromKmlHex('ffffffff')  //white\n        ],\n        swatModes: ['IW', 'EW', 'SM'],\n        tleLineOne: '1 39634U 14016A   18124.03591006  .00000001  00000-0  10014-4 0  9998',\n        tleLineTwo: '2 39634  98.1819 132.0838 0001369  78.7198 281.4156 14.59198520217480',\n        hasModel: true,\n        filePath: 'satellites/sentinel1/',\n        fileName: 's1.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 500000,\n        translations: {\n            x: -0.1,\n            y: -0.1,\n            z: 0\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2014-04-03T21:02:00.000Z'),\n    },\n    {\n        key: 's2a',\n        name: 'SENTINEL-2A',\n        shortName: 'S-2A',\n        satIndex: 1,\n        swathTypes: ['red', 'purple', 'white', 'darkGrey', 'green', 'greener'],\n        swathColors: [\n            Color.colorFromKmlHex('ff0000ff'), //red\n            Color.colorFromKmlHex('ffff00ff'), //purple\n            Color.colorFromKmlHex('ffffffff'), //white\n            Color.colorFromKmlHex('ff7f7f7f'), //dark grey\n            Color.colorFromKmlHex('ff00ff00'),  //green\n            Color.colorFromKmlHex('ff00fff7')  //greener\n        ],\n        swatModes: ['NOBS'],\n        tleLineOne: '1 40697U 15028A   18124.08865983  .00000004  00000-0  17994-4 0  9993',\n        tleLineTwo: '2 40697  98.5686 199.4434 0001286  92.5669 267.5666 14.30817033149583',\n        hasModel: true,\n        filePath: 'satellites/senti2version6/',\n        fileName: 's2.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 1000000,\n        translations: {\n            x: 0.1,\n            y: 0.385,\n            z: 0.02\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2015-06-23T01:52:00.000Z'),\n    },\n    {\n        key: 's3a',\n        name: 'SENTINEL-3A',\n        shortName: 'S-3A',\n        satIndex: 2,\n        tleLineOne: '1 41335U 16011A   18124.14356592 -.00000000  00000-0  18017-4 0  9998',\n        tleLineTwo: '2 41335  98.6266 192.0005 0001035 100.1921 259.9376 14.26736754115121',\n        hasModel: true,\n        filePath: 'satellites/Sentinel3/',\n        fileName: 's3.json',\n        rotations: {\n            x: 0, //0\n            y: 0, //180\n            z: 0, //165\n            headingAxis: [0, 0, 1], //0,0,1\n            headingAdd: 180, //-20\n            headingMultiply: 1 //1\n        },\n        preRotations: {\n            x: 0,\n            y: 180,\n            z: 0\n        },\n        scale: 1000000,\n        translations: {\n            x: 0.01, //-0.01\n            y: 1.98, //1.9\n            z: 0.07 //-0.07\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2016-02-16T17:57:00.000Z'),\n    },\n    {\n        key: 's1b',\n        name: 'SENTINEL-1B',\n        shortName: 'S-1B',\n        satIndex: 3,\n        swathTypes: ['black', 'red', 'green', 'white'],\n        swathColors: [\n            Color.colorFromKmlHex('ff000000'), //black\n            Color.colorFromKmlHex('ff0000ff'), //red\n            Color.colorFromKmlHex('ff00ff00'), //green\n            Color.colorFromKmlHex('ffffffff')  //white\n        ],\n        swatModes: ['IW', 'EW', 'SM'],\n        tleLineOne: '1 41456U 16025A   18124.13828432 -.00000022  00000-0  49756-5 0  9992',\n        tleLineTwo: '2 41456  98.1817 132.0102 0001487  82.9964 277.1419 14.59197806107664',\n        hasModel: true,\n        filePath: 'satellites/sentinel1/',\n        fileName: 's1.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 500000,\n        translations: {\n            x: -0.1,\n            y: -0.1,\n            z: 0\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2016-04-25T21:02:00.000Z'),\n    },\n    {\n        key: 's2b',\n        name: 'SENTINEL-2B',\n        shortName: 'S-2B',\n        satIndex: 4,\n        swathTypes: ['blue'],\n        swathColors: [\n            Color.colorFromKmlHex('ffffff00'),\n        ],\n        swatModes: ['NOBS'],\n        tleLineOne: '1 42063U 17013A   18124.12358125  .00000002  00000-0  17497-4 0  9994',\n        tleLineTwo: '2 42063  98.5687 199.4702 0001382  97.5073 262.6270 14.30817718 60503',\n        groundPosition: {latitude: 5.2079, longitude: -52.7724, altitude: 0},\n        hasModel: true,\n        filePath: 'satellites/senti2version6/',\n        fileName: 's2.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 1000000,\n        translations: {\n            x: 0.1,\n            y: 0.385,\n            z: 0.02\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2017-03-07T01:49:00.000Z'),\n    },\n    {\n        key: 's5p',\n        name: 'SENTINEL-5P',\n        shortName: 'S-5P',\n        satIndex: 5,\n        swathTypes: [],\n        swathColors: [],\n\n        tleLineOne: '1 42969U 17064A   18123.85141871 -.00000009  00000-0  16636-4 0  9994',\n        tleLineTwo: '2 42969  98.7352  64.1585 0001101  78.1817 281.9482 14.19565315 28712',\n\n        groundPosition: {latitude: 62.927860, longitude: 40.574830, altitude: 0},\n        hasModel: true,\n        filePath: 'satellites/sentinel5p/',\n        fileName: 's5p.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 180 + 30,\n            y: 0,\n            z: 0\n        },\n        scale: 70000,\n        translations: {\n            x: 0.5,\n            y: 0.4,\n            z: -1.2\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2017-10-13T09:27:00.000Z'),\n    },\n    {\n        key: 's3b',\n        name: 'SENTINEL-3B',\n        shortName: 'S-3B',\n        satIndex: 6,\n        tleLineOne: '1 43437U 18039A   18122.61596633  .00002473  00000-0  10753-2 0  9999',\n        tleLineTwo: '2 43437  98.6226 190.4610 0008811 292.4467  67.5830 14.24954518   977',\n        groundPosition: {\n            latitude: 62.925556,\n            longitude: 40.577778,\n            altitude: 0,\n        },\n        hasModel: true,\n        filePath: 'satellites/Sentinel3/',\n        fileName: 's3.json',\n        rotations: {\n            x: 0, //0\n            y: 0, //180\n            z: 0, //165\n            headingAxis: [0, 0, 1], //0,0,1\n            headingAdd: 180, //-20\n            headingMultiply: 1 //1\n        },\n        preRotations: {\n            x: 0,\n            y: 180,\n            z: 0\n        },\n        scale: 1000000,\n        translations: {\n            x: 0.01, //-0.01\n            y: 1.98, //1.9\n            z: 0.07 //-0.07\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2018-04-25T17:57:00.000Z'),\n    },\n];\n\nexport const getSatDataByKey = (satKey) => {\n    return satData.find((s) => s.key === satKey);\n};\nexport const getDefaultSatOrbitBySatKey = (satKey) => {\n    const sat = getSatDataByKey(satKey);\n    // const launchDate = `${sat.launchDate.getUTCFullYear()}-${sat.launchDate.getUTCMonth()}-${sat.launchDate.getUTCDate()}`\n    return {\n        // key: `${satKey}-${launchDate}`,\n        key: `orbit-${satKey}`,\n        specs: [\n            sat.tleLineOne,\n            sat.tleLineTwo,\n        ]\n    }\n};\n\nexport default satData;","import createCachedSelector from 're-reselect';\nimport { createSelector } from 'reselect'\nimport momentjs from 'moment';\nimport common from './_common';\nimport {getSubstate as getOrbitsSubstate} from './data/orbits';\nimport {getSubstate as getSatellitesSubstate} from './data/satellites';\nimport {getSearchLayer} from './components/search';\nimport {getSubstate as getAcquisitionPlansSubstate, getPlansForDate} from './data/acquisitionPlans';\nimport {getVisibleAcquisitionsPlans, getVisibleStatistics} from './map';\nimport {getPlansKeys} from '../../utils/acquisitionPlans';\nimport {getSwathKeysFromAPS} from '../../utils/swath';\nimport satellitesUtils from '../../utils/satellites';\nimport {getSatDataByKey} from '../satData';\nexport const getSelectTimePastOrCurrent = (state) => common.getByPath(state, ['selectTimePastOrCurrent']);\n\nexport const getCurrentTime = createCachedSelector(\n    (state) => common.getByPath(state, ['currentTime']),\n    (currentTime) => currentTime\n)((state) => common.getByPath(state, ['currentTime']))\n\nexport const getPreventReloadLayers = (state) => common.getByPath(state, ['preventReloadLayers']);\nexport const getActiveInfoModalKey = (state) => common.getByPath(state, ['infoModal', 'active']);\nexport const getInfoModal = (state, infoModalKey) => common.getByPath(state, ['infoModal', infoModalKey]);\n\nexport const getSelectTime = createCachedSelector(\n    (state) => common.getByPath(state, ['selectTime']),\n    (selectTime) => {\n        return new Date(selectTime)\n    }\n)((state) => {\n    const key = common.getByPath(state, ['selectTime'])\n    return key;\n})\n\n//round time on minutes to prevent rerender on every second?\nexport const getBeginDataTime = createCachedSelector(\n    getSelectTime,\n    (selectTime) => {\n        const beginDataTime = momentjs(selectTime).subtract(5, 'minutes').toDate().toString();\n        return beginDataTime;\n    }\n)((state) => {\n    const selectTime = getSelectTime(state);\n    const cacheKey = momentjs(selectTime).subtract(5, 'minutes').toDate().toString();\n    return cacheKey;\n\n})\n\nexport const getPureActiveLayers = createCachedSelector(\n    (state) => common.getByPath(state, ['activeLayers']),\n    (activeLayers) => {\n        return activeLayers\n    }\n)((state) => {\n    const activeLayers = common.getByPath(state, ['activeLayers'])\n    const cacheKey = activeLayers ? activeLayers.map(l => `${l.layerKey}${l.satKey}`).join(',') : 'null';\n    return cacheKey;\n})\n\nexport function getFollowNow (state)  {return common.getByPath(state, ['followNow'])};\n\nexport function getTrackTimeActive (state)  {return common.getByPath(state, ['trackTime'])};\n\nexport function getPeriodLimit (state)  {return common.getByPath(state, ['periodLimit'])};\n\nexport function getLandscape (state)  {return common.getByPath(state, ['landscape'])};\n\nexport function getFocusedSatellite (state)  {return common.getByPath(state, ['focus'])};\n\n//round time on minutes to prevent rerender on every second?\n\nconst getBeginTime = (selectTime, productsTimeWindow) => {\n    return momentjs(selectTime).subtract(productsTimeWindow, 'millisecond').toDate();\n}\n\n\nconst getSatelliteForLayer = (satellitesSubstate, satKey) => {\n    const salellite = satellitesSubstate.find(s => s.id === satKey);\n    return salellite || null;\n}\n\nconst getOrbitForLayer = (orbitsSubstate, orbitKey) => {\n    const orbit = orbitsSubstate.find(o => o.key === orbitKey);\n    return (orbit && orbit.specs) || null;\n}\n\nexport const getActiveSatProductsPairs = createCachedSelector([getPureActiveLayers], (activeLayers) => {\n    const activeLayersPairs = activeLayers ? activeLayers.map(l => [l.satKey, l.layerKey]) : [];\n    const mergedBySatellite = activeLayersPairs.reduce((acc, value) => {\n        const sat = value[0];\n        const layerKey = value[1];\n        if(acc.hasOwnProperty(sat)) {\n            return {...acc, [sat]: [...acc[sat], layerKey]};\n        } else {\n            return {...acc, [sat]: [layerKey]};\n        }\n    }, {})\n\n    return Object.entries(mergedBySatellite);\n})((state) => {\n    const activeLayers = getPureActiveLayers(state);\n    const activeLayersPairs = activeLayers ? activeLayers.map(l => `${l.satKey}-${l.layerKey}`) : [];\n    \n    return activeLayersPairs.join(',');\n});\n\nexport const getActiveLayers = createCachedSelector(\n    getPureActiveLayers,\n    getSelectTimePastOrCurrent,\n    getOrbitsSubstate,\n    getSatellitesSubstate,\n    getPlansForDate,\n    getVisibleAcquisitionsPlans,\n    getVisibleStatistics,\n    (state, selectTime) => selectTime,\n    getFocusedSatellite,\n    getSearchLayer,\n    (activeLayers, selectTimePastOrCurrent, orbitsSubstate, satellitesSubstate, acquisitionPlans, visibleAcquisitionsPlans, visibleStatistics, selectTime, focusedSatellite, searchLayer) => {\n    const activeSentinelLayers = [];\n    activeLayers.forEach(l => {\n        const satData = getSatDataByKey(l.satKey);\n        const layer = {...l,\n            type: 'sentinelData',\n            beginTime: getBeginTime(selectTime, getSatelliteForLayer(satellitesSubstate, l.satKey).productsTimeWindow),\n            endTime: selectTime,\n            disabled: selectTimePastOrCurrent || !satellitesUtils.isSatelliteReleaseBeforeDate({satData}, selectTime),\n            satData,\n        }\n        activeSentinelLayers.push(layer);\n    });\n\n    //search layer\n    const searchLayers = [];\n    if(searchLayer) {\n        searchLayers.push({\n            type: 'sentinelFootprint',\n            results: [searchLayer],\n        });\n    }\n\n    const orbitLayers = orbitsSubstate.filter((o) =>\n        satellitesUtils.filterByReleasedSatellite(o, satellitesSubstate, selectTime)\n        ).filter((o) =>\n            satellitesUtils.filterByActiveSatellite(o, focusedSatellite)\n        ).map(o => ({...o, type: 'orbit'}));    \n\n    const satellitesLayers = satellitesSubstate.filter((s) => satellitesUtils.isSatelliteReleaseBeforeDate(s, selectTime)).map(s => (\n        {\n            type: 'satellite',\n            key: s.id,\n            name: s.name,\n            model: s.model,\n            satData: s.satData,\n            time: selectTime,\n            tle: getOrbitForLayer(orbitsSubstate, `orbit-${s.id}`)\n        }\n    ));\n\n    let acquisitionPlanLayers = [];\n    \n    //todo filter by visible APS data\n\n    if(selectTimePastOrCurrent) {\n        acquisitionPlanLayers = acquisitionPlans.filter(p => visibleAcquisitionsPlans.includes(p.key)).map(aps => (\n            {\n                type: 'acquisitionPlan',\n                key:`acquisitionPlans_${aps.key}`,\n                name: aps.key,\n                plans: aps.plans,\n                selectTime,\n                satName: aps.key,\n                tle: getOrbitForLayer(orbitsSubstate, `orbit-${aps.key}`),\n                range: getSatelliteForLayer(satellitesSubstate, aps.key).acquisitionPlanTimeWindow\n            }\n        ));    \n    };\n\n\n    let swathLayers = [];\n    //take settings from acquisitions plans in future\n    if(selectTimePastOrCurrent) {\n        for (const acqPlanLayerConfig of acquisitionPlanLayers) {\n            swathLayers.push({\n                type: 'swath',\n                key:`swath_${acqPlanLayerConfig.key}`,\n                apsKey:`${acqPlanLayerConfig.key}`,\n                apsIDKey: getPlansKeys(acqPlanLayerConfig.plans),\n                // name: aps.key,\n                // plans: aps.plans,\n                // selectTime,\n                satName: acqPlanLayerConfig.satName,\n                tle: getOrbitForLayer(orbitsSubstate, `orbit-${acqPlanLayerConfig.satName}`),\n                // range: getSatelliteForLayer(satellitesSubstate, aps.key).acquisitionPlanTimeWindow\n            })\n        }\n    } else {\n        //if visible sentinelLayer for each add swath layer\n        activeSentinelLayers.forEach((sentinelLayer) => {\n            if(sentinelLayer.totalCount > 0) {\n                swathLayers.push({\n                    type: 'swath',\n                    key:`swath_${sentinelLayer.satKey}_${sentinelLayer.layerKey}`,\n                    sentinelLayerKey: sentinelLayer.layerKey,\n                    satName: sentinelLayer.satKey,\n                    tle: getOrbitForLayer(orbitsSubstate, `orbit-${sentinelLayer.satKey}`),\n                })\n            }\n        })\n    }\n\n    let statisticsLayers = [];\n    statisticsLayers = visibleStatistics.map(s => (\n        {\n            type: 'statistics',\n            key:`statistics_${s}`,\n            sensornames: [getSatelliteForLayer(satellitesSubstate, s).statisticsKey],\n            name: s,\n            selectTime,\n            satName: s,\n        }))\n    return [...activeSentinelLayers, ...searchLayers, ...orbitLayers, ...satellitesLayers, ...acquisitionPlanLayers, ...swathLayers, ...statisticsLayers];\n})((state, selectTime) => {\n    const stringSelectTime = selectTime ? selectTime.toString() : '';\n    const activeLayers = common.getByPath(state, ['activeLayers']);\n    const orbitSubstate = getOrbitsSubstate(state);\n    const satellitesSubstate = getSatellitesSubstate(state);\n    const endTime = selectTime;\n    const selectTimePastOrCurrent = getSelectTimePastOrCurrent(state);\n    const acquisitionPlans = getPlansForDate(state, selectTime);\n    const visibleAcquisitionsPlans = getVisibleAcquisitionsPlans(state);\n    const visibleStatistics = getVisibleStatistics(state);\n    let acquisitionPlanLayers = '';\n    if(selectTimePastOrCurrent){\n        acquisitionPlanLayers = getPlansKeys(acquisitionPlans.filter(p => visibleAcquisitionsPlans.includes(p.key)));\n    };\n\n    let swathLayers = '';\n    if(selectTimePastOrCurrent){\n        swathLayers = getSwathKeysFromAPS(acquisitionPlans.filter(p => visibleAcquisitionsPlans.includes(p.key)));\n    } else {\n        swathLayers = activeLayers.map(l => `swath-${l.layerKey}${l.satKey}${getBeginTime(selectTime, getSatelliteForLayer(satellitesSubstate, l.satKey).productsTimeWindow)}${endTime}`).join(',');\n    };\n    \n    let statisticsLayers = '';\n    statisticsLayers = visibleStatistics.join(',');\n\n    const orbitKeys = orbitSubstate.map(l => l.key).join(',');\n    const satellitesKeys = satellitesSubstate.map(s => s.id).join(',');\n    const activeLayersKeys = activeLayers.map(l => `${l.layerKey}${l.satKey}${getBeginTime(selectTime, getSatelliteForLayer(satellitesSubstate, l.satKey).productsTimeWindow)}${endTime}`).join(',');\n    const cacheKey = `pastOrcurrent${selectTimePastOrCurrent}-${stringSelectTime}-${satellitesKeys}-${orbitKeys}-${activeLayersKeys}-${acquisitionPlanLayers}-${swathLayers}-${statisticsLayers}`;    \n    return cacheKey === '' ? 'nodata' : cacheKey;\n});\n\nexport const getActiveLayerByKey = createCachedSelector(\n    (activeLayers) => activeLayers,\n    (activeLayers, layerKey) => layerKey,\n    (activeLayers, layerKey, satKey) => satKey,\n    (activeLayers, layerKey, satKey) => activeLayers.find(l => l.layerKey === layerKey && l.satKey === satKey))((state, layerKey, satKey) => `${satKey}-${layerKey}`);\n\n\nexport default {\n    getCurrentTime,\n    getFollowNow,\n    getSelectTime,\n    getInfoModal,\n}","import { createSelector } from 'reselect'\nimport createCachedSelector from 're-reselect';\nimport common from '../_common';\nimport {getSubstate as getSatellitesSubstate} from '../data/satellites';\nimport {getVisibleAcquisitionsPlans, getVisibleStatistics, getLoadingStatistics} from '../map';\nimport {getSubstate as getLayersSubstate, getByKey as getLayerByKey} from '../data/layers';\nimport {getPlansForDate, getLoadingAcquisitionsPlans} from '../data/acquisitionPlans';\nimport {getActiveLayers, getActiveLayerByKey, getFocusedSatellite, isLayerDisabled, getSelectTimePastOrCurrent, getSelectTime} from '../rootSelectors';\nimport satellitesUtils from '../../../utils/satellites';\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'satelliteSelect']);\n\nconst getVisible = createSelector(getSubstate, substate => substate.visible);\n\nconst getSatelitesSelectOptions = createSelector(\n    [\n        getSatellitesSubstate,\n        getLayersSubstate,\n        getActiveLayers,\n        getFocusedSatellite,\n        getSelectTimePastOrCurrent,\n        getVisibleAcquisitionsPlans,\n        getVisibleStatistics,\n        getPlansForDate,\n        getLoadingAcquisitionsPlans,\n        getLoadingStatistics,\n        getSelectTime,\n    ],\n    (satellites, layersSubState, activeLayers, focusedSatellite, selectTimePastOrCurrent, visibleAcquisitionsPlans, visibleStatistics, acquisitionPlansData, loadingAcquisitionsPlans, loadingStatistics, selectTime) => {\n        \n        const getLayerOption = (layerKey, satConfig) => {\n            const satKey = satConfig.id;\n            const layer = getLayerByKey(layersSubState, layerKey);\n            const activeLayerCfg = getActiveLayerByKey(activeLayers, layerKey, satKey)\n            \n            return {\n                type: 'product',\n                id: layerKey,\n                label: layer.name,\n                // disabled: false,\n                disabled: selectTimePastOrCurrent || !satellitesUtils.isSatelliteReleaseBeforeDate(satConfig, selectTime),\n                satKey: satKey,\n                active: activeLayerCfg ? true : false,\n                status: activeLayerCfg && activeLayerCfg.status,\n                message: activeLayerCfg && activeLayerCfg.message,\n                loadedCount: activeLayerCfg && activeLayerCfg.loadedCount,\n                totalCount: activeLayerCfg && activeLayerCfg.totalCount,\n            }\n        }\n\n        const getSateliteOption = (satConfig) => {\n            // const availableAPS = selectTimePastOrCurrent && acquisitionPlansData.some((p) => p.key === satConfig.id && p.plans.length > 0);\n            const hasAPS = acquisitionPlansData.find((p) => p.key === satConfig.id);\n            const hasStatistics = satConfig.hasOwnProperty('statisticsKey');\n            const activeAPS = visibleAcquisitionsPlans.includes(satConfig.id);\n            const activeStatistics = visibleStatistics.includes(satConfig.id);\n            const satOption = {\n                groupData: {\n                    value: satConfig.id,\n                    satKey: satConfig.id,\n                    icon: satConfig.iconClass,\n                    disabled: !satellitesUtils.isSatelliteReleaseBeforeDate(satConfig, selectTime),\n                    active: focusedSatellite === satConfig.id,\n                    loading: loadingAcquisitionsPlans.some(l => l.key === satConfig.id) || loadingStatistics.some(s => s.key === satConfig.id), //todo\n                },\n                label: satConfig.name,\n                options: []\n            }\n\n            //add acquisition plan option if satellite contains data for it\n            if(hasAPS) {\n                satOption.options.push({\n                    type: 'acquisitionPlan',\n                    id: `acg_${satConfig.id}`,\n                    satKey: satConfig.id,\n                    label: 'Acquisition plan',\n                    disabled: false,\n                    active: activeAPS,\n                    loadedCount: selectTimePastOrCurrent && hasAPS.plans && hasAPS.plans.length > 0 ? hasAPS.visiblePlans || 0 : 0,\n                    totalCount: 0,\n                })\n            }\n\n            //add acquisition plan option if satellite contains data for it\n            if(hasStatistics) {\n                satOption.options.push({\n                    type: 'statistics',\n                    id: `statistics_${satConfig.id}`,\n                    satKey: satConfig.id,\n                    label: 'Statistics',\n                    disabled: false,\n                    active: activeStatistics,\n                    loadedCount: 0,\n                    totalCount: 0,\n                })\n            }\n\n            if(satConfig.layers && satConfig.layers.length > 0) {\n                satOption.options = [...satOption.options, ...satConfig.layers.map((layerKey) => getLayerOption(layerKey, satConfig))];\n            }\n\n            return satOption;\n        }\n\n        const satOptions = satellites.map(getSateliteOption);\n\n        return satOptions;\n    }\n)\n\nexport {\n    getSatelitesSelectOptions,\n    getSubstate,\n    getVisible,\n}","export const convertToUTC = (date) => {\n    if(typeof date === 'string') {\n        date = new Date(date);\n    }\n    if(date) {\n        return new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n    } else {\n        return null;\n    }\n}\n\nexport const getNowUTC = () => {\n    var now = new Date();\n    return convertToUTC(now);\n}\n\nexport const getNowUTCString = () => {\n    return new Date().toUTCString();\n}","import { createSelector } from 'reselect'\nimport createCachedSelector from 're-reselect';\nimport moment from 'moment';\n\n\nimport common from '../_common';\nimport {getCurrentTime} from '../rootSelectors';\nimport {convertToUTC} from '../../../utils/date';\n\nexport const addItemToIndex = (array, index, item) => [...array.slice(0, index), item, ...array.slice(index)];\nexport const removeItemByIndex = (array, index) => [...array.slice(0, index), ...array.slice(index + 1)];\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'timeline']);\n\nconst getVisible = createSelector(getSubstate, substate => substate.visible);\n\nconst getActiveTimeLevel = createCachedSelector(getSubstate, substate => substate.activeTimeLevel)((state) => getSubstate(state).activeTimeLevel);\n\nconst getOverlays = createCachedSelector([getSubstate, getCurrentTime], (substate, currentTime) => {\n    const nowOverlayKey = 'now';\n\n    const overlays = substate.overlays;\n    const time = currentTime ? convertToUTC(currentTime) : null;\n    const now = moment(time);\n    const overlayIndex = overlays.findIndex(o => o.key === nowOverlayKey);\n    const nowOverlay = overlays[overlayIndex];\n    const nowOverlayPlusSecond = {...nowOverlay, start: now.clone(), end: now.clone()};\n    const withoutOverlay = removeItemByIndex(overlays, overlayIndex);\n\tconst updatedOverlays = addItemToIndex(withoutOverlay, overlayIndex, nowOverlayPlusSecond);\n    return updatedOverlays;\n})((state) => {\n    const nowOverlayKey = 'now';\n\n    const overlays = common.getByPath(state, ['components', 'timeline', 'overlays']);\n    const now = moment(getCurrentTime(state));\n\n    const overlayIndex = overlays.findIndex(o => o.key === nowOverlayKey);\n    const nowOverlay = overlays[overlayIndex];\n    const nowOverlayPlusSecond = {...nowOverlay, start: now.clone(), end: now.clone()};\n    const withoutOverlay = removeItemByIndex(overlays, overlayIndex);\n\tconst updatedOverlays = addItemToIndex(withoutOverlay, overlayIndex, nowOverlayPlusSecond);\n    return updatedOverlays.map(o => `${o.key}-${o.start.toString()}-${o.end.toString()}-${o.backdroundColor}-${o.label}`).join(',');\n});\n\nexport {\n    getSubstate,\n    getActiveTimeLevel,\n    getOverlays,\n    getVisible,\n}","import { createSelector } from 'reselect'\nimport moment from 'moment';\n\n\nimport common from '../_common';\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'timeWidget']);\n\nconst getVisible = createSelector(getSubstate, substate => substate.visible);\n\nexport {\n    getVisible,\n}","import { createSelector } from 'reselect'\nimport moment from 'moment';\nimport common from '../_common';\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'searchToolbar']);\nconst getActiveResultIndex = (state) => common.getByPath(state, ['components', 'searchToolbar', 'activeOrderedResultIndex']);\nconst getOrderedResults = (state) => common.getByPath(state, ['components', 'searchToolbar', 'orderedResults']);\nconst getLoading = (state) => common.getByPath(state, ['components', 'searchToolbar', 'loading']);\n\nconst getLastResultIndex = createSelector([\n        getOrderedResults,\n    ],\n    (orderedResults) => {\n        return orderedResults.length;\n    }\n);\n\nconst getActiveResult = createSelector([\n        getActiveResultIndex,\n        getOrderedResults,\n    ],\n    (activeResultIndex, orderedResults) => {\n        return orderedResults[activeResultIndex];\n    }\n);\n\nconst getResultByIndex = createSelector([\n        getOrderedResults,\n        (state, index) => index,\n    ],\n    (orderedResults, index) => {\n        return orderedResults[index];\n    }\n);\n\nconst getGeometry = (state) => getSubstate(state).geometry;\nconst getVisible = createSelector([getSubstate], (substate) => {\n    return substate.visible;\n})\n\nexport {\n    getActiveResultIndex,\n    getSubstate,\n    getLoading,\n    getVisible,\n    getGeometry,\n    getResultByIndex,\n    getActiveResult,\n    getLastResultIndex\n}","import common from '../_common';\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'navigatorBackup']);\n\nexport {\n    getSubstate,\n}","import * as satelliteSelect from './components/satellitesSelect';\nimport * as timeline from './components/timeline';\nimport * as timeWidget from './components/timeWidget';\nimport * as search from './components/search';\nimport * as searchToolbar from './components/searchToolbar';\nimport * as navigatorBackup from './components/navigatorBackup';\nimport * as satellites from './data/satellites';\nimport * as layers from './data/layers';\nimport * as orbits from './data/orbits';\nimport * as map from './map';\nimport * as rootSelectors from './rootSelectors';\n\nexport default {\n    rootSelectors,\n    data: {\n        satellites,\n        layers,\n        orbits,\n    },\n    components: {\n        satelliteSelect,\n        timeline,\n        timeWidget,\n        search,\n        searchToolbar,\n        navigatorBackup,\n    },\n    map,\n}","export const addItemToIndex = (array, index, item) => [...array.slice(0, index), item, ...array.slice(index)];\nexport const removeItemByIndex = (array, index) => [...array.slice(0, index), ...array.slice(index + 1)];\nexport const replaceItemOnIndex = (array, index, item) => [...array.slice(0, index), item, ...array.slice(index + 1)];","export const removeItemByKey = (object, key) => {\n\tconst {[key]: value, ...withoutKey} = object;\n\treturn withoutKey;\n};","import moment from 'moment';\nimport types from './types';\nimport select from './selectors/';\nimport {removeItemByIndex,replaceItemOnIndex, addItemToIndex} from '../utils/arrayManipulation';\nimport {removeItemByKey} from '../utils/objectManipulation';\nimport WorldWindX from 'webworldwind-x';\nimport {merge, cloneDeep} from 'lodash';\nimport {initialState} from './context';\n\nconst {\n    EoUtils\n} = WorldWindX;\n\nconst deactivateLayer = (state, action) => {\n    const satKey = action.payload.satKey;\n    const layerKey = action.payload.layerKey;\n    const selectTime = select.rootSelectors.getSelectTime(state);\n    const activeLayers = select.rootSelectors.getPureActiveLayers(state, selectTime);\n    const activeIndex = activeLayers.findIndex(l => l.satKey === satKey && l.layerKey === layerKey);\n\n    if(activeIndex > -1) {\n        return {\n            ...state,\n            activeLayers: removeItemByIndex(activeLayers, activeIndex)\n        };\n    } else {\n        return state\n    }\n}\n\nconst activateLayer = (state, action) => {\n    const satKey = action.payload.satKey;\n    const layerKey = action.payload.layerKey;\n    const selectTime = select.rootSelectors.getSelectTime(state);\n    const activeLayers = select.rootSelectors.getPureActiveLayers(state, selectTime);\n    const activeIndex = activeLayers.findIndex(l => l.satKey === satKey && l.layerKey === layerKey);\n\n    if(activeIndex === -1) {\n        return {\n            ...state,\n            activeLayers: [...activeLayers, {satKey, layerKey}]\n        };\n    } else {\n        return state\n    }\n}\n\nconst toggleLayer = (state, action) => {\n    const satKey = action.payload.satKey;\n    const layerKey = action.payload.layerKey;\n    const selectTime = select.rootSelectors.getSelectTime(state);\n    const activeLayers = select.rootSelectors.getPureActiveLayers(state, selectTime);\n    const activeIndex = activeLayers.findIndex(l => l.satKey === satKey && l.layerKey === layerKey);\n    \n    if(activeIndex > -1) {\n        return deactivateLayer(state, {\n            payload: {\n                satKey,\n                layerKey\n            }\n        })\n    } else {\n        return activateLayer(state, {\n            payload: {\n                satKey,\n                layerKey\n            }\n        })\n    }\n}\n\nconst setPreventReloadLayers = (state, action) => {\n    return {\n        ...state,\n        preventReloadLayers: action.payload\n    };\n}\n\nconst focusSatelite = (state, action) => {\n    return {\n        ...state,\n        focus: action.payload\n    };\n}\n\nconst setSelectTime = (state, action) => {\n    //FIXME - should be dispatched separated to set selectTimePastOrCurrent\n    const currentTime = select.rootSelectors.getCurrentTime(state);\n    const selectTime = action.payload;\n    let followNow = false;\n    if(select.rootSelectors.getFollowNow(state)) {\n        followNow = true;\n    }\n    const selectTimeMoment = moment(selectTime);\n    return {\n        ...state,\n        selectTime: action.payload,\n        selectTimePastOrCurrent: selectTimeMoment.isAfter(currentTime) || followNow,\n    };\n}\n\nconst setCurrentTime = (state, action) => {\n    const currentTime = action.payload;\n    return {\n        ...state,\n        currentTime: currentTime,\n    };\n}\n\nconst setActiveTimeLevel = (state, action) => {\n    return {\n        ...state,\n        activeTimeLevel: action.payload\n    };\n}\n\nconst setFollowNow = (state, action) => {\n    return {\n        ...state,\n        followNow: action.payload\n    };\n}\n\nconst setTrackTime = (state, action) => {\n    return {\n        ...state,\n        trackTime: action.payload\n    };\n}\n\nconst setLandscape = (state, action) => {\n    return {\n        ...state,\n        landscape: action.payload\n    };\n}\n\nconst setHelper = (state, path, value) => {\n\tlet remainingPath = [...path];\n\tlet currentKey = remainingPath.shift();\n\tif (remainingPath.length) {\n\t\treturn {...state, [currentKey]: setHelper(state[currentKey], remainingPath, value)};\n\t} else {\n\t\treturn {...state, [currentKey]: value};\n\t}\n}\n\nconst updateComponent = (state, action) => {\n\treturn {...state, components: {...state.components, [action.component]: state.components[action.component] ? {...state.components[action.component], ...action.update} : action.update}};\n}\n\nconst setComponent = (state, action) => {\n\tlet path = action.path.split('.');\n\treturn {...state, components: {...state.components, [action.component]: setHelper(state.components[action.component], path, action.value)}};\n}\n\nconst clearComponent = (state, action) => {\n\treturn {...state, components: {...removeItemByKey(state.components, action.component)}};\n}\n\nconst updateModal = (state, modalPath, modal) => {\n    // return {...state, components: {...state.components, [action.component]: setHelper(state.components[action.component], path, action.value)}};\n    return {...setHelper(state, modalPath, modal)};\n}\n\nconst updateInfoModal = (state, action) => {\n    const {modalKey, modalState} = action.payload\n    const infoModalState = select.rootSelectors.getInfoModal(state, modalKey);\n    return updateModal(state, ['infoModal', modalKey], {...infoModalState, ...modalState, modalKey});\n}\n\nconst setActiveInfoModal = (state, action) => {\n    const {modalKey} = action.payload\n    return {...state, infoModal: {...state.infoModal, active: modalKey}};\n}\n\nconst updateActiveLayer = (state, action) => {\n    //get layer by key\n    const layerKey = action.payload.layerKey.layerKey;\n    const satKey = action.payload.layerKey.satKey;\n    const change = action.payload.change;\n    const selectTime = new Date(select.rootSelectors.getSelectTime(state));\n    const activeLayers = select.rootSelectors.getPureActiveLayers(state, selectTime);\n    const layerIndex = activeLayers.findIndex(l => l.satKey === satKey && l.layerKey === layerKey);\n\n    let changed = false;\n    \n    if(layerIndex > -1) {\n        for (const [key, value] of Object.entries(change)) {\n            if(activeLayers[layerIndex][key] !== value) {\n                changed = true;\n                break;\n            }\n        }\n    }\n    \n    if(layerIndex > -1 && changed) {\n        const layerInfo = state.activeLayers[layerIndex];\n        delete layerInfo.message;\n        delete layerInfo.status;\n        delete layerInfo.loadedCount;\n        delete layerInfo.totalCount;\n        return {\n            ...state,\n            activeLayers: replaceItemOnIndex(activeLayers, layerIndex, {...layerInfo, ...change})\n        };\n    } else {\n        return state\n    }\n}\n\nconst setOrbits = (state, action) => {\n    const orbits = action.payload.orbits;\n    return {...state, data: {...state.data, orbits}};\n};\n\nconst setAcquisitionPlans = (state, action) => {\n    const aps = action.payload.aps;\n    return {...state, data: {...state.data, acquisitionPlans: aps}};\n};\n\nconst dataUpdateAcquisitionPlan = (state, action) => {\n    const key = action.payload.key;\n    const url = action.payload.url;\n    const update = action.payload.update;\n    const acquisitionPlansKeyIndex = state.data.acquisitionPlans.findIndex((acquisitionPlans) => acquisitionPlans.key === key);\n    const acquisitionPlanUrlIndex = state.data.acquisitionPlans[acquisitionPlansKeyIndex].plans.findIndex((acquisitionPlan) => acquisitionPlan.url === url);\n    \n    const updatedAcquisitionPlan = merge(cloneDeep(state.data.acquisitionPlans[acquisitionPlansKeyIndex].plans[acquisitionPlanUrlIndex]), update);\n    const updatedAcquisitionPlans = replaceItemOnIndex(state.data.acquisitionPlans[acquisitionPlansKeyIndex].plans, acquisitionPlanUrlIndex, updatedAcquisitionPlan);\n    \n    return {...state, data: {...state.data, acquisitionPlans: [...replaceItemOnIndex(state.data.acquisitionPlans, acquisitionPlansKeyIndex, {...state.data.acquisitionPlans[acquisitionPlansKeyIndex],plans: updatedAcquisitionPlans})]}};\n};\n\nconst setVisibleAcquisitionPlan = (state, action) => {\n    const key = action.payload.key;\n    const count = action.payload.count;\n    const acquisitionPlansKeyIndex = state.data.acquisitionPlans.findIndex((acquisitionPlans) => acquisitionPlans.key === key);\n    return {...state, data: {...state.data, acquisitionPlans: [...replaceItemOnIndex(state.data.acquisitionPlans, acquisitionPlansKeyIndex, {...state.data.acquisitionPlans[acquisitionPlansKeyIndex], visiblePlans: count})]}};\n};\n\nconst setSatelliteHeadingAndUpdateViewHeadingCorrection = (state, action) => {\n    const satelliteIndex = state.data.satellites.findIndex((sat) => sat.id === action.id);\n\n    //check if sat fixed\n    const focusedSatellite = select.rootSelectors.getFocusedSatellite(state);\n    if(focusedSatellite && focusedSatellite === action.id) {\n        //set headingCorrection into view\n        const satData = select.data.satellites.getSatelliteByKey(state, focusedSatellite);\n        state = updateMapView(state, {payload: {view: {headingCorrection: satData.heading}}});\n    }\n\n    return {...state, data: {...state.data, satellites: [...replaceItemOnIndex(state.data.satellites, satelliteIndex, {...state.data.satellites[satelliteIndex], heading: action.heading})]}};\n}\n\nconst updateViewHeadingCorrectionFromFocusedSatellite = (state) => {\n    const focusedSatellite = select.rootSelectors.getFocusedSatellite(state);\n    const satData = select.data.satellites.getSatelliteByKey(state, focusedSatellite);\n    return updateMapView(state, {payload: {view: {headingCorrection: satData.heading}}});\n}\n\nconst setSatelliteHeading = (state, action) => {\n    const satelliteIndex = state.data.satellites.findIndex((sat) => sat.id === action.id);;\n    return {...state, data: {...state.data, satellites: [...replaceItemOnIndex(state.data.satellites, satelliteIndex, {...state.data.satellites[satelliteIndex], heading: action.heading})]}};\n}\n\nconst mapAddVisibleAcquisitionPlan = (state, action) => {\n    const acquisitionPlanKey = action.payload.key;\n    return {...state, map: {...state.map, acquisitionPlans: [...state.map.acquisitionPlans, acquisitionPlanKey]}};\n};\n\nconst mapRemoveVisibleAcquisitionPlan = (state, action) => {\n    const acquisitionPlanKey = action.payload.key;\n    const acquisitionPlanKeyIndex = state.map.acquisitionPlans.indexOf(acquisitionPlanKey);\n    return {...state, map: {...state.map, acquisitionPlans: removeItemByIndex(state.map.acquisitionPlans, acquisitionPlanKeyIndex)}};\n};\n\nconst mapAddVisibleStatisticsLayer = (state, action) => {\n    const key = action.payload.key;\n    return {...state, map: {...state.map, statistics: [...state.map.statistics, {key}]}};\n};\n\nconst mapRemoveVisibleStatisticsLayer = (state, action) => {\n    const key = action.payload.key;\n    const keyIndex = state.map.statistics.findIndex((statistic) => statistic.key === key);\n    return {...state, map: {...state.map, statistics: removeItemByIndex(state.map.statistics, keyIndex)}};\n};\n\nconst mapUpdateStatisticsLayer = (state, action) => {\n    const key = action.payload.key;\n    const update = action.payload.update;\n    const keyIndex = state.map.statistics.findIndex((statistic) => statistic.key === key);\n\n    const updatedStatistic = merge(state.map.statistics[keyIndex], update);\n    const updatedStatistics = replaceItemOnIndex(state.map.statistics, keyIndex, updatedStatistic);\n\n    return {...state, map: {...state.map, statistics: updatedStatistics}};\n};\n\nconst setMapView = (state, action) => {\n    return {...state, map: {...state.map, view: action.payload.view }};\n};\n\nconst updateMapView = (state, action) => {\n    return {...state, map: {...state.map, view: {...state.map.view, ...action.payload.view} }};\n};\n\nconst componentsSearchToolbarClear = (state) => {\n    return {...state, components: {...state.components, searchToolbar: {...cloneDeep(initialState.components.searchToolbar)}}};\n};\n\nexport default (state, action) => {\n    //change state logging\n    // console.log(state, action);\n\n    switch(action.type) {\n        case types.FOCUS_SATELLITE:\n            return focusSatelite(state, action)\n        case types.TOGGLE_LAYER:\n            return toggleLayer(state, action);\n        case types.PREVENT_RELOAD_LAYERS:\n            return setPreventReloadLayers(state, action);\n        case types.ACTIVATE_LAYER:\n            return activateLayer(state, action);\n        case types.DEACTIVATE_LAYER:\n            return deactivateLayer(state, action);\n        case types.CHANGE_SELECTTIME:\n            return setSelectTime(state, action);\n        case types.CHANGE_CURRENTTIME:\n            return setCurrentTime(state, action);\n        case types.CHANGE_ACTIVE_TIME_LEVEL:\n            return setActiveTimeLevel(state, action);\n        case types.FOLLOW_NOW:\n            return setFollowNow(state, action);\n        case types.TRACK_TIME:\n            return setTrackTime(state, action);\n        case types.CHANGE_LANDSCAPE:\n            return setLandscape(state, action);\n        case types.COMPONENT.UPDATE:\n            return updateComponent(state, action);\n        case types.COMPONENT.SET:\n            return setComponent(state, action);\n        case types.COMPONENT.CLEAR:\n            return clearComponent(state, action);\n        case types.UPDATE_ACTIVE_LAYER:\n            return updateActiveLayer(state, action);\n        case types.UPDATE_INFO_MODAL:\n            return updateInfoModal(state, action);\n        case types.SET_ACTIVE_INFO_MODAL:\n            return setActiveInfoModal(state, action);\n        case types.SET_ORBITS:\n            return setOrbits(state, action);\n        case types.SET_ACQUISITION_PLANS:\n            return setAcquisitionPlans(state, action);\n        case types.DATA_UPDATE_ACQUISITIONPLANS:\n            return dataUpdateAcquisitionPlan(state, action);\n        case types.DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT:\n            return setVisibleAcquisitionPlan(state, action);\n        case types.DATA.SATELLITES.SET_HEADING:\n            return setSatelliteHeading(state, action);\n        case types.DATA.SATELLITES.SET_HEADING_AND_UPDATE_VIEW_HEADING_CORRECTION:\n            return setSatelliteHeadingAndUpdateViewHeadingCorrection(state, action);\n        case types.MAP.UPDATE_VIEW_HEADING_CORRECTION_FROM_FOCUSED_SATELLITE:\n            return updateViewHeadingCorrectionFromFocusedSatellite(state, action);\n        case types.MAP_ADD_VISIBLE_ACQUISITION_PLAN:\n            return mapAddVisibleAcquisitionPlan(state, action);\n        case types.MAP_REMOVE_VISIBLE_ACQUISITION_PLAN:\n            return mapRemoveVisibleAcquisitionPlan(state, action);\n        case types.MAP.ADD_STATISTICS_LAYER:\n            return mapAddVisibleStatisticsLayer(state, action);\n        case types.MAP.REMOVE_STATISTICS_LAYER:\n            return mapRemoveVisibleStatisticsLayer(state, action);\n        case types.MAP.UPDATE_STATISTICS:\n            return mapUpdateStatisticsLayer(state, action);\n        case types.MAP.SET_VIEW:\n            return setMapView(state, action);\n        case types.MAP.UPDATE_VIEW:\n            return updateMapView(state, action);\n        case types.COMPONENTS.SEARCH_TOOLBAR.CLEAR:\n            return componentsSearchToolbarClear(state);\n        default:\n            return state;\n    }\n}","import moment from 'moment';\nimport _ from 'lodash';\n\nconst parse = string => {\n\tif (string.match(/\\/P/)) {\n\t\t// start date & duration\n\t\tthrow new Error('Durations not implemented');\n\t}\n\tif (string.match(/\\//)) {\n\t\t// start & end date\n\t\tlet dates = string.split('/');\n\t\treturn {\n\t\t\tstart: parseOne(dates[0]).start,\n\t\t\tend: parseOne(dates[1]).end,\n\t\t\tsource: string,\n\t\t\ttype: 'interval'\n\t\t};\n\t}\n\t// anything else\n\treturn parseOne(string);\n\n};\n\nconst parseOne = string => {\n\tif (string.match(/^[0-9]{4}$/)) {\n\t\t// year\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('year'),\n\t\t\tsource: string,\n\t\t\ttype: 'year'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}$/)) {\n\t\t// month\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('month'),\n\t\t\tsource: string,\n\t\t\ttype: 'month'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/)) {\n\t\t// day\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('day'),\n\t\t\tsource: string,\n\t\t\ttype: 'day'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}$/)) {\n\t\t// hour\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('hour'),\n\t\t\tsource: string,\n\t\t\ttype: 'hour'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}$/)) {\n\t\t// minute\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('minute'),\n\t\t\tsource: string,\n\t\t\ttype: 'minute'\n\t\t};\n\t}\n\tif (\n\t\tstring.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}$/)\n\t\t|| string.match(/^[0-9]{4}[0-9]{2}[0-9]{2}T[0-9]{2}[0-9]{2}[0-9]{2}$/)\n\t) {\n\t\t// second\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('second'),\n\t\t\tsource: string,\n\t\t\ttype: 'second'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}/)) {\n\t\t// full datetime incl. timezone\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('second'),\n\t\t\tsource: string,\n\t\t\ttype: 'full'\n\t\t};\n\t}\n};\n\nexport default parse;\n\nexport const toString = period => {\n\tif (!(_.isObject(period) && period.start && period.end && period.type)) throw new Error('Invalid period supplied to period.toString');\n\tswitch (period.type) {\n\t\tcase 'interval':\n\t\t\treturn period.start.format('YYYY-MM-DD h:mm:ss') + ' - ' + period.end.format('YYYY-MM-DD h:mm:ss');\n\t\tcase 'second':\n\t\tcase 'full':\n\t\t\treturn period.start.format('YYYY-MM-DD h:mm:ss');\n\t\tcase 'minute':\n\t\t\treturn period.start.format('YYYY-MM-DD h:mm');\n\t\tcase 'hour':\n\t\t\treturn period.start.format('YYYY-MM-DD h') + 'h';\n\t\tdefault:\n\t\t\treturn period.source;\n\t}\n};\n\nexport const isInside = (period, time) => {\n\treturn period.start.isBefore(time) && period.end.isAfter(time);\n}\n\nexport const getInside = (period, time) => {\n\tif(time.isBefore(period.start)) {\n\t\treturn period.start;\n\t} else if(time.isAfter(period.end)) {\n\t\treturn period.end;\n\t} else {\n\t\treturn time;\n\t}\n}","import React, {createContext} from 'react'\r\nimport reducer from './reducer';\r\nimport {getNowUTCString} from '../utils/date'\r\nimport moment from 'moment';\r\nimport period from '../utils/period';\r\nimport {getSatDataByKey, getDefaultSatOrbitBySatKey} from './satData';\r\nimport {cloneDeep} from 'lodash';\r\n\r\nconst now = moment(getNowUTCString());\r\n\r\nconst periodLimit = period('2010/2025');\r\nconst stringPeriodLimit = {\r\n    start: periodLimit.start.toDate().toString(),\r\n    end: periodLimit.end.toDate().toString(),\r\n}\r\n\r\nexport const Context = createContext({\r\n    periodLimit: null,\r\n    satellites: [],\r\n    activeLayers: [],\r\n    focus: null,\r\n    selectTime: null,\r\n    currentTime: null,\r\n    followNow: null,\r\n    preventReloadLayers: null,\r\n    selectTimePastOrCurrent: null,\r\n    components:{},\r\n    infoModal: {},\r\n});\r\n\r\nexport const initialState = {\r\n    data: {\r\n        layers: {\r\n            //sentinel 1\r\n            'SLC': {\r\n                key: 'SLC',\r\n                name: 'SLC',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'GRD': {\r\n                key: 'GRD',\r\n                name: 'GRD',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'OCN': {\r\n                key: 'OCN',\r\n                name: 'OCN',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            //sentinel 2\r\n            'S2MSI1C': {\r\n                key: 'S2MSI1C',\r\n                name: 'S2MSI1C',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'S2MSI2A': {\r\n                key: 'S2MSI2A',\r\n                name: 'S2MSI2A',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'S2MSI2Ap': {\r\n                key: 'S2MSI2Ap',\r\n                name: 'S2MSI2Ap',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            //sentinel 3\r\n            'OL_1_EFR___': {\r\n                key: 'OL_1_EFR___',\r\n                name: 'OL_1_EFR___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'OL_1_ERR___': {\r\n                key: 'OL_1_ERR___',\r\n                name: 'OL_1_ERR___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'OL_2_LFR___': {\r\n                key: 'OL_2_LFR___',\r\n                name: 'OL_2_LFR___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'OL_2_LRR___': {\r\n                key: 'OL_2_LRR___',\r\n                name: 'OL_2_LRR___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_1_SRA___': {\r\n                key: 'SR_1_SRA___',\r\n                name: 'SR_1_SRA___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_1_SRA_A_': {\r\n                key: 'SR_1_SRA_A_',\r\n                name: 'SR_1_SRA_A_',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_1_SRA_BS': {\r\n                key: 'SR_1_SRA_BS',\r\n                name: 'SR_1_SRA_BS',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_2_LAN___': {\r\n                key: 'SR_2_LAN___',\r\n                name: 'SR_2_LAN___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SL_1_RBT___': {\r\n                key: 'SL_1_RBT___',\r\n                name: 'SL_1_RBT___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SL_2_LST___': {\r\n                key: 'SL_2_LST___',\r\n                name: 'SL_2_LST___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SY_2_SYN___': {\r\n                key: 'SY_2_SYN___',\r\n                name: 'SY_2_SYN___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SY_2_V10___': {\r\n                key: 'SY_2_V10___',\r\n                name: 'SY_2_V10___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SY_2_VG1___': {\r\n                key: 'SY_2_VG1___',\r\n                name: 'SY_2_VG1___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SY_2_VGP___': {\r\n                key: 'SY_2_VGP___',\r\n                name: 'SY_2_VGP___',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n        },\r\n        satellites: [\r\n            {id: 's1a', name: 'S1-A', model: 'S1', iconClass: 'sentinel-1', satData: getSatDataByKey('s1a'), layers:['SLC', 'GRD', 'OCN'], statisticsKey: 'sentinel-1a', acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's1b', name: 'S1-B', model: 'S1', iconClass: 'sentinel-1', satData: getSatDataByKey('s1b'), layers:['SLC', 'GRD', 'OCN'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's2a', name: 'S2-A', model: 'S2', iconClass: 'sentinel-2', satData: getSatDataByKey('s2a'), layers:['S2MSI1C','S2MSI2A','S2MSI2Ap'],statisticsKey: 'sentinel-2a', acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's2b', name: 'S2-B', model: 'S2', iconClass: 'sentinel-2', satData: getSatDataByKey('s2b'), layers:['S2MSI1C','S2MSI2A','S2MSI2Ap'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's3a', name: 'S3-A', model: 'S3', iconClass: 'sentinel-3', satData: getSatDataByKey('s3a'), layers:['OL_1_EFR___','OL_1_ERR___','OL_2_LFR___','OL_2_LRR___','SR_1_SRA___','SR_1_SRA_A_','SR_1_SRA_BS','SR_2_LAN___','SL_1_RBT___','SL_2_LST___','SY_2_SYN___','SY_2_V10___','SY_2_VG1___','SY_2_VGP___'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's3b', name: 'S3-B', model: 'S3', iconClass: 'sentinel-3', satData: getSatDataByKey('s3b'), layers:['OL_1_EFR___','OL_1_ERR___','OL_2_LFR___','OL_2_LRR___','SR_1_SRA___','SR_1_SRA_A_','SR_1_SRA_BS','SR_2_LAN___','SL_1_RBT___','SL_2_LST___','SY_2_SYN___','SY_2_V10___','SY_2_VG1___','SY_2_VGP___'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's5p', name: 'S-5', model: 'S5', iconClass: 'sentinel-5', satData: getSatDataByKey('s5p'), layers:[], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000}\r\n        ], // All the available satellites.\r\n        orbits: [\r\n            getDefaultSatOrbitBySatKey('s1a'),\r\n            getDefaultSatOrbitBySatKey('s1b'),\r\n            getDefaultSatOrbitBySatKey('s2a'),\r\n            getDefaultSatOrbitBySatKey('s2b'),\r\n            getDefaultSatOrbitBySatKey('s3a'),\r\n            getDefaultSatOrbitBySatKey('s3b'),\r\n            getDefaultSatOrbitBySatKey('s5p'),\r\n        ],\r\n        acquisitionPlans: [],\r\n    },\r\n    map: {\r\n        acquisitionPlans: [],\r\n        statistics: [],\r\n        viewFocused: false,\r\n        view: {\r\n            boxRange: 10060000,\r\n            center: {lat: 41, lon: 7}\r\n        },\r\n    },\r\n    periodLimit: stringPeriodLimit,\r\n    activeLayers: [],\r\n    focus: null, // Fix camera on satellite\r\n    selectTime: null,\r\n    currentTime: getNowUTCString(),\r\n    landscape: true,\r\n    infoModal: {},\r\n    followNow: true,\r\n    trackTime: false,\r\n    preventReloadLayers: false,\r\n    selectTimePastOrCurrent: false,\r\n    components:{\r\n        satelliteSelect: {\r\n            open: true,\r\n            visible: true,\r\n        },\r\n        timeWidget: {\r\n            visible: true,\r\n        },\r\n        timeline: {\r\n            visible: true,\r\n            moving: false,\r\n            mouseTime: null,\r\n            dayWidth: null,\r\n            activeTimeLevel: 'month',\r\n            overlays: [\r\n                {\r\n                    key: 'now',\r\n                    start: now.clone(),\r\n                    end: now.clone(),\r\n                    backdroundColor: 'rgba(77, 77, 239, 0.7)',\r\n                    label: 'Mission',\r\n                    classes: 'overlay1',\r\n                    height: 70,\r\n                    top: 0,\r\n                },\r\n            ]\r\n        },\r\n        search: {\r\n            satellites: ['s1a', 's1b', 's2a', 's2b', 's3a', 's3b', '5p'],\r\n            geometry: null,\r\n            type: null, //types by active satellite? SLC/GRD/OCN\r\n            activeResultIndex: null,\r\n            results: []    \r\n        },\r\n        searchToolbar: {\r\n            visible: false,\r\n            loading: false,\r\n            geometry: null, //{latitude:coordinates.latitude,longitude:coordinates.longitude,altitude:coordinates.altitude}\r\n            orderedResults: [],\r\n            activeOrderedResultIndex: null,\r\n        },\r\n        navigatorBackup: {},\r\n    }\r\n};\r\n\r\nexport const ContextProvider = (props) => {\r\n    const [state, dispatch] =  React.useReducer(reducer, cloneDeep(initialState));\r\n    const value = {state, dispatch};\r\n\r\n    return <Context.Provider value={value}>{props.children}</Context.Provider>;\r\n}","import types from '../../types';\n\n\nexport const setViewFromNavigator = (navigator) => {\n    const mapView = {\n        center: {\n            lat: navigator.lookAtLocation.latitude,\n            lon: navigator.lookAtLocation.longitude,\n            altitude: navigator.lookAtLocation.altitude\n        },\n        range: navigator.range,\n        heading: navigator.heading,\n        tilt: navigator.tilt,\n        roll: navigator.roll,\n\n    }\n\n    return updateMapView(mapView);\n}\n\nexport const updateMapView = (mapView) => {\n    return {\n        type: types.MAP.UPDATE_VIEW,\n        payload: {\n            view: mapView,\n        }\n    }\n}\nexport const updateViewHeadingCorrectionByFocusSatellite = () => {\n    return {\n        type: types.MAP.UPDATE_VIEW_HEADING_CORRECTION_FROM_FOCUSED_SATELLITE,\n    }\n}\nexport const setView = (mapView) => {\n    return {\n        type: types.MAP.SET_VIEW,\n        payload: {\n            view: mapView,\n        }\n    }\n}\n\nexport const updateStatistics = (satKey, change) => {\n    return {\n        type: types.MAP.UPDATE_STATISTICS,\n        payload: {\n            key: satKey,\n            update: change,\n        }\n    }\n}","const getUrl = (dateString) => `https://eoapps.solenix.ch/tle-server/${dateString}/resource.txt`\n\n//cache tle in Map\nconst cache = new Map();\n\nconst SENTINELTLENAMES = ['SENTINEL-1A', 'SENTINEL-1B', 'SENTINEL-2A', 'SENTINEL-2B', 'SENTINEL-3A', 'SENTINEL-3B', 'SENTINEL-5P']\nconst SENTINELTLEKEYSPAIRS = [['SENTINEL-1A', 's1a'], ['SENTINEL-1B', 's1b'], ['SENTINEL-2A', 's2a'], ['SENTINEL-2B', 's2b'], ['SENTINEL-3A', 's3a'], ['SENTINEL-3B', 's3b'], ['SENTINEL-5P', 's5p']]\n\nconst parseSatellitesData = (text) => {\n    const lines = text.split('\\r\\n');\n    const satellites = [];\n    lines.forEach((line, index) => {\n            //satellite name is on every thirth line;\n            const isSatNameLine = index % 3 === 0;\n            if(isSatNameLine) {\n                satellites.push({\n                    name: line.trim(),\n                    line1: lines[index + 1],\n                    line2: lines[index + 2]\n                });\n            }\n    });\n    return satellites;\n}\n\nconst transformTleFormat = (tle) => {\n    const satKey = SENTINELTLEKEYSPAIRS.find((s => s[0] === tle.name))[1];\n    return {\n        key: `orbit-${satKey}`,\n        specs: [\n            tle.line1,\n            tle.line2,\n        ]\n    }\n}\n\n/**\n * @param {string} dateString - Date string in format YYYY-MM-DD like \"2019-06-07\"\n */\nexport const getTle = async (dateString) => {\n    \n    let tle = null;\n    if(cache.has(dateString)) {\n        tle = cache.get(dateString);\n        //check if tle is Promise\n        if(tle && typeof tle.then == 'function') {\n            tle = await tle;\n            return tle;\n        } else {\n            return tle;\n        }\n    } else {\n        const request = fetch(getUrl(dateString)).then(response => response.text()).then(text => parseSatellitesData(text).filter(t => SENTINELTLENAMES.includes(t.name)).map(transformTleFormat));\n        cache.set(dateString, request);\n        const orbits = await request;\n        \n        return orbits;\n    }\n}\n\n","import types from './types';\nimport moment from 'moment';\nimport select from './selectors/';\nimport {setViewFromNavigator, setView} from './actions/map';\nimport {getInside} from '../utils/period';\nimport {getNowUTCString} from '../utils/date';\nimport {getTle} from '../utils/tle';\nimport {getAllAcquisitionPlans} from '../utils/acquisitionPlans';\nimport satellitesUtils from '../utils/satellites';\nimport WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\n\nconst {\n    EoUtils\n} = WordWindX;\n\nconst DEFAULT_NAVIGATOR = {\n    lookAtLocation: {\n        latitude: 0,\n        longitude: 0,\n        altitude: 0,\n    },\n    range: 0,\n    heading: 0,\n    tilt: 0,\n    roll: 0,\n}\n\nlet intervalKeyZoom = null;\nlet intervalKeyScroll = null;\n\nexport const focusSatellite = (satelliteId) => {\n    return {\n        type: types.FOCUS_SATELLITE,\n        payload: satelliteId\n    }\n}\n\nexport const setNavigatorFromOrbit = (selectTime, orbitInfo, prevMapView, respectHeading = 0, respectRoll = 0, respectTilt = 0) => {\n    const satrec = EoUtils.computeSatrec(orbitInfo.specs[0], orbitInfo.specs[1]);\n    const position = EoUtils.getOrbitPosition(satrec, new Date(selectTime));\n    const navigator = {\n        lookAtLocation: {\n            latitude: position.latitude,\n            longitude: position.longitude,\n            altitude: position.altitude\n        },\n        // The range needs to be changed gradually to tha altitude of the satellite.\n        // This one needs to properly clean to the satellite.\n        range: 2 * position.altitude,\n        heading: respectHeading,\n        roll: respectRoll,\n        tilt: respectTilt,\n    }\n    \n    return updateNavigator(prevMapView, navigator)\n\n}\n\nexport const updateNavigator = (prevNavigator, navigator) => {\n    const updatedNavigator = {...DEFAULT_NAVIGATOR, ...prevNavigator, ...navigator};\n    return setNavigator(updatedNavigator);\n}\nexport const setNavigator = (navigator) => {\n    return setViewFromNavigator(navigator);\n}\n\n/**\n * \n * @param {string} satelliteKey \n * @param {string} layerKey \n */\nexport const toggleLayer = (satelliteKey, layerKey) => {\n    return {\n        type: types.TOGGLE_LAYER,\n        payload: {\n            type: 'product',\n            satKey: satelliteKey,\n            layerKey: layerKey,\n        }\n    }\n};\n\n/**\n * \n * @param {string} modalKey \n * @param {string} content \n */\nexport const updateInfoModal = (modalKey, modalState) => {\n    return {\n        type: types.UPDATE_INFO_MODAL,\n        payload: {\n            modalKey,\n            modalState,\n        }\n    }\n};\n\n/**\n * \n * @param {string} modalKey \n */\nexport const setActiveInfoModal = (modalKey) => {\n    return {\n        type: types.SET_ACTIVE_INFO_MODAL,\n        payload: {\n            modalKey,\n        }\n    }\n};\n\n/**\n * \n * @param {string} satelliteKey \n * @param {string} layerKey \n */\nexport const setPreventReloadLayers = (preventReloadLayers) => {\n    return {\n        type: types.PREVENT_RELOAD_LAYERS,\n        payload: preventReloadLayers\n    }\n};\n\nexport const zoomToTimeLevel = (dispatch, level, levelDayWidth, currentDayWidth) => {\n    window.clearInterval(intervalKeyZoom);\n    //zoom to dayWidth\n    const steps = 16;\n    const finalDayWidth = levelDayWidth - 0.1;\n    const dayWidthDiff =  finalDayWidth - currentDayWidth;\n    const peace = dayWidthDiff / steps;\n    let index = 0;\n\n    intervalKeyZoom = window.setInterval(() => {\n        index++;\n        if(index > steps) {\n            index = 0;\n            window.clearInterval(intervalKeyZoom);\n        } else {\n            dispatch(updateComponent('timeline', {dayWidth: currentDayWidth + (peace * index)}))\n        }\n    }, 60)\n};\n\nexport const scrollToTime = (state, dispatch, selectTime, newTime, period, callback) => {\n    window.clearInterval(intervalKeyScroll);\n    const steps = 12;\n    let timeInPeriod = newTime;\n    if(period) {\n        timeInPeriod = moment(getInside(period, moment(newTime)));\n    }\n    const diff = timeInPeriod.diff(moment(selectTime));\n    const peace = diff / steps;\n    let index = 0;\n    intervalKeyScroll = window.setInterval(() => {\n        index++;\n        if(index > steps) {\n            index = 0;\n            window.clearInterval(intervalKeyScroll);\n            if(typeof callback === 'function') {\n                callback();\n            }\n        } else {\n            const newSelectedTime = moment(selectTime).add(peace * index).toDate().toUTCString();\n            const selectedTime = moment(selectTime).add(peace * (index - 1)).toDate().toUTCString();\n            // If the focus is there, move the navigator with the satellite.\n\n            dispatch(changeSelectTime(newSelectedTime, dispatch, selectedTime, state));\n        }\n    }, 60)\n};\n\n/**\n * \n * @param {string} time New time\n * @param {function} dispatch\n * @param {string} selectTime */\nexport const changeSelectTime = (time, dispatch, selectTime, state) => {\n    const selectTimeMoment = moment(selectTime);\n    const selectYearDay = `${selectTimeMoment.year()}-${selectTimeMoment.dayOfYear()}`\n    const momentTime = moment(time);\n    const timeYearDay = `${momentTime.year()}-${momentTime.dayOfYear()}`\n    const newTimeIsSameDay = selectYearDay === timeYearDay;\n\n    //Check if new time is in another day. If so, reload orbits\n    // future TLE are not available at the moment\n    if(!newTimeIsSameDay) {\n        updateTleData(dispatch, time);\n    }\n\n    const focusedSatellite = select.rootSelectors.getFocusedSatellite(state);\n    const viewFixed = !!focusedSatellite;\n    if(focusedSatellite) {\n        const satellite = select.data.satellites.getSatelliteByKey(state, focusedSatellite);\n        const isReleased = satellitesUtils.isSatelliteReleaseBeforeDate(satellite, selectTime)\n        if(isReleased && viewFixed) {\n            const orbitInfo = select.data.orbits.getByKey(state, `orbit-${focusedSatellite}`);\n            const mapView = select.map.getPureView(state);\n            dispatch(setNavigatorFromOrbit(new Date(time), orbitInfo, mapView, mapView.heading, mapView.roll, mapView.tilt));\n        } else if(!isReleased && viewFixed){\n            //release focused satellite if selected date is before satellite release\n            dispatch(focusSatellite(null))\n            //TODO - dont set prev navigator, but respect current\n            const prevNavigator = select.components.navigatorBackup.getSubstate(state);\n            dispatch(setView(prevNavigator));\n            dispatch(clearComponent('navigatorBackup'));\n\n        }\n    }\n\n    return {\n        type: types.CHANGE_SELECTTIME,\n        payload: time\n    }\n}\n\n/**\n * \n * @param {string} time \n */\nexport const changeCurrentTime = time => {\n    return {\n        type: types.CHANGE_CURRENTTIME,\n        payload: time\n    }\n}\n\n/**\n * \n * @param {bool} followNow \n */\nexport const setFollowNow = followNow => {\n    return {\n        type: types.FOLLOW_NOW,\n        payload: followNow\n      };\n}\n\n/**\n * \n * @param {bool} trackTime \n */\nexport const setTrackTime = trackTime => {\n    return {\n        type: types.TRACK_TIME,\n        payload: trackTime\n      };\n}\n\nexport const updateComponent = (component, data) => {\n\treturn {\n\t\ttype: types.COMPONENT.UPDATE,\n\t\tcomponent: component,\n\t\tupdate: data\n\t}\n}\n\nexport const setComponent = (component, path, value) => {\n\treturn {\n\t\ttype: types.COMPONENT.SET,\n\t\tcomponent,\n\t\tpath,\n\t\tvalue\n\t}\n}\nexport const clearComponent = (component) => {\n\treturn {\n\t\ttype: types.COMPONENT.CLEAR,\n\t\tcomponent,\n\t}\n}\n\nexport const nowTick = (dispatch, state) => {\n    const now = getNowUTCString();\n    dispatch(changeCurrentTime(now.toString()));\n    if(select.rootSelectors.getFollowNow(state)) {\n        dispatch(changeSelectTime(now, dispatch, select.rootSelectors.getSelectTime(state), state));\n    }\n};\n\nexport const stopTimer = () => {\n    return setTrackTime(false);\n}\n\nexport const startTimer = (state, dispatch) => {\n    return setTrackTime(true);\n}\n\nexport const stopFollowNow = () => {\n    return setFollowNow(false);\n}\n\n/**\n * \n * @param {bool} landscape \n */\nexport const setOrientation = (landscape) => {\n    return {\n        type: types.CHANGE_LANDSCAPE,\n        payload: landscape\n    }\n}\n\n/**\n * \n * @param {string} layerKey \n * @param {object} change \n */\nexport const updateActiveLayer = (layerKey, change) => {\n    return {\n        type: types.UPDATE_ACTIVE_LAYER,\n        payload: {\n            layerKey,\n            change\n        }\n    }\n}\n\n/**\n * @param {Array.<Object>} - orbits\n */\nexport const setOrbits = (orbits) => {\n    return {\n        type: types.SET_ORBITS,\n        payload: {\n            orbits\n        }\n    }\n}\n\n/**\n * \n */\nexport const updateTleData = (dispatch, selectTime) => {\n    const selectTimeMoment = moment(selectTime);\n    const nowTimeMoment = moment();\n    if(selectTimeMoment.isBefore(nowTimeMoment)) {\n        getTle(selectTimeMoment.format('YYYY-MM-DD')).then((data) => {\n            if(data && data.length > 0) {\n                return dispatch(setOrbits(data));\n            }\n        });\n    }\n}\n\n\n/**\n * @param {Array.<Object>} - orbits\n */\nexport const setAcquisitionPlans = (aps) => {\n    return {\n        type: types.SET_ACQUISITION_PLANS,\n        payload: {\n            aps\n        }\n    }\n}\n\n/**\n * \n */\nexport const updateApsData = async (dispatch) => {\n    const aps = await getAllAcquisitionPlans()\n    dispatch(setAcquisitionPlans(aps));\n}\n\n/**\n * \n */\nexport const mapAddVisibleAcquisitionPlanKey = (acquisitionPlanKey) => {\n    return {\n        type: types.MAP_ADD_VISIBLE_ACQUISITION_PLAN,\n        payload: {\n            key: acquisitionPlanKey\n        }\n    }\n}\n\n/**\n * \n */\nexport const mapRemoveVisibleAcquisitionPlanKey = (acquisitionPlanKey) => {\n    return {\n        type: types.MAP_REMOVE_VISIBLE_ACQUISITION_PLAN,\n        payload: {\n            key: acquisitionPlanKey\n        }\n    }\n}\n\n/**\n * \n */\nexport const dataUpdateAcquisitionPlan = (layerKey, satName, url, update) => {\n    return {\n        type: types.DATA_UPDATE_ACQUISITIONPLANS,\n        payload: {\n            key: satName,\n            url,\n            update,\n        }\n    }\n}\n\nexport const dataAcquisitionPlanSetVisibleCount = (satName, count) => {\n    return {\n        type: types.DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT,\n        payload: {\n            key: satName,\n            count,\n        }\n    }\n}\n\n/**\n * \n */\nexport const toggleAcquisitionPlan = (state, acquisitionPlanKey) => {\n    const acquisitionPlanVisible = select.map.isVisibleAcquisitionPlanByKey(state, acquisitionPlanKey);\n    const action = acquisitionPlanVisible ? types.MAP_REMOVE_VISIBLE_ACQUISITION_PLAN : types.MAP_ADD_VISIBLE_ACQUISITION_PLAN;\n    return {\n        type: action,\n        payload: {\n            key: acquisitionPlanKey\n        }\n    }\n}\n\n/**\n * \n */\nexport const toggleStatistics = (state, satKey) => {\n    const statisticsVisible = select.map.isVisibleStatisticsByKey(state, satKey);\n    const action = statisticsVisible ? types.MAP.REMOVE_STATISTICS_LAYER : types.MAP.ADD_STATISTICS_LAYER;\n    return {\n        type: action,\n        payload: {\n            key: satKey\n        }\n    }\n}\n\n\nexport const searchProducts = (satelliteId, layerId) => {\n    \n}\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M16,18.692c-0.192,0-0.361-0.073-0.509-0.221L5.17,8.149C5.022,8.003,4.948,7.833,4.948,7.641\n\tc0-0.191,0.074-0.362,0.222-0.509l1.107-1.107c0.148-0.147,0.316-0.222,0.509-0.222s0.362,0.074,0.51,0.222L16,14.729l8.704-8.704\n\tc0.147-0.147,0.317-0.222,0.51-0.222c0.191,0,0.361,0.074,0.509,0.222l1.107,1.107c0.147,0.146,0.222,0.317,0.222,0.509\n\tc0,0.192-0.074,0.362-0.222,0.509L16.51,18.472C16.361,18.619,16.192,18.692,16,18.692z M16,27.197\n\tc-0.192,0-0.361-0.073-0.509-0.222L5.17,16.654c-0.147-0.146-0.222-0.316-0.222-0.509c0-0.191,0.074-0.362,0.222-0.51l1.107-1.107\n\tc0.148-0.146,0.316-0.221,0.509-0.221s0.362,0.074,0.51,0.221L16,23.233l8.704-8.705c0.147-0.146,0.317-0.221,0.51-0.221\n\tc0.191,0,0.361,0.074,0.509,0.221l1.107,1.107c0.147,0.147,0.222,0.318,0.222,0.51c0,0.192-0.074,0.362-0.222,0.509L16.51,26.976\n\tC16.361,27.124,16.192,27.197,16,27.197z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M13.308,16c0-0.192,0.073-0.361,0.221-0.509L23.851,5.17c0.146-0.147,0.316-0.222,0.509-0.222\n\tc0.191,0,0.362,0.074,0.509,0.222l1.107,1.107c0.147,0.148,0.222,0.316,0.222,0.509s-0.074,0.362-0.222,0.51L17.271,16l8.704,8.704\n\tc0.147,0.147,0.222,0.317,0.222,0.51c0,0.191-0.074,0.361-0.222,0.509l-1.107,1.107c-0.146,0.147-0.317,0.222-0.509,0.222\n\tc-0.192,0-0.362-0.074-0.509-0.222L13.528,16.51C13.381,16.361,13.308,16.192,13.308,16z M4.803,16c0-0.192,0.073-0.361,0.222-0.509\n\tL15.346,5.17c0.146-0.147,0.316-0.222,0.509-0.222c0.191,0,0.362,0.074,0.51,0.222l1.107,1.107c0.146,0.148,0.221,0.316,0.221,0.509\n\ts-0.074,0.362-0.221,0.51L8.767,16l8.705,8.704c0.146,0.147,0.221,0.317,0.221,0.51c0,0.191-0.074,0.361-0.221,0.509l-1.107,1.107\n\tc-0.147,0.147-0.318,0.222-0.51,0.222c-0.192,0-0.362-0.074-0.509-0.222L5.024,16.51C4.876,16.361,4.803,16.192,4.803,16z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M18.692,16c0,0.192-0.073,0.361-0.221,0.509L8.15,26.83c-0.147,0.147-0.317,0.222-0.509,0.222\n\tc-0.191,0-0.362-0.074-0.509-0.222l-1.107-1.107c-0.147-0.148-0.222-0.316-0.222-0.509s0.074-0.362,0.222-0.51L14.729,16\n\tL6.024,7.296C5.877,7.148,5.803,6.979,5.803,6.787s0.074-0.362,0.222-0.509L7.132,5.17C7.279,5.022,7.45,4.948,7.641,4.948\n\tc0.192,0,0.362,0.074,0.509,0.222l10.322,10.32C18.619,15.639,18.692,15.808,18.692,16z M27.197,16c0,0.192-0.073,0.361-0.222,0.509\n\tL16.654,26.83c-0.146,0.147-0.316,0.222-0.509,0.222c-0.191,0-0.362-0.074-0.51-0.222l-1.107-1.107\n\tc-0.147-0.148-0.221-0.316-0.221-0.509s0.074-0.362,0.221-0.51L23.233,16l-8.705-8.704c-0.147-0.147-0.221-0.317-0.221-0.509\n\ts0.074-0.362,0.221-0.509l1.107-1.107c0.147-0.148,0.318-0.222,0.51-0.222c0.192,0,0.362,0.074,0.509,0.222l10.321,10.32\n\tC27.124,15.639,27.197,15.808,27.197,16z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M16,13.308c0.192,0,0.361,0.073,0.509,0.221L26.83,23.851c0.147,0.146,0.222,0.316,0.222,0.509\n\tc0,0.191-0.074,0.362-0.222,0.509l-1.107,1.107c-0.148,0.147-0.316,0.222-0.509,0.222s-0.362-0.074-0.51-0.222L16,17.271\n\tl-8.704,8.704c-0.147,0.147-0.317,0.222-0.509,0.222s-0.362-0.074-0.509-0.222L5.17,24.868c-0.148-0.146-0.222-0.317-0.222-0.509\n\tc0-0.192,0.074-0.362,0.222-0.509l10.32-10.322C15.639,13.381,15.808,13.308,16,13.308z M16,4.803c0.192,0,0.361,0.073,0.509,0.222\n\tL26.83,15.346c0.147,0.146,0.222,0.316,0.222,0.509c0,0.191-0.074,0.362-0.222,0.51l-1.107,1.107\n\tc-0.148,0.146-0.316,0.221-0.509,0.221s-0.362-0.074-0.51-0.221L16,8.767l-8.704,8.705c-0.147,0.146-0.317,0.221-0.509,0.221\n\ts-0.362-0.074-0.509-0.221L5.17,16.364c-0.148-0.147-0.222-0.318-0.222-0.51c0-0.192,0.074-0.362,0.222-0.509l10.32-10.321\n\tC15.639,4.876,15.808,4.803,16,4.803z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<rect className=\"line\" x=\"5.578\" y=\"15\" width=\"21.125\" height=\"2\"/>\n\t\t<polygon className=\"line\" points=\"12.977,25.095 3.882,16 12.977,6.905 14.391,8.319 6.71,16 14.391,23.681\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 26,16 A 10,10 0 0 1 16,26 10,10 0 0 1 6,16 10,10 0 0 1 16,6 10,10 0 0 1 26,16 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 21.292969,3.2929688 8.5859375,16 21.292969,28.707031 22.707031,27.292969 11.414062,16 22.707031,4.7070312 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 10,3.2929688 8.5859375,4.7070312 19.878906,16 8.5859375,27.292969 10,28.707031 22.707031,16 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"polygon\" d=\"M8 8 l0 18 l16 0 l0 -18\" strokeWidth=\"2\" stroke=\"black\" strokeLinejoin=\"round\" fill=\"transparent\"/>\n\t\t<path className=\"line\" d=\"M5 8 l22 0\" strokeWidth=\"2\" stroke=\"black\" strokeLinecap=\"round\"/>\n\t\t<path className=\"line\" d=\"M14 12 l0 10\" strokeWidth=\"2\" stroke=\"black\" strokeLinecap=\"round\"/>\n\t\t<path className=\"line\" d=\"M18 12 l0 10\" strokeWidth=\"2\" stroke=\"black\" strokeLinecap=\"round\"/>\n\t\t<path className=\"polygon\" d=\"M10 8 l3 -4 l6 0 l3 4\" strokeWidth=\"2\" stroke=\"black\" strokeLinejoin=\"round\" fill=\"transparent\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<circle className=\"line\" cx=\"16\" cy=\"8\" r=\"2.4\"/>\n\t\t<circle className=\"line\" cx=\"16\" cy=\"16\" r=\"2.4\"/>\n\t\t<circle className=\"line\" cx=\"16\" cy=\"24\" r=\"2.4\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M5 27 l22 0\" strokeWidth=\"2\" stroke=\"black\"/>\n\t\t<path className=\"line\" d=\"M16 5 l0 18\" strokeWidth=\"2\" stroke=\"black\"/>\n\t\t<path className=\"line\" d=\"M9 16 l8 8\" strokeWidth=\"2\" stroke=\"black\"/>\n\t\t<path className=\"line\" d=\"M23 16 l-8 8\" strokeWidth=\"2\" stroke=\"black\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M5.382,26.619l1.641-5.399l0.059-0.059l15.781-15.78l3.757,3.758L10.78,24.977L5.382,26.619z M7.597,21.562\n\t\tl-1.242,4.083l4.082-1.242L25.703,9.139l-2.841-2.842L7.597,21.562z\"/>\n\t\t<rect className=\"line\" x=\"6.628\" y=\"22.713\" transform=\"matrix(-0.7071 -0.7071 0.7071 -0.7071 -0.9941 45.6625)\" width=\"4.664\" height=\"0.649\"/>\n\t\t<polygon className=\"line\" points=\"7.99,25.49 5.968,26.031 6.509,24.009\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g transform=\"scale(0.015,-0.015) translate(300,-1636)\">\n\t\t<path className=\"line\"\n\t\t\t   d=\"M755 480q0 -13 -10 -23l-332 -332l144 -144q19 -19 19 -45t-19 -45t-45 -19h-448q-26 0 -45 19t-19 45v448q0 26 19 45t45 19t45 -19l144 -144l332 332q10 10 23 10t23 -10l114 -114q10 -10 10 -23zM1536 1344v-448q0 -26 -19 -45t-45 -19t-45 19l-144 144l-332 -332\nq-10 -10 -23 -10t-23 10l-114 114q-10 10 -10 23t10 23l332 332l-144 144q-19 19 -19 45t19 45t45 19h448q26 0 45 -19t19 -45z\" />\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M26,12.832c0,0.174-0.066,0.327-0.2,0.461l-9.339,9.337c-0.134,0.134-0.287,0.201-0.461,0.201s-0.327-0.067-0.461-0.201\n\tL6.2,13.293C6.066,13.159,6,13.006,6,12.832s0.066-0.327,0.2-0.461l1.002-1.002c0.134-0.134,0.287-0.2,0.461-0.2\n\ts0.327,0.066,0.461,0.2L16,19.243l7.876-7.874c0.134-0.134,0.287-0.2,0.461-0.2s0.327,0.066,0.461,0.2l1.002,1.002\n\tC25.934,12.505,26,12.658,26,12.832z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 5,4 H 28 L 18.535874,15 18.453432,25 13,27 V 15 L 4,4 h 1\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M20.653,25.472h-1.695V13.243c0-0.423-0.343-0.766-0.766-0.766h-3.207h-1.179h-2.46c-0.423,0-0.766,0.343-0.766,0.766v0.563\n\tc0,0.424,0.343,0.766,0.766,0.766h1.694v10.899h-1.695c-0.423,0-0.766,0.343-0.766,0.766v0.563c0,0.424,0.343,0.766,0.766,0.766\n\th2.456c0.002,0,0.003,0.001,0.005,0.001h4.386c0.002,0,0.003-0.001,0.005-0.001h2.456c0.423,0,0.766-0.342,0.766-0.766v-0.563\n\tC21.419,25.814,21.076,25.472,20.653,25.472z\"/>\n\t\t<circle className=\"line\" cx=\"16\" cy=\"7.583\" r=\"3.151\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path d=\"M5 5 l0 17 l5 0 l0 -12 l12 0 l0 -5\" strokeWidth=\"2\" className=\"polygonFilled\"/>\n\t\t<path d=\"M10 22 l0 5 l17 0 l0 -17 l-5 0 l0 12 l-12 0\" strokeWidth=\"2\" className=\"polygon\"/>\n\t\t<path d=\"M10 10 L22 22\" strokeWidth=\"2\" className=\"line\"/>\n\t\t<path d=\"M16 10 L22 16\" strokeWidth=\"2\" className=\"line\"/>\n\t\t<path d=\"M10 16 L16 22\" strokeWidth=\"2\" className=\"line\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 16,2.8828125 1.7636719,10 3.5527344,10.894531 16,17.117188 30.236328,10 Z M 16,5.1171875 25.763672,10 16,14.882812 6.2363281,10 Z\"/>\n\t\t<path className=\"line\" d=\"M 9.5527344,12.105469 1.7636719,16 16,23.117188 30.236328,16 22.447266,12.105469 21.552734,13.894531 25.763672,16 16,20.882812 6.2363281,16 10.447266,13.894531 Z\"/>\n\t\t<path className=\"line\" d=\"M 9.5527344,18.105469 1.7636719,22 16,29.117188 30.236328,22 22.447266,18.105469 21.552734,19.894531 25.763672,22 16,26.882812 6.2363281,22 10.447266,19.894531 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 10,25 A 3.5,3.5 0 0 1 6.5,28.5 3.5,3.5 0 0 1 3,25 3.5,3.5 0 0 1 6.5,21.5 3.5,3.5 0 0 1 10,25 Z\"/>\n\t\t<path className=\"line\" d=\"m 4,12.5 h 5 c 0.554,0 1,0.446 1,1 v 5 c 0,0.554 -0.446,1 -1,1 H 4 c -0.554,0 -1,-0.446 -1,-1 v -5 c 0,-0.554 0.446,-1 1,-1 z\"/>\n\t\t<path className=\"line\" d=\"M 6.5488281,4.0214844 C 6.3688189,4.0168495 6.200219,4.1093556 6.1074219,4.2636719 l -3,4.9785156 C 2.9071078,9.5751818 3.1465554,9.9994087 3.5351562,10 h 6 C 9.9237571,9.9994087 10.163205,9.5751818 9.9628906,9.2421875 l -3,-4.9785156 C 6.8751262,4.1176904 6.7190891,4.0264234 6.5488281,4.0214844 Z M 8.6503906,9 V 9 H 4.4199219 Z\"/>\n\t\t<path className=\"line\" d=\"m 14.080078,6 a 1.0001,1.0001 0 1 0 0,2 h 13.853516 a 1.0001,1.0001 0 1 0 0,-2 z\"/>\n\t\t<path className=\"line\" d=\"m 14.080078,15 a 1.0001,1.0001 0 1 0 0,2 h 13.853516 a 1.0001,1.0001 0 1 0 0,-2 z\"/>\n\t\t<path className=\"line\" d=\"m 14.080078,24 a 1.0001,1.0001 0 1 0 0,2 h 13.853516 a 1.0001,1.0001 0 1 0 0,-2 z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"m 19.703125,14.544922 -3.705078,5.810547 -3.697266,-5.78125 -4.2128904,2.693359 7.9140624,12.376953 7.916016,-12.410156 z M 16,2.5 c -5.217094,0 -9.5,4.2829065 -9.5,9.5 0,5.217094 4.282906,9.5 9.5,9.5 5.217094,0 9.5,-4.282906 9.5,-9.5 0,-5.2170935 -4.282906,-9.5 -9.5,-9.5 z m 0,5 c 2.514893,0 4.5,1.985107 4.5,4.5 0,2.514893 -1.985107,4.5 -4.5,4.5 -2.514893,0 -4.5,-1.985107 -4.5,-4.5 0,-2.514893 1.985107,-4.5 4.5,-4.5 z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<rect className=\"line\" x=\"4\" y=\"15.2\" width=\"24\" height=\"1.6\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M27.088,17.484c0,0.423-0.343,0.766-0.766,0.766H5.677c-0.423,0-0.766-0.343-0.766-0.766v-2.969\n\tc0-0.423,0.343-0.766,0.766-0.766h20.646c0.423,0,0.766,0.343,0.766,0.766V17.484z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M16.983,3.272l7.351,22.055c0.139,0.398,0.055,0.75-0.252,1.057c-0.037,0.038-0.104,0.089-0.193,0.148\n\tc-0.209,0.13-0.431,0.182-0.667,0.149c-0.237-0.029-0.44-0.131-0.609-0.298l-6.617-6.616l-6.617,6.616\n\tc-0.168,0.167-0.371,0.269-0.609,0.298c-0.237,0.032-0.459-0.02-0.666-0.149c-0.207-0.13-0.352-0.306-0.437-0.528\n\tc-0.084-0.222-0.087-0.446-0.011-0.677l7.352-22.055c0.045-0.153,0.131-0.292,0.253-0.414c0.207-0.206,0.452-0.306,0.735-0.298\n\tc0.223-0.008,0.425,0.054,0.609,0.184C16.788,2.874,16.915,3.05,16.983,3.272z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<rect className=\"line\" x=\"15.2\" y=\"4\" width=\"1.6\" height=\"24\"/>\n\t\t<rect className=\"line\" x=\"4\" y=\"15.2\" width=\"24\" height=\"1.6\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M27.088,17.484c0,0.423-0.343,0.766-0.766,0.766H5.677c-0.423,0-0.766-0.343-0.766-0.766v-2.969\n\tc0-0.423,0.343-0.766,0.766-0.766h20.646c0.423,0,0.766,0.343,0.766,0.766V17.484z\"/>\n\t\t<path className=\"line\" d=\"M17.484,4.912c0.423,0,0.766,0.343,0.766,0.766v20.646c0,0.423-0.343,0.766-0.766,0.766h-2.969\n\tc-0.423,0-0.766-0.343-0.766-0.766V5.677c0-0.423,0.343-0.766,0.766-0.766H17.484z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g transform=\"scale(0.016,-0.016) translate(450,-1636)\">\n\t\t<path className=\"line\"\n\t\t\t   d=\"M480 672v448q0 14 -9 23t-23 9t-23 -9t-9 -23v-448q0 -14 9 -23t23 -9t23 9t9 23zM1152 320q0 -26 -19 -45t-45 -19h-429l-51 -483q-2 -12 -10.5 -20.5t-20.5 -8.5h-1q-27 0 -32 27l-76 485h-404q-26 0 -45 19t-19 45q0 123 78.5 221.5t177.5 98.5v512q-52 0 -90 38\nt-38 90t38 90t90 38h640q52 0 90 -38t38 -90t-38 -90t-90 -38v-512q99 0 177.5 -98.5t78.5 -221.5z\" />\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"polygon\" d=\"M11 11 L11 5 L27 5 L27 21 L21 21\" strokeWidth=\"3\"/>\n\t\t<rect className=\"polygon\" x=\"5\" y=\"11\" width=\"16\" height=\"16\" strokeWidth=\"3\"/>\n\t\t<rect className=\"line\" x=\"5\" y=\"11\" width=\"16\" height=\"4\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M27,16c0,1.489-0.292,2.913-0.874,4.269c-0.581,1.354-1.366,2.526-2.349,3.509s-2.154,1.768-3.509,2.349\n\tC18.913,26.708,17.489,27,16,27c-1.642,0-3.204-0.346-4.684-1.038c-1.48-0.693-2.741-1.669-3.781-2.93\n\tc-0.067-0.095-0.098-0.202-0.093-0.322s0.045-0.216,0.122-0.293l1.962-1.977c0.096-0.086,0.215-0.129,0.358-0.129\n\tc0.152,0.02,0.263,0.077,0.329,0.172c0.697,0.907,1.552,1.609,2.564,2.105c1.012,0.495,2.086,0.744,3.223,0.744\n\tc0.994,0,1.94-0.193,2.843-0.58s1.684-0.909,2.342-1.568c0.659-0.658,1.182-1.439,1.568-2.342s0.58-1.849,0.58-2.843\n\tc0-0.993-0.193-1.941-0.58-2.843s-0.909-1.683-1.568-2.342c-0.658-0.659-1.439-1.182-2.342-1.568S16.994,8.667,16,8.667\n\tc-0.936,0-1.833,0.17-2.693,0.509s-1.623,0.823-2.292,1.454l1.962,1.977c0.296,0.287,0.363,0.616,0.2,0.988\n\tc-0.162,0.382-0.444,0.573-0.845,0.573H5.917c-0.248,0-0.463-0.091-0.645-0.272C5.091,13.713,5,13.499,5,13.25V6.833\n\tc0-0.401,0.191-0.683,0.573-0.845c0.373-0.163,0.702-0.095,0.988,0.201l1.862,1.848c1.021-0.965,2.189-1.712,3.502-2.242\n\tC13.238,5.265,14.596,5,16,5c1.489,0,2.913,0.292,4.269,0.874c1.354,0.583,2.526,1.366,3.509,2.349s1.768,2.153,2.349,3.509\n\tC26.708,13.087,27,14.51,27,16z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M5.874,11.732c0.581-1.356,1.366-2.526,2.349-3.509s2.154-1.767,3.509-2.349C13.087,5.292,14.511,5,16,5\n\tc1.403,0,2.762,0.265,4.074,0.795c1.313,0.53,2.48,1.277,3.502,2.242l1.862-1.848c0.286-0.296,0.616-0.363,0.988-0.201\n\tC26.809,6.151,27,6.432,27,6.833v6.417c0,0.249-0.091,0.463-0.272,0.645s-0.396,0.272-0.645,0.272h-6.417\n\tc-0.4,0-0.683-0.191-0.845-0.573c-0.162-0.373-0.096-0.702,0.2-0.988l1.963-1.977c-0.669-0.63-1.433-1.115-2.292-1.454\n\tS16.936,8.667,16,8.667c-0.994,0-1.94,0.193-2.843,0.58s-1.684,0.91-2.342,1.568c-0.659,0.659-1.182,1.439-1.568,2.342\n\ts-0.58,1.85-0.58,2.843c0,0.994,0.193,1.94,0.58,2.843s0.909,1.684,1.568,2.342c0.658,0.659,1.439,1.182,2.342,1.568\n\ts1.849,0.58,2.843,0.58c1.136,0,2.21-0.249,3.223-0.744c1.012-0.496,1.866-1.198,2.563-2.105c0.066-0.095,0.177-0.152,0.329-0.172\n\tc0.144,0,0.263,0.043,0.358,0.129l1.962,1.977c0.077,0.077,0.117,0.173,0.122,0.293s-0.026,0.228-0.093,0.322\n\tc-1.041,1.261-2.302,2.236-3.781,2.93C19.203,26.654,17.642,27,16,27c-1.489,0-2.913-0.292-4.269-0.874\n\tc-1.354-0.581-2.526-1.366-3.509-2.349s-1.768-2.154-2.349-3.509C5.292,18.913,5,17.489,5,16C5,14.51,5.292,13.087,5.874,11.732z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 13,3 C 7.4889972,3 3,7.4889972 3,13 3,18.511003 7.4889972,23 13,23 18.511003,23 23,18.511003 23,13 23,7.4889972 18.511003,3 13,3 Z m 0,2 c 4.430123,0 8,3.5698773 8,8 0,4.430123 -3.569877,8 -8,8 C 8.5698773,21 5,17.430123 5,13 5,8.5698773 8.5698773,5 13,5 Z\"/>\n\t\t<path className=\"line\" d=\"m 20.707031,19.292969 -1.414062,1.414062 9,9 1.414062,-1.414062 z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<circle className=\"line\" cx=\"6.998\" cy=\"16\" r=\"3.15\"/>\n\t\t<circle className=\"line\" cx=\"24.005\" cy=\"8.513\" r=\"3.149\"/>\n\t\t<circle className=\"line\" cx=\"24.005\" cy=\"23.484\" r=\"3.149\"/>\n\t\t<path className=\"line\" d=\"M19.623,10.034c-0.003-0.005-0.002-0.012-0.004-0.018c-0.003-0.005-0.008-0.009-0.012-0.014\n\tc-0.042-0.082-0.111-0.149-0.206-0.184l0,0l-0.264-0.096L16.36,8.711c-0.199-0.072-0.418,0.03-0.492,0.229l-0.095,0.265\n\tc-0.073,0.2,0.029,0.418,0.229,0.49l1.724,0.627l-6.156,2.87c-0.192,0.089-0.275,0.317-0.185,0.509l0.119,0.255\n\tc0.09,0.192,0.317,0.275,0.509,0.185l6.155-2.87l-0.627,1.722c-0.072,0.199,0.029,0.418,0.229,0.491l0.264,0.096\n\tc0.199,0.072,0.418-0.03,0.492-0.229l1.01-2.778l0.097-0.263V10.31C19.665,10.216,19.658,10.119,19.623,10.034z\"/>\n\t\t<path className=\"line\" d=\"M19.623,21.83c-0.003,0.006-0.002,0.013-0.004,0.018c-0.003,0.006-0.008,0.01-0.012,0.015\n\tc-0.042,0.081-0.111,0.149-0.206,0.185l0,0l-0.264,0.096l-2.777,1.012c-0.199,0.071-0.418-0.031-0.492-0.229l-0.095-0.265\n\tc-0.073-0.199,0.029-0.418,0.229-0.49l1.724-0.627l-6.156-2.871c-0.192-0.089-0.275-0.316-0.185-0.508l0.119-0.256\n\tc0.09-0.191,0.317-0.274,0.509-0.185l6.155,2.87l-0.627-1.723c-0.072-0.199,0.029-0.418,0.229-0.49l0.264-0.097\n\tc0.199-0.071,0.418,0.03,0.492,0.229l1.01,2.777l0.097,0.264l0,0C19.665,21.648,19.658,21.746,19.623,21.83z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n<g transform=\"matrix(0.05117622,0,0,0.05117622,2.9443694,-1.5263058)\">\n\t<path className=\"line\" d=\"m 224.595,201.822 h -93.576 c -6.879,0 -13.674,3.236 -15.211,7.307 l -24.902,66.025 c -2.188,5.797 2.867,10.61 11.34,10.61 h 115.271 c 8.477,0 15.584,-4.813 15.873,-10.611 l 3.295,-66.024 c 0.203,-4.072 -5.211,-7.307 -12.09,-7.307 z\"/>\n\t<path className=\"line\" d=\"m 379.204,201.821 -93.574,0.001 c -6.879,0 -12.293,3.236 -12.092,7.307 l 3.293,66.024 c 0.291,5.798 7.4,10.611 15.873,10.611 h 115.275 c 8.473,0 13.525,-4.813 11.338,-10.611 l -24.902,-66.024 c -1.536,-4.072 -8.334,-7.308 -15.211,-7.308 z\"/>\n\t<path className=\"line\" d=\"M 419.61,319.696 H 295.565 c -9.117,0 -16.227,5.703 -15.865,12.927 l 6.236,125.035 c 0.586,11.742 10.93,21.594 23.078,21.594 h 165.289 c 12.148,0 18.283,-9.852 13.855,-21.594 L 440.994,332.623 c -2.722,-7.225 -12.267,-12.927 -21.384,-12.927 z\"/>\n\t<path className=\"line\" d=\"m 214.657,319.696 -124.043,10e-4 c -9.121,0 -18.662,5.702 -21.387,12.926 L 22.065,457.657 c -4.428,11.742 1.703,21.594 13.855,21.594 h 165.285 c 12.152,0 22.492,-9.852 23.076,-21.594 l 6.24,-125.035 c 0.363,-7.223 -6.745,-12.926 -15.864,-12.926 z\"/>\n</g>\n);\n","import React from 'react';\n\nexport default props => (\n<g transform=\"matrix(0.05016772,0,0,0.05016772,3.2140793,3.141888)\">\n\t<path className=\"line\" d=\"M 210.81,37.038 H 55.599 c -11.047,0 -20,8.954 -20,20 v 155.211 c 0,11.046 8.953,20 20,20 H 210.81 c 11.045,0 20,-8.954 20,-20 V 57.038 c 0,-11.046 -8.956,-20 -20,-20 z\"/>\n\t<path className=\"line\" d=\"m 454.127,37.038 h -155.21 c -11.047,0 -20,8.954 -20,20 v 155.211 c 0,11.046 8.953,20 20,20 h 155.211 c 11.045,0 20,-8.954 20,-20 V 57.038 c -10e-4,-11.046 -8.956,-20 -20.001,-20 z\"/>\n\t<path className=\"line\" d=\"m 454.127,280.369 h -155.21 c -11.047,0 -20,8.954 -20,20 V 455.58 c 0,11.046 8.953,20 20,20 h 155.211 c 11.045,0 20,-8.954 20,-20 V 300.369 c -10e-4,-11.046 -8.956,-20 -20.001,-20 z\"/>\n\t<path className=\"line\" d=\"M 210.81,280.369 H 55.599 c -11.047,0 -20,8.954 -20,20 V 455.58 c 0,11.046 8.953,20 20,20 H 210.81 c 11.045,0 20,-8.954 20,-20 V 300.369 c 0,-11.046 -8.956,-20 -20,-20 z\"/>\n</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 7.7070312,6.2929688 6.2929688,7.7070312 24.292969,25.707031 25.707031,24.292969 Z\"/>\n\t\t<path className=\"line\" d=\"M 24.292969,6.2929688 6.2929688,24.292969 7.7070312,25.707031 25.707031,7.7070312 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<polygon className=\"line\" points=\"23.313,10.729 16.001,23.396 8.688,10.729\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M4 27 l24 0\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M4 28 l0 -6\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M28 28 l0 -6\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M16 5 l0 18\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M16 5 l7 7\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M16 5 l-7 7\" strokeWidth=\"2\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\n<g transform=\"matrix(.8602 0 0 .86486 -.4301 -.43243)\" fill=\"none\" fillRule=\"evenodd\">\n    <g fill=\"none\" fillRule=\"evenodd\" >\n      <g transform=\"translate(1 1)\" strokeWidth=\"2\">\n        <circle strokeOpacity=\".5\" cx=\"18\" cy=\"18\" r=\"18\" />\n        <path d=\"M 36,18 C 36,8.06 27.94,0 18,0\">\n          <animateTransform\n            attributeName=\"transform\"\n            type=\"rotate\"\n            from=\"0 18 18\"\n            to=\"360 18 18\"\n            dur=\"1s\"\n            repeatCount=\"indefinite\"\n          />\n        </path>\n      </g>\n    </g>\n</g>\n\n);","import React from 'react';\n\nexport default props => (\n    <g>\n        <g transform=\"matrix(.029895 0 0 .029895 1.0698 1.0507)\">\n            <path className=\"line\" d=\"m500 10c-270.2 0-490 219.8-490 490s219.8 490 490 490 490-219.8 490-490-219.8-490-490-490zm0 896.3c-224 0-406.3-182.3-406.3-406.3s182.3-406.3 406.3-406.3 406.3 182.3 406.3 406.3-182.3 406.3-406.3 406.3z\"/>\n        </g>\n        <g transform=\"matrix(.58975 0 0 1.0043 -4.8033 -.3654)\">\n            <rect className=\"polygon\" x=\"9.322\" y=\"14.812\" width=\"13.449\" height=\"2.3305\"/>\n        <circle className=\"polygon\" transform=\"scale(1,-1)\" cx=\"22.732\" cy=\"-15.977\" r=\"1.1622\"/>\n        <circle className=\"polygon\" cx=\"9.3099\" cy=\"15.978\" r=\"1.1653\"/>\n        </g>\n        <g transform=\"matrix(0 .58975 -1.0043 0 32.365 17.909)\">\n            <rect className=\"polygon\" x=\"9.322\" y=\"14.812\" width=\"13.449\" height=\"2.3305\"/>\n        <circle className=\"polygon\" transform=\"scale(1,-1)\" cx=\"22.732\" cy=\"-15.977\" r=\"1.1622\"/>\n        <circle className=\"polygon\" cx=\"9.3099\" cy=\"15.978\" r=\"1.1653\"/>\n        </g>\n        <g transform=\"matrix(.58975 0 0 1.0043 17.909 -.33431)\">\n            <rect className=\"polygon\" x=\"9.322\" y=\"14.812\" width=\"13.449\" height=\"2.3305\"/>\n        <circle className=\"polygon\" transform=\"scale(1,-1)\" cx=\"22.732\" cy=\"-15.977\" r=\"1.1622\"/>\n        <circle className=\"polygon\" cx=\"9.3099\" cy=\"15.978\" r=\"1.1653\"/>\n        </g>\n        <g transform=\"matrix(0 .58975 -1.0043 0 32.148 -4.8033)\">\n            <rect className=\"polygon\" x=\"9.322\" y=\"14.812\" width=\"13.449\" height=\"2.3305\"/>\n        <circle className=\"polygon\" transform=\"scale(1,-1)\" cx=\"22.732\" cy=\"-15.977\" r=\"1.1622\"/>\n        <circle className=\"polygon\" cx=\"9.3099\" cy=\"15.978\" r=\"1.1653\"/>\n        </g>\n    </g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path d=\"m1.6121 28h28.775c1.037 0 1.4028-0.6125 1.512-0.87611 0.10439-0.25136 0.2684-0.89265-0.3531-1.5882l-13.894-22.385-0.0644-0.10438-0.0868-0.0869c-0.80267-0.80207-2.2002-0.80158-3.0018 0l-0.0869 0.0869-13.958 22.489c-0.6221 0.69554-0.45808 1.3368-0.35418 1.5882 0.10918 0.26321 0.47452 0.8762 1.512 0.8762zm14.388-23.472 13.246 21.341-26.492-4.9e-4z\" strokeWidth=\".097921\"/>\n\t\t<text x=\"12.918264\" y=\"22.888712\" fontFamily=\"Sans\" fontSize=\"15.667px\" letterSpacing=\"0px\" strokeWidth=\".097921px\" wordSpacing=\"0px\" style={{fontFeatureSettings:'normal',fontVariantCaps:'normal',fontVariantLigatures:'normal',fontVariantNumeric:'normal',lineHeight:'125%'}} >\n\t\t\t<tspan x=\"12.918264\" y=\"22.888712\" strokeWidth=\".097921px\">!</tspan>\n\t\t</text>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n  <g transform=\"matrix(0.03061224,0,0,0.03061224,0.69387695,0.69387695)\">\n    <path className={'polygon'} d=\"M 500,10 C 229.8,10 10,229.8 10,500 10,770.2 229.8,990 500,990 770.2,990 990,770.2 990,500 990,229.8 770.2,10 500,10 Z m 0,896.3 C 276,906.3 93.7,724 93.7,500 93.7,276 276,93.7 500,93.7 724,93.7 906.3,276 906.3,500 906.3,724 724,906.3 500,906.3 Z M 325.3,500 c -19.4,0 -35.1,15.6 -35.1,35 0,19.4 15.7,35 35.1,35 h 210 c 19.4,0 35,-15.6 35,-35 V 255.1 c 0,-19.4 -15.6,-35.1 -35,-35.1 -19.4,0 -35,15.7 -35,35.1 V 500 Z\"/>\n  </g>\n)","import React from 'react';\n\nexport default props => (\n  <g transform=\"matrix(.017982 0 0 .017982 -3.9362 -5.3783)\">\n  <path d=\"m956.9 981.1-47-100.6 177.1-82.7 47 100.6z\" />\n  <path d=\"m1124.1 1373.3-41.1-88.2 203.2-94.8 41.1 88.2z\" />\n  <path d=\"m862.1 1633.8-55-77.5 882.5-411.5 55 77.5z\" />\n  <path d=\"m218.9 1372.3 597.7-286.2 144.3 55.7-49.6 147.4-597.7 286.1z\" />\n  <path d=\"m1998.5 785.5-589.8 270.2-144.3-55.6 49.6-147.4 589.8-270.2z\" />\n  <path d=\"m1067.1 1249.4-104.1-228.3l203.2-94.8 104 228.3z\" />\n </g>\n\n);","import React from 'react';\n\nexport default props => (\n  <path d=\"m13.366 8.252 14.345-7.752 3.7891 7.5504-13.011 9.9884zm-2.1152 18.86-0.019375-0.83894-1.6443 1.0405-7.7729-6.7224-1.2572-6.1776 8.7244 6.7688-0.062-1.2639-8.7194-6.9812 6.4564-3.4129l8.5345 5.8099 0.14793 1.6479-4.5853 2.9173 0.09591 1.6233 5.9585 4.3854 0.13805-1.2966-5.5024-4.0204 4.5878-3.0534 5.384 3.0398-0.7347 6.1259-4.3979 4.3745-1.6344-0.97243-1.6048 1.3946-2.8129-2.4487-0.10598-1.4463 0.92196-0.42228z\" strokeWidth=\".025913\"/>\n\n);","import React from 'react';\n\nexport default props => (\n  <path d=\"m17.393 11.325-1.5709-2.6164-0.78004 3.7866 2.2744-0.69643zm8.5956 2.7215 1.0152 1.1523 0.29741-0.35795-1.2396-1.4195zm3.7083-1.3341 1.5958 1.4658-0.63046 2.7928-3.5587 1.1328-1.4302-1.6297-1.1293 0.09494-3.2594-3.7474-1.3341 0.25827-2.3332-0.98851-2.709 0.82818-12.388 9.1726-2.2281-3.0582 15.636-10.845 1.8933 3.1365 2.2941 0.99026 0.70176-0.093 0.03197-3.4019 3.8579 4.3477 0.03391-0.55568-3.792-4.255 4.3548-0.60024 4.4243 3.9914z\" strokeWidth=\".017811\"/>\n\n);","import React from 'react';\n\nexport default props => (\n  <path d=\"m13.577 14.433 0.28406-0.19542-0.41097-5.1072-4.8695 3.4975zm8.1212 7.4342 3.9225 1.2753 4.7547 5.8123-5.8406 2.7218-4.7063-5.3248-0.15714-0.12495-0.23576-2.9172-3.9648 2.5264-0.40292-0.52778-1.8656 1.2108-3.2315-3.4552 0.10679-0.0787 1.0557-2.8367-0.54191-0.71113 1.4767-3.9709 0.957-0.65478-5.0125-1.8112-6.2576-7.279 5.6089-5.0447 6.5356 8.0144 0.08676 0.074235 0.41106 5.1052 3.9608-2.7117 2.7218 3.439c-0.78572 0.3506-1.3317 1.0738-1.3317 1.924 0 1.2028 1.0939 2.1497 2.4056 2.1497 0.1652 0 0.32833-0.0161 0.48548-0.04471l0.0098 2.603zm-1.7246 1.1 0.25383 3.157 4.6902-2.6957-3.8038-1.1906zm2.3511-8.3187c1.1907 0 2.1275 0.85423 2.1275 1.8737s-0.93679 1.8737-2.1275 1.8737c-1.1927 0-2.1295-0.85423-2.1295-1.8737s0.93679-1.8737 2.1295-1.8737z\" strokeWidth=\".020147\"/>\n\n);","import React from 'react';\n\nexport default props => (\n  <path d=\"m12.933 12.306c-0.01259 0.19792 0.07653 0.36386 0.23831 0.48728-2.1363 0.15742-2.6129-0.46384-2.7895-0.98309-0.30428-0.9022 1.0384-2.4852 3.3874-3.3087 2.3491-0.82354 4.4046-0.47876 4.7089 0.42344 0.16595 0.49358 0 1.3767-1.5214 2.4576-0.02519-0.56178-0.87875-0.82993-1.9512-0.59791-1.1108 0.23831-2.0384 0.91915-2.0725 1.5213zm3.496 3.3173 2.1044 0.42557-0.91712 0.69789zm6.1196 1.2341 1.2533 7.1239-4.0386 3.4918-2.1427-10.182 1.5873-1.1086zm-11.918-1.5129-0.64054 0.61496-0.021312-0.46384zm1.2277-0.23192-0.03584-0.06975-0.42131-1.6618c0.56168 0.14473 1.1362 0.183 1.5256 0.18726 1.815-0.07653 3.3322-0.67028 4.5471-1.7831 0.31068-0.25323 0.71494-0.60857 1.0512-1.032l1.0299 0.10637 0.20421 0.67667-4.9833 3.696h-0.14464l2.398 2.2236 2.1831 10.165-6.0195-0.95112-3.1598-9.7581zm-0.80426-0.38721-10.554 2.4044 0.33402-4.7174 8.9092-1.5554c-0.13194 0.37665-0.15539 0.76182-0.053281 1.1469 0.1426 0.53194 0.52991 0.88515 1.0023 1.1192zm7.1345-10.662 5.9686 0.92981-4.5855 5.2302-0.64897-0.08041c0.22126-0.43613 0.3256-0.91915 0.19152-1.4192-0.31494-1.1702-1.8958-1.4958-3.6832-1.2447zm3.0875 7.075 10.224 1.6235-5.8429 4.1237-9.6263-1.9895z\" strokeWidth=\".021278\"/>\n);","import React from 'react';\n\nimport AngleDoubleDown from \"./components/AngleDoubleDown\";\nimport AngleDoubleLeft from \"./components/AngleDoubleLeft\";\nimport AngleDoubleRight from \"./components/AngleDoubleRight\";\nimport AngleDoubleUp from \"./components/AngleDoubleUp\";\nimport ArrowLeft from './components/ArrowLeft';\nimport Circle from './components/Circle';\nimport ChevronLeft from './components/ChevronLeft';\nimport ChevronRight from './components/ChevronRight';\nimport Delete from './components/Delete';\nimport Dots from './components/Dots';\nimport getAngleRight from './components/angle-right-solid';\nimport getAngleLeft from './components/angle-left-solid';\nimport getAngleUp from './components/angle-up-solid';\nimport getAngleDown from './components/angle-down-solid';\nimport Download from './components/Download';\nimport Edit from './components/Edit';\nimport Expand from './components/Expand';\nimport ExpandRow from './components/ExpandRow';\nimport Filter from './components/Filter';\nimport Info from \"./components/Info\";\nimport Opacity from './components/Opacity';\nimport Layers from './components/Layers';\nimport Legend from './components/Legend';\nimport MapPin from './components/MapPin';\nimport Minus from './components/Minus';\nimport MinusThick from './components/MinusThick';\nimport NorthArrow from './components/NorthArrow';\nimport Plus from './components/Plus';\nimport PlusThick from './components/PlusThick';\nimport Pushpin from './components/Pushpin';\nimport Restore from './components/Restore';\nimport RotateLeft from \"./components/RotateLeft\";\nimport RotateRight from \"./components/RotateRight\";\nimport Search from './components/Search';\nimport Share from \"./components/Share\";\nimport getSortDown from './components/sort-down-solid';\nimport getSortUp from './components/sort-up-solid';\nimport TiltMore from './components/TiltMore';\nimport TiltLess from './components/TiltLess';\nimport Times from './components/Times';\nimport TriangleDown from \"./components/TriangleDown\";\nimport getTimes from './components/times-solid';\nimport Upload from './components/Upload';\nimport RotateLeftCircularArrow from './components/RotateLeftCircularArrow';\nimport RotateRightCircularArrow from './components/RotateRightCircularArrow';\nimport LoaderOval from './components/Loader-oval';\nimport Location from './components/Location';\nimport Warning from './components/Warning';\nimport Clock from './components/Clock';\n\nimport Sentinel1 from './components/satellites/Sentinel1';\nimport Sentinel2 from './components/satellites/Sentinel2';\nimport Sentinel3 from './components/satellites/Sentinel3';\nimport Sentinel4 from './components/satellites/Sentinel4';\nimport Sentinel5 from './components/satellites/Sentinel5';\n\nimport './icon.css';\n\nconst icon = key => {\n\tswitch(key) {\n\t\tcase 'angle-double-right':\n\t\t\treturn <AngleDoubleRight />;\n\t\tcase 'angle-double-left':\n\t\t\treturn <AngleDoubleLeft/>;\n\t\tcase 'angle-double-up':\n\t\t\treturn <AngleDoubleUp/>;\n\t\tcase 'angle-double-down':\n\t\t\treturn <AngleDoubleDown/>;\n\t\t// case 'angle-right':\n\t\t// \treturn getAngleRight();\n\t\t// case 'angle-left':\n\t\t// \treturn getAngleLeft();\n\t\t// case 'angle-up':\n\t\t// \treturn getAngleUp();\n\t\t// case 'angle-down':\n\t\t// \treturn getAngleDown();\n\t\tcase 'arrow-left':\n\t\tcase 'back':\n\t\t\treturn <ArrowLeft />;\n\t\tcase 'circle':\n\t\t\treturn <Circle />;\n\t\tcase 'chevron-left':\n\t\t\treturn <ChevronLeft />;\n\t\tcase 'chevron-right':\n\t\t\treturn <ChevronRight />;\n\t\tcase 'delete':\n\t\t\treturn <Delete />; //todo\n\t\tcase 'dots':\n\t\t\treturn <Dots />;\n\t\tcase 'download':\n\t\t\treturn <Download />; //todo\n\t\tcase 'edit':\n\t\t\treturn <Edit />;\n\t\tcase 'expand':\n\t\t\treturn <Expand />; //todo\n\t\tcase 'expand-row':\n\t\t\treturn <ExpandRow />;\n\t\tcase 'filter':\n\t\t\treturn <Filter />;\n\t\tcase 'info':\n\t\t\treturn <Info />;\n\t\tcase 'layers':\n\t\t\treturn <Layers/>;\n\t\tcase 'legend':\n\t\t\treturn <Legend/>;\n\t\tcase 'map-pin':\n\t\t\treturn <MapPin/>;\n\t\tcase 'minus':\n\t\t\treturn <Minus />;\n\t\tcase 'minus-thick':\n\t\t\treturn <MinusThick />;\n\t\tcase 'north-arrow':\n\t\t\treturn <NorthArrow />;\n\t\tcase 'opacity':\n\t\t\treturn <Opacity />; //todo\n\t\tcase 'plus':\n\t\t\treturn <Plus />;\n\t\tcase 'plus-thick':\n\t\t\treturn <PlusThick />;\n\t\tcase 'pushpin':\n\t\t\treturn <Pushpin />; //todo\n\t\tcase 'restore':\n\t\t\treturn <Restore />;\n\t\tcase 'rotate-left':\n\t\t\treturn <RotateLeft />;\n\t\tcase 'rotate-right':\n\t\t\treturn <RotateRight />;\n\t\tcase 'search':\n\t\t\treturn <Search />; //todo\n\t\tcase 'share':\n\t\t\treturn <Share />;\n\t\tcase 'tilt-less':\n\t\t\treturn <TiltLess />; //todo\n\t\tcase 'tilt-more':\n\t\t\treturn <TiltMore />; //todo\n\t\tcase 'times':\n\t\tcase 'close':\n\t\t\treturn <Times />;\n\t\tcase 'triangle-down':\n\t\t\treturn <TriangleDown />;\n\t\tcase 'warning':\n\t\t\treturn <Warning />;\n\t\t// case 'sort-down':\n\t\t// \treturn getSortDown();\n\t\t// case 'sort-up':\n\t\t// \treturn getSortUp();\n\t\tcase 'upload':\n\t\t\treturn <Upload />; //todo\n\t\tcase 'sentinel-1':\n\t\t\treturn <Sentinel1 />;\n\t\tcase 'sentinel-2':\n\t\t\treturn <Sentinel2 />;\n\t\tcase 'sentinel-3':\n\t\t\treturn <Sentinel3 />;\n\t\tcase 'sentinel-4':\n\t\t\treturn <Sentinel4 />;\n\t\tcase 'sentinel-5':\n\t\t\treturn <Sentinel5 />;\n\t\tcase 'location':\n\t\t\treturn <Location />;\n\t\tcase 'loader-oval':\n\t\t\treturn <LoaderOval />;\n\t\tcase 'clock':\n\t\t\treturn <Clock />;\n\t\t// case 'times':\n\t\t// \treturn getTimes();\n\t\tdefault:\n\t\t\treturn (\n\t\t\t\t<g>\n\t\t\t\t\t<rect x=\"4.844\" y=\"4.844\" fill=\"none\" stroke=\"#FF3333\" strokeMiterlimit=\"10\" width=\"22.313\" height=\"22.313\"/>\n\t\t\t\t\t<line fill=\"none\" stroke=\"#FF3333\" strokeMiterlimit=\"10\" x1=\"27.156\" y1=\"4.844\" x2=\"4.844\" y2=\"27.156\"/>\n\t\t\t\t\t<line fill=\"none\" stroke=\"#FF3333\" strokeMiterlimit=\"10\" x1=\"4.844\" y1=\"4.844\" x2=\"27.156\" y2=\"27.156\"/>\n\t\t\t\t</g>\n\t\t\t);\n\t}\n};\n\nexport default props => (\n\t<svg\n\t\tstyle={props.style} //todo better solution (used for transform: rotate)\n\t\tversion=\"1.1\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\txmlnsXlink=\"http://www.w3.org/1999/xlink\"\n\t\tx=\"0px\"\n\t\ty=\"0px\"\n\t\twidth=\"32px\"\n\t\theight=\"32px\"\n\t\tviewBox=\"0 0 32 32\"\n\t\txmlSpace=\"preserve\"\n\t\tclassName={`ptr-icon ${props.className || ''}`}\n\t>\n\t\t{typeof props.icon === \"function\" ? props.icon() : icon(props.icon)}\n\t</svg>\n);\n","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport React from 'react';\nimport ReactModal from 'react-modal';\nimport Icon from '../atoms/Icon';\n\nReactModal.setAppElement('#root');\n\nconst innerContentStyle = css({\n    width: '100%',\n    height: '100%',\n    position: 'relative',\n});\n\nconst closeStyle = css({\n    display: 'flex',\n    flexFlow: 'column',\n    position: 'absolute',\n    cursor: 'pointer',\n    top: '16px',\n    right: '16px',\n    fill: 'rgb(226, 236, 249)',\n    stroke: 'rgb(226, 236, 249)',\n    ':hover:focus': {\n        fill: 'rgb(93, 93, 253)',\n        stroke: 'rgb(93, 93, 253)',        \n    }\n})\n\nconst closeIconStyle = css({\n    width: '1.5rem',\n})\n\nconst headerStyle = css({\n    borderBottom: '1px solid rgb(233, 233, 233)',\n    // minHeight: '1.9rem',\n    // backgroundColor: 'rgba(8, 11, 18, 0.9)',\n    fontSize: '2rem',\n    // paddingBottom: '1rem',\n})\n\nconst visibleOverlayStyle = {\n    backgroundColor: 'rgba(115, 117, 187, 0.14)',\n    zIndex: '1000',\n};\n\nconst hiddenOverlayStyle = {\n    position: 'static'\n};\n\nconst contentStyle = {\n    color: 'rgb(226, 236, 249)',\n    backgroundColor: 'rgba(8, 11, 18, 0.9)',\n    border: '1px solid rgba(204, 204, 204, 0.51)',\n    zIndex: 100,\n    display: 'flex',\n    flexFlow: 'column',\n    overflow: 'hidden',\n};\n\nconst getSidedStyle = (sided) => {\n    const positions = ['top', 'right', 'bottom', 'left'];\n    if(sided && sided.position && positions.includes(sided.position)) {\n        const width = sided.width || '66%';\n        // eslint-disable-next-line default-case\n        switch (sided.position) {\n            case 'top':\n                return {\n                    top: '0px',\n                    right: '0px',\n                    bottom: width,\n                    left: '0px',\n                };\n            case 'right':\n                return {\n                    top: '0px',\n                    right: '0px',\n                    bottom: '0px',\n                    left: width,\n                }\n            case 'bottom':\n                return {\n                    top: width,\n                    right: '0px',\n                    bottom: '0px',\n                    left: '0px',\n                }\n            case 'left':\n                return {\n                    top: '0px',\n                    right: width,\n                    bottom: '0px',\n                    left: '0px',\n                }\n        }\n    } else {\n        return {};\n    }\n}\n\n// {sided?} {possition: top, right, bottom, left, width: %}\n// {displayOverlay} bool\n\nexport default (props) => {\n    const {modalKey, isOpen, content, onClose, header, sided, displayOverlay} = props;\n\n    const sidedStyle = getSidedStyle(sided);\n\n    return (\n        <ReactModal \n            isOpen={isOpen}\n            contentLabel=\"Inline Styles Modal Example\"\n            style={{\n                content: {...contentStyle, ...sidedStyle},\n                overlay: displayOverlay === true ? visibleOverlayStyle : hiddenOverlayStyle\n            }}\n        >\n            <div css={headerStyle}>\n                {header}\n            </div>\n            <div css={innerContentStyle}>\n                {content}\n            </div>\n            <span onClick={() => {onClose(modalKey)}} css={closeStyle}>\n                <Icon icon={'times'} css={closeIconStyle}/>\n            </span>\n        </ReactModal>)\n}","import classnames from 'classnames';\nimport React from 'react';\nimport './style.scss';\nexport default ({className, id, title, value, readOnly=true}) => {\n    const classes = classnames(`ptr-form-group ${className ? className : \"\"}`, {});\n    return (\n        <div className={classes}>\n            <label htmlFor={id} className={'ptr-col-form-label'} >{title}</label>\n            <div >\n                <input type=\"text\" readOnly={readOnly} className={\"ptr-form-control-plaintext\"} id={id} value={value} />\n            </div>\n        </div>\n    )\n}","import classnames from 'classnames';\nimport React from 'react';\nimport './style.scss';\nexport default ({className, children}) => {\n    const classes = classnames(`ptr-form ${className ? className : \"\"}`, {});\n    return (\n        <form className={classes}>\n            {children}\n        </form>\n    )\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\n\nimport Icon from '../Icon';\n\nimport './style.scss';\n\nclass Button extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\tcircular: PropTypes.bool,\n\t\tclassName: PropTypes.string,\n\t\tdisabled: PropTypes.bool,\n\t\tghost: PropTypes.bool,\n\t\ticon: PropTypes.string,\n\t\tinverted: PropTypes.bool,\n\t\tinvisible: PropTypes.bool,\n\t\tlarge: PropTypes.bool,\n\t\tonClick: PropTypes.func.isRequired,\n\t\tprimary: PropTypes.bool,\n\t\tsecondary: PropTypes.bool,\n\t\tside: PropTypes.string,\n\t\tsmall: PropTypes.bool,\n\t\ttitle: PropTypes.string,\n\t\tunfocusable: PropTypes.bool\n\t};\n\n\tstatic defaultProps = {\n\t\tdisabled: false\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tfocused: false,\n\t\t\tmenuOpen: false\n\t\t};\n\n\t\tthis.onBlur = this.onBlur.bind(this);\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.onKeyPress = this.onKeyPress.bind(this);\n\t}\n\n\n\tonClick(e) {\n\t\tif (!this.props.disabled) {\n\t\t\tif (this.props.onClick) {\n\t\t\t\tthis.props.onClick(e);\n\t\t\t}\n\t\t\tthis.setState({\n\t\t\t\tmenuOpen: !this.state.menuOpen\n\t\t\t});\n\t\t}\n\t}\n\n\tonBlur() {\n\t\tthis.setState({\n\t\t\tmenuOpen: false\n\t\t});\n\t}\n\n\tonKeyPress(e) {\n\t\tif(e.charCode === 32) {\n\t\t\tthis.onClick(e);\n\t\t} else if (e.charCode === 13){\n\t\t\tthis.onClick(e);\n\t\t}\n\t}\n\n\n\trender() {\n\n\t\tlet iconInsert = null;\n\t\tif (this.props.icon) {\n\t\t\t// determine icon\n\t\t\ticonInsert = (\n\t\t\t\t<Icon icon={this.props.icon} />\n\t\t\t);\n\t\t}\n\n\t\tlet hasContent = false;\n\t\tlet content = React.Children.map(this.props.children, child => {\n\t\t\tif (child) {\n\t\t\t\tif (typeof child === 'string') {\n\t\t\t\t\thasContent = true;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"ptr-button-caption\">{child}</div>\n\t\t\t\t\t);\n\t\t\t\t} else if (typeof child === 'object' && child.type === React.Fragment) {\n\t\t\t\t\thasContent = true;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"ptr-button-content\">{child}</div>\n\t\t\t\t\t);\n\t\t\t\t} else if (React.isValidElement(child)) {\n\t\t\t\t\treturn React.cloneElement(child);\n\t\t\t\t} else {\n\t\t\t\t\thasContent = true;\n\t\t\t\t\treturn child;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tlet classes = classNames(\n\t\t\t'ptr-button', {\n\t\t\t\tcircular: !!this.props.circular,\n\t\t\t\tdisabled: this.props.disabled,\n\t\t\t\tghost: !!this.props.ghost,\n\t\t\t\ticon: !!iconInsert && !hasContent,\n\t\t\t\tinvisible: !!this.props.invisible,\n\t\t\t\tinverted: !!this.props.inverted,\n\t\t\t\tlarge: !!this.props.large,\n\t\t\t\tprimary: !!this.props.primary,\n\t\t\t\tsecondary: !!this.props.secondary,\n\t\t\t\tside: !!this.props.side,\n\t\t\t\t'side-left': this.props.side === 'left',\n\t\t\t\t'side-right': this.props.side === 'right',\n\t\t\t\t'side-top': this.props.side === 'top',\n\t\t\t\t'side-bottom': this.props.side === 'bottom',\n\t\t\t\tsmall: this.props.small,\n\t\t\t},\n\t\t\tthis.props.className\n\t\t);\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={classes}\n\t\t\t\tid={this.props.id}\n\t\t\t\tonBlur={this.onBlur}\n\t\t\t\tonClick={this.onClick}\n\t\t\t\tonKeyPress={this.onKeyPress}\n\t\t\t\ttabIndex={(this.props.disabled || this.props.unfocusable) ? \"-1\" : \"0\"}\n\t\t\t\ttitle={this.props.title}\n\t\t\t>\n\t\t\t\t{iconInsert}\n\t\t\t\t{content}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Button;\n\nexport const Buttons =  ({vertical, children}) => (<div className={classNames(\"ptr-buttons\", {vertical})}>{children}</div>);\nexport const ButtonGroup =  ({vertical, children}) => (<div className={classNames(\"ptr-button-group\", {vertical})}>{children}</div>);\n","import WorldWind from 'webworldwind-esa';\n\nconst {\n    ShapeAttributes,\n    Color,\n} = WorldWind;\n\nconst addBoundariesAltitude = (boundaries = [], altitude = 0) => {\n    return boundaries.map((bs) => {\n        if(bs && Array.isArray(bs)) {\n            return addBoundariesAltitude(bs, altitude);\n        } else {\n            return new WorldWind.Position(bs.latitude, bs.longitude, altitude);\n        }\n    })\n}\n\nexport const productBounds = (boundaries) => {\n    //ideal would be use SurfacePolygon, but because of local WWW updates is layer broken\n    const polygon = new WorldWind.Polygon(addBoundariesAltitude(boundaries, 90000), null);\n    polygon.altitudeMode = WorldWind.ABSOLUTE;\n    polygon.extrude = false; // extrude the polygon edges to the ground\n\n    const polygonAttributes = new WorldWind.ShapeAttributes(null);\n    polygonAttributes.drawInterior = true;\n    polygonAttributes.drawOutline = true;\n    polygonAttributes.outlineColor = WorldWind.Color.BLUE;\n    polygonAttributes.interiorColor = new WorldWind.Color(0, 1, 1, .2);\n    polygonAttributes.drawVerticals = polygon.extrude;\n    polygonAttributes.applyLighting = false;\n    polygon.attributes = polygonAttributes;\n    return polygon;\n}\n\nexport const productAttributes = () => {\n    const shapeAttributes = new ShapeAttributes(null);\n    shapeAttributes.drawOutline = true;\n    shapeAttributes.drawInterior = false;\n    shapeAttributes.outlineColor = new Color(1, 0, 0, 1);\n    shapeAttributes.outlineWidth = 1;\n    return shapeAttributes;\n}\nexport const getBoundaries = (product) => {\n    if(product && product.boundaries) {\n        //close polygon by first point\n        return product.boundaries;\n    } else {\n        return [];\n    }\n}\n\nexport const getProductDownloadUrl = (product) => {\n    let url;\n    for (const prop of product.link) {\n        if (prop.rel !== 'icon') {\n            url = prop.href;\n            break;\n        }\n    };\n    return url;\n}","import styled from '@emotion/styled';\nimport React from 'react';\nimport PropTypes from \"prop-types\";\n\nimport FormGroup from \"../form/FormGroup\";\nimport Form from \"../form/Form\";\nimport Button from '../atoms/Button';\n\nimport {getProductDownloadUrl} from '../../utils/product';\n\nimport \"./style.css\";\n\n// const itemStyle = {\n//     display: 'flex',\n// };\n\nconst getDownloadIcon = (url, isOnline) => {\n    if(url) {\n        return (<Button ghost disabled={!isOnline} onClick={() => {window.open(url, '_blank')}} icon={'download'} className={'ptr-download-product'} small></Button>);\n    } else {\n        return null;\n    }\n}\n\n\nconst Heading = ({product, text, isOnline}) => {\n    const downloadUrl = product ? getProductDownloadUrl(product) : null;\n    const DownloadIcon = getDownloadIcon(downloadUrl, isOnline);\n    return (<div className={'ptr-product-heading'}>{text}{DownloadIcon}</div>)\n}\n\nconst getDataList = (data) => {\n    return data.map((i, index) => {\n        return <FormGroup title={i.name} value={i.content} id={`${index}_${i.name}`} readOnly={true} key={`${index}_${i.name}`}/>\n    });\n};\n\nconst ProductInformation = ({product, heading, online}) => {\n    const {title, id, date, int, str, summary} = product;\n\n    //dates\n    const dateList = date ? getDataList(date) : null;\n\n    //int\n    const intList = int ? getDataList(int) : null;\n\n    //str\n    const strList = str ? Object.entries(str).map(([title, value], index) => <FormGroup title={title} value={value.content} id={`${index}_${title}`} key={`${index}_${title}`} readOnly={true}/>) : null;\n\n    //summary\n    const summaryItem = summary && summary.content ? <FormGroup title={'Summary'} value={summary.content} id={`summary`} readOnly={true}/> : null;\n\n    //title\n    const titleItem = title && title.content ? <FormGroup title={'Title'} value={title.content} id={`title`} readOnly={true}/> : null;\n\n    return (\n        <div className={'product-info'}>\n            <h1>\n                {heading ? heading : <Heading text={`${str.platformname.content} - ${str.producttype.content}`} product={product} isOnline={online}/>}\n            </h1>\n            <Form className={'ptr-product-info'}>\n                <section>\n                    <FormGroup title={'Online'} value={online} id={`online`} key={`online`} readOnly={true}/>\n                </section>\n                <section>\n                    {titleItem}\n                </section>\n                <section>\n                    {dateList}\n                </section>\n                <section>\n                    {intList}\n                </section>\n                <section>\n                    {strList}\n                </section>\n                <section>\n                    {summaryItem}\n                </section>\n            </Form>\n            {/* line */}\n        </div>\n    )\n}\n\nProductInformation.propTypes = {\n    product:PropTypes.object,\n}\n\nProductInformation.defaultProps = {\n    product: {},\n}\n\nexport default ProductInformation;","/*\n * Copyright 2003-2006, 2009, 2017, United States Government, as represented by the Administrator of the\n * National Aeronautics and Space Administration. All rights reserved.\n *\n * The NASAWorldWind/WebWorldWind platform is licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @exports ColladaScene\n */\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    ArgumentError,\n    BasicTextureProgram,\n    Color,\n    Logger,\n    Matrix,\n    Position,\n    PickedObject,\n    Renderable,\n    Vec3\n} = WorldWind;\n\n\n/**\n * Constructs a collada scene\n * @alias ColladaScene\n * @constructor\n * @augments Renderable\n * @classdesc Represents a scene. A scene is a collection of nodes with meshes, materials and textures.\n * @param {Position} position The scene's geographic position.\n * @param {Object} sceneData The scene's data containing the nodes, meshes, materials, textures and other\n * info needed to render the scene.\n */\nvar ColladaScene = function (position, sceneData) {\n    if (!position) {\n        throw new ArgumentError(\n            Logger.logMessage(Logger.LEVEL_SEVERE, \"ColladaScene\", \"constructor\", \"missingPosition\"));\n    }\n\n    Renderable.call(this);\n\n    // Documented in defineProperties below.\n    this._position = position;\n\n    // Documented in defineProperties below.\n    this._nodes = [];\n    this._meshes = {};\n    this._materials = {};\n    this._images = {};\n    this._upAxis = '';\n    this._dirPath = '';\n\n    // Documented in defineProperties below.\n    this._xRotation = 0;\n    this._yRotation = 0;\n    this._zRotation = 0;\n\n    this.preX = 0;\n    this.preY = 0;\n    this.preZ = 0;\n\n    // Documented in defineProperties below.\n    this._xTranslation = 0;\n    this._yTranslation = 0;\n    this._zTranslation = 0;\n\n    // Documented in defineProperties below.\n    this._scale = 1;\n\n    // Documented in defineProperties below.\n    this._altitudeMode = WorldWind.ABSOLUTE;\n\n    // Documented in defineProperties below.\n    this._localTransforms = true;\n\n    // Documented in defineProperties below.\n    this._useTexturePaths = true;\n\n    // Documented in defineProperties below.\n    this._nodesToHide = [];\n    this._hideNodes = false;\n\n    // Documented in defineProperties below.\n    this._placePoint = new Vec3(0, 0, 0);\n\n    // Documented in defineProperties below.\n    this._transformationMatrix = Matrix.fromIdentity();\n    this._mvpMatrix = Matrix.fromIdentity();\n\n    // Documented in defineProperties below.\n    this._normalTransformMatrix = Matrix.fromIdentity();\n    this._normalMatrix = Matrix.fromIdentity();\n    this._texCoordMatrix = Matrix.fromIdentity().setToUnitYFlip();\n\n    //Internal. Intentionally not documented.\n    this._entities = [];\n\n    //Internal. Intentionally not documented.\n    this._activeTexture = null;\n\n    //Internal. Intentionally not documented.\n    this._tmpVector = new Vec3(0, 0, 0);\n    this._tmpColor = new Color(1, 1, 1, 1);\n\n    //Internal. Intentionally not documented.\n    this._vboCacheKey = '';\n    this._iboCacheKey = '';\n\n    this.setSceneData(sceneData);\n};\n\nColladaScene.prototype = Object.create(Renderable.prototype);\nColladaScene.prototype.constructor = ColladaScene;\n\nObject.defineProperties(ColladaScene.prototype, {\n\n    /**\n     * The scene's geographic position.\n     * @memberof ColladaScene.prototype\n     * @type {Position}\n     */\n    position: {\n        get: function () {\n            return this._position;\n        },\n        set: function (value) {\n            this._position = value;\n        }\n    },\n\n    /**\n     * An array of nodes extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {ColladaNode[]}\n     */\n    nodes: {\n        get: function () {\n            return this._nodes;\n        },\n        set: function (value) {\n            this._nodes = value;\n        }\n    },\n\n    /**\n     * An object with meshes extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {{ColladaMesh}}\n     */\n    meshes: {\n        get: function () {\n            return this._meshes;\n        },\n        set: function (value) {\n            this._meshes = value;\n        }\n    },\n\n    /**\n     * An object with materials and their effects extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {ColladaMaterial}\n     */\n    materials: {\n        get: function () {\n            return this._materials;\n        },\n        set: function (value) {\n            this._materials = value;\n        }\n    },\n\n    /**\n     * An object with images extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {ColladaImage}\n     */\n    images: {\n        get: function () {\n            return this._images;\n        },\n        set: function (value) {\n            this._images = value;\n        }\n    },\n\n    /**\n     * The up axis of the collada model extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {String}\n     */\n    upAxis: {\n        get: function () {\n            return this._upAxis;\n        },\n        set: function (value) {\n            this._upAxis = value;\n        }\n    },\n\n    /**\n     * The path to the directory of the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {String}\n     */\n    dirPath: {\n        get: function () {\n            return this._dirPath;\n        },\n        set: function (value) {\n            this._dirPath = value;\n        }\n    },\n\n    /**\n     * The scene's rotation angle in degrees for the x axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    xRotation: {\n        get: function () {\n            return this._xRotation;\n        },\n        set: function (value) {\n            this._xRotation = value;\n        }\n    },\n\n    /**\n     * The scene's rotation angle in degrees for the x axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    yRotation: {\n        get: function () {\n            return this._yRotation;\n        },\n        set: function (value) {\n            this._yRotation = value;\n        }\n    },\n\n    /**\n     * The scene's rotation angle in degrees for the x axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    zRotation: {\n        get: function () {\n            return this._zRotation;\n        },\n        set: function (value) {\n            this._zRotation = value;\n        }\n    },\n\n    /**\n     * The scene's translation for the x axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    xTranslation: {\n        get: function () {\n            return this._xTranslation;\n        },\n        set: function (value) {\n            this._xTranslation = value;\n        }\n    },\n\n    /**\n     * The scene's translation for the y axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    yTranslation: {\n        get: function () {\n            return this._yTranslation;\n        },\n        set: function (value) {\n            this._yTranslation = value;\n        }\n    },\n\n    /**\n     * The scene's translation for the z axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    zTranslation: {\n        get: function () {\n            return this._zTranslation;\n        },\n        set: function (value) {\n            this._zTranslation = value;\n        }\n    },\n\n    /**\n     * The scene's scale.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    scale: {\n        get: function () {\n            return this._scale;\n        },\n        set: function (value) {\n            this._scale = value;\n        }\n    },\n\n    /**\n     * The scene's Cartesian point on the globe for the specified position.\n     * @memberof ColladaScene.prototype\n     * @type {Vec3}\n     */\n    placePoint: {\n        get: function () {\n            return this._placePoint;\n        },\n        set: function (value) {\n            this._placePoint = value;\n        }\n    },\n\n    /**\n     * The scene's altitude mode. May be one of\n     * <ul>\n     *  <li>[WorldWind.ABSOLUTE]{@link WorldWind#ABSOLUTE}</li>\n     *  <li>[WorldWind.RELATIVE_TO_GROUND]{@link WorldWind#RELATIVE_TO_GROUND}</li>\n     *  <li>[WorldWind.CLAMP_TO_GROUND]{@link WorldWind#CLAMP_TO_GROUND}</li>\n     * </ul>\n     * @default WorldWind.ABSOLUTE\n     * @memberof ColladaScene.prototype\n     * @type {String}\n     */\n    altitudeMode: {\n        get: function () {\n            return this._altitudeMode;\n        },\n        set: function (value) {\n            this._altitudeMode = value;\n        }\n    },\n\n    /**\n     * The scene's transformation matrix containing the scale, rotations and translations\n     * @memberof ColladaScene.prototype\n     * @type {Matrix}\n     */\n    transformationMatrix: {\n        get: function () {\n            return this._transformationMatrix;\n        },\n        set: function (value) {\n            this._transformationMatrix = value;\n        }\n    },\n\n    /**\n     * The scene's normal matrix\n     * @memberof ColladaScene.prototype\n     * @type {Matrix}\n     */\n    normalMatrix: {\n        get: function () {\n            return this._normalMatrix;\n        },\n        set: function (value) {\n            this._normalMatrix = value;\n        }\n    },\n\n    /**\n     * Force the use of the nodes transformation info. Some 3d software may break the transformations when\n     * importing/exporting models to collada format. Set to false to ignore the the nodes transformation.\n     * Only use this option if the model does not render properly.\n     * @memberof ColladaScene.prototype\n     * @default true\n     * @type {Boolean}\n     */\n    localTransforms: {\n        get: function () {\n            return this._localTransforms;\n        },\n        set: function (value) {\n            this._localTransforms = value;\n        }\n    },\n\n    /**\n     * Force the use of the texture path specified in the collada file. Set to false to ignore the paths of the\n     * textures in the collada file and instead get the textures from the same dir as the collada file.\n     * @memberof ColladaScene.prototype\n     * @default true\n     * @type {Boolean}\n     */\n    useTexturePaths: {\n        get: function () {\n            return this._useTexturePaths;\n        },\n        set: function (value) {\n            this._useTexturePaths = value;\n        }\n    },\n\n    /**\n     * An array of node id's to not render.\n     * @memberof ColladaScene.prototype\n     * @type {String[]}\n     */\n    nodesToHide: {\n        get: function () {\n            return this._nodesToHide;\n        },\n        set: function (value) {\n            this._nodesToHide = value;\n        }\n    },\n\n    /**\n     * Set to true to force the renderer to not draw the nodes passed to the nodesToHide list.\n     * @memberof ColladaScene.prototype\n     * @default false\n     * @type {Boolean}\n     */\n    hideNodes: {\n        get: function () {\n            return this._hideNodes;\n        },\n        set: function (value) {\n            this._hideNodes = value;\n        }\n    }\n\n});\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.setSceneData = function (sceneData) {\n    if (sceneData) {\n        this._nodes = sceneData.root.children;\n        this._meshes = sceneData.meshes;\n        this._materials = sceneData.materials;\n        this._images = sceneData.images;\n        this._upAxis = sceneData.metadata.up_axis;\n        this._dirPath = sceneData.dirPath;\n\n        this.flattenModel();\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.flattenModel = function () {\n    for (var i = 0, nodesLen = this._nodes.length; i < nodesLen; i++) {\n        this.flattenNode(this._nodes[i]);\n    }\n\n    this._entities.sort(function (a, b) {\n        var va = (a.imageKey === null) ? \"\" : \"\" + a,\n            vb = (b.imageKey === null) ? \"\" : \"\" + b;\n        return va > vb ? 1 : (va === vb ? 0 : -1);\n    });\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.flattenNode = function (node) {\n    if (node.mesh) {\n        var meshKey = node.mesh;\n        var buffers = this._meshes[meshKey].buffers;\n\n        for (var i = 0, bufLen = buffers.length; i < bufLen; i++) {\n            var materialBuf = buffers[i].material;\n\n            for (var j = 0; j < node.materials.length; j++) {\n                if (materialBuf === node.materials[j].symbol) {\n                    var materialKey = node.materials[j].id;\n                    break;\n                }\n            }\n\n            var material = this._materials[materialKey];\n            var imageKey = null;\n            var hasTexture = material && material.textures && buffers[i].uvs && buffers[i].uvs.length > 0;\n            if (hasTexture) {\n                if (material.textures.diffuse) {\n                    imageKey = material.textures.diffuse.mapId;\n                } else if (material.textures.reflective) {\n                    imageKey = material.textures.reflective.mapId;\n                }\n            }\n\n            this._entities.push({\n                mesh: buffers[i],\n                material: material,\n                node: node,\n                imageKey: imageKey\n            });\n        }\n    }\n\n    for (var k = 0; k < node.children.length; k++) {\n        this.flattenNode(node.children[k]);\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.render = function (dc) {\n    var orderedScene;\n    var frustum = dc.frustumInModelCoordinates;\n\n    if (!this.enabled) {\n        return;\n    }\n\n    if (this.lastFrameTime !== dc.timestamp) {\n        orderedScene = this.makeOrderedRenderable(dc);\n    }\n\n    if (!orderedScene) {\n        return;\n    }\n\n    if (!frustum.containsPoint(this._placePoint)) {\n        return;\n    }\n\n    orderedScene.layer = dc.currentLayer;\n\n    this.lastFrameTime = dc.timestamp;\n\n    dc.addOrderedRenderable(orderedScene);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.makeOrderedRenderable = function (dc) {\n    dc.surfacePointForMode(this._position.latitude, this._position.longitude, this._position.altitude,\n        this._altitudeMode, this._placePoint);\n\n    this.eyeDistance = dc.eyePoint.distanceTo(this._placePoint);\n\n    return this;\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.renderOrdered = function (dc) {\n    this.drawOrderedScene(dc);\n\n    if (dc.pickingMode) {\n        var po = new PickedObject(this.pickColor.clone(), this, this._position, this.layer, false);\n        dc.resolvePick(po);\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.drawOrderedScene = function (dc) {\n    try {\n        this.beginDrawing(dc);\n    } finally {\n        this.endDrawing(dc);\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.beginDrawing = function (dc) {\n    var gl = dc.currentGlContext;\n    var gpuResourceCache = dc.gpuResourceCache;\n\n    var vboId = gpuResourceCache.resourceForKey(this._vboCacheKey);\n    var iboId = gpuResourceCache.resourceForKey(this._iboCacheKey);\n\n    if (!vboId) {\n        this.setupBuffers(dc);\n        vboId = gpuResourceCache.resourceForKey(this._vboCacheKey);\n        iboId = gpuResourceCache.resourceForKey(this._iboCacheKey);\n    }\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n    if (iboId) {\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, iboId);\n    }\n\n    dc.findAndBindProgram(BasicTextureProgram);\n    gl.enableVertexAttribArray(0);\n\n    if (dc.pickingMode) {\n        this.pickColor = dc.uniquePickColor();\n    }\n\n    this.computeTransformationMatrix(dc.globe);\n\n    for (var i = 0, len = this._entities.length; i < len; i++) {\n        var mustRenderNode = this.mustRenderNode(this._entities[i].node.id);\n        if (mustRenderNode) {\n            this.draw(dc, this._entities[i]);\n        }\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.setupBuffers = function (dc) {\n    var gl = dc.currentGlContext;\n    var sizeOfFloat32 = Float32Array.BYTES_PER_ELEMENT || 4;\n    var sizeOfUint16 = Uint16Array.BYTES_PER_ELEMENT || 2;\n    var sizeOfUint32 = Uint32Array.BYTES_PER_ELEMENT || 4;\n    var is32BitIndices = false;\n    var numIndices = 0;\n    var numVertices = 0;\n\n    for (var i = 0, len = this._entities.length; i < len; i++) {\n        var mesh = this._entities[i].mesh;\n        if (mesh.indexedRendering) {\n            numIndices += mesh.indices.length;\n            if (mesh.indices instanceof Uint32Array) {\n                is32BitIndices = true;\n            }\n        }\n        numVertices += mesh.vertices.length;\n        if (this._entities[i].imageKey) {\n            numVertices += mesh.uvs.length;\n        }\n        if (mesh.normals && mesh.normals.length) {\n            numVertices += mesh.normals.length;\n        }\n    }\n\n    var vbo = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n    gl.bufferData(gl.ARRAY_BUFFER, numVertices * sizeOfFloat32, gl.STATIC_DRAW);\n\n    var offset = 0;\n    for (i = 0, len = this._entities.length; i < len; i++) {\n        var data = this._entities[i].mesh.vertices;\n        this._entities[i].vertexOffset = offset;\n        gl.bufferSubData(gl.ARRAY_BUFFER, offset * sizeOfFloat32, data);\n        offset += data.length;\n    }\n\n    for (i = 0, len = this._entities.length; i < len; i++) {\n        if (this._entities[i].imageKey) {\n            data = this._entities[i].mesh.uvs;\n            this._entities[i].uvOffset = offset;\n            gl.bufferSubData(gl.ARRAY_BUFFER, offset * sizeOfFloat32, data);\n            offset += data.length;\n        }\n    }\n\n    for (i = 0, len = this._entities.length; i < len; i++) {\n        data = data = this._entities[i].mesh.normals;\n        if (data && data.length) {\n            this._entities[i].normalOffset = offset;\n            gl.bufferSubData(gl.ARRAY_BUFFER, offset * sizeOfFloat32, data);\n            offset += data.length;\n        }\n    }\n\n    var indexSize = sizeOfUint16;\n    var indexBufferSize = numIndices * indexSize;\n    var uIntExt;\n    if (is32BitIndices) {\n        uIntExt = dc.getExtension('OES_element_index_uint');\n\n        if (!uIntExt) {\n            Logger.log(Logger.LEVEL_SEVERE,\n                'The 3D model is too big and might not render properly. \\n' +\n                'Your browser does not support the \"OES_element_index_uint\" extension, ' +\n                'required to render large models.'\n            );\n        } else {\n            indexSize = sizeOfUint32;\n            indexBufferSize = numIndices * indexSize;\n        }\n    }\n\n    if (numIndices) {\n        var ibo = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indexBufferSize, gl.STATIC_DRAW);\n\n        offset = 0;\n        for (i = 0, len = this._entities.length; i < len; i++) {\n            mesh = this._entities[i].mesh;\n            if (mesh.indexedRendering) {\n                data = mesh.indices;\n                if (data instanceof Uint32Array && !uIntExt) {\n                    data = new Uint16Array(data);\n                }\n                this._entities[i].indexOffset = offset;\n                this._entities[i].indexSize = indexSize;\n                gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, offset * indexSize, data);\n                offset += data.length;\n            }\n        }\n    }\n\n    this._vboCacheKey = dc.gpuResourceCache.generateCacheKey();\n    dc.gpuResourceCache.putResource(this._vboCacheKey, vbo, numVertices * sizeOfFloat32);\n\n    if (numIndices) {\n        this._iboCacheKey = dc.gpuResourceCache.generateCacheKey();\n        dc.gpuResourceCache.putResource(this._iboCacheKey, ibo, indexBufferSize);\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.draw = function (dc, entity) {\n    var gl = dc.currentGlContext;\n    var program = dc.currentProgram;\n    var gpuResourceCache = dc.gpuResourceCache;\n\n    var buffers = entity.mesh;\n    var material = entity.material;\n\n    var nodeWorldMatrix = entity.node.worldMatrix;\n    var nodeNormalMatrix = entity.node.normalMatrix;\n\n    var hasLighting = buffers.normals && buffers.normals.length;\n\n    var imageKey = entity.imageKey;\n\n    this.applyColor(dc, material);\n\n    if (imageKey) {\n        var imagePath = this._useTexturePaths ? this._images[imageKey].path : this._images[imageKey].filename;\n        var textureCacheKey = this._dirPath + imagePath;\n        this._activeTexture = gpuResourceCache.resourceForKey(textureCacheKey);\n        if (!this._activeTexture) {\n            var wrapMode = buffers.isClamp ? gl.CLAMP_TO_EDGE : gl.REPEAT;\n            this._activeTexture = gpuResourceCache.retrieveTexture(gl, textureCacheKey, wrapMode);\n        }\n        var textureBound = this._activeTexture && this._activeTexture.bind(dc);\n        if (textureBound) {\n            program.loadTextureEnabled(gl, true);\n            gl.vertexAttribPointer(2, 2, gl.FLOAT, false, 8, entity.uvOffset * 4);\n            gl.enableVertexAttribArray(2);\n            program.loadModulateColor(gl, dc.pickingMode);\n        } else {\n            program.loadTextureEnabled(gl, false);\n            gl.disableVertexAttribArray(2);\n        }\n    } else {\n        program.loadTextureEnabled(gl, false);\n        gl.disableVertexAttribArray(2);\n    }\n\n    if (hasLighting && !dc.pickingMode) {\n        program.loadApplyLighting(gl, 1);\n        gl.vertexAttribPointer(1, 3, gl.FLOAT, false, 12, entity.normalOffset * 4);\n        gl.enableVertexAttribArray(1);\n    } else {\n        program.loadApplyLighting(gl, 0);\n        gl.disableVertexAttribArray(1);\n    }\n\n    this.applyMatrix(dc, hasLighting, textureCacheKey, nodeWorldMatrix, nodeNormalMatrix);\n\n    gl.vertexAttribPointer(0, 3, gl.FLOAT, false, 12, entity.vertexOffset * 4);\n\n    if (buffers.indexedRendering) {\n        var indexOffsetBytes = entity.indexOffset * entity.indexSize;\n        if (buffers.indices instanceof Uint32Array && dc.getExtension('OES_element_index_uint')) {\n            gl.drawElements(gl.TRIANGLES, buffers.indices.length, gl.UNSIGNED_INT, indexOffsetBytes);\n        } else {\n            gl.drawElements(gl.TRIANGLES, buffers.indices.length, gl.UNSIGNED_SHORT, indexOffsetBytes);\n        }\n    } else {\n        gl.drawArrays(gl.TRIANGLES, 0, Math.floor(buffers.vertices.length / 3));\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.applyColor = function (dc, material) {\n    var gl = dc.currentGlContext,\n        program = dc.currentProgram;\n\n    if (material) {\n        if (material.techniqueType === 'constant') {\n            var diffuse = material.reflective;\n        } else {\n            diffuse = material.diffuse;\n        }\n    }\n\n    var opacity;\n    var r = 1, g = 1, b = 1, a = 1;\n\n    if (diffuse) {\n        r = diffuse[0];\n        g = diffuse[1];\n        b = diffuse[2];\n        a = diffuse[3] != null ? diffuse[3] : 1;\n    }\n\n    this._tmpColor.set(r, g, b, a);\n    opacity = a * this.layer.opacity;\n    gl.depthMask(opacity >= 1 || dc.pickingMode);\n    program.loadColor(gl, dc.pickingMode ? this.pickColor : this._tmpColor);\n    program.loadOpacity(gl, dc.pickingMode ? (opacity > 0 ? 1 : 0) : opacity);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.applyMatrix = function (dc, hasLighting, hasTexture, nodeWorldMatrix, nodeNormalMatrix) {\n    this._mvpMatrix.copy(dc.modelviewProjection);\n    this._mvpMatrix.multiplyMatrix(this._transformationMatrix);\n\n    if (nodeWorldMatrix && this._localTransforms) {\n        this._mvpMatrix.multiplyMatrix(nodeWorldMatrix);\n    }\n\n    if (hasLighting && !dc.pickingMode) {\n        this._normalMatrix.copy(dc.modelviewNormalTransform);\n        this._normalMatrix.multiplyMatrix(this._normalTransformMatrix);\n        if (nodeNormalMatrix && this._localTransforms) {\n            this._normalMatrix.multiplyMatrix(nodeNormalMatrix);\n        }\n\n        dc.currentProgram.loadModelviewInverse(dc.currentGlContext, this._normalMatrix);\n    }\n\n    if (hasTexture && this._activeTexture) {\n        dc.currentProgram.loadTextureMatrix(dc.currentGlContext, this._texCoordMatrix);\n        this._activeTexture = null;\n    }\n\n    dc.currentProgram.loadModelviewProjection(dc.currentGlContext, this._mvpMatrix);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.endDrawing = function (dc) {\n    var gl = dc.currentGlContext;\n    var program = dc.currentProgram;\n\n    gl.disableVertexAttribArray(1);\n    gl.disableVertexAttribArray(2);\n    program.loadApplyLighting(gl, 0);\n    program.loadTextureEnabled(gl, false);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.computeTransformationMatrix = function (globe) {\n    this._transformationMatrix.setToIdentity();\n\n    this._transformationMatrix.multiplyByLocalCoordinateTransform(this._placePoint, globe);\n\n    this._transformationMatrix.multiplyByRotation(1, 0, 0, this._xRotation);\n    this._transformationMatrix.multiplyByRotation(0, 1, 0, this._yRotation);\n    this._transformationMatrix.multiplyByRotation(0, 0, 1, this._zRotation);\n\n    this._transformationMatrix.multiplyByScale(this._scale, this._scale, this._scale);\n\n    this._transformationMatrix.multiplyByTranslation(this._xTranslation, this._yTranslation, this._zTranslation);\n\n    this._transformationMatrix.multiplyByRotation(1, 0, 0, this.preX);\n    this._transformationMatrix.multiplyByRotation(0, 1, 0, this.preY);\n    this._transformationMatrix.multiplyByRotation(0, 0, 1, this.preZ);\n\n    this.computeNormalMatrix();\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.computeNormalMatrix = function () {\n    this._transformationMatrix.extractRotationAngles(this._tmpVector);\n    this._normalTransformMatrix.setToIdentity();\n    this._normalTransformMatrix.multiplyByRotation(-1, 0, 0, this._tmpVector[0]);\n    this._normalTransformMatrix.multiplyByRotation(0, -1, 0, this._tmpVector[1]);\n    this._normalTransformMatrix.multiplyByRotation(0, 0, -1, this._tmpVector[2]);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.mustRenderNode = function (nodeId) {\n    var draw = true;\n    if (this._hideNodes) {\n        var pos = this._nodesToHide.indexOf(nodeId);\n        draw = (pos === -1);\n    }\n    return draw;\n};\n\nexport default ColladaScene;","import WorldWind from 'webworldwind-esa';\r\nimport ColladaScene from \"./collada/ColladaScene\";\r\n\r\nconst {\r\n    Matrix,\r\n    Renderable\r\n} = WorldWind;\r\n\r\n/**\r\n * @exports Model\r\n */\r\nclass Model extends Renderable {\r\n    /**\r\n     * Constructs model of the satellite on the given position.\r\n     * @param model {Object} Model information. Collada information.\r\n     * @param satellite {Object} The details about the satellite and the way it should be transformed and presented.\r\n     * @param position {Position} The exact position of the center of the satellite.\r\n     */\r\n    constructor(model, satellite, position) {\r\n        super();\r\n\r\n        this._satellite = satellite;\r\n        const satelliteModel = this.parse(model);\r\n        this.draw(position, satelliteModel);\r\n    }\r\n\r\n    /**\r\n     * Updates the position of the model.\r\n     * @param position {Position} Current position of the model.\r\n     */\r\n    position(position) {\r\n        this._model.position = position;\r\n    }\r\n\r\n    /**\r\n     * Draws the collada model into a Collada Scene.\r\n     * @param position {Position} Position of the satellite.\r\n     * @param modelData Collada Model Information.\r\n     */\r\n    draw(position, modelData) {\r\n        const nodesToHide = [\r\n            'PlatformCircleAndName', 'SolarWingsCircleAndName', 'C-SarCircleAndName',\r\n            'PlatformTextsAndArrows', 'SolarWingsTextsAndArrows', 'C-SarTextsAndArrows',\r\n\r\n            'SolarArrayGroup', 'WingsDetailsGroup', 'Group004', 'MsiGroup', 'SatelliteGroup',\r\n\r\n            'SatelliteDimensionsGroup', 'MWRGroup', 'SRALGroup', 'OLCIGroup', 'SLSTRGroup'\r\n        ];\r\n        const {\r\n            rotations,\r\n            translations,\r\n            preRotations,\r\n            scale,\r\n            shortName,\r\n            ignoreLocalTransforms\r\n        } = this._satellite;\r\n\r\n        const model = new ColladaScene(position, modelData);\r\n        model.type = this.type;\r\n        model.satShortName = shortName;\r\n\r\n        model.nodesToHide = nodesToHide;\r\n        model.hideNodes = true;\r\n        model.useTexturePaths = false;\r\n        model.localTransforms = ignoreLocalTransforms;\r\n        model.scale = scale;\r\n        model.xRotation = rotations.x;\r\n        model.yRotation = rotations.y;\r\n        model.zRotation = rotations.z;\r\n        model.xTranslation = translations.x;\r\n        model.yTranslation = translations.y;\r\n        model.zTranslation = translations.z;\r\n        model.preX = preRotations.x;\r\n        model.preY = preRotations.y;\r\n        model.preZ = preRotations.z;\r\n\r\n        this._model = model;\r\n        modelData = null;\r\n    }\r\n\r\n    /**\r\n     * Parses the collada model and update the information relevant to the satellites.\r\n     * @param {{ meshes:Object, root:Object, materials:{reflective:Array, diffuse:Array} }} jsonData\r\n     * @return {Object} Collada model.\r\n     */\r\n    parse(jsonData) {\r\n        const meshes = jsonData.meshes;\r\n        const nodes = jsonData.root.children;\r\n        const materials = jsonData.materials;\r\n\r\n        for (let key in meshes) {\r\n            if (meshes.hasOwnProperty(key)) {\r\n                const buffers = meshes[key].buffers;\r\n\r\n                for (let i = 0; i < buffers.length; i++) {\r\n                    const vertices = buffers[i].vertices || [];\r\n                    const normals = buffers[i].normals || [];\r\n                    const uvs = buffers[i].uvs || [];\r\n                    const indices = buffers[i].indices || [];\r\n\r\n                    const eVertices = new Float32Array(vertices);\r\n                    const eNormals = new Float32Array(normals);\r\n                    const eUvs = new Float32Array(uvs);\r\n                    const eIndices = new Uint16Array(indices);\r\n\r\n                    buffers[i].vertices = eVertices;\r\n                    buffers[i].normals = eNormals;\r\n                    buffers[i].uvs = eUvs;\r\n                    buffers[i].indices = eIndices;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            const node = nodes[i];\r\n            if (node.mesh) {\r\n                const worldMatrix = node.worldMatrix.slice(0);\r\n                node.worldMatrix = Matrix.fromIdentity();\r\n                node.worldMatrix.copy(worldMatrix);\r\n\r\n                if (node.children.length) {\r\n                    console.info('node has children', node);\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let key in materials) {\r\n            if (materials.hasOwnProperty(key)) {\r\n                const material = materials[key];\r\n\r\n                if (material.id === '_3_-_Default-material') {\r\n                    if (material.reflective) {\r\n                        material.reflective[0] = 0.289219;\r\n                        material.reflective[1] = 0.713497;\r\n                        material.reflective[2] = 0.870753;\r\n                        material.reflective[3] = 1;\r\n                    }\r\n                } else if (material.id === '_1_-_Default_004-material') {\r\n                    material.diffuse[3] = 0;\r\n                } else if (material.id === '_1_-_Default-material') {\r\n                    material.diffuse[3] = 0;\r\n                } else if (material.id === 'Chrome-material') {\r\n                    material.textures = null;\r\n                    material.diffuse[0] = 0.3137;\r\n                    material.diffuse[1] = 0.3137;\r\n                    material.diffuse[2] = 0.3137;\r\n                } else if (material.id === 'Satellite_panel-material') {\r\n                    material.textures.reflective.mapId = 'image9';\r\n                } else if (material.id === '_3_-_Default') {\r\n                    material.textures.reflective.mapId = 'image4';\r\n                } else if (material.id === '_4_-_Default-material') {\r\n                    material.textures.reflective.mapId = 'image5';\r\n                } else if (material.id === '_5_-_Default_002-material') {\r\n                    material.textures.reflective.mapId = 'image6';\r\n                } else if (material.id === '_5_-_Default-material') {\r\n                    material.textures.reflective.mapId = 'image5';\r\n                }\r\n            }\r\n        }\r\n\r\n        return jsonData;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    render(dc) {\r\n        if(!this._model || !this.enabled) {\r\n            return;\r\n        }\r\n\r\n        this._model.render(dc);\r\n    }\r\n}\r\n\r\nexport default Model;","import WorldWind from 'webworldwind-esa';\nimport WorldWindX from 'webworldwind-x';\nimport Model from '../../worldwind/Model';\n\nconst {\n    RenderableLayer,\n    Position,\n} = WorldWind;\n\nconst {\n    EoUtils\n} = WorldWindX;\n\n\nconst DEFAULT_MODEL_OPTIONS = {\n    rotations: {\n        x: 0,\n        y: 0,\n        z: 0,\n        headingAxis: [0, 0, 1],\n        headingAdd: -90,\n        headingMultiply: 1\n    },\n    preRotations: {\n        x: 0,\n        y: 0,\n        z: 0\n    },\n    scale: 500000,\n    translations: {\n        x: -0.1,\n        y: -0.1,\n        z: 0\n    },\n    ignoreLocalTransforms: true\n}\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer can render only one model of satellite. It`s possible to set position data of model.\n * @param options {Object}\n * @param options.key {String}\n * @param options.time {Date} Time of the satellite.\n * @param options.onLayerChanged {func}\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass SatelliteModelLayer extends RenderableLayer {\n\tconstructor(options, satelliteOptions) {\n        super(options);\n        this.type = 'SatelliteModelLayer';\n        this._satelliteOptions = satelliteOptions;\n        this._rerenderMap = null;\n        this.key = options.key;\n        this.model = null;\n        this.time = options.time;\n        this.Tle = null;\n        this.heading = null;\n        this.onLayerChanged = options.onLayerChanged || null;\n    };\n    \n    /**\n     * \n     * @param {Object} collada model \n     * @param {Object} options\n     * @param {Position} position\n     */\n    setModel(model, options = DEFAULT_MODEL_OPTIONS, position) {\n        if(model) {\n            this.model = new Model(model, options, position);\n\n            this.removeAllRenderables();\n            this.addRenderable(this.model);\n            this.doRerender();\n        }\n    }\n\n    /**\n     * @param position {Position} Position of the satellite.\n     */\n    setPosition(position) {\n        if(position && this.model) {\n            this.model.position(position);\n        }\n    }\n\n    \n    /**\n     * @param position {Array.<lte>} Lte.\n     */\n    setTle(Tle) {\n        if(Tle) {\n            this.Tle = Tle;\n            this.update();\n        }\n    }\n    \n    /**\n     * @param position {Array.<lte>} Lte.\n     */\n    update() {\n        if(this.Tle && this.time) {\n            const satrec = EoUtils.computeSatrec(...this.Tle);\n            const position = EoUtils.getOrbitPosition(satrec, new Date(this.time));\n            this.setPosition(new Position(position.latitude, position.longitude, position.altitude));\n            if(this.model) {\n                this.alignWithOrbit(this.time, position, EoUtils.computeSatrec(...this.Tle), this._satelliteOptions.rotations, this.model._model);\n            }\n            this.doRerender();\n        }\n    }\n\n    alignWithOrbit(date, currentPosition, satrec, rotations, model) {\n        const now = date.getTime();\n        const nextPosition = EoUtils.getOrbitPosition(satrec, new Date(now + 10000));\n        const headingRad = EoUtils.headingAngleRadians(currentPosition.latitude, currentPosition.longitude, nextPosition.latitude, nextPosition.longitude);\n        const heading = EoUtils.rad2deg(headingRad);\n        this.heading = heading;\n\n        if(typeof this.onLayerChanged === 'function') {\n            this.onLayerChanged({\n                satKey: this.satName,\n                layerKey: this.key,\n                type: this.type,\n            }, {update: {\n                heading: this.heading\n            }});\n        }\n\n        const angle = (heading + rotations.headingAdd) * rotations.headingMultiply;\n\n        if (heading !== 0) {\n            if (rotations.headingAxis[0] === 1) {\n                model.xRotation = angle;\n            }\n            else if (rotations.headingAxis[1] === 1) {\n                model.yRotation = angle;\n            }\n            else if (rotations.headingAxis[2] === 1) {\n                model.zRotation = angle;\n            }\n        }\n    }\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    setTime(time) {\n        if(time) {\n            this.time = time;\n            this.update();\n        }\n    }\n    \n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n\t}\n}\n\nexport default SatelliteModelLayer;\n\n","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nconst {\n    EoUtils,\n} = WordWindX;\n\nconst {\n    ABSOLUTE,\n    Color,\n    Renderable,\n    Path,\n    ShapeAttributes\n} = WorldWind;\n\n\n/**\n * @exports Orbits\n */\nclass Orbits extends Renderable {\n    /**\n     * Constructs Orbits displaying the past and future position. The positions are calculated from the satrec. The\n     * orbits are displayed from now back to past and\n     * @param satrec {Object} SDG format representing the satellite.\n     * @param time {Date} Date for which the orbits will be displayed.\n     * @param timeWindow {Number} Amount of milliseconds for the time window.\n     * @param orbitPoints {Number} Amount of the Panther.\n     */\n    constructor(satrec, startTime = new Date(), endTime = new Date(), color, orbitPoints = 720) {\n        super();\n\n        if(!satrec) {\n            throw new Error('Orbits#constructor Satellite Record is missing.');\n        }\n\n        this._satrec = satrec;\n\n        // this._timeWindow = timeWindow;\n        this._orbitPoints = orbitPoints;\n\n        this._trail = this.trail(this.trailAttributes(color));\n        // this._futureTrail = this.trail(this.trailAttributes(new Color(1, 1, 0, 1)));\n\n        if(endTime.getTime() === startTime.getTime()) {\n            this._currentEndTime = new Date(startTime.getTime() + orbitPoints * 1000);\n            this._previousEndTime = new Date(startTime.getTime() + orbitPoints * 1000);\n        } else {\n            this._currentEndTime = endTime;\n            this._previousEndTime = endTime;\n        }\n\n        this._currentStartTime = startTime;\n        this._previousStartTime = startTime;\n\n        this.populate();\n    }\n\n    /**\n     * Update information about when and where the satellite was. It fully rebuilds the positions for the trails.\n     * @param satelliteRecord SPG format representing the satellite.\n     */\n    satrec(satelliteRecord, preventPopulate) {\n        if(!satelliteRecord) {\n            throw Error('No satellite record was provided');\n        }\n        this._satrec = satelliteRecord;\n        // This must signalize somehow that it needs to be recalculated.\n\n        if(preventPopulate !== true) {\n            this.populate();\n        }\n    }\n\n    /**\n     * Update current time for this set of orbits.\n     * @param startTime {Date} Start date for the orbit.\n     * @param endTime {Date} End date for the orbit.\n     */\n    time(startTime, endTime, preventUpdate) {\n        if(!startTime) {\n            throw Error('No startTime was provided');\n        }\n        if(!endTime) {\n            throw Error('No endTime was provided');\n        }\n        this._previousStartTime = this._currentStartTime;\n        this._previousEndTime = this._currentEndTime;\n        this._currentStartTime = startTime;\n        this._currentEndTime = endTime;\n\n        if(preventUpdate !== true) {\n            this.update();\n        }\n    }\n\n    /**\n     * Renders all trails belonging to this Orbit if it is enabled.\n     * @param dc {DrawContext} Shared state for one rendering.\n     */\n    render(dc) {\n        if(!this.enabled) {\n            return;\n        }\n\n        this._trail.render(dc);\n        // this._futureTrail.render(dc);\n    }\n\n    /**\n     * Updates the trails associated with this Orbit based on the current time and satrec. If there is no change in\n     * either of these parameters nothing changes.\n     * @param force {Boolean} If force, recalculate all positions\n     * @private\n     */\n    update(force = false) {\n        const startDate = this._currentStartTime.getTime();\n        const now = startDate;\n        const previousStartTime = this._previousStartTime.getTime();\n        const previousTime = previousStartTime;\n        const changeStart = startDate - previousStartTime;\n        const endDate = this._currentEndTime.getTime();\n        const previousEndTime = this._previousEndTime.getTime();\n        const changeEnd = endDate - previousEndTime;\n        if(changeStart === 0 && changeEnd === 0 && !force) {\n            return;\n        }\n\n        if(force) {\n            this.populate();\n            return;\n        }\n\n        const timeWindow = endDate - startDate;\n\n        const tick = Math.floor(timeWindow / this._orbitPoints);\n        let positionsToReplace = (Math.ceil(Math.abs(now - previousTime) / tick)) + Math.ceil(Math.abs(endDate - previousEndTime) / tick);\n        if(positionsToReplace > this._orbitPoints) {\n            this.populate();\n            return;\n        }\n\n        //if start change\n        //update start\n        if(changeStart) {\n            //change to future\n            if(changeStart > 0) {\n                //remove olded possitions than current startDate\n                let i = 0;\n                while (this._trail.positions[i].time < startDate) {\n                    this._trail.positions.shift();\n                }\n            }\n\n            if(changeStart < 0) {\n                //add possitions to startDate\n                const positionsToReplace = Math.ceil(Math.abs(now - previousTime) / tick);\n                for(let positionIndex = 0; positionIndex < positionsToReplace; positionIndex++) {\n                    const time = new Date(previousTime - positionIndex * tick);\n                    const position = EoUtils.getOrbitPositionWithPositionalData(this._satrec, time).position;\n                    position.time = time.getTime();\n                    this._trail.positions = [position, ...this._trail.positions];\n                }\n            }\n        }\n        \n\n        //if end change\n        //update end\n        if(changeEnd) {\n            //change to future\n            if(changeEnd > 0) {\n                //change to future\n                const positionsToReplace = Math.ceil(Math.abs(endDate - previousEndTime) / tick);\n                for(let positionIndex = 0; positionIndex < positionsToReplace; positionIndex++) {\n                    const time = new Date(previousEndTime + positionIndex * tick);\n                    const position = EoUtils.getOrbitPositionWithPositionalData(this._satrec, time).position;\n                    position.time = time.getTime();\n                    this._trail.positions.push(position);\n                }\n            }\n\n            if(changeEnd < 0) {\n                //remove olded possitions than current endDate\n                let i = this._trail.positions.length - 1;\n                while (this._trail.positions[i].time > endDate) {\n                    this._trail.positions.pop();\n                    i = this._trail.positions.length - 1;\n                }\n            }\n        }\n        this._trail.positions = [...this._trail.positions];\n    }\n\n    populate() {\n        const startDate = this._currentStartTime.getTime();\n        const endDate = this._currentEndTime.getTime();\n        const timeWindow = endDate - startDate;\n        const tick = Math.floor(timeWindow / this._orbitPoints);\n\n        const positions = [];\n        for(let positionIndex = 0; positionIndex < this._orbitPoints; positionIndex++) {\n            const time = new Date(startDate + positionIndex * tick);\n            const position = EoUtils.getOrbitPositionWithPositionalData(this._satrec, time).position;\n            position.time = time.getTime();\n            positions.push(position);\n        }\n        this._trail.positions = [...positions];\n    }\n\n    /**\n     * Create the relevant shape which is used to display the orbit on the globe.\n     * @private\n     * @param attributes\n     */\n    trail(attributes) {\n        const trail = new Path([]);\n        trail.enabled = true;\n        trail.altitudeMode = ABSOLUTE;\n        trail.numSubSegments = 1;\n        trail.attributes = attributes;\n        return trail;\n    }\n\n    /**\n     * Create attributes for the proper visualization of the Orbit in more than one color.\n     * @private\n     * @param color\n     */\n    trailAttributes(color) {\n        const attributes = new ShapeAttributes(null);\n        attributes.outlineColor = color;\n        attributes.outlineWidth = 1;\n        attributes.drawOutline = true;\n        attributes.drawInterior = false;\n        return attributes;\n    }\n}\n\nexport default Orbits;","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nimport Orbit from './utils/Orbit';\nconst {\n    RenderableLayer,\n    Color\n} = WorldWind;\n\nconst {\n    EoUtils,\n} = WordWindX;\n\n/**\n * Class extending WorldWind.RenderableLayer. It`s possible to set time of orbit.\n * @param options {Object}\n * @param options.key {String}\n * @param options.time {Date} Selected time\n * @param options.currentTime {Date} \n * @param options.opacity {Number} \n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass OrbitLayer extends RenderableLayer {\n\tconstructor(options) {\n        super(options);\n        this._rerenderMap = null;\n        this.satRec = null;\n        this.key = options.key;\n        this.timeWindow = 90 * 60 * 1000; //90 minutes\n        this.opacity = Number.isFinite(options.opacity) && options.opacity > -1 && options.opacity < 101 ? options.opacity : 100;\n        this._beforeCurrentOrbit = new Orbit(EoUtils.computeSatrec(...options.satRec), new Date(), new Date(), new Color(213 / 255, 214  / 255, 210 / 255, this.opacity));\n        this._afterCurrentOrbit = new Orbit(EoUtils.computeSatrec(...options.satRec), new Date(), new Date(), new Color(1, 1, 0, 1));\n        this.addRenderable(this._beforeCurrentOrbit);\n        this.addRenderable(this._afterCurrentOrbit);\n        this.currentTime = null;\n        this.selectTime = null;\n        this.endTime = null;\n        this.endTime = null;\n        this.satRec = null;\n        this.setSatRec(options.satRec);\n        this.setTime(options.currentTime, options.time);\n        \n    };\n\n    \n    /**\n     * @param {Array.<lte>} satRec  Lte.\n     */\n    setSatRec(satRec, preventUpdate) {\n        if(satRec) {\n            this.satRec = satRec;\n            const satrec = EoUtils.computeSatrec(...satRec);\n            this._beforeCurrentOrbit.satrec(satrec, true);\n            if(preventUpdate !== true) {\n                this._beforeCurrentOrbit.update(true);\n            }\n            this._afterCurrentOrbit.satrec(satrec, true);\n            if(preventUpdate !== true) {\n                this._afterCurrentOrbit.update(true);\n            }\n            this.doRerender();\n        }\n    }\n\n    /**\n     * @param {Date} time Time of the orbit.\n     */\n    setTime(currentTime, selectTime, preventUpdate) {\n        if(currentTime && selectTime) {\n            this.currentTime = currentTime;\n            this.selectTime = selectTime;\n\n            this.startTime = new Date(selectTime.getTime() - this.timeWindow);\n            this.endTime = new Date(selectTime.getTime() + this.timeWindow);\n\n            this.removeRenderable(this._beforeCurrentOrbit);\n            this.removeRenderable(this._afterCurrentOrbit);\n\n            if(currentTime.getTime() < this.startTime.getTime()) {\n                //all in future\n                this._afterCurrentOrbit.time(this.startTime, this.endTime, preventUpdate);\n                this.addRenderable(this._afterCurrentOrbit);\n            } else if(this.startTime.getTime() < currentTime.getTime() && currentTime.getTime() < this.endTime.getTime()) {\n                //select time visible\n                this._beforeCurrentOrbit.time(this.startTime, currentTime, preventUpdate);\n                this._afterCurrentOrbit.time(currentTime, this.endTime, preventUpdate);\n                this.addRenderable(this._beforeCurrentOrbit);\n                this.addRenderable(this._afterCurrentOrbit);\n            } else if(currentTime.getTime() > this.endTime.getTime()) {\n                //all in past\n                this._beforeCurrentOrbit.time(this.startTime, this.endTime, preventUpdate);\n                this.addRenderable(this._beforeCurrentOrbit);\n            }\n\n            this.doRerender();\n        }\n    }\n\n    forceUpdate() {\n        this._afterCurrentOrbit.update(true);\n        this._beforeCurrentOrbit.update(true);\n    }\n    \n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n\t}\n}\n\nexport default OrbitLayer;\n\n","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    Location,\r\n    Sector,\r\n    WmsLayer\r\n} = WorldWind;\r\n\r\nclass SentinelCloudlessLayer extends WmsLayer {\r\n    constructor(){\r\n        let url = 'https://tiles.maps.eox.at/wms';\r\n        if(window.location.host === 'dashboard.eoapps.eu') {\r\n            url = 'https://tiles.esa.maps.eox.at/wms'\r\n        }\r\n\r\n        super({\r\n            service: url,\r\n            layerNames: \"s2cloudless-2018\",\r\n            title: \"Sentinel Cloudless Layer\",\r\n            sector: new Sector(-90, 90, -180, 180),\r\n            levelZeroDelta: new Location(45, 45),\r\n            numLevels: 19,\r\n            format: \"image/jpg\",\r\n            opacity: 1,\r\n            size: 256,\r\n            version: \"1.3.0\"\r\n        });\r\n    }\r\n}\r\n\r\nexport default SentinelCloudlessLayer;","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    Location,\r\n    Sector,\r\n    WmsLayer\r\n} = WorldWind;\r\n\r\nclass SentinelTopologyLayer extends WmsLayer {\r\n    constructor(){\r\n        let url = 'https://tiles.maps.eox.at/wms';\r\n        if(window.location.host === 'dashboard.eoapps.eu') {\r\n            url = 'https://tiles.esa.maps.eox.at/wms'\r\n        }\r\n\r\n        super({\r\n            service: url,\r\n            layerNames: \"overlay\",\r\n            title: \"Overlay layer by EOX - 4326\",\r\n            sector: new Sector(-90, 90, -180, 180),\r\n            levelZeroDelta: new Location(45, 45),\r\n            numLevels: 19,\r\n            format: \"image/jpg\",\r\n            opacity: 1,\r\n            size: 256,\r\n            version: \"1.3.0\"\r\n        });\r\n    }\r\n}\r\n\r\nexport default SentinelTopologyLayer;","import toGeoJSON from './togeojson';\nimport WorldWind from 'webworldwind-esa';\n\nexport class AcquisitionPlansParser {\n\n    /**\n     * @alias AcquisitionPlansParser\n     * @constructor\n     * @param {Workers} workers \n     */\n    constructor(workers) {\n        if (!workers) {\n            throw (new Error('AcquisitionPlansParser - constructor - missing workers instance'));\n        }\n\n        this.workers = workers;\n\n        this.InteriorCtor = WorldWind ? WorldWind.SurfacePolygon : null;\n        this.OutlineCtor = WorldWind ? WorldWind.Path : null;\n        this.ShapeAttributesCtor = WorldWind ? WorldWind.ShapeAttributes : null;\n        this.PositionCtor = WorldWind ? WorldWind.Position : null;\n        this.ColorCtor = WorldWind ? WorldWind.Color : null;\n\n        /**\n         * @type {DOMParser|null}\n         */\n        this.domParser = null;\n\n        /**\n         * @type {Object}\n         */\n        this.shapeAttributesMap = Object.create(null);\n    }\n\n    /**\n     * Parses an acquisition plan kml file.\n     * Parsing will be attempted in a web worker and if that fails it will be attemped on the main thread.\n     * \n     * @param {{ satName: String, url: String, type: String, interior: Boolean, outline: Boolean, outlineAlpha: Number, interiorAlpha: Number, highlightAlpha: Number, filterDate: String }} fileInfo\n     * \n     * @param {String} fileInfo.satName The satellite name for the acquisition plan. The convention is to use the short name: \"s1a\", \"s2b\", \"s5p\", etc.\n     * @param {String} fileInfo.url The url for the acquisition plan file\n     * @param {String} fileInfo.type A type for the web workers. Default is \"downloadAndParseKmls\"\n     * @param {Boolean} fileInfo.interior A flag that indicates if interior renderables should be created. Default is true\n     * @param {Boolean} fileInfo.outline A flag that indicates if outline renderables should be created. Default is true\n     * @param {Number} fileInfo.outlineAlpha Alpha value fot the outline. Default is 1\n     * @param {Number} fileInfo.interiorAlpha Alpha value for the interior. Default is 0.2\n     * @param {Number} fileInfo.highlightAlpha Alpha value for the interior highlight. Default is 0.5\n     * @param {String} fileInfo.filterDate An ISODate string used for filtering out shapes that lees than this value. Default is the current date\n     * \n     * @param {Function} cb A callback function, will be called with error and entry params\n     */\n    parse(fileInfo, cb) {\n        fileInfo.type = fileInfo.type || 'downloadAndParseKmls';\n        fileInfo.filterDate = fileInfo.filterDate || new Date().toISOString();\n\n        this.workers.process(fileInfo, (err, result) => {\n            if (err) {\n                return cb(err);\n            }\n\n            const { shapes, satName, url } = result;\n            let parsedShapes;\n\n            if (typeof shapes === 'string') {\n                console.info('Worker unable to parse kml file', url);\n                try {\n                    parsedShapes = this.parseSync(shapes, satName, fileInfo.filterDate);\n                }\n                catch (error) {\n                    return cb(error);\n                }\n            }\n            else {\n                parsedShapes = shapes;\n            }\n\n            let outlines;\n            let interiors;\n            let interval;\n\n            try {\n                ({ outlines, interiors, interval } = this.makeRenderables(parsedShapes, fileInfo));\n            }\n            catch (error) {\n                return cb(error);\n            }\n\n            if ((outlines || interiors) && interval) {\n                return cb(null, this.formatOutput({ satName, url }, interval, outlines, interiors));\n            }\n        });\n    }\n\n    parseSync(kmlString, satName, filterDate) {\n        if (!this.domParser) {\n            this.domParser = new DOMParser();\n        }\n\n        const kmlDoc = this.domParser.parseFromString(kmlString, 'text/xml');\n        const geoJson = toGeoJSON.kml(kmlDoc);\n        let shapes = geoJson.features;\n\n        const isSentinel2 = satName.includes('s2');\n        const nowDate = new Date(filterDate);\n        shapes = shapes.filter(shape => {\n            const isInTheFuture = new Date(shape.properties.timespan.end) >= nowDate;\n\n            if (isSentinel2) {\n                return (\n                    isInTheFuture &&\n                    shape.properties.Mode === 'NOBS' &&\n                    shape.properties.Timeliness === 'NOMINAL'\n                );\n            }\n\n            return isInTheFuture;\n        });\n\n        return shapes;\n    }\n\n    makeRenderables(shapes, fileInfo) {\n        const outlines = [];\n        const interiors = [];\n\n        const interval = {\n            startDate: Number.MAX_SAFE_INTEGER,\n            endDate: Number.MIN_SAFE_INTEGER\n        };\n\n        for (let i = 0; i < shapes.length; i++) {\n            let shape = shapes[i];\n            let coords = shape.coordinates;\n            let color = shape.color;\n            let extendedData = shape.extendedData;\n\n            if (shape.geometry) {\n                coords = shape.geometry.coordinates[0];\n            }\n            if (shape.properties) {\n                color = shape.properties.lineColor;\n                extendedData = shape.properties;\n            }\n\n            let positions = this.makePositions(coords);\n\n            if (fileInfo.outline !== false) {\n                let pathAttributes = this.makePathAttributes(color, fileInfo.outlineAlpha);\n                let path = new this.OutlineCtor(positions, pathAttributes);\n                path.altitudeMode = 'clampToGround';\n                path.followTerrain = true;\n                path.expiryTime = Number.MAX_SAFE_INTEGER;\n                this.setTimeInterval(path, extendedData, interval);\n                path.kmlProps.satName = fileInfo.satName;\n                outlines.push(path);\n            }\n\n            if (fileInfo.interior !== false) {\n                let surfacePolygonAttributes = this.makeSurfacePolygonAttributes(color, fileInfo.interiorAlpha);\n                let surfacePolygon = new this.InteriorCtor(positions, surfacePolygonAttributes);\n                surfacePolygon.highlightAttributes = this.makeSurfacePolygonHighlightAttributes(color, fileInfo.highlightAlpha);\n                this.setTimeInterval(surfacePolygon, extendedData, interval);\n                surfacePolygon.kmlProps.satName = fileInfo.satName;\n                interiors.push(surfacePolygon);\n            }\n        }\n\n        interval.startDate = new Date(interval.startDate);\n        interval.endDate = new Date(interval.endDate);\n\n        return {\n            outlines,\n            interiors,\n            interval,\n        };\n    }\n\n    makePositions(coords) {\n        const positions = [];\n\n        for (let i = 0, len = coords.length; i < len; i++) {\n            let coord = coords[i];\n            let pos = new this.PositionCtor(\n                coord[1] || coord.latitude,\n                coord[0] || coord.longitude,\n                coord[2] || 0\n            );\n            if (pos.longitude < -180) {\n                pos.longitude = pos.longitude + 360;\n            }\n            if (pos.longitude > 180) {\n                pos.longitude = pos.longitude - 360;\n            }\n            positions.push(pos);\n        }\n\n        return positions;\n    }\n\n    makePathAttributes(hexColor, alpha = 1) {\n        const key = hexColor + 'path';\n        \n        if (this.shapeAttributesMap[key]) {\n            return this.shapeAttributesMap[key];\n        }\n\n        const attributes =  new this.ShapeAttributesCtor(null);\n        attributes.drawOutline = true;\n        attributes.drawInterior = false;\n        attributes.outlineColor = this.makeColor(hexColor, alpha);\n\n        this.shapeAttributesMap[key] = attributes;\n\n        return attributes;\n    }\n\n    makeSurfacePolygonAttributes(props, alpha = 0.2) {\n        const hexColor = props.lineColor || props;\n        const key = hexColor + 'poly';\n\n        if (this.shapeAttributesMap[key]) {\n            return this.shapeAttributesMap[key];\n        }\n\n        const attributes = new this.ShapeAttributesCtor(null);\n        attributes.drawOutline = false;\n        attributes.drawInterior = true;\n        attributes.interiorColor = this.makeColor(hexColor, alpha);\n\n        this.shapeAttributesMap[key] = attributes;\n\n        return attributes;\n    }\n\n    makeSurfacePolygonHighlightAttributes(props, alpha = 0.5) {\n        const hexColor = props.lineColor || props;\n\n        const attributes = new this.ShapeAttributesCtor(null);\n        attributes.drawOutline = false;\n        attributes.drawInterior = true;\n        attributes.interiorColor = this.makeColor(hexColor, alpha);\n\n        return attributes;\n    }\n\n    makeColor(hexColor, alpha) {\n        const blue = hexColor.substring(2, 4);\n        const green = hexColor.substring(4, 6);\n        const red = hexColor.substring(6, 8);\n\n        const r = parseInt(red, 16) / 255;\n        const g = parseInt(green, 16) / 255;\n        const b = parseInt(blue, 16) / 255;\n\n        return new this.ColorCtor(r, g, b, alpha);\n    }\n\n    setTimeInterval(renderable, props, interval) {\n        const startTime = this.dateStringToUTC(props.ObservationTimeStart || props.timespan.begin);\n        const endTime = this.dateStringToUTC(props.ObservationTimeStop || props.timespan.end);\n        const startTimeMs = (new Date(startTime)).getTime();\n        const endTimeMs = (new Date(endTime)).getTime();\n\n        if (interval.startDate > startTimeMs) {\n            interval.startDate = startTimeMs;\n        }\n        if (interval.endDate < endTimeMs) {\n            interval.endDate = endTimeMs;\n        }\n\n        renderable.kmlProps = props;\n        renderable.kmlProps.startDate = new Date(startTimeMs);\n        renderable.kmlProps.endDate = new Date(endTimeMs);\n        renderable.type = 'acqPlan';\n    }\n\n    dateStringToUTC(dateString) {\n        const lastChar = dateString[dateString.length - 1];\n        if (lastChar.toLowerCase() !== 'z') {\n            return dateString + 'Z';\n        }\n        return dateString;\n    }\n\n    formatOutput(fileInfo, interval, outlines = [], interiors = []) {\n        return {\n            url: fileInfo.url,\n            satName: fileInfo.satName,\n            outlines: outlines,\n            interiors: interiors,\n            startDate: interval.startDate,\n            endDate: interval.endDate,\n        };\n    }\n\n}","/*\n * @license\n * Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.\n * Copyright 2014, Google Inc. All Rights Reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to\n * deal in the Software without restriction, including without limitation the\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n * sell copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice including the dates of first publication and\n * either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/\n * shall be included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n * SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR\n * IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n *\n * Original Code. The Original Code is: OpenGL Sample Implementation,\n * Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,\n * Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.\n * Copyright in any portions created by third parties is as indicated\n * elsewhere herein. All Rights Reserved.\n */\n/*\n * @author ericv@cs.stanford.edu (Eric Veach)\n * @author bckenny@google.com (Brendan Kenny)\n */\n\n/*\n * Base namespace.\n * @const\n */\nvar libtess = {};\n\n/**\n * Whether to run asserts and extra debug checks.\n * @define {boolean}\n */\nlibtess.DEBUG = false;\n\n/**\n * Checks if the condition evaluates to true if libtess.DEBUG is true.\n * @param {*} condition The condition to check.\n * @param {string=} opt_message Error message in case of failure.\n * @throws {Error} Assertion failed, the condition evaluates to false.\n */\nlibtess.assert = function(condition, opt_message) {\n  if (libtess.DEBUG && !condition) {\n    throw new Error('Assertion failed' +\n        (opt_message ? ': ' + opt_message : ''));\n  }\n};\n\n/**\n * The maximum vertex coordinate size, 1e150. Anything larger will trigger a\n * GLU_TESS_COORD_TOO_LARGE error callback and the vertex will be clamped to\n * this value for all tessellation calculations.\n * @const {number}\n */\nlibtess.GLU_TESS_MAX_COORD = 1e150;\n// NOTE(bckenny): value from glu.pl generator\n\n/**\n * Normally the polygon is projected to a plane perpendicular to one of the\n * three coordinate axes before tessellating in 2d. This helps numerical\n * accuracy by forgoing a transformation step by simply dropping one coordinate\n * dimension.\n *\n * However, this can affect the placement of intersection points for non-axis-\n * aligned polygons. Setting TRUE_PROJECT to true will instead project onto a\n * plane actually perpendicular to the polygon's normal.\n *\n * NOTE(bckenny): I can find no instances on the internet in which this mode has\n * been used, but it's difficult to search for. This was a compile-time setting\n * in the original, so setting this as constant. If this is exposed in the\n * public API, remove the ignore coverage directives on\n * libtess.normal.projectPolygon and libtess.normal.normalize_.\n * @const {boolean}\n */\nlibtess.TRUE_PROJECT = false;\n\n/**\n * We cache vertex data for single-contour polygons so that we can try a\n * quick-and-dirty decomposition first.\n * @const {number}\n */\nlibtess.TESS_MAX_CACHE = 100;\n\n/**\n * The default tolerance for merging features, 0, meaning vertices are only\n * merged if they are exactly coincident\n * If a higher tolerance is needed, significant rewriting will need to occur.\n * See libtess.sweep.TOLERANCE_NONZERO_ as a starting place.\n * @const {number}\n */\nlibtess.GLU_TESS_DEFAULT_TOLERANCE = 0;\n\n/**\n * The input contours parition the plane into regions. A winding\n * rule determines which of these regions are inside the polygon.\n *\n * For a single contour C, the winding number of a point x is simply\n * the signed number of revolutions we make around x as we travel\n * once around C (where CCW is positive). When there are several\n * contours, the individual winding numbers are summed. This\n * procedure associates a signed integer value with each point x in\n * the plane. Note that the winding number is the same for all\n * points in a single region.\n *\n * The winding rule classifies a region as \"inside\" if its winding\n * number belongs to the chosen category (odd, nonzero, positive,\n * negative, or absolute value of at least two). The current GLU\n * tesselator implements the \"odd\" rule. The \"nonzero\" rule is another\n * common way to define the interior. The other three rules are\n * useful for polygon CSG operations.\n * @enum {number}\n */\nlibtess.windingRule = {\n  // NOTE(bckenny): values from enumglu.spec\n  GLU_TESS_WINDING_ODD: 100130,\n  GLU_TESS_WINDING_NONZERO: 100131,\n  GLU_TESS_WINDING_POSITIVE: 100132,\n  GLU_TESS_WINDING_NEGATIVE: 100133,\n  GLU_TESS_WINDING_ABS_GEQ_TWO: 100134\n};\n\n/**\n * The type of primitive return from a \"begin\" callback. GL_LINE_LOOP is only\n * returned when GLU_TESS_BOUNDARY_ONLY is true. GL_TRIANGLE_STRIP and\n * GL_TRIANGLE_FAN are no longer returned since 1.1.0 (see release notes).\n * @enum {number}\n */\nlibtess.primitiveType = {\n  GL_LINE_LOOP: 2,\n  GL_TRIANGLES: 4,\n  GL_TRIANGLE_STRIP: 5,\n  GL_TRIANGLE_FAN: 6\n};\n\n/**\n * The types of errors provided in the error callback.\n * @enum {number}\n */\nlibtess.errorType = {\n  // TODO(bckenny) doc types\n  // NOTE(bckenny): values from enumglu.spec\n  GLU_TESS_MISSING_BEGIN_POLYGON: 100151,\n  GLU_TESS_MISSING_END_POLYGON: 100153,\n  GLU_TESS_MISSING_BEGIN_CONTOUR: 100152,\n  GLU_TESS_MISSING_END_CONTOUR: 100154,\n  GLU_TESS_COORD_TOO_LARGE: 100155,\n  GLU_TESS_NEED_COMBINE_CALLBACK: 100156\n};\n\n/**\n * Enum values necessary for providing settings and callbacks. See the readme\n * for details.\n * @enum {number}\n */\nlibtess.gluEnum = {\n  // TODO(bckenny): rename so not always typing libtess.gluEnum.*?\n\n  // NOTE(bckenny): values from enumglu.spec\n  GLU_TESS_BEGIN: 100100,\n  GLU_TESS_VERTEX: 100101,\n  GLU_TESS_END: 100102,\n  GLU_TESS_ERROR: 100103,\n  GLU_TESS_EDGE_FLAG: 100104,\n  GLU_TESS_COMBINE: 100105,\n  GLU_TESS_BEGIN_DATA: 100106,\n  GLU_TESS_VERTEX_DATA: 100107,\n  GLU_TESS_END_DATA: 100108,\n  GLU_TESS_ERROR_DATA: 100109,\n  GLU_TESS_EDGE_FLAG_DATA: 100110,\n  GLU_TESS_COMBINE_DATA: 100111,\n\n  GLU_TESS_MESH: 100112,  //  NOTE(bckenny): from tess.c\n  GLU_TESS_TOLERANCE: 100142,\n  GLU_TESS_WINDING_RULE: 100140,\n  GLU_TESS_BOUNDARY_ONLY: 100141,\n\n  // TODO(bckenny): move this to libtess.errorType?\n  GLU_INVALID_ENUM: 100900,\n  GLU_INVALID_VALUE: 100901\n};\n\n/** @typedef {number} */\n//libtess.PQHandle;\n\n// TODO(bckenny): better typing on key?\n/** @typedef {Object} */\n//libtess.PQKey;\n\n\n/* global libtess */\n\n/** @const */\nlibtess.geom = {};\n\n/**\n * Returns whether vertex u and vertex v are equal.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @return {boolean}\n */\nlibtess.geom.vertEq = function(u, v) {\n  return u.s === v.s && u.t === v.t;\n};\n\n/**\n * Returns whether vertex u is lexicographically less than or equal to vertex v.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @return {boolean}\n */\nlibtess.geom.vertLeq = function(u, v) {\n  return (u.s < v.s) || (u.s === v.s && u.t <= v.t);\n};\n\n/**\n * Given three vertices u,v,w such that geom.vertLeq(u,v) && geom.vertLeq(v,w),\n * evaluates the t-coord of the edge uw at the s-coord of the vertex v.\n * Returns v.t - (uw)(v.s), ie. the signed distance from uw to v.\n * If uw is vertical (and thus passes thru v), the result is zero.\n *\n * The calculation is extremely accurate and stable, even when v\n * is very close to u or w.  In particular if we set v.t = 0 and\n * let r be the negated result (this evaluates (uw)(v.s)), then\n * r is guaranteed to satisfy MIN(u.t,w.t) <= r <= MAX(u.t,w.t).\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @param {libtess.GluVertex} w\n * @return {number}\n */\nlibtess.geom.edgeEval = function(u, v, w) {\n\n  var gapL = v.s - u.s;\n  var gapR = w.s - v.s;\n\n  if (gapL + gapR > 0) {\n    if (gapL < gapR) {\n      return (v.t - u.t) + (u.t - w.t) * (gapL / (gapL + gapR));\n    } else {\n      return (v.t - w.t) + (w.t - u.t) * (gapR / (gapL + gapR));\n    }\n  }\n\n  // vertical line\n  return 0;\n};\n\n/**\n * Returns a number whose sign matches geom.edgeEval(u,v,w) but which\n * is cheaper to evaluate.  Returns > 0, == 0 , or < 0\n * as v is above, on, or below the edge uw.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @param {libtess.GluVertex} w\n * @return {number}\n */\nlibtess.geom.edgeSign = function(u, v, w) {\n\n  var gapL = v.s - u.s;\n  var gapR = w.s - v.s;\n\n  if (gapL + gapR > 0) {\n    return (v.t - w.t) * gapL + (v.t - u.t) * gapR;\n  }\n\n  // vertical line\n  return 0;\n};\n\n/**\n * Version of VertLeq with s and t transposed.\n * Returns whether vertex u is lexicographically less than or equal to vertex v.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @return {boolean}\n */\nlibtess.geom.transLeq = function(u, v) {\n  return (u.t < v.t) || (u.t === v.t && u.s <= v.s);\n};\n\n/**\n * Version of geom.edgeEval with s and t transposed.\n * Given three vertices u,v,w such that geom.transLeq(u,v) &&\n * geom.transLeq(v,w), evaluates the t-coord of the edge uw at the s-coord of\n * the vertex v. Returns v.s - (uw)(v.t), ie. the signed distance from uw to v.\n * If uw is vertical (and thus passes thru v), the result is zero.\n *\n * The calculation is extremely accurate and stable, even when v\n * is very close to u or w.  In particular if we set v.s = 0 and\n * let r be the negated result (this evaluates (uw)(v.t)), then\n * r is guaranteed to satisfy MIN(u.s,w.s) <= r <= MAX(u.s,w.s).\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @param {libtess.GluVertex} w\n * @return {number}\n */\nlibtess.geom.transEval = function(u, v, w) {\n\n  var gapL = v.t - u.t;\n  var gapR = w.t - v.t;\n\n  if (gapL + gapR > 0) {\n    if (gapL < gapR) {\n      return (v.s - u.s) + (u.s - w.s) * (gapL / (gapL + gapR));\n    } else {\n      return (v.s - w.s) + (w.s - u.s) * (gapR / (gapL + gapR));\n    }\n  }\n\n  // vertical line\n  return 0;\n};\n\n/**\n * Version of geom.edgeSign with s and t transposed.\n * Returns a number whose sign matches geom.transEval(u,v,w) but which\n * is cheaper to evaluate.  Returns > 0, == 0 , or < 0\n * as v is above, on, or below the edge uw.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @param {libtess.GluVertex} w\n * @return {number}\n */\nlibtess.geom.transSign = function(u, v, w) {\n\n  var gapL = v.t - u.t;\n  var gapR = w.t - v.t;\n\n  if (gapL + gapR > 0) {\n    return (v.s - w.s) * gapL + (v.s - u.s) * gapR;\n  }\n\n  // vertical line\n  return 0;\n};\n\n/**\n * Returns whether edge is directed from right to left.\n * @param {libtess.GluHalfEdge} e\n * @return {boolean}\n */\nlibtess.geom.edgeGoesLeft = function(e) {\n  return libtess.geom.vertLeq(e.dst(), e.org);\n};\n\n/**\n * Returns whether edge is directed from left to right.\n * @param {libtess.GluHalfEdge} e\n * @return {boolean}\n */\nlibtess.geom.edgeGoesRight = function(e) {\n  return libtess.geom.vertLeq(e.org, e.dst());\n};\n\n/**\n * Calculates the L1 distance between vertices u and v.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @return {number}\n */\nlibtess.geom.vertL1dist = function(u, v) {\n  return Math.abs(u.s - v.s) + Math.abs(u.t - v.t);\n};\n\n// NOTE(bckenny): vertCCW is called nowhere in libtess and isn't part of the\n// public API.\n/* istanbul ignore next */\n/**\n * For almost-degenerate situations, the results are not reliable.\n * Unless the floating-point arithmetic can be performed without\n * rounding errors, *any* implementation will give incorrect results\n * on some degenerate inputs, so the client must have some way to\n * handle this situation.\n * @param {!libtess.GluVertex} u\n * @param {!libtess.GluVertex} v\n * @param {!libtess.GluVertex} w\n * @return {boolean}\n */\nlibtess.geom.vertCCW = function(u, v, w) {\n  return (u.s * (v.t - w.t) + v.s * (w.t - u.t) + w.s * (u.t - v.t)) >= 0;\n};\n\n/**\n * Given parameters a,x,b,y returns the value (b*x+a*y)/(a+b),\n * or (x+y)/2 if a==b==0. It requires that a,b >= 0, and enforces\n * this in the rare case that one argument is slightly negative.\n * The implementation is extremely stable numerically.\n * In particular it guarantees that the result r satisfies\n * MIN(x,y) <= r <= MAX(x,y), and the results are very accurate\n * even when a and b differ greatly in magnitude.\n * @private\n * @param {number} a\n * @param {number} x\n * @param {number} b\n * @param {number} y\n * @return {number}\n */\nlibtess.geom.interpolate_ = function(a, x, b, y) {\n  // from Macro RealInterpolate:\n  //(a = (a < 0) ? 0 : a, b = (b < 0) ? 0 : b, ((a <= b) ? ((b == 0) ? ((x+y) / 2) : (x + (y-x) * (a/(a+b)))) : (y + (x-y) * (b/(a+b)))))\n  a = (a < 0) ? 0 : a;\n  b = (b < 0) ? 0 : b;\n\n  if (a <= b) {\n    if (b === 0) {\n      return (x + y) / 2;\n    } else {\n      return x + (y - x) * (a / (a + b));\n    }\n  } else {\n    return y + (x - y) * (b / (a + b));\n  }\n};\n\n/**\n * Given edges (o1,d1) and (o2,d2), compute their point of intersection.\n * The computed point is guaranteed to lie in the intersection of the\n * bounding rectangles defined by each edge.\n * @param {!libtess.GluVertex} o1\n * @param {!libtess.GluVertex} d1\n * @param {!libtess.GluVertex} o2\n * @param {!libtess.GluVertex} d2\n * @param {!libtess.GluVertex} v\n */\nlibtess.geom.edgeIntersect = function(o1, d1, o2, d2, v) {\n  // This is certainly not the most efficient way to find the intersection\n  // of two line segments, but it is very numerically stable.\n\n  // Strategy: find the two middle vertices in the VertLeq ordering,\n  // and interpolate the intersection s-value from these. Then repeat\n  // using the TransLeq ordering to find the intersection t-value.\n  var z1;\n  var z2;\n  var tmp;\n  if (!libtess.geom.vertLeq(o1, d1)) {\n    // Swap(o1, d1);\n    tmp = o1;\n    o1 = d1;\n    d1 = tmp;\n  }\n  if (!libtess.geom.vertLeq(o2, d2)) {\n    // Swap(o2, d2);\n    tmp = o2;\n    o2 = d2;\n    d2 = tmp;\n  }\n  if (!libtess.geom.vertLeq(o1, o2)) {\n    // Swap(o1, o2);\n    tmp = o1;\n    o1 = o2;\n    o2 = tmp;\n    // Swap(d1, d2);\n    tmp = d1;\n    d1 = d2;\n    d2 = tmp;\n  }\n\n  if (!libtess.geom.vertLeq(o2, d1)) {\n    // Technically, no intersection -- do our best\n    v.s = (o2.s + d1.s) / 2;\n\n  } else if (libtess.geom.vertLeq(d1, d2)) {\n    // Interpolate between o2 and d1\n    z1 = libtess.geom.edgeEval(o1, o2, d1);\n    z2 = libtess.geom.edgeEval(o2, d1, d2);\n    if (z1 + z2 < 0) { z1 = -z1; z2 = -z2; }\n    v.s = libtess.geom.interpolate_(z1, o2.s, z2, d1.s);\n\n  } else {\n    // Interpolate between o2 and d2\n    z1 = libtess.geom.edgeSign(o1, o2, d1);\n    z2 = -libtess.geom.edgeSign(o1, d2, d1);\n    if (z1 + z2 < 0) { z1 = -z1; z2 = -z2; }\n    v.s = libtess.geom.interpolate_(z1, o2.s, z2, d2.s);\n  }\n\n  // Now repeat the process for t\n  if (!libtess.geom.transLeq(o1, d1)) {\n    // Swap(o1, d1);\n    tmp = o1;\n    o1 = d1;\n    d1 = tmp;\n  }\n  if (!libtess.geom.transLeq(o2, d2)) {\n    // Swap(o2, d2);\n    tmp = o2;\n    o2 = d2;\n    d2 = tmp;\n  }\n  if (!libtess.geom.transLeq(o1, o2)) {\n    // Swap(o1, o2);\n    tmp = o1;\n    o1 = o2;\n    o2 = tmp;\n    // Swap(d1, d2);\n    tmp = d1;\n    d1 = d2;\n    d2 = tmp;\n  }\n\n  if (!libtess.geom.transLeq(o2, d1)) {\n    // Technically, no intersection -- do our best\n    v.t = (o2.t + d1.t) / 2;\n\n  } else if (libtess.geom.transLeq(d1, d2)) {\n    // Interpolate between o2 and d1\n    z1 = libtess.geom.transEval(o1, o2, d1);\n    z2 = libtess.geom.transEval(o2, d1, d2);\n    if (z1 + z2 < 0) { z1 = -z1; z2 = -z2; }\n    v.t = libtess.geom.interpolate_(z1, o2.t, z2, d1.t);\n\n  } else {\n    // Interpolate between o2 and d2\n    z1 = libtess.geom.transSign(o1, o2, d1);\n    z2 = -libtess.geom.transSign(o1, d2, d1);\n    if (z1 + z2 < 0) { z1 = -z1; z2 = -z2; }\n    v.t = libtess.geom.interpolate_(z1, o2.t, z2, d2.t);\n  }\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): could maybe merge GluMesh and mesh.js since these are\n// operations on the mesh\n\n/** @const */\nlibtess.mesh = {};\n\n/****************** Basic Edge Operations **********************/\n\n\n/**\n * makeEdge creates one edge, two vertices, and a loop (face).\n * The loop consists of the two new half-edges.\n *\n * @param {libtess.GluMesh} mesh [description].\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.makeEdge = function(mesh) {\n  // TODO(bckenny): probably move to GluMesh, but needs Make* methods with it\n\n  var e = libtess.mesh.makeEdgePair_(mesh.eHead);\n\n  // complete edge with vertices and face (see mesh.makeEdgePair_)\n  libtess.mesh.makeVertex_(e, mesh.vHead);\n  libtess.mesh.makeVertex_(e.sym, mesh.vHead);\n  libtess.mesh.makeFace_(e, mesh.fHead);\n\n  return e;\n};\n\n\n/**\n * meshSplice(eOrg, eDst) is the basic operation for changing the\n * mesh connectivity and topology. It changes the mesh so that\n *  eOrg.oNext <- OLD( eDst.oNext )\n *  eDst.oNext <- OLD( eOrg.oNext )\n * where OLD(...) means the value before the meshSplice operation.\n *\n * This can have two effects on the vertex structure:\n *  - if eOrg.org != eDst.org, the two vertices are merged together\n *  - if eOrg.org == eDst.org, the origin is split into two vertices\n * In both cases, eDst.org is changed and eOrg.org is untouched.\n *\n * Similarly (and independently) for the face structure,\n *  - if eOrg.lFace == eDst.lFace, one loop is split into two\n *  - if eOrg.lFace != eDst.lFace, two distinct loops are joined into one\n * In both cases, eDst.lFace is changed and eOrg.lFace is unaffected.\n *\n * Some special cases:\n * If eDst == eOrg, the operation has no effect.\n * If eDst == eOrg.lNext, the new face will have a single edge.\n * If eDst == eOrg.lPrev(), the old face will have a single edge.\n * If eDst == eOrg.oNext, the new vertex will have a single edge.\n * If eDst == eOrg.oPrev(), the old vertex will have a single edge.\n *\n * @param {libtess.GluHalfEdge} eOrg [description].\n * @param {libtess.GluHalfEdge} eDst [description].\n */\nlibtess.mesh.meshSplice = function(eOrg, eDst) {\n  // TODO: more descriptive name?\n\n  var joiningLoops = false;\n  var joiningVertices = false;\n\n  if (eOrg === eDst) {\n    return;\n  }\n\n  if (eDst.org !== eOrg.org) {\n    // We are merging two disjoint vertices -- destroy eDst.org\n    joiningVertices = true;\n    libtess.mesh.killVertex_(eDst.org, eOrg.org);\n  }\n\n  if (eDst.lFace !== eOrg.lFace) {\n    // We are connecting two disjoint loops -- destroy eDst.lFace\n    joiningLoops = true;\n    libtess.mesh.killFace_(eDst.lFace, eOrg.lFace);\n  }\n\n  // Change the edge structure\n  libtess.mesh.splice_(eDst, eOrg);\n\n  if (!joiningVertices) {\n    // We split one vertex into two -- the new vertex is eDst.org.\n    // Make sure the old vertex points to a valid half-edge.\n    libtess.mesh.makeVertex_(eDst, eOrg.org);\n    eOrg.org.anEdge = eOrg;\n  }\n\n  if (!joiningLoops) {\n    // We split one loop into two -- the new loop is eDst.lFace.\n    // Make sure the old face points to a valid half-edge.\n    libtess.mesh.makeFace_(eDst, eOrg.lFace);\n    eOrg.lFace.anEdge = eOrg;\n  }\n};\n\n\n/**\n * deleteEdge(eDel) removes the edge eDel. There are several cases:\n * if (eDel.lFace != eDel.rFace()), we join two loops into one; the loop\n * eDel.lFace is deleted. Otherwise, we are splitting one loop into two;\n * the newly created loop will contain eDel.dst(). If the deletion of eDel\n * would create isolated vertices, those are deleted as well.\n *\n * This function could be implemented as two calls to __gl_meshSplice\n * plus a few calls to memFree, but this would allocate and delete\n * unnecessary vertices and faces.\n *\n * @param {libtess.GluHalfEdge} eDel [description].\n */\nlibtess.mesh.deleteEdge = function(eDel) {\n  var eDelSym = eDel.sym;\n  var joiningLoops = false;\n\n  // First step: disconnect the origin vertex eDel.org.  We make all\n  // changes to get a consistent mesh in this \"intermediate\" state.\n  if (eDel.lFace !== eDel.rFace()) {\n    // We are joining two loops into one -- remove the left face\n    joiningLoops = true;\n    libtess.mesh.killFace_(eDel.lFace, eDel.rFace());\n  }\n\n  if (eDel.oNext === eDel) {\n    libtess.mesh.killVertex_(eDel.org, null);\n\n  } else {\n    // Make sure that eDel.org and eDel.rFace() point to valid half-edges\n    eDel.rFace().anEdge = eDel.oPrev();\n    eDel.org.anEdge = eDel.oNext;\n\n    libtess.mesh.splice_(eDel, eDel.oPrev());\n\n    if (!joiningLoops) {\n      // We are splitting one loop into two -- create a new loop for eDel.\n      libtess.mesh.makeFace_(eDel, eDel.lFace);\n    }\n  }\n\n  // Claim: the mesh is now in a consistent state, except that eDel.org\n  // may have been deleted.  Now we disconnect eDel.dst().\n  if (eDelSym.oNext === eDelSym) {\n    libtess.mesh.killVertex_(eDelSym.org, null);\n    libtess.mesh.killFace_(eDelSym.lFace, null);\n\n  } else {\n    // Make sure that eDel.dst() and eDel.lFace point to valid half-edges\n    eDel.lFace.anEdge = eDelSym.oPrev();\n    eDelSym.org.anEdge = eDelSym.oNext;\n    libtess.mesh.splice_(eDelSym, eDelSym.oPrev());\n  }\n\n  // Any isolated vertices or faces have already been freed.\n  libtess.mesh.killEdge_(eDel);\n};\n\n/******************** Other Edge Operations **********************/\n\n/* All these routines can be implemented with the basic edge\n * operations above.  They are provided for convenience and efficiency.\n */\n\n\n/**\n * addEdgeVertex(eOrg) creates a new edge eNew such that\n * eNew == eOrg.lNext, and eNew.dst() is a newly created vertex.\n * eOrg and eNew will have the same left face.\n *\n * @param {libtess.GluHalfEdge} eOrg [description].\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.addEdgeVertex = function(eOrg) {\n  // TODO(bckenny): why is it named this?\n\n  var eNew = libtess.mesh.makeEdgePair_(eOrg);\n  var eNewSym = eNew.sym;\n\n  // Connect the new edge appropriately\n  libtess.mesh.splice_(eNew, eOrg.lNext);\n\n  // Set the vertex and face information\n  eNew.org = eOrg.dst();\n\n  libtess.mesh.makeVertex_(eNewSym, eNew.org);\n\n  eNew.lFace = eNewSym.lFace = eOrg.lFace;\n\n  return eNew;\n};\n\n\n/**\n * splitEdge(eOrg) splits eOrg into two edges eOrg and eNew,\n * such that eNew == eOrg.lNext. The new vertex is eOrg.dst() == eNew.org.\n * eOrg and eNew will have the same left face.\n *\n * @param {libtess.GluHalfEdge} eOrg [description].\n * @return {!libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.splitEdge = function(eOrg) {\n  var tempHalfEdge = libtess.mesh.addEdgeVertex(eOrg);\n  var eNew = tempHalfEdge.sym;\n\n  // Disconnect eOrg from eOrg.dst() and connect it to eNew.org\n  libtess.mesh.splice_(eOrg.sym, eOrg.sym.oPrev());\n  libtess.mesh.splice_(eOrg.sym, eNew);\n\n  // Set the vertex and face information\n  eOrg.sym.org = eNew.org; // NOTE(bckenny): assignment to dst\n  eNew.dst().anEdge = eNew.sym;  // may have pointed to eOrg.sym\n  eNew.sym.lFace = eOrg.rFace(); // NOTE(bckenny): assignment to rFace\n  eNew.winding = eOrg.winding;  // copy old winding information\n  eNew.sym.winding = eOrg.sym.winding;\n\n  return eNew;\n};\n\n\n/**\n * connect(eOrg, eDst) creates a new edge from eOrg.dst()\n * to eDst.org, and returns the corresponding half-edge eNew.\n * If eOrg.lFace == eDst.lFace, this splits one loop into two,\n * and the newly created loop is eNew.lFace. Otherwise, two disjoint\n * loops are merged into one, and the loop eDst.lFace is destroyed.\n *\n * If (eOrg == eDst), the new face will have only two edges.\n * If (eOrg.lNext == eDst), the old face is reduced to a single edge.\n * If (eOrg.lNext.lNext == eDst), the old face is reduced to two edges.\n *\n * @param {libtess.GluHalfEdge} eOrg [description].\n * @param {libtess.GluHalfEdge} eDst [description].\n * @return {!libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.connect = function(eOrg, eDst) {\n  var joiningLoops = false;\n  var eNew = libtess.mesh.makeEdgePair_(eOrg);\n  var eNewSym = eNew.sym;\n\n  if (eDst.lFace !== eOrg.lFace) {\n    // We are connecting two disjoint loops -- destroy eDst.lFace\n    joiningLoops = true;\n    libtess.mesh.killFace_(eDst.lFace, eOrg.lFace);\n  }\n\n  // Connect the new edge appropriately\n  libtess.mesh.splice_(eNew, eOrg.lNext);\n  libtess.mesh.splice_(eNewSym, eDst);\n\n  // Set the vertex and face information\n  eNew.org = eOrg.dst();\n  eNewSym.org = eDst.org;\n  eNew.lFace = eNewSym.lFace = eOrg.lFace;\n\n  // Make sure the old face points to a valid half-edge\n  eOrg.lFace.anEdge = eNewSym;\n\n  if (!joiningLoops) {\n    // We split one loop into two -- the new loop is eNew.lFace\n    libtess.mesh.makeFace_(eNew, eOrg.lFace);\n  }\n  return eNew;\n};\n\n/******************** Other Operations **********************/\n\n\n/**\n * zapFace(fZap) destroys a face and removes it from the\n * global face list. All edges of fZap will have a null pointer as their\n * left face. Any edges which also have a null pointer as their right face\n * are deleted entirely (along with any isolated vertices this produces).\n * An entire mesh can be deleted by zapping its faces, one at a time,\n * in any order. Zapped faces cannot be used in further mesh operations!\n *\n * @param {libtess.GluFace} fZap [description].\n */\nlibtess.mesh.zapFace = function(fZap) {\n  var eStart = fZap.anEdge;\n\n  // walk around face, deleting edges whose right face is also NULL\n  var eNext = eStart.lNext;\n  var e;\n  do {\n    e = eNext;\n    eNext = e.lNext;\n\n    e.lFace = null;\n    if (e.rFace() === null) {\n      // delete the edge -- see mesh.deleteEdge above\n      if (e.oNext === e) {\n        libtess.mesh.killVertex_(e.org, null);\n\n      } else {\n        // Make sure that e.org points to a valid half-edge\n        e.org.anEdge = e.oNext;\n        libtess.mesh.splice_(e, e.oPrev());\n      }\n\n      var eSym = e.sym;\n\n      if (eSym.oNext === eSym) {\n        libtess.mesh.killVertex_(eSym.org, null);\n\n      } else {\n        // Make sure that eSym.org points to a valid half-edge\n        eSym.org.anEdge = eSym.oNext;\n        libtess.mesh.splice_(eSym, eSym.oPrev());\n      }\n      libtess.mesh.killEdge_(e);\n    }\n  } while (e !== eStart);\n\n  // delete from circular doubly-linked list\n  var fPrev = fZap.prev;\n  var fNext = fZap.next;\n  fNext.prev = fPrev;\n  fPrev.next = fNext;\n\n  // TODO(bckenny): memFree( fZap );\n  // TODO(bckenny): probably null at callsite\n};\n\n// TODO(bckenny): meshUnion isn't called within libtess and isn't part of the\n// public API. Could be useful if more mesh manipulation functions are exposed.\n/* istanbul ignore next */\n/**\n * meshUnion() forms the union of all structures in\n * both meshes, and returns the new mesh (the old meshes are destroyed).\n *\n * @param {!libtess.GluMesh} mesh1\n * @param {!libtess.GluMesh} mesh2\n * @return {!libtess.GluMesh}\n */\nlibtess.mesh.meshUnion = function(mesh1, mesh2) {\n  // TODO(bceknny): probably move to GluMesh method\n  var f1 = mesh1.fHead;\n  var v1 = mesh1.vHead;\n  var e1 = mesh1.eHead;\n\n  var f2 = mesh2.fHead;\n  var v2 = mesh2.vHead;\n  var e2 = mesh2.eHead;\n\n  // Add the faces, vertices, and edges of mesh2 to those of mesh1\n  if (f2.next !== f2) {\n    f1.prev.next = f2.next;\n    f2.next.prev = f1.prev;\n    f2.prev.next = f1;\n    f1.prev = f2.prev;\n  }\n\n  if (v2.next !== v2) {\n    v1.prev.next = v2.next;\n    v2.next.prev = v1.prev;\n    v2.prev.next = v1;\n    v1.prev = v2.prev;\n  }\n\n  if (e2.next !== e2) {\n    e1.sym.next.sym.next = e2.next;\n    e2.next.sym.next = e1.sym.next;\n    e2.sym.next.sym.next = e1;\n    e1.sym.next = e2.sym.next;\n  }\n\n  // TODO(bckenny): memFree(mesh2);\n  // TODO(bckenny): If function is kept, remove mesh2's data to enforce.\n  return mesh1;\n};\n\n\n/**\n * deleteMesh(mesh) will free all storage for any valid mesh.\n * @param {libtess.GluMesh} mesh [description].\n */\nlibtess.mesh.deleteMesh = function(mesh) {\n  // TODO(bckenny): unnecessary, I think.\n  // TODO(bckenny): might want to explicitly null at callsite\n  // lots of memFrees. see also DELETE_BY_ZAPPING\n};\n\n/************************ Utility Routines ************************/\n\n\n/**\n * Creates a new pair of half-edges which form their own loop.\n * No vertex or face structures are allocated, but these must be assigned\n * before the current edge operation is completed.\n *\n * TODO(bckenny): warning about eNext strictly being first of pair? (see code)\n *\n * @private\n * @param {libtess.GluHalfEdge} eNext [description].\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.makeEdgePair_ = function(eNext) {\n  var e = new libtess.GluHalfEdge();\n  var eSym = new libtess.GluHalfEdge();\n\n  // TODO(bckenny): how do we ensure this? see above comment in jsdoc\n  // Make sure eNext points to the first edge of the edge pair\n  // if (eNext->Sym < eNext ) { eNext = eNext->Sym; }\n\n  // NOTE(bckenny): check this for bugs in current implementation!\n\n  // Insert in circular doubly-linked list before eNext.\n  // Note that the prev pointer is stored in sym.next.\n  var ePrev = eNext.sym.next;\n  eSym.next = ePrev;\n  ePrev.sym.next = e;\n  e.next = eNext;\n  eNext.sym.next = eSym;\n\n  e.sym = eSym;\n  e.oNext = e;\n  e.lNext = eSym;\n\n  eSym.sym = e;\n  eSym.oNext = eSym;\n  eSym.lNext = e;\n\n  return e;\n};\n\n\n/**\n * splice_ is best described by the Guibas/Stolfi paper or the\n * CS348a notes. Basically, it modifies the mesh so that\n * a.oNext and b.oNext are exchanged. This can have various effects\n * depending on whether a and b belong to different face or vertex rings.\n * For more explanation see mesh.meshSplice below.\n *\n * @private\n * @param {libtess.GluHalfEdge} a [description].\n * @param {libtess.GluHalfEdge} b [description].\n */\nlibtess.mesh.splice_ = function(a, b) {\n  var aONext = a.oNext;\n  var bONext = b.oNext;\n\n  aONext.sym.lNext = b;\n  bONext.sym.lNext = a;\n  a.oNext = bONext;\n  b.oNext = aONext;\n};\n\n\n/**\n * makeVertex_(eOrig, vNext) attaches a new vertex and makes it the\n * origin of all edges in the vertex loop to which eOrig belongs. \"vNext\" gives\n * a place to insert the new vertex in the global vertex list.  We insert\n * the new vertex *before* vNext so that algorithms which walk the vertex\n * list will not see the newly created vertices.\n *\n * NOTE: unlike original, acutally allocates new vertex.\n *\n * @private\n * @param {libtess.GluHalfEdge} eOrig [description].\n * @param {libtess.GluVertex} vNext [description].\n */\nlibtess.mesh.makeVertex_ = function(eOrig, vNext) {\n  // insert in circular doubly-linked list before vNext\n  var vPrev = vNext.prev;\n  var vNew = new libtess.GluVertex(vNext, vPrev);\n  vPrev.next = vNew;\n  vNext.prev = vNew;\n\n  vNew.anEdge = eOrig;\n  // leave coords, s, t undefined\n  // TODO(bckenny): does above line mean 0 specifically, or does it matter?\n\n  // fix other edges on this vertex loop\n  var e = eOrig;\n  do {\n    e.org = vNew;\n    e = e.oNext;\n  } while (e !== eOrig);\n};\n\n\n/**\n * makeFace_(eOrig, fNext) attaches a new face and makes it the left\n * face of all edges in the face loop to which eOrig belongs. \"fNext\" gives\n * a place to insert the new face in the global face list.  We insert\n * the new face *before* fNext so that algorithms which walk the face\n * list will not see the newly created faces.\n *\n * NOTE: unlike original, acutally allocates new face.\n *\n * @private\n * @param {libtess.GluHalfEdge} eOrig [description].\n * @param {libtess.GluFace} fNext [description].\n */\nlibtess.mesh.makeFace_ = function(eOrig, fNext) {\n  // insert in circular doubly-linked list before fNext\n  var fPrev = fNext.prev;\n  var fNew = new libtess.GluFace(fNext, fPrev);\n  fPrev.next = fNew;\n  fNext.prev = fNew;\n\n  fNew.anEdge = eOrig;\n\n  // The new face is marked \"inside\" if the old one was.  This is a\n  // convenience for the common case where a face has been split in two.\n  fNew.inside = fNext.inside;\n\n  // fix other edges on this face loop\n  var e = eOrig;\n  do {\n    e.lFace = fNew;\n    e = e.lNext;\n  } while (e !== eOrig);\n};\n\n\n/**\n * killEdge_ destroys an edge (the half-edges eDel and eDel.sym),\n * and removes from the global edge list.\n *\n * @private\n * @param {libtess.GluHalfEdge} eDel [description].\n */\nlibtess.mesh.killEdge_ = function(eDel) {\n  // TODO(bckenny): in this case, no need to worry(?), but check when checking mesh.makeEdgePair_\n  // Half-edges are allocated in pairs, see EdgePair above\n  // if (eDel->Sym < eDel ) { eDel = eDel->Sym; }\n\n  // delete from circular doubly-linked list\n  var eNext = eDel.next;\n  var ePrev = eDel.sym.next;\n  eNext.sym.next = ePrev;\n  ePrev.sym.next = eNext;\n\n  // TODO(bckenny): memFree( eDel ); (which also frees eDel.sym)\n  // TODO(bckenny): need to null at callsites?\n};\n\n\n/**\n * killVertex_ destroys a vertex and removes it from the global\n * vertex list. It updates the vertex loop to point to a given new vertex.\n *\n * @private\n * @param {libtess.GluVertex} vDel [description].\n * @param {libtess.GluVertex} newOrg [description].\n */\nlibtess.mesh.killVertex_ = function(vDel, newOrg) {\n  var eStart = vDel.anEdge;\n\n  // change the origin of all affected edges\n  var e = eStart;\n  do {\n    e.org = newOrg;\n    e = e.oNext;\n  } while (e !== eStart);\n\n  // delete from circular doubly-linked list\n  var vPrev = vDel.prev;\n  var vNext = vDel.next;\n  vNext.prev = vPrev;\n  vPrev.next = vNext;\n\n  // TODO(bckenny): memFree( vDel );\n  // TODO(bckenny): need to null at callsites?\n};\n\n\n/**\n * killFace_ destroys a face and removes it from the global face\n * list. It updates the face loop to point to a given new face.\n *\n * @private\n * @param {libtess.GluFace} fDel [description].\n * @param {libtess.GluFace} newLFace [description].\n */\nlibtess.mesh.killFace_ = function(fDel, newLFace) {\n  var eStart = fDel.anEdge;\n\n  // change the left face of all affected edges\n  var e = eStart;\n  do {\n    e.lFace = newLFace;\n    e = e.lNext;\n  } while (e !== eStart);\n\n  // delete from circular doubly-linked list\n  var fPrev = fDel.prev;\n  var fNext = fDel.next;\n  fNext.prev = fPrev;\n  fPrev.next = fNext;\n\n  // TODO(bckenny): memFree( fDel );\n  // TODO(bckenny): need to null at callsites?\n};\n\n\n/* global libtess */\n\n/** @const */\nlibtess.normal = {};\n\n// TODO(bckenny): Integrate SLANTED_SWEEP somehow?\n/* The \"feature merging\" is not intended to be complete. There are\n * special cases where edges are nearly parallel to the sweep line\n * which are not implemented. The algorithm should still behave\n * robustly (ie. produce a reasonable tesselation) in the presence\n * of such edges, however it may miss features which could have been\n * merged. We could minimize this effect by choosing the sweep line\n * direction to be something unusual (ie. not parallel to one of the\n * coordinate axes).\n * #if defined(SLANTED_SWEEP)\n * #define S_UNIT_X  0.50941539564955385 // Pre-normalized\n * #define S_UNIT_Y  0.86052074622010633\n * #endif\n */\n\n/**\n * X coordinate of local basis for polygon projection.\n * @private\n * @const\n */\nlibtess.normal.S_UNIT_X_ = 1.0;\n\n/**\n * Y coordinate of local basis for polygon projection.\n * @private\n * @const\n */\nlibtess.normal.S_UNIT_Y_ = 0.0;\n\n/**\n * Determines a polygon normal and projects vertices onto the plane of the\n * polygon.\n * @param {!libtess.GluTesselator} tess\n */\nlibtess.normal.projectPolygon = function(tess) {\n  var computedNormal = false;\n\n  var norm = [\n    tess.normal[0],\n    tess.normal[1],\n    tess.normal[2]\n  ];\n  if (norm[0] === 0 && norm[1] === 0 && norm[2] === 0) {\n    libtess.normal.computeNormal_(tess, norm);\n    computedNormal = true;\n  }\n\n  var sUnit = tess.sUnit;\n  var tUnit = tess.tUnit;\n  var i = libtess.normal.longAxis_(norm);\n\n  // NOTE(bckenny): This branch is never taken. See comment on\n  // libtess.TRUE_PROJECT.\n  /* istanbul ignore if */\n  if (libtess.TRUE_PROJECT) {\n    // Choose the initial sUnit vector to be approximately perpendicular\n    // to the normal.\n    libtess.normal.normalize_(norm);\n\n    sUnit[i] = 0;\n    sUnit[(i + 1) % 3] = libtess.normal.S_UNIT_X_;\n    sUnit[(i + 2) % 3] = libtess.normal.S_UNIT_Y_;\n\n    // Now make it exactly perpendicular\n    var w = libtess.normal.dot_(sUnit, norm);\n    sUnit[0] -= w * norm[0];\n    sUnit[1] -= w * norm[1];\n    sUnit[2] -= w * norm[2];\n    libtess.normal.normalize_(sUnit);\n\n    // Choose tUnit so that (sUnit,tUnit,norm) form a right-handed frame\n    tUnit[0] = norm[1] * sUnit[2] - norm[2] * sUnit[1];\n    tUnit[1] = norm[2] * sUnit[0] - norm[0] * sUnit[2];\n    tUnit[2] = norm[0] * sUnit[1] - norm[1] * sUnit[0];\n    libtess.normal.normalize_(tUnit);\n\n  } else {\n    // Project perpendicular to a coordinate axis -- better numerically\n    sUnit[i] = 0;\n    sUnit[(i + 1) % 3] = libtess.normal.S_UNIT_X_;\n    sUnit[(i + 2) % 3] = libtess.normal.S_UNIT_Y_;\n\n    tUnit[i] = 0;\n    tUnit[(i + 1) % 3] = (norm[i] > 0) ?\n        -libtess.normal.S_UNIT_Y_ : libtess.normal.S_UNIT_Y_;\n    tUnit[(i + 2) % 3] = (norm[i] > 0) ?\n        libtess.normal.S_UNIT_X_ : -libtess.normal.S_UNIT_X_;\n  }\n\n  // Project the vertices onto the sweep plane\n  var vHead = tess.mesh.vHead;\n  for (var v = vHead.next; v !== vHead; v = v.next) {\n    v.s = libtess.normal.dot_(v.coords, sUnit);\n    v.t = libtess.normal.dot_(v.coords, tUnit);\n  }\n\n  if (computedNormal) {\n    libtess.normal.checkOrientation_(tess);\n  }\n};\n\n/**\n * Computes the dot product of vectors u and v.\n * @private\n * @param {!Array.<number>} u\n * @param {!Array.<number>} v\n * @return {number}\n */\nlibtess.normal.dot_ = function(u, v) {\n  return u[0] * v[0] + u[1] * v[1] + u[2] * v[2];\n};\n\n// NOTE(bckenny): only called from within libtess.normal.projectPolygon's\n// TRUE_PROJECT branch, so ignoring for code coverage.\n/* istanbul ignore next */\n/**\n * Normalize vector v.\n * @private\n * @param {!Array.<number>} v\n */\nlibtess.normal.normalize_ = function(v) {\n  var len = v[0] * v[0] + v[1] * v[1] + v[2] * v[2];\n\n  len = Math.sqrt(len);\n  v[0] /= len;\n  v[1] /= len;\n  v[2] /= len;\n};\n\n/**\n * Returns the index of the longest component of vector v.\n * @private\n * @param {!Array.<number>} v\n * @return {number}\n */\nlibtess.normal.longAxis_ = function(v) {\n  var i = 0;\n\n  if (Math.abs(v[1]) > Math.abs(v[0])) {\n    i = 1;\n  }\n  if (Math.abs(v[2]) > Math.abs(v[i])) {\n    i = 2;\n  }\n\n  return i;\n};\n\n/**\n * Compute an approximate normal of the polygon from the vertices themselves.\n * Result returned in norm.\n * @private\n * @param {!libtess.GluTesselator} tess\n * @param {!Array.<number>} norm\n */\nlibtess.normal.computeNormal_ = function(tess, norm) {\n  var maxVal = [\n    -2 * libtess.GLU_TESS_MAX_COORD,\n    -2 * libtess.GLU_TESS_MAX_COORD,\n    -2 * libtess.GLU_TESS_MAX_COORD\n  ];\n  var minVal = [\n    2 * libtess.GLU_TESS_MAX_COORD,\n    2 * libtess.GLU_TESS_MAX_COORD,\n    2 * libtess.GLU_TESS_MAX_COORD\n  ];\n  var maxVert = [];\n  var minVert = [];\n\n  var v;\n  var vHead = tess.mesh.vHead;\n  for (v = vHead.next; v !== vHead; v = v.next) {\n    for (var i = 0; i < 3; ++i) {\n      var c = v.coords[i];\n      if (c < minVal[i]) { minVal[i] = c; minVert[i] = v; }\n      if (c > maxVal[i]) { maxVal[i] = c; maxVert[i] = v; }\n    }\n  }\n\n  // Find two vertices separated by at least 1/sqrt(3) of the maximum\n  // distance between any two vertices\n  var index = 0;\n  if (maxVal[1] - minVal[1] > maxVal[0] - minVal[0]) { index = 1; }\n  if (maxVal[2] - minVal[2] > maxVal[index] - minVal[index]) { index = 2; }\n  if (minVal[index] >= maxVal[index]) {\n    // All vertices are the same -- normal doesn't matter\n    norm[0] = 0; norm[1] = 0; norm[2] = 1;\n    return;\n  }\n\n  // Look for a third vertex which forms the triangle with maximum area\n  // (Length of normal == twice the triangle area)\n  var maxLen2 = 0;\n  var v1 = minVert[index];\n  var v2 = maxVert[index];\n  var tNorm = [0, 0, 0];\n  var d1 = [\n    v1.coords[0] - v2.coords[0],\n    v1.coords[1] - v2.coords[1],\n    v1.coords[2] - v2.coords[2]\n  ];\n  var d2 = [0, 0, 0];\n  for (v = vHead.next; v !== vHead; v = v.next) {\n    d2[0] = v.coords[0] - v2.coords[0];\n    d2[1] = v.coords[1] - v2.coords[1];\n    d2[2] = v.coords[2] - v2.coords[2];\n    tNorm[0] = d1[1] * d2[2] - d1[2] * d2[1];\n    tNorm[1] = d1[2] * d2[0] - d1[0] * d2[2];\n    tNorm[2] = d1[0] * d2[1] - d1[1] * d2[0];\n    var tLen2 = tNorm[0] * tNorm[0] + tNorm[1] * tNorm[1] + tNorm[2] * tNorm[2];\n    if (tLen2 > maxLen2) {\n      maxLen2 = tLen2;\n      norm[0] = tNorm[0];\n      norm[1] = tNorm[1];\n      norm[2] = tNorm[2];\n    }\n  }\n\n  if (maxLen2 <= 0) {\n    // All points lie on a single line -- any decent normal will do\n    norm[0] = norm[1] = norm[2] = 0;\n    norm[libtess.normal.longAxis_(d1)] = 1;\n  }\n};\n\n/**\n * Check that the sum of the signed area of all projected contours is\n * non-negative. If not, negate the t-coordinates to reverse the orientation and\n * make it so.\n * @private\n * @param {!libtess.GluTesselator} tess\n */\nlibtess.normal.checkOrientation_ = function(tess) {\n  var area = 0;\n  var fHead = tess.mesh.fHead;\n  for (var f = fHead.next; f !== fHead; f = f.next) {\n    var e = f.anEdge;\n    if (e.winding <= 0) { continue; }\n    do {\n      area += (e.org.s - e.dst().s) * (e.org.t + e.dst().t);\n      e = e.lNext;\n    } while (e !== f.anEdge);\n  }\n\n  if (area < 0) {\n    // Reverse the orientation by flipping all the t-coordinates\n    var vHead = tess.mesh.vHead;\n    for (var v = vHead.next; v !== vHead; v = v.next) {\n      v.t = -v.t;\n    }\n    tess.tUnit[0] = -tess.tUnit[0];\n    tess.tUnit[1] = -tess.tUnit[1];\n    tess.tUnit[2] = -tess.tUnit[2];\n  }\n};\n\n\n/* global libtess */\n\n/** @const */\nlibtess.render = {};\n\n/**\n * Takes a mesh, breaks it into separate triangles, and renders them. The\n * rendering output is provided as callbacks (see the API). Set flagEdges to\n * true to get edgeFlag callbacks (tess.flagBoundary in original libtess).\n * @param {!libtess.GluTesselator} tess\n * @param {!libtess.GluMesh} mesh\n * @param {boolean} flagEdges\n */\nlibtess.render.renderMesh = function(tess, mesh, flagEdges) {\n  var beginOrBeginDataCalled = false;\n\n  // TODO(bckenny): edgeState needs to be boolean, but !== on first call\n  // force edge state output for first vertex\n  var edgeState = -1;\n\n  // We examine all faces in an arbitrary order. Whenever we find\n  // an inside triangle f, we render f.\n  // NOTE(bckenny): go backwards through face list to match original libtess\n  // triangle order\n  for (var f = mesh.fHead.prev; f !== mesh.fHead; f = f.prev) {\n    if (f.inside) {\n      // We're going to emit a triangle, so call begin callback once\n      if (!beginOrBeginDataCalled) {\n        tess.callBeginOrBeginData(libtess.primitiveType.GL_TRIANGLES);\n        beginOrBeginDataCalled = true;\n      }\n\n      // check that face has only three edges\n      var e = f.anEdge;\n      // Loop once for each edge (there will always be 3 edges)\n      do {\n        if (flagEdges) {\n          // Set the \"edge state\" to true just before we output the\n          // first vertex of each edge on the polygon boundary.\n          var newState = !e.rFace().inside ? 1 : 0; // TODO(bckenny): total hack to get edgeState working. fix me.\n          if (edgeState !== newState) {\n            edgeState = newState;\n            // TODO(bckenny): edgeState should be boolean now\n            tess.callEdgeFlagOrEdgeFlagData(!!edgeState);\n          }\n        }\n\n        // emit vertex\n        tess.callVertexOrVertexData(e.org.data);\n\n        e = e.lNext;\n      } while (e !== f.anEdge);\n    }\n  }\n\n  // only call end callback if begin was called\n  if (beginOrBeginDataCalled) {\n    tess.callEndOrEndData();\n  }\n};\n\n/**\n * Takes a mesh, and outputs one contour for each face marked \"inside\". The\n * rendering output is provided as callbacks (see the API).\n * @param {!libtess.GluTesselator} tess\n * @param {!libtess.GluMesh} mesh\n */\nlibtess.render.renderBoundary = function(tess, mesh) {\n  for (var f = mesh.fHead.next; f !== mesh.fHead; f = f.next) {\n    if (f.inside) {\n      tess.callBeginOrBeginData(libtess.primitiveType.GL_LINE_LOOP);\n\n      var e = f.anEdge;\n      do {\n        tess.callVertexOrVertexData(e.org.data);\n        e = e.lNext;\n      } while (e !== f.anEdge);\n\n      tess.callEndOrEndData();\n    }\n  }\n};\n\n\n/* global libtess */\n\n// TODO(bckenny): a number of these never return null (as opposed to original) and should be typed appropriately\n\n/*\n * Invariants for the Edge Dictionary.\n * - each pair of adjacent edges e2=succ(e1) satisfies edgeLeq_(e1,e2)\n *   at any valid location of the sweep event\n * - if edgeLeq_(e2,e1) as well (at any valid sweep event), then e1 and e2\n *   share a common endpoint\n * - for each e, e.dst() has been processed, but not e.org\n * - each edge e satisfies vertLeq(e.dst(),event) && vertLeq(event,e.org)\n *   where \"event\" is the current sweep line event.\n * - no edge e has zero length\n *\n * Invariants for the Mesh (the processed portion).\n * - the portion of the mesh left of the sweep line is a planar graph,\n *   ie. there is *some* way to embed it in the plane\n * - no processed edge has zero length\n * - no two processed vertices have identical coordinates\n * - each \"inside\" region is monotone, ie. can be broken into two chains\n *   of monotonically increasing vertices according to VertLeq(v1,v2)\n *   - a non-invariant: these chains may intersect (very slightly)\n *\n * Invariants for the Sweep.\n * - if none of the edges incident to the event vertex have an activeRegion\n *   (ie. none of these edges are in the edge dictionary), then the vertex\n *   has only right-going edges.\n * - if an edge is marked \"fixUpperEdge\" (it is a temporary edge introduced\n *   by ConnectRightVertex), then it is the only right-going edge from\n *   its associated vertex.  (This says that these edges exist only\n *   when it is necessary.)\n */\n\n/** @const */\nlibtess.sweep = {};\n\n\n/**\n * Make the sentinel coordinates big enough that they will never be\n * merged with real input features.  (Even with the largest possible\n * input contour and the maximum tolerance of 1.0, no merging will be\n * done with coordinates larger than 3 * libtess.GLU_TESS_MAX_COORD).\n * @private\n * @const\n * @type {number}\n */\nlibtess.sweep.SENTINEL_COORD_ = 4 * libtess.GLU_TESS_MAX_COORD;\n\n\n/**\n * Because vertices at exactly the same location are merged together\n * before we process the sweep event, some degenerate cases can't occur.\n * However if someone eventually makes the modifications required to\n * merge features which are close together, the cases below marked\n * TOLERANCE_NONZERO will be useful.  They were debugged before the\n * code to merge identical vertices in the main loop was added.\n * @private\n * @const\n * @type {boolean}\n */\nlibtess.sweep.TOLERANCE_NONZERO_ = false;\n\n\n/**\n * computeInterior(tess) computes the planar arrangement specified\n * by the given contours, and further subdivides this arrangement\n * into regions. Each region is marked \"inside\" if it belongs\n * to the polygon, according to the rule given by tess.windingRule.\n * Each interior region is guaranteed be monotone.\n *\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.computeInterior = function(tess) {\n  tess.fatalError = false;\n\n  // Each vertex defines an event for our sweep line. Start by inserting\n  // all the vertices in a priority queue. Events are processed in\n  // lexicographic order, ie.\n  // e1 < e2  iff  e1.x < e2.x || (e1.x == e2.x && e1.y < e2.y)\n  libtess.sweep.removeDegenerateEdges_(tess);\n  libtess.sweep.initPriorityQ_(tess);\n  libtess.sweep.initEdgeDict_(tess);\n\n  // TODO(bckenny): don't need the cast if pq's key is better typed\n  var v;\n  while ((v = /** @type {libtess.GluVertex} */(tess.pq.extractMin())) !== null) {\n    for (;;) {\n      var vNext = /** @type {libtess.GluVertex} */(tess.pq.minimum());\n      if (vNext === null || !libtess.geom.vertEq(vNext, v)) {\n        break;\n      }\n\n      /* Merge together all vertices at exactly the same location.\n       * This is more efficient than processing them one at a time,\n       * simplifies the code (see connectLeftDegenerate), and is also\n       * important for correct handling of certain degenerate cases.\n       * For example, suppose there are two identical edges A and B\n       * that belong to different contours (so without this code they would\n       * be processed by separate sweep events).  Suppose another edge C\n       * crosses A and B from above.  When A is processed, we split it\n       * at its intersection point with C.  However this also splits C,\n       * so when we insert B we may compute a slightly different\n       * intersection point.  This might leave two edges with a small\n       * gap between them.  This kind of error is especially obvious\n       * when using boundary extraction (GLU_TESS_BOUNDARY_ONLY).\n       */\n      vNext = /** @type {libtess.GluVertex} */(tess.pq.extractMin());\n      libtess.sweep.spliceMergeVertices_(tess, v.anEdge, vNext.anEdge);\n    }\n    libtess.sweep.sweepEvent_(tess, v);\n  }\n\n  // TODO(bckenny): what does the next comment mean? can we eliminate event except when debugging?\n  // Set tess.event for debugging purposes\n  var minRegion = tess.dict.getMin().getKey();\n  tess.event = minRegion.eUp.org;\n  libtess.sweep.doneEdgeDict_(tess);\n  libtess.sweep.donePriorityQ_(tess);\n\n  libtess.sweep.removeDegenerateFaces_(tess.mesh);\n  tess.mesh.checkMesh();\n};\n\n\n/**\n * When we merge two edges into one, we need to compute the combined\n * winding of the new edge.\n * @private\n * @param {libtess.GluHalfEdge} eDst [description].\n * @param {libtess.GluHalfEdge} eSrc [description].\n */\nlibtess.sweep.addWinding_ = function(eDst, eSrc) {\n  // NOTE(bckenny): from AddWinding macro\n  eDst.winding += eSrc.winding;\n  eDst.sym.winding += eSrc.sym.winding;\n};\n\n\n/**\n * Both edges must be directed from right to left (this is the canonical\n * direction for the upper edge of each region).\n *\n * The strategy is to evaluate a \"t\" value for each edge at the\n * current sweep line position, given by tess.event.  The calculations\n * are designed to be very stable, but of course they are not perfect.\n *\n * Special case: if both edge destinations are at the sweep event,\n * we sort the edges by slope (they would otherwise compare equally).\n *\n * @private\n * @param {!libtess.GluTesselator} tess\n * @param {!libtess.ActiveRegion} reg1\n * @param {!libtess.ActiveRegion} reg2\n * @return {boolean}\n */\nlibtess.sweep.edgeLeq_ = function(tess, reg1, reg2) {\n  var event = tess.event;\n  var e1 = reg1.eUp;\n  var e2 = reg2.eUp;\n\n  if (e1.dst() === event) {\n    if (e2.dst() === event) {\n      // Two edges right of the sweep line which meet at the sweep event.\n      // Sort them by slope.\n      if (libtess.geom.vertLeq(e1.org, e2.org)) {\n        return libtess.geom.edgeSign(e2.dst(), e1.org, e2.org) <= 0;\n      }\n\n      return libtess.geom.edgeSign(e1.dst(), e2.org, e1.org) >= 0;\n    }\n\n    return libtess.geom.edgeSign(e2.dst(), event, e2.org) <= 0;\n  }\n\n  if (e2.dst() === event) {\n    return libtess.geom.edgeSign(e1.dst(), event, e1.org) >= 0;\n  }\n\n  // General case - compute signed distance *from* e1, e2 to event\n  var t1 = libtess.geom.edgeEval(e1.dst(), event, e1.org);\n  var t2 = libtess.geom.edgeEval(e2.dst(), event, e2.org);\n  return (t1 >= t2);\n};\n\n\n/**\n * [deleteRegion_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} reg [description].\n */\nlibtess.sweep.deleteRegion_ = function(tess, reg) {\n  if (reg.fixUpperEdge) {\n    // It was created with zero winding number, so it better be\n    // deleted with zero winding number (ie. it better not get merged\n    // with a real edge).\n  }\n\n  reg.eUp.activeRegion = null;\n\n  tess.dict.deleteNode(reg.nodeUp);\n  reg.nodeUp = null;\n\n  // memFree( reg ); TODO(bckenny)\n  // TODO(bckenny): may need to null at callsite\n};\n\n\n/**\n * Replace an upper edge which needs fixing (see connectRightVertex).\n * @private\n * @param {libtess.ActiveRegion} reg [description].\n * @param {libtess.GluHalfEdge} newEdge [description].\n */\nlibtess.sweep.fixUpperEdge_ = function(reg, newEdge) {\n  libtess.mesh.deleteEdge(reg.eUp);\n\n  reg.fixUpperEdge = false;\n  reg.eUp = newEdge;\n  newEdge.activeRegion = reg;\n};\n\n\n/**\n * Find the region above the uppermost edge with the same origin.\n * @private\n * @param {libtess.ActiveRegion} reg [description].\n * @return {libtess.ActiveRegion} [description].\n */\nlibtess.sweep.topLeftRegion_ = function(reg) {\n  var org = reg.eUp.org;\n\n  // Find the region above the uppermost edge with the same origin\n  do {\n    reg = reg.regionAbove();\n  } while (reg.eUp.org === org);\n\n  // If the edge above was a temporary edge introduced by connectRightVertex,\n  // now is the time to fix it.\n  if (reg.fixUpperEdge) {\n    var e = libtess.mesh.connect(reg.regionBelow().eUp.sym, reg.eUp.lNext);\n    libtess.sweep.fixUpperEdge_(reg, e);\n    reg = reg.regionAbove();\n  }\n\n  return reg;\n};\n\n\n/**\n * Find the region above the uppermost edge with the same destination.\n * @private\n * @param {libtess.ActiveRegion} reg [description].\n * @return {libtess.ActiveRegion} [description].\n */\nlibtess.sweep.topRightRegion_ = function(reg) {\n  var dst = reg.eUp.dst();\n\n  do {\n    reg = reg.regionAbove();\n  } while (reg.eUp.dst() === dst);\n\n  return reg;\n};\n\n\n/**\n * Add a new active region to the sweep line, *somewhere* below \"regAbove\"\n * (according to where the new edge belongs in the sweep-line dictionary).\n * The upper edge of the new region will be \"eNewUp\".\n * Winding number and \"inside\" flag are not updated.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regAbove [description].\n * @param {libtess.GluHalfEdge} eNewUp [description].\n * @return {libtess.ActiveRegion} regNew.\n */\nlibtess.sweep.addRegionBelow_ = function(tess, regAbove, eNewUp) {\n  var regNew = new libtess.ActiveRegion();\n\n  regNew.eUp = eNewUp;\n  regNew.nodeUp = tess.dict.insertBefore(regAbove.nodeUp, regNew);\n  eNewUp.activeRegion = regNew;\n\n  return regNew;\n};\n\n\n/**\n * [isWindingInside_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {number} n int.\n * @return {boolean} [description].\n */\nlibtess.sweep.isWindingInside_ = function(tess, n) {\n  switch (tess.windingRule) {\n    case libtess.windingRule.GLU_TESS_WINDING_ODD:\n      return ((n & 1) !== 0);\n    case libtess.windingRule.GLU_TESS_WINDING_NONZERO:\n      return (n !== 0);\n    case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:\n      return (n > 0);\n    case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:\n      return (n < 0);\n    case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:\n      return (n >= 2) || (n <= -2);\n  }\n\n  // TODO(bckenny): not reached\n  return false;\n};\n\n\n/**\n * [computeWinding_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} reg [description].\n */\nlibtess.sweep.computeWinding_ = function(tess, reg) {\n  reg.windingNumber = reg.regionAbove().windingNumber + reg.eUp.winding;\n  reg.inside = libtess.sweep.isWindingInside_(tess, reg.windingNumber);\n};\n\n\n/**\n * Delete a region from the sweep line. This happens when the upper\n * and lower chains of a region meet (at a vertex on the sweep line).\n * The \"inside\" flag is copied to the appropriate mesh face (we could\n * not do this before -- since the structure of the mesh is always\n * changing, this face may not have even existed until now).\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} reg [description].\n */\nlibtess.sweep.finishRegion_ = function(tess, reg) {\n  // TODO(bckenny): may need to null reg at callsite\n\n  var e = reg.eUp;\n  var f = e.lFace;\n\n  f.inside = reg.inside;\n  f.anEdge = e;   // optimization for tessmono.tessellateMonoRegion() // TODO(bckenny): how so?\n  libtess.sweep.deleteRegion_(tess, reg);\n};\n\n\n/**\n * We are given a vertex with one or more left-going edges. All affected\n * edges should be in the edge dictionary. Starting at regFirst.eUp,\n * we walk down deleting all regions where both edges have the same\n * origin vOrg. At the same time we copy the \"inside\" flag from the\n * active region to the face, since at this point each face will belong\n * to at most one region (this was not necessarily true until this point\n * in the sweep). The walk stops at the region above regLast; if regLast\n * is null we walk as far as possible. At the same time we relink the\n * mesh if necessary, so that the ordering of edges around vOrg is the\n * same as in the dictionary.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regFirst [description].\n * @param {libtess.ActiveRegion} regLast [description].\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.sweep.finishLeftRegions_ = function(tess, regFirst, regLast) {\n  var regPrev = regFirst;\n  var ePrev = regFirst.eUp;\n  while (regPrev !== regLast) {\n    // placement was OK\n    regPrev.fixUpperEdge = false;\n    var reg = regPrev.regionBelow();\n    var e = reg.eUp;\n    if (e.org !== ePrev.org) {\n      if (!reg.fixUpperEdge) {\n        /* Remove the last left-going edge. Even though there are no further\n         * edges in the dictionary with this origin, there may be further\n         * such edges in the mesh (if we are adding left edges to a vertex\n         * that has already been processed). Thus it is important to call\n         * finishRegion rather than just deleteRegion.\n         */\n        libtess.sweep.finishRegion_(tess, regPrev);\n        break;\n      }\n\n      // If the edge below was a temporary edge introduced by\n      // connectRightVertex, now is the time to fix it.\n      e = libtess.mesh.connect(ePrev.lPrev(), e.sym);\n      libtess.sweep.fixUpperEdge_(reg, e);\n    }\n\n    // Relink edges so that ePrev.oNext === e\n    if (ePrev.oNext !== e) {\n      libtess.mesh.meshSplice(e.oPrev(), e);\n      libtess.mesh.meshSplice(ePrev, e);\n    }\n\n    // may change reg.eUp\n    libtess.sweep.finishRegion_(tess, regPrev);\n    ePrev = reg.eUp;\n    regPrev = reg;\n  }\n\n  return ePrev;\n};\n\n\n/**\n * Purpose: insert right-going edges into the edge dictionary, and update\n * winding numbers and mesh connectivity appropriately. All right-going\n * edges share a common origin vOrg. Edges are inserted CCW starting at\n * eFirst; the last edge inserted is eLast.oPrev. If vOrg has any\n * left-going edges already processed, then eTopLeft must be the edge\n * such that an imaginary upward vertical segment from vOrg would be\n * contained between eTopLeft.oPrev and eTopLeft; otherwise eTopLeft\n * should be null.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @param {libtess.GluHalfEdge} eFirst [description].\n * @param {libtess.GluHalfEdge} eLast [description].\n * @param {libtess.GluHalfEdge} eTopLeft [description].\n * @param {boolean} cleanUp [description].\n */\nlibtess.sweep.addRightEdges_ = function(tess, regUp, eFirst, eLast, eTopLeft,\n    cleanUp) {\n\n  var firstTime = true;\n\n  // Insert the new right-going edges in the dictionary\n  var e = eFirst;\n  do {\n    libtess.sweep.addRegionBelow_(tess, regUp, e.sym);\n    e = e.oNext;\n  } while (e !== eLast);\n\n  // Walk *all* right-going edges from e.org, in the dictionary order,\n  // updating the winding numbers of each region, and re-linking the mesh\n  // edges to match the dictionary ordering (if necessary).\n  if (eTopLeft === null) {\n    eTopLeft = regUp.regionBelow().eUp.rPrev();\n  }\n  var regPrev = regUp;\n  var ePrev = eTopLeft;\n  var reg;\n  for (;;) {\n    reg = regPrev.regionBelow();\n    e = reg.eUp.sym;\n    if (e.org !== ePrev.org) {\n      break;\n    }\n\n    if (e.oNext !== ePrev) {\n      // Unlink e from its current position, and relink below ePrev\n      libtess.mesh.meshSplice(e.oPrev(), e);\n      libtess.mesh.meshSplice(ePrev.oPrev(), e);\n    }\n    // Compute the winding number and \"inside\" flag for the new regions\n    reg.windingNumber = regPrev.windingNumber - e.winding;\n    reg.inside = libtess.sweep.isWindingInside_(tess, reg.windingNumber);\n\n    // Check for two outgoing edges with same slope -- process these\n    // before any intersection tests (see example in libtess.sweep.computeInterior).\n    regPrev.dirty = true;\n    if (!firstTime && libtess.sweep.checkForRightSplice_(tess, regPrev)) {\n      libtess.sweep.addWinding_(e, ePrev);\n      libtess.sweep.deleteRegion_(tess, regPrev); // TODO(bckenny): need to null regPrev anywhere else?\n      libtess.mesh.deleteEdge(ePrev);\n    }\n    firstTime = false;\n    regPrev = reg;\n    ePrev = e;\n  }\n\n  regPrev.dirty = true;\n\n  if (cleanUp) {\n    // Check for intersections between newly adjacent edges.\n    libtess.sweep.walkDirtyRegions_(tess, regPrev);\n  }\n};\n\n\n/**\n * [callCombine_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.GluVertex} isect [description].\n * @param {Array.<Object>} data [description].\n * @param {Array.<number>} weights [description].\n * @param {boolean} needed [description].\n */\nlibtess.sweep.callCombine_ = function(tess, isect, data, weights, needed) {\n  // Copy coord data in case the callback changes it.\n  var coords = [\n    isect.coords[0],\n    isect.coords[1],\n    isect.coords[2]\n  ];\n\n  isect.data = null;\n  isect.data = tess.callCombineOrCombineData(coords, data, weights);\n  if (isect.data === null) {\n    if (!needed) {\n      // not needed, so just use data from first vertex\n      isect.data = data[0];\n\n    } else if (!tess.fatalError) {\n      // The only way fatal error is when two edges are found to intersect,\n      // but the user has not provided the callback necessary to handle\n      // generated intersection points.\n      tess.callErrorOrErrorData(\n          libtess.errorType.GLU_TESS_NEED_COMBINE_CALLBACK);\n      tess.fatalError = true;\n    }\n  }\n};\n\n\n/**\n * Two vertices with idential coordinates are combined into one.\n * e1.org is kept, while e2.org is discarded.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.GluHalfEdge} e1 [description].\n * @param {libtess.GluHalfEdge} e2 [description].\n */\nlibtess.sweep.spliceMergeVertices_ = function(tess, e1, e2) {\n  // TODO(bckenny): better way to init these? save them?\n  var data = [null, null, null, null];\n  var weights = [0.5, 0.5, 0, 0];\n\n  data[0] = e1.org.data;\n  data[1] = e2.org.data;\n  libtess.sweep.callCombine_(tess, e1.org, data, weights, false);\n  libtess.mesh.meshSplice(e1, e2);\n};\n\n\n/**\n * Find some weights which describe how the intersection vertex is\n * a linear combination of org and dst. Each of the two edges\n * which generated \"isect\" is allocated 50% of the weight; each edge\n * splits the weight between its org and dst according to the\n * relative distance to \"isect\".\n *\n * @private\n * @param {libtess.GluVertex} isect [description].\n * @param {libtess.GluVertex} org [description].\n * @param {libtess.GluVertex} dst [description].\n * @param {Array.<number>} weights [description].\n * @param {number} weightIndex Index into weights for first weight to supply.\n */\nlibtess.sweep.vertexWeights_ = function(isect, org, dst, weights, weightIndex) {\n  // TODO(bckenny): think through how we can use L1dist here and be correct for coords\n  var t1 = libtess.geom.vertL1dist(org, isect);\n  var t2 = libtess.geom.vertL1dist(dst, isect);\n\n  // TODO(bckenny): introduced weightIndex to mimic addressing in original\n  // 1) document (though it is private and only used from getIntersectData)\n  // 2) better way? manually inline into getIntersectData? supply two two-length tmp arrays?\n  var i0 = weightIndex;\n  var i1 = weightIndex + 1;\n  weights[i0] = 0.5 * t2 / (t1 + t2);\n  weights[i1] = 0.5 * t1 / (t1 + t2);\n  isect.coords[0] += weights[i0] * org.coords[0] + weights[i1] * dst.coords[0];\n  isect.coords[1] += weights[i0] * org.coords[1] + weights[i1] * dst.coords[1];\n  isect.coords[2] += weights[i0] * org.coords[2] + weights[i1] * dst.coords[2];\n};\n\n\n/**\n * We've computed a new intersection point, now we need a \"data\" pointer\n * from the user so that we can refer to this new vertex in the\n * rendering callbacks.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.GluVertex} isect [description].\n * @param {libtess.GluVertex} orgUp [description].\n * @param {libtess.GluVertex} dstUp [description].\n * @param {libtess.GluVertex} orgLo [description].\n * @param {libtess.GluVertex} dstLo [description].\n */\nlibtess.sweep.getIntersectData_ = function(tess, isect, orgUp, dstUp, orgLo,\n    dstLo) {\n\n  // TODO(bckenny): called for every intersection event, should these be from a pool?\n  // TODO(bckenny): better way to init these?\n  var weights = [0, 0, 0, 0];\n  var data = [\n    orgUp.data,\n    dstUp.data,\n    orgLo.data,\n    dstLo.data\n  ];\n\n  // TODO(bckenny): it appears isect is a reappropriated vertex, so does need to be zeroed.\n  // double check this.\n  isect.coords[0] = isect.coords[1] = isect.coords[2] = 0;\n\n  // TODO(bckenny): see note in libtess.sweep.vertexWeights_ for explanation of weightIndex. fix?\n  libtess.sweep.vertexWeights_(isect, orgUp, dstUp, weights, 0);\n  libtess.sweep.vertexWeights_(isect, orgLo, dstLo, weights, 2);\n\n  libtess.sweep.callCombine_(tess, isect, data, weights, true);\n};\n\n\n/**\n * Check the upper and lower edge of regUp, to make sure that the\n * eUp.org is above eLo, or eLo.org is below eUp (depending on which\n * origin is leftmost).\n *\n * The main purpose is to splice right-going edges with the same\n * dest vertex and nearly identical slopes (ie. we can't distinguish\n * the slopes numerically). However the splicing can also help us\n * to recover from numerical errors. For example, suppose at one\n * point we checked eUp and eLo, and decided that eUp.org is barely\n * above eLo. Then later, we split eLo into two edges (eg. from\n * a splice operation like this one). This can change the result of\n * our test so that now eUp.org is incident to eLo, or barely below it.\n * We must correct this condition to maintain the dictionary invariants.\n *\n * One possibility is to check these edges for intersection again\n * (i.e. checkForIntersect). This is what we do if possible. However\n * checkForIntersect requires that tess.event lies between eUp and eLo,\n * so that it has something to fall back on when the intersection\n * calculation gives us an unusable answer. So, for those cases where\n * we can't check for intersection, this routine fixes the problem\n * by just splicing the offending vertex into the other edge.\n * This is a guaranteed solution, no matter how degenerate things get.\n * Basically this is a combinatorial solution to a numerical problem.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @return {boolean} [description].\n */\nlibtess.sweep.checkForRightSplice_ = function(tess, regUp) {\n  // TODO(bckenny): fully learn how these two checks work\n\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n\n  if (libtess.geom.vertLeq(eUp.org, eLo.org)) {\n    if (libtess.geom.edgeSign(eLo.dst(), eUp.org, eLo.org) > 0) {\n      return false;\n    }\n\n    // eUp.org appears to be below eLo\n    if (!libtess.geom.vertEq(eUp.org, eLo.org)) {\n      // Splice eUp.org into eLo\n      libtess.mesh.splitEdge(eLo.sym);\n      libtess.mesh.meshSplice(eUp, eLo.oPrev());\n      regUp.dirty = regLo.dirty = true;\n\n    } else if (eUp.org !== eLo.org) {\n      // merge the two vertices, discarding eUp.org\n      // TODO(bckenny): fix pqHandle null situation\n      tess.pq.remove(/** @type {libtess.PQHandle} */(eUp.org.pqHandle));\n      libtess.sweep.spliceMergeVertices_(tess, eLo.oPrev(), eUp);\n    }\n\n  } else {\n    if (libtess.geom.edgeSign(eUp.dst(), eLo.org, eUp.org) < 0) {\n      return false;\n    }\n\n    // eLo.org appears to be above eUp, so splice eLo.org into eUp\n    regUp.regionAbove().dirty = regUp.dirty = true;\n    libtess.mesh.splitEdge(eUp.sym);\n    libtess.mesh.meshSplice(eLo.oPrev(), eUp);\n  }\n\n  return true;\n};\n\n\n/**\n * Check the upper and lower edge of regUp to make sure that the\n * eUp.dst() is above eLo, or eLo.dst() is below eUp (depending on which\n * destination is rightmost).\n *\n * Theoretically, this should always be true. However, splitting an edge\n * into two pieces can change the results of previous tests. For example,\n * suppose at one point we checked eUp and eLo, and decided that eUp.dst()\n * is barely above eLo. Then later, we split eLo into two edges (eg. from\n * a splice operation like this one). This can change the result of\n * the test so that now eUp.dst() is incident to eLo, or barely below it.\n * We must correct this condition to maintain the dictionary invariants\n * (otherwise new edges might get inserted in the wrong place in the\n * dictionary, and bad stuff will happen).\n *\n * We fix the problem by just splicing the offending vertex into the\n * other edge.\n *\n * @private\n * @param {libtess.GluTesselator} tess description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @return {boolean} [description].\n */\nlibtess.sweep.checkForLeftSplice_ = function(tess, regUp) {\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n  var e;\n\n  if (libtess.geom.vertLeq(eUp.dst(), eLo.dst())) {\n    if (libtess.geom.edgeSign(eUp.dst(), eLo.dst(), eUp.org) < 0) {\n      return false;\n    }\n\n    // eLo.dst() is above eUp, so splice eLo.dst() into eUp\n    regUp.regionAbove().dirty = regUp.dirty = true;\n    e = libtess.mesh.splitEdge(eUp);\n    libtess.mesh.meshSplice(eLo.sym, e);\n    e.lFace.inside = regUp.inside;\n\n  } else {\n    if (libtess.geom.edgeSign(eLo.dst(), eUp.dst(), eLo.org) > 0) {\n      return false;\n    }\n\n    // eUp.dst() is below eLo, so splice eUp.dst() into eLo\n    regUp.dirty = regLo.dirty = true;\n    e = libtess.mesh.splitEdge(eLo);\n    libtess.mesh.meshSplice(eUp.lNext, eLo.sym);\n    e.rFace().inside = regUp.inside;\n  }\n\n  return true;\n};\n\n\n/**\n * Check the upper and lower edges of the given region to see if\n * they intersect. If so, create the intersection and add it\n * to the data structures.\n *\n * Returns true if adding the new intersection resulted in a recursive\n * call to addRightEdges_(); in this case all \"dirty\" regions have been\n * checked for intersections, and possibly regUp has been deleted.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @return {boolean} [description].\n */\nlibtess.sweep.checkForIntersect_ = function(tess, regUp) {\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n  var orgUp = eUp.org;\n  var orgLo = eLo.org;\n  var dstUp = eUp.dst();\n  var dstLo = eLo.dst();\n\n  var isect = new libtess.GluVertex();\n\n  if (orgUp === orgLo) {\n    // right endpoints are the same\n    return false;\n  }\n\n  var tMinUp = Math.min(orgUp.t, dstUp.t);\n  var tMaxLo = Math.max(orgLo.t, dstLo.t);\n  if (tMinUp > tMaxLo) {\n    // t ranges do not overlap\n    return false;\n  }\n\n  if (libtess.geom.vertLeq(orgUp, orgLo)) {\n    if (libtess.geom.edgeSign(dstLo, orgUp, orgLo) > 0) {\n      return false;\n    }\n  } else {\n    if (libtess.geom.edgeSign(dstUp, orgLo, orgUp) < 0) {\n      return false;\n    }\n  }\n\n  // At this point the edges intersect, at least marginally\n  libtess.geom.edgeIntersect(dstUp, orgUp, dstLo, orgLo, isect);\n\n  // The following properties are guaranteed:\n\n  if (libtess.geom.vertLeq(isect, tess.event)) {\n    /* The intersection point lies slightly to the left of the sweep line,\n     * so move it until it's slightly to the right of the sweep line.\n     * (If we had perfect numerical precision, this would never happen\n     * in the first place). The easiest and safest thing to do is\n     * replace the intersection by tess.event.\n     */\n    isect.s = tess.event.s;\n    isect.t = tess.event.t;\n  }\n\n  // TODO(bckenny): try to find test54.d\n  /* Similarly, if the computed intersection lies to the right of the\n   * rightmost origin (which should rarely happen), it can cause\n   * unbelievable inefficiency on sufficiently degenerate inputs.\n   * (If you have the test program, try running test54.d with the\n   * \"X zoom\" option turned on).\n   */\n  var orgMin = libtess.geom.vertLeq(orgUp, orgLo) ? orgUp : orgLo;\n  if (libtess.geom.vertLeq(orgMin, isect)) {\n    isect.s = orgMin.s;\n    isect.t = orgMin.t;\n  }\n\n  if (libtess.geom.vertEq(isect, orgUp) || libtess.geom.vertEq(isect, orgLo)) {\n    // Easy case -- intersection at one of the right endpoints\n    libtess.sweep.checkForRightSplice_(tess, regUp);\n    return false;\n  }\n\n  // TODO(bckenny): clean this up; length is distracting\n  if ((!libtess.geom.vertEq(dstUp, tess.event) &&\n      libtess.geom.edgeSign(dstUp, tess.event, isect) >= 0) ||\n      (!libtess.geom.vertEq(dstLo, tess.event) &&\n      libtess.geom.edgeSign(dstLo, tess.event, isect) <= 0)) {\n\n    /* Very unusual -- the new upper or lower edge would pass on the\n     * wrong side of the sweep event, or through it. This can happen\n     * due to very small numerical errors in the intersection calculation.\n     */\n    if (dstLo === tess.event) {\n      // Splice dstLo into eUp, and process the new region(s)\n      libtess.mesh.splitEdge(eUp.sym);\n      libtess.mesh.meshSplice(eLo.sym, eUp);\n      regUp = libtess.sweep.topLeftRegion_(regUp);\n      eUp = regUp.regionBelow().eUp;\n      libtess.sweep.finishLeftRegions_(tess, regUp.regionBelow(), regLo);\n      libtess.sweep.addRightEdges_(tess, regUp, eUp.oPrev(), eUp, eUp, true);\n      return true;\n    }\n\n    if (dstUp === tess.event) {\n      // Splice dstUp into eLo, and process the new region(s)\n      libtess.mesh.splitEdge(eLo.sym);\n      libtess.mesh.meshSplice(eUp.lNext, eLo.oPrev());\n      regLo = regUp;\n      regUp = libtess.sweep.topRightRegion_(regUp);\n      var e = regUp.regionBelow().eUp.rPrev();\n      regLo.eUp = eLo.oPrev();\n      eLo = libtess.sweep.finishLeftRegions_(tess, regLo, null);\n      libtess.sweep.addRightEdges_(tess, regUp, eLo.oNext, eUp.rPrev(), e,\n          true);\n      return true;\n    }\n\n    /* Special case: called from connectRightVertex. If either\n     * edge passes on the wrong side of tess.event, split it\n     * (and wait for connectRightVertex to splice it appropriately).\n     */\n    if (libtess.geom.edgeSign(dstUp, tess.event, isect) >= 0) {\n      regUp.regionAbove().dirty = regUp.dirty = true;\n      libtess.mesh.splitEdge(eUp.sym);\n      eUp.org.s = tess.event.s;\n      eUp.org.t = tess.event.t;\n    }\n\n    if (libtess.geom.edgeSign(dstLo, tess.event, isect) <= 0) {\n      regUp.dirty = regLo.dirty = true;\n      libtess.mesh.splitEdge(eLo.sym);\n      eLo.org.s = tess.event.s;\n      eLo.org.t = tess.event.t;\n    }\n\n    // leave the rest for connectRightVertex\n    return false;\n  }\n\n  /* General case -- split both edges, splice into new vertex.\n   * When we do the splice operation, the order of the arguments is\n   * arbitrary as far as correctness goes. However, when the operation\n   * creates a new face, the work done is proportional to the size of\n   * the new face. We expect the faces in the processed part of\n   * the mesh (ie. eUp.lFace) to be smaller than the faces in the\n   * unprocessed original contours (which will be eLo.oPrev.lFace).\n   */\n  libtess.mesh.splitEdge(eUp.sym);\n  libtess.mesh.splitEdge(eLo.sym);\n  libtess.mesh.meshSplice(eLo.oPrev(), eUp);\n  eUp.org.s = isect.s;\n  eUp.org.t = isect.t;\n  eUp.org.pqHandle = tess.pq.insert(eUp.org);\n  libtess.sweep.getIntersectData_(tess, eUp.org, orgUp, dstUp, orgLo, dstLo);\n  regUp.regionAbove().dirty = regUp.dirty = regLo.dirty = true;\n\n  return false;\n};\n\n\n/**\n * When the upper or lower edge of any region changes, the region is\n * marked \"dirty\". This routine walks through all the dirty regions\n * and makes sure that the dictionary invariants are satisfied\n * (see the comments at the beginning of this file). Of course,\n * new dirty regions can be created as we make changes to restore\n * the invariants.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n */\nlibtess.sweep.walkDirtyRegions_ = function(tess, regUp) {\n  var regLo = regUp.regionBelow();\n\n  for (;;) {\n    // Find the lowest dirty region (we walk from the bottom up).\n    while (regLo.dirty) {\n      regUp = regLo;\n      regLo = regLo.regionBelow();\n    }\n    if (!regUp.dirty) {\n      regLo = regUp;\n      regUp = regUp.regionAbove();\n      if (regUp === null || !regUp.dirty) {\n        // We've walked all the dirty regions\n        return;\n      }\n    }\n\n    regUp.dirty = false;\n    var eUp = regUp.eUp;\n    var eLo = regLo.eUp;\n\n    if (eUp.dst() !== eLo.dst()) {\n      // Check that the edge ordering is obeyed at the dst vertices.\n      if (libtess.sweep.checkForLeftSplice_(tess, regUp)) {\n        // If the upper or lower edge was marked fixUpperEdge, then\n        // we no longer need it (since these edges are needed only for\n        // vertices which otherwise have no right-going edges).\n        if (regLo.fixUpperEdge) {\n          libtess.sweep.deleteRegion_(tess, regLo);\n          libtess.mesh.deleteEdge(eLo);\n          regLo = regUp.regionBelow();\n          eLo = regLo.eUp;\n\n        } else if (regUp.fixUpperEdge) {\n          libtess.sweep.deleteRegion_(tess, regUp);\n          libtess.mesh.deleteEdge(eUp);\n          regUp = regLo.regionAbove();\n          eUp = regUp.eUp;\n        }\n      }\n    }\n\n    if (eUp.org !== eLo.org) {\n      if (eUp.dst() !== eLo.dst() && !regUp.fixUpperEdge &&\n          !regLo.fixUpperEdge &&\n          (eUp.dst() === tess.event || eLo.dst() === tess.event)) {\n        /* When all else fails in checkForIntersect(), it uses tess.event\n         * as the intersection location. To make this possible, it requires\n         * that tess.event lie between the upper and lower edges, and also\n         * that neither of these is marked fixUpperEdge (since in the worst\n         * case it might splice one of these edges into tess.event, and\n         * violate the invariant that fixable edges are the only right-going\n         * edge from their associated vertex).\n         */\n        if (libtess.sweep.checkForIntersect_(tess, regUp)) {\n          // walkDirtyRegions() was called recursively; we're done\n          return;\n        }\n\n      } else {\n        // Even though we can't use checkForIntersect(), the org vertices\n        // may violate the dictionary edge ordering. Check and correct this.\n        libtess.sweep.checkForRightSplice_(tess, regUp);\n      }\n    }\n\n    if (eUp.org === eLo.org && eUp.dst() === eLo.dst()) {\n      // A degenerate loop consisting of only two edges -- delete it.\n      libtess.sweep.addWinding_(eLo, eUp);\n      libtess.sweep.deleteRegion_(tess, regUp);\n      libtess.mesh.deleteEdge(eUp);\n      regUp = regLo.regionAbove();\n    }\n  }\n};\n\n\n/**\n * Purpose: connect a \"right\" vertex vEvent (one where all edges go left)\n * to the unprocessed portion of the mesh. Since there are no right-going\n * edges, two regions (one above vEvent and one below) are being merged\n * into one. regUp is the upper of these two regions.\n *\n * There are two reasons for doing this (adding a right-going edge):\n *  - if the two regions being merged are \"inside\", we must add an edge\n *    to keep them separated (the combined region would not be monotone).\n *  - in any case, we must leave some record of vEvent in the dictionary,\n *    so that we can merge vEvent with features that we have not seen yet.\n *    For example, maybe there is a vertical edge which passes just to\n *    the right of vEvent; we would like to splice vEvent into this edge.\n *\n * However, we don't want to connect vEvent to just any vertex. We don't\n * want the new edge to cross any other edges; otherwise we will create\n * intersection vertices even when the input data had no self-intersections.\n * (This is a bad thing; if the user's input data has no intersections,\n * we don't want to generate any false intersections ourselves.)\n *\n * Our eventual goal is to connect vEvent to the leftmost unprocessed\n * vertex of the combined region (the union of regUp and regLo).\n * But because of unseen vertices with all right-going edges, and also\n * new vertices which may be created by edge intersections, we don't\n * know where that leftmost unprocessed vertex is. In the meantime, we\n * connect vEvent to the closest vertex of either chain, and mark the region\n * as \"fixUpperEdge\". This flag says to delete and reconnect this edge\n * to the next processed vertex on the boundary of the combined region.\n * Quite possibly the vertex we connected to will turn out to be the\n * closest one, in which case we won't need to make any changes.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @param {libtess.GluHalfEdge} eBottomLeft [description].\n */\nlibtess.sweep.connectRightVertex_ = function(tess, regUp, eBottomLeft) {\n  var eTopLeft = eBottomLeft.oNext;\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n  var degenerate = false;\n\n  if (eUp.dst() !== eLo.dst()) {\n    libtess.sweep.checkForIntersect_(tess, regUp);\n  }\n\n  // Possible new degeneracies: upper or lower edge of regUp may pass\n  // through vEvent, or may coincide with new intersection vertex\n  if (libtess.geom.vertEq(eUp.org, tess.event)) {\n    libtess.mesh.meshSplice(eTopLeft.oPrev(), eUp);\n    regUp = libtess.sweep.topLeftRegion_(regUp);\n    eTopLeft = regUp.regionBelow().eUp;\n    libtess.sweep.finishLeftRegions_(tess, regUp.regionBelow(), regLo);\n    degenerate = true;\n  }\n  if (libtess.geom.vertEq(eLo.org, tess.event)) {\n    libtess.mesh.meshSplice(eBottomLeft, eLo.oPrev());\n    eBottomLeft = libtess.sweep.finishLeftRegions_(tess, regLo, null);\n    degenerate = true;\n  }\n  if (degenerate) {\n    libtess.sweep.addRightEdges_(tess, regUp, eBottomLeft.oNext, eTopLeft,\n        eTopLeft, true);\n    return;\n  }\n\n  // Non-degenerate situation -- need to add a temporary, fixable edge.\n  // Connect to the closer of eLo.org, eUp.org.\n  var eNew;\n  if (libtess.geom.vertLeq(eLo.org, eUp.org)) {\n    eNew = eLo.oPrev();\n  } else {\n    eNew = eUp;\n  }\n  eNew = libtess.mesh.connect(eBottomLeft.lPrev(), eNew);\n\n  // Prevent cleanup, otherwise eNew might disappear before we've even\n  // had a chance to mark it as a temporary edge.\n  libtess.sweep.addRightEdges_(tess, regUp, eNew, eNew.oNext, eNew.oNext,\n      false);\n  eNew.sym.activeRegion.fixUpperEdge = true;\n  libtess.sweep.walkDirtyRegions_(tess, regUp);\n};\n\n\n/**\n * The event vertex lies exacty on an already-processed edge or vertex.\n * Adding the new vertex involves splicing it into the already-processed\n * part of the mesh.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @param {libtess.GluVertex} vEvent [description].\n */\nlibtess.sweep.connectLeftDegenerate_ = function(tess, regUp, vEvent) {\n  var e = regUp.eUp;\n  /* istanbul ignore if */\n  if (libtess.geom.vertEq(e.org, vEvent)) {\n    // NOTE(bckenny): this code is unreachable but remains for a hypothetical\n    // future extension of libtess. See docs on libtess.sweep.TOLERANCE_NONZERO_\n    // for more information. Conditional on TOLERANCE_NONZERO_ to help Closure\n    // Compiler eliminate dead code.\n    // e.org is an unprocessed vertex - just combine them, and wait\n    // for e.org to be pulled from the queue\n    if (libtess.sweep.TOLERANCE_NONZERO_) {\n      libtess.sweep.spliceMergeVertices_(tess, e, vEvent.anEdge);\n    }\n    return;\n  }\n\n  if (!libtess.geom.vertEq(e.dst(), vEvent)) {\n    // General case -- splice vEvent into edge e which passes through it\n    libtess.mesh.splitEdge(e.sym);\n\n    if (regUp.fixUpperEdge) {\n      // This edge was fixable -- delete unused portion of original edge\n      libtess.mesh.deleteEdge(e.oNext);\n      regUp.fixUpperEdge = false;\n    }\n\n    libtess.mesh.meshSplice(vEvent.anEdge, e);\n\n    // recurse\n    libtess.sweep.sweepEvent_(tess, vEvent);\n    return;\n  }\n\n  // NOTE(bckenny): this code is unreachable but remains for a hypothetical\n  // future extension of libtess. See docs on libtess.sweep.TOLERANCE_NONZERO_\n  // for more information. Conditional on TOLERANCE_NONZERO_ to help Closure\n  // Compiler eliminate dead code.\n  // vEvent coincides with e.dst(), which has already been processed.\n  // Splice in the additional right-going edges.\n  /* istanbul ignore next */\n\n  /* istanbul ignore next */\n  if (libtess.sweep.TOLERANCE_NONZERO_) {\n    regUp = libtess.sweep.topRightRegion_(regUp);\n    var reg = regUp.regionBelow();\n    var eTopRight = reg.eUp.sym;\n    var eTopLeft = eTopRight.oNext;\n    var eLast = eTopLeft;\n\n    if (reg.fixUpperEdge) {\n      // Here e.dst() has only a single fixable edge going right.\n      // We can delete it since now we have some real right-going edges.\n\n      // there are some left edges too\n      libtess.sweep.deleteRegion_(tess, reg); // TODO(bckenny): something to null?\n      libtess.mesh.deleteEdge(eTopRight);\n      eTopRight = eTopLeft.oPrev();\n    }\n\n    libtess.mesh.meshSplice(vEvent.anEdge, eTopRight);\n    if (!libtess.geom.edgeGoesLeft(eTopLeft)) {\n      // e.dst() had no left-going edges -- indicate this to addRightEdges()\n      eTopLeft = null;\n    }\n\n    libtess.sweep.addRightEdges_(tess, regUp, eTopRight.oNext, eLast, eTopLeft,\n        true);\n  }\n};\n\n\n/**\n * Connect a \"left\" vertex (one where both edges go right)\n * to the processed portion of the mesh. Let R be the active region\n * containing vEvent, and let U and L be the upper and lower edge\n * chains of R. There are two possibilities:\n *\n * - the normal case: split R into two regions, by connecting vEvent to\n *   the rightmost vertex of U or L lying to the left of the sweep line\n *\n * - the degenerate case: if vEvent is close enough to U or L, we\n *   merge vEvent into that edge chain. The subcases are:\n *  - merging with the rightmost vertex of U or L\n *  - merging with the active edge of U or L\n *  - merging with an already-processed portion of U or L\n *\n * @private\n * @param {libtess.GluTesselator} tess   [description].\n * @param {libtess.GluVertex} vEvent [description].\n */\nlibtess.sweep.connectLeftVertex_ = function(tess, vEvent) {\n  // TODO(bckenny): tmp only used for sweep. better to keep tmp across calls?\n  var tmp = new libtess.ActiveRegion();\n\n  // NOTE(bckenny): this was commented out in the original\n  // libtess.assert(vEvent.anEdge.oNext.oNext === vEvent.anEdge);\n\n  // Get a pointer to the active region containing vEvent\n  tmp.eUp = vEvent.anEdge.sym;\n  var regUp = tess.dict.search(tmp).getKey();\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n\n  // try merging with U or L first\n  if (libtess.geom.edgeSign(eUp.dst(), vEvent, eUp.org) === 0) {\n    libtess.sweep.connectLeftDegenerate_(tess, regUp, vEvent);\n    return;\n  }\n\n  // Connect vEvent to rightmost processed vertex of either chain.\n  // e.dst() is the vertex that we will connect to vEvent.\n  var reg = libtess.geom.vertLeq(eLo.dst(), eUp.dst()) ? regUp : regLo;\n  var eNew;\n  if (regUp.inside || reg.fixUpperEdge) {\n    if (reg === regUp) {\n      eNew = libtess.mesh.connect(vEvent.anEdge.sym, eUp.lNext);\n\n    } else {\n      var tempHalfEdge = libtess.mesh.connect(eLo.dNext(), vEvent.anEdge);\n      eNew = tempHalfEdge.sym;\n    }\n\n    if (reg.fixUpperEdge) {\n      libtess.sweep.fixUpperEdge_(reg, eNew);\n\n    } else {\n      libtess.sweep.computeWinding_(tess,\n          libtess.sweep.addRegionBelow_(tess, regUp, eNew));\n    }\n    libtess.sweep.sweepEvent_(tess, vEvent);\n\n  } else {\n    // The new vertex is in a region which does not belong to the polygon.\n    // We don''t need to connect this vertex to the rest of the mesh.\n    libtess.sweep.addRightEdges_(tess, regUp, vEvent.anEdge, vEvent.anEdge,\n        null, true);\n  }\n};\n\n\n/**\n * Does everything necessary when the sweep line crosses a vertex.\n * Updates the mesh and the edge dictionary.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.GluVertex} vEvent [description].\n */\nlibtess.sweep.sweepEvent_ = function(tess, vEvent) {\n  tess.event = vEvent; // for access in edgeLeq_ // TODO(bckenny): wuh?\n\n  /* Check if this vertex is the right endpoint of an edge that is\n   * already in the dictionary.  In this case we don't need to waste\n   * time searching for the location to insert new edges.\n   */\n  var e = vEvent.anEdge;\n  while (e.activeRegion === null) {\n    e = e.oNext;\n    if (e === vEvent.anEdge) {\n      // All edges go right -- not incident to any processed edges\n      libtess.sweep.connectLeftVertex_(tess, vEvent);\n      return;\n    }\n  }\n\n  /* Processing consists of two phases: first we \"finish\" all the\n   * active regions where both the upper and lower edges terminate\n   * at vEvent (ie. vEvent is closing off these regions).\n   * We mark these faces \"inside\" or \"outside\" the polygon according\n   * to their winding number, and delete the edges from the dictionary.\n   * This takes care of all the left-going edges from vEvent.\n   */\n  var regUp = libtess.sweep.topLeftRegion_(e.activeRegion);\n  var reg = regUp.regionBelow();\n  var eTopLeft = reg.eUp;\n  var eBottomLeft = libtess.sweep.finishLeftRegions_(tess, reg, null);\n\n  /* Next we process all the right-going edges from vEvent. This\n   * involves adding the edges to the dictionary, and creating the\n   * associated \"active regions\" which record information about the\n   * regions between adjacent dictionary edges.\n   */\n  if (eBottomLeft.oNext === eTopLeft) {\n    // No right-going edges -- add a temporary \"fixable\" edge\n    libtess.sweep.connectRightVertex_(tess, regUp, eBottomLeft);\n\n  } else {\n    libtess.sweep.addRightEdges_(tess, regUp, eBottomLeft.oNext, eTopLeft,\n        eTopLeft, true);\n  }\n};\n\n\n/**\n * We add two sentinel edges above and below all other edges,\n * to avoid special cases at the top and bottom.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {number} t [description].\n */\nlibtess.sweep.addSentinel_ = function(tess, t) {\n  var reg = new libtess.ActiveRegion();\n\n  var e = libtess.mesh.makeEdge(tess.mesh);\n\n  e.org.s = libtess.sweep.SENTINEL_COORD_;\n  e.org.t = t;\n  e.dst().s = -libtess.sweep.SENTINEL_COORD_;\n  e.dst().t = t;\n  tess.event = e.dst(); //initialize it\n\n  reg.eUp = e;\n  reg.windingNumber = 0;\n  reg.inside = false;\n  reg.fixUpperEdge = false;\n  reg.sentinel = true;\n  reg.dirty = false;\n  reg.nodeUp = tess.dict.insert(reg);\n};\n\n\n/**\n * We maintain an ordering of edge intersections with the sweep line.\n * This order is maintained in a dynamic dictionary.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.initEdgeDict_ = function(tess) {\n  tess.dict = new libtess.Dict(tess, libtess.sweep.edgeLeq_);\n\n  libtess.sweep.addSentinel_(tess, -libtess.sweep.SENTINEL_COORD_);\n  libtess.sweep.addSentinel_(tess, libtess.sweep.SENTINEL_COORD_);\n};\n\n\n/**\n * [doneEdgeDict_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.doneEdgeDict_ = function(tess) {\n  // NOTE(bckenny): fixedEdges is only used in the assert below, so ignore so\n  // when asserts are removed jshint won't error.\n  /* jshint unused:false */\n  var fixedEdges = 0;\n\n  var reg;\n  while ((reg = tess.dict.getMin().getKey()) !== null) {\n    // At the end of all processing, the dictionary should contain\n    // only the two sentinel edges, plus at most one \"fixable\" edge\n    // created by connectRightVertex().\n    if (!reg.sentinel) {\n    }\n    libtess.sweep.deleteRegion_(tess, reg);\n  }\n\n  // NOTE(bckenny): see tess.dict.deleteDict_() for old delete dict function\n  tess.dict = null;\n};\n\n\n/**\n * Remove zero-length edges, and contours with fewer than 3 vertices.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.removeDegenerateEdges_ = function(tess) {\n  var eHead = tess.mesh.eHead;\n\n  var eNext;\n  for (var e = eHead.next; e !== eHead; e = eNext) {\n    eNext = e.next;\n    var eLNext = e.lNext;\n\n    if (libtess.geom.vertEq(e.org, e.dst()) && e.lNext.lNext !== e) {\n      // Zero-length edge, contour has at least 3 edges\n      libtess.sweep.spliceMergeVertices_(tess, eLNext, e); // deletes e.org\n      libtess.mesh.deleteEdge(e); // e is a self-loop TODO(bckenny): does this comment really apply here?\n      e = eLNext;\n      eLNext = e.lNext;\n    }\n\n    if (eLNext.lNext === e) {\n      // Degenerate contour (one or two edges)\n      if (eLNext !== e) {\n        if (eLNext === eNext || eLNext === eNext.sym) {\n          eNext = eNext.next;\n        }\n        libtess.mesh.deleteEdge(eLNext);\n      }\n\n      if (e === eNext || e === eNext.sym) {\n        eNext = eNext.next;\n      }\n      libtess.mesh.deleteEdge(e);\n    }\n  }\n};\n\n\n/**\n * Construct priority queue and insert all vertices into it, which determines\n * the order in which vertices cross the sweep line.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.initPriorityQ_ = function(tess) {\n  // TODO(bckenny): libtess.geom.vertLeq needs cast?\n  var pq = new libtess.PriorityQ(\n      /** @type {function(Object, Object): boolean} */(libtess.geom.vertLeq));\n  tess.pq = pq;\n\n  var vHead = tess.mesh.vHead;\n  var v;\n  for (v = vHead.next; v !== vHead; v = v.next) {\n    v.pqHandle = pq.insert(v);\n  }\n\n  pq.init();\n};\n\n\n/**\n * [donePriorityQ_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.donePriorityQ_ = function(tess) {\n  // TODO(bckenny): probably don't need deleteQ. check that function for comment\n  tess.pq.deleteQ();\n  tess.pq = null;\n};\n\n\n/**\n * Delete any degenerate faces with only two edges. walkDirtyRegions()\n * will catch almost all of these, but it won't catch degenerate faces\n * produced by splice operations on already-processed edges.\n * The two places this can happen are in finishLeftRegions(), when\n * we splice in a \"temporary\" edge produced by connectRightVertex(),\n * and in checkForLeftSplice(), where we splice already-processed\n * edges to ensure that our dictionary invariants are not violated\n * by numerical errors.\n *\n * In both these cases it is *very* dangerous to delete the offending\n * edge at the time, since one of the routines further up the stack\n * will sometimes be keeping a pointer to that edge.\n *\n * @private\n * @param {libtess.GluMesh} mesh [description].\n */\nlibtess.sweep.removeDegenerateFaces_ = function(mesh) {\n  var fNext;\n  for (var f = mesh.fHead.next; f !== mesh.fHead; f = fNext) {\n    fNext = f.next;\n    var e = f.anEdge;\n\n    if (e.lNext.lNext === e) {\n      // A face with only two edges\n      libtess.sweep.addWinding_(e.oNext, e);\n      libtess.mesh.deleteEdge(e);\n    }\n  }\n};\n\n\n/* global libtess */\n\n/** @const */\nlibtess.tessmono = {};\n\n/**\n * Tessellates a monotone region (what else would it do??). The region must\n * consist of a single loop of half-edges (see mesh.js) oriented CCW. \"Monotone\"\n * in this case means that any vertical line intersects the interior of the\n * region in a single interval.\n *\n * Tessellation consists of adding interior edges (actually pairs of\n * half-edges), to split the region into non-overlapping triangles.\n * @private\n * @param {!libtess.GluFace} face\n */\nlibtess.tessmono.tessellateMonoRegion_ = function(face) {\n  /* The basic idea is explained in Preparata and Shamos (which I don't\n   * have handy right now), although their implementation is more\n   * complicated than this one. The are two edge chains, an upper chain\n   * and a lower chain. We process all vertices from both chains in order,\n   * from right to left.\n   *\n   * The algorithm ensures that the following invariant holds after each\n   * vertex is processed: the untessellated region consists of two\n   * chains, where one chain (say the upper) is a single edge, and\n   * the other chain is concave. The left vertex of the single edge\n   * is always to the left of all vertices in the concave chain.\n   *\n   * Each step consists of adding the rightmost unprocessed vertex to one\n   * of the two chains, and forming a fan of triangles from the rightmost\n   * of two chain endpoints. Determining whether we can add each triangle\n   * to the fan is a simple orientation test. By making the fan as large\n   * as possible, we restore the invariant (check it yourself).\n   *\n   * All edges are oriented CCW around the boundary of the region.\n   * First, find the half-edge whose origin vertex is rightmost.\n   * Since the sweep goes from left to right, face.anEdge should\n   * be close to the edge we want.\n   */\n  var up = face.anEdge;\n\n  for (; libtess.geom.vertLeq(up.dst(), up.org); up = up.lPrev()) { }\n  for (; libtess.geom.vertLeq(up.org, up.dst()); up = up.lNext) { }\n\n  var lo = up.lPrev();\n\n  var tempHalfEdge;\n  while (up.lNext !== lo) {\n    if (libtess.geom.vertLeq(up.dst(), lo.org)) {\n      // up.dst() is on the left. It is safe to form triangles from lo.org.\n      // The edgeGoesLeft test guarantees progress even when some triangles\n      // are CW, given that the upper and lower chains are truly monotone.\n      while (lo.lNext !== up && (libtess.geom.edgeGoesLeft(lo.lNext) ||\n          libtess.geom.edgeSign(lo.org, lo.dst(), lo.lNext.dst()) <= 0)) {\n\n        tempHalfEdge = libtess.mesh.connect(lo.lNext, lo);\n        lo = tempHalfEdge.sym;\n      }\n      lo = lo.lPrev();\n\n    } else {\n      // lo.org is on the left. We can make CCW triangles from up.dst().\n      while (lo.lNext !== up && (libtess.geom.edgeGoesRight(up.lPrev()) ||\n          libtess.geom.edgeSign(up.dst(), up.org, up.lPrev().org) >= 0)) {\n\n        tempHalfEdge = libtess.mesh.connect(up, up.lPrev());\n        up = tempHalfEdge.sym;\n      }\n      up = up.lNext;\n    }\n  }\n\n  // Now lo.org == up.dst() == the leftmost vertex. The remaining region\n  // can be tessellated in a fan from this leftmost vertex.\n  while (lo.lNext.lNext !== up) {\n    tempHalfEdge = libtess.mesh.connect(lo.lNext, lo);\n    lo = tempHalfEdge.sym;\n  }\n};\n\n/**\n * Tessellates each region of the mesh which is marked \"inside\" the polygon.\n * Each such region must be monotone.\n * @param {!libtess.GluMesh} mesh\n */\nlibtess.tessmono.tessellateInterior = function(mesh) {\n  var next;\n  for (var f = mesh.fHead.next; f !== mesh.fHead; f = next) {\n    // Make sure we don't try to tessellate the new triangles.\n    next = f.next;\n    if (f.inside) {\n      libtess.tessmono.tessellateMonoRegion_(f);\n    }\n  }\n};\n\n/**\n * Zaps (i.e. sets to null) all faces which are not marked \"inside\" the polygon.\n * Since further mesh operations on null faces are not allowed, the main purpose\n * is to clean up the mesh so that exterior loops are not represented in the\n * data structure.\n * @param {!libtess.GluMesh} mesh\n */\nlibtess.tessmono.discardExterior = function(mesh) {\n  var next;\n  for (var f = mesh.fHead.next; f !== mesh.fHead; f = next) {\n    // Since f will be destroyed, save its next pointer.\n    next = f.next;\n    if (!f.inside) {\n      libtess.mesh.zapFace(f);\n    }\n  }\n};\n\n/**\n * Resets the winding numbers on all edges so that regions marked \"inside\" the\n * polygon have a winding number of \"value\", and regions outside have a winding\n * number of 0.\n *\n * If keepOnlyBoundary is true, it also deletes all edges which do not separate\n * an interior region from an exterior one.\n *\n * @param {!libtess.GluMesh} mesh\n * @param {number} value\n * @param {boolean} keepOnlyBoundary\n */\nlibtess.tessmono.setWindingNumber = function(mesh, value, keepOnlyBoundary) {\n  var eNext;\n  for (var e = mesh.eHead.next; e !== mesh.eHead; e = eNext) {\n    eNext = e.next;\n\n    if (e.rFace().inside !== e.lFace.inside) {\n      // This is a boundary edge (one side is interior, one is exterior).\n      e.winding = (e.lFace.inside) ? value : -value;\n\n    } else {\n      // Both regions are interior, or both are exterior.\n      if (!keepOnlyBoundary) {\n        e.winding = 0;\n\n      } else {\n        libtess.mesh.deleteEdge(e);\n      }\n    }\n  }\n};\n\n\n/* global libtess */\n\n/**\n * A list of edges crossing the sweep line, sorted from top to bottom.\n * Implementation is a doubly-linked list, sorted by the injected edgeLeq\n * comparator function. Here it is a simple ordering, but see libtess.sweep for\n * the list of invariants on the edge dictionary this ordering creates.\n * @constructor\n * @struct\n * @param {!libtess.GluTesselator} frame\n * @param {function(!libtess.GluTesselator, !libtess.ActiveRegion, !libtess.ActiveRegion): boolean} leq\n */\nlibtess.Dict = function(frame, leq) {\n\n  /**\n   * The head of the doubly-linked DictNode list. At creation time, links back\n   * and forward only to itself.\n   * @private\n   */\n  this.head_ = new libtess.DictNode();\n\n  /**\n   * The GluTesselator used as the frame for edge/event comparisons.\n   * @private\n   */\n  this.frame_ = frame;\n\n  /**\n   * Comparison function to maintain the invariants of the Dict. See\n   * libtess.sweep.edgeLeq_ for source.\n   * @private\n   * @type {function(!libtess.GluTesselator, !libtess.ActiveRegion, !libtess.ActiveRegion): boolean}\n   */\n  this.leq_ = leq;\n};\n\n/* istanbul ignore next */\n/**\n * Formerly used to delete the dict.\n * NOTE(bckenny): No longer called but left for memFree documentation. Nulled at\n * former callsite instead (sweep.doneEdgeDict_)\n * @private\n */\nlibtess.Dict.prototype.deleteDict_ = function() {\n  // for (var node = this.head_.next; node !== this.head_; node = node.next) {\n  //   memFree(node);\n  // }\n  // memFree(dict);\n};\n\n/**\n * Insert the supplied key into the edge list and return its new node.\n * @param {libtess.DictNode} node\n * @param {!libtess.ActiveRegion} key\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.insertBefore = function(node, key) {\n  do {\n    node = node.prev;\n  } while (node.key !== null && !this.leq_(this.frame_, node.key, key));\n\n  // insert the new node and update the surrounding nodes to point to it\n  var newNode = new libtess.DictNode(key, node.next, node);\n  node.next.prev = newNode;\n  node.next = newNode;\n\n  return newNode;\n};\n\n/**\n * Insert key into the dict and return the new node that contains it.\n * @param {!libtess.ActiveRegion} key\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.insert = function(key) {\n  // NOTE(bckenny): from a macro in dict.h/dict-list.h\n  return this.insertBefore(this.head_, key);\n};\n\n/**\n * Remove node from the list.\n * @param {libtess.DictNode} node\n */\nlibtess.Dict.prototype.deleteNode = function(node) {\n  node.next.prev = node.prev;\n  node.prev.next = node.next;\n\n  // NOTE(bckenny): nulled at callsite (sweep.deleteRegion_)\n  // memFree( node );\n};\n\n/**\n * Search returns the node with the smallest key greater than or equal\n * to the given key. If there is no such key, returns a node whose\n * key is null. Similarly, max(d).getSuccessor() has a null key, etc.\n * @param {!libtess.ActiveRegion} key\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.search = function(key) {\n  var node = this.head_;\n\n  do {\n    node = node.next;\n  } while (node.key !== null && !this.leq_(this.frame_, key, node.key));\n\n  return node;\n};\n\n/**\n * Return the node with the smallest key.\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.getMin = function() {\n  // NOTE(bckenny): from a macro in dict.h/dict-list.h\n  return this.head_.next;\n};\n\n// NOTE(bckenny): libtess.Dict.getMax isn't called within libtess and isn't part\n// of the public API. For now, leaving in but ignoring for coverage.\n/* istanbul ignore next */\n/**\n * Returns the node with the greatest key.\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.getMax = function() {\n  // NOTE(bckenny): from a macro in dict.h/dict-list.h\n  return this.head_.prev;\n};\n\n\n/* global libtess */\n\n/**\n * A doubly-linked-list node with a libtess.ActiveRegion payload.\n * The key for this node and the next and previous nodes in the parent Dict list\n * can be provided to insert it into an existing list (or all can be omitted if\n * this is to be the founding node of the list).\n * @param {!libtess.ActiveRegion=} opt_key\n * @param {!libtess.DictNode=} opt_nextNode\n * @param {!libtess.DictNode=} opt_prevNode\n * @constructor\n * @struct\n */\nlibtess.DictNode = function(opt_key, opt_nextNode, opt_prevNode) {\n  /**\n   * The ActiveRegion key for this node, or null if the head of the list.\n   * @type {libtess.ActiveRegion}\n   */\n  this.key = opt_key || null;\n\n  /**\n   * Link to next DictNode in parent list or to self if this is the first node.\n   * @type {!libtess.DictNode}\n   */\n  this.next = opt_nextNode || this;\n\n  /**\n   * Link to previous DictNode in parent list or to self if this is the first\n   * node.\n   * @type {!libtess.DictNode}\n   */\n  this.prev = opt_prevNode || this;\n};\n\n/**\n * Get the key from this node.\n * @return {libtess.ActiveRegion}\n */\nlibtess.DictNode.prototype.getKey = function() {\n  return this.key;\n};\n\n/**\n * Get the successor node to this one.\n * @return {!libtess.DictNode}\n */\nlibtess.DictNode.prototype.getSuccessor = function() {\n  return this.next;\n};\n\n/**\n * Get the predecessor node to this one.\n * @return {!libtess.DictNode}\n */\nlibtess.DictNode.prototype.getPredecessor = function() {\n  return this.prev;\n};\n\n\n\n/* global libtess */\n\n/**\n * Cached vertex data for single-countour polygons for quick-and-dirty\n * decomposition.\n * @constructor\n * @struct\n */\nlibtess.CachedVertex = function() {\n  /**\n   * [coords description]\n   * @type {Array.<number>}\n   */\n  this.coords = [0, 0, 0];\n  // TODO(bckenny): better way to init?\n\n  /**\n   * [data description]\n   * @type {Object}\n   */\n  this.data = null;\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): create more javascript-y API, e.g. make gluTessEndPolygon\n// async, don't require so many temp objects created\n\n/**\n * The tesselator main class, providing the public API.\n * @constructor\n * @struct\n */\nlibtess.GluTesselator = function() {\n  // Only initialize fields which can be changed by the api. Other fields\n  // are initialized where they are used.\n\n  // TODO(bckenny): many of these can be made private\n  // TODO(bckenny): can we combine call* and call*Data functions?\n\n  /*** state needed for collecting the input data ***/\n\n  /**\n   * what begin/end calls have we seen?\n   * @type {libtess.GluTesselator.tessState_}\n   */\n  this.state = libtess.GluTesselator.tessState_.T_DORMANT;\n\n  /**\n   * lastEdge_.org is the most recent vertex\n   * @private\n   * @type {libtess.GluHalfEdge}\n   */\n  this.lastEdge_ = null;\n\n  /**\n   * stores the input contours, and eventually the tessellation itself\n   * @type {libtess.GluMesh}\n   */\n  this.mesh = null;\n  // NOTE(bckenny): initialized in this.emptyCache_\n\n  /**\n   * Error callback.\n   * @private\n   * @type {?function((libtess.errorType|libtess.gluEnum))}\n   */\n  this.callError_ = null;\n\n\n  /*** state needed for projecting onto the sweep plane ***/\n\n  /**\n   * user-specified normal (if provided)\n   * @type {!Array.<number>}\n   */\n  this.normal = [0, 0, 0];\n  // TODO(bckenny): better way to init these arrays?\n\n  /**\n   * unit vector in s-direction (debugging)\n   * @type {!Array.<number>}\n   */\n  this.sUnit = [0, 0, 0];\n\n  /**\n   * unit vector in t-direction (debugging)\n   * @type {!Array.<number>}\n   */\n  this.tUnit = [0, 0, 0];\n\n  /*** state needed for the line sweep ***/\n  // TODO(bckenny): this could be moved to a sweep state object of some sort\n\n  /**\n   * tolerance for merging features\n   * @type {number}\n   */\n  this.relTolerance = libtess.GLU_TESS_DEFAULT_TOLERANCE;\n\n  /**\n   * rule for determining polygon interior\n   * @type {libtess.windingRule}\n   */\n  this.windingRule = libtess.windingRule.GLU_TESS_WINDING_ODD;\n\n  /**\n   * fatal error: needed combine callback\n   * @type {boolean}\n   */\n  this.fatalError = false;\n\n  /**\n   * edge dictionary for sweep line\n   * @type {libtess.Dict}\n   */\n  this.dict = null;\n  // NOTE(bckenny): dict initialized in sweep.initEdgeDict_, removed in sweep.doneEdgeDict_\n\n  /**\n   * priority queue of vertex events\n   * @type {libtess.PriorityQ}\n   */\n  this.pq = null;\n  // NOTE(bckenny): pq initialized in sweep.initPriorityQ\n\n  /**\n   * current sweep event being processed\n   * @type {libtess.GluVertex}\n   */\n  this.event = null;\n\n  /**\n   * Combine callback.\n   * @private\n   * @type {?function(Array.<number>, Array.<Object>, Array.<number>): Object}\n   */\n  this.callCombine_ = null;\n\n  /*** state needed for rendering callbacks (see render.js) ***/\n\n  /**\n   * Extract contours, not triangles\n   * @type {boolean}\n   */\n  this.boundaryOnly = false;\n\n  /**\n   * Begin callback.\n   * @private\n   * @type {?function(libtess.primitiveType)}\n   */\n  this.callBegin_ = null;\n\n  /**\n   * Edge flag callback.\n   * @private\n   * @type {?function(boolean)}\n   */\n  this.callEdgeFlag_ = null;\n\n  /**\n   * Vertex callback.\n   * @private\n   * @type {?function(Object)}\n   */\n  this.callVertex_ = null;\n\n  /**\n   * End callback.\n   * @private\n   * @type {?function()}\n   */\n  this.callEnd_ = null;\n\n  /**\n   * Mesh callback.\n   * @private\n   * @type {?function(libtess.GluMesh)}\n   */\n  this.callMesh_ = null;\n\n  /*** rendering callbacks that also pass polygon data  ***/\n  /**\n   * BeginData callback.\n   * @private\n   * @type {?function(libtess.primitiveType, Object)}\n   */\n  this.callBeginData_ = null;\n\n  /**\n   * EdgeFlagData callback.\n   * @private\n   * @type {?function(boolean, Object)}\n   */\n  this.callEdgeFlagData_ = null;\n\n  /**\n   * VertexData callback.\n   * @private\n   * @type {?function(Object, Object)}\n   */\n  this.callVertexData_ = null;\n\n  /**\n   * EndData callback.\n   * @private\n   * @type {?function(Object)}\n   */\n  this.callEndData_ = null;\n\n  /**\n   * ErrorData callback.\n   * @private\n   * @type {?function((libtess.errorType|libtess.gluEnum), Object)}\n   */\n  this.callErrorData_ = null;\n\n  /**\n   * CombineData callback.\n   * @private\n   * @type {?function(Array.<number>, Array.<Object>, Array.<number>, Object): Object}\n   */\n  this.callCombineData_ = null;\n\n  /**\n   * client data for current polygon\n   * @private\n   * @type {Object}\n   */\n  this.polygonData_ = null;\n\n  /*** state needed to cache single-contour polygons for renderCache() ***/\n  /**\n   * empty cache on next vertex() call\n   * @type {boolean}\n   */\n  this.emptyCache = false;\n  // TODO(bckenny): possibly rename to be clear it's a boolean\n\n  /**\n   * number of cached vertices\n   * @type {number}\n   */\n  this.cacheCount = 0;\n\n  /**\n   * the vertex data\n   * @type {Array.<libtess.CachedVertex>}\n   */\n  this.cache = new Array(libtess.TESS_MAX_CACHE);\n\n  // TODO(bckenny): fill now? or init on demand\n  for (var i = 0; i < libtess.TESS_MAX_CACHE; i++) {\n    this.cache[i] = new libtess.CachedVertex();\n  }\n};\n\n/**\n * The begin/end calls must be properly nested. We keep track of the current\n * state to enforce the ordering.\n * @enum {number}\n * @private\n */\nlibtess.GluTesselator.tessState_ = {\n  T_DORMANT: 0,\n  T_IN_POLYGON: 1,\n  T_IN_CONTOUR: 2\n};\n\n/**\n * Destory the tesselator object. See README.\n */\nlibtess.GluTesselator.prototype.gluDeleteTess = function() {\n  // TODO(bckenny): This does nothing but assert that it isn't called while\n  // building the polygon since we rely on GC to handle memory. *If* the public\n  // API changes, this should go.\n  this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT);\n  // memFree(tess); TODO(bckenny)\n};\n\n\n/**\n * Set properties for control over tesselation. See README.\n * @param {libtess.gluEnum} which [description].\n * @param {number|boolean} value [description].\n */\nlibtess.GluTesselator.prototype.gluTessProperty = function(which, value) {\n  // TODO(bckenny): split into more setters?\n  // TODO(bckenny): in any case, we can do better than this switch statement\n\n  switch (which) {\n    case libtess.gluEnum.GLU_TESS_TOLERANCE:\n      if (value < 0 || value > 1) {\n        break;\n      }\n      // TODO(bckenny): libtess doesn't support any tolerance but 0. This should\n      // reject any non-zero tolerance accordingly.\n      this.relTolerance = /** @type {number} */(value);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_WINDING_RULE:\n      var windingRule = /** @type {libtess.windingRule} */(value);\n\n      switch (windingRule) {\n        case libtess.windingRule.GLU_TESS_WINDING_ODD:\n        case libtess.windingRule.GLU_TESS_WINDING_NONZERO:\n        case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:\n        case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:\n        case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:\n          this.windingRule = windingRule;\n          return;\n        default:\n      }\n      break;\n\n    case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:\n      // TODO(bckenny): added boolean param type. make sure ok.\n      this.boundaryOnly = !!value;\n      return;\n\n    default:\n      this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM);\n      return;\n  }\n  this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_VALUE);\n};\n\n\n/**\n * Returns tessellator property\n * @param {libtess.gluEnum} which [description].\n * @return {number|boolean} [description].\n */\nlibtess.GluTesselator.prototype.gluGetTessProperty = function(which) {\n  // TODO(bckenny): as above, split into more getters? and improve on switch statement\n  // why are these being asserted in getter but not setter?\n\n  switch (which) {\n    case libtess.gluEnum.GLU_TESS_TOLERANCE:\n      // tolerance should be in range [0..1]\n      return this.relTolerance;\n\n    case libtess.gluEnum.GLU_TESS_WINDING_RULE:\n      var rule = this.windingRule;\n      return rule;\n\n    case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:\n      return this.boundaryOnly;\n\n    default:\n      this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM);\n      break;\n  }\n  return false;\n};\n\n\n/**\n * Lets the user supply the polygon normal, if known.  All input data\n * is projected into a plane perpendicular to the normal before\n * tesselation. All output triangles are oriented CCW with\n * respect to the normal (CW orientation can be obtained by\n * reversing the sign of the supplied normal). For example, if\n * you know that all polygons lie in the x-y plane, call\n * \"tess.gluTessNormal(0.0, 0.0, 1.0)\" before rendering any polygons.\n *\n * @param {number} x [description].\n * @param {number} y [description].\n * @param {number} z [description].\n */\nlibtess.GluTesselator.prototype.gluTessNormal = function(x, y, z) {\n  this.normal[0] = x;\n  this.normal[1] = y;\n  this.normal[2] = z;\n};\n\n\n/**\n * Specify callbacks. See README. A null or undefined opt_fn removes current callback.\n *\n * @param {libtess.gluEnum} which [description].\n * @param {?Function=} opt_fn [description].\n */\nlibtess.GluTesselator.prototype.gluTessCallback = function(which, opt_fn) {\n  var fn = !opt_fn ? null : opt_fn;\n  // TODO(bckenny): better opt_fn typing?\n\n  switch (which) {\n    case libtess.gluEnum.GLU_TESS_BEGIN:\n      this.callBegin_ = /** @type {function(libtess.primitiveType)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_BEGIN_DATA:\n      this.callBeginData_ =\n          /** @type {function(libtess.primitiveType, Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_EDGE_FLAG:\n      this.callEdgeFlag_ = /** @type {function(boolean)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_EDGE_FLAG_DATA:\n      this.callEdgeFlagData_ = /** @type {function(boolean, Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_VERTEX:\n      this.callVertex_ = /** @type {function(Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_VERTEX_DATA:\n      this.callVertexData_ = /** @type {function(Object, Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_END:\n      this.callEnd_ = /** @type {function()} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_END_DATA:\n      this.callEndData_ = /** @type {function(Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_ERROR:\n      this.callError_ = /** @type {function((libtess.errorType|libtess.gluEnum))} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_ERROR_DATA:\n      this.callErrorData_ =\n          /** @type {function((libtess.errorType|libtess.gluEnum), Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_COMBINE:\n      this.callCombine_ = /** @type {function(Array.<number>, Array.<Object>, Array.<number>): Object} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_COMBINE_DATA:\n      this.callCombineData_ = /** @type {function(Array.<number>, Array.<Object>, Array.<number>, Object): Object} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_MESH:\n      this.callMesh_ = /** @type {function(libtess.GluMesh)} */ (fn);\n      return;\n\n    default:\n      this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM);\n      return;\n  }\n};\n\n\n/**\n * Specify a vertex and associated data. Must be within calls to\n * beginContour/endContour. See README.\n *\n * @param {Array.<number>} coords [description].\n * @param {Object} data [description].\n */\nlibtess.GluTesselator.prototype.gluTessVertex = function(coords, data) {\n  var tooLarge = false;\n\n  // TODO(bckenny): pool allocation?\n  var clamped = [0, 0, 0];\n\n  this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);\n\n  if (this.emptyCache) {\n    this.emptyCache_();\n    this.lastEdge_ = null;\n  }\n\n  for (var i = 0; i < 3; ++i) {\n    var x = coords[i];\n    if (x < -libtess.GLU_TESS_MAX_COORD) {\n      x = -libtess.GLU_TESS_MAX_COORD;\n      tooLarge = true;\n    }\n    if (x > libtess.GLU_TESS_MAX_COORD) {\n      x = libtess.GLU_TESS_MAX_COORD;\n      tooLarge = true;\n    }\n    clamped[i] = x;\n  }\n\n  if (tooLarge) {\n    this.callErrorOrErrorData(libtess.errorType.GLU_TESS_COORD_TOO_LARGE);\n  }\n\n  if (this.mesh === null) {\n    if (this.cacheCount < libtess.TESS_MAX_CACHE) {\n      this.cacheVertex_(clamped, data);\n      return;\n    }\n\n    // cache is full, create mesh and add cached verts to it\n    this.emptyCache_();\n  }\n\n  this.addVertex_(clamped, data);\n};\n\n\n/**\n * [gluTessBeginPolygon description]\n * @param {Object} data Client data for current polygon.\n */\nlibtess.GluTesselator.prototype.gluTessBeginPolygon = function(data) {\n  this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT);\n\n  this.state = libtess.GluTesselator.tessState_.T_IN_POLYGON;\n  this.cacheCount = 0;\n  this.emptyCache = false;\n  this.mesh = null;\n\n  this.polygonData_ = data;\n};\n\n\n/**\n * [gluTessBeginContour description]\n */\nlibtess.GluTesselator.prototype.gluTessBeginContour = function() {\n  this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON);\n\n  this.state = libtess.GluTesselator.tessState_.T_IN_CONTOUR;\n  this.lastEdge_ = null;\n  if (this.cacheCount > 0) {\n    // Just set a flag so we don't get confused by empty contours\n    // -- these can be generated accidentally with the obsolete\n    // NextContour() interface.\n    // TODO(bckenny): we aren't implementing NextContour() interface.\n    this.emptyCache = true;\n  }\n};\n\n\n/**\n * [gluTessEndContour description]\n */\nlibtess.GluTesselator.prototype.gluTessEndContour = function() {\n  this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);\n  this.state = libtess.GluTesselator.tessState_.T_IN_POLYGON;\n};\n\n\n/**\n * [gluTessEndPolygon description]\n */\nlibtess.GluTesselator.prototype.gluTessEndPolygon = function() {\n  this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON);\n  this.state = libtess.GluTesselator.tessState_.T_DORMANT;\n\n  if (this.mesh === null) {\n    // TODO(bckenny): can we eliminate more cache functionality?\n    this.emptyCache_();\n  }\n\n  // Determine the polygon normal and project vertices onto the plane\n  // of the polygon.\n  libtess.normal.projectPolygon(this);\n\n  // computeInterior(tess) computes the planar arrangement specified\n  // by the given contours, and further subdivides this arrangement\n  // into regions. Each region is marked \"inside\" if it belongs\n  // to the polygon, according to the rule given by this.windingRule.\n  // Each interior region is guaranteed be monotone.\n  libtess.sweep.computeInterior(this);\n\n  if (!this.fatalError) {\n    // If the user wants only the boundary contours, we throw away all edges\n    // except those which separate the interior from the exterior.\n    // Otherwise we tessellate all the regions marked \"inside\".\n    // NOTE(bckenny): we know this.mesh has been initialized, so help closure out.\n    var mesh = /** @type {!libtess.GluMesh} */(this.mesh);\n    if (this.boundaryOnly) {\n      libtess.tessmono.setWindingNumber(mesh, 1, true);\n    } else {\n      libtess.tessmono.tessellateInterior(mesh);\n    }\n\n    this.mesh.checkMesh();\n\n    if (this.callBegin_ || this.callEnd_ || this.callVertex_ ||\n        this.callEdgeFlag_ || this.callBeginData_ || this.callEndData_ ||\n        this.callVertexData_ || this.callEdgeFlagData_) {\n\n      if (this.boundaryOnly) {\n        // output boundary contours\n        libtess.render.renderBoundary(this, this.mesh);\n\n      } else {\n        // output triangles (with edge callback if one is set)\n        var flagEdges = !!(this.callEdgeFlag_ || this.callEdgeFlagData_);\n        libtess.render.renderMesh(this, this.mesh, flagEdges);\n      }\n    }\n\n    if (this.callMesh_) {\n      // Throw away the exterior faces, so that all faces are interior.\n      // This way the user doesn't have to check the \"inside\" flag,\n      // and we don't need to even reveal its existence. It also leaves\n      // the freedom for an implementation to not generate the exterior\n      // faces in the first place.\n      libtess.tessmono.discardExterior(this.mesh);\n      // user wants the mesh itself\n      this.callMesh_(this.mesh);\n\n      this.mesh = null;\n      this.polygonData_ = null;\n      return;\n    }\n  }\n\n  libtess.mesh.deleteMesh(this.mesh);\n  this.polygonData_ = null;\n  this.mesh = null;\n};\n\n\n/**\n * Return the tessellator to its original dormant state.\n * @private\n */\nlibtess.GluTesselator.prototype.makeDormant_ = function() {\n  if (this.mesh) {\n    libtess.mesh.deleteMesh(this.mesh);\n  }\n  this.state = libtess.GluTesselator.tessState_.T_DORMANT;\n  this.lastEdge_ = null;\n  this.mesh = null;\n};\n\n\n/**\n * [requireState_ description]\n * @private\n * @param {libtess.GluTesselator.tessState_} state [description].\n */\nlibtess.GluTesselator.prototype.requireState_ = function(state) {\n  if (this.state !== state) {\n    this.gotoState_(state);\n  }\n};\n\n\n/**\n * [gotoState_ description]\n * @private\n * @param  {libtess.GluTesselator.tessState_} newState [description].\n */\nlibtess.GluTesselator.prototype.gotoState_ = function(newState) {\n  while (this.state !== newState) {\n    // We change the current state one level at a time, to get to the desired\n    // state.\n    if (this.state < newState) {\n      switch (this.state) {\n        case libtess.GluTesselator.tessState_.T_DORMANT:\n          this.callErrorOrErrorData(\n              libtess.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);\n          this.gluTessBeginPolygon(null);\n          break;\n\n        case libtess.GluTesselator.tessState_.T_IN_POLYGON:\n          this.callErrorOrErrorData(\n              libtess.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR);\n          this.gluTessBeginContour();\n          break;\n      }\n\n    } else {\n      switch (this.state) {\n        case libtess.GluTesselator.tessState_.T_IN_CONTOUR:\n          this.callErrorOrErrorData(\n              libtess.errorType.GLU_TESS_MISSING_END_CONTOUR);\n          this.gluTessEndContour();\n          break;\n\n        case libtess.GluTesselator.tessState_.T_IN_POLYGON:\n          this.callErrorOrErrorData(\n              libtess.errorType.GLU_TESS_MISSING_END_POLYGON);\n          // this.gluTessEndPolygon() is too much work!\n          this.makeDormant_();\n          break;\n      }\n    }\n  }\n};\n\n\n/**\n * [addVertex_ description]\n * @private\n * @param {Array.<number>} coords [description].\n * @param {Object} data [description].\n */\nlibtess.GluTesselator.prototype.addVertex_ = function(coords, data) {\n  var e = this.lastEdge_;\n  if (e === null) {\n    // Make a self-loop (one vertex, one edge).\n    e = libtess.mesh.makeEdge(this.mesh);\n    libtess.mesh.meshSplice(e, e.sym);\n\n  } else {\n    // Create a new vertex and edge which immediately follow e\n    // in the ordering around the left face.\n    libtess.mesh.splitEdge(e);\n    e = e.lNext;\n  }\n\n  // The new vertex is now e.org.\n  e.org.data = data;\n  e.org.coords[0] = coords[0];\n  e.org.coords[1] = coords[1];\n  e.org.coords[2] = coords[2];\n\n  // The winding of an edge says how the winding number changes as we\n  // cross from the edge''s right face to its left face.  We add the\n  // vertices in such an order that a CCW contour will add +1 to\n  // the winding number of the region inside the contour.\n  e.winding = 1;\n  e.sym.winding = -1;\n\n  this.lastEdge_ = e;\n};\n\n\n/**\n * [cacheVertex_ description]\n * @private\n * @param {Array.<number>} coords [description].\n * @param {Object} data [description].\n */\nlibtess.GluTesselator.prototype.cacheVertex_ = function(coords, data) {\n  var v = this.cache[this.cacheCount];\n\n  v.data = data;\n  v.coords[0] = coords[0];\n  v.coords[1] = coords[1];\n  v.coords[2] = coords[2];\n  ++this.cacheCount;\n};\n\n\n/**\n * [emptyCache_ description]\n * @private\n */\nlibtess.GluTesselator.prototype.emptyCache_ = function() {\n  // NOTE(bckenny): surprise!\n  this.mesh = new libtess.GluMesh();\n\n  for (var i = 0; i < this.cacheCount; i++) {\n    var v = this.cache[i];\n    this.addVertex_(v.coords, v.data);\n  }\n\n  this.cacheCount = 0;\n  this.emptyCache = false;\n};\n\n\n// TODO(bckenny): all following conditional callbacks could be simplified\n// TODO(bckenny): using null for now, but may rework\n// TODO(bckenny): should add documentation that references in callback are volatile (or make a copy)\n// see README callback descriptions\n/**\n * [callBeginOrBeginData description]\n * @param {libtess.primitiveType} type [description].\n */\nlibtess.GluTesselator.prototype.callBeginOrBeginData = function(type) {\n  if (this.callBeginData_) {\n    this.callBeginData_(type, this.polygonData_);\n\n  } else if (this.callBegin_) {\n    this.callBegin_(type);\n  }\n};\n\n\n/**\n * [callVertexOrVertexData description]\n * @param {Object} data [description].\n */\nlibtess.GluTesselator.prototype.callVertexOrVertexData = function(data) {\n  if (this.callVertexData_) {\n    this.callVertexData_(data, this.polygonData_);\n\n  } else if (this.callVertex_) {\n    this.callVertex_(data);\n  }\n};\n\n\n/**\n * [callEdgeFlagOrEdgeFlagData description]\n * @param {boolean} flag [description].\n */\nlibtess.GluTesselator.prototype.callEdgeFlagOrEdgeFlagData = function(flag) {\n  if (this.callEdgeFlagData_) {\n    this.callEdgeFlagData_(flag, this.polygonData_);\n\n  } else if (this.callEdgeFlag_) {\n    this.callEdgeFlag_(flag);\n  }\n};\n\n\n/**\n * [callEndOrEndData description]\n */\nlibtess.GluTesselator.prototype.callEndOrEndData = function() {\n  if (this.callEndData_) {\n    this.callEndData_(this.polygonData_);\n\n  } else if (this.callEnd_) {\n    this.callEnd_();\n  }\n};\n\n\n/**\n * [callCombineOrCombineData description]\n * @param {Array.<number>} coords [description].\n * @param {Array.<Object>} data [description].\n * @param {Array.<number>} weight [description].\n * @return {Object} Interpolated vertex.\n */\nlibtess.GluTesselator.prototype.callCombineOrCombineData =\n    function(coords, data, weight) {\n\n  var interpData;\n  if (this.callCombineData_) {\n    interpData = this.callCombineData_(coords, data, weight, this.polygonData_);\n\n  } else if (this.callCombine_) {\n    interpData = this.callCombine_(coords, data, weight);\n  }\n\n  // TODO(bckenny): can't be undefined\n  if (interpData === undefined) {\n    interpData = null;\n  }\n  return interpData;\n};\n\n\n// TODO(bckenny): combine the enums in libtess\n/**\n * [callErrorOrErrorData description]\n * @param {(libtess.errorType|libtess.gluEnum)} errno [description].\n */\nlibtess.GluTesselator.prototype.callErrorOrErrorData = function(errno) {\n  if (this.callErrorData_) {\n    this.callErrorData_(errno, this.polygonData_);\n\n  } else if (this.callError_) {\n    this.callError_(errno);\n  }\n};\n\n\n\n/* global libtess */\n\n/**\n * Each face has a pointer to the next and previous faces in the\n * circular list, and a pointer to a half-edge with this face as\n * the left face (null if this is the dummy header). There is also\n * a field \"data\" for client data.\n *\n * @param {libtess.GluFace=} opt_nextFace\n * @param {libtess.GluFace=} opt_prevFace\n * @constructor\n * @struct\n */\nlibtess.GluFace = function(opt_nextFace, opt_prevFace) {\n  // TODO(bckenny): reverse order of params?\n\n  /**\n   * next face (never null)\n   * @type {!libtess.GluFace}\n   */\n  this.next = opt_nextFace || this;\n\n  /**\n   * previous face (never NULL)\n   * @type {!libtess.GluFace}\n   */\n  this.prev = opt_prevFace || this;\n\n  /**\n   * A half edge with this left face.\n   * @type {libtess.GluHalfEdge}\n   */\n  this.anEdge = null;\n\n  /**\n   * room for client's data\n   * @type {Object}\n   */\n  this.data = null;\n\n  /**\n   * This face is in the polygon interior.\n   * @type {boolean}\n   */\n  this.inside = false;\n};\n\n\n\n/* global libtess */\n\n/**\n * The fundamental data structure is the \"half-edge\". Two half-edges\n * go together to make an edge, but they point in opposite directions.\n * Each half-edge has a pointer to its mate (the \"symmetric\" half-edge sym),\n * its origin vertex (org), the face on its left side (lFace), and the\n * adjacent half-edges in the CCW direction around the origin vertex\n * (oNext) and around the left face (lNext). There is also a \"next\"\n * pointer for the global edge list (see below).\n *\n * The notation used for mesh navigation:\n *  sym   = the mate of a half-edge (same edge, but opposite direction)\n *  oNext = edge CCW around origin vertex (keep same origin)\n *  dNext = edge CCW around destination vertex (keep same dest)\n *  lNext = edge CCW around left face (dest becomes new origin)\n *  rNext = edge CCW around right face (origin becomes new dest)\n *\n * \"prev\" means to substitute CW for CCW in the definitions above.\n *\n * The circular edge list is special; since half-edges always occur\n * in pairs (e and e.sym), each half-edge stores a pointer in only\n * one direction. Starting at eHead and following the e.next pointers\n * will visit each *edge* once (ie. e or e.sym, but not both).\n * e.sym stores a pointer in the opposite direction, thus it is\n * always true that e.sym.next.sym.next === e.\n *\n * @param {libtess.GluHalfEdge=} opt_nextEdge\n * @constructor\n * @struct\n */\nlibtess.GluHalfEdge = function(opt_nextEdge) {\n  // TODO(bckenny): are these the right defaults? (from gl_meshNewMesh requirements)\n\n  /**\n   * doubly-linked list (prev==sym->next)\n   * @type {!libtess.GluHalfEdge}\n   */\n  this.next = opt_nextEdge || this;\n\n  // TODO(bckenny): how can this be required if created in pairs? move to factory creation only?\n  /**\n   * same edge, opposite direction\n   * @type {libtess.GluHalfEdge}\n   */\n  this.sym = null;\n\n  /**\n   * next edge CCW around origin\n   * @type {libtess.GluHalfEdge}\n   */\n  this.oNext = null;\n\n  /**\n   * next edge CCW around left face\n   * @type {libtess.GluHalfEdge}\n   */\n  this.lNext = null;\n\n  /**\n   * origin vertex (oVertex too long)\n   * @type {libtess.GluVertex}\n   */\n  this.org = null;\n\n  /**\n   * left face\n   * @type {libtess.GluFace}\n   */\n  this.lFace = null;\n\n  // Internal data (keep hidden)\n  // NOTE(bckenny): can't be private, though...\n\n  /**\n   * a region with this upper edge (see sweep.js)\n   * @type {libtess.ActiveRegion}\n   */\n  this.activeRegion = null;\n\n  /**\n   * change in winding number when crossing from the right face to the left face\n   * @type {number}\n   */\n  this.winding = 0;\n};\n\n// NOTE(bckenny): the following came from macros in mesh\n// TODO(bckenny): using methods as aliases for sym connections for now.\n// not sure about this approach. getters? renames?\n\n\n/**\n * [rFace description]\n * @return {libtess.GluFace} [description].\n */\nlibtess.GluHalfEdge.prototype.rFace = function() {\n  return this.sym.lFace;\n};\n\n\n/**\n * [dst description]\n * @return {libtess.GluVertex} [description].\n */\nlibtess.GluHalfEdge.prototype.dst = function() {\n  return this.sym.org;\n};\n\n\n/**\n * [oPrev description]\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.GluHalfEdge.prototype.oPrev = function() {\n  return this.sym.lNext;\n};\n\n\n/**\n * [lPrev description]\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.GluHalfEdge.prototype.lPrev = function() {\n  return this.oNext.sym;\n};\n\n// NOTE(bckenny): libtess.GluHalfEdge.dPrev is called nowhere in libtess and\n// isn't part of the current public API. It could be useful for mesh traversal\n// and manipulation if made public, however.\n/* istanbul ignore next */\n/**\n * The edge clockwise around destination vertex (keep same dest).\n * @return {libtess.GluHalfEdge}\n */\nlibtess.GluHalfEdge.prototype.dPrev = function() {\n  return this.lNext.sym;\n};\n\n\n/**\n * [rPrev description]\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.GluHalfEdge.prototype.rPrev = function() {\n  return this.sym.oNext;\n};\n\n\n/**\n * [dNext description]\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.GluHalfEdge.prototype.dNext = function() {\n  return this.rPrev().sym;\n};\n\n\n// NOTE(bckenny): libtess.GluHalfEdge.rNext is called nowhere in libtess and\n// isn't part of the current public API. It could be useful for mesh traversal\n// and manipulation if made public, however.\n/* istanbul ignore next */\n/**\n * The edge CCW around the right face (origin of this becomes new dest).\n * @return {libtess.GluHalfEdge}\n */\nlibtess.GluHalfEdge.prototype.rNext = function() {\n  return this.oPrev().sym;\n};\n\n\n\n/* global libtess */\n\n/**\n * Creates a new mesh with no edges, no vertices,\n * and no loops (what we usually call a \"face\").\n *\n * @constructor\n * @struct\n */\nlibtess.GluMesh = function() {\n  /**\n   * dummy header for vertex list\n   * @type {libtess.GluVertex}\n   */\n  this.vHead = new libtess.GluVertex();\n\n  /**\n   * dummy header for face list\n   * @type {libtess.GluFace}\n   */\n  this.fHead = new libtess.GluFace();\n\n  /**\n   * dummy header for edge list\n   * @type {libtess.GluHalfEdge}\n   */\n  this.eHead = new libtess.GluHalfEdge();\n\n  /**\n   * and its symmetric counterpart\n   * @type {libtess.GluHalfEdge}\n   */\n  this.eHeadSym = new libtess.GluHalfEdge();\n\n  // TODO(bckenny): better way to pair these?\n  this.eHead.sym = this.eHeadSym;\n  this.eHeadSym.sym = this.eHead;\n};\n\n\n// TODO(bckenny): #ifndef NDEBUG\n/**\n * Checks mesh for self-consistency.\n */\nlibtess.GluMesh.prototype.checkMesh = function() {\n  if (!libtess.DEBUG) {\n    return;\n  }\n\n  var fHead = this.fHead;\n  var vHead = this.vHead;\n  var eHead = this.eHead;\n\n  var e;\n\n  // faces\n  var f;\n  var fPrev = fHead;\n  for (fPrev = fHead; (f = fPrev.next) !== fHead; fPrev = f) {\n    e = f.anEdge;\n    do {\n      e = e.lNext;\n    } while (e !== f.anEdge);\n  }\n\n  // vertices\n  var v;\n  var vPrev = vHead;\n  for (vPrev = vHead; (v = vPrev.next) !== vHead; vPrev = v) {\n    e = v.anEdge;\n    do {\n      e = e.oNext;\n    } while (e !== v.anEdge);\n  }\n\n  // edges\n  var ePrev = eHead;\n  for (ePrev = eHead; (e = ePrev.next) !== eHead; ePrev = e) {\n  }\n};\n\n\n\n/* global libtess */\n\n/**\n * Each vertex has a pointer to next and previous vertices in the\n * circular list, and a pointer to a half-edge with this vertex as\n * the origin (null if this is the dummy header). There is also a\n * field \"data\" for client data.\n *\n * @param {libtess.GluVertex=} opt_nextVertex [description].\n * @param {libtess.GluVertex=} opt_prevVertex [description].\n * @constructor\n * @struct\n */\nlibtess.GluVertex = function(opt_nextVertex, opt_prevVertex) {\n  // TODO(bckenny): reverse order of params?\n\n  /**\n   * Next vertex (never null).\n   * @type {!libtess.GluVertex}\n   */\n  this.next = opt_nextVertex || this;\n\n  /**\n   * Previous vertex (never null).\n   * @type {!libtess.GluVertex}\n   */\n  this.prev = opt_prevVertex || this;\n\n  /**\n   * A half-edge with this origin.\n   * @type {libtess.GluHalfEdge}\n   */\n  this.anEdge = null;\n\n  /**\n   * The client's data.\n   * @type {Object}\n   */\n  this.data = null;\n\n  /**\n   * The vertex location in 3D.\n   * @type {!Array.<number>}\n   */\n  this.coords = [0, 0, 0];\n  // TODO(bckenny): we may want to rethink coords, either eliminate (using s\n  // and t and user data) or index into contiguous storage?\n\n  /**\n   * Component of projection onto the sweep plane.\n   * @type {number}\n   */\n  this.s = 0;\n\n  /**\n   * Component of projection onto the sweep plane.\n   * @type {number}\n   */\n  this.t = 0;\n\n  /**\n   * To allow deletion from priority queue.\n   * @type {?libtess.PQHandle}\n   */\n  this.pqHandle = null;\n  // NOTE(bckenny): pqHandle inited in sweep\n  // TODO(bckenny): can we have a numeric default value? null may do bad things\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): more specific typing on key\n\n/**\n * [PQHandleElem description]\n * @constructor\n * @struct\n */\nlibtess.PQHandleElem = function() {\n  // TODO(bckenny): if key could instead be an indexed into another store, makes heap storage a lot easier\n\n  /**\n   * [key description]\n   * @type {libtess.PQKey}\n   */\n  this.key = null;\n\n  /**\n   * [node description]\n   * @type {libtess.PQHandle}\n   */\n  this.node = 0;\n};\n\n\n/**\n * Allocate a PQHandleElem array of size size. If oldArray is not null, its\n * contents are copied to the beginning of the new array. The rest of the array\n * is filled with new PQHandleElems.\n *\n * @param {?Array.<libtess.PQHandleElem>} oldArray [description].\n * @param {number} size [description].\n * @return {Array.<libtess.PQHandleElem>} [description].\n */\nlibtess.PQHandleElem.realloc = function(oldArray, size) {\n  var newArray = new Array(size);\n\n  // TODO(bckenny): better to reallocate array? or grow array?\n  var index = 0;\n  if (oldArray !== null) {\n    for (; index < oldArray.length; index++) {\n      newArray[index] = oldArray[index];\n    }\n  }\n\n  for (; index < size; index++) {\n    newArray[index] = new libtess.PQHandleElem();\n  }\n\n  return newArray;\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): maybe just have these created inline as literals\n// (or unboxed directly - PQHandle is just an array index number)\n\n/**\n * [PQNode description]\n * @constructor\n * @struct\n */\nlibtess.PQNode = function() {\n  /**\n   * [handle description]\n   * @type {libtess.PQHandle}\n   */\n  this.handle = 0;\n};\n\n\n/**\n * Allocate a PQNode array of size size. If oldArray is not null, its contents\n * are copied to the beginning of the new array. The rest of the array is\n * filled with new PQNodes.\n *\n * @param {?Array.<libtess.PQNode>} oldArray [description].\n * @param {number} size [description].\n * @return {Array.<libtess.PQNode>} [description].\n */\nlibtess.PQNode.realloc = function(oldArray, size) {\n  var newArray = new Array(size);\n\n  // TODO(bckenny): better to reallocate array? or grow array?\n  var index = 0;\n  if (oldArray !== null) {\n    for (; index < oldArray.length; index++) {\n      newArray[index] = oldArray[index];\n    }\n  }\n\n  for (; index < size; index++) {\n    newArray[index] = new libtess.PQNode();\n  }\n\n  return newArray;\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): preallocating arrays may actually be hurting us in sort\n// performance (esp if theres some undefs in there)\n\n/**\n * [PriorityQ description]\n * @constructor\n * @struct\n * @param {function(Object, Object): boolean} leq [description].\n */\nlibtess.PriorityQ = function(leq) {\n  /**\n   * [keys description]\n   * @private\n   * @type {Array.<libtess.PQKey>}\n   */\n  this.keys_ = libtess.PriorityQ.prototype.PQKeyRealloc_(null,\n      libtess.PriorityQ.INIT_SIZE_);\n\n  /**\n   * Array of indexes into this.keys_\n   * @private\n   * @type {Array.<number>}\n   */\n  this.order_ = null;\n\n  /**\n   * [size description]\n   * @private\n   * @type {number}\n   */\n  this.size_ = 0;\n\n  /**\n   * [max_ description]\n   * @private\n   * @type {number}\n   */\n  this.max_ = libtess.PriorityQ.INIT_SIZE_;\n\n  /**\n   * [initialized description]\n   * @private\n   * @type {boolean}\n   */\n  this.initialized_ = false;\n\n  // TODO(bckenny): leq was inlined by define in original, but appears to just\n  // be vertLeq, as passed. keep an eye on this as to why its not used.\n  /**\n   * [leq description]\n   * @private\n   * @type {function(libtess.PQKey, libtess.PQKey): boolean}\n   */\n  this.leq_ =\n      /** @type {function(libtess.PQKey, libtess.PQKey): boolean} */(leq);\n\n  /**\n   * [heap_ description]\n   * @private\n   * @type {libtess.PriorityQHeap}\n   */\n  this.heap_ = new libtess.PriorityQHeap(this.leq_);\n};\n\n\n/**\n * [INIT_SIZE_ description]\n * @private\n * @const\n * @type {number}\n */\nlibtess.PriorityQ.INIT_SIZE_ = 32;\n\n\n/**\n * [deleteQ description]\n */\nlibtess.PriorityQ.prototype.deleteQ = function() {\n  // TODO(bckenny): unnecessary, I think.\n  this.heap_.deleteHeap();\n  this.heap_ = null;\n  this.order_ = null;\n  this.keys_ = null;\n  // NOTE(bckenny): nulled at callsite (sweep.donePriorityQ_)\n};\n\n\n/**\n * [init description]\n */\nlibtess.PriorityQ.prototype.init = function() {\n  // TODO(bckenny): reuse. in theory, we don't have to empty this, as access is\n  // dictated by this.size_, but array.sort doesn't know that\n  this.order_ = [];\n\n  // Create an array of indirect pointers to the keys, so that\n  // the handles we have returned are still valid.\n  // TODO(bckenny): valid for when? it appears we can just store indexes into\n  // keys_, but what did this mean?\n  for (var i = 0; i < this.size_; i++) {\n    this.order_[i] = i;\n  }\n\n  // sort the indirect pointers in descending order of the keys themselves\n  // TODO(bckenny): make sure it's ok that keys[a] === keys[b] returns 1\n  // TODO(bckenny): unstable sort means we may get slightly different polys in\n  // different browsers, but only when passing in equal points\n  // TODO(bckenny): make less awkward closure?\n  var comparator = (function(keys, leq) {\n    return function(a, b) {\n      return leq(keys[a], keys[b]) ? 1 : -1;\n    };\n  })(this.keys_, this.leq_);\n  this.order_.sort(comparator);\n\n  this.max_ = this.size_;\n  this.initialized_ = true;\n  this.heap_.init();\n\n  // TODO(bckenny):\n  // #ifndef NDEBUG\n  if (libtess.DEBUG) {\n    var p = 0;\n    var r = p + this.size_ - 1;\n    for (i = p; i < r; ++i) {\n    }\n  }\n  // #endif\n};\n\n\n/**\n * [insert description]\n * @param {libtess.PQKey} keyNew [description].\n * @return {libtess.PQHandle} [description].\n */\nlibtess.PriorityQ.prototype.insert = function(keyNew) {\n  // NOTE(bckenny): originally returned LONG_MAX as alloc failure signal. no\n  // longer does.\n  if (this.initialized_) {\n    return this.heap_.insert(keyNew);\n  }\n\n  var curr = this.size_;\n  if (++this.size_ >= this.max_) {\n    // If the heap overflows, double its size.\n    this.max_ *= 2;\n    this.keys_ =\n        libtess.PriorityQ.prototype.PQKeyRealloc_(this.keys_, this.max_);\n  }\n\n  this.keys_[curr] = keyNew;\n\n  // Negative handles index the sorted array.\n  return -(curr + 1);\n};\n\n\n/**\n * Allocate a PQKey array of size size. If oldArray is not null, its\n * contents are copied to the beginning of the new array. The rest of the array\n * is filled with nulls.\n *\n * @private\n * @param {?Array.<libtess.PQKey>} oldArray [description].\n * @param {number} size [description].\n * @return {Array.<(?libtess.PQKey)>} [description].\n */\nlibtess.PriorityQ.prototype.PQKeyRealloc_ = function(oldArray, size) {\n  // TODO(bckenny): double check return type. can we have ? there?\n  var newArray = new Array(size);\n\n  // TODO(bckenny): better to reallocate array? or grow array?\n  var index = 0;\n  if (oldArray !== null) {\n    for (; index < oldArray.length; index++) {\n      newArray[index] = oldArray[index];\n    }\n  }\n\n  for (; index < size; index++) {\n    newArray[index] = null;\n  }\n\n  return newArray;\n};\n\n// NOTE(bckenny): libtess.PriorityQ.keyLessThan_ is called nowhere in libtess\n// and isn't part of the public API.\n/* istanbul ignore next */\n/**\n * Whether x is less than y according to this.leq_.\n * @private\n * @param {number} x\n * @param {number} y\n * @return {boolean}\n */\nlibtess.PriorityQ.prototype.keyLessThan_ = function(x, y) {\n  // NOTE(bckenny): was macro LT\n  var keyX = this.keys_[x];\n  var keyY = this.keys_[y];\n  return !this.leq_(keyY, keyX);\n};\n\n// NOTE(bckenny): libtess.PriorityQ.keyGreaterThan_ is called nowhere in libtess\n// and isn't part of the public API.\n/* istanbul ignore next */\n/**\n * Whether x is greater than y according to this.leq_.\n * @private\n * @param {number} x\n * @param {number} y\n * @return {boolean}\n */\nlibtess.PriorityQ.prototype.keyGreaterThan_ = function(x, y) {\n  // NOTE(bckenny): was macro GT\n  var keyX = this.keys_[x];\n  var keyY = this.keys_[y];\n  return !this.leq_(keyX, keyY);\n};\n\n\n/**\n * [extractMin description]\n * @return {libtess.PQKey} [description].\n */\nlibtess.PriorityQ.prototype.extractMin = function() {\n  if (this.size_ === 0) {\n    return this.heap_.extractMin();\n  }\n\n  var sortMin = this.keys_[this.order_[this.size_ - 1]];\n  if (!this.heap_.isEmpty()) {\n    var heapMin = this.heap_.minimum();\n    if (this.leq_(heapMin, sortMin)) {\n      return this.heap_.extractMin();\n    }\n  }\n\n  do {\n    --this.size_;\n  } while (this.size_ > 0 && this.keys_[this.order_[this.size_ - 1]] === null);\n\n  return sortMin;\n};\n\n\n/**\n * [minimum description]\n * @return {libtess.PQKey} [description].\n */\nlibtess.PriorityQ.prototype.minimum = function() {\n  if (this.size_ === 0) {\n    return this.heap_.minimum();\n  }\n\n  var sortMin = this.keys_[this.order_[this.size_ - 1]];\n  if (!this.heap_.isEmpty()) {\n    var heapMin = this.heap_.minimum();\n    if (this.leq_(heapMin, sortMin)) {\n      return heapMin;\n    }\n  }\n\n  return sortMin;\n};\n\n// NOTE(bckenny): libtess.PriorityQ.isEmpty_ isn't called within libtess and\n// isn't part of the public API. For now, leaving in but ignoring for coverage.\n/* istanbul ignore next */\n/**\n * Returns whether the priority queue is empty.\n * @private\n * @return {boolean}\n */\nlibtess.PriorityQ.prototype.isEmpty_ = function() {\n  return (this.size_ === 0) && this.heap_.isEmpty();\n};\n\n\n/**\n * [remove description]\n * @param {libtess.PQHandle} curr [description].\n */\nlibtess.PriorityQ.prototype.remove = function(curr) {\n  if (curr >= 0) {\n    this.heap_.remove(curr);\n    return;\n  }\n  curr = -(curr + 1);\n\n  this.keys_[curr] = null;\n  while (this.size_ > 0 && this.keys_[this.order_[this.size_ - 1]] === null) {\n    --this.size_;\n  }\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): keys appear to always be GluVertex in this case?\n\n/**\n * [PriorityQHeap description]\n * @constructor\n * @struct\n * @param {function(libtess.PQKey, libtess.PQKey): boolean} leq [description].\n */\nlibtess.PriorityQHeap = function(leq) {\n  /**\n   * The heap itself. Active nodes are stored in the range 1..size. Each node\n   * stores only an index into handles.\n   * @private\n   * @type {Array.<libtess.PQNode>}\n   */\n  this.nodes_ = libtess.PQNode.realloc(null,\n      libtess.PriorityQHeap.INIT_SIZE_ + 1);\n\n  /**\n   * Each handle stores a key, plus a pointer back to the node which currently\n   * represents that key (ie. nodes[handles[i].node].handle == i).\n   * @private\n   * @type {Array.<libtess.PQHandleElem>}\n   */\n  this.handles_ = libtess.PQHandleElem.realloc(null,\n      libtess.PriorityQHeap.INIT_SIZE_ + 1);\n\n  // TODO(bckenny): size and max should probably be libtess.PQHandle for correct\n  // typing (see PriorityQ.js)\n  /**\n   * The size of the queue.\n   * @private\n   * @type {number}\n   */\n  this.size_ = 0;\n\n  /**\n   * The queue's current allocated space.\n   * @private\n   * @type {number}\n   */\n  this.max_ = libtess.PriorityQHeap.INIT_SIZE_;\n\n  /**\n   * The index of the next free hole in the handles array. Handle in that slot\n   * has next item in freeList in its node propert. If there are no holes,\n   * freeList === 0 and one at the end of handles must be use.\n   * @private\n   * @type {libtess.PQHandle}\n   */\n  this.freeList_ = 0;\n\n  /**\n   * Indicates that the heap has been initialized via init. If false, inserts\n   * are fast insertions at the end of a list. If true, all inserts will now be\n   * correctly ordered in the queue before returning.\n   * @private\n   * @type {boolean}\n   */\n  this.initialized_ = false;\n\n  // TODO(bckenny): leq was inlined by define in original, but appears to\n  // be vertLeq, as passed. Using injected version, but is it better just to\n  // manually inline?\n  /**\n   * [leq description]\n   * @private\n   * @type {function(libtess.PQKey, libtess.PQKey): boolean}\n   */\n  this.leq_ = leq;\n\n  // so that minimum returns null\n  this.nodes_[1].handle = 1;\n};\n\n\n/**\n * [INIT_SIZE_ description]\n * @private\n * @const\n * @type {number}\n */\nlibtess.PriorityQHeap.INIT_SIZE_ = 32;\n\n\n/**\n * [deleteHeap description]\n */\nlibtess.PriorityQHeap.prototype.deleteHeap = function() {\n  // TODO(bckenny): unnecessary, I think.\n  this.handles_ = null;\n  this.nodes_ = null;\n  // NOTE(bckenny): nulled at callsite in PriorityQ.deleteQ\n};\n\n\n/**\n * Initializing ordering of the heap. Must be called before any method other\n * than insert is called to ensure correctness when removing or querying.\n */\nlibtess.PriorityQHeap.prototype.init = function() {\n  // This method of building a heap is O(n), rather than O(n lg n).\n  for (var i = this.size_; i >= 1; --i) {\n    this.floatDown_(i);\n  }\n\n  this.initialized_ = true;\n};\n\n\n/**\n * Insert a new key into the heap.\n * @param {libtess.PQKey} keyNew The key to insert.\n * @return {libtess.PQHandle} A handle that can be used to remove the key.\n */\nlibtess.PriorityQHeap.prototype.insert = function(keyNew) {\n  var curr = ++this.size_;\n\n  // if the heap overflows, double its size.\n  if ((curr * 2) > this.max_) {\n    this.max_ *= 2;\n    this.nodes_ = libtess.PQNode.realloc(this.nodes_, this.max_ + 1);\n    this.handles_ = libtess.PQHandleElem.realloc(this.handles_, this.max_ + 1);\n  }\n\n  var free;\n  if (this.freeList_ === 0) {\n    free = curr;\n  } else {\n    free = this.freeList_;\n    this.freeList_ = this.handles_[free].node;\n  }\n\n  this.nodes_[curr].handle = free;\n  this.handles_[free].node = curr;\n  this.handles_[free].key = keyNew;\n\n  if (this.initialized_) {\n    this.floatUp_(curr);\n  }\n\n  return free;\n};\n\n\n/**\n * @return {boolean} Whether the heap is empty.\n */\nlibtess.PriorityQHeap.prototype.isEmpty = function() {\n  return this.size_ === 0;\n};\n\n\n/**\n * Returns the minimum key in the heap. If the heap is empty, null will be\n * returned.\n * @return {libtess.PQKey} [description].\n */\nlibtess.PriorityQHeap.prototype.minimum = function() {\n  return this.handles_[this.nodes_[1].handle].key;\n};\n\n\n/**\n * Removes the minimum key from the heap and returns it. If the heap is empty,\n * null will be returned.\n * @return {libtess.PQKey} [description].\n */\nlibtess.PriorityQHeap.prototype.extractMin = function() {\n  var n = this.nodes_;\n  var h = this.handles_;\n  var hMin = n[1].handle;\n  var min = h[hMin].key;\n\n  if (this.size_ > 0) {\n    n[1].handle = n[this.size_].handle;\n    h[n[1].handle].node = 1;\n\n    h[hMin].key = null;\n    h[hMin].node = this.freeList_;\n    this.freeList_ = hMin;\n\n    if (--this.size_ > 0) {\n      this.floatDown_(1);\n    }\n  }\n\n  return min;\n};\n\n\n/**\n * Remove key associated with handle hCurr (returned from insert) from heap.\n * @param {libtess.PQHandle} hCurr [description].\n */\nlibtess.PriorityQHeap.prototype.remove = function(hCurr) {\n  var n = this.nodes_;\n  var h = this.handles_;\n\n  var curr = h[hCurr].node;\n  n[curr].handle = n[this.size_].handle;\n  h[n[curr].handle].node = curr;\n\n  if (curr <= --this.size_) {\n    if (curr <= 1 ||\n        this.leq_(h[n[curr >> 1].handle].key, h[n[curr].handle].key)) {\n\n      this.floatDown_(curr);\n    } else {\n      this.floatUp_(curr);\n    }\n  }\n\n  h[hCurr].key = null;\n  h[hCurr].node = this.freeList_;\n  this.freeList_ = hCurr;\n};\n\n\n/**\n * [floatDown_ description]\n * @private\n * @param {libtess.PQHandle} curr [description].\n */\nlibtess.PriorityQHeap.prototype.floatDown_ = function(curr) {\n  var n = this.nodes_;\n  var h = this.handles_;\n\n  var hCurr = n[curr].handle;\n  for (;;) {\n    // The children of node i are nodes 2i and 2i+1.\n    // set child to the index of the child with the minimum key\n    var child = curr << 1;\n    if (child < this.size_ &&\n        this.leq_(h[n[child + 1].handle].key, h[n[child].handle].key)) {\n\n      ++child;\n    }\n\n    var hChild = n[child].handle;\n    if (child > this.size_ || this.leq_(h[hCurr].key, h[hChild].key)) {\n      n[curr].handle = hCurr;\n      h[hCurr].node = curr;\n      break;\n    }\n    n[curr].handle = hChild;\n    h[hChild].node = curr;\n    curr = child;\n  }\n};\n\n\n/**\n * [floatUp_ description]\n * @private\n * @param {libtess.PQHandle} curr [description].\n */\nlibtess.PriorityQHeap.prototype.floatUp_ = function(curr) {\n  var n = this.nodes_;\n  var h = this.handles_;\n\n  var hCurr = n[curr].handle;\n  for (;;) {\n    var parent = curr >> 1;\n    var hParent = n[parent].handle;\n    if (parent === 0 || this.leq_(h[hParent].key, h[hCurr].key)) {\n      n[curr].handle = hCurr;\n      h[hCurr].node = curr;\n      break;\n    }\n\n    n[curr].handle = hParent;\n    h[hParent].node = curr;\n    curr = parent;\n  }\n};\n\n\n/* global libtess */\n\n// TODO(bckenny): apparently only visible outside of sweep for debugging routines.\n// find out if we can hide\n\n/**\n * For each pair of adjacent edges crossing the sweep line, there is\n * an ActiveRegion to represent the region between them. The active\n * regions are kept in sorted order in a dynamic dictionary. As the\n * sweep line crosses each vertex, we update the affected regions.\n * @constructor\n * @struct\n */\nlibtess.ActiveRegion = function() {\n  // TODO(bckenny): I *think* eUp and nodeUp could be passed in as constructor params\n\n  /**\n   * The upper edge of the region, directed right to left\n   * @type {libtess.GluHalfEdge}\n   */\n  this.eUp = null;\n\n  /**\n   * Dictionary node corresponding to eUp edge.\n   * @type {libtess.DictNode}\n   */\n  this.nodeUp = null;\n\n  /**\n   * Used to determine which regions are inside the polygon.\n   * @type {number}\n   */\n  this.windingNumber = 0;\n\n  /**\n   * Whether this region is inside the polygon.\n   * @type {boolean}\n   */\n  this.inside = false;\n\n  /**\n   * Marks fake edges at t = +/-infinity.\n   * @type {boolean}\n   */\n  this.sentinel = false;\n\n  /**\n   * Marks regions where the upper or lower edge has changed, but we haven't\n   * checked whether they intersect yet.\n   * @type {boolean}\n   */\n  this.dirty = false;\n\n  /**\n   * marks temporary edges introduced when we process a \"right vertex\" (one\n   * without any edges leaving to the right)\n   * @type {boolean}\n   */\n  this.fixUpperEdge = false;\n};\n\n/**\n * Returns the ActiveRegion below this one.\n * @return {libtess.ActiveRegion}\n */\nlibtess.ActiveRegion.prototype.regionBelow = function() {\n  return this.nodeUp.getPredecessor().getKey();\n};\n\n/**\n * Returns the ActiveRegion above this one.\n * @return {libtess.ActiveRegion}\n */\nlibtess.ActiveRegion.prototype.regionAbove = function() {\n  return this.nodeUp.getSuccessor().getKey();\n};\n\n/* global libtess, module */\n\nexport default libtess;\n","import WorldWind from 'webworldwind-esa';\n\nconst {\n    GpuProgram\n} = WorldWind;\n\nexport default class ScreenColorProgram extends GpuProgram {\n\n    constructor(gl) {\n        const vertexShaderSource =\n            'attribute vec3 a_position;\\n' +\n\n            'uniform vec2 u_resolution;\\n' +\n\n            'void main() {\\n' +\n                // convert the position from pixels to 0.0 to 1.0\n            '   vec2 zeroToOne = a_position.xy / u_resolution;\\n' +\n\n                // convert from 0->1 to 0->2\n            '   vec2 zeroToTwo = zeroToOne * 2.0;\\n' +\n\n                // convert from 0->2 to -1->+1 (clipspace)\n            '   vec2 clipSpace = zeroToTwo - 1.0;\\n' +\n\n            '   gl_Position = vec4(clipSpace, 0, 1);\\n' +\n            '}';\n\n        const fragmentShaderSource =\n            'precision mediump float;\\n' +\n\n            'uniform vec4 color;\\n' +\n\n            'void main() {\\n' +\n            '   gl_FragColor = color;\\n' +\n            '}';\n\n        super(gl, vertexShaderSource, fragmentShaderSource, ['a_position']);\n\n        this.resolutionLocation = this.uniformLocation(gl, 'u_resolution');\n        this.colorLocation = this.uniformLocation(gl, 'color');\n\n        this.localCache = {\n            resolution: {\n                width: null,\n                height: null,\n            },\n            color: {\n                r: null,\n                g: null,\n                b: null,\n                a: null,\n            },\n        };\n    }\n\n    loadResolution(gl, width, height) {\n        if (this.localCache.resolution.width === width && this.localCache.resolution.height === height) {\n            return;\n        }\n        gl.uniform2f(this.resolutionLocation, width, height);\n        this.localCache.resolution.width = width;\n        this.localCache.resolution.height = height;\n    }\n\n    loadColor(gl, color) {\n        const cacheColor = this.localCache.color;\n        if (cacheColor.r === color.red &&\n            cacheColor.g === color.green &&\n            cacheColor.b === color.blue &&\n            cacheColor.a === color.alpha) {\n            return;\n        }\n        const a = color.alpha;\n        gl.uniform4f(this.colorLocation, color.red * a, color.green * a, color.blue * a, color.alpha);\n        cacheColor.r = color.red;\n        cacheColor.g = color.green;\n        cacheColor.b = color.blue;\n        cacheColor.a = color.alpha;\n    }\n\n}\n\nScreenColorProgram.key = 'WorldWindGpuScreenColorProgram';","import WorldWind from 'webworldwind-esa';\n\nconst {\n    GpuProgram\n} = WorldWind;\n\nexport default class ScreenTextureProgram extends GpuProgram {\n\n    constructor(gl) {\n        const vertexShaderSource =\n            'attribute vec3 a_position;\\n' +\n            'attribute vec2 vertexTexCoord;\\n' +\n\n            'uniform vec2 u_resolution;\\n' +\n\n            'varying vec2 texCoord;\\n' +\n\n            'void main() {\\n' +\n            // convert the position from pixels to 0.0 to 1.0\n            '   vec2 zeroToOne = a_position.xy / u_resolution;\\n' +\n\n            // convert from 0->1 to 0->2\n            '   vec2 zeroToTwo = zeroToOne * 2.0;\\n' +\n\n            // convert from 0->2 to -1->+1 (clipspace)\n            '   vec2 clipSpace = zeroToTwo - 1.0;\\n' +\n\n            '   gl_Position = vec4(clipSpace, 0, 1);\\n' +\n            '   gl_PointSize = 3.0;\\n' +\n            '   texCoord = vertexTexCoord;\\n' +\n            '}';\n\n        const fragmentShaderSource =\n            'precision mediump float;\\n' +\n\n            'uniform sampler2D textureSampler;\\n' +\n\n            'varying vec2 texCoord;\\n' +\n\n            'void main() {\\n' +\n            '   gl_FragColor = texture2D(textureSampler, texCoord);\\n' +\n            //'   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\\n' +\n            '}';\n\n        super(gl, vertexShaderSource, fragmentShaderSource, ['a_position', 'vertexTexCoord']);\n\n        this.resolutionLocation = this.uniformLocation(gl, 'u_resolution');\n        this.texUnitLocation = this.uniformLocation(gl, 'textureSampler');\n\n        this.localCache = {\n            resolution: {\n                width: null,\n                height: null,\n            },\n            textureUnit: null,\n        };\n    }\n\n    loadResolution(gl, width, height) {\n        if (this.localCache.resolution.width === width && this.localCache.resolution.height === height) {\n            return;\n        }\n        gl.uniform2f(this.resolutionLocation, width, height);\n        this.localCache.resolution.width = width;\n        this.localCache.resolution.height = height;\n    }\n\n    loadTextureUnit(gl, unit) {\n        if (this.localCache.textureUnit === unit) {\n            return;\n        }\n        gl.uniform1i(this.texUnitLocation, unit - gl.TEXTURE0);\n        this.localCache.textureUnit = unit;\n    }\n\n}\n\nScreenTextureProgram.key = 'WorldWindGpuScreenTextureProgram';","import libtess from './libtess';\nimport ScreenColorProgram from './ScreenColorProgram';\nimport ScreenTextureProgram from './ScreenTextureProgram';\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    Angle,\n    SurfaceShape,\n    PickedObject,\n    Texture,\n    Location,\n} = WorldWind;\n\nconst WGS84_SEMI_MAJOR_AXIS = 6378137.0;\n\nexport default class TexturedSurfaceShape extends SurfaceShape {\n\n    static tesselator() {\n        if (!TexturedSurfaceShape.tess) {\n            TexturedSurfaceShape.tess = new libtess.GluTesselator();\n        }\n        return TexturedSurfaceShape.tess;\n    }\n\n    static nextId() {\n        if (!TexturedSurfaceShape._nextId) {\n            TexturedSurfaceShape._nextId = 0;\n        }\n        return TexturedSurfaceShape._nextId++;\n    }\n\n    static staticStateKey(shape) {\n        shape.stateKeyInvalid = false;\n\n        if (shape.highlighted) {\n            if (!shape._highlightAttributes) {\n                if (!shape._attributes) {\n                    shape._attributesStateKey = null;\n                } else {\n                    shape._attributesStateKey = shape._attributes.stateKey;\n                }\n            } else {\n                shape._attributesStateKey = shape._highlightAttributes.stateKey;\n            }\n        } else {\n            if (!shape._attributes) {\n                shape._attributesStateKey = null;\n            } else {\n                shape._attributesStateKey = shape._attributes.stateKey;\n            }\n        }\n\n        return 'dn ' + shape.displayName +\n            ' id ' + shape._id +\n            ' at ' + (!shape._attributesStateKey ? 'null' : shape._attributesStateKey) +\n            ' hi ' + shape.highlighted +\n            ' en ' + shape.enabled +\n            ' pt ' + shape.pathType +\n            ' ne ' + shape.maximumNumEdgeIntervals +\n            ' po ' + shape.polarThrottle +\n            ' img ' + !!shape.image +\n            ' se ' + '[' +\n            shape.sector.minLatitude + ',' +\n            shape.sector.maxLatitude + ',' +\n            shape.sector.minLongitude + ',' +\n            shape.sector.maxLongitude +\n            ']';\n    }\n\n    constructor(attributes) {\n        super(attributes);\n\n        this._image = null;\n        this._imageUUID = '';\n        this._interiorVboCacheKey = '';\n        this._outlineVboCacheKey = '';\n\n        this._contoursPrepered = false;\n        this._contoursInfo = [];\n\n        this._id = TexturedSurfaceShape.nextId();\n    }\n\n    get image() {\n        return this._image;\n    }\n\n    set image(img) {\n        this._image = img;\n        this.stateKeyInvalid = true;\n    }\n\n    get imageUUID() {\n        return this._imageUUID;\n    }\n\n    set imageUUID(value) {\n        this._imageUUID = value;\n    }\n\n    renderToTexture(dc, fbo, xScale, yScale, dx, dy) {\n        const attributes = (this._highlighted ? (this._highlightAttributes || this._attributes) : this._attributes);\n        const drawInterior = (!this._isInteriorInhibited && attributes.drawInterior);\n        const drawOutline = (attributes.drawOutline && attributes.outlineWidth > 0);\n\n        if (!drawInterior && !drawOutline) {\n            return;\n        }\n\n        if (dc.pickingMode && !this.pickColor) {\n            this.pickColor = dc.uniquePickColor();\n        }\n\n        //TODO pass width and height from SurfaceShapeTile\n        const tileWidth = 256;\n        const tileHeight = 256;\n\n        var i;\n        const interiorGeometry = this.mapGeometry(this._interiorGeometry, xScale, yScale, dx, dy);\n        for (i = 0; i < interiorGeometry.length; i++) {\n            if (!this._contoursPrepered) {\n                var wo = this.windingOrder_all(interiorGeometry[i]);\n                this._contoursInfo.push({wo: wo});\n            }\n\n            var points = interiorGeometry[i];\n            if (points[0] === points[points.length - 2] && points[1] === points[points.length - 1]) {\n                points.pop();\n                points.pop();\n            }\n        }\n\n        if (this._image && !dc.pickingMode && !this.crossesAntiMeridian && !this.containsPole) {\n            if (!this._contoursPrepered) {\n                if (interiorGeometry.length === 1) {\n                    const {anglesMap, topLeftIndex} = this.getCorners(interiorGeometry[0], this._contoursInfo[0].wo);\n                    const uvs = this.computeUvs(this._contoursInfo[0].wo, anglesMap, topLeftIndex, this._interiorGeometry[0]);\n                    this._contoursInfo[0].anglesMap = anglesMap;\n                    this._contoursInfo[0].topLeftIndex = topLeftIndex;\n                    this._contoursInfo[0].uvs = uvs;\n\n                    var tessGeom = this.tessellate_p1(interiorGeometry[0], uvs);\n                    var tessIndices = [];\n                    for (i = 0; i < tessGeom.length; i += 5) {\n                        var x = tessGeom[i];\n                        var y = tessGeom[i + 1];\n\n                        for (var j = 0; j < interiorGeometry[0].length; j += 2) {\n                            var px = interiorGeometry[0][j];\n                            var py = interiorGeometry[0][j + 1];\n                            if (px === x && py === y) {\n                                tessIndices.push(j / 2);\n                                break;\n                            }\n                        }\n                    }\n                    this._contoursInfo[0].iboData = new Uint16Array(tessIndices);\n\n                    var len = Math.floor(interiorGeometry[0].length / 2) * 5;\n                    this._contoursInfo[0].vboData = new Float32Array(len);\n\n                    var vboData = this._contoursInfo[0].vboData;\n                    var k = 0;\n                    for (i = 0; i < vboData.length; i += 5) {\n                        vboData[i] = interiorGeometry[k];\n                        vboData[i + 1] = interiorGeometry[k + 1];\n                        vboData[i + 2] = 0;\n                        vboData[i + 3] = uvs[k];\n                        vboData[i + 4] = uvs[k + 1];\n                        k += 2;\n                    }\n\n                    this._contoursPrepered = true;\n                }\n                else {\n\n                }\n                //this._contoursPrepered = true;\n            }\n            this.renderTexture(dc, {\n                points: interiorGeometry[0],\n                tileWidth,\n                tileHeight,\n                xScale,\n                yScale,\n                dx,\n                dy,\n            });\n        }\n        else {\n            this.renderColor(dc, {\n                tileWidth,\n                tileHeight,\n                xScale,\n                yScale,\n                dx,\n                dy,\n                drawInterior,\n                interiorColor: attributes.interiorColor,\n                drawOutline,\n                outlineColor: attributes.outlineColor,\n            });\n            this._contoursPrepered = true;\n        }\n\n        if (dc.pickingMode) {\n            var po = new PickedObject(this.pickColor.clone(), this.pickDelegate ? this.pickDelegate : this,\n                null, this.layer, false);\n            dc.resolvePick(po);\n        }\n    }\n\n    renderColor(dc, {tileWidth, tileHeight, xScale, yScale, dx, dy, drawInterior, interiorColor}) {\n        if (!this.tessGeom) {\n            this.tessGeom = this.tessellate(this._interiorGeometry);\n            this.tessTris = new Float32Array(this.tessGeom.length);\n        }\n\n        if (!this.wo) {\n            const interiorGeometry = this.mapGeometry(this._interiorGeometry, xScale, yScale, dx, dy);\n            this.wo = this.windingOrder_all(interiorGeometry[0]);\n        }\n\n        const gl = dc.currentGlContext;\n        const program = dc.findAndBindProgram(ScreenColorProgram);\n        program.loadResolution(gl, tileWidth, tileHeight);\n        gl.enableVertexAttribArray(0);\n\n        if (drawInterior) {\n            program.loadColor(gl, dc.pickingMode ? this.pickColor : interiorColor);\n\n            for (var i = 0; i < this.tessGeom.length; i += 3) {\n                var x = this.tessGeom[i];\n                var y = this.tessGeom[i + 1];\n                this.tessTris[i] = x * Angle.RADIANS_TO_DEGREES * xScale + dx;\n                this.tessTris[i + 1] = y * Angle.RADIANS_TO_DEGREES * yScale + dy;\n                this.tessTris[i + 2] = 0;\n            }\n\n            this.bindInteriorVbo(dc, this.tessTris, null);\n            gl.vertexAttribPointer(0, 3, gl.FLOAT, false, 0, 0);\n\n            if (this.wo === 'CW') {\n                gl.frontFace(gl.CW);\n            }\n            gl.drawArrays(gl.TRIANGLES, 0, Math.floor(this.tessTris.length / 3));\n\n            if (this.wo === 'CW') {\n                gl.frontFace(gl.CCW);\n            }\n        }\n\n        //if (drawOutline || true) {\n        /*program.loadColor(gl, attributes.outlineColor);\n        this.bindOutlineVbo(dc, new Float32Array(outlineGeometry[0]), null);\n        gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0);\n        gl.drawArrays(gl.LINE_STRIP, 0, Math.floor(outlineGeometry[0].length / 2));*/\n        //}\n    }\n\n    renderTexture(dc, {points, tileWidth, tileHeight, xScale, yScale, dx, dy, anglesMap, topLeftIndex}) {\n\n        var vboData = this._contoursInfo[0].vboData;\n        var k = 0;\n        for (var i = 0; i < vboData.length; i += 5) {\n            vboData[i] = points[k];\n            vboData[i + 1] = points[k + 1];\n            k += 2;\n        }\n\n        const gl = dc.currentGlContext;\n        const program = dc.findAndBindProgram(ScreenTextureProgram);\n        program.loadResolution(gl, tileWidth, tileHeight);\n        gl.enableVertexAttribArray(0);\n        gl.enableVertexAttribArray(1);\n        program.loadTextureUnit(gl, gl.TEXTURE0);\n        const imageTextureKey = this._imageUUID || this._image.src;\n        if (!imageTextureKey) {\n            console.error('TexturedSurfaceShape, no uuid for image. Use shape.imageUUID to set a unique id');\n        }\n        let imageTexture = dc.gpuResourceCache.resourceForKey(imageTextureKey);\n\n        if (!imageTexture) {\n            imageTexture = new Texture(gl, this._image, null, true);\n            dc.gpuResourceCache.putResource(imageTextureKey, imageTexture, imageTexture.size);\n        }\n\n        imageTexture.bind(dc);\n\n        this.bindInteriorVbo(dc, vboData, null);\n        this.bindInteriorIbo(dc, this._contoursInfo[0].iboData, null);\n        /*var buf = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buf);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this._contoursInfo[0].iboData, gl.STATIC_DRAW);*/\n        const valuesPerVertex = 3 + 2; //3 values for position and 2 values for uvs\n        const sizeOfFloat32 = 4;\n        const vertexSize = valuesPerVertex * sizeOfFloat32;\n\n        gl.vertexAttribPointer(0, 3, gl.FLOAT, false, vertexSize, 0);\n        gl.vertexAttribPointer(1, 2, gl.FLOAT, false, vertexSize, 3 * sizeOfFloat32);\n\n        if (this._contoursInfo[0].wo === 'CW') {\n            gl.frontFace(gl.CW);\n        }\n\n        gl.drawElements(gl.TRIANGLES, this._contoursInfo[0].iboData.length, gl.UNSIGNED_SHORT, 0);\n\n        //gl.drawArrays(gl.TRIANGLES, 0, Math.floor(this._contoursInfo[0].tessTris.length / 5));\n        //gl.drawArrays(gl.POINTS, 0,  Math.floor(this.tessTris.length / 5));\n        /*for (var i =0 ; i < this.tessTris.length; i += 3) {\n            gl.drawArrays(gl.LINE_LOOP, i, 3);\n        }*/\n\n        if (this._contoursInfo[0].wo === 'CW') {\n            gl.frontFace(gl.CCW);\n        }\n\n        gl.disableVertexAttribArray(1);\n    }\n\n    computeUvs(wo, anglesMap, topLeftIndex, locations1) {\n        const locations = locations1.slice();\n        locations.pop();\n        var uvs = new Float32Array(locations.length * 2);\n        var side = '';\n\n        for (var i = topLeftIndex; i < locations.length + topLeftIndex; i++) {\n            var index = i % locations.length;\n            var uv = {s: -1, t: -1};\n\n            if (anglesMap[index]) {\n                //is corner\n                side = this.nextSide(side, wo);\n\n                var sideStart = locations[index];\n                var sideEnd = null;\n                for (var j = i + 1; j < locations.length + topLeftIndex; j++) {\n                    var jIndex = j % locations.length;\n                    if (anglesMap[jIndex] != null) {\n                        sideEnd = locations[jIndex];\n                        break;\n                    }\n                }\n                if (!sideEnd) {\n                    sideEnd = locations[topLeftIndex];\n                }\n                var sideDistance = Location.greatCircleDistance(sideStart, sideEnd) * WGS84_SEMI_MAJOR_AXIS;\n            }\n\n            var distance = Location.greatCircleDistance(sideStart, locations[index]) * WGS84_SEMI_MAJOR_AXIS;\n\n            if (wo === 'CW') {\n                if (side === 'top') {\n                    uv.s = distance / sideDistance;\n                    uv.t = 0;\n                }\n                else if (side === 'right') {\n                    uv.s = 1;\n                    uv.t = distance / sideDistance;\n                }\n                else if (side === 'bottom') {\n                    uv.s = 1 - distance / sideDistance;\n                    uv.t = 1;\n                }\n                else if (side === 'left') {\n                    uv.s = 0;\n                    uv.t = 1 - distance / sideDistance;\n                }\n            }\n            else {\n                if (side === 'left') {\n                    uv.s = 0;\n                    uv.t = distance / sideDistance;\n                }\n                else if (side === 'bottom') {\n                    uv.s = distance / sideDistance;\n                    uv.t = 1;\n                }\n                else if (side === 'right') {\n                    uv.s = 1;\n                    uv.t = 1 - distance / sideDistance;\n                }\n                else if (side === 'top') {\n                    uv.s = 1 - distance / sideDistance;\n                    uv.t = 0;\n                }\n            }\n\n            uvs[index * 2] = uv.s;\n            uvs[index * 2 + 1] = uv.t;\n        }\n\n        return uvs;\n    }\n\n    nextSide(side, wo) {\n        var nextSide = '';\n        if (wo === 'CW') {\n            nextSide = 'top';\n            if (side === 'top') {\n                nextSide = 'right';\n            }\n            else if (side === 'right') {\n                nextSide = 'bottom';\n            }\n            else if (side === 'bottom') {\n                nextSide = 'left';\n            }\n            else if (side === 'left') {\n                nextSide = 'top';\n            }\n        }\n        else {\n            nextSide = 'left';\n            if (side === 'left') {\n                nextSide = 'bottom';\n            }\n            else if (side === 'bottom') {\n                nextSide = 'right';\n            }\n            else if (side === 'right') {\n                nextSide = 'top';\n            }\n            else if (side === 'top') {\n                nextSide = 'left';\n            }\n        }\n\n        return nextSide;\n    }\n\n    mapGeometry(contours, xScale, yScale, dx, dy) {\n        return contours.map(contour => {\n            return contour.reduce((acc, location) => {\n                const x = location.longitude * xScale + dx;\n                const y = location.latitude * yScale + dy;\n                acc.push(x, y);\n                return acc;\n            }, []);\n        });\n    }\n\n    bindInteriorVbo(dc, vboData, vboUsage) {\n        vboUsage = vboUsage || dc.currentGlContext.STATIC_DRAW;\n        if (!this._interiorVboCacheKey) {\n            this._interiorVboCacheKey = dc.gpuResourceCache.generateCacheKey();\n        }\n\n        this.bindVbo(dc, vboData, vboUsage, this._interiorVboCacheKey);\n    }\n\n    bindOutlineVbo(dc, vboData, vboUsage) {\n        vboUsage = vboUsage || dc.currentGlContext.STATIC_DRAW;\n        if (!this._outlineVboCacheKey) {\n            this._outlineVboCacheKey = dc.gpuResourceCache.generateCacheKey();\n        }\n\n        this.bindVbo(dc, vboData, vboUsage, this._outlineVboCacheKey);\n    }\n\n    bindVbo(dc, vboData, vboUsage, cacheKey) {\n        const gl = dc.currentGlContext;\n\n        let vbo = dc.gpuResourceCache.resourceForKey(cacheKey);\n        const vboEntry = dc.gpuResourceCache.entries.entries[cacheKey];\n        let vboSize = 0;\n        if (vboEntry) {\n            vboSize = vboEntry.size;\n        }\n        if (!vbo || vboSize < vboData.length * vboData.BYTES_PER_ELEMENT) {\n            vbo = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n            gl.bufferData(gl.ARRAY_BUFFER, vboData, vboUsage);\n            dc.gpuResourceCache.putResource(cacheKey, vbo, vboData.length * vboData.BYTES_PER_ELEMENT);\n        }\n        else {\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, vboData);\n        }\n    }\n\n    bindInteriorIbo(dc, iboData, iboUsage) {\n        iboUsage = iboUsage || dc.currentGlContext.STATIC_DRAW;\n        if (!this._interiorIboCacheKey) {\n            this._interiorIboCacheKey = dc.gpuResourceCache.generateCacheKey();\n        }\n\n        this.bindIbo(dc, iboData, iboUsage, this._interiorIboCacheKey);\n    }\n\n    bindIbo(dc, iboData, iboUsage, cacheKey) {\n        const gl = dc.currentGlContext;\n\n        let ibo = dc.gpuResourceCache.resourceForKey(cacheKey);\n        const vboEntry = dc.gpuResourceCache.entries.entries[cacheKey];\n        let iboSize = 0;\n        if (vboEntry) {\n            iboSize = vboEntry.size;\n        }\n        if (!ibo || iboSize < iboData.length * iboData.BYTES_PER_ELEMENT) {\n            ibo = gl.createBuffer();\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, iboData, iboUsage);\n            dc.gpuResourceCache.putResource(cacheKey, ibo, iboData.length * iboData.BYTES_PER_ELEMENT);\n        }\n        else {\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n        }\n    }\n\n    tessellate_p(points, uvs) {\n        var tess = TexturedSurfaceShape.tesselator();\n        var triangles = [];\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN, function (prim) {\n            if (prim !== libtess.primitiveType.GL_TRIANGLES) {\n                console.error('Tessellation error, primitive is not TRIANGLES.');\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE, function (coords, data, weight) {\n            var newCoords = [coords[0], coords[1], coords[2]];\n\n            if (uvs && uvs.length) {\n                for (var i = 3; i <= 4; i++) {\n                    var value = 0;\n                    for (var w = 0; w < 4; w++) {\n                        if (weight[w] > 0) {\n                            value += weight[w] * data[w][i];\n                        }\n                    }\n\n                    newCoords[i] = value;\n                }\n            }\n\n            return newCoords;\n        });\n\n        //prevents triangle fans and strips\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG, function () {\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA, function (data, tris) {\n            tris.push(data[0]);\n            tris.push(data[1]);\n            tris.push(data[2]);\n\n            if (uvs && uvs.length) {\n                tris.push(data[3]);\n                tris.push(data[4]);\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR, function (errno) {\n            console.error('tess err', errno);\n        });\n\n        tess.gluTessBeginPolygon(triangles);\n        tess.gluTessBeginContour();\n\n        var k = 0;\n        for (var i = 0; i < points.length; i++) {\n\n            var vertex = [points[i].x, points[i].y, 0];\n            if (uvs && uvs.length) {\n                vertex.push(uvs[k], uvs[k + 1]);\n                k += 2;\n            }\n\n            tess.gluTessVertex(vertex, vertex);\n        }\n\n        tess.gluTessEndContour();\n        tess.gluTessEndPolygon();\n\n        return triangles;\n    }\n\n    tessellate_p1(points, uvs) {\n        var tess = TexturedSurfaceShape.tesselator();\n        var triangles = [];\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN, function (prim) {\n            if (prim !== libtess.primitiveType.GL_TRIANGLES) {\n                console.error('Tessellation error, primitive is not TRIANGLES.');\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE, function (coords, data, weight) {\n            var newCoords = [coords[0], coords[1], coords[2]];\n\n            if (uvs && uvs.length) {\n                for (var i = 3; i <= 4; i++) {\n                    var value = 0;\n                    for (var w = 0; w < 4; w++) {\n                        if (weight[w] > 0) {\n                            value += weight[w] * data[w][i];\n                        }\n                    }\n\n                    newCoords[i] = value;\n                }\n            }\n\n            return newCoords;\n        });\n\n        //prevents triangle fans and strips\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG, function () {\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA, function (data, tris) {\n            tris.push(data[0]);\n            tris.push(data[1]);\n            tris.push(data[2]);\n\n            if (uvs && uvs.length) {\n                tris.push(data[3]);\n                tris.push(data[4]);\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR, function (errno) {\n            console.error('tess err', errno);\n        });\n\n        tess.gluTessBeginPolygon(triangles);\n        tess.gluTessBeginContour();\n\n        var k = 0;\n        for (var i = 0; i < points.length; i += 2) {\n\n            var vertex = [points[i], points[i + 1], 0];\n            if (uvs && uvs.length) {\n                vertex.push(uvs[k], uvs[k + 1]);\n                k += 2;\n            }\n\n            tess.gluTessVertex(vertex, vertex);\n        }\n\n        tess.gluTessEndContour();\n        tess.gluTessEndPolygon();\n\n        return triangles;\n    }\n\n    tessellate(contours, uvs) {\n        var tess = TexturedSurfaceShape.tesselator();\n        var triangles = [];\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN, function (prim) {\n            if (prim !== libtess.primitiveType.GL_TRIANGLES) {\n                console.error('Tessellation error, primitive is not TRIANGLES.');\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE, function (coords, data, weight) {\n            var newCoords = [coords[0], coords[1], coords[2]];\n\n            if (uvs && uvs.length) {\n                for (var i = 3; i <= 4; i++) {\n                    var value = 0;\n                    for (var w = 0; w < 4; w++) {\n                        if (weight[w] > 0) {\n                            value += weight[w] * data[w][i];\n                        }\n                    }\n\n                    newCoords[i] = value;\n                }\n            }\n\n            return newCoords;\n        });\n\n        //prevents triangle fans and strips\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG, function () {\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA, function (data, tris) {\n            tris.push(data[0]);\n            tris.push(data[1]);\n            tris.push(data[2]);\n\n            if (uvs && uvs.length) {\n                tris.push(data[3]);\n                tris.push(data[4]);\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR, function (errno) {\n            console.error('tess err', errno);\n        });\n\n        // Tessellate the polygon.\n        tess.gluTessBeginPolygon(triangles);\n        var k = 0;\n        for (var i = 0; i < contours.length; i++) {\n            tess.gluTessBeginContour();\n            var contour = contours[i];\n            for (var j = 0; j < contour.length; j += 1) {\n                var pos = contour[j];\n                var x = pos.longitude * Angle.DEGREES_TO_RADIANS;\n                var y = pos.latitude * Angle.DEGREES_TO_RADIANS;\n                var vertex = [x, y, 0];\n                if (uvs && uvs.length) {\n                    vertex.push(uvs[k], uvs[k + 1]);\n                    k += 2;\n                }\n                //console.log('vertex', vertex);\n                tess.gluTessVertex(vertex, vertex);\n            }\n            tess.gluTessEndContour();\n        }\n        tess.gluTessEndPolygon();\n\n        return triangles;\n    }\n\n    getBbox(points) {\n        const bbox = {\n            minX: Number.MAX_SAFE_INTEGER,\n            maxX: Number.MIN_SAFE_INTEGER,\n            minY: Number.MAX_SAFE_INTEGER,\n            maxY: Number.MIN_SAFE_INTEGER,\n            width: 0,\n            height: 0\n        };\n\n        for (var i = 0; i < points.length; i++) {\n            var point = points[i];\n            bbox.minX = Math.min(bbox.minX, point.x);\n            bbox.maxX = Math.max(bbox.maxX, point.x);\n            bbox.minY = Math.min(bbox.minY, point.y);\n            bbox.maxY = Math.max(bbox.maxY, point.y);\n        }\n\n        bbox.width = Math.abs(bbox.maxX - bbox.minX);\n        bbox.height = Math.abs(bbox.maxY - bbox.minY);\n\n        return bbox;\n    }\n\n    getCorners(points, wo) {\n        if (points.length === 4) {\n            //return this.reindexCorners(points);\n        }\n\n        var angles = [];\n        for (var i = 0; i < points.length; i += 2) {\n            var prevX;\n            var prevY;\n            var currentX;\n            var currentY;\n            var nextX;\n            var nextY;\n\n            if (i === 0) {\n                prevX = points[points.length - 2];\n                prevY = points[points.length - 1];\n            }\n            else {\n                prevX = points[i - 2];\n                prevY = points[i - 1];\n            }\n\n            currentX = points[i];\n            currentY = points[i + 1];\n\n            if (i === points.length - 2) {\n                nextX = points[0];\n                nextY = points[1];\n            }\n            else {\n                nextX = points[i + 2];\n                nextY = points[i + 3];\n            }\n\n            var angle = Math.atan2(nextY - currentY, nextX - currentX) -\n                Math.atan2(prevY - currentY, prevX - currentX);\n\n            angles.push({\n                index: i / 2,\n                angle: Math.abs(angle) * Angle.RADIANS_TO_DEGREES\n            });\n        }\n\n        angles = angles.filter(el => {\n            if (el.angle < 170 || el.angle > 190) {\n                return true;\n            }\n            return false;\n        });\n\n        /*var p0 = points[angles[0].index];\n        var p1 = points[angles[1].index];\n        var p2 = points[angles[2].index];\n        var p3 = points[angles[3].index];*/\n\n        var p0 = {x: points[angles[0].index * 2], y: points[angles[0].index * 2 + 1], index: angles[0].index};\n        var p1 = {x: points[angles[1].index * 2], y: points[angles[1].index * 2 + 1], index: angles[1].index};\n        var p2 = {x: points[angles[2].index * 2], y: points[angles[2].index * 2 + 1], index: angles[2].index};\n        var p3 = {x: points[angles[3].index * 2], y: points[angles[3].index * 2 + 1], index: angles[3].index};\n\n       /* p0.index = angles[0].index;\n        p1.index = angles[1].index;\n        p2.index = angles[2].index;\n        p3.index = angles[3].index;*/\n\n        //const corners = this.reindexCorners([p0, p1, p2, p3]);\n        const corners = this.findWhichCorners([p0, p1, p2, p3]);\n        const topLeftIndex = corners[0].index;\n\n        /*const newPoints = [];\n        const topLeftIndex = corners[0].index;\n        for (i = topLeftIndex; i < points.length + topLeftIndex; i++) {\n            newPoints.push(points[i % points.length]);\n        }*/\n\n        var anglesMap = angles.reduce((map, el) => {\n            var type = '';\n            var i = corners.findIndex(c => c.index === el.index);\n            if (wo === 'CW') {\n                if (i === 0) {\n                    type = 'tl';\n                }\n                else if (i === 1) {\n                    type = 'tr';\n                }\n                else if (i === 2) {\n                    type = 'br';\n                }\n                else if (i === 3) {\n                    type = 'bl';\n                }\n            }\n            else {\n                if (i === 0) {\n                    type = 'tl';\n                }\n                else if (i === 1) {\n                    type = 'bl';\n                }\n                else if (i === 2) {\n                    type = 'br';\n                }\n                else if (i === 3) {\n                    type = 'tr';\n                }\n            }\n            map[el.index] = type;\n            return map;\n        }, Object.create(null));\n\n        return {anglesMap, topLeftIndex};\n    }\n\n    findWhichCorners(corners) {\n        const userProps = this.userProperties;\n        if (userProps && userProps.identifier) {\n            var id = userProps.identifier;\n            //id = \"S3A_OL_1_ERR____20190110T190220_20190110T194614_20190110T211413_2634_040_113______SVL_O_NR_002.SEN3\"\n            if (id.indexOf('S3') === 0 && id.indexOf('OL_1_ERR___') !== -1) {\n                //these shapes span from pole to pole and became twisted in 2D\n                var geom = this._interiorGeometry[0];\n                var cornerLocations = corners.map(c => {\n                    var location = geom[c.index];\n                    return {latitude: location.latitude, longitude: location.longitude, index: c.index};\n                });\n                cornerLocations.sort((a, b) => a.latitude - b.latitude);\n                cornerLocations.length = 2;\n                var c0 = cornerLocations[0];\n                var c1 = cornerLocations[1];\n                if ((c0.longitude < 0 && c1.longitude > 0) ||\n                    (c0.longitude > 0 && c1.longitude < 0)) {\n                    cornerLocations.sort((a, b) => Math.abs(b.longitude) - Math.abs(a.longitude));\n                }\n                else {\n                    cornerLocations.sort((a, b) => Math.abs(a.longitude) - Math.abs(b.longitude));\n                }\n\n                var topLeftIndex = corners.findIndex(corner => corner.index === cornerLocations[0].index);\n                var newCorners;\n                if (topLeftIndex > 0) {\n                    newCorners = [];\n                    for (var i = topLeftIndex; i < corners.length + topLeftIndex; i++) {\n                        newCorners.push(corners[i % corners.length]);\n                    }\n                }\n\n                return newCorners || corners;\n            }\n        }\n\n        return this.reindexCorners(corners);\n    }\n\n    getCorners_old(points, bbox) {\n        if (this.isEqualPoints(points[0], points[points.length - 1])) {\n            points.pop();\n        }\n\n        if (points.length === 4) {\n            return this.reindexCorners(points);\n        }\n\n        bbox = bbox || this.getBbox(points);\n\n        var corners = [];\n        for (var i = 0; i < points.length - 1; i++) {\n            var point = points[i];\n            if (point.x === bbox.minX || point.x === bbox.maxX) {\n                corners.push(point);\n            }\n            else if (point.y === bbox.minY || point.y === bbox.maxY) {\n                corners.push(point);\n            }\n        }\n\n        if (corners.length < 4) {\n            return corners;\n        }\n\n        return this.reindexCorners(corners);\n    }\n\n    reindexCorners(corners) {\n        //return corners;\n\n        var topLeftIndex = -1;\n        var c = corners.slice();\n        c.sort((a, b) => b.y - a.y);\n        c.length = 2;\n        c.sort((a, b) => a.x - b.x);\n        topLeftIndex = c[0].index;\n        topLeftIndex = corners.findIndex(corner => corner.index === c[0].index);\n\n        //return topLeftIndex;\n\n        var newCorners;\n        if (topLeftIndex > 0) {\n            newCorners = [];\n            for (var i = topLeftIndex; i < corners.length + topLeftIndex; i++) {\n                newCorners.push(corners[i % corners.length]);\n            }\n        }\n\n        return newCorners || corners;\n    }\n\n    reindexCorners_old(corners) {\n        var topLeftIndex = -1;\n        var slope1 = this.getSlope(corners[0], corners[2]);\n        if (slope1 > 0) {\n            if (corners[0].y < corners[2].y) {\n                topLeftIndex = 0;\n            }\n            else {\n                topLeftIndex = 2;\n            }\n        }\n        var slope2 = this.getSlope(corners[1], corners[3]);\n        if (slope2 > 0) {\n            if (corners[1].y < corners[3].y) {\n                if (topLeftIndex !== -1) {\n                    console.error('slope method is not ok 1');\n                }\n                topLeftIndex = 1;\n            }\n            else {\n                if (topLeftIndex !== -1) {\n                    console.error('slope method is not ok 2');\n                }\n                topLeftIndex = 3;\n            }\n        }\n\n        if (topLeftIndex === -1) {\n            console.error('slope method could not determine topLeft');\n        }\n\n        var newCorners;\n        if (topLeftIndex > 0) {\n            newCorners = [];\n            for (var i = topLeftIndex; i < corners.length + topLeftIndex; i++) {\n                newCorners.push(corners[i % corners.length]);\n            }\n        }\n\n        return newCorners || corners;\n    }\n\n    isEqualPoints(p1, p2) {\n        return (\n            p1.x === p2.x &&\n            p1.y === p2.y\n        );\n    }\n\n    windingOrder(corners) {\n        const e0 = (corners[1].x - corners[0].x) * (corners[1].y + corners[0].y);\n        const e1 = (corners[2].x - corners[1].x) * (corners[2].y + corners[1].y);\n        const e2 = (corners[3].x - corners[2].x) * (corners[3].y + corners[2].y);\n        const e3 = (corners[0].x - corners[3].x) * (corners[0].y + corners[3].y);\n        const sum = e0 + e1 + e2 + e3;\n        if (sum < 0) {\n            return 'CCW';\n        }\n        return 'CW';\n    }\n\n    windingOrder_all(list) {\n        let sum = 0;\n        for (let i = 0; i < list.length - 2; i += 2) {\n            let i1 = (i + 2) % list.length;\n            let i0 = i % list.length;\n            let p1x = list[i1];\n            let p1y = list[i1 + 1];\n            let p0x = list[i0];\n            let p0y = list[i0 + 1];\n            sum += ((p1x - p0x) * (p1y + p0y));\n        }\n        if (sum < 0) {\n            return 'CCW';\n        }\n        return 'CW';\n    }\n\n    getSlope(p1, p2) {\n        return (p1.y - p2.y) / (p1.x - p2.x);\n    }\n\n    distance2D(p1, p2) {\n        var dx = p2.x - p1.x;\n        var dy = p2.y - p1.y;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n\n}\n\nvar a = [\n    {latitude: -71.0573, longitude: -119.968}, //TL\n    {latitude: -79.6085, longitude: -149.754}, //TR\n    {latitude: 55.7391, longitude: 27.7961}, //BR\n    {latitude: 58.487, longitude: 6.61523}, //BL\n];\n\nvar b = [\n    {latitude: -70.6695, longitude: -54.5441}, //TL\n    {latitude: -79.8964, longitude: -85.1012}, //TR\n    {latitude: 55.9681, longitude: 91.5418}, //BR\n    {latitude: 58.7238, longitude: 70.2286}, //BL\n];","import TexturedSurfaceShape from './TexturedSurfaceShape';\n\nexport default class TexturedSurfacePolygon extends TexturedSurfaceShape {\n\n    static staticStateKey(shape) {\n        return TexturedSurfaceShape.staticStateKey(shape);\n    }\n\n    constructor(boundaries, attributes) {\n        super(attributes);\n\n        if (!Array.isArray(boundaries)) {\n            throw new Error('TexturedSurfacePolygon - constructor - The specified boundary is not an array.');\n\n        }\n\n        //this._boundaries = boundaries;\n        this._boundaries = this.removeDuplicateLocations(boundaries);\n    }\n\n    get boundaries() {\n        return this._boundaries;\n    }\n\n    set boundaries(boundaries) {\n        if (!Array.isArray(boundaries)) {\n            throw new Error('TexturedSurfacePolygon - set boundaries - The specified boundary is not an array.');\n        }\n        //this._boundaries = boundaries;\n        this._boundaries = this.removeDuplicateLocations(boundaries);\n        this.isPrepared = false;\n        this.stateKeyInvalid = true;\n    }\n\n    removeDuplicateLocations(boundaries) {\n        if (Array.isArray(boundaries[0])) {\n            const newBoundaries = [];\n            for (var i = 0; i < boundaries.length; i++) {\n                var contour = this.removeDuplicateLocationsFromContour(boundaries[i]);\n                newBoundaries.push(contour);\n            }\n            return newBoundaries;\n        }\n        else {\n            return this.removeDuplicateLocationsFromContour(boundaries);\n        }\n    }\n\n    removeDuplicateLocationsFromContour(contour) {\n        const newBoundaries = [];\n\n        for (var i = 0; i < contour.length - 1; i++) {\n            var loc = contour[i];\n            newBoundaries.push(loc);\n            for (var j = i + 1; j < contour.length; j++) {\n                var loc2 = contour[j];\n                if (loc.latitude !== loc2.latitude || loc.longitude !== loc2.longitude) {\n                    break;\n                }\n                i++;\n            }\n        }\n\n        return newBoundaries;\n    }\n\n    computeStateKey() {\n        return TexturedSurfacePolygon.staticStateKey(this);\n    }\n\n}","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nimport KMLWorker from './utils/KML.worker'\nimport {AcquisitionPlansParser} from './utils/AcquisitionPlansParser'\nimport TexturedSurfacePolygon from \"../../worldwind/textured/TexturedSurfacePolygon\";\n\nconst {\n    RenderableLayer,\n} = WorldWind;\n\nconst {\n    Workers,\n    AcquisitionPlans,\n} = WordWindX;\n\nconst satNames = ['s1a', 's1b', 's2a', 's2b'];\nconst numWorkers = Workers.getCoreCount();\nconst workers = new Workers(KMLWorker, numWorkers);\nconst acquisitionPlans = new AcquisitionPlans(satNames, workers);\nacquisitionPlans.parser = new AcquisitionPlansParser(workers);\nacquisitionPlans.parser.InteriorCtor = TexturedSurfacePolygon;\n\n/**\n * \n * @param {string} dateString - Datestring like 20190430 with fixed width.\n */\nconst getDate = (dateString) => {\n    return new Date(`${dateString.substr(0,4)}-${dateString.substr(4,2)}-${dateString.substr(6,2)}`);\n}\n\nconst filterPlansByUrl = (plans, cachedPlans) => {\n    return plans.filter((plan) => {\n        return !cachedPlans.some(cachedPlan => cachedPlan.url === plan.url);\n    })\n}\n\nconst generateId = () => {\n    return window.crypto.getRandomValues(new Uint32Array(1))[0];\n}\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer can render only one model of satellite. It`s possible to set position data of model.\n * @param options {Object}\n * @param options.key {String}\n * @param options.satName {String}\n * @param options.time {Date} Time of the satellite.\n * @param options.range {number} Renge in milliseconds. Default is 90 minutes.\n * @param options.onLayerChanged {func}\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass AcquisitionPlanLayer extends RenderableLayer {\n\tconstructor(options) {\n        super(options);\n        this._rerenderMap = null;\n        this.key = options.key;\n        this.satName = options.satName;\n        this.plans = null;\n        this.onLayerChanged = options.onLayerChanged || null;\n        this.time = options.time || new Date();\n\n        this.range = options.range || 90 * 60 * 1000; \n        this.loading = new Set();\n    };\n\n\tasync setPlans(plans, startDate, endDate) {\n        this.plans = plans;\n        this.update();\n    }\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    setTime(time) {\n        if(time) {\n            this.time = time;\n            this.update();\n        }\n    }\n\n\n\n    async getFootprints(range) {\n        const updateId = generateId();\n\n        //filter plans by acquisitionPlans.cache\n        \n        const startDate = new Date(this.time.getTime() - range)\n        const endDate = new Date(this.time.getTime() + range)\n        // await Promise.all(this.plans.map(plan => acquisitionPlans.parse({...plan, filterDate: startDate.toISOString()}).catch((err) => {console.error(err)})));\n        const filteredPlans = filterPlansByUrl(this.plans, acquisitionPlans.cache[this.satName]);\n\n        //if already loading, then remove from plans\n        const unloadedPlans = filteredPlans.filter(plan => ![...this.loading].some((pHash) => `${pHash.split('.kml_')[0]}.kml` === plan.url));\n\n        //add loading urls\n        filteredPlans.forEach(plan => this.loading.add(`${plan.url}_${updateId}`));\n\n        //dont filter in cache\n        if(typeof this.onLayerChanged === 'function') {\n            this.onLayerChanged({\n                satKey: this.satName,\n                layerKey: this.key\n            }, {update: {loading: true}, plans: unloadedPlans.map(p => p.url), sat: this.satName});\n        }\n        await Promise.all(unloadedPlans.map(plan => acquisitionPlans.parse({...plan, filterDate: getDate(plan.start).toISOString()}).catch((err) => {console.error(err)})));\n        if(typeof this.onLayerChanged === 'function') {\n            this.onLayerChanged({\n                satKey: this.satName,\n                layerKey: this.key\n            }, {update: {loading: false}, plans: unloadedPlans.map(p => p.url), sat: this.satName});\n        }\n\n        //remove loading urls\n        filteredPlans.forEach(plan => this.loading.delete(`${plan.url}_${updateId}`));\n\n        acquisitionPlans.terminateWorkers();\n        return acquisitionPlans.getFootprints({ satName: this.satName, startDate , endDate });\n    }\n\n    async update() {\n        this.removeAllRenderables();\n        this.doRerender();\n        const { interiors, outlines } = await this.getFootprints(this.range);\n\n        if(typeof this.onLayerChanged === 'function') {\n            this.onLayerChanged({\n                satKey: this.satName,\n                layerKey: this.key\n            }, {count: outlines.length, sat: this.satName});\n        }\n\n        this.addRenderables(interiors);\n        this.addRenderables(outlines);\n        this.doRerender();\n    }\n\n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n\t}\n}\n\nexport default AcquisitionPlanLayer;\n\n","import WorldWind from 'webworldwind-esa';\nimport chroma from 'chroma-js';\nconst {\n    Color\n} = WorldWind;\n\n/**\n * It represents the distribution for one creation of Choropleth.\n * @param options {Object}\n * @param options.opacity {Number} Number between 0 and 100\n * @param options.max {Number} Maximum amount represented in the Choropleth.\n * @param options.palettes {ColorPalette}\n * @constructor\n */\nclass Distribution {\n    constructor(options) {\n        this._hexs = this.prepareClasses(options.palettes, options.max, options.opacity, true);\n    }\n\n    /**\n     * It should prepare available color classes based on the currently selected color palette, maximum amount which\n     * might scale down the number of classes and alpha representing the opacity of the color.\n     * @param palette {Object}\n     * @param max {Number} Represents maximum in current choropleth. Mainly to allow scaling down if it too low.\n     * @param alpha {Number} 0 - 100 represents opacity in percents\n     * @param isHex\n     */\n    prepareClasses(palette, max, alpha, isHex) {\n        let amountOfClasses = max < 17 ? max : 17;\n        this.oneLevel = max / amountOfClasses;\n\n        let colors = chroma.scale(palette.colors).colors(amountOfClasses);\n        return colors.map(function (color) {\n            if (!isHex) {\n                let rgb = chroma(color).rgb();\n                return new Color(rgb[0] / 255, rgb[1] / 255, rgb[2] / 255, alpha);\n            } else {\n                return chroma(color).hex();\n            }\n        });\n    }\n}\n\nexport default Distribution;","import WorldWind from 'webworldwind-esa';\nconst {\n    TiledImageLayer,\n    Sector,\n    Location,\n    TriangleMesh,\n    WWUtil,\n    ShapeAttributes,\n    Position\n} = WorldWind;\n\n/**\n * It should display hexagonal and partially transparent.\n * @param options {Object}\n * @param options.products {Object[]} Collection of products.\n * @param options.name {String} Name of the layer.\n * @param options.max {Number} Maximum amount of products. In this case we should use it as 100%. Based on this we will\n *  adapt the extruded polygons.\n * @constructor\n */\nclass Extruded extends TiledImageLayer {\n    constructor(options) {\n        super(new Sector(-90, 90, -180, 180), new Location(22.5 / 2, 22.5 / 2), 12, 'image/png', 'Extruded' + WWUtil.guid(), 256, 256);\n\n        let data = {};\n        let lat, lon;\n        for (lat = -90; lat <= 90; lat++) {\n            data[lat] = {};\n            for (lon = -180; lon <= 180; lon++) {\n                data[lat][lon] = [];\n            }\n        }\n\n        let latitude, longitude;\n        options.products.forEach(function (product) {\n            latitude = Math.floor(product.latitude);\n            longitude = Math.floor(product.longitude);\n            data[latitude][longitude].push(product);\n        });\n        this._data = data;\n\n        this.polygons = {};\n\n        let result = document.createElement('canvas');\n        result.height = 256;\n        result.width = 256;\n        \n        let ctx = result.getContext('2d');\n        ctx.globalAlpha = 0;\n        ctx.fillRect(0,0,256,256);\n        ctx.globalAlpha = 1.0;\n\n        this.transparentImage = result;\n\n        this.imagery = null;\n    }\n\n    filterGeographically(data, sector) {\n        let minLatitude = Math.floor(sector.minLatitude);\n        let maxLatitude = Math.floor(sector.maxLatitude);\n        let minLongitude = Math.floor(sector.minLongitude);\n        let maxLongitude = Math.floor(sector.maxLongitude);\n\n        if (minLatitude <= -90) {\n            minLatitude = -90;\n        }\n        if (maxLatitude >= 90) {\n            maxLatitude = 90;\n        }\n\n        if (minLongitude <= -180) {\n            minLongitude = -180;\n        }\n        if (maxLongitude >= 180) {\n            maxLongitude = 180;\n        }\n\n        let aggregatedMissions = {};\n        let lat, lon;\n        for (lat = minLatitude; lat <= maxLatitude; lat++) {\n            for (lon = minLongitude; lon <= maxLongitude; lon++) {\n                data[lat][lon].forEach(function (product) {\n                    if (sector.containsLocation(product.latitude, product.longitude)) {\n                        if(!aggregatedMissions[product.mission.mission]){\n                            aggregatedMissions[product.mission.mission] = {\n                                amount: 0,\n                                color: product.mission.color\n                            };\n                        }\n\n                        aggregatedMissions[product.mission.mission].amount += product.amount;\n                    }\n                });\n            }\n        }\n\n        return aggregatedMissions;\n    }\n\n    assemblePolygonsForTile(tile){\n        let dataForDrawingPolygons = this.filterGeographically(this._data, tile.sector);\n        let missions = Object.keys(dataForDrawingPolygons); // Missions to draw.\n\n        let currentAltitude = 0;\n\n        let extentSizeLatitude = (tile.sector.maxLatitude - tile.sector.minLatitude) / 5;\n        let extentSizeLongitude = (tile.sector.maxLongitude - tile.sector.minLongitude) / 5;\n\n        missions.sort();\n        let results = [];\n        missions.forEach((mission) => {\n            let normalizedAmount = Math.sqrt(dataForDrawingPolygons[mission].amount) * 20000;\n            let shapeAttributes = new ShapeAttributes();\n            let interiorColor = dataForDrawingPolygons[mission].color.clone();\n            interiorColor.alpha = 0.6;\n            shapeAttributes.interiorColor = interiorColor;\n            shapeAttributes.outlineColor = dataForDrawingPolygons[mission].color;\n            shapeAttributes.drawInterior = true;\n            shapeAttributes.drawOutline = true;\n            // How do I make outlines?\n\n            let center1 = new Position(tile.sector.minLatitude + (2.5 * extentSizeLatitude), tile.sector.minLongitude + (2.5 * extentSizeLongitude), currentAltitude),\n                a1 = new Position(tile.sector.minLatitude + (3 * extentSizeLatitude), tile.sector.minLongitude + (2.33 * extentSizeLongitude), currentAltitude),\n                b1 = new Position(tile.sector.minLatitude + (3 * extentSizeLatitude), tile.sector.minLongitude + (2.66 * extentSizeLongitude), currentAltitude),\n                c1 = new Position(tile.sector.minLatitude + (2.66 * extentSizeLatitude), tile.sector.minLongitude + (3 * extentSizeLongitude), currentAltitude),\n                d1 = new Position(tile.sector.minLatitude + (2.33 * extentSizeLatitude), tile.sector.minLongitude + (3 * extentSizeLongitude), currentAltitude),\n                e1 = new Position(tile.sector.minLatitude + (2 * extentSizeLatitude), tile.sector.minLongitude + (2.66 * extentSizeLongitude), currentAltitude),\n                f1 = new Position(tile.sector.minLatitude + (2 * extentSizeLatitude), tile.sector.minLongitude + (2.33 * extentSizeLongitude), currentAltitude),\n                g1 = new Position(tile.sector.minLatitude + (2.33 * extentSizeLatitude), tile.sector.minLongitude + (2 * extentSizeLongitude), currentAltitude),\n                h1 = new Position(tile.sector.minLatitude + (2.66 * extentSizeLatitude), tile.sector.minLongitude + (2 * extentSizeLongitude), currentAltitude),\n\n                center2 = new Position(tile.sector.minLatitude + (2.5 * extentSizeLatitude), tile.sector.minLongitude + (2.5 * extentSizeLongitude), currentAltitude + normalizedAmount),\n                a2 = new Position(tile.sector.minLatitude + (3 * extentSizeLatitude), tile.sector.minLongitude + (2.33 * extentSizeLongitude), currentAltitude + normalizedAmount),\n                b2 = new Position(tile.sector.minLatitude + (3 * extentSizeLatitude), tile.sector.minLongitude + (2.66 * extentSizeLongitude), currentAltitude + normalizedAmount),\n                c2 = new Position(tile.sector.minLatitude + (2.66 * extentSizeLatitude), tile.sector.minLongitude + (3 * extentSizeLongitude), currentAltitude + normalizedAmount),\n                d2 = new Position(tile.sector.minLatitude + (2.33 * extentSizeLatitude), tile.sector.minLongitude + (3 * extentSizeLongitude), currentAltitude + normalizedAmount),\n                e2 = new Position(tile.sector.minLatitude + (2 * extentSizeLatitude), tile.sector.minLongitude + (2.66 * extentSizeLongitude), currentAltitude + normalizedAmount),\n                f2 = new Position(tile.sector.minLatitude + (2 * extentSizeLatitude), tile.sector.minLongitude + (2.33 * extentSizeLongitude), currentAltitude + normalizedAmount),\n                g2 = new Position(tile.sector.minLatitude + (2.33 * extentSizeLatitude), tile.sector.minLongitude + (2 * extentSizeLongitude), currentAltitude + normalizedAmount),\n                h2 = new Position(tile.sector.minLatitude + (2.66 * extentSizeLatitude), tile.sector.minLongitude + (2 * extentSizeLongitude), currentAltitude + normalizedAmount);\n\n            // Create Triangle Mesh instead of the polygon.\n            let vertices = [\n                center2, a2, b2, c2, d2, e2, f2, g2, h2,\n                center1, a1, b1, c1, d1, e1, f1, g1, h1\n            ];\n            let indices = [\n                0, 1, 2,\n                0, 2, 3,\n                0, 3, 4,\n                0, 4, 5,\n                0, 5, 6,\n                0, 6, 7,\n                0, 7, 8,\n                0, 8, 1,\n\n                9, 10, 11,\n                9, 11, 12,\n                9, 12, 13,\n                9, 13, 14,\n                9, 14, 15,\n                9, 15, 16,\n                9, 16, 17,\n                9, 17, 10,\n\n                2, 1, 10,\n                2, 10, 11,\n\n                3, 2, 11,\n                3, 11, 12,\n\n                4, 3, 12,\n                4, 12, 13,\n\n                5, 4, 13,\n                5, 13, 14,\n\n                6, 5, 14,\n                6, 14, 15,\n\n                7, 6, 15,\n                7, 15, 16,\n\n                8, 7, 16,\n                8, 16, 17,\n\n                1, 8, 17,\n                1, 17, 10\n            ];\n            let mesh = new TriangleMesh(vertices, indices, shapeAttributes);\n            mesh.outlineIndices = [\n                1, 2, 11, 10, 11,\n                2, 3, 12, 11, 12,\n                3, 4, 13, 12, 13,\n                4, 5, 14, 13, 14,\n                5, 6, 15, 14, 15,\n                6, 7, 16, 15, 16,\n                7, 8, 17, 16, 17,\n                10, 1, 8\n            ];\n\n            currentAltitude += normalizedAmount;\n            results.push(mesh);\n        });\n\n        return results;\n    }\n\n    /**\n     * In this case instead of actually drawing imagery it renders the polygons associated with relevant tiles.\n     * @param dc {DrawContext}\n     * @param tile {Tile} Tile to be generated.\n     */\n    retrieveTileImage(dc, tile) {\n        if(!this.polygons[tile.imagePath]) {\n            this.polygons[tile.imagePath] = this.assemblePolygonsForTile(tile);\n        }\n\n        let imagePath = tile.imagePath;\n        let cache = dc.gpuResourceCache;\n        let layer = this;\n\n        let texture = layer.createTexture(dc, tile, this.transparentImage);\n        layer.removeFromCurrentRetrievals(imagePath);\n\n        if (texture) {\n            cache.putResource(imagePath, texture, texture.size);\n\n            layer.currentTilesInvalid = true;\n            layer.absentResourceList.unmarkResourceAbsent(imagePath);\n        }\n    }\n}\n\nexport default Extruded;","export default {\n    apiUrl: 'https://eoapps.solenix.ch/stats/',\n    missions: 'missions.json',\n    missionTemplate: '{{mission}}/{{year}}/{{month}}.json'\n};","import config from './config';\nimport moment from 'moment';\nimport WorldWind from 'webworldwind-esa';\nconst {\n    Logger\n} = WorldWind;\n\n\n/**\n * Store containing all already received products. These products are stored for further usage in the Cache.\n * @constructor\n * @augments BaseStore\n */\nclass Products {\n    constructor() {\n        this._url = config.apiUrl + config.missionTemplate;\n        this._cache = {};\n    }\n\n    /**\n     * Retrieve all products valid for certain combination of mission, instrument, year and month.\n     * @param mission {String} Code of the mission\n     * @param year {String} Year of the acquisition\n     * @param month {String} Month of the acquisition\n     * @param color {Color} Color used to display the information in extruded version.\n     */\n    retrieve(mission, year, month, color) {\n        Logger.logMessage(Logger.LEVEL_INFO, 'Products', 'retrieve', `Retrieve products for mission ${mission} on ${year}-${month}`);\n        if (this._cache[mission] && this._cache[mission][year] && this._cache[mission][year][month]) {\n            Logger.logMessage(Logger.LEVEL_INFO, 'Products', 'retrieve', `Retrieved ${this._cache[mission][year][month].length}} of products from cache`);\n\n            return Promise.resolve(this._cache[mission][year][month]);\n        }\n\n        this.prepareCache(mission, year);\n\n        let url = `${config.apiUrl}${mission}/${year}/${month}.json`;\n        let self = this;\n        return this.ajax(url, {responseType: 'json'}).then(content => {\n            let models = self.parseProductsFromRemote(content, {mission: mission, color: color}); // The mission should already contain the color of the mission.\n            Logger.logMessage(Logger.LEVEL_INFO, 'Products', 'retrieve', `Caching ${models.length} of products  for ${mission} on ${year}-${month}`);\n\n            self._cache[mission][year][month] = models;\n\n            return models;\n        }).catch(() => {\n            Logger.logMessage(Logger.LEVEL_INFO, 'Products', 'retrieve', `No models available for ${mission} on ${year}-${month}`);\n\n            return [];\n        });\n    }\n\n    /**\n     * Parses products received from the Remote API into models we internally understand.\n     * @param content {String} JSON response from the server containing the products.\n     * @param mission {Object} Mission name and  Color used to display the information in extruded version.\n     * @returns {AggregatedProduct[]} Information about amount of products acquired on given location.\n     * @private\n     */\n    parseProductsFromRemote(content, mission) {\n        let products = content.boxes;\n        Logger.logMessage(Logger.LEVEL_INFO, 'Products', 'retrieve', 'Retrieved ' + products.length + ' of products' +\n            ' from remote API. ');\n\n        let models = [];\n        products.forEach(function (product) {\n            models.push({\n                latitude: (Number(product.bbox2Lat) + Number(product.bbox1Lat)) / 2,\n                longitude: (Number(product.bbox2Lon) + Number(product.bbox1Lon)) / 2,\n                mission: mission,\n                amount: Number(product.amount),\n                acquisitionMoment: moment(product.year + '-' + product.month)\n            });\n        });\n\n        return models;\n    }\n\n    prepareCache(mission, year) {\n        if (!this._cache[mission]) {\n            this._cache[mission] = [];\n        }\n        if (!this._cache[mission][year]) {\n            this._cache[mission][year] = [];\n        }\n    }\n\n    ajax(url, options) {\n        return new Promise(function (resolve, reject) {\n            let xhr = new XMLHttpRequest();\n\n            xhr.open('GET', url, true);\n            if (options.responseType) {\n                xhr.responseType = options.responseType;\n            }\n            xhr.onreadystatechange = (function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        resolve(this.response);\n                    }\n                    else {\n                        Logger.log(Logger.LEVEL_WARNING,\n                            'File retrieval failed (' + xhr.statusText + '): ' + url);\n                        reject();\n                    }\n                }\n            });\n\n            xhr.onerror = (function () {\n                Logger.log(Logger.LEVEL_WARNING, 'Remote file retrieval failed: ' + url);\n\n                reject();\n            }).bind(this);\n\n            xhr.ontimeout = (function () {\n                Logger.log(Logger.LEVEL_WARNING, 'Remote file retrieval timed out: ' + url);\n\n                reject();\n            }).bind(this);\n\n            xhr.send(null);\n        });\n    }\n}\n\nexport default Products;","/*\n * Copyright 2015-2018 WorldWind Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * It represents one tile in the HeatMap information. It is basically an interface specifying the public methods\n * properties and default configuration. The logic itself is handled in the subclasses.\n * @alias HeatMapTile\n * @constructor\n * @param data {Object[]} Array of information constituting points in the map.\n * @param options {Object}\n * @param options.sector {Sector} Sector with the geographical information for tile representation.\n * @param options.width {Number} Width of the Canvas to be created in pixels.\n * @param options.height {Number} Height of the Canvas to be created in pixels.\n * @param options.radius {Number} Radius of the data point in pixels.\n * @param options.incrementPerIntensity {Number}\n */\nvar HeatMapTile = function(data, options) {\n    this._data = data;\n\n    this._sector = options.sector;\n\n    this._canvas = this.createCanvas(options.width, options.height);\n    this._width = options.width;\n    this._height = options.height;\n\n    this._radius = options.radius;\n\n    this._incrementPerIntensity = options.incrementPerIntensity;\n};\n\n/**\n * It returns the drawn HeatMapTile in the form of URL.\n * @return {String} Data URL of the tile.\n */\nHeatMapTile.prototype.url = function() {\n    return this.draw().toDataURL();\n};\n\n/**\n * It returns the whole Canvas. It is then possible to use for further uses. This one is actually used in the\n * HeatMapLayer mechanism so if you want to provide some custom implementation of Canvas creation in your tile,\n * change this method.\n * @return {HTMLCanvasElement} Canvas Element representing the drawn tile.\n */\nHeatMapTile.prototype.canvas = function() {\n    return this.draw();\n};\n\n/**\n * It draws the shapes on the canvas.\n * @protected\n * @returns {HTMLCanvasElement}\n */\nHeatMapTile.prototype.draw = function() {\n    var shape = this.shape();\n\n    var ctx = this._canvas.getContext('2d');\n    ctx.clearRect(0,0, this._width, this._height);\n\n    for(var i = 0; i < this._data.length; i++) {\n        var location = this._data[i];\n        // Get the location in pixels and draw the image.\n        ctx.globalAlpha = location.measure * this._incrementPerIntensity;\n        ctx.drawImage(shape, this.longitudeInSector(location, this._sector, this._width), this._height - this.latitudeInSector(location, this._sector, this._height));\n    }\n\n    return this._canvas;\n};\n\n/**\n * It creates canvas element of given size.\n * @protected\n * @param width {Number} Width of the canvas in pixels\n * @param height {Number} Height of the canvas in pixels\n * @returns {HTMLCanvasElement} Created the canvas\n */\nHeatMapTile.prototype.createCanvas = function(width, height) {\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n\n    return canvas;\n};\n\n/**\n * It creates a canvas containing the circle of the right size. THe default shape is circle, but subclasses can\n * change this behavior.\n * @protected\n * @returns {HTMLCanvasElement} Canvas representing the circle.\n */\nHeatMapTile.prototype.shape = function() {\n    var shape = this.createCanvas(this._width, this._height),\n        ctx = shape.getContext('2d'),\n        r2 = this._radius + this._radius;\n\n    shape.width = shape.height = r2;\n\n    var gradient = ctx.createRadialGradient(this._radius, this._radius, 0, this._radius, this._radius, this._radius);\n    gradient.addColorStop(0, \"rgba(0,0,0,1)\");\n    gradient.addColorStop(1, \"rgba(0,0,0,0)\");\n\n    ctx.beginPath();\n    ctx.arc(this._radius, this._radius, this._radius, 0, Math.PI * 2, true);\n\n    ctx.fillStyle = gradient;\n    ctx.fill();\n\n    ctx.closePath();\n\n    return shape;\n};\n\n/**\n * It calculates position in pixels of the point based on its latitude.\n * @param location {Location} Location to transform\n * @param sector {Sector} Sector to which transform\n * @param height {Number} Height of the tile to draw to.\n * @private\n * @returns {number} Position on the height in pixels. THe result needs to start with 0\n */\nHeatMapTile.prototype.latitudeInSector = function(location, sector, height) {\n    // Percentage of the available space.\n    var sizeOfArea = sector.maxLatitude - sector.minLatitude;\n    var locationInArea = location.latitude - sector.minLatitude;\n    return Math.ceil((locationInArea / sizeOfArea) * (height - 1));\n};\n\n/**\n * @param location {Location} Location to transform\n * @param sector {Sector} Sector to which transform\n * @param width {Number} Height of the tile to draw to.\n * @returns {number}\n */\nHeatMapTile.prototype.longitudeInSector = function(location, sector, width) {\n    var sizeOfArea = sector.maxLongitude - sector.minLongitude ;\n    var locationInArea = location.longitude - sector.minLongitude;\n    return Math.ceil((locationInArea / sizeOfArea) * (width - 1));\n};\n\nexport default HeatMapTile;","/*\n * Copyright 2003-2006, 2009, 2017, United States Government, as represented by the Administrator of the\n * National Aeronautics and Space Administration. All rights reserved.\n *\n * The NASAWorldWind/WebWorldWind platform is licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport HeatMapTile from './HeatMapTile';\n\n/**\n * Constructs a HeatMapColoredTile.\n *\n * The default implementation using the shades of gray to draw the information produced by the HeatMapTile is a source\n * for coloring. This class colours the provided canvas based on the information contained in the intensityGradient.\n *\n *  @inheritDoc\n *\n * @alias HeatMapColoredTile\n * @constructor\n * @augments HeatMapTile\n * @classdesc Tile for the HeatMap layer visualising data on a canvas using colour scale.\n * @param options.intensityGradient {Object} Keys represent the opacity between 0 and 1 and the values represent\n *  color strings.\n *  @param options.extendedWidth {Number} Optional. Minimal width that needs to be retrieved for colorization.\n *  @param options.extendedHeight {Number} Optional. Minimal height that needs to be retrieved for colorization.\n *  @param options.opacity {Number} Optional. The opacity applied to the calculated colors. The opacity is between \n *      0 (fully transparent) and 1 (fully opaque). The default value is 1.\n */\nvar HeatMapColoredTile = function (data, options) {\n    HeatMapTile.call(this, data, options);\n\n    this._extendedWidth = options.extendedWidth;\n    this._extendedHeight = options.extendedHeight;\n    this._gradient = this.gradient(options.intensityGradient);\n    this._opacity = options.opacity * 255 || 1;\n};\n\nHeatMapColoredTile.prototype = Object.create(HeatMapTile.prototype);\n\n/**\n * The coloured version colorizes only the cropped area relevant for the display. The rest is ignored.\n */\nHeatMapColoredTile.prototype.draw = function () {\n    var canvas = HeatMapTile.prototype.draw.call(this);\n\n    var ctx = canvas.getContext('2d');\n\n    var top = 0;\n    var left = 0;\n    var width = this._width;\n    var height = this._height;\n    if (this._extendedHeight) {\n        top = this._extendedHeight;\n        height = this._height - (2 * this._extendedHeight);\n    }\n    if (this._extendedWidth) {\n        left = this._extendedWidth;\n        width = this._width - (2 * this._extendedWidth);\n    }\n\n    var colored = ctx.getImageData(top, left, width, height);\n    this.colorize(colored.data, this._gradient);\n    ctx.putImageData(colored, top, left);\n\n    return canvas;\n};\n\n/**\n * Creates one pixel height gradient based on the provided intensity gradient. The gradient is drawn on the small\n * canvas, from which the resulting data are retrieved.\n * @private\n * @param intensityGradient {Object}  Gradient of colours used to draw the points. The keys represents percentage\n *  for start of given color, which is value of the object.\n * @returns {Uint8ClampedArray} Array of the gradient colours representing the full range relevant for this tile.\n */\nHeatMapColoredTile.prototype.gradient = function (intensityGradient) {\n    // create a 256x1 gradient that we'll use to turn a grayscale heatmap into a colored one\n    var canvas = this.createCanvas(1, 256),\n        ctx = canvas.getContext('2d'),\n        gradient = ctx.createLinearGradient(0, 0, 0, 256);\n\n    for (var i in intensityGradient) {\n        gradient.addColorStop(+i, intensityGradient[i]);\n    }\n\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, 0, 1, 256);\n\n    return ctx.getImageData(0, 0, 1, 256).data;\n};\n\n/**\n * Colorizes all the relevant pixels based on the values from the linear gradient. The colour is applied directly\n * to the pixels by changing them.\n * @private\n * @param pixels {Uint8ClampedArray} The pixels to colorize in the format retrieved from canvas.\n * @param gradient {Uint8ClampedArray} The pixels used as the source of the colors for the data pixels. The colors\n *  are applied based on the opacity (blackness) of given pixel.\n */\nHeatMapColoredTile.prototype.colorize = function (pixels, gradient) {\n    for (var i = 0, len = pixels.length, j; i < len; i += 4) {\n        j = pixels[i + 3] * 4;\n\n        if (j) {\n            pixels[i] = gradient[j];\n            pixels[i + 1] = gradient[j + 1];\n            pixels[i + 2] = gradient[j + 2];\n            pixels[i + 3] = this._opacity;\n        }\n    }\n\n};\n\nexport default HeatMapColoredTile;","/*\n * Copyright 2003-2006, 2009, 2017, United States Government, as represented by the Administrator of the\n * National Aeronautics and Space Administration. All rights reserved.\n *\n * The NASAWorldWind/WebWorldWind platform is licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport HeatMapColoredTile from './HeatMapColoredTile';\nimport HeatMapTile from './HeatMapTile';\n\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    HeatMapIntervalType,\n    Location,\n    MeasuredLocation,\n    TiledImageLayer,\n    Sector,\n    WWUtil\n} = WorldWind;\n\n/**\n * Constructs a HeatMap Layer.\n *\n * The default implementation uses gradient circles to display measured locations. The measure of the locations\n * define the colors of the gradient.\n *\n * @alias HeatMapLayer\n * @constructor\n * @augments TiledImageLayer\n * @classdesc A HeatMap layer for visualising an array of measured locations.\n * @param {String} displayName This layer's display name.\n * @param {MeasuredLocation[]} measuredLocations An array of locations with measures to visualise.\n * @param {Number} numLevels Optional. If provided it specifies the amount of levels that will be generated for\n *  this layer. If you have only one, it behaves in a similar way to the Analytical surface from the World Wind Java.\n *  If you have multiple levels then whenever the user zooms over certain threshold, the new version of the layer\n *  will be generated.\n */\nvar HeatMapLayer = function (displayName, measuredLocations, numLevels) {\n    this.tileWidth = 256;\n    this.tileHeight = 256;\n\n    TiledImageLayer.call(this, new Sector(-90, 90, -180, 180), new Location(45, 45), numLevels, 'image/png', 'HeatMap' + WWUtil.guid(), this.tileWidth, this.tileHeight);\n\n    this.displayName = displayName;\n\n    var data = {};\n    for (var lat = -90; lat <= 90; lat++) {\n        data[lat] = {};\n        for (var lon = -180; lon <= 180; lon++) {\n            data[lat][lon] = [];\n        }\n    }\n\n    var latitude, longitude;\n    var max = Number.MIN_VALUE;\n    measuredLocations.forEach(function (measured) {\n        latitude = Math.floor(measured.latitude);\n        longitude = Math.floor(measured.longitude);\n        measured.measure = Math.pow(measured.measure, 1 / 2);\n        data[latitude][longitude].push(measured);\n    });\n\n    var amountAtTile = 0;\n    for (var lat = -90; lat <= 90; lat++) {\n        for (var lon = -180; lon <= 180; lon++) {\n            amountAtTile = 0;\n            data[lat][lon].forEach(function(measured){\n                amountAtTile += measured.measure;\n            });\n            if(amountAtTile > max) {\n                max = amountAtTile;\n            }\n        }\n    }\n\n    this._data = data;\n    this._measuredLocations = measuredLocations;\n\n    this._intervalType = HeatMapIntervalType.CONTINUOUS;\n    this._scale = ['blue', 'cyan', 'lime', 'yellow', 'red'];\n    this._radius = 12.5;\n    this._incrementPerIntensity = 1 / max;\n    this._max = max;\n    this._opacity = 1;\n\n    this.setGradient(measuredLocations);\n};\n\nHeatMapLayer.prototype = Object.create(TiledImageLayer.prototype);\n\nObject.defineProperties(HeatMapLayer.prototype, {\n    /**\n     * Type of interval to apply between the minimum and maximum values in the data. Default value is CONTINUOUS.\n     * The supported values are CONTINUOUS and QUANTILES\n     * @memberof HeatMapLayer.prototype\n     * @type {HeatMapIntervalType}\n     */\n    intervalType: {\n        get: function () {\n            return this._intervalType;\n        },\n        set: function (intervalType) {\n            this._intervalType = intervalType;\n            this.setGradient();\n        }\n    },\n\n    /**\n     * Array of colors representing the scale used when generating the gradients.\n     * The default value is ['blue', 'cyan', 'lime', 'yellow', 'red'].\n     * @memberof HeatMapLayer.prototype\n     * @type {String[]}\n     */\n    scale: {\n        get: function () {\n            return this._scale;\n        },\n        set: function (scale) {\n            this._scale = scale;\n            this.setGradient();\n        }\n    },\n\n    /**\n     * Gradient of colours used to draw the points and derived from the scale, intervalType and the data. The colors\n     * are stored in an object, which has as keys the percentage from which the given color should be applied.\n     * The default object based on the default scale and intervalType (in case of CONTINUOUS the data are irrelevant):\n     * {\n     *     \"0\": \"blue\",\n     *     \"0.2\": \"cyan\",\n     *     \"0.4\": \"lime\",\n     *     \"o.6\": \"yellow\",\n     *     \"0.8\": \"red\"\n     * }\n     * @memberOf HeatMapLayer.prototype\n     * @type {Object}\n     */\n    gradient: {\n        get: function () {\n            return this._gradient;\n        }\n    },\n\n    /**\n     * Radius of a point in pixels. The default value is 12.5.\n     * @memberof HeatMapLayer.prototype\n     * @type {Number}\n     */\n    radius: {\n        get: function () {\n            return this._radius;\n        },\n        set: function (radius) {\n            this._radius = radius;\n        }\n    },\n\n    /**\n     * The final opacity of this layer. Number between 0 (Fully transparent)\n     * and 1 (Fully opaque). If the opacity isn't provided the final opacity \n     * will be 1.\n     * @memberof HeatMapLayer.prototype\n     * @type {Number}\n     */\n    opacity: {\n        get: function() {\n            return this._opacity;\n        },\n        set: function(opacity) {\n            this._opacity = opacity;\n        }\n    }\n});\n\n/**\n * Returns the relevant points for the visualisation for current sector. To retrieve the relevant points, the data\n * are stored in the two dimensional array representation of the geographic locations. The first index represents\n * latitude from -90 to 90. The second index represents longitude from -180 to 180.\n * For the sector pieces outside of the bounds of valid latitude and longitude, the array behaves as if it was\n * continuous in the longitudinal space of <-180,180> and clamped to the min, max value in case of latitudinal space.\n * @private\n * @param data {MeasuredLocation[][]} Two dimensional array covering the whole globe in WGS84 coordinates.\n * @param sector {Sector} Visible sector limiting the data to retrieve.\n * @returns {MeasuredLocation[]} Array of the Measured Locations relevant for given sector.\n */\nHeatMapLayer.prototype.filterGeographically = function (data, sector) {\n    var minLatitude = Math.floor(sector.minLatitude);\n    var maxLatitude = Math.floor(sector.maxLatitude);\n    var minLongitude = Math.floor(sector.minLongitude);\n    var maxLongitude = Math.floor(sector.maxLongitude);\n\n    var extraLongitudeBefore = 0, extraLongitudeAfter = 0;\n\n    // Clamp the latitude to <-90,90>\n    if (minLatitude <= -90) {\n        minLatitude = -90;\n    }\n    if (maxLatitude >= 90) {\n        maxLatitude = 90;\n    }\n\n    // Handle continuousness of the longitudinal space.\n    if (minLongitude <= -180) {\n        extraLongitudeBefore = Math.abs(minLongitude - (-180));\n        minLongitude = -180;\n    }\n    if (maxLongitude >= 180) {\n        extraLongitudeAfter = Math.abs(maxLongitude - 180);\n        maxLongitude = 180;\n    }\n\n    var result = [];\n    this.gatherGeographical(data, result, sector, minLatitude, maxLatitude, minLongitude, maxLongitude);\n\n    if (extraLongitudeBefore !== 0) {\n        var beforeSector = new Sector(minLatitude, maxLatitude, 180 - extraLongitudeBefore, 180);\n        this.gatherGeographical(data, result, beforeSector, minLatitude, maxLatitude, 180 - extraLongitudeBefore, 180, -360);\n    }\n\n    if (extraLongitudeAfter !== 0) {\n        var afterSector = new Sector(minLatitude, maxLatitude, -180, -180 + extraLongitudeAfter);\n        this.gatherGeographical(data, result, afterSector, minLatitude, maxLatitude, -180, -180 + extraLongitudeAfter, 360);\n    }\n\n    return result;\n};\n\n/**\n * Internal method to gather the geographical data for given sector and bounding box. The data are in the two dimensional\n * array structure. Therefore the method goes through the slice of the array limited by the bounding box. The\n * elements in given 1 * 1 degree space are then filtered based on their exact location and the exact limitation of\n * the sector.\n * @private\n * @param data {MeasuredLocation[][]} Two dimensional array covering the whole globe in WGS84 coordinates. The globe\n *  is split into the grid of 1 * 1 degrees.\n * @param result {MeasuredLocation[]} Array of the Locations that are valid within given area.\n * @param sector {Sector} The sector representing the detailed area relevant for given\n * @param minLatitude {Number} The integer bound of the sector relevant for the filtering.\n * @param maxLatitude {Number} The integer bound of the sector relevant for the filtering.\n * @param minLongitude {Number} The integer bound of the sector relevant for the filtering.\n * @param maxLongitude {Number} The integer bound of the sector relevant for the filtering.\n * @param adaptLongitude {Number} Optional. If this is supplied, then the result contains new measured locations\n *  with the longitude adapted by adding this number.\n */\nHeatMapLayer.prototype.gatherGeographical = function (data, result, sector, minLatitude, maxLatitude, minLongitude,\n                                                      maxLongitude, adaptLongitude) {\n    var lat, lon;\n    for (lat = minLatitude; lat <= maxLatitude; lat++) {\n        for (lon = minLongitude; lon <= maxLongitude; lon++) {\n            data[lat][lon].forEach(function (element) {\n                if (sector.containsLocation(element.latitude, element.longitude)) {\n                    if (!adaptLongitude) {\n                        result.push(element);\n                    } else {\n                        result.push(new MeasuredLocation(element.latitude, adaptLongitude + element.longitude, element.measure));\n                    }\n                }\n            });\n        }\n    }\n};\n\n/**\n * Sets gradient based on the Scale and IntervalType. It supports CONTINUOUS and QUANTILES types of the interval.\n * The CONTINUOUS simply distribute the colors equally among the percentage.\n * The QUNATILES distribution takes into account the underlying data. The data are sorted based on the measures.\n * The amount of colors in the scale decides how many of the intervals will be in the resulting gradient. The value\n * used as the key for the resulting gradient is taken from element on the position represented by the percentage\n * counted via following formula:\n *  gradientIndex = (data[Math.floor((1 / scale.length) * data.length)].measure) / max;\n * @private\n */\nHeatMapLayer.prototype.setGradient = function () {\n    var intervalType = this.intervalType;\n    var scale = this.scale;\n\n    var gradient = {};\n    if (intervalType === HeatMapIntervalType.CONTINUOUS) {\n        scale.forEach(function (color, index) {\n            gradient[index / scale.length] = color;\n        });\n    } else if (intervalType === HeatMapIntervalType.QUANTILES) {\n        var data = this._measuredLocations;\n        // Equal amount of pieces in each group.\n        data.sort(function (item1, item2) {\n            if (item1.measure < item2.measure) {\n                return -1;\n            } else if (item1.measure > item2.measure) {\n                return 1;\n            } else {\n                return 0;\n            }\n        });\n        var max = data[data.length - 1].measure;\n        if (data.length >= scale.length) {\n            scale.forEach(function (color, index) {\n                if (index === 0) {\n                    gradient[0] = color;\n                } else {\n                    gradient[\n                    data[Math.floor(index / scale.length * data.length)].measure / max\n                        ] = color;\n                }\n            });\n        } else {\n            scale.forEach(function (color, index) {\n                gradient[index / scale.length] = color;\n            });\n        }\n    }\n    this._gradient = gradient;\n};\n\n/**\n * The Image for given Tile is generated and drawn on internal Canvas.\n * @inheritDoc\n */\nHeatMapLayer.prototype.retrieveTileImage = function (dc, tile, suppressRedraw) {\n    if (this.currentRetrievals.indexOf(tile.imagePath) < 0) {\n        if (this.absentResourceList.isResourceAbsent(tile.imagePath)) {\n            return;\n        }\n\n        var imagePath = tile.imagePath,\n            cache = dc.gpuResourceCache,\n            layer = this,\n            radius = this.radius;\n        if(typeof radius === 'function') {\n            radius = radius(tile.sector);\n        }\nconsole.log(radius);\n\n        var extended = this.calculateExtendedSector(tile.sector, 2 * (radius / this.tileWidth), 2 * (radius / this.tileHeight));\n        var extendedWidth = Math.ceil(extended.extensionFactorWidth * this.tileWidth);\n        var extendedHeight = Math.ceil(extended.extensionFactorHeight * this.tileHeight);\n\n        var data = this.filterGeographically(this._data, extended.sector);\n\n        var canvas = this.createHeatMapTile(data, {\n            sector: extended.sector,\n\n            width: this.tileWidth + 2 * extendedWidth,\n            height: this.tileHeight + 2 * extendedHeight,\n            radius: radius,\n\n            intensityGradient: this.gradient,\n            incrementPerIntensity: this._incrementPerIntensity,\n\n            extendedWidth: extendedWidth,\n            extendedHeight: extendedHeight,\n\n            opacity: this.opacity\n        }).canvas();\n\n        var result = document.createElement('canvas');\n        result.height = this.tileHeight;\n        result.width = this.tileWidth;\n        result.getContext('2d').putImageData(\n            canvas.getContext('2d').getImageData(extendedWidth, extendedHeight, this.tileWidth, this.tileHeight),\n            0, 0\n        );\n\n        var texture = layer.createTexture(dc, tile, result);\n        layer.removeFromCurrentRetrievals(imagePath);\n\n        if (texture) {\n            cache.putResource(imagePath, texture, texture.size);\n\n            layer.currentTilesInvalid = true;\n            layer.absentResourceList.unmarkResourceAbsent(imagePath);\n\n            if (!suppressRedraw) {\n                // Send an event to request a redraw.\n                var e = document.createEvent('Event');\n                e.initEvent(\"WorldWindRedraw\", true, true);\n                window.dispatchEvent(e);\n            }\n        }\n    }\n};\n\n\n/**\n * Calculates the new sector for which the data will be filtered and which will be drawn on the tile.\n * The standard version just applies extension factor to the difference between minimum and maximum. The extension\n * factor may differ between latitude and longitude.\n * @protected\n * @param sector {Sector} Sector to use as basis for the extension.\n * @param extensionFactorWidth {Number} The factor to be applied on the width to get sector representing the right geographical area.\n * @param extensionFactorHeight {Number} The factor to be applied on the height to get sector representing the right geographical area.\n * @return {Object} .sector New extended sector.\n *                  .extensionFactorHeight The factor by which the area is changed on the latitude.\n *                  .extensionFactorWidth The factor by which the area is changed on the longitude.\n */\nHeatMapLayer.prototype.calculateExtendedSector = function (sector, extensionFactorWidth, extensionFactorHeight) {\n    var latitudeChange = (sector.maxLatitude - sector.minLatitude) * extensionFactorHeight;\n    var longitudeChange = (sector.maxLongitude - sector.minLongitude) * extensionFactorWidth;\n    return {\n        sector: new Sector(\n            sector.minLatitude - latitudeChange,\n            sector.maxLatitude + latitudeChange,\n            sector.minLongitude - longitudeChange,\n            sector.maxLongitude + longitudeChange\n        ),\n        extensionFactorHeight: extensionFactorHeight,\n        extensionFactorWidth: extensionFactorWidth\n    };\n};\n\n/**\n * Overwrite this method if you want to use a custom implementation of tile used for displaying the data. In the\n * default version the tile draws points as blurring circles coloured based on the gradient.\n * @protected\n * @param data {Object[]} Array of information constituting points in the map.\n * @param options {Object}\n * @param options.sector {Sector} Sector with the geographical information for tile representation.\n * @param options.width {Number} Width of the Canvas to be created in pixels.\n * @param options.height {Number} Height of the Canvas to be created in pixels.\n * @param options.radius {Number} Radius of the data point in pixels.\n * @param options.incrementPerIntensity {Number} The ratio representing the 1 / measure for the maximum measure.\n * @param options.intensityGradient {Object} Gradient of colours used to draw the points and derived from the scale,\n *  intervalType and the data.\n * @param options.extendedWidth {Number} Minimal width that needs to be valid in the resulting object.\n * @param options.extendedHeight {Number} Minimal height that needs to be valid in the resulting object.\n *\n * @return {HeatMapTile} Instance of the implementation of the HeatMapTile used for this instance of the layer.\n */\nHeatMapLayer.prototype.createHeatMapTile = function (data, options) {\n    return new HeatMapColoredTile(data, options);\n};\n\nexport default HeatMapLayer;","import Distribution from './Distribution';\nimport Extruded from './Extruded';\nimport Products from './Products';\nimport WorldWind from 'webworldwind-esa';\nimport HeatMapLayer from '../../../worldwind/layer/heatmap/HeatMapLayer'\nimport chroma from 'chroma-js';\nimport moment from 'moment';\n\n\nconst {\n    RenderableLayer,\n    Color,\n    MeasuredLocation,\n} = WorldWind;\n\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer can render only one model of satellite. It`s possible to set position data of model.\n * @param options {Object}\n * @param options.key {String}\n * @param options.sensornames {Array} ['sentinel-1a', 'sentinel-2a']\n * @param options.satName {String}\n * @param options.time {Date} Time of the satellite.\n * @param options.range {number} Renge in milliseconds. Default is 90 minutes.\n * @param options.onLayerChanged {func}\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass StatisticsLayer extends RenderableLayer {\n\tconstructor(options) {\n        super(options);\n        this._products = new Products();\n        this._rerenderMap = null;\n        this.key = options.key;\n        this.satName = options.satName;\n        this.sensornames = options.sensornames;\n        this.onLayerChanged = options.onLayerChanged || null;\n        this.time = options.time || new Date();\n        this.strMonthTime = this.getMonthTimeString(this.time);\n\n        this.loading = new Set();\n\n        this._missionScale = [\n            new Color(15/255, 89/255, 69/255, 1),\n            new Color(91/255, 216/255, 75/255, 1),\n            new Color(24/255, 167/255, 134/255, 1),\n            new Color(16/255, 125/255, 90/255, 1)\n        ];\n        this._instrumentsScale = [\n            new Color(59/255, 15/255, 87/255, 1),\n            new Color(75/255, 138/255, 216/255, 1),\n            new Color(136/255, 92/255, 193/255, 1),\n            new Color(91/255, 37/255, 162/255, 1)\n        ];\n\n        this._choropleth = null;\n        this._extruded = null;\n\n        this.update();\n    };\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    setTime(time) {\n        if(time) {\n            this.time = time;\n            this.updateStrMonthTime();\n        }\n    }\n\n    updateStrMonthTime() {\n        if(this.time) {\n            const newStrMonthTime = this.getMonthTimeString(this.time);\n            if(newStrMonthTime !== this.strMonthTime) {\n                this.strMonthTime = newStrMonthTime;\n                this.update();\n            }\n        }\n    }\n\n    getMonthTimeString(date) {\n        const momTime = moment(date);\n        const strMonthTime = `${momTime.format('YYYY')}-${momTime.format('MM')}`;\n        return strMonthTime;\n    }\n\n    getPallete(paletteKey) {\n        const palettes = [\n            {\n                key: 'orange',\n                title: 'Sequential: orange',\n                colors: [chroma('rgb(255,245,235)'), chroma('rgb(253,141,60)'), chroma('rgb(127,39,4)')],\n                selected: true\n            },\n            {\n                key: 'blue',\n                title: 'Sequential: blue',\n                colors: [chroma('rgb(255,255,217)'), chroma('rgb(65,182,196)'), chroma('rgb(8,29,88)')]\n            },\n            {\n                key: 'blue-orange',\n                title: 'Divergent: blue-orange',\n                colors: [chroma('rgb(8,48,107)'), chroma('rgb(255,255,255)'), chroma('rgb(127,39,4)')]\n            },\n            {\n                key: 'heat',\n                title: 'HeatMap: Multiple Colors',\n                colors: [chroma('blue'), chroma('cyan'), chroma('lime'), chroma('yellow'), chroma('red')]\n            },\n            {\n                key: 'blue-red',\n                title: 'HeatMap: Blue Red',\n                colors: [chroma('blue'), chroma('red')]\n            },\n            {\n                key: 'white-red',\n                title: 'HeatMap: White Red',\n                colors: [chroma('white'), chroma('red')]\n            }\n        ];\n\n         // GEt colors for missions and sensors.\n\n        const palette = palettes.filter(function (palette) {\n            return palette.key === paletteKey;\n        })[0];\n        return palette;\n    }\n\n    update() {\n\n        const pallete = this.getPallete('heat');\n\n        const options = {\n            palettes: pallete,\n            sensornames: this.sensornames,\n            type: 'sensors',\n            opacity: 75,\n            dates: [this.strMonthTime]\n        }\n\n        return this.redraw(options).then(function (distribution) {\n            let legendMap = distribution._hexs.map(function (hex, i) {\n                return {\n                    color: hex,\n                    startValue: Math.pow(distribution.oneLevel * i, 2),\n                    endValue: Math.pow(distribution.oneLevel * (i + 1), 2)\n                };\n            });\n\n            return legendMap;\n        }).catch(function (err) {\n            console.error(err);\n        });\n    }\n\n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n    }\n\n    // Documented in superclass.\n\tdoRender(dc) {\n\t\tif(this._choropleth && typeof this._choropleth.doRender === 'function'){\n            this._choropleth.doRender(dc);\n        };\n\n\t\tif(this._extruded && typeof this._extruded.doRender === 'function'){\n            this._extruded.doRender(dc);\n        };\n\t}\n\n    /**\n     * It removes currently displayed layers with actually valid information and creates new layers with the\n     * information needed for user to understand the state.\n     * Example:\n     * {\n     *   sensornames: ['c-sar'],\n     *   type: 'sensors',\n     *   opacity: 100,\n     *   dates: ['2017-08']\n     * }\n     *\n     * @param options {Object}\n     * @param options.type {String} mission or sensors\n     * @param options.dates {String[]} Array of dates in the format YYYY-MM\n     * @param options.spacecraftnames {String[]} Array of the names of the spacecrafts to be used.\n     * @param options.sensornames {String[]} Array of the names of the sensors to be used.\n     * @param options.showExtrudedPolygons {Boolean} Whether the extruded polygons should be displayed\n     * @param options.opacity {Number} 0 to 100\n     */\n    redraw(options) {\n        if(!options || (options.type !== 'missions' && options.type !== 'sensors' )) {\n            return;\n        }\n\n        let dataToDownload = null\n        let colorScale = null;\n        if (options.type === 'missions') {\n            dataToDownload = options.spacecraftnames;\n            colorScale = this._missionScale;\n        } else if (options.type === 'sensors') {\n            dataToDownload = options.sensornames;\n            colorScale = this._instrumentsScale;\n        }\n\n        let chosenMonths = options.dates.map(function (date) {\n            // date which needs to be updated.\n            return moment(date);\n        }); // This must return arrays of available months.\n        let allPromises = [];\n\n        // Combinations of datasets and months.\n        // It is necessary to make sure that the promises are correctly handled.\n        dataToDownload.forEach((dataset, index) => {\n            chosenMonths.forEach((chosenMonth) => {\n                allPromises.push(this._products.retrieve(\n                    dataset,\n                    chosenMonth.format('YYYY'),\n                    chosenMonth.format('MM'),\n                    colorScale[index]\n                ));\n            });\n        });\n\n        if(typeof this.onLayerChanged === 'function') {\n            this.onLayerChanged({\n                satKey: this.satName,\n                layerKey: this.key\n            }, {loading: true});\n        }\n\n        return Promise.all(allPromises).then((products) => {\n            let legend = this.aggregateAndFilter(options, [].concat(...products));\n\n            if(typeof this.onLayerChanged === 'function') {\n                this.onLayerChanged({\n                    satKey: this.satName,\n                    layerKey: this.key\n                }, {loading: false});\n            }\n\n            this.doRerender();\n\n            return legend;\n        });\n    }\n\n    /**\n     * It gets grid of the products and aggregates and filters it.\n     * @param options {Object}\n     * @param products\n     */\n    aggregateAndFilter(options, products) {\n        this._choropleth = this.getChoropleth(products, options);\n\n        if (options.showExtrudedPolygons) {\n            this._extruded = this.getExtruded(products);\n        }\n\n        return this._choropleth.distribution;\n    }\n\n    // Move to the relevant layers.\n\n    /**\n     * It returns newly created Choropleth for currently chosen products.\n     * @param products {AggregatedProduct[]} Collection of the products to be displayed in the choropleth.\n     * @param options {Object}\n     * @returns {HeatMapLayer} Layer representing choropleth with the passed in Products.\n     */\n    getChoropleth(products, options) {\n        let heatMap = new HeatMapLayer('Product Statistics', products.map(function (product) {\n            return new MeasuredLocation(\n                product.latitude,\n                product.longitude,\n                product.amount\n            );\n        }), 1);\n\n        let distribution = new Distribution({\n            opacity: 1,\n            palettes: options.palettes,\n            max: heatMap._max\n        });\n\n        heatMap.distribution = distribution;\n        heatMap.scale = distribution._hexs;\n        heatMap.opacity = options.opacity && options.opacity / 100 || 0.75;\n        heatMap.radius = function (sector) {\n            if (sector.maxLongitude - sector.minLongitude >= 45) {\n                return 25;\n            } else if (sector.maxLongitude - sector.minLongitude >= 22.5) {\n                return 37.5;\n            } else if (sector.maxLongitude - sector.minLongitude >= 11.125) {\n                return 50;\n            } else if (sector.maxLongitude - sector.minLongitude >= 5.5) {\n                return 62.5;\n            }\n\n            return 75;\n        };\n\n        return heatMap;\n    }\n\n    /**\n     * It returns newly created Extruded layer for either currently chosen mission or sensor. It is responsibility\n     * of this layer to choose, whether it displays Sensor or Mission and update accordingly.\n     * @param products {AggregatedProduct[]} Collection of the products to be displayed as extruded polygons.\n     * @returns {Extruded} Layer representing shares displayed by differently colored extruded polygons.\n     */\n    getExtruded(products) {\n        // The relevant part is in colors.\n        return new Extruded({\n            name: 'Analytics Extruded Layer Missions.',\n\n            products: products\n        });\n    }\n}\n\nexport default StatisticsLayer;\n\n","import WorldWind from 'webworldwind-esa';\n\nconst {\n\tRenderableLayer,\n} = WorldWind;\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer can render specific layer for defined view range.\n * @param displayName {String}\n * @param options {Object}\n * @param options.key {String}\n * @param options.layers {Array}\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass MultiRangeLayer extends RenderableLayer {\n\tconstructor(displayName, options) {\n        super(displayName);\n        this._rerenderMap = null;\n\t\tthis.key = options.key;\n\t\tthis.range = 0;\n\n\n\t\tthis.intervals = [];\n\t\tthis.layers = [];\n\n\t\tif(options.layers && options.layers.length > 0) {\n\t\t\tfor (const layerOption of options.layers) {\n\t\t\t\tconst rangeInterval = layerOption.rangeInterval;\n\t\t\t\tconst layer = layerOption.layer;\n\n\t\t\t\tthis.intervals = [...new Set([...this.intervals, ...rangeInterval])];\n\t\t\t\tthis.layers = [...this.layers, layer];\n\t\t\t}\n\t\t}\n\t};\n\t\n\tgetLayerByRange() {\n\t\tlet i = 0\n\t\twhile ((this.range > this.intervals[i] && this.range > this.intervals[i + 1]) || (this.range < this.intervals[i] && this.range < this.intervals[i + 1])) {\n\t\t\tif(i>100) {\n\t\t\t\treturn null\n\t\t\t}\n\t\t\ti++\n\t\t}\n\t\treturn this.layers[i]\n\t}\n\n    onUpdateNavigator(view) {\n\t\tthis.range = view.boxRange;\n    }\n\n\tdoRender(dc) {\n\t\tconst layer = this.getLayerByRange();\n\t\tif(layer) {\n\t\t\tlayer.doRender(dc);\n\t\t}\n\t}\n}\n\nexport default MultiRangeLayer;\n\n","import WorldWind from 'webworldwind-esa';\n\nconst {\n    Sector,\n    Location,\n} = WorldWind;\n\nconst getWmsProductFromONDA = (shape, id, url) => {\n    const boundaries = shape._boundaries[0];\n\n    var minLatitude = boundaries[0].latitude;\n    var maxLatitude = boundaries[0].latitude;\n    var minLongitude = boundaries[0].longitude;\n    var maxLongitude = boundaries[0].longitude;\n    for (let i = 1; i < boundaries.length; i++) {\n        minLatitude = Math.min(minLatitude, boundaries[i].latitude);\n        maxLatitude = Math.max(maxLatitude, boundaries[i].latitude);\n        minLongitude = Math.min(minLongitude, boundaries[i].longitude);\n        maxLongitude = Math.max(maxLongitude, boundaries[i].longitude);\n    }\n\n    var shapeSector = new Sector(\n        minLatitude,\n        maxLatitude,\n        minLongitude,\n        maxLongitude\n    );\n    var customLocation = new Location(36, 36);\n\n    const wmsConfigOnda = {\n        service: url,\n        layerNames: id,\n        sector: shapeSector,\n        levelZeroDelta: customLocation,\n        numLevels: 19,\n        format: \"image/png\",\n        size: 256,\n        coordinateSystem: \"EPSG:4326\",\n        version: \"1.1.1\",\n    };\n     console.log(wmsConfigOnda);\n     return wmsConfigOnda;\n    // const wmsLayer = new WmsLayer(wmsConfigOnda);\n    // wmsLayer.doProxy = false;// true;\n    // wmsLayer.maxActiveAltitude = 2500000;\n    // return wmsLayer;\n\n}\n\nexport default {\n    getWmsProductFromONDA,\n}","import WorldWind from 'webworldwind-esa';\nimport WorldWindX from 'webworldwind-x';\nimport SciHubServices from './utils/SciHubServices';\nimport MultiRangeLayer from './MultiRangeLayer';\nimport { getSatelitesSelectOptions } from '../../context/selectors/components/satellitesSelect';\n\nconst {\n\tArgumentError,\n    RenderableLayer,\n    WmsLayer,\n\tLogger,\n} = WorldWind;\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer create for each added renderable coresponding WMS layer.\n * @param displayName {String}\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass FootPrintWMSWrapperLayer extends RenderableLayer {\n\tconstructor(displayName) {\n\t\tsuper(displayName);\n\n\t\t/**\n\t\t * The array of renderables;\n\t\t * @type {Array}\n\t\t * @readonly\n\t\t */\n\t\tthis.renderables = [];\n\n\t\t/**\n\t\t * An array with two elements:\n\t\t * start time and end time of the visible range.\n\t\t * @type {Date[]}\n\t\t */\n\t\tthis.timeRange = [];\n\n\t\t/**\n\t\t * An array of WMS layers for each renderable:\n\t\t * @type {Array}\n\t\t */\n\t\tthis.layers = [];\n\t};\n\n\t/**\n\t * Adds a renderable to this layer.\n\t * @param {Renderable} renderable The renderable to add.\n\t * @throws {ArgumentError} If the specified renderable is null or undefined.\n\t */\n\taddRenderable(renderable) {\n\t\tif (!renderable) {\n\t\t\tthrow new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"RenderableLayer\", \"addRenderable\",\n\t\t\t\t\"missingRenderable\"));\n\t\t}\n\n\t\tthis.renderables.push(renderable);\n\n\t\tthis.update();\n\t};\n\n\t/**\n\t * Adds an array of renderables to this layer.\n\t * @param {Renderable[]} renderables The renderables to add.\n\t * @throws {ArgumentError} If the specified renderables array is null or undefined.\n\t */\n\taddRenderables(renderables) {\n\t\tif (!renderables) {\n\t\t\tthrow new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"RenderableLayer\", \"addRenderables\",\n\t\t\t\t\"The renderables array is null or undefined.\"));\n\t\t}\n\n\t\tfor (var i = 0, len = renderables.length; i < len; i++) {\n\t\t\tthis.addRenderable(renderables[i]);\n\t\t}\n\t};\n\n\t/**\n\t * Removes a renderable from this layer.\n\t * @param {Renderable} renderable The renderable to remove.\n\t */\n\tremoveRenderable(renderable) {\n\t\tvar index = this.renderables.indexOf(renderable);\n\t\tif (index >= 0) {\n\t\t\tthis.renderables.splice(index, 1);\n\t\t}\n\t\tthis.update();\n\t};\n\n\t/**\n\t * Removes all renderables from this layer. Does not call dispose on those renderables.\n\t */\n\tremoveAllRenderables() {\n\t\tthis.renderables = [];\n\t\tthis.update();\n\t};\n\n\tgetLayerFromRenderable(renderable) {\n\t\tconst serviceAddress = `https://eoapps.solenix.ch/dias/onda?service=wms`;\n\t\tconst config = SciHubServices.getWmsProductFromONDA(renderable, renderable.userProperties.key, serviceAddress);\n\t\tconst wmsLayer = new WmsLayer(config);\n\t\treturn wmsLayer;\n\t}\n\n\tupdate() {\n\t\t//vzit renderables a vyrobit z nich wms vrstvy\n\t\t//uloit do layers\n\t\tthis.layers = [];\n\t\tfor (const renderable of this.renderables) {\n\t\t\tconst layer = this.getLayerFromRenderable(renderable);\n\t\t\tthis.layers.push(layer)\n\t\t}\n\t}\n\n\t// Documented in superclass.\n\tdoRender(dc) {\n\t\tfor(const layer of this.layers) {\n\t\t\tlayer.doRender(dc);\n\t\t}\n\t};\n\n\t/**\n\t * Internal function for solving the visibility based on time.\n\t * The element is visible when its whole range is inside the selected time range.\n\t */\n\tsolveTimeVisibility(dc, renderable) {\n\t\tvar selectedTimeRange = dc.currentLayer.timeRange;\n\n\t\tif (renderable.timeRange.length >= 2 && selectedTimeRange.length >= 2) {\n\t\t\tvar minTime = renderable.timeRange[0];\n\t\t\tvar maxTime = renderable.timeRange[1];\n\t\t\tvar minSelectedTime = selectedTimeRange[0];\n\t\t\tvar maxSelectedTime = selectedTimeRange[1];\n\n\t\t\tif (minTime < minSelectedTime  ||\n\t\t\t\tmaxTime > maxSelectedTime) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn renderable.enabled;\n\t};\t\n}\n\nexport default FootPrintWMSWrapperLayer;\n\n","import WorldWind from 'webworldwind-esa';\nimport WorldWindX from 'webworldwind-x';\nimport MultiRangeLayer from './MultiRangeLayer';\nimport FootPrintWMSWrapperLayer from './FootPrintWMSWrapperLayer';\n\nconst {\n    RenderableLayer,\n\tArgumentError,\n\tLogger,\n} = WorldWind;\n\n/**\n * Layer integrates two different types of layers. WMS layer for less range and Renderable layer for high range.\n * @param displayName {String}\n * @augments WorldWind.Layer\n * @constructor\n */\nclass FootPrint extends MultiRangeLayer {\n\tconstructor(displayName) {\n\t\tconst options = {\n\t\t\tkey: displayName,\n\t\t\tlayers:[\n\t\t\t\t{\n\t\t\t\t\trangeInterval: [0,4000000],\n\t\t\t\t\tlayer: new FootPrintWMSWrapperLayer(`FootPrintWMSWrapperLayer-${displayName}`)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trangeInterval: [4000000,220000000],\n\t\t\t\t\tlayer: new RenderableLayer(`renderableLayer-${displayName}`)\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t\t\n\t\tsuper(displayName, options);\n        \n\t};\n\n\t/**\n\t * Adds a renderable to this layer.\n\t * @param {Renderable} renderable The renderable to add.\n\t * @throws {ArgumentError} If the specified renderable is null or undefined.\n\t */\n\taddRenderable(renderable) {\n\t\tif (!renderable) {\n\t\t\tthrow new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"RenderableLayer\", \"addRenderable\",\n\t\t\t\t\"missingRenderable\"));\n\t\t}\n\t\t\n\t\tfor(const layer of this.layers) {\n\t\t\tif(typeof layer.addRenderable === 'function') {\n\t\t\t\tlayer.addRenderable(renderable);\n\t\t\t}\n\t\t}\n\n\t};\n\n\t/**\n\t * Adds an array of renderables to this layer.\n\t * @param {Renderable[]} renderables The renderables to add.\n\t * @throws {ArgumentError} If the specified renderables array is null or undefined.\n\t */\n\taddRenderables(renderables) {\n\t\tif (!renderables) {\n\t\t\tthrow new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"RenderableLayer\", \"addRenderables\",\n\t\t\t\t\"The renderables array is null or undefined.\"));\n\t\t}\n\n\t\tfor(const layer of this.layers) {\n\t\t\tif(typeof layer.addRenderables === 'function') {\n\t\t\t\tlayer.addRenderables(renderables);\n\t\t\t}\n\t\t}\n\t};\n\n\n\t/**\n\t * Removes a renderable from this layer.\n\t * @param {Renderable} renderable The renderable to remove.\n\t */\n\tremoveRenderable(renderable) {\n\t\tfor(const layer of this.layers) {\n\t\t\tif(typeof layer.removeRenderable === 'function') {\n\t\t\t\tlayer.removeRenderable(renderable);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Removes all renderables from this layer. Does not call dispose on those renderables.\n\t */\n\tremoveAllRenderables() {\n\t\tfor(const layer of this.layers) {\n\t\t\tif(typeof layer.removeAllRenderables === 'function') {\n\t\t\t\tlayer.removeAllRenderables();\n\t\t\t}\n\t\t}\n\t};\n\n\n\t/**\n\t * Internal function for solving the visibility based on time.\n\t * The element is visible when its whole range is inside the selected time range.\n\t */\n\tsolveTimeVisibility(dc, renderable) {\n\t\tfor(const layer of this.layers) {\n\t\t\tif(typeof layer.solveTimeVisibility === 'function') {\n\t\t\t\tlayer.solveTimeVisibility(dc, renderable);\n\t\t\t}\n\t\t}\n\t}\n\t\n}\n\nexport default FootPrint;\n\n","/*!\n * satellite-js v3.0.1\n * (c) 2013 Shashwat Kandadai and UCSC\n * https://github.com/shashwatak/satellite-js\n * License: MIT\n */\n\nvar pi = Math.PI;\nvar twoPi = pi * 2;\nvar deg2rad = pi / 180.0;\nvar rad2deg = 180 / pi;\nvar minutesPerDay = 1440.0;\nvar mu = 398600.5; // in km3 / s2\n\nvar earthRadius = 6378.137; // in km\n\nvar xke = 60.0 / Math.sqrt(earthRadius * earthRadius * earthRadius / mu);\nvar vkmpersec = earthRadius * xke / 60.0;\nvar tumin = 1.0 / xke;\nvar j2 = 0.00108262998905;\nvar j3 = -0.00000253215306;\nvar j4 = -0.00000161098761;\nvar j3oj2 = j3 / j2;\nvar x2o3 = 2.0 / 3.0;\n\nvar constants = /*#__PURE__*/Object.freeze({\n  pi: pi,\n  twoPi: twoPi,\n  deg2rad: deg2rad,\n  rad2deg: rad2deg,\n  minutesPerDay: minutesPerDay,\n  mu: mu,\n  earthRadius: earthRadius,\n  xke: xke,\n  vkmpersec: vkmpersec,\n  tumin: tumin,\n  j2: j2,\n  j3: j3,\n  j4: j4,\n  j3oj2: j3oj2,\n  x2o3: x2o3\n});\n\n/* -----------------------------------------------------------------------------\n *\n *                           procedure days2mdhms\n *\n *  this procedure converts the day of the year, days, to the equivalent month\n *    day, hour, minute and second.\n *\n *  algorithm     : set up array for the number of days per month\n *                  find leap year - use 1900 because 2000 is a leap year\n *                  loop through a temp value while the value is < the days\n *                  perform int conversions to the correct day and month\n *                  convert remainder into h m s using type conversions\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs          description                    range / units\n *    year        - year                           1900 .. 2100\n *    days        - julian day of the year         0.0  .. 366.0\n *\n *  outputs       :\n *    mon         - month                          1 .. 12\n *    day         - day                            1 .. 28,29,30,31\n *    hr          - hour                           0 .. 23\n *    min         - minute                         0 .. 59\n *    sec         - second                         0.0 .. 59.999\n *\n *  locals        :\n *    dayofyr     - day of year\n *    temp        - temporary extended values\n *    inttemp     - temporary int value\n *    i           - index\n *    lmonth[12]  - int array containing the number of days per month\n *\n *  coupling      :\n *    none.\n * --------------------------------------------------------------------------- */\nfunction days2mdhms(year, days) {\n  var lmonth = [31, year % 4 === 0 ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n  var dayofyr = Math.floor(days); //  ----------------- find month and day of month ----------------\n\n  var i = 1;\n  var inttemp = 0;\n\n  while (dayofyr > inttemp + lmonth[i - 1] && i < 12) {\n    inttemp += lmonth[i - 1];\n    i += 1;\n  }\n\n  var mon = i;\n  var day = dayofyr - inttemp; //  ----------------- find hours minutes and seconds -------------\n\n  var temp = (days - dayofyr) * 24.0;\n  var hr = Math.floor(temp);\n  temp = (temp - hr) * 60.0;\n  var minute = Math.floor(temp);\n  var sec = (temp - minute) * 60.0;\n  return {\n    mon: mon,\n    day: day,\n    hr: hr,\n    minute: minute,\n    sec: sec\n  };\n}\n/* -----------------------------------------------------------------------------\n *\n *                           procedure jday\n *\n *  this procedure finds the julian date given the year, month, day, and time.\n *    the julian date is defined by each elapsed day since noon, jan 1, 4713 bc.\n *\n *  algorithm     : calculate the answer in one step for efficiency\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs          description                    range / units\n *    year        - year                           1900 .. 2100\n *    mon         - month                          1 .. 12\n *    day         - day                            1 .. 28,29,30,31\n *    hr          - universal time hour            0 .. 23\n *    min         - universal time min             0 .. 59\n *    sec         - universal time sec             0.0 .. 59.999\n *\n *  outputs       :\n *    jd          - julian date                    days from 4713 bc\n *\n *  locals        :\n *    none.\n *\n *  coupling      :\n *    none.\n *\n *  references    :\n *    vallado       2007, 189, alg 14, ex 3-14\n *\n * --------------------------------------------------------------------------- */\n\nfunction jdayInternal(year, mon, day, hr, minute, sec) {\n  var msec = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n  return 367.0 * year - Math.floor(7 * (year + Math.floor((mon + 9) / 12.0)) * 0.25) + Math.floor(275 * mon / 9.0) + day + 1721013.5 + ((msec / 60000 + sec / 60.0 + minute) / 60.0 + hr) / 24.0 // ut in days\n  // # - 0.5*sgn(100.0*year + mon - 190002.5) + 0.5;\n  ;\n}\n\nfunction jday(year, mon, day, hr, minute, sec, msec) {\n  if (year instanceof Date) {\n    var date = year;\n    return jdayInternal(date.getUTCFullYear(), date.getUTCMonth() + 1, // Note, this function requires months in range 1-12.\n    date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds());\n  }\n\n  return jdayInternal(year, mon, day, hr, minute, sec, msec);\n}\n/* -----------------------------------------------------------------------------\n *\n *                           procedure invjday\n *\n *  this procedure finds the year, month, day, hour, minute and second\n *  given the julian date. tu can be ut1, tdt, tdb, etc.\n *\n *  algorithm     : set up starting values\n *                  find leap year - use 1900 because 2000 is a leap year\n *                  find the elapsed days through the year in a loop\n *                  call routine to find each individual value\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs          description                    range / units\n *    jd          - julian date                    days from 4713 bc\n *\n *  outputs       :\n *    year        - year                           1900 .. 2100\n *    mon         - month                          1 .. 12\n *    day         - day                            1 .. 28,29,30,31\n *    hr          - hour                           0 .. 23\n *    min         - minute                         0 .. 59\n *    sec         - second                         0.0 .. 59.999\n *\n *  locals        :\n *    days        - day of year plus fractional\n *                  portion of a day               days\n *    tu          - julian centuries from 0 h\n *                  jan 0, 1900\n *    temp        - temporary double values\n *    leapyrs     - number of leap years from 1900\n *\n *  coupling      :\n *    days2mdhms  - finds month, day, hour, minute and second given days and year\n *\n *  references    :\n *    vallado       2007, 208, alg 22, ex 3-13\n * --------------------------------------------------------------------------- */\n\nfunction invjday(jd, asArray) {\n  // --------------- find year and days of the year -\n  var temp = jd - 2415019.5;\n  var tu = temp / 365.25;\n  var year = 1900 + Math.floor(tu);\n  var leapyrs = Math.floor((year - 1901) * 0.25); // optional nudge by 8.64x10-7 sec to get even outputs\n\n  var days = temp - ((year - 1900) * 365.0 + leapyrs) + 0.00000000001; // ------------ check for case of beginning of a year -----------\n\n  if (days < 1.0) {\n    year -= 1;\n    leapyrs = Math.floor((year - 1901) * 0.25);\n    days = temp - ((year - 1900) * 365.0 + leapyrs);\n  } // ----------------- find remaing data  -------------------------\n\n\n  var mdhms = days2mdhms(year, days);\n  var mon = mdhms.mon,\n      day = mdhms.day,\n      hr = mdhms.hr,\n      minute = mdhms.minute;\n  var sec = mdhms.sec - 0.00000086400;\n\n  if (asArray) {\n    return [year, mon, day, hr, minute, Math.floor(sec)];\n  }\n\n  return new Date(Date.UTC(year, mon - 1, day, hr, minute, Math.floor(sec)));\n}\n\n/* -----------------------------------------------------------------------------\n *\n *                           procedure dpper\n *\n *  this procedure provides deep space long period periodic contributions\n *    to the mean elements.  by design, these periodics are zero at epoch.\n *    this used to be dscom which included initialization, but it's really a\n *    recurring function.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    e3          -\n *    ee2         -\n *    peo         -\n *    pgho        -\n *    pho         -\n *    pinco       -\n *    plo         -\n *    se2 , se3 , sgh2, sgh3, sgh4, sh2, sh3, si2, si3, sl2, sl3, sl4 -\n *    t           -\n *    xh2, xh3, xi2, xi3, xl2, xl3, xl4 -\n *    zmol        -\n *    zmos        -\n *    ep          - eccentricity                           0.0 - 1.0\n *    inclo       - inclination - needed for lyddane modification\n *    nodep       - right ascension of ascending node\n *    argpp       - argument of perigee\n *    mp          - mean anomaly\n *\n *  outputs       :\n *    ep          - eccentricity                           0.0 - 1.0\n *    inclp       - inclination\n *    nodep        - right ascension of ascending node\n *    argpp       - argument of perigee\n *    mp          - mean anomaly\n *\n *  locals        :\n *    alfdp       -\n *    betdp       -\n *    cosip  , sinip  , cosop  , sinop  ,\n *    dalf        -\n *    dbet        -\n *    dls         -\n *    f2, f3      -\n *    pe          -\n *    pgh         -\n *    ph          -\n *    pinc        -\n *    pl          -\n *    sel   , ses   , sghl  , sghs  , shl   , shs   , sil   , sinzf , sis   ,\n *    sll   , sls\n *    xls         -\n *    xnoh        -\n *    zf          -\n *    zm          -\n *\n *  coupling      :\n *    none.\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction dpper(satrec, options) {\n  var e3 = satrec.e3,\n      ee2 = satrec.ee2,\n      peo = satrec.peo,\n      pgho = satrec.pgho,\n      pho = satrec.pho,\n      pinco = satrec.pinco,\n      plo = satrec.plo,\n      se2 = satrec.se2,\n      se3 = satrec.se3,\n      sgh2 = satrec.sgh2,\n      sgh3 = satrec.sgh3,\n      sgh4 = satrec.sgh4,\n      sh2 = satrec.sh2,\n      sh3 = satrec.sh3,\n      si2 = satrec.si2,\n      si3 = satrec.si3,\n      sl2 = satrec.sl2,\n      sl3 = satrec.sl3,\n      sl4 = satrec.sl4,\n      t = satrec.t,\n      xgh2 = satrec.xgh2,\n      xgh3 = satrec.xgh3,\n      xgh4 = satrec.xgh4,\n      xh2 = satrec.xh2,\n      xh3 = satrec.xh3,\n      xi2 = satrec.xi2,\n      xi3 = satrec.xi3,\n      xl2 = satrec.xl2,\n      xl3 = satrec.xl3,\n      xl4 = satrec.xl4,\n      zmol = satrec.zmol,\n      zmos = satrec.zmos;\n  var init = options.init,\n      opsmode = options.opsmode;\n  var ep = options.ep,\n      inclp = options.inclp,\n      nodep = options.nodep,\n      argpp = options.argpp,\n      mp = options.mp; // Copy satellite attributes into local variables for convenience\n  // and symmetry in writing formulae.\n\n  var alfdp;\n  var betdp;\n  var cosip;\n  var sinip;\n  var cosop;\n  var sinop;\n  var dalf;\n  var dbet;\n  var dls;\n  var f2;\n  var f3;\n  var pe;\n  var pgh;\n  var ph;\n  var pinc;\n  var pl;\n  var sinzf;\n  var xls;\n  var xnoh;\n  var zf;\n  var zm; //  ---------------------- constants -----------------------------\n\n  var zns = 1.19459e-5;\n  var zes = 0.01675;\n  var znl = 1.5835218e-4;\n  var zel = 0.05490; //  --------------- calculate time varying periodics -----------\n\n  zm = zmos + zns * t; // be sure that the initial call has time set to zero\n\n  if (init === 'y') {\n    zm = zmos;\n  }\n\n  zf = zm + 2.0 * zes * Math.sin(zm);\n  sinzf = Math.sin(zf);\n  f2 = 0.5 * sinzf * sinzf - 0.25;\n  f3 = -0.5 * sinzf * Math.cos(zf);\n  var ses = se2 * f2 + se3 * f3;\n  var sis = si2 * f2 + si3 * f3;\n  var sls = sl2 * f2 + sl3 * f3 + sl4 * sinzf;\n  var sghs = sgh2 * f2 + sgh3 * f3 + sgh4 * sinzf;\n  var shs = sh2 * f2 + sh3 * f3;\n  zm = zmol + znl * t;\n\n  if (init === 'y') {\n    zm = zmol;\n  }\n\n  zf = zm + 2.0 * zel * Math.sin(zm);\n  sinzf = Math.sin(zf);\n  f2 = 0.5 * sinzf * sinzf - 0.25;\n  f3 = -0.5 * sinzf * Math.cos(zf);\n  var sel = ee2 * f2 + e3 * f3;\n  var sil = xi2 * f2 + xi3 * f3;\n  var sll = xl2 * f2 + xl3 * f3 + xl4 * sinzf;\n  var sghl = xgh2 * f2 + xgh3 * f3 + xgh4 * sinzf;\n  var shll = xh2 * f2 + xh3 * f3;\n  pe = ses + sel;\n  pinc = sis + sil;\n  pl = sls + sll;\n  pgh = sghs + sghl;\n  ph = shs + shll;\n\n  if (init === 'n') {\n    pe -= peo;\n    pinc -= pinco;\n    pl -= plo;\n    pgh -= pgho;\n    ph -= pho;\n    inclp += pinc;\n    ep += pe;\n    sinip = Math.sin(inclp);\n    cosip = Math.cos(inclp);\n    /* ----------------- apply periodics directly ------------ */\n    // sgp4fix for lyddane choice\n    // strn3 used original inclination - this is technically feasible\n    // gsfc used perturbed inclination - also technically feasible\n    // probably best to readjust the 0.2 limit value and limit discontinuity\n    // 0.2 rad = 11.45916 deg\n    // use next line for original strn3 approach and original inclination\n    // if (inclo >= 0.2)\n    // use next line for gsfc version and perturbed inclination\n\n    if (inclp >= 0.2) {\n      ph /= sinip;\n      pgh -= cosip * ph;\n      argpp += pgh;\n      nodep += ph;\n      mp += pl;\n    } else {\n      //  ---- apply periodics with lyddane modification ----\n      sinop = Math.sin(nodep);\n      cosop = Math.cos(nodep);\n      alfdp = sinip * sinop;\n      betdp = sinip * cosop;\n      dalf = ph * cosop + pinc * cosip * sinop;\n      dbet = -ph * sinop + pinc * cosip * cosop;\n      alfdp += dalf;\n      betdp += dbet;\n      nodep %= twoPi; //  sgp4fix for afspc written intrinsic functions\n      //  nodep used without a trigonometric function ahead\n\n      if (nodep < 0.0 && opsmode === 'a') {\n        nodep += twoPi;\n      }\n\n      xls = mp + argpp + cosip * nodep;\n      dls = pl + pgh - pinc * nodep * sinip;\n      xls += dls;\n      xnoh = nodep;\n      nodep = Math.atan2(alfdp, betdp); //  sgp4fix for afspc written intrinsic functions\n      //  nodep used without a trigonometric function ahead\n\n      if (nodep < 0.0 && opsmode === 'a') {\n        nodep += twoPi;\n      }\n\n      if (Math.abs(xnoh - nodep) > pi) {\n        if (nodep < xnoh) {\n          nodep += twoPi;\n        } else {\n          nodep -= twoPi;\n        }\n      }\n\n      mp += pl;\n      argpp = xls - mp - cosip * nodep;\n    }\n  }\n\n  return {\n    ep: ep,\n    inclp: inclp,\n    nodep: nodep,\n    argpp: argpp,\n    mp: mp\n  };\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                           procedure dscom\n *\n *  this procedure provides deep space common items used by both the secular\n *    and periodics subroutines.  input is provided as shown. this routine\n *    used to be called dpper, but the functions inside weren't well organized.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    epoch       -\n *    ep          - eccentricity\n *    argpp       - argument of perigee\n *    tc          -\n *    inclp       - inclination\n *    nodep       - right ascension of ascending node\n *    np          - mean motion\n *\n *  outputs       :\n *    sinim  , cosim  , sinomm , cosomm , snodm  , cnodm\n *    day         -\n *    e3          -\n *    ee2         -\n *    em          - eccentricity\n *    emsq        - eccentricity squared\n *    gam         -\n *    peo         -\n *    pgho        -\n *    pho         -\n *    pinco       -\n *    plo         -\n *    rtemsq      -\n *    se2, se3         -\n *    sgh2, sgh3, sgh4        -\n *    sh2, sh3, si2, si3, sl2, sl3, sl4         -\n *    s1, s2, s3, s4, s5, s6, s7          -\n *    ss1, ss2, ss3, ss4, ss5, ss6, ss7, sz1, sz2, sz3         -\n *    sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33        -\n *    xgh2, xgh3, xgh4, xh2, xh3, xi2, xi3, xl2, xl3, xl4         -\n *    nm          - mean motion\n *    z1, z2, z3, z11, z12, z13, z21, z22, z23, z31, z32, z33         -\n *    zmol        -\n *    zmos        -\n *\n *  locals        :\n *    a1, a2, a3, a4, a5, a6, a7, a8, a9, a10         -\n *    betasq      -\n *    cc          -\n *    ctem, stem        -\n *    x1, x2, x3, x4, x5, x6, x7, x8          -\n *    xnodce      -\n *    xnoi        -\n *    zcosg  , zsing  , zcosgl , zsingl , zcosh  , zsinh  , zcoshl , zsinhl ,\n *    zcosi  , zsini  , zcosil , zsinil ,\n *    zx          -\n *    zy          -\n *\n *  coupling      :\n *    none.\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction dscom(options) {\n  var epoch = options.epoch,\n      ep = options.ep,\n      argpp = options.argpp,\n      tc = options.tc,\n      inclp = options.inclp,\n      nodep = options.nodep,\n      np = options.np;\n  var a1;\n  var a2;\n  var a3;\n  var a4;\n  var a5;\n  var a6;\n  var a7;\n  var a8;\n  var a9;\n  var a10;\n  var cc;\n  var x1;\n  var x2;\n  var x3;\n  var x4;\n  var x5;\n  var x6;\n  var x7;\n  var x8;\n  var zcosg;\n  var zsing;\n  var zcosh;\n  var zsinh;\n  var zcosi;\n  var zsini;\n  var ss1;\n  var ss2;\n  var ss3;\n  var ss4;\n  var ss5;\n  var ss6;\n  var ss7;\n  var sz1;\n  var sz2;\n  var sz3;\n  var sz11;\n  var sz12;\n  var sz13;\n  var sz21;\n  var sz22;\n  var sz23;\n  var sz31;\n  var sz32;\n  var sz33;\n  var s1;\n  var s2;\n  var s3;\n  var s4;\n  var s5;\n  var s6;\n  var s7;\n  var z1;\n  var z2;\n  var z3;\n  var z11;\n  var z12;\n  var z13;\n  var z21;\n  var z22;\n  var z23;\n  var z31;\n  var z32;\n  var z33; // -------------------------- constants -------------------------\n\n  var zes = 0.01675;\n  var zel = 0.05490;\n  var c1ss = 2.9864797e-6;\n  var c1l = 4.7968065e-7;\n  var zsinis = 0.39785416;\n  var zcosis = 0.91744867;\n  var zcosgs = 0.1945905;\n  var zsings = -0.98088458; //  --------------------- local variables ------------------------\n\n  var nm = np;\n  var em = ep;\n  var snodm = Math.sin(nodep);\n  var cnodm = Math.cos(nodep);\n  var sinomm = Math.sin(argpp);\n  var cosomm = Math.cos(argpp);\n  var sinim = Math.sin(inclp);\n  var cosim = Math.cos(inclp);\n  var emsq = em * em;\n  var betasq = 1.0 - emsq;\n  var rtemsq = Math.sqrt(betasq); //  ----------------- initialize lunar solar terms ---------------\n\n  var peo = 0.0;\n  var pinco = 0.0;\n  var plo = 0.0;\n  var pgho = 0.0;\n  var pho = 0.0;\n  var day = epoch + 18261.5 + tc / 1440.0;\n  var xnodce = (4.5236020 - 9.2422029e-4 * day) % twoPi;\n  var stem = Math.sin(xnodce);\n  var ctem = Math.cos(xnodce);\n  var zcosil = 0.91375164 - 0.03568096 * ctem;\n  var zsinil = Math.sqrt(1.0 - zcosil * zcosil);\n  var zsinhl = 0.089683511 * stem / zsinil;\n  var zcoshl = Math.sqrt(1.0 - zsinhl * zsinhl);\n  var gam = 5.8351514 + 0.0019443680 * day;\n  var zx = 0.39785416 * stem / zsinil;\n  var zy = zcoshl * ctem + 0.91744867 * zsinhl * stem;\n  zx = Math.atan2(zx, zy);\n  zx += gam - xnodce;\n  var zcosgl = Math.cos(zx);\n  var zsingl = Math.sin(zx); //  ------------------------- do solar terms ---------------------\n\n  zcosg = zcosgs;\n  zsing = zsings;\n  zcosi = zcosis;\n  zsini = zsinis;\n  zcosh = cnodm;\n  zsinh = snodm;\n  cc = c1ss;\n  var xnoi = 1.0 / nm;\n  var lsflg = 0;\n\n  while (lsflg < 2) {\n    lsflg += 1;\n    a1 = zcosg * zcosh + zsing * zcosi * zsinh;\n    a3 = -zsing * zcosh + zcosg * zcosi * zsinh;\n    a7 = -zcosg * zsinh + zsing * zcosi * zcosh;\n    a8 = zsing * zsini;\n    a9 = zsing * zsinh + zcosg * zcosi * zcosh;\n    a10 = zcosg * zsini;\n    a2 = cosim * a7 + sinim * a8;\n    a4 = cosim * a9 + sinim * a10;\n    a5 = -sinim * a7 + cosim * a8;\n    a6 = -sinim * a9 + cosim * a10;\n    x1 = a1 * cosomm + a2 * sinomm;\n    x2 = a3 * cosomm + a4 * sinomm;\n    x3 = -a1 * sinomm + a2 * cosomm;\n    x4 = -a3 * sinomm + a4 * cosomm;\n    x5 = a5 * sinomm;\n    x6 = a6 * sinomm;\n    x7 = a5 * cosomm;\n    x8 = a6 * cosomm;\n    z31 = 12.0 * x1 * x1 - 3.0 * x3 * x3;\n    z32 = 24.0 * x1 * x2 - 6.0 * x3 * x4;\n    z33 = 12.0 * x2 * x2 - 3.0 * x4 * x4;\n    z1 = 3.0 * (a1 * a1 + a2 * a2) + z31 * emsq;\n    z2 = 6.0 * (a1 * a3 + a2 * a4) + z32 * emsq;\n    z3 = 3.0 * (a3 * a3 + a4 * a4) + z33 * emsq;\n    z11 = -6.0 * a1 * a5 + emsq * (-24.0 * x1 * x7 - 6.0 * x3 * x5);\n    z12 = -6.0 * (a1 * a6 + a3 * a5) + emsq * (-24.0 * (x2 * x7 + x1 * x8) + -6.0 * (x3 * x6 + x4 * x5));\n    z13 = -6.0 * a3 * a6 + emsq * (-24.0 * x2 * x8 - 6.0 * x4 * x6);\n    z21 = 6.0 * a2 * a5 + emsq * (24.0 * x1 * x5 - 6.0 * x3 * x7);\n    z22 = 6.0 * (a4 * a5 + a2 * a6) + emsq * (24.0 * (x2 * x5 + x1 * x6) - 6.0 * (x4 * x7 + x3 * x8));\n    z23 = 6.0 * a4 * a6 + emsq * (24.0 * x2 * x6 - 6.0 * x4 * x8);\n    z1 = z1 + z1 + betasq * z31;\n    z2 = z2 + z2 + betasq * z32;\n    z3 = z3 + z3 + betasq * z33;\n    s3 = cc * xnoi;\n    s2 = -0.5 * s3 / rtemsq;\n    s4 = s3 * rtemsq;\n    s1 = -15.0 * em * s4;\n    s5 = x1 * x3 + x2 * x4;\n    s6 = x2 * x3 + x1 * x4;\n    s7 = x2 * x4 - x1 * x3; //  ----------------------- do lunar terms -------------------\n\n    if (lsflg === 1) {\n      ss1 = s1;\n      ss2 = s2;\n      ss3 = s3;\n      ss4 = s4;\n      ss5 = s5;\n      ss6 = s6;\n      ss7 = s7;\n      sz1 = z1;\n      sz2 = z2;\n      sz3 = z3;\n      sz11 = z11;\n      sz12 = z12;\n      sz13 = z13;\n      sz21 = z21;\n      sz22 = z22;\n      sz23 = z23;\n      sz31 = z31;\n      sz32 = z32;\n      sz33 = z33;\n      zcosg = zcosgl;\n      zsing = zsingl;\n      zcosi = zcosil;\n      zsini = zsinil;\n      zcosh = zcoshl * cnodm + zsinhl * snodm;\n      zsinh = snodm * zcoshl - cnodm * zsinhl;\n      cc = c1l;\n    }\n  }\n\n  var zmol = (4.7199672 + (0.22997150 * day - gam)) % twoPi;\n  var zmos = (6.2565837 + 0.017201977 * day) % twoPi; //  ------------------------ do solar terms ----------------------\n\n  var se2 = 2.0 * ss1 * ss6;\n  var se3 = 2.0 * ss1 * ss7;\n  var si2 = 2.0 * ss2 * sz12;\n  var si3 = 2.0 * ss2 * (sz13 - sz11);\n  var sl2 = -2.0 * ss3 * sz2;\n  var sl3 = -2.0 * ss3 * (sz3 - sz1);\n  var sl4 = -2.0 * ss3 * (-21.0 - 9.0 * emsq) * zes;\n  var sgh2 = 2.0 * ss4 * sz32;\n  var sgh3 = 2.0 * ss4 * (sz33 - sz31);\n  var sgh4 = -18.0 * ss4 * zes;\n  var sh2 = -2.0 * ss2 * sz22;\n  var sh3 = -2.0 * ss2 * (sz23 - sz21); //  ------------------------ do lunar terms ----------------------\n\n  var ee2 = 2.0 * s1 * s6;\n  var e3 = 2.0 * s1 * s7;\n  var xi2 = 2.0 * s2 * z12;\n  var xi3 = 2.0 * s2 * (z13 - z11);\n  var xl2 = -2.0 * s3 * z2;\n  var xl3 = -2.0 * s3 * (z3 - z1);\n  var xl4 = -2.0 * s3 * (-21.0 - 9.0 * emsq) * zel;\n  var xgh2 = 2.0 * s4 * z32;\n  var xgh3 = 2.0 * s4 * (z33 - z31);\n  var xgh4 = -18.0 * s4 * zel;\n  var xh2 = -2.0 * s2 * z22;\n  var xh3 = -2.0 * s2 * (z23 - z21);\n  return {\n    snodm: snodm,\n    cnodm: cnodm,\n    sinim: sinim,\n    cosim: cosim,\n    sinomm: sinomm,\n    cosomm: cosomm,\n    day: day,\n    e3: e3,\n    ee2: ee2,\n    em: em,\n    emsq: emsq,\n    gam: gam,\n    peo: peo,\n    pgho: pgho,\n    pho: pho,\n    pinco: pinco,\n    plo: plo,\n    rtemsq: rtemsq,\n    se2: se2,\n    se3: se3,\n    sgh2: sgh2,\n    sgh3: sgh3,\n    sgh4: sgh4,\n    sh2: sh2,\n    sh3: sh3,\n    si2: si2,\n    si3: si3,\n    sl2: sl2,\n    sl3: sl3,\n    sl4: sl4,\n    s1: s1,\n    s2: s2,\n    s3: s3,\n    s4: s4,\n    s5: s5,\n    s6: s6,\n    s7: s7,\n    ss1: ss1,\n    ss2: ss2,\n    ss3: ss3,\n    ss4: ss4,\n    ss5: ss5,\n    ss6: ss6,\n    ss7: ss7,\n    sz1: sz1,\n    sz2: sz2,\n    sz3: sz3,\n    sz11: sz11,\n    sz12: sz12,\n    sz13: sz13,\n    sz21: sz21,\n    sz22: sz22,\n    sz23: sz23,\n    sz31: sz31,\n    sz32: sz32,\n    sz33: sz33,\n    xgh2: xgh2,\n    xgh3: xgh3,\n    xgh4: xgh4,\n    xh2: xh2,\n    xh3: xh3,\n    xi2: xi2,\n    xi3: xi3,\n    xl2: xl2,\n    xl3: xl3,\n    xl4: xl4,\n    nm: nm,\n    z1: z1,\n    z2: z2,\n    z3: z3,\n    z11: z11,\n    z12: z12,\n    z13: z13,\n    z21: z21,\n    z22: z22,\n    z23: z23,\n    z31: z31,\n    z32: z32,\n    z33: z33,\n    zmol: zmol,\n    zmos: zmos\n  };\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                           procedure dsinit\n *\n *  this procedure provides deep space contributions to mean motion dot due\n *    to geopotential resonance with half day and one day orbits.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    cosim, sinim-\n *    emsq        - eccentricity squared\n *    argpo       - argument of perigee\n *    s1, s2, s3, s4, s5      -\n *    ss1, ss2, ss3, ss4, ss5 -\n *    sz1, sz3, sz11, sz13, sz21, sz23, sz31, sz33 -\n *    t           - time\n *    tc          -\n *    gsto        - greenwich sidereal time                   rad\n *    mo          - mean anomaly\n *    mdot        - mean anomaly dot (rate)\n *    no          - mean motion\n *    nodeo       - right ascension of ascending node\n *    nodedot     - right ascension of ascending node dot (rate)\n *    xpidot      -\n *    z1, z3, z11, z13, z21, z23, z31, z33 -\n *    eccm        - eccentricity\n *    argpm       - argument of perigee\n *    inclm       - inclination\n *    mm          - mean anomaly\n *    xn          - mean motion\n *    nodem       - right ascension of ascending node\n *\n *  outputs       :\n *    em          - eccentricity\n *    argpm       - argument of perigee\n *    inclm       - inclination\n *    mm          - mean anomaly\n *    nm          - mean motion\n *    nodem       - right ascension of ascending node\n *    irez        - flag for resonance           0-none, 1-one day, 2-half day\n *    atime       -\n *    d2201, d2211, d3210, d3222, d4410, d4422, d5220, d5232, d5421, d5433    -\n *    dedt        -\n *    didt        -\n *    dmdt        -\n *    dndt        -\n *    dnodt       -\n *    domdt       -\n *    del1, del2, del3        -\n *    ses  , sghl , sghs , sgs  , shl  , shs  , sis  , sls\n *    theta       -\n *    xfact       -\n *    xlamo       -\n *    xli         -\n *    xni\n *\n *  locals        :\n *    ainv2       -\n *    aonv        -\n *    cosisq      -\n *    eoc         -\n *    f220, f221, f311, f321, f322, f330, f441, f442, f522, f523, f542, f543  -\n *    g200, g201, g211, g300, g310, g322, g410, g422, g520, g521, g532, g533  -\n *    sini2       -\n *    temp        -\n *    temp1       -\n *    theta       -\n *    xno2        -\n *\n *  coupling      :\n *    getgravconst\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction dsinit(options) {\n  var cosim = options.cosim,\n      argpo = options.argpo,\n      s1 = options.s1,\n      s2 = options.s2,\n      s3 = options.s3,\n      s4 = options.s4,\n      s5 = options.s5,\n      sinim = options.sinim,\n      ss1 = options.ss1,\n      ss2 = options.ss2,\n      ss3 = options.ss3,\n      ss4 = options.ss4,\n      ss5 = options.ss5,\n      sz1 = options.sz1,\n      sz3 = options.sz3,\n      sz11 = options.sz11,\n      sz13 = options.sz13,\n      sz21 = options.sz21,\n      sz23 = options.sz23,\n      sz31 = options.sz31,\n      sz33 = options.sz33,\n      t = options.t,\n      tc = options.tc,\n      gsto = options.gsto,\n      mo = options.mo,\n      mdot = options.mdot,\n      no = options.no,\n      nodeo = options.nodeo,\n      nodedot = options.nodedot,\n      xpidot = options.xpidot,\n      z1 = options.z1,\n      z3 = options.z3,\n      z11 = options.z11,\n      z13 = options.z13,\n      z21 = options.z21,\n      z23 = options.z23,\n      z31 = options.z31,\n      z33 = options.z33,\n      ecco = options.ecco,\n      eccsq = options.eccsq;\n  var emsq = options.emsq,\n      em = options.em,\n      argpm = options.argpm,\n      inclm = options.inclm,\n      mm = options.mm,\n      nm = options.nm,\n      nodem = options.nodem,\n      irez = options.irez,\n      atime = options.atime,\n      d2201 = options.d2201,\n      d2211 = options.d2211,\n      d3210 = options.d3210,\n      d3222 = options.d3222,\n      d4410 = options.d4410,\n      d4422 = options.d4422,\n      d5220 = options.d5220,\n      d5232 = options.d5232,\n      d5421 = options.d5421,\n      d5433 = options.d5433,\n      dedt = options.dedt,\n      didt = options.didt,\n      dmdt = options.dmdt,\n      dnodt = options.dnodt,\n      domdt = options.domdt,\n      del1 = options.del1,\n      del2 = options.del2,\n      del3 = options.del3,\n      xfact = options.xfact,\n      xlamo = options.xlamo,\n      xli = options.xli,\n      xni = options.xni;\n  var f220;\n  var f221;\n  var f311;\n  var f321;\n  var f322;\n  var f330;\n  var f441;\n  var f442;\n  var f522;\n  var f523;\n  var f542;\n  var f543;\n  var g200;\n  var g201;\n  var g211;\n  var g300;\n  var g310;\n  var g322;\n  var g410;\n  var g422;\n  var g520;\n  var g521;\n  var g532;\n  var g533;\n  var sini2;\n  var temp;\n  var temp1;\n  var xno2;\n  var ainv2;\n  var aonv;\n  var cosisq;\n  var eoc;\n  var q22 = 1.7891679e-6;\n  var q31 = 2.1460748e-6;\n  var q33 = 2.2123015e-7;\n  var root22 = 1.7891679e-6;\n  var root44 = 7.3636953e-9;\n  var root54 = 2.1765803e-9;\n  var rptim = 4.37526908801129966e-3; // equates to 7.29211514668855e-5 rad/sec\n\n  var root32 = 3.7393792e-7;\n  var root52 = 1.1428639e-7;\n  var znl = 1.5835218e-4;\n  var zns = 1.19459e-5; // -------------------- deep space initialization ------------\n\n  irez = 0;\n\n  if (nm < 0.0052359877 && nm > 0.0034906585) {\n    irez = 1;\n  }\n\n  if (nm >= 8.26e-3 && nm <= 9.24e-3 && em >= 0.5) {\n    irez = 2;\n  } // ------------------------ do solar terms -------------------\n\n\n  var ses = ss1 * zns * ss5;\n  var sis = ss2 * zns * (sz11 + sz13);\n  var sls = -zns * ss3 * (sz1 + sz3 - 14.0 - 6.0 * emsq);\n  var sghs = ss4 * zns * (sz31 + sz33 - 6.0);\n  var shs = -zns * ss2 * (sz21 + sz23); // sgp4fix for 180 deg incl\n\n  if (inclm < 5.2359877e-2 || inclm > pi - 5.2359877e-2) {\n    shs = 0.0;\n  }\n\n  if (sinim !== 0.0) {\n    shs /= sinim;\n  }\n\n  var sgs = sghs - cosim * shs; // ------------------------- do lunar terms ------------------\n\n  dedt = ses + s1 * znl * s5;\n  didt = sis + s2 * znl * (z11 + z13);\n  dmdt = sls - znl * s3 * (z1 + z3 - 14.0 - 6.0 * emsq);\n  var sghl = s4 * znl * (z31 + z33 - 6.0);\n  var shll = -znl * s2 * (z21 + z23); // sgp4fix for 180 deg incl\n\n  if (inclm < 5.2359877e-2 || inclm > pi - 5.2359877e-2) {\n    shll = 0.0;\n  }\n\n  domdt = sgs + sghl;\n  dnodt = shs;\n\n  if (sinim !== 0.0) {\n    domdt -= cosim / sinim * shll;\n    dnodt += shll / sinim;\n  } // ----------- calculate deep space resonance effects --------\n\n\n  var dndt = 0.0;\n  var theta = (gsto + tc * rptim) % twoPi;\n  em += dedt * t;\n  inclm += didt * t;\n  argpm += domdt * t;\n  nodem += dnodt * t;\n  mm += dmdt * t; // sgp4fix for negative inclinations\n  // the following if statement should be commented out\n  // if (inclm < 0.0)\n  // {\n  //   inclm  = -inclm;\n  //   argpm  = argpm - pi;\n  //   nodem = nodem + pi;\n  // }\n  // -------------- initialize the resonance terms -------------\n\n  if (irez !== 0) {\n    aonv = Math.pow(nm / xke, x2o3); // ---------- geopotential resonance for 12 hour orbits ------\n\n    if (irez === 2) {\n      cosisq = cosim * cosim;\n      var emo = em;\n      em = ecco;\n      var emsqo = emsq;\n      emsq = eccsq;\n      eoc = em * emsq;\n      g201 = -0.306 - (em - 0.64) * 0.440;\n\n      if (em <= 0.65) {\n        g211 = 3.616 - 13.2470 * em + 16.2900 * emsq;\n        g310 = -19.302 + 117.3900 * em - 228.4190 * emsq + 156.5910 * eoc;\n        g322 = -18.9068 + 109.7927 * em - 214.6334 * emsq + 146.5816 * eoc;\n        g410 = -41.122 + 242.6940 * em - 471.0940 * emsq + 313.9530 * eoc;\n        g422 = -146.407 + 841.8800 * em - 1629.014 * emsq + 1083.4350 * eoc;\n        g520 = -532.114 + 3017.977 * em - 5740.032 * emsq + 3708.2760 * eoc;\n      } else {\n        g211 = -72.099 + 331.819 * em - 508.738 * emsq + 266.724 * eoc;\n        g310 = -346.844 + 1582.851 * em - 2415.925 * emsq + 1246.113 * eoc;\n        g322 = -342.585 + 1554.908 * em - 2366.899 * emsq + 1215.972 * eoc;\n        g410 = -1052.797 + 4758.686 * em - 7193.992 * emsq + 3651.957 * eoc;\n        g422 = -3581.690 + 16178.110 * em - 24462.770 * emsq + 12422.520 * eoc;\n\n        if (em > 0.715) {\n          g520 = -5149.66 + 29936.92 * em - 54087.36 * emsq + 31324.56 * eoc;\n        } else {\n          g520 = 1464.74 - 4664.75 * em + 3763.64 * emsq;\n        }\n      }\n\n      if (em < 0.7) {\n        g533 = -919.22770 + 4988.6100 * em - 9064.7700 * emsq + 5542.21 * eoc;\n        g521 = -822.71072 + 4568.6173 * em - 8491.4146 * emsq + 5337.524 * eoc;\n        g532 = -853.66600 + 4690.2500 * em - 8624.7700 * emsq + 5341.4 * eoc;\n      } else {\n        g533 = -37995.780 + 161616.52 * em - 229838.20 * emsq + 109377.94 * eoc;\n        g521 = -51752.104 + 218913.95 * em - 309468.16 * emsq + 146349.42 * eoc;\n        g532 = -40023.880 + 170470.89 * em - 242699.48 * emsq + 115605.82 * eoc;\n      }\n\n      sini2 = sinim * sinim;\n      f220 = 0.75 * (1.0 + 2.0 * cosim + cosisq);\n      f221 = 1.5 * sini2;\n      f321 = 1.875 * sinim * (1.0 - 2.0 * cosim - 3.0 * cosisq);\n      f322 = -1.875 * sinim * (1.0 + 2.0 * cosim - 3.0 * cosisq);\n      f441 = 35.0 * sini2 * f220;\n      f442 = 39.3750 * sini2 * sini2;\n      f522 = 9.84375 * sinim * (sini2 * (1.0 - 2.0 * cosim - 5.0 * cosisq) + 0.33333333 * (-2.0 + 4.0 * cosim + 6.0 * cosisq));\n      f523 = sinim * (4.92187512 * sini2 * (-2.0 - 4.0 * cosim + 10.0 * cosisq) + 6.56250012 * (1.0 + 2.0 * cosim - 3.0 * cosisq));\n      f542 = 29.53125 * sinim * (2.0 - 8.0 * cosim + cosisq * (-12.0 + 8.0 * cosim + 10.0 * cosisq));\n      f543 = 29.53125 * sinim * (-2.0 - 8.0 * cosim + cosisq * (12.0 + 8.0 * cosim - 10.0 * cosisq));\n      xno2 = nm * nm;\n      ainv2 = aonv * aonv;\n      temp1 = 3.0 * xno2 * ainv2;\n      temp = temp1 * root22;\n      d2201 = temp * f220 * g201;\n      d2211 = temp * f221 * g211;\n      temp1 *= aonv;\n      temp = temp1 * root32;\n      d3210 = temp * f321 * g310;\n      d3222 = temp * f322 * g322;\n      temp1 *= aonv;\n      temp = 2.0 * temp1 * root44;\n      d4410 = temp * f441 * g410;\n      d4422 = temp * f442 * g422;\n      temp1 *= aonv;\n      temp = temp1 * root52;\n      d5220 = temp * f522 * g520;\n      d5232 = temp * f523 * g532;\n      temp = 2.0 * temp1 * root54;\n      d5421 = temp * f542 * g521;\n      d5433 = temp * f543 * g533;\n      xlamo = (mo + nodeo + nodeo - (theta + theta)) % twoPi;\n      xfact = mdot + dmdt + 2.0 * (nodedot + dnodt - rptim) - no;\n      em = emo;\n      emsq = emsqo;\n    } //  ---------------- synchronous resonance terms --------------\n\n\n    if (irez === 1) {\n      g200 = 1.0 + emsq * (-2.5 + 0.8125 * emsq);\n      g310 = 1.0 + 2.0 * emsq;\n      g300 = 1.0 + emsq * (-6.0 + 6.60937 * emsq);\n      f220 = 0.75 * (1.0 + cosim) * (1.0 + cosim);\n      f311 = 0.9375 * sinim * sinim * (1.0 + 3.0 * cosim) - 0.75 * (1.0 + cosim);\n      f330 = 1.0 + cosim;\n      f330 *= 1.875 * f330 * f330;\n      del1 = 3.0 * nm * nm * aonv * aonv;\n      del2 = 2.0 * del1 * f220 * g200 * q22;\n      del3 = 3.0 * del1 * f330 * g300 * q33 * aonv;\n      del1 = del1 * f311 * g310 * q31 * aonv;\n      xlamo = (mo + nodeo + argpo - theta) % twoPi;\n      xfact = mdot + xpidot + dmdt + domdt + dnodt - (no + rptim);\n    } //  ------------ for sgp4, initialize the integrator ----------\n\n\n    xli = xlamo;\n    xni = no;\n    atime = 0.0;\n    nm = no + dndt;\n  }\n\n  return {\n    em: em,\n    argpm: argpm,\n    inclm: inclm,\n    mm: mm,\n    nm: nm,\n    nodem: nodem,\n    irez: irez,\n    atime: atime,\n    d2201: d2201,\n    d2211: d2211,\n    d3210: d3210,\n    d3222: d3222,\n    d4410: d4410,\n    d4422: d4422,\n    d5220: d5220,\n    d5232: d5232,\n    d5421: d5421,\n    d5433: d5433,\n    dedt: dedt,\n    didt: didt,\n    dmdt: dmdt,\n    dndt: dndt,\n    dnodt: dnodt,\n    domdt: domdt,\n    del1: del1,\n    del2: del2,\n    del3: del3,\n    xfact: xfact,\n    xlamo: xlamo,\n    xli: xli,\n    xni: xni\n  };\n}\n\n/* -----------------------------------------------------------------------------\n *\n *                           function gstime\n *\n *  this function finds the greenwich sidereal time.\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs          description                    range / units\n *    jdut1       - julian date in ut1             days from 4713 bc\n *\n *  outputs       :\n *    d      - greenwich sidereal time        0 to 2pi rad\n *\n *  locals        :\n *    temp        - temporary variable for doubles   rad\n *    tut1        - julian centuries from the\n *                  jan 1, 2000 12 h epoch (ut1)\n *\n *  coupling      :\n *    none\n *\n *  references    :\n *    vallado       2004, 191, eq 3-45\n * --------------------------------------------------------------------------- */\n\nfunction gstimeInternal(jdut1) {\n  var tut1 = (jdut1 - 2451545.0) / 36525.0;\n  var temp = -6.2e-6 * tut1 * tut1 * tut1 + 0.093104 * tut1 * tut1 + (876600.0 * 3600 + 8640184.812866) * tut1 + 67310.54841; // # sec\n\n  temp = temp * deg2rad / 240.0 % twoPi; // 360/86400 = 1/240, to deg, to rad\n  //  ------------------------ check quadrants ---------------------\n\n  if (temp < 0.0) {\n    temp += twoPi;\n  }\n\n  return temp;\n}\n\nfunction gstime() {\n  if ((arguments.length <= 0 ? undefined : arguments[0]) instanceof Date || arguments.length > 1) {\n    return gstimeInternal(jday.apply(void 0, arguments));\n  }\n\n  return gstimeInternal.apply(void 0, arguments);\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                           procedure initl\n *\n *  this procedure initializes the sgp4 propagator. all the initialization is\n *    consolidated here instead of having multiple loops inside other routines.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    ecco        - eccentricity                           0.0 - 1.0\n *    epoch       - epoch time in days from jan 0, 1950. 0 hr\n *    inclo       - inclination of satellite\n *    no          - mean motion of satellite\n *    satn        - satellite number\n *\n *  outputs       :\n *    ainv        - 1.0 / a\n *    ao          - semi major axis\n *    con41       -\n *    con42       - 1.0 - 5.0 cos(i)\n *    cosio       - cosine of inclination\n *    cosio2      - cosio squared\n *    eccsq       - eccentricity squared\n *    method      - flag for deep space                    'd', 'n'\n *    omeosq      - 1.0 - ecco * ecco\n *    posq        - semi-parameter squared\n *    rp          - radius of perigee\n *    rteosq      - square root of (1.0 - ecco*ecco)\n *    sinio       - sine of inclination\n *    gsto        - gst at time of observation               rad\n *    no          - mean motion of satellite\n *\n *  locals        :\n *    ak          -\n *    d1          -\n *    del         -\n *    adel        -\n *    po          -\n *\n *  coupling      :\n *    getgravconst\n *    gstime      - find greenwich sidereal time from the julian date\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction initl(options) {\n  var ecco = options.ecco,\n      epoch = options.epoch,\n      inclo = options.inclo,\n      opsmode = options.opsmode;\n  var no = options.no; // sgp4fix use old way of finding gst\n  // ----------------------- earth constants ---------------------\n  // sgp4fix identify constants and allow alternate values\n  // ------------- calculate auxillary epoch quantities ----------\n\n  var eccsq = ecco * ecco;\n  var omeosq = 1.0 - eccsq;\n  var rteosq = Math.sqrt(omeosq);\n  var cosio = Math.cos(inclo);\n  var cosio2 = cosio * cosio; // ------------------ un-kozai the mean motion -----------------\n\n  var ak = Math.pow(xke / no, x2o3);\n  var d1 = 0.75 * j2 * (3.0 * cosio2 - 1.0) / (rteosq * omeosq);\n  var delPrime = d1 / (ak * ak);\n  var adel = ak * (1.0 - delPrime * delPrime - delPrime * (1.0 / 3.0 + 134.0 * delPrime * delPrime / 81.0));\n  delPrime = d1 / (adel * adel);\n  no /= 1.0 + delPrime;\n  var ao = Math.pow(xke / no, x2o3);\n  var sinio = Math.sin(inclo);\n  var po = ao * omeosq;\n  var con42 = 1.0 - 5.0 * cosio2;\n  var con41 = -con42 - cosio2 - cosio2;\n  var ainv = 1.0 / ao;\n  var posq = po * po;\n  var rp = ao * (1.0 - ecco);\n  var method = 'n'; //  sgp4fix modern approach to finding sidereal time\n\n  var gsto;\n\n  if (opsmode === 'a') {\n    //  sgp4fix use old way of finding gst\n    //  count integer number of days from 0 jan 1970\n    var ts70 = epoch - 7305.0;\n    var ds70 = Math.floor(ts70 + 1.0e-8);\n    var tfrac = ts70 - ds70; //  find greenwich location at epoch\n\n    var c1 = 1.72027916940703639e-2;\n    var thgr70 = 1.7321343856509374;\n    var fk5r = 5.07551419432269442e-15;\n    var c1p2p = c1 + twoPi;\n    gsto = (thgr70 + c1 * ds70 + c1p2p * tfrac + ts70 * ts70 * fk5r) % twoPi;\n\n    if (gsto < 0.0) {\n      gsto += twoPi;\n    }\n  } else {\n    gsto = gstime(epoch + 2433281.5);\n  }\n\n  return {\n    no: no,\n    method: method,\n    ainv: ainv,\n    ao: ao,\n    con41: con41,\n    con42: con42,\n    cosio: cosio,\n    cosio2: cosio2,\n    eccsq: eccsq,\n    omeosq: omeosq,\n    posq: posq,\n    rp: rp,\n    rteosq: rteosq,\n    sinio: sinio,\n    gsto: gsto\n  };\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                           procedure dspace\n *\n *  this procedure provides deep space contributions to mean elements for\n *    perturbing third body.  these effects have been averaged over one\n *    revolution of the sun and moon.  for earth resonance effects, the\n *    effects have been averaged over no revolutions of the satellite.\n *    (mean motion)\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    d2201, d2211, d3210, d3222, d4410, d4422, d5220, d5232, d5421, d5433 -\n *    dedt        -\n *    del1, del2, del3  -\n *    didt        -\n *    dmdt        -\n *    dnodt       -\n *    domdt       -\n *    irez        - flag for resonance           0-none, 1-one day, 2-half day\n *    argpo       - argument of perigee\n *    argpdot     - argument of perigee dot (rate)\n *    t           - time\n *    tc          -\n *    gsto        - gst\n *    xfact       -\n *    xlamo       -\n *    no          - mean motion\n *    atime       -\n *    em          - eccentricity\n *    ft          -\n *    argpm       - argument of perigee\n *    inclm       - inclination\n *    xli         -\n *    mm          - mean anomaly\n *    xni         - mean motion\n *    nodem       - right ascension of ascending node\n *\n *  outputs       :\n *    atime       -\n *    em          - eccentricity\n *    argpm       - argument of perigee\n *    inclm       - inclination\n *    xli         -\n *    mm          - mean anomaly\n *    xni         -\n *    nodem       - right ascension of ascending node\n *    dndt        -\n *    nm          - mean motion\n *\n *  locals        :\n *    delt        -\n *    ft          -\n *    theta       -\n *    x2li        -\n *    x2omi       -\n *    xl          -\n *    xldot       -\n *    xnddt       -\n *    xndt        -\n *    xomi        -\n *\n *  coupling      :\n *    none        -\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction dspace(options) {\n  var irez = options.irez,\n      d2201 = options.d2201,\n      d2211 = options.d2211,\n      d3210 = options.d3210,\n      d3222 = options.d3222,\n      d4410 = options.d4410,\n      d4422 = options.d4422,\n      d5220 = options.d5220,\n      d5232 = options.d5232,\n      d5421 = options.d5421,\n      d5433 = options.d5433,\n      dedt = options.dedt,\n      del1 = options.del1,\n      del2 = options.del2,\n      del3 = options.del3,\n      didt = options.didt,\n      dmdt = options.dmdt,\n      dnodt = options.dnodt,\n      domdt = options.domdt,\n      argpo = options.argpo,\n      argpdot = options.argpdot,\n      t = options.t,\n      tc = options.tc,\n      gsto = options.gsto,\n      xfact = options.xfact,\n      xlamo = options.xlamo,\n      no = options.no;\n  var atime = options.atime,\n      em = options.em,\n      argpm = options.argpm,\n      inclm = options.inclm,\n      xli = options.xli,\n      mm = options.mm,\n      xni = options.xni,\n      nodem = options.nodem,\n      nm = options.nm;\n  var fasx2 = 0.13130908;\n  var fasx4 = 2.8843198;\n  var fasx6 = 0.37448087;\n  var g22 = 5.7686396;\n  var g32 = 0.95240898;\n  var g44 = 1.8014998;\n  var g52 = 1.0508330;\n  var g54 = 4.4108898;\n  var rptim = 4.37526908801129966e-3; // equates to 7.29211514668855e-5 rad/sec\n\n  var stepp = 720.0;\n  var stepn = -720.0;\n  var step2 = 259200.0;\n  var delt;\n  var x2li;\n  var x2omi;\n  var xl;\n  var xldot;\n  var xnddt;\n  var xndt;\n  var xomi;\n  var dndt = 0.0;\n  var ft = 0.0; //  ----------- calculate deep space resonance effects -----------\n\n  var theta = (gsto + tc * rptim) % twoPi;\n  em += dedt * t;\n  inclm += didt * t;\n  argpm += domdt * t;\n  nodem += dnodt * t;\n  mm += dmdt * t; // sgp4fix for negative inclinations\n  // the following if statement should be commented out\n  // if (inclm < 0.0)\n  // {\n  //   inclm = -inclm;\n  //   argpm = argpm - pi;\n  //   nodem = nodem + pi;\n  // }\n\n  /* - update resonances : numerical (euler-maclaurin) integration - */\n\n  /* ------------------------- epoch restart ----------------------  */\n  //   sgp4fix for propagator problems\n  //   the following integration works for negative time steps and periods\n  //   the specific changes are unknown because the original code was so convoluted\n  // sgp4fix take out atime = 0.0 and fix for faster operation\n\n  if (irez !== 0) {\n    //  sgp4fix streamline check\n    if (atime === 0.0 || t * atime <= 0.0 || Math.abs(t) < Math.abs(atime)) {\n      atime = 0.0;\n      xni = no;\n      xli = xlamo;\n    } // sgp4fix move check outside loop\n\n\n    if (t > 0.0) {\n      delt = stepp;\n    } else {\n      delt = stepn;\n    }\n\n    var iretn = 381; // added for do loop\n\n    while (iretn === 381) {\n      //  ------------------- dot terms calculated -------------\n      //  ----------- near - synchronous resonance terms -------\n      if (irez !== 2) {\n        xndt = del1 * Math.sin(xli - fasx2) + del2 * Math.sin(2.0 * (xli - fasx4)) + del3 * Math.sin(3.0 * (xli - fasx6));\n        xldot = xni + xfact;\n        xnddt = del1 * Math.cos(xli - fasx2) + 2.0 * del2 * Math.cos(2.0 * (xli - fasx4)) + 3.0 * del3 * Math.cos(3.0 * (xli - fasx6));\n        xnddt *= xldot;\n      } else {\n        // --------- near - half-day resonance terms --------\n        xomi = argpo + argpdot * atime;\n        x2omi = xomi + xomi;\n        x2li = xli + xli;\n        xndt = d2201 * Math.sin(x2omi + xli - g22) + d2211 * Math.sin(xli - g22) + d3210 * Math.sin(xomi + xli - g32) + d3222 * Math.sin(-xomi + xli - g32) + d4410 * Math.sin(x2omi + x2li - g44) + d4422 * Math.sin(x2li - g44) + d5220 * Math.sin(xomi + xli - g52) + d5232 * Math.sin(-xomi + xli - g52) + d5421 * Math.sin(xomi + x2li - g54) + d5433 * Math.sin(-xomi + x2li - g54);\n        xldot = xni + xfact;\n        xnddt = d2201 * Math.cos(x2omi + xli - g22) + d2211 * Math.cos(xli - g22) + d3210 * Math.cos(xomi + xli - g32) + d3222 * Math.cos(-xomi + xli - g32) + d5220 * Math.cos(xomi + xli - g52) + d5232 * Math.cos(-xomi + xli - g52) + 2.0 * d4410 * Math.cos(x2omi + x2li - g44) + d4422 * Math.cos(x2li - g44) + d5421 * Math.cos(xomi + x2li - g54) + d5433 * Math.cos(-xomi + x2li - g54);\n        xnddt *= xldot;\n      } //  ----------------------- integrator -------------------\n      //  sgp4fix move end checks to end of routine\n\n\n      if (Math.abs(t - atime) >= stepp) {\n        iretn = 381;\n      } else {\n        ft = t - atime;\n        iretn = 0;\n      }\n\n      if (iretn === 381) {\n        xli += xldot * delt + xndt * step2;\n        xni += xndt * delt + xnddt * step2;\n        atime += delt;\n      }\n    }\n\n    nm = xni + xndt * ft + xnddt * ft * ft * 0.5;\n    xl = xli + xldot * ft + xndt * ft * ft * 0.5;\n\n    if (irez !== 1) {\n      mm = xl - 2.0 * nodem + 2.0 * theta;\n      dndt = nm - no;\n    } else {\n      mm = xl - nodem - argpm + theta;\n      dndt = nm - no;\n    }\n\n    nm = no + dndt;\n  }\n\n  return {\n    atime: atime,\n    em: em,\n    argpm: argpm,\n    inclm: inclm,\n    xli: xli,\n    mm: mm,\n    xni: xni,\n    nodem: nodem,\n    dndt: dndt,\n    nm: nm\n  };\n}\n\n/*----------------------------------------------------------------------------\n *\n *                             procedure sgp4\n *\n *  this procedure is the sgp4 prediction model from space command. this is an\n *    updated and combined version of sgp4 and sdp4, which were originally\n *    published separately in spacetrack report //3. this version follows the\n *    methodology from the aiaa paper (2006) describing the history and\n *    development of the code.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    satrec  - initialised structure from sgp4init() call.\n *    tsince  - time since epoch (minutes)\n *\n *  outputs       :\n *    r           - position vector                     km\n *    v           - velocity                            km/sec\n *  return code - non-zero on error.\n *                   1 - mean elements, ecc >= 1.0 or ecc < -0.001 or a < 0.95 er\n *                   2 - mean motion less than 0.0\n *                   3 - pert elements, ecc < 0.0  or  ecc > 1.0\n *                   4 - semi-latus rectum < 0.0\n *                   5 - epoch elements are sub-orbital\n *                   6 - satellite has decayed\n *\n *  locals        :\n *    am          -\n *    axnl, aynl        -\n *    betal       -\n *    cosim   , sinim   , cosomm  , sinomm  , cnod    , snod    , cos2u   ,\n *    sin2u   , coseo1  , sineo1  , cosi    , sini    , cosip   , sinip   ,\n *    cosisq  , cossu   , sinsu   , cosu    , sinu\n *    delm        -\n *    delomg      -\n *    dndt        -\n *    eccm        -\n *    emsq        -\n *    ecose       -\n *    el2         -\n *    eo1         -\n *    eccp        -\n *    esine       -\n *    argpm       -\n *    argpp       -\n *    omgadf      -\n *    pl          -\n *    r           -\n *    rtemsq      -\n *    rdotl       -\n *    rl          -\n *    rvdot       -\n *    rvdotl      -\n *    su          -\n *    t2  , t3   , t4    , tc\n *    tem5, temp , temp1 , temp2  , tempa  , tempe  , templ\n *    u   , ux   , uy    , uz     , vx     , vy     , vz\n *    inclm       - inclination\n *    mm          - mean anomaly\n *    nm          - mean motion\n *    nodem       - right asc of ascending node\n *    xinc        -\n *    xincp       -\n *    xl          -\n *    xlm         -\n *    mp          -\n *    xmdf        -\n *    xmx         -\n *    xmy         -\n *    nodedf      -\n *    xnode       -\n *    nodep       -\n *    np          -\n *\n *  coupling      :\n *    getgravconst-\n *    dpper\n *    dspace\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report //3 1980\n *    hoots, norad spacetrack report //6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction sgp4(satrec, tsince) {\n  /* eslint-disable no-param-reassign */\n  var coseo1;\n  var sineo1;\n  var cosip;\n  var sinip;\n  var cosisq;\n  var delm;\n  var delomg;\n  var eo1;\n  var argpm;\n  var argpp;\n  var su;\n  var t3;\n  var t4;\n  var tc;\n  var tem5;\n  var temp;\n  var tempa;\n  var tempe;\n  var templ;\n  var inclm;\n  var mm;\n  var nm;\n  var nodem;\n  var xincp;\n  var xlm;\n  var mp;\n  var nodep;\n  /* ------------------ set mathematical constants --------------- */\n  // sgp4fix divisor for divide by zero check on inclination\n  // the old check used 1.0 + cos(pi-1.0e-9), but then compared it to\n  // 1.5 e-12, so the threshold was changed to 1.5e-12 for consistency\n\n  var temp4 = 1.5e-12; // --------------------- clear sgp4 error flag -----------------\n\n  satrec.t = tsince;\n  satrec.error = 0; //  ------- update for secular gravity and atmospheric drag -----\n\n  var xmdf = satrec.mo + satrec.mdot * satrec.t;\n  var argpdf = satrec.argpo + satrec.argpdot * satrec.t;\n  var nodedf = satrec.nodeo + satrec.nodedot * satrec.t;\n  argpm = argpdf;\n  mm = xmdf;\n  var t2 = satrec.t * satrec.t;\n  nodem = nodedf + satrec.nodecf * t2;\n  tempa = 1.0 - satrec.cc1 * satrec.t;\n  tempe = satrec.bstar * satrec.cc4 * satrec.t;\n  templ = satrec.t2cof * t2;\n\n  if (satrec.isimp !== 1) {\n    delomg = satrec.omgcof * satrec.t; //  sgp4fix use mutliply for speed instead of pow\n\n    var delmtemp = 1.0 + satrec.eta * Math.cos(xmdf);\n    delm = satrec.xmcof * (delmtemp * delmtemp * delmtemp - satrec.delmo);\n    temp = delomg + delm;\n    mm = xmdf + temp;\n    argpm = argpdf - temp;\n    t3 = t2 * satrec.t;\n    t4 = t3 * satrec.t;\n    tempa = tempa - satrec.d2 * t2 - satrec.d3 * t3 - satrec.d4 * t4;\n    tempe += satrec.bstar * satrec.cc5 * (Math.sin(mm) - satrec.sinmao);\n    templ = templ + satrec.t3cof * t3 + t4 * (satrec.t4cof + satrec.t * satrec.t5cof);\n  }\n\n  nm = satrec.no;\n  var em = satrec.ecco;\n  inclm = satrec.inclo;\n\n  if (satrec.method === 'd') {\n    tc = satrec.t;\n    var dspaceOptions = {\n      irez: satrec.irez,\n      d2201: satrec.d2201,\n      d2211: satrec.d2211,\n      d3210: satrec.d3210,\n      d3222: satrec.d3222,\n      d4410: satrec.d4410,\n      d4422: satrec.d4422,\n      d5220: satrec.d5220,\n      d5232: satrec.d5232,\n      d5421: satrec.d5421,\n      d5433: satrec.d5433,\n      dedt: satrec.dedt,\n      del1: satrec.del1,\n      del2: satrec.del2,\n      del3: satrec.del3,\n      didt: satrec.didt,\n      dmdt: satrec.dmdt,\n      dnodt: satrec.dnodt,\n      domdt: satrec.domdt,\n      argpo: satrec.argpo,\n      argpdot: satrec.argpdot,\n      t: satrec.t,\n      tc: tc,\n      gsto: satrec.gsto,\n      xfact: satrec.xfact,\n      xlamo: satrec.xlamo,\n      no: satrec.no,\n      atime: satrec.atime,\n      em: em,\n      argpm: argpm,\n      inclm: inclm,\n      xli: satrec.xli,\n      mm: mm,\n      xni: satrec.xni,\n      nodem: nodem,\n      nm: nm\n    };\n    var dspaceResult = dspace(dspaceOptions);\n    em = dspaceResult.em;\n    argpm = dspaceResult.argpm;\n    inclm = dspaceResult.inclm;\n    mm = dspaceResult.mm;\n    nodem = dspaceResult.nodem;\n    nm = dspaceResult.nm;\n  }\n\n  if (nm <= 0.0) {\n    // printf(\"// error nm %f\\n\", nm);\n    satrec.error = 2; // sgp4fix add return\n\n    return [false, false];\n  }\n\n  var am = Math.pow(xke / nm, x2o3) * tempa * tempa;\n  nm = xke / Math.pow(am, 1.5);\n  em -= tempe; // fix tolerance for error recognition\n  // sgp4fix am is fixed from the previous nm check\n\n  if (em >= 1.0 || em < -0.001) {\n    // || (am < 0.95)\n    // printf(\"// error em %f\\n\", em);\n    satrec.error = 1; // sgp4fix to return if there is an error in eccentricity\n\n    return [false, false];\n  } //  sgp4fix fix tolerance to avoid a divide by zero\n\n\n  if (em < 1.0e-6) {\n    em = 1.0e-6;\n  }\n\n  mm += satrec.no * templ;\n  xlm = mm + argpm + nodem;\n  nodem %= twoPi;\n  argpm %= twoPi;\n  xlm %= twoPi;\n  mm = (xlm - argpm - nodem) % twoPi; // ----------------- compute extra mean quantities -------------\n\n  var sinim = Math.sin(inclm);\n  var cosim = Math.cos(inclm); // -------------------- add lunar-solar periodics --------------\n\n  var ep = em;\n  xincp = inclm;\n  argpp = argpm;\n  nodep = nodem;\n  mp = mm;\n  sinip = sinim;\n  cosip = cosim;\n\n  if (satrec.method === 'd') {\n    var dpperParameters = {\n      inclo: satrec.inclo,\n      init: 'n',\n      ep: ep,\n      inclp: xincp,\n      nodep: nodep,\n      argpp: argpp,\n      mp: mp,\n      opsmode: satrec.operationmode\n    };\n    var dpperResult = dpper(satrec, dpperParameters);\n    ep = dpperResult.ep;\n    nodep = dpperResult.nodep;\n    argpp = dpperResult.argpp;\n    mp = dpperResult.mp;\n    xincp = dpperResult.inclp;\n\n    if (xincp < 0.0) {\n      xincp = -xincp;\n      nodep += pi;\n      argpp -= pi;\n    }\n\n    if (ep < 0.0 || ep > 1.0) {\n      //  printf(\"// error ep %f\\n\", ep);\n      satrec.error = 3; //  sgp4fix add return\n\n      return [false, false];\n    }\n  } //  -------------------- long period periodics ------------------\n\n\n  if (satrec.method === 'd') {\n    sinip = Math.sin(xincp);\n    cosip = Math.cos(xincp);\n    satrec.aycof = -0.5 * j3oj2 * sinip; //  sgp4fix for divide by zero for xincp = 180 deg\n\n    if (Math.abs(cosip + 1.0) > 1.5e-12) {\n      satrec.xlcof = -0.25 * j3oj2 * sinip * (3.0 + 5.0 * cosip) / (1.0 + cosip);\n    } else {\n      satrec.xlcof = -0.25 * j3oj2 * sinip * (3.0 + 5.0 * cosip) / temp4;\n    }\n  }\n\n  var axnl = ep * Math.cos(argpp);\n  temp = 1.0 / (am * (1.0 - ep * ep));\n  var aynl = ep * Math.sin(argpp) + temp * satrec.aycof;\n  var xl = mp + argpp + nodep + temp * satrec.xlcof * axnl; // --------------------- solve kepler's equation ---------------\n\n  var u = (xl - nodep) % twoPi;\n  eo1 = u;\n  tem5 = 9999.9;\n  var ktr = 1; //    sgp4fix for kepler iteration\n  //    the following iteration needs better limits on corrections\n\n  while (Math.abs(tem5) >= 1.0e-12 && ktr <= 10) {\n    sineo1 = Math.sin(eo1);\n    coseo1 = Math.cos(eo1);\n    tem5 = 1.0 - coseo1 * axnl - sineo1 * aynl;\n    tem5 = (u - aynl * coseo1 + axnl * sineo1 - eo1) / tem5;\n\n    if (Math.abs(tem5) >= 0.95) {\n      if (tem5 > 0.0) {\n        tem5 = 0.95;\n      } else {\n        tem5 = -0.95;\n      }\n    }\n\n    eo1 += tem5;\n    ktr += 1;\n  } //  ------------- short period preliminary quantities -----------\n\n\n  var ecose = axnl * coseo1 + aynl * sineo1;\n  var esine = axnl * sineo1 - aynl * coseo1;\n  var el2 = axnl * axnl + aynl * aynl;\n  var pl = am * (1.0 - el2);\n\n  if (pl < 0.0) {\n    //  printf(\"// error pl %f\\n\", pl);\n    satrec.error = 4; //  sgp4fix add return\n\n    return [false, false];\n  }\n\n  var rl = am * (1.0 - ecose);\n  var rdotl = Math.sqrt(am) * esine / rl;\n  var rvdotl = Math.sqrt(pl) / rl;\n  var betal = Math.sqrt(1.0 - el2);\n  temp = esine / (1.0 + betal);\n  var sinu = am / rl * (sineo1 - aynl - axnl * temp);\n  var cosu = am / rl * (coseo1 - axnl + aynl * temp);\n  su = Math.atan2(sinu, cosu);\n  var sin2u = (cosu + cosu) * sinu;\n  var cos2u = 1.0 - 2.0 * sinu * sinu;\n  temp = 1.0 / pl;\n  var temp1 = 0.5 * j2 * temp;\n  var temp2 = temp1 * temp; // -------------- update for short period periodics ------------\n\n  if (satrec.method === 'd') {\n    cosisq = cosip * cosip;\n    satrec.con41 = 3.0 * cosisq - 1.0;\n    satrec.x1mth2 = 1.0 - cosisq;\n    satrec.x7thm1 = 7.0 * cosisq - 1.0;\n  }\n\n  var mrt = rl * (1.0 - 1.5 * temp2 * betal * satrec.con41) + 0.5 * temp1 * satrec.x1mth2 * cos2u; // sgp4fix for decaying satellites\n\n  if (mrt < 1.0) {\n    // printf(\"// decay condition %11.6f \\n\",mrt);\n    satrec.error = 6;\n    return {\n      position: false,\n      velocity: false\n    };\n  }\n\n  su -= 0.25 * temp2 * satrec.x7thm1 * sin2u;\n  var xnode = nodep + 1.5 * temp2 * cosip * sin2u;\n  var xinc = xincp + 1.5 * temp2 * cosip * sinip * cos2u;\n  var mvt = rdotl - nm * temp1 * satrec.x1mth2 * sin2u / xke;\n  var rvdot = rvdotl + nm * temp1 * (satrec.x1mth2 * cos2u + 1.5 * satrec.con41) / xke; // --------------------- orientation vectors -------------------\n\n  var sinsu = Math.sin(su);\n  var cossu = Math.cos(su);\n  var snod = Math.sin(xnode);\n  var cnod = Math.cos(xnode);\n  var sini = Math.sin(xinc);\n  var cosi = Math.cos(xinc);\n  var xmx = -snod * cosi;\n  var xmy = cnod * cosi;\n  var ux = xmx * sinsu + cnod * cossu;\n  var uy = xmy * sinsu + snod * cossu;\n  var uz = sini * sinsu;\n  var vx = xmx * cossu - cnod * sinsu;\n  var vy = xmy * cossu - snod * sinsu;\n  var vz = sini * cossu; // --------- position and velocity (in km and km/sec) ----------\n\n  var r = {\n    x: mrt * ux * earthRadius,\n    y: mrt * uy * earthRadius,\n    z: mrt * uz * earthRadius\n  };\n  var v = {\n    x: (mvt * ux + rvdot * vx) * vkmpersec,\n    y: (mvt * uy + rvdot * vy) * vkmpersec,\n    z: (mvt * uz + rvdot * vz) * vkmpersec\n  };\n  return {\n    position: r,\n    velocity: v\n  };\n  /* eslint-enable no-param-reassign */\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                             procedure sgp4init\n *\n *  this procedure initializes variables for sgp4.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    opsmode     - mode of operation afspc or improved 'a', 'i'\n *    satn        - satellite number\n *    bstar       - sgp4 type drag coefficient              kg/m2er\n *    ecco        - eccentricity\n *    epoch       - epoch time in days from jan 0, 1950. 0 hr\n *    argpo       - argument of perigee (output if ds)\n *    inclo       - inclination\n *    mo          - mean anomaly (output if ds)\n *    no          - mean motion\n *    nodeo       - right ascension of ascending node\n *\n *  outputs       :\n *    rec      - common values for subsequent calls\n *    return code - non-zero on error.\n *                   1 - mean elements, ecc >= 1.0 or ecc < -0.001 or a < 0.95 er\n *                   2 - mean motion less than 0.0\n *                   3 - pert elements, ecc < 0.0  or  ecc > 1.0\n *                   4 - semi-latus rectum < 0.0\n *                   5 - epoch elements are sub-orbital\n *                   6 - satellite has decayed\n *\n *  locals        :\n *    cnodm  , snodm  , cosim  , sinim  , cosomm , sinomm\n *    cc1sq  , cc2    , cc3\n *    coef   , coef1\n *    cosio4      -\n *    day         -\n *    dndt        -\n *    em          - eccentricity\n *    emsq        - eccentricity squared\n *    eeta        -\n *    etasq       -\n *    gam         -\n *    argpm       - argument of perigee\n *    nodem       -\n *    inclm       - inclination\n *    mm          - mean anomaly\n *    nm          - mean motion\n *    perige      - perigee\n *    pinvsq      -\n *    psisq       -\n *    qzms24      -\n *    rtemsq      -\n *    s1, s2, s3, s4, s5, s6, s7          -\n *    sfour       -\n *    ss1, ss2, ss3, ss4, ss5, ss6, ss7         -\n *    sz1, sz2, sz3\n *    sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33        -\n *    tc          -\n *    temp        -\n *    temp1, temp2, temp3       -\n *    tsi         -\n *    xpidot      -\n *    xhdot1      -\n *    z1, z2, z3          -\n *    z11, z12, z13, z21, z22, z23, z31, z32, z33         -\n *\n *  coupling      :\n *    getgravconst-\n *    initl       -\n *    dscom       -\n *    dpper       -\n *    dsinit      -\n *    sgp4        -\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction sgp4init(satrec, options) {\n  /* eslint-disable no-param-reassign */\n  var opsmode = options.opsmode,\n      satn = options.satn,\n      epoch = options.epoch,\n      xbstar = options.xbstar,\n      xecco = options.xecco,\n      xargpo = options.xargpo,\n      xinclo = options.xinclo,\n      xmo = options.xmo,\n      xno = options.xno,\n      xnodeo = options.xnodeo;\n  var cosim;\n  var sinim;\n  var cc1sq;\n  var cc2;\n  var cc3;\n  var coef;\n  var coef1;\n  var cosio4;\n  var em;\n  var emsq;\n  var eeta;\n  var etasq;\n  var argpm;\n  var nodem;\n  var inclm;\n  var mm;\n  var nm;\n  var perige;\n  var pinvsq;\n  var psisq;\n  var qzms24;\n  var s1;\n  var s2;\n  var s3;\n  var s4;\n  var s5;\n  var sfour;\n  var ss1;\n  var ss2;\n  var ss3;\n  var ss4;\n  var ss5;\n  var sz1;\n  var sz3;\n  var sz11;\n  var sz13;\n  var sz21;\n  var sz23;\n  var sz31;\n  var sz33;\n  var tc;\n  var temp;\n  var temp1;\n  var temp2;\n  var temp3;\n  var tsi;\n  var xpidot;\n  var xhdot1;\n  var z1;\n  var z3;\n  var z11;\n  var z13;\n  var z21;\n  var z23;\n  var z31;\n  var z33;\n  /* ------------------------ initialization --------------------- */\n  // sgp4fix divisor for divide by zero check on inclination\n  // the old check used 1.0 + Math.cos(pi-1.0e-9), but then compared it to\n  // 1.5 e-12, so the threshold was changed to 1.5e-12 for consistency\n\n  var temp4 = 1.5e-12; // ----------- set all near earth variables to zero ------------\n\n  satrec.isimp = 0;\n  satrec.method = 'n';\n  satrec.aycof = 0.0;\n  satrec.con41 = 0.0;\n  satrec.cc1 = 0.0;\n  satrec.cc4 = 0.0;\n  satrec.cc5 = 0.0;\n  satrec.d2 = 0.0;\n  satrec.d3 = 0.0;\n  satrec.d4 = 0.0;\n  satrec.delmo = 0.0;\n  satrec.eta = 0.0;\n  satrec.argpdot = 0.0;\n  satrec.omgcof = 0.0;\n  satrec.sinmao = 0.0;\n  satrec.t = 0.0;\n  satrec.t2cof = 0.0;\n  satrec.t3cof = 0.0;\n  satrec.t4cof = 0.0;\n  satrec.t5cof = 0.0;\n  satrec.x1mth2 = 0.0;\n  satrec.x7thm1 = 0.0;\n  satrec.mdot = 0.0;\n  satrec.nodedot = 0.0;\n  satrec.xlcof = 0.0;\n  satrec.xmcof = 0.0;\n  satrec.nodecf = 0.0; // ----------- set all deep space variables to zero ------------\n\n  satrec.irez = 0;\n  satrec.d2201 = 0.0;\n  satrec.d2211 = 0.0;\n  satrec.d3210 = 0.0;\n  satrec.d3222 = 0.0;\n  satrec.d4410 = 0.0;\n  satrec.d4422 = 0.0;\n  satrec.d5220 = 0.0;\n  satrec.d5232 = 0.0;\n  satrec.d5421 = 0.0;\n  satrec.d5433 = 0.0;\n  satrec.dedt = 0.0;\n  satrec.del1 = 0.0;\n  satrec.del2 = 0.0;\n  satrec.del3 = 0.0;\n  satrec.didt = 0.0;\n  satrec.dmdt = 0.0;\n  satrec.dnodt = 0.0;\n  satrec.domdt = 0.0;\n  satrec.e3 = 0.0;\n  satrec.ee2 = 0.0;\n  satrec.peo = 0.0;\n  satrec.pgho = 0.0;\n  satrec.pho = 0.0;\n  satrec.pinco = 0.0;\n  satrec.plo = 0.0;\n  satrec.se2 = 0.0;\n  satrec.se3 = 0.0;\n  satrec.sgh2 = 0.0;\n  satrec.sgh3 = 0.0;\n  satrec.sgh4 = 0.0;\n  satrec.sh2 = 0.0;\n  satrec.sh3 = 0.0;\n  satrec.si2 = 0.0;\n  satrec.si3 = 0.0;\n  satrec.sl2 = 0.0;\n  satrec.sl3 = 0.0;\n  satrec.sl4 = 0.0;\n  satrec.gsto = 0.0;\n  satrec.xfact = 0.0;\n  satrec.xgh2 = 0.0;\n  satrec.xgh3 = 0.0;\n  satrec.xgh4 = 0.0;\n  satrec.xh2 = 0.0;\n  satrec.xh3 = 0.0;\n  satrec.xi2 = 0.0;\n  satrec.xi3 = 0.0;\n  satrec.xl2 = 0.0;\n  satrec.xl3 = 0.0;\n  satrec.xl4 = 0.0;\n  satrec.xlamo = 0.0;\n  satrec.zmol = 0.0;\n  satrec.zmos = 0.0;\n  satrec.atime = 0.0;\n  satrec.xli = 0.0;\n  satrec.xni = 0.0; // sgp4fix - note the following variables are also passed directly via satrec.\n  // it is possible to streamline the sgp4init call by deleting the \"x\"\n  // variables, but the user would need to set the satrec.* values first. we\n  // include the additional assignments in case twoline2rv is not used.\n\n  satrec.bstar = xbstar;\n  satrec.ecco = xecco;\n  satrec.argpo = xargpo;\n  satrec.inclo = xinclo;\n  satrec.mo = xmo;\n  satrec.no = xno;\n  satrec.nodeo = xnodeo; //  sgp4fix add opsmode\n\n  satrec.operationmode = opsmode; // ------------------------ earth constants -----------------------\n  // sgp4fix identify constants and allow alternate values\n\n  var ss = 78.0 / earthRadius + 1.0; // sgp4fix use multiply for speed instead of pow\n\n  var qzms2ttemp = (120.0 - 78.0) / earthRadius;\n  var qzms2t = qzms2ttemp * qzms2ttemp * qzms2ttemp * qzms2ttemp;\n  satrec.init = 'y';\n  satrec.t = 0.0;\n  var initlOptions = {\n    satn: satn,\n    ecco: satrec.ecco,\n    epoch: epoch,\n    inclo: satrec.inclo,\n    no: satrec.no,\n    method: satrec.method,\n    opsmode: satrec.operationmode\n  };\n  var initlResult = initl(initlOptions);\n  var ao = initlResult.ao,\n      con42 = initlResult.con42,\n      cosio = initlResult.cosio,\n      cosio2 = initlResult.cosio2,\n      eccsq = initlResult.eccsq,\n      omeosq = initlResult.omeosq,\n      posq = initlResult.posq,\n      rp = initlResult.rp,\n      rteosq = initlResult.rteosq,\n      sinio = initlResult.sinio;\n  satrec.no = initlResult.no;\n  satrec.con41 = initlResult.con41;\n  satrec.gsto = initlResult.gsto;\n  satrec.error = 0; // sgp4fix remove this check as it is unnecessary\n  // the mrt check in sgp4 handles decaying satellite cases even if the starting\n  // condition is below the surface of te earth\n  // if (rp < 1.0)\n  // {\n  //   printf(\"// *** satn%d epoch elts sub-orbital ***\\n\", satn);\n  //   satrec.error = 5;\n  // }\n\n  if (omeosq >= 0.0 || satrec.no >= 0.0) {\n    satrec.isimp = 0;\n\n    if (rp < 220.0 / earthRadius + 1.0) {\n      satrec.isimp = 1;\n    }\n\n    sfour = ss;\n    qzms24 = qzms2t;\n    perige = (rp - 1.0) * earthRadius; // - for perigees below 156 km, s and qoms2t are altered -\n\n    if (perige < 156.0) {\n      sfour = perige - 78.0;\n\n      if (perige < 98.0) {\n        sfour = 20.0;\n      } // sgp4fix use multiply for speed instead of pow\n\n\n      var qzms24temp = (120.0 - sfour) / earthRadius;\n      qzms24 = qzms24temp * qzms24temp * qzms24temp * qzms24temp;\n      sfour = sfour / earthRadius + 1.0;\n    }\n\n    pinvsq = 1.0 / posq;\n    tsi = 1.0 / (ao - sfour);\n    satrec.eta = ao * satrec.ecco * tsi;\n    etasq = satrec.eta * satrec.eta;\n    eeta = satrec.ecco * satrec.eta;\n    psisq = Math.abs(1.0 - etasq);\n    coef = qzms24 * Math.pow(tsi, 4.0);\n    coef1 = coef / Math.pow(psisq, 3.5);\n    cc2 = coef1 * satrec.no * (ao * (1.0 + 1.5 * etasq + eeta * (4.0 + etasq)) + 0.375 * j2 * tsi / psisq * satrec.con41 * (8.0 + 3.0 * etasq * (8.0 + etasq)));\n    satrec.cc1 = satrec.bstar * cc2;\n    cc3 = 0.0;\n\n    if (satrec.ecco > 1.0e-4) {\n      cc3 = -2.0 * coef * tsi * j3oj2 * satrec.no * sinio / satrec.ecco;\n    }\n\n    satrec.x1mth2 = 1.0 - cosio2;\n    satrec.cc4 = 2.0 * satrec.no * coef1 * ao * omeosq * (satrec.eta * (2.0 + 0.5 * etasq) + satrec.ecco * (0.5 + 2.0 * etasq) - j2 * tsi / (ao * psisq) * (-3.0 * satrec.con41 * (1.0 - 2.0 * eeta + etasq * (1.5 - 0.5 * eeta)) + 0.75 * satrec.x1mth2 * (2.0 * etasq - eeta * (1.0 + etasq)) * Math.cos(2.0 * satrec.argpo)));\n    satrec.cc5 = 2.0 * coef1 * ao * omeosq * (1.0 + 2.75 * (etasq + eeta) + eeta * etasq);\n    cosio4 = cosio2 * cosio2;\n    temp1 = 1.5 * j2 * pinvsq * satrec.no;\n    temp2 = 0.5 * temp1 * j2 * pinvsq;\n    temp3 = -0.46875 * j4 * pinvsq * pinvsq * satrec.no;\n    satrec.mdot = satrec.no + 0.5 * temp1 * rteosq * satrec.con41 + 0.0625 * temp2 * rteosq * (13.0 - 78.0 * cosio2 + 137.0 * cosio4);\n    satrec.argpdot = -0.5 * temp1 * con42 + 0.0625 * temp2 * (7.0 - 114.0 * cosio2 + 395.0 * cosio4) + temp3 * (3.0 - 36.0 * cosio2 + 49.0 * cosio4);\n    xhdot1 = -temp1 * cosio;\n    satrec.nodedot = xhdot1 + (0.5 * temp2 * (4.0 - 19.0 * cosio2) + 2.0 * temp3 * (3.0 - 7.0 * cosio2)) * cosio;\n    xpidot = satrec.argpdot + satrec.nodedot;\n    satrec.omgcof = satrec.bstar * cc3 * Math.cos(satrec.argpo);\n    satrec.xmcof = 0.0;\n\n    if (satrec.ecco > 1.0e-4) {\n      satrec.xmcof = -x2o3 * coef * satrec.bstar / eeta;\n    }\n\n    satrec.nodecf = 3.5 * omeosq * xhdot1 * satrec.cc1;\n    satrec.t2cof = 1.5 * satrec.cc1; // sgp4fix for divide by zero with xinco = 180 deg\n\n    if (Math.abs(cosio + 1.0) > 1.5e-12) {\n      satrec.xlcof = -0.25 * j3oj2 * sinio * (3.0 + 5.0 * cosio) / (1.0 + cosio);\n    } else {\n      satrec.xlcof = -0.25 * j3oj2 * sinio * (3.0 + 5.0 * cosio) / temp4;\n    }\n\n    satrec.aycof = -0.5 * j3oj2 * sinio; // sgp4fix use multiply for speed instead of pow\n\n    var delmotemp = 1.0 + satrec.eta * Math.cos(satrec.mo);\n    satrec.delmo = delmotemp * delmotemp * delmotemp;\n    satrec.sinmao = Math.sin(satrec.mo);\n    satrec.x7thm1 = 7.0 * cosio2 - 1.0; // --------------- deep space initialization -------------\n\n    if (2 * pi / satrec.no >= 225.0) {\n      satrec.method = 'd';\n      satrec.isimp = 1;\n      tc = 0.0;\n      inclm = satrec.inclo;\n      var dscomOptions = {\n        epoch: epoch,\n        ep: satrec.ecco,\n        argpp: satrec.argpo,\n        tc: tc,\n        inclp: satrec.inclo,\n        nodep: satrec.nodeo,\n        np: satrec.no,\n        e3: satrec.e3,\n        ee2: satrec.ee2,\n        peo: satrec.peo,\n        pgho: satrec.pgho,\n        pho: satrec.pho,\n        pinco: satrec.pinco,\n        plo: satrec.plo,\n        se2: satrec.se2,\n        se3: satrec.se3,\n        sgh2: satrec.sgh2,\n        sgh3: satrec.sgh3,\n        sgh4: satrec.sgh4,\n        sh2: satrec.sh2,\n        sh3: satrec.sh3,\n        si2: satrec.si2,\n        si3: satrec.si3,\n        sl2: satrec.sl2,\n        sl3: satrec.sl3,\n        sl4: satrec.sl4,\n        xgh2: satrec.xgh2,\n        xgh3: satrec.xgh3,\n        xgh4: satrec.xgh4,\n        xh2: satrec.xh2,\n        xh3: satrec.xh3,\n        xi2: satrec.xi2,\n        xi3: satrec.xi3,\n        xl2: satrec.xl2,\n        xl3: satrec.xl3,\n        xl4: satrec.xl4,\n        zmol: satrec.zmol,\n        zmos: satrec.zmos\n      };\n      var dscomResult = dscom(dscomOptions);\n      satrec.e3 = dscomResult.e3;\n      satrec.ee2 = dscomResult.ee2;\n      satrec.peo = dscomResult.peo;\n      satrec.pgho = dscomResult.pgho;\n      satrec.pho = dscomResult.pho;\n      satrec.pinco = dscomResult.pinco;\n      satrec.plo = dscomResult.plo;\n      satrec.se2 = dscomResult.se2;\n      satrec.se3 = dscomResult.se3;\n      satrec.sgh2 = dscomResult.sgh2;\n      satrec.sgh3 = dscomResult.sgh3;\n      satrec.sgh4 = dscomResult.sgh4;\n      satrec.sh2 = dscomResult.sh2;\n      satrec.sh3 = dscomResult.sh3;\n      satrec.si2 = dscomResult.si2;\n      satrec.si3 = dscomResult.si3;\n      satrec.sl2 = dscomResult.sl2;\n      satrec.sl3 = dscomResult.sl3;\n      satrec.sl4 = dscomResult.sl4;\n      sinim = dscomResult.sinim;\n      cosim = dscomResult.cosim;\n      em = dscomResult.em;\n      emsq = dscomResult.emsq;\n      s1 = dscomResult.s1;\n      s2 = dscomResult.s2;\n      s3 = dscomResult.s3;\n      s4 = dscomResult.s4;\n      s5 = dscomResult.s5;\n      ss1 = dscomResult.ss1;\n      ss2 = dscomResult.ss2;\n      ss3 = dscomResult.ss3;\n      ss4 = dscomResult.ss4;\n      ss5 = dscomResult.ss5;\n      sz1 = dscomResult.sz1;\n      sz3 = dscomResult.sz3;\n      sz11 = dscomResult.sz11;\n      sz13 = dscomResult.sz13;\n      sz21 = dscomResult.sz21;\n      sz23 = dscomResult.sz23;\n      sz31 = dscomResult.sz31;\n      sz33 = dscomResult.sz33;\n      satrec.xgh2 = dscomResult.xgh2;\n      satrec.xgh3 = dscomResult.xgh3;\n      satrec.xgh4 = dscomResult.xgh4;\n      satrec.xh2 = dscomResult.xh2;\n      satrec.xh3 = dscomResult.xh3;\n      satrec.xi2 = dscomResult.xi2;\n      satrec.xi3 = dscomResult.xi3;\n      satrec.xl2 = dscomResult.xl2;\n      satrec.xl3 = dscomResult.xl3;\n      satrec.xl4 = dscomResult.xl4;\n      satrec.zmol = dscomResult.zmol;\n      satrec.zmos = dscomResult.zmos;\n      nm = dscomResult.nm;\n      z1 = dscomResult.z1;\n      z3 = dscomResult.z3;\n      z11 = dscomResult.z11;\n      z13 = dscomResult.z13;\n      z21 = dscomResult.z21;\n      z23 = dscomResult.z23;\n      z31 = dscomResult.z31;\n      z33 = dscomResult.z33;\n      var dpperOptions = {\n        inclo: inclm,\n        init: satrec.init,\n        ep: satrec.ecco,\n        inclp: satrec.inclo,\n        nodep: satrec.nodeo,\n        argpp: satrec.argpo,\n        mp: satrec.mo,\n        opsmode: satrec.operationmode\n      };\n      var dpperResult = dpper(satrec, dpperOptions);\n      satrec.ecco = dpperResult.ep;\n      satrec.inclo = dpperResult.inclp;\n      satrec.nodeo = dpperResult.nodep;\n      satrec.argpo = dpperResult.argpp;\n      satrec.mo = dpperResult.mp;\n      argpm = 0.0;\n      nodem = 0.0;\n      mm = 0.0;\n      var dsinitOptions = {\n        cosim: cosim,\n        emsq: emsq,\n        argpo: satrec.argpo,\n        s1: s1,\n        s2: s2,\n        s3: s3,\n        s4: s4,\n        s5: s5,\n        sinim: sinim,\n        ss1: ss1,\n        ss2: ss2,\n        ss3: ss3,\n        ss4: ss4,\n        ss5: ss5,\n        sz1: sz1,\n        sz3: sz3,\n        sz11: sz11,\n        sz13: sz13,\n        sz21: sz21,\n        sz23: sz23,\n        sz31: sz31,\n        sz33: sz33,\n        t: satrec.t,\n        tc: tc,\n        gsto: satrec.gsto,\n        mo: satrec.mo,\n        mdot: satrec.mdot,\n        no: satrec.no,\n        nodeo: satrec.nodeo,\n        nodedot: satrec.nodedot,\n        xpidot: xpidot,\n        z1: z1,\n        z3: z3,\n        z11: z11,\n        z13: z13,\n        z21: z21,\n        z23: z23,\n        z31: z31,\n        z33: z33,\n        ecco: satrec.ecco,\n        eccsq: eccsq,\n        em: em,\n        argpm: argpm,\n        inclm: inclm,\n        mm: mm,\n        nm: nm,\n        nodem: nodem,\n        irez: satrec.irez,\n        atime: satrec.atime,\n        d2201: satrec.d2201,\n        d2211: satrec.d2211,\n        d3210: satrec.d3210,\n        d3222: satrec.d3222,\n        d4410: satrec.d4410,\n        d4422: satrec.d4422,\n        d5220: satrec.d5220,\n        d5232: satrec.d5232,\n        d5421: satrec.d5421,\n        d5433: satrec.d5433,\n        dedt: satrec.dedt,\n        didt: satrec.didt,\n        dmdt: satrec.dmdt,\n        dnodt: satrec.dnodt,\n        domdt: satrec.domdt,\n        del1: satrec.del1,\n        del2: satrec.del2,\n        del3: satrec.del3,\n        xfact: satrec.xfact,\n        xlamo: satrec.xlamo,\n        xli: satrec.xli,\n        xni: satrec.xni\n      };\n      var dsinitResult = dsinit(dsinitOptions);\n      satrec.irez = dsinitResult.irez;\n      satrec.atime = dsinitResult.atime;\n      satrec.d2201 = dsinitResult.d2201;\n      satrec.d2211 = dsinitResult.d2211;\n      satrec.d3210 = dsinitResult.d3210;\n      satrec.d3222 = dsinitResult.d3222;\n      satrec.d4410 = dsinitResult.d4410;\n      satrec.d4422 = dsinitResult.d4422;\n      satrec.d5220 = dsinitResult.d5220;\n      satrec.d5232 = dsinitResult.d5232;\n      satrec.d5421 = dsinitResult.d5421;\n      satrec.d5433 = dsinitResult.d5433;\n      satrec.dedt = dsinitResult.dedt;\n      satrec.didt = dsinitResult.didt;\n      satrec.dmdt = dsinitResult.dmdt;\n      satrec.dnodt = dsinitResult.dnodt;\n      satrec.domdt = dsinitResult.domdt;\n      satrec.del1 = dsinitResult.del1;\n      satrec.del2 = dsinitResult.del2;\n      satrec.del3 = dsinitResult.del3;\n      satrec.xfact = dsinitResult.xfact;\n      satrec.xlamo = dsinitResult.xlamo;\n      satrec.xli = dsinitResult.xli;\n      satrec.xni = dsinitResult.xni;\n    } // ----------- set variables if not deep space -----------\n\n\n    if (satrec.isimp !== 1) {\n      cc1sq = satrec.cc1 * satrec.cc1;\n      satrec.d2 = 4.0 * ao * tsi * cc1sq;\n      temp = satrec.d2 * tsi * satrec.cc1 / 3.0;\n      satrec.d3 = (17.0 * ao + sfour) * temp;\n      satrec.d4 = 0.5 * temp * ao * tsi * (221.0 * ao + 31.0 * sfour) * satrec.cc1;\n      satrec.t3cof = satrec.d2 + 2.0 * cc1sq;\n      satrec.t4cof = 0.25 * (3.0 * satrec.d3 + satrec.cc1 * (12.0 * satrec.d2 + 10.0 * cc1sq));\n      satrec.t5cof = 0.2 * (3.0 * satrec.d4 + 12.0 * satrec.cc1 * satrec.d3 + 6.0 * satrec.d2 * satrec.d2 + 15.0 * cc1sq * (2.0 * satrec.d2 + cc1sq));\n    }\n    /* finally propogate to zero epoch to initialize all others. */\n    // sgp4fix take out check to let satellites process until they are actually below earth surface\n    // if(satrec.error == 0)\n\n  }\n\n  sgp4(satrec, 0, 0);\n  satrec.init = 'n';\n  /* eslint-enable no-param-reassign */\n}\n\n/* -----------------------------------------------------------------------------\n *\n *                           function twoline2rv\n *\n *  this function converts the two line element set character string data to\n *    variables and initializes the sgp4 variables. several intermediate varaibles\n *    and quantities are determined. note that the result is a structure so multiple\n *    satellites can be processed simultaneously without having to reinitialize. the\n *    verification mode is an important option that permits quick checks of any\n *    changes to the underlying technical theory. this option works using a\n *    modified tle file in which the start, stop, and delta time values are\n *    included at the end of the second line of data. this only works with the\n *    verification mode. the catalog mode simply propagates from -1440 to 1440 min\n *    from epoch and is useful when performing entire catalog runs.\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs        :\n *    longstr1    - first line of the tle\n *    longstr2    - second line of the tle\n *    typerun     - type of run                    verification 'v', catalog 'c',\n *                                                 manual 'm'\n *    typeinput   - type of manual input           mfe 'm', epoch 'e', dayofyr 'd'\n *    opsmode     - mode of operation afspc or improved 'a', 'i'\n *    whichconst  - which set of constants to use  72, 84\n *\n *  outputs       :\n *    satrec      - structure containing all the sgp4 satellite information\n *\n *  coupling      :\n *    getgravconst-\n *    days2mdhms  - conversion of days to month, day, hour, minute, second\n *    jday        - convert day month year hour minute second into julian date\n *    sgp4init    - initialize the sgp4 variables\n *\n *  references    :\n *    norad spacetrack report #3\n *    vallado, crawford, hujsak, kelso  2006\n --------------------------------------------------------------------------- */\n\n/**\n * Return a Satellite imported from two lines of TLE data.\n *\n * Provide the two TLE lines as strings `longstr1` and `longstr2`,\n * and select which standard set of gravitational constants you want\n * by providing `gravity_constants`:\n *\n * `sgp4.propagation.wgs72` - Standard WGS 72 model\n * `sgp4.propagation.wgs84` - More recent WGS 84 model\n * `sgp4.propagation.wgs72old` - Legacy support for old SGP4 behavior\n *\n * Normally, computations are made using letious recent improvements\n * to the algorithm.  If you want to turn some of these off and go\n * back into \"afspc\" mode, then set `afspc_mode` to `True`.\n */\n\nfunction twoline2satrec(longstr1, longstr2) {\n  var opsmode = 'i';\n  var xpdotp = 1440.0 / (2.0 * pi); // 229.1831180523293;\n\n  var year = 0;\n  var satrec = {};\n  satrec.error = 0;\n  satrec.satnum = longstr1.substring(2, 7);\n  satrec.epochyr = parseInt(longstr1.substring(18, 20), 10);\n  satrec.epochdays = parseFloat(longstr1.substring(20, 32));\n  satrec.ndot = parseFloat(longstr1.substring(33, 43));\n  satrec.nddot = parseFloat(\".\".concat(parseInt(longstr1.substring(44, 50), 10), \"E\").concat(longstr1.substring(50, 52)));\n  satrec.bstar = parseFloat(\"\".concat(longstr1.substring(53, 54), \".\").concat(parseInt(longstr1.substring(54, 59), 10), \"E\").concat(longstr1.substring(59, 61))); // satrec.satnum = longstr2.substring(2, 7);\n\n  satrec.inclo = parseFloat(longstr2.substring(8, 16));\n  satrec.nodeo = parseFloat(longstr2.substring(17, 25));\n  satrec.ecco = parseFloat(\".\".concat(longstr2.substring(26, 33)));\n  satrec.argpo = parseFloat(longstr2.substring(34, 42));\n  satrec.mo = parseFloat(longstr2.substring(43, 51));\n  satrec.no = parseFloat(longstr2.substring(52, 63)); // ---- find no, ndot, nddot ----\n\n  satrec.no /= xpdotp; //   rad/min\n  // satrec.nddot= satrec.nddot * Math.pow(10.0, nexp);\n  // satrec.bstar= satrec.bstar * Math.pow(10.0, ibexp);\n  // ---- convert to sgp4 units ----\n\n  satrec.a = Math.pow(satrec.no * tumin, -2.0 / 3.0);\n  satrec.ndot /= xpdotp * 1440.0; // ? * minperday\n\n  satrec.nddot /= xpdotp * 1440.0 * 1440; // ---- find standard orbital elements ----\n\n  satrec.inclo *= deg2rad;\n  satrec.nodeo *= deg2rad;\n  satrec.argpo *= deg2rad;\n  satrec.mo *= deg2rad;\n  satrec.alta = satrec.a * (1.0 + satrec.ecco) - 1.0;\n  satrec.altp = satrec.a * (1.0 - satrec.ecco) - 1.0; // ----------------------------------------------------------------\n  // find sgp4epoch time of element set\n  // remember that sgp4 uses units of days from 0 jan 1950 (sgp4epoch)\n  // and minutes from the epoch (time)\n  // ----------------------------------------------------------------\n  // ---------------- temp fix for years from 1957-2056 -------------------\n  // --------- correct fix will occur when year is 4-digit in tle ---------\n\n  if (satrec.epochyr < 57) {\n    year = satrec.epochyr + 2000;\n  } else {\n    year = satrec.epochyr + 1900;\n  }\n\n  var mdhmsResult = days2mdhms(year, satrec.epochdays);\n  var mon = mdhmsResult.mon,\n      day = mdhmsResult.day,\n      hr = mdhmsResult.hr,\n      minute = mdhmsResult.minute,\n      sec = mdhmsResult.sec;\n  satrec.jdsatepoch = jday(year, mon, day, hr, minute, sec); //  ---------------- initialize the orbit at sgp4epoch -------------------\n\n  sgp4init(satrec, {\n    opsmode: opsmode,\n    satn: satrec.satnum,\n    epoch: satrec.jdsatepoch - 2433281.5,\n    xbstar: satrec.bstar,\n    xecco: satrec.ecco,\n    xargpo: satrec.argpo,\n    xinclo: satrec.inclo,\n    xmo: satrec.mo,\n    xno: satrec.no,\n    xnodeo: satrec.nodeo\n  });\n  return satrec;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction propagate() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  // Return a position and velocity vector for a given date and time.\n  var satrec = args[0];\n  var date = Array.prototype.slice.call(args, 1);\n  var j = jday.apply(void 0, _toConsumableArray(date));\n  var m = (j - satrec.jdsatepoch) * minutesPerDay;\n  return sgp4(satrec, m);\n}\n\nfunction dopplerFactor(location, position, velocity) {\n  var currentRange = Math.sqrt(Math.pow(position.x - location.x, 2) + Math.pow(position.y - location.y, 2) + Math.pow(position.z - location.z, 2));\n  var nextPos = {\n    x: position.x + velocity.x,\n    y: position.y + velocity.y,\n    z: position.z + velocity.z\n  };\n  var nextRange = Math.sqrt(Math.pow(nextPos.x - location.x, 2) + Math.pow(nextPos.y - location.y, 2) + Math.pow(nextPos.z - location.z, 2));\n  var rangeRate = nextRange - currentRange;\n\n  function sign(value) {\n    return value >= 0 ? 1 : -1;\n  }\n\n  rangeRate *= sign(rangeRate);\n  var c = 299792.458; // Speed of light in km/s\n\n  return 1 + rangeRate / c;\n}\n\nfunction radiansToDegrees(radians) {\n  return radians * rad2deg;\n}\nfunction degreesToRadians(degrees) {\n  return degrees * deg2rad;\n}\nfunction degreesLat(radians) {\n  if (radians < -pi / 2 || radians > pi / 2) {\n    throw new RangeError('Latitude radians must be in range [-pi/2; pi/2].');\n  }\n\n  return radiansToDegrees(radians);\n}\nfunction degreesLong(radians) {\n  if (radians < -pi || radians > pi) {\n    throw new RangeError('Longitude radians must be in range [-pi; pi].');\n  }\n\n  return radiansToDegrees(radians);\n}\nfunction radiansLat(degrees) {\n  if (degrees < -90 || degrees > 90) {\n    throw new RangeError('Latitude degrees must be in range [-90; 90].');\n  }\n\n  return degreesToRadians(degrees);\n}\nfunction radiansLong(degrees) {\n  if (degrees < -180 || degrees > 180) {\n    throw new RangeError('Longitude degrees must be in range [-180; 180].');\n  }\n\n  return degreesToRadians(degrees);\n}\nfunction geodeticToEcf(geodetic) {\n  var longitude = geodetic.longitude,\n      latitude = geodetic.latitude,\n      height = geodetic.height;\n  var a = 6378.137;\n  var b = 6356.7523142;\n  var f = (a - b) / a;\n  var e2 = 2 * f - f * f;\n  var normal = a / Math.sqrt(1 - e2 * (Math.sin(latitude) * Math.sin(latitude)));\n  var x = (normal + height) * Math.cos(latitude) * Math.cos(longitude);\n  var y = (normal + height) * Math.cos(latitude) * Math.sin(longitude);\n  var z = (normal * (1 - e2) + height) * Math.sin(latitude);\n  return {\n    x: x,\n    y: y,\n    z: z\n  };\n}\nfunction eciToGeodetic(eci, gmst) {\n  // http://www.celestrak.com/columns/v02n03/\n  var a = 6378.137;\n  var b = 6356.7523142;\n  var R = Math.sqrt(eci.x * eci.x + eci.y * eci.y);\n  var f = (a - b) / a;\n  var e2 = 2 * f - f * f;\n  var longitude = Math.atan2(eci.y, eci.x) - gmst;\n\n  while (longitude < -pi) {\n    longitude += twoPi;\n  }\n\n  while (longitude > pi) {\n    longitude -= twoPi;\n  }\n\n  var kmax = 20;\n  var k = 0;\n  var latitude = Math.atan2(eci.z, Math.sqrt(eci.x * eci.x + eci.y * eci.y));\n  var C;\n\n  while (k < kmax) {\n    C = 1 / Math.sqrt(1 - e2 * (Math.sin(latitude) * Math.sin(latitude)));\n    latitude = Math.atan2(eci.z + a * C * e2 * Math.sin(latitude), R);\n    k += 1;\n  }\n\n  var height = R / Math.cos(latitude) - a * C;\n  return {\n    longitude: longitude,\n    latitude: latitude,\n    height: height\n  };\n}\nfunction ecfToEci(ecf, gmst) {\n  // ccar.colorado.edu/ASEN5070/handouts/coordsys.doc\n  //\n  // [X]     [C -S  0][X]\n  // [Y]  =  [S  C  0][Y]\n  // [Z]eci  [0  0  1][Z]ecf\n  //\n  var X = ecf.x * Math.cos(gmst) - ecf.y * Math.sin(gmst);\n  var Y = ecf.x * Math.sin(gmst) + ecf.y * Math.cos(gmst);\n  var Z = ecf.z;\n  return {\n    x: X,\n    y: Y,\n    z: Z\n  };\n}\nfunction eciToEcf(eci, gmst) {\n  // ccar.colorado.edu/ASEN5070/handouts/coordsys.doc\n  //\n  // [X]     [C -S  0][X]\n  // [Y]  =  [S  C  0][Y]\n  // [Z]eci  [0  0  1][Z]ecf\n  //\n  //\n  // Inverse:\n  // [X]     [C  S  0][X]\n  // [Y]  =  [-S C  0][Y]\n  // [Z]ecf  [0  0  1][Z]eci\n  var x = eci.x * Math.cos(gmst) + eci.y * Math.sin(gmst);\n  var y = eci.x * -Math.sin(gmst) + eci.y * Math.cos(gmst);\n  var z = eci.z;\n  return {\n    x: x,\n    y: y,\n    z: z\n  };\n}\n\nfunction topocentric(observerGeodetic, satelliteEcf) {\n  // http://www.celestrak.com/columns/v02n02/\n  // TS Kelso's method, except I'm using ECF frame\n  // and he uses ECI.\n  var longitude = observerGeodetic.longitude,\n      latitude = observerGeodetic.latitude;\n  var observerEcf = geodeticToEcf(observerGeodetic);\n  var rx = satelliteEcf.x - observerEcf.x;\n  var ry = satelliteEcf.y - observerEcf.y;\n  var rz = satelliteEcf.z - observerEcf.z;\n  var topS = Math.sin(latitude) * Math.cos(longitude) * rx + Math.sin(latitude) * Math.sin(longitude) * ry - Math.cos(latitude) * rz;\n  var topE = -Math.sin(longitude) * rx + Math.cos(longitude) * ry;\n  var topZ = Math.cos(latitude) * Math.cos(longitude) * rx + Math.cos(latitude) * Math.sin(longitude) * ry + Math.sin(latitude) * rz;\n  return {\n    topS: topS,\n    topE: topE,\n    topZ: topZ\n  };\n}\n/**\n * @param {Object} tc\n * @param {Number} tc.topS Positive horizontal vector S due south.\n * @param {Number} tc.topE Positive horizontal vector E due east.\n * @param {Number} tc.topZ Vector Z normal to the surface of the earth (up).\n * @returns {Object}\n */\n\n\nfunction topocentricToLookAngles(tc) {\n  var topS = tc.topS,\n      topE = tc.topE,\n      topZ = tc.topZ;\n  var rangeSat = Math.sqrt(topS * topS + topE * topE + topZ * topZ);\n  var El = Math.asin(topZ / rangeSat);\n  var Az = Math.atan2(-topE, topS) + pi;\n  return {\n    azimuth: Az,\n    elevation: El,\n    rangeSat: rangeSat // Range in km\n\n  };\n}\n\nfunction ecfToLookAngles(observerGeodetic, satelliteEcf) {\n  var topocentricCoords = topocentric(observerGeodetic, satelliteEcf);\n  return topocentricToLookAngles(topocentricCoords);\n}\n\nexport { constants, propagate, sgp4, twoline2satrec, gstime, jday, invjday, dopplerFactor, radiansToDegrees, degreesToRadians, degreesLat, degreesLong, radiansLat, radiansLong, geodeticToEcf, eciToGeodetic, eciToEcf, ecfToEci, ecfToLookAngles };","import * as satellite from './satellite';\n\nfunction deg2rad(deg) {\n    return deg * (Math.PI / 180);\n}\n\nfunction rad2deg(rad) {\n    return rad * (180 / Math.PI);\n}\n\nfunction computeSatrec(tleLine1, tleLine2) {\n    return satellite.twoline2satrec(tleLine1, tleLine2);\n}\n\nfunction getOrbitPositionWithPositionalData(satrec, date) {\n\n    var positionEci = getPositionEci(satrec, date);\n    var gmst = getGmst(date);\n    var position_gd = satellite.eciToGeodetic(positionEci, gmst);\n    var latitude = satellite.degreesLat(position_gd.latitude);\n    var longitude = satellite.degreesLong(position_gd.longitude);\n    var altitude = position_gd.height * 1000;\n\n    return {\n        position_eci: positionEci,\n        gmst: gmst,\n        position: {latitude, longitude, altitude}\n    };\n}\n\n\nfunction getOrbitPosition(satrec, date) {\n\n    var positionEci = getPositionEci(satrec, date);\n    var gmst = getGmst(date);\n    var position_gd = satellite.eciToGeodetic(positionEci, gmst);\n    var latitude = satellite.degreesLat(position_gd.latitude);\n    var longitude = satellite.degreesLong(position_gd.longitude);\n    var altitude = position_gd.height * 1000;\n\n    return {latitude, longitude, altitude};\n}\n\nfunction getElevationWithPositionalData(position_eci, gmst, observerGd) {\n    var positionEcf = satellite.eciToEcf(position_eci, gmst);\n    var lookAngles = satellite.ecfToLookAngles(observerGd, positionEcf);\n    return lookAngles.elevation;\n}\n\nfunction getPositionEci(satrec, date) {\n    var positionAndVelocity = satellite.propagate(\n        satrec,\n        date.getUTCFullYear(),\n        date.getUTCMonth() + 1,\n        date.getUTCDate(),\n        date.getUTCHours(),\n        date.getUTCMinutes(),\n        date.getUTCSeconds()\n    );\n\n    return positionAndVelocity.position;\n}\n\nfunction getGmst(date) {\n    return satellite.gstime(\n        date.getUTCFullYear(),\n        date.getUTCMonth() + 1,\n        date.getUTCDate(),\n        date.getUTCHours(),\n        date.getUTCMinutes(),\n        date.getUTCSeconds()\n    );\n}\n\nfunction headingAngleRadians(latStart, longStart, latEnd, longEnd) {\n    var headingAngle = 0;\n\n    var northPoleCurrentPositionDiff = pointToPointDistance(\n        {latitude: 90, longitude: 0},\n        {latitude: latStart, longitude: longStart}\n    );\n\n    var nextPositionCurrentPositionDiff = pointToPointDistance(\n        {latitude: latStart, longitude: longStart},\n        {latitude: latEnd, longitude: longEnd}\n    );\n\n    if (nextPositionCurrentPositionDiff != 0) {\n        var northPoleNextPositionDiff = pointToPointDistance(\n            {latitude: 90, longitude: 0},\n            {latitude: latEnd, longitude: longEnd}\n        );\n\n        var cosAngleCurrentPosition = (nextPositionCurrentPositionDiff * nextPositionCurrentPositionDiff +\n            northPoleCurrentPositionDiff * northPoleCurrentPositionDiff -\n            northPoleNextPositionDiff * northPoleNextPositionDiff) /\n            (2 * nextPositionCurrentPositionDiff * northPoleCurrentPositionDiff);\n\n        headingAngle = Math.abs(Math.acos(cosAngleCurrentPosition));\n    }\n\n    return headingAngle;\n}\n\nfunction pointToPointDistance(point1, point2) {\n    var lat1 = point1.latitude;\n    var lon1 = point1.longitude;\n    var lat2 = point2.latitude;\n    var lon2 = point2.longitude;\n\n    return getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2);\n}\n\nfunction getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {\n    var R = 6371; // Radius of the earth in km\n    var dLat = deg2rad(lat2 - lat1);\n    var dLon = deg2rad(lon2 - lon1);\n    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n        Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n        Math.sin(dLon / 2) * Math.sin(dLon / 2);\n\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    var d = R * c; // Distance in km\n\n    return d;\n}\n\n\nfunction projectPosition(origin, heading, distance) {\n    var coordinate = {};\n    var rtd = 180.0 / Math.PI;\n    var dtr = Math.PI / 180.0;\n    var brng = dtr * heading;\n    var lat1 = dtr * origin.latitude;\n    var lon1 = dtr * origin.longitude;\n    var kLatLonEarthRadius = 6371.0;\n\n    var lat2 = Math.asin(Math.sin(lat1) * Math.cos(distance / kLatLonEarthRadius) +\n        Math.cos(lat1) * Math.sin(distance / kLatLonEarthRadius) * Math.cos(brng));\n    var lon2 = lon1 + Math.atan2(Math.sin(brng) * Math.sin(distance / kLatLonEarthRadius) * Math.cos(lat1),\n        Math.cos(distance / kLatLonEarthRadius) - Math.sin(lat1) * Math.sin(lat2));\n    lon2 = fmod(lon2 + Math.PI, 2.0 * Math.PI) - Math.PI;\n\n    if (!isNaN(lat2) && !isNaN(lon2)) {\n        coordinate.latitude = lat2 * rtd;\n        coordinate.longitude = lon2 * rtd;\n        coordinate.altitude = 0;\n    }\n\n    return coordinate;\n}\n\nfunction fmod(a, b) {\n    return Number((a - (Math.floor(a / b) * b)).toPrecision(8));\n}\n\nexport default {\n    computeSatrec,\n    deg2rad,\n    getElevationWithPositionalData,\n    getOrbitPosition,\n    getOrbitPositionWithPositionalData,\n    headingAngleRadians,\n    projectPosition,\n    rad2deg\n};","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nimport utils from './utils/eo/utils';\nconst {\n    RenderableLayer,\n    Color,\n} = WorldWind;\n\nconst {\n    SwathCone\n} = WordWindX;\n\nconst getParams = (satName, type) => {\n\n    let translateDistance = null;\n\n    //swath width - so that the swath is the same width as the acq plan\n    let swathWidth;\n\n    //controls how big the swath is, higher values means a smaller swath\n    const swathHeight = 35;\n\n    if (satName === 's1a' || satName === 's1b') {\n        if (type === 'IW') {\n            //red\n            translateDistance = 490;\n            swathWidth = 130;\n        }\n        else if (type === 'EW') {\n            //green\n            translateDistance = 435;\n            swathWidth = 210;\n        }\n        else if (type === 'SM') {\n            //black\n            translateDistance = 308;\n            swathWidth = 41;\n        }\n        else {\n            return;\n        }\n    }\n    else if (satName === 's2a' || satName === 's2b') {\n        swathWidth = 145;\n        translateDistance = undefined;\n    } else if (satName === 's3a' || satName === 's3b') {\n        //FIXME\n        swathWidth = 145;\n        translateDistance = undefined;\n    }\n\n    return {\n        swathWidth,\n        swathHeight,\n        translateDistance,\n    }\n}\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer can render only one model of satellite. It`s possible to set position data of model.\n * @param options {Object}\n * @param options.key {String}\n * @param options.time {String}\n * @param options.tle {String}\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass SwathLayer extends RenderableLayer {\n\tconstructor(options) {\n        super(options);\n        this._rerenderMap = null;\n        this.key = options.key;\n        this.satName = options.satName;\n        this.time = options.time;\n        this.Tle = options.tle;\n        this.swath = null;\n        this.type = null;\n        this.color = Color.RED;\n    };\n\n    /**\n     * @param position {Array.<lte>} Lte.\n     */\n    setTle(Tle) {\n        if(Tle) {\n            this.Tle = Tle;\n            this.update();\n        }\n    }\n\n    /**\n     * @param type {string}\n     */\n    setType(type) {\n        const update = this.type !== type;\n        if(type) {\n            this.type = type;\n\n            if(update) {\n                this.update();\n            }\n        }\n    }\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    setTime(time) {\n        if(time) {\n            this.time = time;\n            this.update();\n        }\n    }\n\n\n    /**\n     * @param visible {Boolean} Time of the satellite.\n     */\n    setVisible(visible) {\n        const update = this.visible !== visible;\n        if(visible === true) {\n            this.visible = true;\n        } else {\n            this.visible = false;\n        }\n\n        if(update) {\n            this.update();\n        }\n    }\n\n    /**\n     * \n     */\n    update() {\n        this.removeAllRenderables();\n        if(this.visible && this.time && this.Tle && this.type) {\n            const satRec = utils.computeSatrec(...this.Tle);\n\n            const currentPosition = utils.getOrbitPosition(satRec, this.time);\n            \n            const nextPosition = utils.getOrbitPosition(satRec, new Date(this.time.getTime() + 10000));\n            const nNextPosition = utils.getOrbitPosition(satRec, new Date(this.time.getTime() + 20000));\n            const headingRad = utils.headingAngleRadians(currentPosition.latitude, currentPosition.longitude, nextPosition.latitude, nextPosition.longitude);\n            const currentHeading = utils.rad2deg(headingRad);\n            const nextHeadingRad = utils.headingAngleRadians(nextPosition.latitude, nextPosition.longitude, nNextPosition.latitude, nNextPosition.longitude);\n            const nextHeading = utils.rad2deg(nextHeadingRad);\n\n            const params = getParams(this.satName, this.type);\n            if(params && params.swathWidth && params.swathHeight) {\n                const {swathWidth, swathHeight, translateDistance} = params;\n                this.swath = new SwathCone({\n                    currentPosition,\n                    nextPosition,\n                    currentHeading,\n                    nextHeading\n                }, this.color, translateDistance, swathWidth, swathHeight);\n    \n                this.addRenderable(this.swath);\n            }\n        }\n        this.doRerender();\n    }\n    \n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n    \n\tsetColor(color) {\n        const update = this.color !== color;\n        if(color) {\n            this.color = color;\n\n            if(update) {\n                this.update();\n            }\n        }\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n\t}\n}\n\nexport default SwathLayer;\n\n","const modelsCache = new Map();\n\nexport const getModel = (path, key) => {\n\tconst loader = new Promise((resolve,reject) => {\n\t\tconst cached = modelsCache.has(key);\n\t\tif(cached) {\n\t\t\tresolve(modelsCache.get(key))\n\t\t} else {\n\t\t\tfetch(path).then(response => {\n\t\t\t\treturn response.json();\n\t\t\t}).then((model) => {\n\t\t\t\tmodel.key = key;\n\t\t\t\tresolve(model);\n\t\t\t});\n\t\t}\n\t});\n\treturn loader;\n}","export default class QuickLook {\r\n    constructor(iconUrl, fetch) {\r\n        this._icon = iconUrl;\r\n        this._fetch = fetch;\r\n\r\n        this._image = null;\r\n    }\r\n\r\n    /**\r\n     * Loads icon for the specific QuickLook in the form of image. Once the image was loaded, it is cached.\r\n     * @returns {Promise<Image>}\r\n     */\r\n    async icon() {\r\n        if(this._image) {\r\n            return this._image;\r\n        }\r\n        try {\r\n            // The request needs to be authorized\r\n            const response = await this._fetch(this._icon, {\r\n                headers: {\r\n                    \"Accept\": \"blob\",\r\n                }\r\n            });\r\n            if(!response.ok) {\r\n                throw new Error('ERROR QuickLook#icon Status: ' + response.status);\r\n            }\r\n            const blobData = await response.blob();\r\n            const url = window.URL.createObjectURL(blobData);\r\n            const image = await this.createImage(url);\r\n            window.URL.revokeObjectURL(url);\r\n    \r\n            this._image = image;\r\n            return image;    \r\n        } catch (err) {\r\n            throw new Error('ERROR QuickLook#icon Status: ' + err.message);\r\n        }\r\n    }\r\n\r\n    async createImage(url) {\r\n        return new Promise((resolve, reject) => {\r\n            flipImage(url, (base64src) => {\r\n                const imageOfQuickLook = new Image();\r\n                imageOfQuickLook.addEventListener('load', () => {\r\n                    resolve(imageOfQuickLook);\r\n                }, false);\r\n                imageOfQuickLook.src = base64src;\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nfunction flipImage (srcBase64, callback) {\r\n    const img = new Image();\r\n\r\n    // https://stackoverflow.com/questions/20600800/js-client-side-exif-orientation-rotate-and-mirror-jpeg-images\r\n    // https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\r\n    const srcOrientation = 4;\r\n\r\n    img.onload = function() {\r\n        var width = img.width,\r\n            height = img.height,\r\n            canvas = document.createElement('canvas'),\r\n            ctx = canvas.getContext(\"2d\");\r\n    \r\n        // set proper canvas dimensions before transform & export\r\n        if (4 < srcOrientation && srcOrientation < 9) {\r\n          canvas.width = height;\r\n          canvas.height = width;\r\n        } else {\r\n          canvas.width = width;\r\n          canvas.height = height;\r\n        }\r\n    \r\n        // transform context before drawing image\r\n        switch (srcOrientation) {\r\n          case 2: ctx.transform(-1, 0, 0, 1, width, 0); break;\r\n          case 3: ctx.transform(-1, 0, 0, -1, width, height); break;\r\n          case 4: ctx.transform(1, 0, 0, -1, 0, height); break;\r\n          case 5: ctx.transform(0, 1, 1, 0, 0, 0); break;\r\n          case 6: ctx.transform(0, 1, -1, 0, height, 0); break;\r\n          case 7: ctx.transform(0, -1, -1, 0, height, width); break;\r\n          case 8: ctx.transform(0, -1, 1, 0, 0, width); break;\r\n          default: break;\r\n        }\r\n    \r\n        // draw image\r\n        ctx.drawImage(img, 0, 0);\r\n    \r\n        // export base64\r\n        callback(canvas.toDataURL());\r\n      };\r\n\r\n      img.src = srcBase64;\r\n}","import WorldWind from 'webworldwind-esa';\n\nconst {\n    Location\n} = WorldWind;\n\n\nexport function parseWKT(text) {\n    const i = text.indexOf('(');\n    const type = text.slice(0, i).trim();\n    const geometry = text.slice(i + 1, -1).trim();\n    if (type.toLowerCase() === 'polygon') {\n        return parsePolygon(geometry);\n    }\n    else if (type.toLowerCase() === 'multipolygon') {\n        //console.log('geometry', geometry);\n        const polygonStrings = splitMultiPolygon(geometry);\n        const polygons = polygonStrings.map(geo => {\n            const polygon = parsePolygon(geo);\n            return polygon[0];\n        });\n        //console.log('polygons', polygons);\n        return polygons;\n    }\n}\n\nfunction splitMultiPolygon(geometryString) {\n    const polygons = [];\n    let startIndex = 0;\n    let opened = 0;\n    for (var i = 0, len = geometryString.length; i < len; i++) {\n        var char = geometryString[i];\n        if (char === '(') {\n            if (opened === 0) {\n                startIndex = i;\n            }\n            opened++;\n        }\n        else if (char === ')') {\n            opened--;\n            if (opened === 0) {\n                polygons.push(geometryString.slice(startIndex, i));\n            }\n        }\n    }\n    return polygons;\n}\n\nfunction parsePolygon(geometry) {\n    const res = [];\n    let currentPolygon = '';\n    for (var i = 0, len = geometry.length; i < len; i++) {\n        var char = geometry[i];\n        if (char === '(') {\n            currentPolygon = '';\n        }\n        else if (char === ')') {\n            var pairs = currentPolygon.split(',');\n            var locations = pairs.map(pair => {\n                const lonLat = pair.trim().split(' ');\n                const lon = +lonLat[0];\n                const lat = +lonLat[1];\n                return new Location(lat, lon);\n            });\n            res.push(locations);\n        }\n        else {\n            currentPolygon += char;\n        }\n    }\n    return res;\n}","import {parseWKT} from \"./WKTParser\";\n\nexport default function parseJSON(response) {\n    const featureCollection = {\n        id: '',\n        type: 'FeatureCollection',\n        features: [],\n        properties: {}\n    };\n\n    let root;\n    try {\n        const jsonData = JSON.parse(response);\n        root = jsonData.feed;\n    }\n    catch (e) {\n        return featureCollection;\n    }\n\n    featureCollection.properties.totalResults = +root['opensearch:totalResults'] || 0;\n    featureCollection.properties.startIndex = +root['opensearch:startIndex'] || 0;\n    featureCollection.properties.itemsPerPage = +root['opensearch:itemsPerPage'] || 0;\n\n    if (Array.isArray(root.link)) {\n        if (!featureCollection.properties.links) {\n            featureCollection.properties.links = {};\n        }\n        root.link.forEach(link => {\n            const rel = link.rel;\n            if (!rel) {\n                return;\n            }\n            featureCollection.properties.links[rel] = link.href;\n        });\n    }\n\n    if (Array.isArray(root.entry)) {\n        featureCollection.features = root.entry.map(parseEntry);\n    }\n    else if (root.entry){\n        featureCollection.features.push(parseEntry(root.entry));\n    }\n\n    return featureCollection;\n\n}\n\nexport function parseEntry(entryObj) {\n    const feature = {\n        id: '',\n        type: 'Feature',\n        bbox: [],\n        geometry: null,\n        properties: {}\n    };\n\n    const properties = feature.properties;\n\n    if (entryObj.date) {\n        if (Array.isArray(entryObj.date)) {\n            entryObj.date.forEach(prop => {\n                if (prop.name) {\n                    properties[prop.name] = new Date(prop.content).getTime();\n                }\n            });\n        }\n        else if (entryObj.date.name) {\n            properties[entryObj.date.name] = new Date(entryObj.date.content).getTime();\n        }\n    }\n\n    if (entryObj.double) {\n        if (Array.isArray(entryObj.double)) {\n            entryObj.double.forEach(prop => {\n                if (prop.name) {\n                    properties[prop.name] = +prop.content;\n                }\n            });\n        }\n        else if (entryObj.double.name) {\n            properties[entryObj.double.name] = +entryObj.double.content;\n        }\n    }\n\n    if (entryObj.int) {\n        if (Array.isArray(entryObj.int)) {\n            entryObj.int.forEach(prop => {\n                if (prop.name) {\n                    properties[prop.name] = +prop.content;\n                }\n            });\n        }\n        else if (entryObj.int.name) {\n            properties[entryObj.int.name] = +entryObj.int.content;\n        }\n    }\n\n    if (entryObj.link) {\n        if (Array.isArray(entryObj.link)) {\n            entryObj.link.forEach(prop => {\n                if (prop.rel === 'icon') {\n                    properties.quickLook = prop.href;\n                }\n            });\n        }\n        else if (entryObj.link.rel === 'icon') {\n            properties.quickLook = entryObj.link.href;\n        }\n    }\n\n    if (entryObj.str) {\n        for (const [key, prop] of Object.entries(entryObj.str)) {\n            if (prop.name === 'gmlfootprint' || prop.name === 'footprint') {\n                continue;\n            }\n\n            if (prop.name && prop.name !== 'real_footprint') {\n                properties[prop.name] = prop.content;\n            }\n\n            if (prop.name === 'real_footprint') {\n                feature.geometry = parseWKT(prop.content);\n            }\n        };\n\n        if (!feature.geometry) {\n            const footprint = entryObj.str.footprint;\n            if (footprint) {\n                feature.geometry = parseWKT(footprint.content);\n            }\n        }\n    }\n    if (!properties.tileid && (properties.filename || entryObj.title)) {\n        //S2A_MSIL2A_20180612T095031_N0208_R079_T33SUB_20180612T123902\n        let filename = properties.filename || entryObj.title;\n        const [sat, productLevel, sensingDate, processingBaselineNumber,\n            relativeOrbitNumber, tileId, productDiscriminator] = filename.trim().split('_');\n        properties.tileid = tileId.slice(1);\n    }\n\n    return feature;\n}","import WorldWind from 'webworldwind-esa';\r\nimport QuickLook from \"./QuickLook\";\r\nimport {parseEntry} from \"./SciHubJSONParser\";\r\nimport TexturedSurfacePolygon from '../textured/TexturedSurfacePolygon';\r\n\r\nconst {\r\n    Color,\r\n    ShapeAttributes,\r\n} = WorldWind;\r\n\r\nexport default class Product {\r\n    constructor(fetch, entry) {\r\n        if(!entry || !entry.id || !fetch) {\r\n            throw new Error(`Product#constructor Provided entry is either null or invalid. Entry ${entry}`);\r\n        }\r\n\r\n        this._id = entry.id;\r\n        this._entry = entry;\r\n\r\n        // Renderable related information\r\n        this._footprint = entry.str && entry.str.footprint && entry.str.footprint && entry.str.footprint.content || null;\r\n        const icons = entry.link && entry.link.length > 0 &&\r\n            entry.link.filter(link => link.rel && link.rel === 'icon') || [];\r\n        const iconUrl = icons.length > 0 && icons[0].href || null;\r\n        if(iconUrl) {\r\n            this._icon = new QuickLook(iconUrl, fetch);\r\n        } else {\r\n            this._icon = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Unique identifier of the specific product\r\n     * @returns {String} UUID of the given product\r\n     */\r\n    id() {\r\n        return this._id;\r\n    }\r\n\r\n    /**\r\n     * The whole entry related to this product.\r\n     * @returns {Object} Entry representing the product.\r\n     */\r\n    metadata() {\r\n        return this._entry;\r\n    }\r\n\r\n    /**\r\n     * Renderable for displaying this Product including QuickLook or null, if this wouldn't make any sense.\r\n     * It doesn't make sense when no footprint is provided.\r\n     * @returns {Promise<Renderable>}\r\n     */\r\n    async renderable() {\r\n        if(!this._footprint) {\r\n            return Promise.resolve(null);\r\n        }\r\n\r\n        const feature = parseEntry(this._entry)\r\n        let boundaries = feature.geometry[0];\r\n        const renderable = new TexturedSurfacePolygon(boundaries, this.footprintAttributes());\r\n        renderable.maximumNumEdgeIntervals = 2;\r\n        renderable.polarThrottle = 1;\r\n\r\n        if(this._icon) {\r\n            try {\r\n                renderable.image = await this._icon.icon();\r\n            } catch (e) {\r\n                console.log('ERROR: Product#renderable ', e);\r\n                renderable.error = e;\r\n            }\r\n        }\r\n        return renderable;\r\n    }\r\n\r\n    /**\r\n     * The default attributes to be used for the Footprint.\r\n     * @return {ShapeAttributes} Attributes for the footprint shapes\r\n     */\r\n    footprintAttributes() {\r\n        const shapeAttributes = new ShapeAttributes(null);\r\n        shapeAttributes.drawOutline = true;\r\n        shapeAttributes.drawInterior = true;\r\n        shapeAttributes.outlineColor = new Color(1, 0, 0, 1);\r\n        shapeAttributes.interiorColor = new Color(1, 1, 0, 0.3);\r\n        shapeAttributes.outlineWidth = 1;\r\n        return shapeAttributes;\r\n    }\r\n}","export default class Query {\r\n    /**\r\n     * Representation of the query for the SciHub.\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @param startIndex {Number} Index of the first returned results\r\n     */\r\n    constructor({shortName, products = [], location, beginTime, endTime, startIndex} = {}) {\r\n        this._shortName = shortName;\r\n        this._products = products;\r\n        this._location = location;\r\n        this._beginTime = beginTime;\r\n        this._endTime = endTime;\r\n        this._startIndex = startIndex;\r\n    }\r\n\r\n    /**\r\n     * URL representation of the query for the SciHub.\r\n     * @returns {string} query part of the URL for the SciHub request.\r\n     */\r\n    url() {\r\n        let toSerialize = [];\r\n\r\n        if(this._location){\r\n            toSerialize.push(serializeLocation(this._location));\r\n        }\r\n        if(this._beginTime && this._endTime) {\r\n            toSerialize.push(serializeTime(this._beginTime, this._endTime));\r\n        }\r\n\r\n        const platformNameQuery = '(filename:(' + serializeFileName(this._shortName) + '))';\r\n        const productsQuery = serializeProductType(this._products);\r\n        toSerialize.push(platformNameQuery, productsQuery);\r\n        const queryValue = toSerialize.join('AND');\r\n        const format = `format=json`;\r\n        return `?q=${encodeURIComponent(queryValue)}&rows=100&start=${this._startIndex}&orderby=${encodeURIComponent('beginposition desc')}&${format}`;\r\n    }\r\n}\r\n\r\nconst serializeProductType = (products) => {\r\n    const productsString = products.join(' OR ');\r\n    return '(producttype:(' + productsString + '))';\r\n};\r\n\r\nconst serializeLocation = ({latitude, longitude}) => {\r\n    return '(footprint:\"intersects(' + latitude + ', ' + longitude + ')\")';\r\n};\r\n\r\nconst serializeFileName = (shortSatName) => {\r\n    if (shortSatName === 'S-1A') {\r\n        return 'S1A_*';\r\n    }\r\n    if (shortSatName === 'S-2A') {\r\n        return 'S2A_*';\r\n    }\r\n    if (shortSatName === 'S-3A') {\r\n        return 'S3A_*';\r\n    }\r\n    if (shortSatName === 'S-1B') {\r\n        return 'S1B_*';\r\n    }\r\n    if (shortSatName === 'S-2B') {\r\n        return 'S2B_*';\r\n    }\r\n    if (shortSatName === 'S-5P') {\r\n        return '';\r\n    }\r\n    if (shortSatName === 'S-3B') {\r\n        return 'S3B_*';\r\n    }\r\n};\r\n\r\nconst serializeTime = (startTime, endTime) => {\r\n    return `(beginposition: [${startTime.toISOString()} TO ${endTime.toISOString()}])`;\r\n};","import moment from 'moment';\r\nimport Product from './Product';\r\nimport Query from './Query';\r\n\r\nconst getProductsInTime = (products, startDate, endDate) => {\r\n    const startDateMoment = moment.utc(startDate);\r\n    const endDateMoment = moment.utc(endDate);\r\n\r\n    return products.filter((product) => {\r\n        const metadata = product.metadata();\r\n        const beginpositionDate = metadata.date.find((d) => {\r\n            return d.name === 'beginposition'\r\n        })\r\n        const beginposition = beginpositionDate && beginpositionDate.content && moment.utc(beginpositionDate.content)\r\n\r\n        const endpositionDate = metadata.date.find((d) => {\r\n            return d.name === 'endposition'\r\n        })\r\n        const endposition = endpositionDate && endpositionDate.content && moment.utc(endpositionDate.content)\r\n\r\n        return beginposition.isBetween(startDateMoment, endDateMoment) || endposition.isBetween(startDateMoment, endDateMoment)\r\n    });\r\n}\r\n\r\nexport const productIntersectTime = (product, time) => {\r\n    const timeMoment = moment(time);\r\n    const metadata = product.metadata();\r\n    const beginpositionDate = metadata.date.find((d) => {\r\n        return d.name === 'beginposition'\r\n    })\r\n    const beginposition = beginpositionDate && beginpositionDate.content && moment.utc(beginpositionDate.content)\r\n\r\n    const endpositionDate = metadata.date.find((d) => {\r\n            return d.name === 'endposition'\r\n        })\r\n    const endposition = endpositionDate && endpositionDate.content && moment.utc(endpositionDate.content    )\r\n\r\n    return timeMoment.isBetween(beginposition, endposition);\r\n}\r\n\r\nconst getCacheID = (shortName, products, location, hour) => {\r\n    return `${shortName}-${products}-${location}-${hour}`;\r\n}\r\n\r\nexport const parseEntry = (entry) => {\r\n    if(entry && entry.id) {\r\n        const parsedEntry = {\r\n            title:{...entry.title},\r\n            link:[...entry.link],\r\n            id:{...entry.id},\r\n            summary:{...entry.summary},\r\n            date:[...entry.date],\r\n        };\r\n\r\n        parsedEntry.id = entry.id;\r\n\r\n        const str = {};\r\n        entry.str.forEach(element => {\r\n            const name = element.name;\r\n            str[name] = element;\r\n        });\r\n        parsedEntry.str = str;\r\n\r\n        parsedEntry.link = entry.link.map(element => {\r\n            return {\r\n                rel: element.rel,\r\n                href: element.href\r\n            };\r\n        });\r\n        return parsedEntry;\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default class Products {\r\n    /**\r\n     * Products represents collection of the products from different satellites. The Query is focused on the SciHub.\r\n     * @param cache {Map} Cache to be used for storing the retrieved products.\r\n     * @param fetch {Function} Function with provided defaults for making requests.\r\n     * @param baseUrl {String} Optional. Optional URL for the retrieval of the products. Default is SciHub\r\n     */\r\n    constructor(cache, searchCache, fetch, baseUrl = 'https://scihub.copernicus.eu/apihub/search') {\r\n        this._baseUrl = baseUrl;\r\n        this._cache = cache;\r\n        this._searchCache = searchCache;\r\n\r\n        this._fetch = fetch;\r\n    }\r\n\r\n    parseSearchResults(hours, beginTime, endTime) {\r\n        let filteredProducts = [];\r\n        for(const [key, value] of hours.entries()) {\r\n            const processed = this.processProducts(value);\r\n            filteredProducts = [...filteredProducts, ...processed];\r\n        };\r\n        return getProductsInTime(filteredProducts, beginTime, endTime)\r\n    }\r\n\r\n    loadSearch(hours, shortName, products, location) {\r\n        // load unloaded hour\r\n        for(const [hour, search] of hours.entries()) {\r\n            if(!search) {\r\n                const hourLoader = this.loadSearchByHour(shortName, products, location, hour);\r\n                hours.set(hour, hourLoader);\r\n            }\r\n        };\r\n\r\n        //wait until all hours loads\r\n        const promises = []\r\n        for(const [hour, search] of hours.entries()) { \r\n            const isPromise = typeof search.then === 'function';\r\n            if(isPromise) {\r\n                promises.push(search);\r\n            }\r\n        };\r\n\r\n        return Promise.all(promises).then(searchResults => {\r\n            for (const result of searchResults) {\r\n                this._searchCache.set(getCacheID(shortName, products, location, result.hour), result.search);\r\n                hours.set(result.hour, result.search);\r\n            }\r\n            return searchResults;\r\n        });\r\n    }\r\n\r\n    getChachedSearch(hours, shortName, products, location) {\r\n        // get hours from cache\r\n        for(const hour of hours.keys()) {\r\n            hours.set(hour, this._searchCache.get(getCacheID(shortName, products, location, hour)));\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Retrieve the product information from the SciHub. The process has two parts.\r\n     *   The first part is retrieving the products available for given combination of the parameters.\r\n     *   The second part is to retrieve the actual quicklooks for all the products not already stored in cache.\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @returns {Promise<Product[]>} Product for further use.\r\n     */\r\n    async products({shortName, products = [], location, beginTime, endTime} = {}) {\r\n        const momentBeginTime = moment.utc(beginTime).startOf('hour');\r\n        const momentEndTime = moment.utc(endTime).endOf('hour');\r\n        const diff = momentEndTime.diff(momentBeginTime);\r\n        const duration = moment.duration(diff);\r\n        const durationInHours = Math.ceil(duration.asHours());\r\n\r\n        const hours = new window.Map();\r\n        for (let i = 0; i < durationInHours; i++) {\r\n            const time = moment.utc(momentBeginTime).add(i, 'hour');\r\n            hours.set(time.format('YYYY-MM-DD-HH'));\r\n        }\r\n\r\n        this.getChachedSearch(hours, shortName, products, location);\r\n\r\n        return this.loadSearch(hours, shortName, products, location).then((results) => {\r\n            const hoursString = [...hours.keys()].sort();\r\n            const firstHour = hoursString[0];\r\n            const lastHour = hoursString[hoursString.length - 1];\r\n            const beforeFirstHour = moment.utc(firstHour, 'YYYY-MM-DD-HH').subtract(1, 'hour').startOf('hour').format('YYYY-MM-DD-HH');\r\n            const afterLastHour = moment.utc(lastHour, 'YYYY-MM-DD-HH').add(1, 'hour').startOf('hour').format('YYYY-MM-DD-HH');\r\n\r\n            const marginHours = new window.Map();\r\n            marginHours.set(beforeFirstHour);\r\n            marginHours.set(afterLastHour);\r\n\r\n            this.getChachedSearch(marginHours, shortName, products, location);\r\n            this.loadSearch(marginHours, shortName, products, location)\r\n            return this.parseSearchResults(hours, beginTime, endTime)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Retrieve the product information from the SciHub. The process has two parts.\r\n     *   The first part is retrieving the products available for given combination of the parameters.\r\n     *   The second part is to retrieve the actual quicklooks for all the products not already stored in cache.\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @returns {Promise<Product[]>} Product for further use.\r\n     */\r\n    async loadSearchByHour(shortName, products, location, hour) {\r\n        const beginTime = moment.utc(hour, 'YYYY-MM-DD-HH').startOf('hour');\r\n        const endTime = moment.utc(hour, 'YYYY-MM-DD-HH').endOf('hour');\r\n        const resultsPerPage = 100;\r\n        let startIndex = 0;\r\n        let currentPage;\r\n        do {\r\n            currentPage = await this.load({shortName, products, location, beginTime: beginTime.toDate(), endTime: endTime.toDate(), startIndex});\r\n            startIndex += resultsPerPage;\r\n\r\n            // const processed = this.processProducts(currentPage);\r\n            // filteredProducts.push.apply(filteredProducts, processed);\r\n        } while(currentPage.next);\r\n\r\n        return {\r\n            hour,\r\n            search: currentPage\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Retrieve the product information from the SciHub. The process has two parts.\r\n     *   The first part is retrieving the products available for given combination of the parameters.\r\n     *   The second part is to retrieve the actual quicklooks for all the products not already stored in cache.\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @returns {Promise<Object>}\r\n     *   errors contains array of errors happening during creation of the renderables.\r\n     *   total represents the total amount of products\r\n     *   renderables the renderables tobe displayed\r\n     */\r\n    async renderables({shortName, products = [], location, beginTime, endTime} = {}) {\r\n        const productsLocal = await this.products({shortName, products, location, beginTime, endTime});\r\n        const renderables = [];\r\n        const errors = [];\r\n        for(let productIndex = 0; productIndex < productsLocal.length; productIndex++) {\r\n            try {\r\n                const renderable = await productsLocal[productIndex].renderable();\r\n                if(renderable.error) {\r\n                    errors.push(renderable.error);\r\n                }\r\n                renderables.push(renderable);\r\n            } catch(e) {\r\n                console.log('Products#renderables', e);\r\n                errors.push(e);\r\n            }\r\n        }\r\n        return {\r\n            errors: errors,\r\n            renderables: renderables,\r\n            total: productsLocal.length\r\n        };\r\n    }\r\n\r\n    /**\r\n     * From the entries received from Sci Hub creates relevant products with all necessary information for further\r\n     * processing and visualization.\r\n     * @private\r\n     * @param feed {Object} Atom feed with the information about the products.\r\n     * @returns {Array<Product>} Valid products\r\n     */\r\n    processProducts(feed) {\r\n        if(feed.entry && feed.entry.length > 0) {\r\n            return feed.entry.map(entry => {\r\n                const parsedEntry = parseEntry(entry);\r\n                if(parsedEntry && parsedEntry.id) {\r\n                    const id = parsedEntry.id;\r\n                    const cached = this._cache.get(id);\r\n                    if(!cached) {\r\n                        const product = new Product(this._fetch, parsedEntry);\r\n                        this._cache.set(product.id(), product);\r\n                        return product;\r\n                    } else {\r\n                        return cached;\r\n                    }\r\n                } else {\r\n                    return null;\r\n                }\r\n            }).filter(product => product);\r\n        } else {\r\n            return [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load feed with the products from the remote source.\r\n     * @private\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @param startIndex {Number} The index of the first result to query for.\r\n     * @returns {Promise<Object>} Feed from the response.\r\n     */\r\n    async load({shortName, products = [], location, beginTime, endTime, startIndex} = {}) {\r\n        const query = new Query({shortName, products, location, beginTime, endTime, startIndex});\r\n        const url = this._baseUrl + query.url();\r\n        const cached = this._cache.get(url);\r\n        if(cached) {\r\n            return JSON.parse(cached);\r\n        }\r\n\r\n        try {\r\n            //\r\n            // TODO - solenix proxy needs request without Authorization\r\n            //\r\n            const response = await window.fetch(url, {\r\n                headers: {\r\n                    'Accept': 'application/json'\r\n                }\r\n            });\r\n\r\n            const res = await response.json();\r\n            const feed = res.feed;\r\n\r\n            // Here it is necessary to decide whether there are more results.\r\n            const totalResults = Number(feed['opensearch:totalResults']);\r\n            const itemsPerPage = Number(feed['opensearch:itemsPerPage']);\r\n\r\n            feed.next = (startIndex + itemsPerPage) < totalResults;\r\n            this._cache.set(url, JSON.stringify(feed));\r\n            return feed;\r\n        } catch (error) {\r\n            throw (new Error('Error in loading products list'));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load product bygiven key.\r\n     * @param key {String} Key of product\r\n     * @returns {Promise<Object>} Feed from the response.\r\n     */\r\n    async loadProduct(key = '') {\r\n        const getUrl = (key) => `https://scihub.copernicus.eu/apihub/odata/v1/Products('${key}')/`;\r\n        const url = getUrl(key);\r\n        const cached = this._cache.get(url);\r\n        if(cached) {\r\n            return JSON.parse(cached);\r\n        }\r\n\r\n        try {\r\n            const response = await this._fetch(url, {\r\n                headers: {\r\n                    'Accept': 'application/json'\r\n                }\r\n            });\r\n\r\n            const parsed = await response.json();\r\n\r\n            const entry = parsed.d;\r\n            this._cache.set(url, JSON.stringify(entry));\r\n            return entry;\r\n        } catch (error) {\r\n            throw (new Error(`Error in loading product ${key}`));\r\n        }\r\n    }\r\n}","export const hubUsername = 'copapps';\nexport const hubPassword = 'C9C-2EZ-gQ4-ezY';\n\nconst getBaseUrl = () => {\n    if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\n        // run proxy `npm run proxy` to use this url\n        return 'http://localhost:3031';\n    } else {\n        return 'https://eoapps.solenix.ch';\n    }\n}\nexport const sciHubUrl = `${getBaseUrl()}/scihub/search`;","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nimport createCachedSelector from 're-reselect';\nimport './style.css';\nimport SatelliteModelLayer from './SatelliteModelLayer';\nimport OrbitLayer from './OrbitLayer';\nimport SentinelCloudlessLayer from './SentinelCloudlessLayer';\nimport SentinelTopologyLayer from './SentinelTopologyLayer';\nimport AcquisitionPlanLayer from './AcquisitionPlanLayer';\nimport StatisticsLayer from './Statistics/StatisticsLayer';\nimport MultiRangeLayer from './MultiRangeLayer';\nimport FootPrintLayer from './FootPrintLayer';\nimport SwathLayer from './SwathLayer';\nimport {getPlansKeys} from '../../utils/acquisitionPlans';\nimport {getBoundaries, productBounds} from '../../utils/product';\nimport {getModel} from './satellitesModels';\nimport SciHubProducts, {productIntersectTime} from '../../worldwind/products/Products';\nimport {hubPassword, hubUsername, sciHubUrl} from \"../../config\";\nimport { getSwathKey, getColorForSatType } from '../../utils/swath';\n\nwindow.WorldWind.configuration.baseUrl = `${window.location.origin}${window.location.pathname}`;\nconsole.log(\"WorldWind.configuration.baseUrl set to: \", window.WorldWind.configuration.baseUrl);\n\nconst {\n    StarFieldLayer,\n    EoUtils,\n} = WordWindX;\n\nconst {\n    RenderableLayer,\n    AtmosphereLayer,\n} = WorldWind;\n\nconst csiRenderablesCache = new window.Map();\nconst searchCache = new window.Map();\nconst layersCache = new window.Map();\nconst productsScihub = new SciHubProducts(csiRenderablesCache, searchCache, fetchWithCredentials, sciHubUrl);\nconst defaultBackgroundLayer = new SentinelCloudlessLayer();\nconst defaultStarfieldLayer = new StarFieldLayer('./images/stars.json');\nconst defaultAtmosphereLayer = new AtmosphereLayer('./images/dnb_land_ocean_ice_2012.png');\n\nconst MINVISIBLERANGE = 1000000;\nconst MAXVISIBLERANGE = 100000000000;\n\nconst multiRangeAtmosphereLayer = new MultiRangeLayer('multiRangeAtmosphereLayer', {\n    key: 'multiRangeAtmosphereLayer',\n    layers: [{\n        layer:defaultAtmosphereLayer,\n        rangeInterval: [MINVISIBLERANGE,MAXVISIBLERANGE]\n    }]\n});\nconst productsRequests = new window.Map();\nconst defaultTopologyLayer = new SentinelTopologyLayer();\nconst multiRangeTopologyLayer = new MultiRangeLayer('multiRangeTopologyLayer', {\n    key: 'multiRangeTopologyLayer',\n    layers: [{\n        layer:defaultTopologyLayer,\n        rangeInterval: [MINVISIBLERANGE,MAXVISIBLERANGE]\n    }]\n});\n\n\nexport function getLayerKeySCIHubResult (layerConfig) {\n    return `${layerConfig.id}`;\n}\n\nexport function getLayerKeyFromConfig (layerConfig) {\n    //identify search layer\n    if(layerConfig && layerConfig.results && layerConfig.results[0] && layerConfig.results[0].id && layerConfig.results[0].id) {\n        return getLayerKeySCIHubResult(layerConfig.results[0]);\n    } else if(layerConfig.satKey && layerConfig.layerKey) {\n        return `${layerConfig.satKey}-${layerConfig.layerKey}`;   \n    } else {\n        return `${layerConfig.type}-${layerConfig.key}`;\n    }\n}\n\nexport function getLayerIdFromConfig (layerConfig) {\n    if(layerConfig.satKey && layerConfig.layerKey && layerConfig.beginTime && layerConfig.endTime) {\n        return `${layerConfig.satKey}-${layerConfig.layerKey}-${layerConfig.beginTime.toString()}-${layerConfig.endTime.toString()}`;   \n    } else if(layerConfig && layerConfig.results && layerConfig.results[0] && layerConfig.results[0].id && layerConfig.results[0].id) {\n        return getLayerKeySCIHubResult(layerConfig.results[0]);\n    }else {\n        return layerConfig.key;\n    }\n}\n\nexport function getProductByKey (productKey) {\n    return csiRenderablesCache.get(productKey);\n}\n\nconst filterOrbitLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'orbit');\n}\n\nconst filterAcquisitionPlanLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'acquisitionPlan');\n}\n\nconst filterStatisticsLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'statistics');\n}\n\nconst filterSwathLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'swath');\n}\n\nconst filterSatelliteLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'satellite');\n}\n\nconst filterSentinelDataLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'sentinelData');\n}\n\nconst filterSearchLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'sentinelFootprint');\n}\n\nexport function getLayerByName (name, layers) {\n    return layers.find(l => l.displayName === name);\n}\n\nfunction fetchWithCredentials (url, options = {}) {\n    if (!options.headers) {\n        options.headers = {};\n    }\n    options.headers.Authorization = `Basic ${window.btoa(`${hubUsername}:${hubPassword}`)}`;\n\n    const fetch = window.fetch(url, options);\n    return fetch;\n};\n\nconst getSentinelLayer = (layerConfig) => {\n    const layerKey = getLayerKeyFromConfig(layerConfig);\n    const cacheLayer = layersCache.get(layerKey);\n    if(cacheLayer) {\n        return cacheLayer;\n    } else {\n        const layer = new RenderableLayer(layerKey);\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getFootprintLayer = (layerConfig) => {\n    const layerKey = getLayerKeySCIHubResult(layerConfig.results[0]);\n    const cacheLayer = layersCache.get(layerKey);\n    \n    if(cacheLayer) {\n        return cacheLayer;\n    } else {\n        const layer = new FootPrintLayer(layerKey);\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getOrbitLayer = (layerConfig, time = new Date(), wwd, currentTime) => {\n    const layerKey = layerConfig.key;\n    const cacheLayer = layersCache.get(layerKey);\n\n    //set specs\n\n    if(cacheLayer) {\n        let changed = false;\n        if(time.toString() !== cacheLayer.selectTime.toString() || currentTime.toString() !== cacheLayer.currentTime.toString()) {\n            changed = true;\n            cacheLayer.setTime(new Date(currentTime), new Date(time), true);\n        }\n\n        if(layerConfig.specs[0] !== (cacheLayer.satRec && cacheLayer.satRec[0]) || layerConfig.specs[1] !== (cacheLayer.satRec && cacheLayer.satRec[1])) {\n            changed = true;\n            cacheLayer.setSatRec(layerConfig.specs, true);\n        }\n\n        if(changed) {\n            cacheLayer.forceUpdate();\n        }\n        return cacheLayer;\n    } else {\n        const layer = new OrbitLayer({key: layerKey, satRec: layerConfig.specs, time, currentTime, opacity: 0.7});\n        layer.setRerender(() => wwd.redraw());\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getAcquisitionPlanLayer = (layerConfig, wwd, time, onLayerChanged) => {\n    const layerKey = layerConfig.key;\n    const cacheLayer = layersCache.get(layerKey);\n    const plans = layerConfig.plans;\n\n    if(cacheLayer) {\n        const plansKeys = getPlansKeys(plans);\n        const cacheLayerPlansKeys = getPlansKeys(cacheLayer.plans);\n        \n        if(plansKeys !== cacheLayerPlansKeys) {\n            cacheLayer.setPlans(plans);\n        }\n\n        if(time.getTime() !== cacheLayer.time.getTime()) {\n            cacheLayer.setTime(time);\n        }\n        return cacheLayer;\n    } else {\n        const layer = new AcquisitionPlanLayer({key: layerKey, satName: layerConfig.satName, time: time, onLayerChanged, range: layerConfig.range});\n        layer.setPlans(plans);\n        layer.setRerender(() => wwd.redraw());\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getStatisticsLayer = (layerConfig, wwd, time, onLayerChanged) => {\n    const layerKey = layerConfig.key;\n    const cacheLayer = layersCache.get(layerKey);\n    const plans = layerConfig.plans;\n\n    if(cacheLayer) {\n        const plansKeys = getPlansKeys(plans);\n        const cacheLayerPlansKeys = getPlansKeys(cacheLayer.plans);\n\n        if(time.getTime() !== cacheLayer.time.getTime()) {\n            cacheLayer.setTime(time);\n        }\n        return cacheLayer;\n    } else {\n        const layer = new StatisticsLayer({key: layerKey, satName: layerConfig.satName, time: time, onLayerChanged, sensornames: layerConfig.sensornames});\n        layer.setTime(time);\n        layer.setRerender(() => wwd.redraw());\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getSwathLayer = (layerConfig, wwd, time) => {\n    const layerKey = layerConfig.key;\n    \n    const cacheLayer = layersCache.get(layerKey);\n\n    // const plans = layerConfig.plans;\n\n    if(cacheLayer) {\n        //if changed TLE in config\n        if((layerConfig.tle && layerConfig.tle[0]) !== (cacheLayer.Tle && cacheLayer.Tle[0]) || (layerConfig.tle && layerConfig.tle[1]) !== (cacheLayer.Tle && cacheLayer.Tle[1])) {\n            cacheLayer.setTle(layerConfig.tle);\n        }\n\n            if(time.toString() !== cacheLayer.time.toString()) {\n                cacheLayer.setTime(time);\n            }\n            const layerAcquisitionKey = layerConfig.apsKey;\n            const sentinelLayerKey = layerConfig.sentinelLayerKey;\n            //check if in future\n            if(layerAcquisitionKey) {\n                const cacheLayerAcquisition = layersCache.get(layerAcquisitionKey);\n                const swath = cacheLayerAcquisition.getFootprints(0);\n                swath.then(data => {\n                    if(data && data.outlines && data.outlines.length > 0) {\n                        const color = data.interiors[0].attributes.interiorColor;\n                        const type = data.interiors[0].kmlProps.Mode;\n                        cacheLayer.setType(type);\n                        cacheLayer.setColor(color);\n                        cacheLayer.setVisible(true);\n                    } else {\n                        cacheLayer.setVisible(false);\n                    }\n                })\n            //check if in past over some data, between start and stop date\n            } else if(sentinelLayerKey){\n                const sentinelLayer = layersCache.get(`${layerConfig.satName}-${layerConfig.sentinelLayerKey}`)\n                const renderables = sentinelLayer.renderables;\n                if(renderables) {\n                    //check renderables intersect select time\n                    const products = renderables.map((r) => getProductByKey(r.userProperties.key));\n                    const intersectedProduct = products.find((p) => productIntersectTime(p, time))\n                    if(intersectedProduct) {\n                        const type = intersectedProduct.metadata().str.sensoroperationalmode && intersectedProduct.metadata().str.sensoroperationalmode.content;\n                        const color = getColorForSatType(layerConfig.satName, type); //get color by type\n                        cacheLayer.setType(type);\n                        cacheLayer.setColor(color);\n                        cacheLayer.setVisible(true);\n                    } else {\n                        cacheLayer.setVisible(false);\n                    }\n                } else {\n                    cacheLayer.setVisible(false);\n                }\n            } else {\n                cacheLayer.setVisible(false);\n            }\n            \n\n        return cacheLayer;\n    } else {\n        const layer = new SwathLayer({key: layerKey, satName: layerConfig.satName, time: time, tle: layerConfig.tle});\n        layer.setRerender(() => wwd.redraw());\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getSatelliteLayer = (layerConfig, time, wwd, onLayerChanged) => {\n    const layerKey = layerConfig.key;\n    const cacheLayer = layersCache.get(layerKey);\n    if(cacheLayer) {\n        //upadte time on change\n        if(time.toString() !== cacheLayer.time.toString()) {\n            cacheLayer.setTime(time);\n        }\n\n        //if changed TLE in config\n        if((layerConfig.tle && layerConfig.tle[0]) !== (cacheLayer.Tle && cacheLayer.Tle[0]) || (layerConfig.tle && layerConfig.tle[1]) !== (cacheLayer.Tle && cacheLayer.Tle[1])) {\n            cacheLayer.setTle(layerConfig.tle);\n        }\n\n        return cacheLayer;\n    } else {\n        const options = {\n            rotations: layerConfig.satData.rotations,\n            preRotations: layerConfig.satData.preRotations,\n            scale: layerConfig.satData.scale,\n            translations: layerConfig.satData.translations,\n            ignoreLocalTransforms: layerConfig.satData.ignoreLocalTransforms,\n        }\n        const layer = new SatelliteModelLayer({key: layerKey, time: time, onLayerChanged}, options);\n        layer.setRerender(() => wwd.redraw());\n        getModel(`${layerConfig.satData.filePath}${layerConfig.satData.fileName}`, layerKey).then(\n            (model) => {\n                const satrec = EoUtils.computeSatrec(layerConfig.satData.tleLineOne, layerConfig.satData.tleLineTwo);\n                const position = EoUtils.getOrbitPosition(satrec, new Date(time));\n                layer.setModel(model, options, position)\n                layer.setTle([layerConfig.satData.tleLineOne, layerConfig.satData.tleLineTwo]);\n            }\n        );\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\n//call on add product renderable\nexport const getLayers = createCachedSelector([\n    (layersConfig) => layersConfig,\n    (layersConfig, time) => time,\n    (layersConfig, time, wwd) => wwd,\n    (layersConfig, time, wwd, onLayerChanged) => onLayerChanged,\n    (layersConfig, time, wwd, onLayerChanged, currentTime) => currentTime,\n], (layersConfig, time, wwd, onLayerChanged, currentTime) => {\n    defaultStarfieldLayer.time = time;\n    defaultAtmosphereLayer.time = time;\n    const layers = [\n        defaultStarfieldLayer,\n        defaultBackgroundLayer,\n        multiRangeAtmosphereLayer,\n        multiRangeTopologyLayer\n    ];\n\n    const sentinelDataLayersConfigs = filterSentinelDataLayersConfigs(layersConfig);\n    const sentinelLayers = sentinelDataLayersConfigs.map(getSentinelLayer);\n    \n    const orbitLayersConfigs = filterOrbitLayersConfigs(layersConfig);\n    const orbitLayers = orbitLayersConfigs.map((o) => getOrbitLayer(o, time, wwd, currentTime));\n\n    const satellitesLayersConfigs = filterSatelliteLayersConfigs(layersConfig);\n    const satelliteLayers = satellitesLayersConfigs.map((s) => getSatelliteLayer(s, time, wwd, onLayerChanged));\n    \n    const acquisitionPlanLayersConfigs = filterAcquisitionPlanLayersConfigs(layersConfig);\n    const acquisitionPlanLayers = acquisitionPlanLayersConfigs.map((s) => getAcquisitionPlanLayer(s, wwd, time, onLayerChanged));\n    \n    const staticticsLayersConfigs = filterStatisticsLayersConfigs(layersConfig);\n    const statisticsLayers = staticticsLayersConfigs.map((s) => getStatisticsLayer(s, wwd, time, onLayerChanged));\n    \n    const swathLayersConfigs = filterSwathLayersConfigs(layersConfig);\n    const swathLayers = swathLayersConfigs.map((s) => getSwathLayer(s, wwd, time));\n    \n    const searchLayerConfigs = filterSearchLayersConfigs(layersConfig);\n    const searchLayer = searchLayerConfigs.map((searchResult) => getFootprintLayer(searchResult));\n\n    return [...layers, ...searchLayer, ...sentinelLayers, ...orbitLayers, ...satelliteLayers, ...acquisitionPlanLayers, ...statisticsLayers, ...swathLayers];\n})((layersConfig, time, wwd, onLayerChanged, currentTime) => {\n    const stringTime = time ? time.toString() : '';\n    const stringCurrentTime = currentTime ? currentTime.toString() : '';\n    const sentinelDataLayersConfigs = filterSentinelDataLayersConfigs(layersConfig);\n    const orbitLayersConfigs = filterOrbitLayersConfigs(layersConfig);\n    const satellitesLayersConfigs = filterSatelliteLayersConfigs(layersConfig);\n\n    const acquisitionPlanLayers = filterAcquisitionPlanLayersConfigs(layersConfig);\n\n    const swathLayersConfigs = filterSwathLayersConfigs(layersConfig);\n    \n    const staticticsLayersConfigs = filterStatisticsLayersConfigs(layersConfig);\n\n    const orbitKeys = orbitLayersConfigs.map(l => l.key).join(',');\n    \n    const satellitesKeys = satellitesLayersConfigs.map(l => l.key).join(',');\n    \n    const activeLayersKeys = sentinelDataLayersConfigs.map((layerConfig) => `${getLayerKeyFromConfig(layerConfig)}-${layerConfig.beginTime.toString()}-${layerConfig.endTime.toString()}`).join(',');\n\n    const acquisitionPlanLayersKeys = acquisitionPlanLayers.map((aps) => `${aps.key}_${getPlansKeys(aps.plans)}`);\n    \n    const swathLayersKeys = swathLayersConfigs.map((swathCfg) => `${getSwathKey(swathCfg)}`).join(',');\n\n    const statisticsLayersKeys = staticticsLayersConfigs.map(l => l.key).join(',');\n    \n    const searchLayerConfigs = filterSearchLayersConfigs(layersConfig);\n    const searchLayerKey = searchLayerConfigs.map((layerConfig) => getLayerKeySCIHubResult(layerConfig.results[0]));\n\n    const cacheKey = `${searchLayerKey}-${stringTime}-${stringCurrentTime}-${satellitesKeys}-${orbitKeys}-${activeLayersKeys}-${acquisitionPlanLayersKeys}-${swathLayersKeys}-${statisticsLayersKeys}`;\n    return cacheKey;\n});\n\nconst getSciProducts = async (layerConfig) => {\n    try {\n        let beginTime = layerConfig.beginTime;\n        let endTime = layerConfig.endTime;\n\n        const productsLocal = productsScihub.products({\n            shortName: layerConfig.satData.shortName,\n            products: [layerConfig.layerKey],\n            beginTime: beginTime,\n            endTime: endTime\n        });\n        return await productsLocal;\n    } catch {\n        console.error('Can not get products.')\n    }\n}\n\nexport const getSciProductByKey = async (productKey) => {\n    try {\n        const product = productsScihub.loadProduct(productKey);\n        return await product;\n    } catch {\n        console.error('Can not get products.')\n    }\n}\n\nexport const loadLatestProducts = async (shortName, products, location, beginTime, endTime, startIndex) => {\n    const feed = await productsScihub.load({shortName, products, location, beginTime, endTime, startIndex});\n    if(feed.entry && feed.entry.length > 0) {\n        return feed.entry\n    } else {\n        return null\n    }\n};\n\nexport const setRenderablesFromConfig = async (layer, layerConfig, redrawCallback, onLayerChanged, cancelled, onRenderableAdd) => {\n    let rejected = false;\n    cancelled.catch(() => {\n        rejected = true;\n    })\n    //return promise\n    const msg = {\n        status: 'ok',\n        loadedCount: null,\n        totalCount: null,\n    }\n    const requests = [];\n    const status = 'loading';\n    let loadedCount = 0;\n    let errors = [];\n    let totalCount = 0;\n    redrawCallback();\n    // const changedLayer = {\n    //     satKey: layerConfig.satKey,\n    //     layerKey: layerConfig.layerKey\n    // }\n    // onLayerChanged(changedLayer, {status, loadedCount, totalCount})\n\n    const products = productsScihub.processProducts({entry: layerConfig.results})\n\n    // const products = await getSciProducts(layerConfig);\n    totalCount = products.length;\n    if(rejected) {\n        return\n    }\n\n    const productsIDs = products.map(p => p.id());\n\n    const renderablesToRemove = [];\n    const renderedRenderables = [];\n    layer.renderables.forEach((r => {\n        const id = r && r.userProperties && r.userProperties.key;\n        renderedRenderables.push(id);\n        if(!productsIDs.includes(id)) {\n            renderablesToRemove.push(r) ;\n        }\n    }))\n\n    //remove renderables\n    renderablesToRemove.forEach(r => layer.removeRenderable(r));\n\n    //identify new renderables\n    const newRenderables = products.filter((p) => {\n        const productID = p.id();\n        return !renderedRenderables.includes(productID);\n    })\n\n    loadedCount = layer.renderables.length;\n\n    for(let productIndex = 0; productIndex < newRenderables.length; productIndex++) {\n        const key = newRenderables[productIndex].id();\n        const request = newRenderables[productIndex].renderable().then((result) => {\n            \n            \n            if(rejected) {\n                return\n            }\n            const boundaries = getBoundaries(result);\n\n            let uncompleateBoundaries = false;\n            if(boundaries && boundaries.length > 0 && boundaries[0].length < 4) {\n                uncompleateBoundaries = true;\n            }\n            const error = result.error instanceof Error;\n\n            if(!error && !uncompleateBoundaries) {\n                loadedCount++;\n                result['userProperties'] = {\n                    key\n                }\n                layer.addRenderable(result);\n                onRenderableAdd(result);\n                redrawCallback();\n                // onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n            } else {\n                //Add also not loaded footprints\n                loadedCount++;\n                const polygon = productBounds(boundaries);\n                polygon['userProperties'] = {\n                    key\n                }\n\n\n                layer.addRenderable(polygon);\n\n                errors.push(error);\n                redrawCallback();\n                // onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n\n            }\n        }, (err) => {\n            // debugger\n        });\n        requests.push(request);\n    }\n\n    await Promise.all(requests.map(p => p.catch(e => e)));\n    // onLayerChanged(changedLayer, {status: 'ok', loadedCount, totalCount});\n\n    return msg;\n}\n\nexport const setRenderables = async (layer, layerConfig, redrawCallback, onLayerChanged, cancelled, onRenderableAdd) => {\n    let rejected = false;\n    cancelled.catch(() => {\n        rejected = true;\n    })\n    //return promise\n    const msg = {\n        status: 'ok',\n        loadedCount: null,\n        totalCount: null,\n    }\n    const requests = [];\n    const status = 'loading';\n    let loadedCount = 0;\n    let errors = [];\n    let totalCount = 0;\n    redrawCallback();\n    const changedLayer = {\n        satKey: layerConfig.satKey,\n        layerKey: layerConfig.layerKey\n    }\n\n    // Performance hack how identify if getSciProducts really load data\n    // prevent unneceresy mutating state\n    let startLoading = true;\n    window.setTimeout(() => {\n        if(startLoading) {\n            onLayerChanged(changedLayer, {status, loadedCount, totalCount})\n        }\n    }, 50)\n\n    const products = await getSciProducts(layerConfig);\n    startLoading = false;\n    totalCount = products.length;\n    if(rejected) {\n        return\n    }\n\n    const productsIDs = products.map(p => p.id());\n\n    const renderablesToRemove = [];\n    const renderedRenderables = [];\n    layer.renderables.forEach((r => {\n        const id = r && r.userProperties && r.userProperties.key;\n        renderedRenderables.push(id);\n        if(!productsIDs.includes(id)) {\n            renderablesToRemove.push(r) ;\n        }\n    }))\n\n    //remove renderables\n    renderablesToRemove.forEach(r => layer.removeRenderable(r));\n\n    //identify new renderables\n    const newRenderables = products.filter((p) => {\n        const productID = p.id();\n        return !renderedRenderables.includes(productID);\n    })\n\n    loadedCount = layer.renderables.length;\n\n    for(let productIndex = 0; productIndex < newRenderables.length; productIndex++) {\n        const key = newRenderables[productIndex].id();\n        const request = newRenderables[productIndex].renderable().then((result) => {\n            \n            \n            if(rejected) {\n                return\n            }\n            const boundaries = getBoundaries(result);\n\n            let uncompleateBoundaries = false;\n            if(boundaries && boundaries.length > 0 && boundaries[0].length < 4) {\n                uncompleateBoundaries = true;\n            }\n            const error = result.error instanceof Error;\n\n            if(!error && !uncompleateBoundaries) {\n                loadedCount++;\n                result['userProperties'] = {\n                    key\n                }\n\n                layer.addRenderable(result);\n                onRenderableAdd(result);\n                redrawCallback();\n                onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n            } else {\n                //Add also not loaded footprints\n                loadedCount++;\n                const polygon = productBounds(boundaries);\n                polygon['userProperties'] = {\n                    key\n                }\n\n\n                layer.addRenderable(polygon);\n\n                errors.push(error);\n\n                redrawCallback();\n                // onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n\n            }\n        }, (err) => {\n            // debugger\n        });\n        requests.push(request);\n    }\n\n    await Promise.all(requests.map(p => p.catch(e => e)));\n    onLayerChanged(changedLayer, {status: 'ok', loadedCount, totalCount});\n\n    return msg;\n}\n\nexport const setFootprintRenderables = async (layer, layerConfig, redrawCallback, onLayerChanged, cancelled) => {\n    let rejected = false;\n    cancelled.catch(() => {\n        rejected = true;\n    })\n    //return promise\n    const msg = {\n        status: 'ok',\n        loadedCount: null,\n        totalCount: null,\n    }\n    const requests = [];\n    const status = 'loading';\n    let loadedCount = 0;\n    let errors = [];\n    let totalCount = 0;\n    redrawCallback();\n    const changedLayer = {\n        satKey: layerConfig.satKey,\n        layerKey: layerConfig.layerKey\n    }\n    onLayerChanged(changedLayer, {status, loadedCount, totalCount})\n\n    const products = await getSciProducts(layerConfig);\n    totalCount = products.length;\n    if(rejected) {\n        return\n    }\n\n    const productsIDs = products.map(p => p.id());\n\n    const renderablesToRemove = [];\n    const renderedRenderables = [];\n    layer.renderables.forEach((r => {\n        const id = r && r.userProperties && r.userProperties.key;\n        renderedRenderables.push(id);\n        if(!productsIDs.includes(id)) {\n            renderablesToRemove.push(r) ;\n        }\n    }))\n\n    //remove renderables\n    renderablesToRemove.forEach(r => layer.removeRenderable(r));\n\n    //identify new renderables\n    const newRenderables = products.filter((p) => {\n        const productID = p.id();\n        return !renderedRenderables.includes(productID);\n    })\n\n    loadedCount = layer.renderables.length;\n\n    for(let productIndex = 0; productIndex < newRenderables.length; productIndex++) {\n        const key = newRenderables[productIndex].id();\n        const request = newRenderables[productIndex].renderable().then((result) => {\n            \n            \n            if(rejected) {\n                return\n            }\n            const boundaries = getBoundaries(result);\n\n            let uncompleateBoundaries = false;\n            if(boundaries && boundaries.length > 0 && boundaries[0].length < 4) {\n                uncompleateBoundaries = true;\n            }\n            const error = result.error instanceof Error;\n\n            if(!error && !uncompleateBoundaries) {\n                loadedCount++;\n                result['userProperties'] = {\n                    key\n                }\n\n                layer.addRenderable(result);\n                redrawCallback();\n                onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n            } else {\n                //Add also not loaded footprints\n                loadedCount++;\n                const polygon = productBounds(boundaries);\n                polygon['userProperties'] = {\n                    key\n                }\n\n\n                layer.addRenderable(polygon);\n\n                errors.push(error);\n\n                redrawCallback();\n                // onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n\n            }\n        }, (err) => {\n            // debugger\n        });\n        requests.push(request);\n    }\n\n    await Promise.all(requests.map(p => p.catch(e => e)));\n    onLayerChanged(changedLayer, {status: 'ok', loadedCount, totalCount});\n\n    return msg;\n}\n\nexport const reloadLayer = async (layerCfg, wwdLayer, wwd, onLayerChanged, onRenderableAdd) => {\n\n    const layerKey = getLayerKeyFromConfig(layerCfg);\n    let rejected = false;\n    const activeRequestReject = productsRequests.get(layerKey);\n    if(activeRequestReject) {\n        //reject pending request\n        activeRequestReject();\n        rejected = true;\n        productsRequests.delete(layerKey);\n    }\n\n    const cancelled = new Promise((resolve, reject) => {\n        productsRequests.set(layerKey, reject);\n    });\n\n    const dispatchChange = (layerKey, change) => {\n        if(!rejected) {\n            onLayerChanged(layerKey, change);\n        }\n    }\n\n    try {\n        await setRenderables(wwdLayer, layerCfg, wwd.redraw.bind(wwd), dispatchChange, cancelled, onRenderableAdd);\n        productsRequests.delete(layerKey);\n    } catch (err) {\n        if (err.message === \"Cancelled\") {\n            console.log(\"Connection was closed\");\n        } else {\n            console.log(\"Unexpected error:\", err.stack);\n        }\n    }\n}\n\nexport const reloadFootprint = async (layerCfg, wwdLayer, wwd, onLayerChanged, onRenderableAdd) => {\n\n    const layerKey = getLayerKeySCIHubResult(layerCfg.results[0]);\n    let rejected = false;\n    const activeRequestReject = productsRequests.get(layerKey);\n    if(activeRequestReject) {\n        //reject pending request\n        activeRequestReject();\n        rejected = true;\n        productsRequests.delete(layerKey);\n    }\n\n    const cancelled = new Promise((resolve, reject) => {\n        productsRequests.set(layerKey, reject);\n    });\n\n    const dispatchChange = (layerKey, change) => {\n        if(!rejected) {\n            onLayerChanged(layerKey, change);\n        }\n    }\n\n    try {\n        await setRenderablesFromConfig(wwdLayer, layerCfg, wwd.redraw.bind(wwd), dispatchChange, cancelled, onRenderableAdd);\n        productsRequests.delete(layerKey);\n    } catch (err) {\n        if (err.message === \"Cancelled\") {\n            console.log(\"Connection was closed\");\n        } else {\n            console.log(\"Unexpected error:\", err.stack);\n        }\n    }\n}\n\nexport const reloadLayersRenderable = (layers, wwdLayers, wwd, onLayerChanged, onRenderableAdd) => {\n    layers.forEach((layerCfg) => {\n        //reload only sentinel data\n        if(layerCfg.type === 'sentinelData') {\n            const layerKey = getLayerKeyFromConfig(layerCfg);\n            const wwdLayer = getLayerByName(layerKey, wwdLayers);   \n            //split animation frame\n            window.setTimeout(() => reloadLayer(layerCfg, wwdLayer, wwd, onLayerChanged, onRenderableAdd), 0);\n            // reloadLayer(layerCfg, wwdLayer, wwd, onLayerChanged);\n        }\n\n        if(layerCfg.type === 'sentinelFootprint') {\n            const layerKey = getLayerKeySCIHubResult(layerCfg.results[0]);\n            const wwdLayer = getLayerByName(layerKey, wwdLayers);   \n            reloadFootprint(layerCfg, wwdLayer, wwd, onLayerChanged, onRenderableAdd);\n        }\n    });\n}\n\nexport default {\n    getLayers,\n    getLayerKeyFromConfig,\n    getLayerKeySCIHubResult,\n    getLayerByName,\n    reloadLayersRenderable,\n}","import React, { useState, useEffect } from 'react';\nimport Presentation from './presentation';\nimport {getSciProductByKey} from '../../components/WorldWindMap/layers';\n\nconst ProductInformation = (props) => {\n    const {product, heading} = props;\n    const [productOnline, setProductOnline] = useState(null);\n    useEffect(() => {\n        const fetchData = async () => {\n            const productMetadata = await getSciProductByKey(product.id);\n            setProductOnline(productMetadata);\n        }\n        fetchData();\n    }, [])\n\n    return (\n        product ? <Presentation product={product} online={productOnline && productOnline.Online} heading={heading}/> : null\n    )\n}\n\nexport default ProductInformation;","import * as React from 'react';\nimport {Context} from './context';\nexport function withContext(Component) {\n  return (props) => {\n    return (\n      <Context.Consumer>\n        {(contexts) => <Component {...props} {...contexts} />\n        }\n      </Context.Consumer>\n    )\n  }\n}","import React from 'react';\nimport PropTypes from \"prop-types\";\nimport Modal from '../Modal';\nimport ProductInformation from '../productInformation';\nimport {withContext} from '../../context/withContext';\n\nconst ProductsModal = (props) => {\n    const {visible, onClose, showProducts, products, modalKey} = props;\n\n    const productInformations = products.map((product) => {\n        return (<ProductInformation key={product.id} product={product} />)\n    })\n    const content = <div className={'ptr-modal-scroolable-content-wrapper'}>{productInformations}</div>;\n\n    const header = (<div><h1 className={'modal-header'}>Sentinel products [{products.length}]</h1></div>);\n\n    return (\n        visible ? <Modal \n                modalKey = {modalKey}\n                isOpen = {visible}\n                content = {content}\n                header = {header}\n                onClose = {onClose}\n                displayOverlay = {true}\n                /> : null\n    )\n}\n\nProductsModal.propTypes = {\n    visible:PropTypes.bool,\n    onClose:PropTypes.func,\n    showProducts:PropTypes.array,\n    products:PropTypes.array,\n    modalKey:PropTypes.string,\n  }\n\n  ProductsModal.defaultProps = {\n    visible:false,\n    onClose:() => {},\n    showProducts: [],\n    products: [],\n    modalKey: '',\n  }\n\nexport default withContext(ProductsModal);","import React from 'react';\nimport Presentation from './presentation';\nimport {withContext} from '../../context/withContext';\nimport {getProductByKey} from '../../components/WorldWindMap/layers';\n// import Icon from '../Icon';\nimport {\n    updateInfoModal,\n    setActiveInfoModal,\n} from '../../context/actions';\nimport select from '../../context/selectors/';\n\n\n// ReactModal.setAppElement('#root');\n\nconst ProductsModal = (props) => {\n    // const {modalKey, isOpen, content, onClose, header} = props;\n    const {dispatch, state} = props;\n    \n    //info modal state\n    const activeInfoModalKey = select.rootSelectors.getActiveInfoModalKey(state);\n    const activeInfoModal = select.rootSelectors.getInfoModal(state, activeInfoModalKey);\n    const visible = !!activeInfoModalKey && activeInfoModal.type === 'PRODUCTS';\n    let products = visible ? activeInfoModal.products.map((key) => getProductByKey(key).metadata()) : null;\n    const onInfoModalClose = () => {\n        dispatch(updateInfoModal(activeInfoModalKey, {open: false}));\n        dispatch(setActiveInfoModal(null));\n    }\n\n    return (\n        visible ? <Presentation \n            visible={visible}\n            onClose={onInfoModalClose}\n            showProducts={activeInfoModal.products}\n            products={products}\n            modalKey={activeInfoModalKey}\n            /> : null\n    )\n}\n\nexport default withContext(ProductsModal);","import React from 'react';\n\nconst copy = (text, e) => {\n\tnavigator.clipboard.writeText(text);\n\te.stopPropagation();\n};\n\nexport default props => {\n\tif (!props.value || typeof props.value !== \"string\") return null;\n\n\tlet shortKey = props.value.substring(0, 4);\n\treturn (\n\t\t<span\n\t\t\tclassName=\"option-id\"\n\t\t\ttitle={props.value}\n\t\t\tonClick={copy.bind(null, props.value)}\n\t\t>\n\t\t\t{shortKey}\n\t  </span>\n\t);\n}","import React from 'react';\n// import i18n from 'i18next';\n\nimport _ from 'lodash';\n\n// import period, {toString as periodToString} from './period';\n// import {replaceIdWithKey, removeDuplicities} from './models';\n\n\nexport default {\n\n\t// period: period,\n\t// periodToString: periodToString,\n\n\t// addI18nResources: function(namespace, resources){\n\t// \t_.forIn(resources, (resource, language) => {\n\t// \t\ti18n.addResourceBundle(language, namespace, resource, true, true);\n\t// \t});\n\t// },\n\n\tdeepClone: function (data) {\n\t\tvar clone = data;\n\t\tif (_.isObject(data) && !React.Component.isPrototypeOf(data)) {\n\n\t\t\tclone = _.clone(data);\n\n\t\t\t_.each(clone, function (value, key) {\n\t\t\t\tclone[key] = this.deepClone(value);\n\t\t\t}, this);\n\n\t\t}\n\n\t\treturn clone;\n\t},\n\n\tdeepCloneKeepModels: function (data) {\n\t\tvar clone = data;\n\t\tif (\n\t\t\t_.isObject(data) && !React.Component.isPrototypeOf(data)\n\t\t//&& !(data instanceof GeneralModel)\n\t\t) {\n\n\t\t\tclone = _.clone(data);\n\n\t\t\t_.each(clone, function (value, key) {\n\t\t\t\tclone[key] = this.deepCloneKeepModels(value);\n\t\t\t}, this);\n\n\t\t}\n\n\t\treturn clone;\n\t},\n\n\tclone: function (data) {\n\t\tvar clone = data;\n\t\tif (\n\t\t\t_.isObject(data) && !React.Component.isPrototypeOf(data)\n\t\t) {\n\n\t\t\tclone = _.clone(data);\n\n\t\t\t_.each(clone, function (value, key) {\n\t\t\t\tclone[key] = this.deepCloneKeepModels(value);\n\t\t\t}, this);\n\n\t\t}\n\n\t\treturn clone;\n\t},\n\n\t/**\n\t * Generates v4 compliant UUID\n\t * @returns {string|*|void}\n\t */\n\tuuid() {\n\t\treturn ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\n\t\t\t(c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n\t\t)\n\t},\n\n\t/**\n\t * DEPRECATED!\n\t * Generates pseudo-uuid string\n\t * @returns {string}\n\t */\n\tguid() {\n\t\tfunction s4() {\n\t\t\treturn Math.floor((1 + Math.random()) * 0x10000)\n\t\t\t\t.toString(16)\n\t\t\t\t.substring(1);\n\t\t}\n\n\t\treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n\t\t\ts4() + '-' + s4() + s4() + s4();\n\t},\n\n\t/**\n\t * Generates random string of specified length.\n\t * @param length\n\t * @returns {string}\n\t */\n\trandomString: length => ((Math.random() * Math.pow(36, length) >> 0).toString(36)),\n\n\tgetRemSize: () => parseFloat(getComputedStyle(document.documentElement).fontSize),\n\n\t/**\n\t * Promise.all() for objects (instead of arrays)\n\t * @param object of promises\n\t * @returns promise of object of resolved values\n\t */\n\tpromiseAll(object) {\n\n\t\tlet promisedProperties = [];\n\t\tconst objectKeys = Object.keys(object);\n\n\t\tobjectKeys.forEach((key) => promisedProperties.push(object[key]));\n\n\t\treturn Promise.all(promisedProperties)\n\t\t\t.then((resolvedValues) => {\n\t\t\t\treturn resolvedValues.reduce((resolvedObject, property, index) => {\n\t\t\t\t\tresolvedObject[objectKeys[index]] = property;\n\t\t\t\t\treturn resolvedObject;\n\t\t\t\t}, object);\n\t\t\t});\n\n\t},\n\n\tcollectionsAreEqual (collection1, collection2, sortBy) {\n\t\t// Sort conditions so the arrays match up.\n\t\tsortBy = sortBy || 'id';\n\t\tcollection1 = _.sortBy(collection1, sortBy);\n\t\tcollection2 = _.sortBy(collection2, sortBy);\n\t\treturn JSON.stringify(collection1) === JSON.stringify(collection2);\n\t},\n\n\tscrollTo(elementId, containerId, duration){\n\t\tlet animationDuration = duration ? duration : 200;\n\t\tlet container = document.getElementById(containerId);\n\t\tlet element = document.getElementById(elementId);\n\n\t\tlet elementOffset = element.offsetTop;\n\t\tlet elementHeight = element.offsetHeight;\n\t\tlet containerHeight = container.offsetHeight;\n\t\tlet scroll = elementOffset + elementHeight - containerHeight + 10;\n\n\t\tdocument.getElementById(containerId).scrollTop = elementOffset;\n\t},\n\n\trenderParagraphWithSeparatedLines(text) {\n\t\tif (text && typeof text === \"string\"){\n\t\t\tlet splittedText = text.split(\"\\n\");\n\t\t\treturn (\n\t\t\t\t<p>\n\t\t\t\t\t{splittedText.map((rec, index) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<span key={index}>\n\t\t\t\t\t\t\t{rec}{index === (splittedText.length - 1) ? null : <br/>}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)})\n\t\t\t\t\t}\n\t\t\t\t</p>\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\n\t/**\n\t * Get json-like formatted string\n\t * @param json {JSON | string | null}\n\t * @return {string}\n\t */\n\tgetStringFromJson (json) {\n\t\tif (json && typeof json === \"object\") {\n\t\t\treturn JSON.stringify(json, null, 2)  ;\n\t\t} else {\n\t\t\treturn json;\n\t\t}\n\t},\n\n\t/**\n\t * Takes deep object and returns it with values containing path to that key in the object (where value isn't a nested object).\n\t * e.g. {a: null, b: {c: null, d: null}} => {a: 'a', b: {c: 'b.c', d: 'b.d'}}\n\t * Used for constants.\n\t * @param object - input object or nested object when called recursively\n\t * @param path - path to nested object when called recursively\n\t * @returns object\n\t */\n\tdeepKeyMirror(object, path) {\n\t\tif (_.isObjectLike(object)) {\n\t\t\treturn _.mapValues(object, (value, key) => {\n\t\t\t\treturn this.deepKeyMirror(value, path ? path + '.' + key : key);\n\t\t\t});\n\t\t} else {\n\t\t\treturn path;\n\t\t}\n\t},\n\n\n\tstringToNumHash(string) {\n\t\tstring = '' + string;\n\t\tif (typeof string !== 'string') throw new Error('stringToNumHash: argument must be a string');\n\t\tlet hash = 1;\n\t\tfor (let i = 0; i < string.length; i++) {\n\t\t\thash = Math.imul(hash + string.charCodeAt(i) | 0, 265443576107);\n\t\t}\n\t\treturn (hash ^ hash >>> 17) >>> 0;\n\t},\n\n\t/**\n\t * Deterministic colour set based on input string.\n\t * @param string - input string\n\t * @param count - number of colours\n\t * @param options - hue, saturation and lightness ranges\n\t * @returns {Array} css hsl codes\n\t */\n\tstringToColours(string, count, options) {\n\t\tlet hash = this.stringToNumHash(string);\n\t\tlet colours = [];\n\t\tlet defaults = {\n\t\t\thue: [0,360],\n\t\t\tsaturation: [35,65],\n\t\t\tlightness: [40,60]\n\t\t};\n\t\toptions = {...defaults, ...options};\n\t\tlet h, s, l;\n\t\tlet hueRange = options.hue[1] - options.hue[0];\n\t\tlet saturationRange = options.saturation[1] - options.saturation[0];\n\t\tlet lightnessRange = options.lightness[1] - options.lightness[0];\n\t\tfor (let i = 0; i < (count || 1); i++) {\n\t\t\th = hash % hueRange + options.hue[0];\n\t\t\thash = (hash ^ hash >>> 17) >>> 0;\n\t\t\ts = hash % saturationRange + options.saturation[0];\n\t\t\thash = (hash ^ hash >>> 17) >>> 0;\n\t\t\tl = hash % lightnessRange + options.lightness[0];\n\t\t\thash = (hash ^ hash >>> 17) >>> 0;\n\t\t\tcolours.push('hsl(' + h + ',' + s + '%,' + l + '%)');\n\t\t}\n\t\treturn colours;\n\t}\n}\n\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport SelectBase from 'react-select';\n// import CreatableSelect from 'react-select';\nimport classnames from 'classnames';\nimport _ from 'lodash';\n\nimport './select.scss';\nimport Key from \"./Key\";\nimport utils from \"../../../utils/utils\";\n\nclass Select extends React.PureComponent {\n\n    static propTypes = {\n        className: PropTypes.string, // className for the outer element\n        clearable: PropTypes.bool,\n        components: PropTypes.object,\n        disabled: PropTypes.bool,\n        formatOptionLabel: PropTypes.func, // custom option rendering\n        multi: PropTypes.bool,\n        onChange: PropTypes.func, // onChange handler: function (newValue) {}\n        options: PropTypes.array,\n        optionLabel: PropTypes.string, // path to label\n        optionValue: PropTypes.string, // path to value\n        type: PropTypes.string,\n        placeholder: PropTypes.string,\n        unfocusable: PropTypes.bool,\n        value: PropTypes.oneOfType([\n            PropTypes.object,\n            PropTypes.array,\n            PropTypes.string\n        ]),\n        valueIsTitle: PropTypes.bool,\n        withKeyPrefix: PropTypes.bool,\n\n        // creatable\n        onCreate: PropTypes.func,\n\n        // id of the element where menu will be rendered\n        menuPortalTarget: PropTypes.string\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.getLabel = this.getLabel.bind(this);\n        this.onChange = this.onChange.bind(this);\n        this.onCreate = this.onCreate.bind(this);\n    }\n\n    getFormattedOptions() {\n        return this.props.options.map(option => {\n        \tlet label = option;\n        \tlet value = option;\n\n        \tif (this.props.optionValue) {\n        \t\tvalue = _.get(option, this.props.optionValue);\n\t\t\t}\n\n        \tif (this.props.optionLabel) {\n        \t\tlabel = _.get(option, this.props.optionLabel)\n\t\t\t}\n\n            return {value, label, isDisabled: option.isDisabled};\n        });\n    }\n\n    onChange(selectedObject) {\n        // multiselect\n        if (_.isArray(selectedObject)){\n            if (_.isEmpty(selectedObject)) {\n                this.props.onChange(null);\n            } else if (this.props.optionValue) {\n                let selected = [];\n                _.forEach(selectedObject, (item) => {\n                    let originalObject = _.find(this.props.options, (option) => {return ((item && item.value) === (_.get(option, this.props.optionValue)))});\n                    if (originalObject) {\n                        selected.push(originalObject);\n                    }\n                });\n                this.props.onChange(selected);\n            } else {\n                let values = selectedObject.map(object => object.value);\n                this.props.onChange(values);\n            }\n        }\n\n        else {\n            if (this.props.optionValue) {\n                let selected =  _.find(this.props.options, (option) => {\n                    return (_.get(option, this.props.optionValue) === (selectedObject && selectedObject.value))\n                });\n                if (selected) {\n                    this.props.onChange(selected);\n                } else {\n                    this.props.onChange(null);\n                }\n            } else {\n                this.props.onChange(selectedObject ? selectedObject.value : null);\n            }\n        }\n    }\n\n    onCreate(label) {\n        let key = utils.uuid();\n        if (this.props.optionValue && this.props.optionLabel) {\n            let data = {};\n            _.set(data, this.props.optionValue, key);\n            _.set(data, this.props.optionLabel, label);\n            this.props.onCreate(data);\n        } else {\n            this.props.onCreate(label);\n        }\n    }\n    \n    render() {\n        let props = {...this.props};\n\n        // prepare options\n        if (!props.options) {\n            props.options = [];\n        } else {\n            props.options = this.getFormattedOptions();\n        }\n\n        // prepare selected value\n        if (props.value && typeof props.value === 'string') {\n            props.value = _.find(props.options, {value: props.value});\n        } else if (props.value && props.optionValue && !_.isArray(props.value)) {\n        \tprops.value = _.find(props.options, {value: _.get(props.value, props.optionValue)})\n\t\t} else if (_.isArray(props.value)) {\n            props.value = _.filter(props.options, (option) => {\n                return !!_.find(props.value, value => {\n                    if (typeof value === 'string') {\n                        return value === option.value;\n                    } else {\n                        return _.get(value, props.optionValue) === option.value;\n                    }\n                });\n            });\n        }\n\n        const classes = classnames(`ptr-select-container ${this.props.className ? this.props.className : \"\"}`, {\n            'value-is-title': !!this.props.valueIsTitle,\n            'disabled': this.props.disabled,\n            'clearable': this.props.clearable,\n            'multi': this.props.multi\n        });\n\n        switch (this.props.type) {\n            case 'creatable':\n                return this.renderCreatable(props, classes);\n            default:\n                return this.renderBase(props, classes);\n        }\n    }\n\n    renderBase(props, classes) {\n        return (\n            <SelectBase\n                placeholder={this.props.placeholder}\n                className={classes}\n                classNamePrefix={'ptr-select'}\n                clearable={this.props.clearable}\n                components={props.components}\n                formatOptionLabel={this.getLabel}\n                hideSelectedOptions={props.hideSelectedOptions}\n                isClearable={this.props.clearable}\n                isDisabled={this.props.disabled}\n                isOptionDisabled={(option) => option.isDisabled}\n                isMulti={this.props.multi}\n                onChange={this.onChange}\n                options={props.options}\n                tabIndex={props.unfocusable ? -1 : 0}\n                value={props.value}\n                title={props.value}\n                styles={{ menuPortal: base => {\n                        const { zIndex, ...rest } = base;  // remove zIndex from base by destructuring\n                        return { ...rest, zIndex: 9999 };\n                    }}}\n                menuPortalTarget={document.getElementById(this.props.menuPortalTarget || \"ptr-app\")}\n            />\n        );\n    }\n\n    renderCreatable(props, classes) {\n        return (\n            <SelectBase\n                className={classes}\n                classNamePrefix={'ptr-select'}\n                components={props.components}\n                formatOptionLabel={this.getLabel}\n                hideSelectedOptions={props.hideSelectedOptions}\n                isClearable={this.props.clearable}\n                isDisabled={this.props.disabled}\n                isOptionDisabled={(option) => option.isDisabled}\n                isMulti={this.props.multi}\n                onChange={this.onChange}\n                onCreateOption={this.onCreate}\n                options={props.options}\n                tabIndex={props.unfocusable ? -1 : 0}\n                value={props.value}\n                title={props.value}\n                styles={{ menuPortal: base => {\n                        const { zIndex, ...rest } = base;  // remove zIndex from base by destructuring\n                        return { ...rest, zIndex: 9999 };\n                    }}}\n                menuPortalTarget={document.getElementById(this.props.menuPortalTarget || \"ptr-app\")}\n            />\n        )\n    }\n\n    getLabel(option) {\n        if (this.props.formatOptionLabel) {\n            if (this.props.optionValue) {\n                let selected =  _.find(this.props.options, (opt) => {\n                    return (_.get(opt, this.props.optionValue) === option.value)\n                });\n                if (selected) {\n                    return this.props.formatOptionLabel(selected);\n                } else {\n                    throw new Error('Select#Selected option was not found in original options.');\n                }\n            } else {\n                return this.props.formatOptionLabel(option.label);\n            }\n        } else {\n            let labelPrefix = null;\n            let labelText = option.label;\n\n            if (this.props.withKeyPrefix) {\n                labelPrefix = (<Key value={option.value}/>)\n            }\n\n            return (\n                <div className=\"label\" key='label'>\n                    {labelPrefix}\n                    {labelText}\n                </div>\n            );\n        }\n    }\n}\n\nexport default Select;","import React, { useState } from 'react';\nimport Button from '../../../atoms/Button';\nimport Icon from '../../../atoms/Icon';\nimport Select from '../../../atoms/Select/Select';\nimport moment from 'moment';\n\nimport './style.scss';\n\nconst SearchForm = ({coordinates, satellites, search, previousResultIndex, nextResultIndex, changeActiveResultIndex, result, time}) => {\n    const [selectedSatellite, setSelectedSatellite] = useState(null);\n    const [selectedProduct, setSelectedProduct] = useState(null);\n\n    const satellitesOptions = [...satellites].map((sat) => ({\n        value: sat.id,\n        label: sat.name,\n    }));\n\n    const productsOptions = selectedSatellite ? satellites.find(s => s.id === selectedSatellite.value).layers.map(l => ({\n        value: l,\n        label: l,\n    })) : [];\n\n    const onSearchClick = () => {\n        search(selectedSatellite.value, selectedProduct.value, coordinates, new Date(time), 0);\n    };\n\n    const displayMoveButtons = Number.isInteger(previousResultIndex) ||  Number.isInteger(nextResultIndex);\n\n    return (\n        <div className={'ptr-search-form'}>\n            <div className={'ptr-search-form-selects'}>\n                <Button ghost className={'ptr-btn-no-wrap'} onClick={() => {}}>\n                    <Icon icon='clock' />{moment(time).format('YYYY-MM-DD')}\n                </Button>\n                <Button ghost className={'ptr-btn-no-wrap'} onClick={() => {}}>\n                    <Icon icon='location' />{`${Math.round(coordinates.longitude * 100) / 100} , ${Math.round(coordinates.latitude * 100) / 100}`}\n                </Button>\n                <Select\n                    options={satellitesOptions}\n                    onChange={(sat) => {setSelectedSatellite(sat); setSelectedProduct(null)}}\n                    value={selectedSatellite}\n                    placeholder={'Satellite'}\n                    optionLabel='label'\n                    optionValue='value'\n                    />\n\n                <Select\n                    options={productsOptions}\n                    onChange={(sat) => setSelectedProduct(sat)}\n                    value={selectedProduct}\n                    disabled={!selectedSatellite}\n                    placeholder={'Product'}\n                    optionLabel='label'\n                    optionValue='value'\n                    />\n            </div>\n\n            <div className={'ptr-search-form-navigation'}>\n                <Button \n                    ghost\n                    onClick={onSearchClick}\n                    disabled={!selectedProduct || !selectedSatellite}\n                    >\n                    Search\n                </Button>\n                {   \n                    displayMoveButtons ?\n                    <Button \n                        ghost\n                        onClick={() => changeActiveResultIndex(previousResultIndex)}\n                        disabled = {!Number.isInteger(previousResultIndex)}\n                        >\n                        Previous\n                    </Button> : null\n                }\n                {   \n                    displayMoveButtons ?\n                    <Button \n                        ghost\n                        onClick={() => changeActiveResultIndex(nextResultIndex)}\n                        disabled = {!Number.isInteger(nextResultIndex)}\n                        >\n                        Next\n                    </Button> : null\n                }\n            </div>\n\n        </div>\n    )\n}\n\nexport default SearchForm;","import SciHubProducts from '../../../../worldwind/products/Products';\nimport {hubPassword, hubUsername, sciHubUrl} from \"../../../../config\";\nimport types from '../../../types';\nimport {setComponent} from '../../../actions';\n\nconst searchCache = new window.Map();\nconst csiRenderablesCache = new window.Map();\nconst productsScihub = new SciHubProducts(csiRenderablesCache, searchCache, fetchWithCredentials, sciHubUrl);\n\nfunction fetchWithCredentials (url, options = {}) {\n    if (!options.headers) {\n        options.headers = {};\n    }\n    options.headers.Authorization = `Basic ${window.btoa(`${hubUsername}:${hubPassword}`)}`;\n\n    const fetch = window.fetch(url, options);\n    return fetch;\n};\n\nexport const loadLatestProducts = async (shortName, products, location, beginTime, endTime, startIndex) => {\n    const feed = await productsScihub.load({shortName, products, location, beginTime, endTime, startIndex});\n    if(feed.entry && feed.entry.length > 0) {\n        return feed.entry\n    } else {\n        return null\n    }\n};\n\nexport const setSearchResults = (results) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: 'search',\n        path: 'results',\n        value: results,\n    };\n};\n\nexport const setSearchTime = (time) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: 'search',\n        path: 'filterTime',\n        value: time,\n    };\n};\n\nexport const setActiveResultIndex = (index) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: 'search',\n        path: 'activeResultIndex',\n        value: index,\n    };\n};\n\nexport const setGeometry = (geometry) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: 'search',\n        path: 'geometry',\n        value: geometry,\n    };\n};\n\nexport const resetSearchComponent = (dispatch) => {\n    dispatch(setSearchResults([]));\n    dispatch(setSearchTime(null));\n    dispatch(setActiveResultIndex(null));\n    dispatch(setGeometry(null));\n};","import React from 'react';\nimport Presentation from './presentation';\nimport select from '../../../../context/selectors/';\nimport {withContext} from '../../../../context/withContext';\nimport {\n    loadLatestProducts,\n    setSearchResults,\n    setActiveResultIndex,\n    setSearchTime,\n} from '../../../../context/actions/components/searchForm/actions';\n\nconst getPreviousIndex = (curIndex, minIndex = 0) => {\n    if(Number.isInteger(curIndex) && curIndex - 1 >= minIndex) {\n        return curIndex - 1;\n    } else {\n        return null;\n    }\n}\n\nconst getNextIndex = (curIndex, maxIndex) => {\n    if(Number.isInteger(curIndex) && curIndex + 1 <= maxIndex) {\n        return curIndex + 1;\n    } else {\n        return null;\n    }\n}\n\nconst SetalliteSelect = (props) => {\n    const {dispatch, state} = props;\n\n    const activeInfoModalKey = select.rootSelectors.getActiveInfoModalKey(state);\n    const activeInfoModal = select.rootSelectors.getInfoModal(state, activeInfoModalKey);\n    const visible = !!activeInfoModalKey && activeInfoModal.type === 'SEARCH';\n    const coordinates = visible ? activeInfoModal.coordinates : null;\n    const satellites = select.data.satellites.getSubstate(state);\n    const results = select.components.search.getResults(state) || [];\n    const activeResultIndex = select.components.search.getActiveResultIndex(state);\n    const filterTime = select.components.search.getFilterTime(state);\n    const result = (Number.isInteger(activeResultIndex) && results[activeResultIndex]) || null;\n    const nextResultIndex = getNextIndex(activeResultIndex, results.length);\n    const previousResultIndex = getPreviousIndex(activeResultIndex);\n    const selectedTime = filterTime || select.rootSelectors.getSelectTime(state);\n    \n    const searchCoords = async(satelliteId, productId, location, time, statrIndex) => {\n        // setLoading(false);\n        try {\n            const shortName = `${satelliteId[0].toUpperCase()}-${satelliteId.substring(1,3).toUpperCase()}`;\n            const endTime = time;\n            const beginTime = new Date(new Date(endTime).setYear(endTime.getUTCFullYear() - 1));\n            dispatch(setSearchTime(time))\n            const results = await loadLatestProducts(shortName, [productId], location, beginTime, endTime, statrIndex);\n            dispatch(setSearchResults(results))\n            if(results && results.length > 0) {\n                dispatch(setActiveResultIndex(0))\n            }\n        } catch (e) {\n            // setError(e.message || 'Unexpected error');\n        }\n        // setLoading(false);\n    };\n\n    const changeActiveResultIndex = (index) => dispatch(setActiveResultIndex(index));\n\n\n    return (\n        <Presentation \n            time={selectedTime}\n            coordinates={coordinates}\n            satellites={satellites}\n            search={searchCoords}\n            activeResultIndex={activeResultIndex}\n            nextResultIndex={nextResultIndex}\n            previousResultIndex={previousResultIndex}\n            changeActiveResultIndex={changeActiveResultIndex}\n            result={result}\n            />\n    )\n}\n\nexport default withContext(SetalliteSelect);","import React from 'react';\nimport {parseEntry} from '../../../../worldwind/products/Products';\nimport ProductInformation from '../../../productInformation';\n\nimport './style.scss';\n\nconst Result = ({result}) => {\n    \n    const parsedResult = parseEntry(result);\n    return (\n        <div>\n            {!result ? <div>Search in SCI Hub.</div> : null}\n            {result ? <ProductInformation key={parsedResult.id} product={parsedResult} /> : null}\n        </div>\n    )\n}\n\nexport default Result;","import React from 'react';\nimport Presentation from './presentation';\nimport select from '../../../../context/selectors/';\nimport {withContext} from '../../../../context/withContext';\n\nconst Result = (props) => {\n    const {dispatch, state} = props;\n    const results = select.components.search.getResults(state);\n    const activeResultIndex = select.components.search.getActiveResultIndex(state);\n    const result = (Number.isInteger(activeResultIndex) && results && results.length > 0 && results[activeResultIndex]) || null;\n\n    return (\n        <Presentation \n            result={result}\n            />\n    )\n}\n\nexport default withContext(Result);","import React from 'react';\nimport PropTypes from \"prop-types\";\nimport Modal from '../Modal';\nimport {withContext} from '../../context/withContext';\nimport SearchForm from './components/searchForm';\nimport Result from './components/result';\nimport './style.scss';\n\nconst ProductsModal = (props) => {\n    const {visible, onClose, coordinates, modalKey, vertical} = props;\n\n    // const content = products.map((product) => {\n    //     return (<ProductInformation key={product.id} product={product} />)\n    // })\n\n    const header = <SearchForm />;\n    const content = (<div className={'ptr-modal-scroolable-content-wrapper'}><Result /></div>);\n    return (\n        visible ? <Modal \n                modalKey = {modalKey}\n                isOpen = {visible}\n                header = {header}\n                content = {content}\n                onClose = {onClose}\n                sided = {{position: vertical ? 'left' : 'bottom'}}\n                vertical = {vertical}\n                /> : null\n    )\n}\n\nProductsModal.propTypes = {\n    coordinates:PropTypes.object,\n    visible:PropTypes.bool,\n    onClose:PropTypes.func,\n    modalKey:PropTypes.string,\n  }\n\n  ProductsModal.defaultProps = {\n    visible:false,\n    onClose:() => {},\n    coordinates: {},\n    modalKey: '',\n  }\n\nexport default withContext(ProductsModal);","import React from 'react';\nimport Presentation from './presentation';\nimport {withContext} from '../../context/withContext';\nimport {getProductByKey} from '../../components/WorldWindMap/layers';\n// import Icon from '../Icon';\nimport {\n    updateInfoModal,\n    setActiveInfoModal,\n    updateComponent,\n} from '../../context/actions';\n\nimport {\n    resetSearchComponent,\n} from '../../context/actions/components/searchForm/actions';\n\nimport select from '../../context/selectors/';\n\n\n// ReactModal.setAppElement('#root');\n\nconst SearchModal = ({dispatch, state}) => {\n    //info modal state\n    const activeInfoModalKey = select.rootSelectors.getActiveInfoModalKey(state);\n    const activeInfoModal = select.rootSelectors.getInfoModal(state, activeInfoModalKey);\n    const visible = !!activeInfoModalKey && activeInfoModal.type === 'SEARCH';\n    const coordinates = visible ? activeInfoModal.coordinates : null;\n    const vertical = select.rootSelectors.getLandscape(state);\n    const onInfoModalClose = () => {\n        dispatch(updateInfoModal(activeInfoModalKey, {open: false}));\n        dispatch(setActiveInfoModal(null));\n        resetSearchComponent(dispatch);\n\n        dispatch(updateComponent('timeline', {visible: true}));\n        dispatch(updateComponent('satelliteSelect', {visible: true}));\n        dispatch(updateComponent('timeWidget', {visible: true}));\n    }\n\n    return (\n        visible ? <Presentation \n            visible={visible}\n            vertical={vertical}\n            onClose={onInfoModalClose}\n            coordinates={coordinates}\n            modalKey={activeInfoModalKey}\n            /> : null\n    )\n}\n\nexport default withContext(SearchModal);","import WorldWind from 'webworldwind-esa';\n\nconst {\n    ArcBallCamera,\n    ArgumentError,\n    BasicWorldWindowController,\n    DrawContext,\n    EarthElevationModel,\n    FrameStatistics,\n    Frustum,\n    Globe,\n    Globe2D,\n    GoToAnimator,\n    GpuResourceCache,\n    Line,\n    Logger,\n    LookAtNavigator,\n    Matrix,\n    Navigator,\n    PickedObjectList,\n    Position,\n    Rectangle,\n    Sector,\n    SurfaceShape,\n    SurfaceShapeTileBuilder,\n    Terrain,\n    Vec2,\n    Vec3,\n    WWMath\n} = WorldWind;\n\n\n/**\n * Constructs a WorldWind window for an HTML canvas.\n * @alias WorldWindow\n * @constructor\n * @classdesc Represents a WorldWind window for an HTML canvas.\n * @param {String|HTMLCanvasElement} canvasElem The ID assigned to the HTML canvas in the document or the canvas\n * element itself.\n * @param {ElevationModel} elevationModel An optional argument indicating the elevation model to use for the World\n * Window. If missing or null, a default elevation model is used.\n * @throws {ArgumentError} If there is no HTML element with the specified ID in the document, or if the\n * HTML canvas does not support WebGL.\n */\nclass WorldWindow {\n    constructor(canvasElem, elevationModel, controllerConstructor, cameraConstructor) {\n        if (!(window.WebGLRenderingContext)) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"constructor\", \"webglNotSupported\"));\n        }\n\n        // Get the actual canvas element either directly or by ID.\n        var canvas;\n        if (canvasElem instanceof HTMLCanvasElement) {\n            canvas = canvasElem;\n        } else {\n            // Attempt to get the HTML canvas with the specified ID.\n            canvas = document.getElementById(canvasElem);\n\n            if (!canvas) {\n                throw new ArgumentError(\n                    Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"constructor\",\n                        \"The specified canvas ID is not in the document.\"));\n            }\n        }\n\n        // Create the WebGL context associated with the HTML canvas.\n        var gl = this.createContext(canvas);\n        if (!gl) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"constructor\", \"webglNotSupported\"));\n        }\n\n        // Internal. Intentionally not documented.\n        this.drawContext = new DrawContext(gl);\n\n        // Internal. Intentionally not documented. Must be initialized before the navigator is created.\n        this.eventListeners = {};\n\n        // Internal. Intentionally not documented. Initially true in order to redraw at least once.\n        this.redrawRequested = true;\n\n        // Internal. Intentionally not documented.\n        this.redrawRequestId = null;\n\n        // Internal. Intentionally not documented.\n        this.scratchModelview = Matrix.fromIdentity();\n\n        // Internal. Intentionally not documented.\n        this.scratchProjection = Matrix.fromIdentity();\n\n        // Internal. Intentionally not documented.\n        this.hasStencilBuffer = gl.getContextAttributes().stencil;\n\n        /**\n         * The HTML canvas associated with this WorldWindow.\n         * @type {HTMLElement}\n         * @readonly\n         */\n        this.canvas = canvas;\n\n        /**\n         * The number of bits in the depth buffer associated with this WorldWindow.\n         * @type {number}\n         * @readonly\n         */\n        this.depthBits = gl.getParameter(gl.DEPTH_BITS);\n\n        /**\n         * The current viewport of this WorldWindow.\n         * @type {Rectangle}\n         * @readonly\n         */\n        this.viewport = new Rectangle(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n        /**\n         * The globe displayed.\n         * @type {Globe}\n         */\n        this.globe = new Globe(elevationModel || new EarthElevationModel());\n\n        /**\n         * The layers to display in this WorldWindow.\n         * This property is read-only. Use [addLayer]{@link WorldWindow#addLayer} or\n         * [insertLayer]{@link WorldWindow#insertLayer} to add layers to this WorldWindow.\n         * Use [removeLayer]{@link WorldWindow#removeLayer} to remove layers from this WorldWindow.\n         * @type {Layer[]}\n         * @readonly\n         */\n        this.layers = [];\n\n        /**\n         * The navigator used to manipulate the globe.\n         * @type {Navigator}\n         * @default [Navigator]{@link Navigator}\n         */\n        this.navigator = new Navigator(cameraConstructor && new cameraConstructor(this) || new ArcBallCamera(this));\n\n\n        /**\n         * The controller used to manipulate the globe.\n         * @type {WorldWindowController}\n         * @default [BasicWorldWindowController]{@link BasicWorldWindowController}\n         */\n        this.worldWindowController = controllerConstructor && new controllerConstructor(this) || new BasicWorldWindowController(this);\n\n        /**\n         * The vertical exaggeration to apply to the terrain.\n         * @type {Number}\n         */\n        this.verticalExaggeration = 1;\n\n        /**\n         * Indicates that picking will return all objects at the pick point, if any. The top-most object will have\n         * its isOnTop flag set to true.\n         * If deep picking is false, the default, only the top-most object is returned, plus\n         * the picked-terrain object if the pick point is over the terrain.\n         * @type {boolean}\n         * @default false\n         */\n        this.deepPicking = false;\n\n        /**\n         * Indicates whether this WorldWindow should be configured for sub-surface rendering. If true, shapes\n         * below the terrain can be seen when the terrain is made transparent. If false, sub-surface shapes are\n         * not visible, however, performance is slightly increased.\n         * @type {boolean}\n         * @default false\n         */\n        this.subsurfaceMode = false;\n\n        /**\n         * The opacity to apply to terrain and surface shapes. This property is typically used when viewing\n         * the sub-surface. It modifies the opacity of the terrain and surface shapes as a whole. It should be\n         * a number between 0 and 1. It is compounded with the individual opacities of the image layers and\n         * surface shapes on the terrain.\n         * @type {Number}\n         * @default 1\n         */\n        this.surfaceOpacity = 1;\n\n        /**\n         * Performance statistics for this WorldWindow.\n         * @type {FrameStatistics}\n         */\n        this.frameStatistics = new FrameStatistics();\n\n        /**\n         * The {@link GoToAnimator} used by this WorldWindow to respond to its goTo method.\n         * @type {GoToAnimator}\n         */\n        this.goToAnimator = new GoToAnimator(this);\n\n        // Documented with its property accessor below.\n        this._redrawCallbacks = [];\n\n        // Documented with its property accessor below.\n        this._orderedRenderingFilters = [\n            function (dc) {\n                thisWindow.declutter(dc, 1);\n            },\n            function (dc) {\n                thisWindow.declutter(dc, 2);\n            }\n        ];\n\n        // Intentionally not documented.\n        this.pixelScale = 1;\n\n        // Prevent the browser's default actions in response to mouse and touch events, which interfere with\n        // navigation. Register these event listeners  before any others to ensure that they're called last.\n        function preventDefaultListener(event) {\n            event.preventDefault();\n        }\n\n        this.addEventListener(\"mousedown\", preventDefaultListener);\n        this.addEventListener(\"touchstart\", preventDefaultListener);\n        this.addEventListener(\"contextmenu\", preventDefaultListener);\n        this.addEventListener(\"wheel\", preventDefaultListener);\n\n        var thisWindow = this;\n\n        // Redirect various UI interactions to the appropriate handler.\n        function onGestureEvent(event) {\n            thisWindow.onGestureEvent(event);\n        }\n\n        if (window.PointerEvent) {\n            // Prevent the browser's default actions in response to pointer events which interfere with navigation.\n            // This CSS style property is configured here to ensure that it's set for all applications.\n            this.canvas.style.setProperty(\"touch-action\", \"none\");\n\n            this.addEventListener(\"pointerdown\", onGestureEvent, false);\n            window.addEventListener(\"pointermove\", onGestureEvent, false); // get pointermove events outside event target\n            window.addEventListener(\"pointercancel\", onGestureEvent, false); // get pointercancel events outside event target\n            window.addEventListener(\"pointerup\", onGestureEvent, false); // get pointerup events outside event target\n        } else {\n            this.addEventListener(\"mousedown\", onGestureEvent, false);\n            window.addEventListener(\"mousemove\", onGestureEvent, false); // get mousemove events outside event target\n            window.addEventListener(\"mouseup\", onGestureEvent, false); // get mouseup events outside event target\n            this.addEventListener(\"touchstart\", onGestureEvent, false);\n            this.addEventListener(\"touchmove\", onGestureEvent, false);\n            this.addEventListener(\"touchend\", onGestureEvent, false);\n            this.addEventListener(\"touchcancel\", onGestureEvent, false);\n        }\n\n        // Register wheel event listeners on the WorldWindow's canvas.\n        this.addEventListener(\"wheel\", function (event) {\n            onGestureEvent(event);\n        });\n\n        // Set up to handle WebGL context lost events.\n        function handleContextLost(event) {\n            thisWindow.handleContextLost(event);\n        }\n\n        this.canvas.addEventListener(\"webglcontextlost\", handleContextLost, false);\n\n        // Set up to handle WebGL context restored events.\n        function handleContextRestored(event) {\n            thisWindow.handleContextRestored(event);\n        }\n\n        this.canvas.addEventListener(\"webglcontextrestored\", handleContextRestored, false);\n\n        // Set up to handle WebGL context events and WorldWind redraw request events. Imagery uses the canvas\n        // redraw events because images are generally specific to the WebGL context associated with the canvas.\n        // Elevation models use the global window redraw events because they can be shared among WorldWindows.\n        function handleRedrawEvent(event) {\n            thisWindow.handleRedrawEvent(event)\n        }\n\n        this.canvas.addEventListener(WorldWind.REDRAW_EVENT_TYPE, handleRedrawEvent, false);\n        window.addEventListener(WorldWind.REDRAW_EVENT_TYPE, handleRedrawEvent, false);\n\n        // Render to the WebGL context in an animation frame loop until the WebGL context is lost.\n        this.animationFrameLoop();\n    };\n\n\n    /**\n     * An array of functions to call during ordered rendering prior to rendering the ordered renderables.\n     * Each function is passed one argument, the current draw context. The function may modify the\n     * ordered renderables in the draw context's ordered renderable list, which has been sorted from front\n     * to back when the filter function is called. Ordered rendering filters are typically used to apply\n     * decluttering. The default set of filter functions contains one function that declutters shapes with\n     * declutter group ID of 1 ({@link GeographicText} by default) and one function that declutters shapes\n     * with declutter group ID 2 ({@link Placemark} by default). Applications can add functions to this\n     * array or remove them.\n     * @type {Function[]}\n     * @default [WorldWindow.declutter]{@link WorldWindow#declutter} with a group ID of 1\n     * @readonly\n     * @memberof WorldWindow.prototype\n     */\n    orderedRenderingFilters() {\n        return this._orderedRenderingFilters;\n    }\n\n    /**\n     * The list of callbacks to call immediately before and immediately after performing a redraw. The callbacks\n     * have two arguments: this WorldWindow and the redraw stage, e.g., <code style='white-space:nowrap'>redrawCallback(worldWindow, stage);</code>.\n     * The stage will be either WorldWind.BEFORE_REDRAW or WorldWind.AFTER_REDRAW indicating whether the\n     * callback has been called either immediately before or immediately after a redraw, respectively.\n     * Applications may add functions to this array or remove them.\n     * @type {Function[]}\n     * @readonly\n     * @memberof WorldWindow.prototype\n     */\n    redrawCallbacks() {\n        return this._redrawCallbacks;\n    }\n\n    /**\n     * Converts window coordinates to coordinates relative to this WorldWindow's canvas.\n     * @param {Number} x The X coordinate to convert.\n     * @param {Number} y The Y coordinate to convert.\n     * @returns {Vec2} The converted coordinates.\n     */\n    canvasCoordinates(x, y) {\n        var bbox = this.canvas.getBoundingClientRect(),\n            xc = x - (bbox.left + this.canvas.clientLeft),// * (this.canvas.width / bbox.width),\n            yc = y - (bbox.top + this.canvas.clientTop);// * (this.canvas.height / bbox.height);\n\n        return new Vec2(xc, yc);\n    };\n\n    onGestureEvent(event) {\n        this.worldWindowController.onGestureEvent(event);\n    };\n\n    /**\n     * Registers an event listener for the specified event type on this WorldWindow's canvas. This function\n     * delegates the processing of events to the WorldWindow's canvas. For details on this function and its\n     * arguments, see the W3C [EventTarget]{@link https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-EventTarget}\n     * documentation.\n     *\n     * Registering event listeners using this function enables applications to prevent the WorldWindow's default\n     * navigation behavior. To prevent default navigation behavior, call the [Event]{@link https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-Event}'s\n     * preventDefault method from within an event listener for any events the navigator should not respond to.\n     *\n     * When an event occurs, this calls the registered event listeners in order of reverse registration. Since the\n     * WorldWindow registers its navigator event listeners first, application event listeners are called before\n     * navigator event listeners.\n     *\n     * @param type The event type to listen for.\n     * @param listener The function to call when the event occurs.\n     * @throws {ArgumentError} If any argument is null or undefined.\n     */\n    addEventListener(type, listener) {\n        if (!type) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"addEventListener\", \"missingType\"));\n        }\n\n        if (!listener) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"addEventListener\", \"missingListener\"));\n        }\n\n        var thisWorldWindow = this;\n        var entry = this.eventListeners[type];\n        if (!entry) {\n            entry = {\n                listeners: [],\n                callback: function (event) { // calls listeners in reverse registration order\n                    event.worldWindow = thisWorldWindow;\n                    for (var i = 0, len = entry.listeners.length; i < len; i++) {\n                        entry.listeners[i](event);\n                    }\n                }\n            };\n            this.eventListeners[type] = entry;\n        }\n\n        var index = entry.listeners.indexOf(listener);\n        if (index == -1) { // suppress duplicate listeners\n            entry.listeners.splice(0, 0, listener); // insert the listener at the beginning of the list\n\n            if (entry.listeners.length == 1) { // first listener added, add the event listener callback\n                this.canvas.addEventListener(type, entry.callback, false);\n            }\n        }\n    };\n\n    /**\n     * Removes an event listener for the specified event type from this WorldWindow's canvas. The listener must be\n     * the same object passed to addEventListener. Calling removeEventListener with arguments that do not identify a\n     * currently registered listener has no effect.\n     *\n     * @param type Indicates the event type the listener registered for.\n     * @param listener The listener to remove. Must be the same function object passed to addEventListener.\n     * @throws {ArgumentError} If any argument is null or undefined.\n     */\n    removeEventListener(type, listener) {\n        if (!type) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"removeEventListener\", \"missingType\"));\n        }\n\n        if (!listener) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"removeEventListener\", \"missingListener\"));\n        }\n\n        var entry = this.eventListeners[type];\n        if (!entry) {\n            return; // no entry for the specified type\n        }\n\n        var index = entry.listeners.indexOf(listener);\n        if (index != -1) {\n            entry.listeners.splice(index, 1); // remove the listener from the list\n\n            if (entry.listeners.length == 0) { // last listener removed, remove the event listener callback\n                this.canvas.removeEventListener(type, entry.callback, false);\n            }\n        }\n    };\n\n    /**\n     * Causes this WorldWindow to redraw itself at the next available opportunity. The redraw occurs on the main\n     * thread at a time of the browser's discretion. Applications should call redraw after changing the World\n     * Window's state, but should not expect that change to be reflected on screen immediately after this function\n     * returns. This is the preferred method for requesting a redraw of the WorldWindow.\n     */\n    redraw() {\n        this.redrawRequested = true; // redraw during the next animation frame\n    };\n\n    /**\n     * Requests the WorldWind objects displayed at a specified screen-coordinate point.\n     *\n     * If the point intersects the terrain, the returned list contains an object identifying the associated geographic\n     * position. This returns an empty list when nothing in the WorldWind scene intersects the specified point.\n     *\n     * @param pickPoint The point to examine in this WorldWindow's screen coordinates.\n     * @returns {PickedObjectList} A list of picked WorldWind objects at the specified pick point.\n     * @throws {ArgumentError} If the specified pick point is null or undefined.\n     */\n    pick(pickPoint) {\n        if (!pickPoint) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"pick\", \"missingPoint\"));\n        }\n\n        // Suppress the picking operation and return an empty list when the WebGL context has been lost.\n        if (this.drawContext.currentGlContext.isContextLost()) {\n            return new PickedObjectList();\n        }\n\n        this.resize();\n        this.resetDrawContext();\n        this.drawContext.pickingMode = true;\n        this.drawContext.pickPoint = pickPoint;\n        this.drawContext.pickRay = this.rayThroughScreenPoint(pickPoint);\n        this.drawFrame();\n\n        return this.drawContext.objectsAtPickPoint;\n    };\n\n    /**\n     * Requests the position of the WorldWind terrain at a specified screen-coordinate point. If the point\n     * intersects the terrain, the returned list contains a single object identifying the associated geographic\n     * position. Otherwise this returns an empty list.\n     * @param pickPoint The point to examine in this WorldWindow's screen coordinates.\n     * @returns {PickedObjectList} A list containing the picked WorldWind terrain position at the specified point,\n     * or an empty list if the point does not intersect the terrain.\n     * @throws {ArgumentError} If the specified pick point is null or undefined.\n     */\n    pickTerrain(pickPoint) {\n        if (!pickPoint) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"pickTerrain\", \"missingPoint\"));\n        }\n\n        // Suppress the picking operation and return an empty list when the WebGL context has been lost.\n        if (this.drawContext.currentGlContext.isContextLost()) {\n            return new PickedObjectList();\n        }\n\n        this.resize();\n        this.resetDrawContext();\n        this.drawContext.pickingMode = true;\n        this.drawContext.pickTerrainOnly = true;\n        this.drawContext.pickPoint = pickPoint;\n        this.drawContext.pickRay = this.rayThroughScreenPoint(pickPoint);\n        this.drawFrame();\n\n        return this.drawContext.objectsAtPickPoint;\n    };\n\n    /**\n     * Requests the WorldWind objects displayed within a specified screen-coordinate region. This returns all\n     * objects that intersect the specified region, regardless of whether or not an object is actually visible, and\n     * marks objects that are visible as on top.\n     * @param {Rectangle} rectangle The screen coordinate rectangle identifying the region to search.\n     * @returns {PickedObjectList} A list of visible WorldWind objects within the specified region.\n     * @throws {ArgumentError} If the specified rectangle is null or undefined.\n     */\n    pickShapesInRegion(rectangle) {\n        if (!rectangle) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"pickShapesInRegion\", \"missingRectangle\"));\n        }\n\n        // Suppress the picking operation and return an empty list when the WebGL context has been lost.\n        if (this.drawContext.currentGlContext.isContextLost()) {\n            return new PickedObjectList();\n        }\n\n        this.resize();\n        this.resetDrawContext();\n        this.drawContext.pickingMode = true;\n        this.drawContext.regionPicking = true;\n        this.drawContext.pickRectangle =\n            new Rectangle(rectangle.x, this.canvas.height - rectangle.y, rectangle.width, rectangle.height);\n        this.drawFrame();\n\n        return this.drawContext.objectsAtPickPoint;\n    };\n\n    // Internal function. Intentionally not documented.\n    createContext(canvas) {\n        // Request a WebGL context with antialiasing is disabled. Antialiasing causes gaps to appear at the edges of\n        // terrain tiles.\n        var glAttrs = { antialias: false, stencil: true },\n            gl = canvas.getContext(\"webgl\", glAttrs);\n        if (!gl) {\n            gl = canvas.getContext(\"experimental-webgl\", glAttrs);\n        }\n\n        // uncomment to debug WebGL\n        //var gl = WebGLDebugUtils.makeDebugContext(this.canvas.getContext(\"webgl\"),\n        //        this.throwOnGLError,\n        //        this.logAndValidate\n        //);\n\n        return gl;\n    };\n\n    // Internal function. Intentionally not documented.\n    handleContextLost(event) {\n        Logger.log(Logger.LEVEL_INFO, \"WebGL context event: \" + event.statusMessage);\n        // Inform WebGL that we handle context restoration, enabling the context restored event to be delivered.\n        event.preventDefault();\n        // Notify the draw context that the WebGL rendering context has been lost.\n        this.drawContext.contextLost();\n        // Stop the rendering animation frame loop, resuming only if the WebGL context is restored.\n        window.cancelAnimationFrame(this.redrawRequestId);\n    };\n\n    // Internal function. Intentionally not documented.\n    handleContextRestored(event) {\n        Logger.log(Logger.LEVEL_INFO, \"WebGL context event: \" + event.statusMessage);\n        // Notify the draw context that the WebGL rendering context has been restored.\n        this.drawContext.contextRestored();\n        // Resume the rendering animation frame loop until the WebGL context is lost.\n        this.redraw();\n        this.animationFrameLoop();\n    };\n\n    // Internal function. Intentionally not documented.\n    handleRedrawEvent(event) {\n        this.redraw(); // redraw in the next animation frame\n    };\n\n    // Internal function. Intentionally not documented.\n    animationFrameLoop() {\n        // Render to the WebGL context as needed.\n        this.redrawIfNeeded();\n\n        // Continue the animation frame loop until the WebGL context is lost.\n        var thisWindow = this;\n\n        function animationFrameCallback() {\n            thisWindow.animationFrameLoop();\n        }\n\n        this.redrawRequestId = window.requestAnimationFrame(animationFrameCallback);\n    };\n\n    // Internal function. Intentionally not documented.\n    redrawIfNeeded() {\n        // Check if the drawing buffer needs to resize to match its screen size, which requires a redraw.\n        this.resize();\n\n        // Redraw the WebGL drawing buffer only when necessary.\n        if (!this.redrawRequested) {\n            return;\n        }\n\n        try {\n            // Prepare to redraw and notify the redraw callbacks that a redraw is about to occur.\n            this.redrawRequested = false;\n            this.drawContext.previousRedrawTimestamp = this.drawContext.timestamp;\n            this.callRedrawCallbacks(WorldWind.BEFORE_REDRAW);\n            // Redraw the WebGL drawing buffer.\n            this.resetDrawContext();\n            this.drawFrame();\n        } catch (e) {\n            Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"redrawIfNeeded\",\n                \"Exception occurred during redrawing.\\n\" + e.toString());\n        } finally {\n            // Notify the redraw callbacks that a redraw has completed.\n            this.callRedrawCallbacks(WorldWind.AFTER_REDRAW);\n            // Handle rendering code redraw requests.\n            if (this.drawContext.redrawRequested) {\n                this.redrawRequested = true;\n            }\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    resize() {\n        var gl = this.drawContext.currentGlContext,\n            width = gl.canvas.clientWidth * this.pixelScale,\n            height = gl.canvas.clientHeight * this.pixelScale;\n\n        if (gl.canvas.width != width ||\n            gl.canvas.height != height) {\n\n            // Make the canvas drawing buffer size match its screen size.\n            gl.canvas.width = width;\n            gl.canvas.height = height;\n\n            // Set the WebGL viewport to match the canvas drawing buffer size.\n            gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n            this.viewport = new Rectangle(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n            // Cause this WorldWindow to redraw with the new size.\n            this.redrawRequested = true;\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    computeViewingTransform(projection, modelview) {\n        if (!modelview) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"computeViewingTransform\", \"missingModelview\"));\n        }\n\n        var globe = this.globe;\n        this.navigator.camera.createViewMatrix(modelview);\n\n        if (projection) {\n            projection.setToIdentity();\n            var globeRadius = WWMath.max(globe.equatorialRadius, globe.polarRadius),\n                eyePoint = modelview.extractEyePoint(new Vec3(0, 0, 0)),\n                eyePos = globe.computePositionFromPoint(eyePoint[0], eyePoint[1], eyePoint[2], new Position(0, 0, 0)),\n                eyeHorizon = WWMath.horizonDistanceForGlobeRadius(globeRadius, eyePos.altitude),\n                atmosphereHorizon = WWMath.horizonDistanceForGlobeRadius(globeRadius, 160000),\n                viewport = this.viewport;\n\n            // Set the far clip distance to the smallest value that does not clip the atmosphere.\n            // TODO adjust the clip plane distances based on the navigator's orientation - shorter distances when the\n            // TODO horizon is not in view\n            // TODO parameterize the object altitude for horizon distance\n            var farDistance = eyeHorizon + atmosphereHorizon;\n            if (farDistance < 1e3)\n                farDistance = 1e3;\n\n            // Compute the near clip distance in order to achieve a desired depth resolution at the far clip distance.\n            // This computed distance is limited such that it does not intersect the terrain when possible and is never\n            // less than a predetermined minimum (usually one). The computed near distance automatically scales with the\n            // resolution of the WebGL depth buffer.\n            var nearDistance = WWMath.perspectiveNearDistanceForFarDistance(farDistance, 10, this.depthBits);\n\n            // Prevent the near clip plane from intersecting the terrain.\n            var distanceToSurface = eyePos.altitude - globe.elevationAtLocation(eyePos.latitude, eyePos.longitude);\n            if (distanceToSurface > 0) {\n                var maxNearDistance = WWMath.perspectiveNearDistance(viewport.width, viewport.height, distanceToSurface);\n                if (nearDistance > maxNearDistance) {\n                    nearDistance = maxNearDistance;\n                }\n            }\n\n            if (nearDistance < 1) {\n                nearDistance = 1;\n            }\n\n            // Compute the current projection matrix based on this navigator's perspective properties and the current\n            // WebGL viewport.\n            projection.setToPerspectiveProjection(viewport.width, viewport.height, nearDistance, farDistance);\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    computePixelMetrics(projection) {\n        var projectionInv = Matrix.fromIdentity();\n        projectionInv.invertMatrix(projection);\n\n        // Compute the eye coordinate rectangles carved out of the frustum by the near and far clipping planes, and\n        // the distance between those planes and the eye point along the -Z axis. The rectangles are determined by\n        // transforming the bottom-left and top-right points of the frustum from clip coordinates to eye\n        // coordinates.\n        var nbl = new Vec3(-1, -1, -1),\n            ntr = new Vec3(+1, +1, -1),\n            fbl = new Vec3(-1, -1, +1),\n            ftr = new Vec3(+1, +1, +1);\n        // Convert each frustum corner from clip coordinates to eye coordinates by multiplying by the inverse\n        // projection matrix.\n        nbl.multiplyByMatrix(projectionInv);\n        ntr.multiplyByMatrix(projectionInv);\n        fbl.multiplyByMatrix(projectionInv);\n        ftr.multiplyByMatrix(projectionInv);\n\n        var nrRectWidth = WWMath.fabs(ntr[0] - nbl[0]),\n            frRectWidth = WWMath.fabs(ftr[0] - fbl[0]),\n            nrDistance = -nbl[2],\n            frDistance = -fbl[2];\n\n        // Compute the scale and offset used to determine the width of a pixel on a rectangle carved out of the\n        // frustum at a distance along the -Z axis in eye coordinates. These values are found by computing the scale\n        // and offset of a frustum rectangle at a given distance, then dividing each by the viewport width.\n        var frustumWidthScale = (frRectWidth - nrRectWidth) / (frDistance - nrDistance),\n            frustumWidthOffset = nrRectWidth - frustumWidthScale * nrDistance;\n\n        return {\n            pixelSizeFactor: frustumWidthScale / this.viewport.width,\n            pixelSizeOffset: frustumWidthOffset / this.viewport.height\n        };\n    };\n\n    /**\n     * Computes the approximate size of a pixel at a specified distance from the eye point.\n     * <p>\n     * This method assumes rectangular pixels, where pixel coordinates denote\n     * infinitely thin spaces between pixels. The units of the returned size are in model coordinates per pixel\n     * (usually meters per pixel). This returns 0 if the specified distance is zero. The returned size is undefined\n     * if the distance is less than zero.\n     *\n     * @param {Number} distance The distance from the eye point at which to determine pixel size, in model\n     * coordinates.\n     * @returns {Number} The approximate pixel size at the specified distance from the eye point, in model\n     * coordinates per pixel.\n     */\n    pixelSizeAtDistance(distance) {\n        this.computeViewingTransform(this.scratchProjection, this.scratchModelview);\n        var pixelMetrics = this.computePixelMetrics(this.scratchProjection);\n        return pixelMetrics.pixelSizeFactor * distance + pixelMetrics.pixelSizeOffset;\n    };\n\n    // Internal. Intentionally not documented.\n    computeDrawContext() {\n        var dc = this.drawContext;\n\n        this.computeViewingTransform(dc.projection, dc.modelview);\n        dc.viewport = this.viewport;\n        dc.eyePoint = dc.modelview.extractEyePoint(new Vec3(0, 0, 0));\n\n        dc.modelviewProjection.setToIdentity();\n        dc.modelviewProjection.setToMultiply(dc.projection, dc.modelview);\n\n        var pixelMetrics = this.computePixelMetrics(dc.projection);\n        dc.pixelSizeFactor = pixelMetrics.pixelSizeFactor;\n        dc.pixelSizeOffset = pixelMetrics.pixelSizeOffset;\n\n        // Compute the inverse of the modelview, projection, and modelview-projection matrices. The inverse matrices\n        // are used to support operations on navigator state.\n        var modelviewInv = Matrix.fromIdentity();\n        modelviewInv.invertOrthonormalMatrix(dc.modelview);\n\n        dc.modelviewNormalTransform = Matrix.fromIdentity().setToTransposeOfMatrix(modelviewInv.upper3By3());\n\n        // Compute the frustum in model coordinates. Start by computing the frustum in eye coordinates from the\n        // projection matrix, then transform this frustum to model coordinates by multiplying its planes by the\n        // transpose of the modelview matrix. We use the transpose of the modelview matrix because planes are\n        // transformed by the inverse transpose of a matrix, and we want to transform from eye coordinates to model\n        // coordinates.\n        var modelviewTranspose = Matrix.fromIdentity();\n        modelviewTranspose.setToTransposeOfMatrix(dc.modelview);\n        dc.frustumInModelCoordinates = Frustum.fromProjectionMatrix(dc.projection);\n        dc.frustumInModelCoordinates.transformByMatrix(modelviewTranspose);\n        dc.frustumInModelCoordinates.normalize();\n    };\n\n    // Internal. Intentionally not documented.\n    resetDrawContext() {\n        this.globe.offset = 0;\n\n        var dc = this.drawContext;\n        dc.reset();\n        dc.globe = this.globe;\n        dc.navigator = this.navigator;\n        dc.layers = this.layers.slice();\n        dc.layers.push(dc.screenCreditController);\n        this.computeDrawContext();\n        dc.verticalExaggeration = this.verticalExaggeration;\n        dc.surfaceOpacity = this.surfaceOpacity;\n        dc.deepPicking = this.deepPicking;\n        dc.frameStatistics = this.frameStatistics;\n        dc.pixelScale = this.pixelScale;\n        dc.update();\n    };\n\n    /* useful stuff to debug WebGL */\n    /*\n        function logGLCall(functionName, args) {\n        console.log(\"gl.\" + functionName + \"(\" +\n        WebGLDebugUtils.glFunctionArgsToString(functionName, args) + \")\");\n        };\n    \n        function validateNoneOfTheArgsAreUndefined(functionName, args) {\n        for (var ii = 0; ii < args.length; ++ii) {\n        if (args[ii] === undefined) {\n        console.error(\"undefined passed to gl.\" + functionName + \"(\" +\n        WebGLDebugUtils.glFunctionArgsToString(functionName, args) + \")\");\n        }\n        }\n        };\n    \n        logAndValidate logAndValidate(functionName, args) {\n        logGLCall(functionName, args);\n        validateNoneOfTheArgsAreUndefined (functionName, args);\n        };\n    \n        throwOnGLError throwOnGLError(err, funcName, args) {\n        throw WebGLDebugUtils.glEnumToString(err) + \" was caused by call to: \" + funcName;\n        };\n        */\n\n    // Internal function. Intentionally not documented.\n    drawFrame() {\n        try {\n            this.drawContext.frameStatistics.beginFrame();\n            this.beginFrame();\n\n            if (this.drawContext.globe.is2D() && this.drawContext.globe.continuous) {\n                this.do2DContiguousRepaint();\n            } else {\n                this.doNormalRepaint();\n            }\n\n        } finally {\n            this.endFrame();\n            this.drawContext.frameStatistics.endFrame();\n            //console.log(this.drawContext.frameStatistics.frameTime);\n        }\n    };\n\n    doNormalRepaint() {\n        this.createTerrain();\n        this.clearFrame();\n        this.deferOrderedRendering = false;\n        if (this.drawContext.pickingMode) {\n            if (this.drawContext.makePickFrustum()) {\n                this.doPick();\n                this.resolvePick();\n            }\n        } else {\n            this.doDraw();\n            if (this.subsurfaceMode && this.hasStencilBuffer) {\n                this.redrawSurface();\n                this.drawScreenRenderables();\n            }\n        }\n    };\n\n    do2DContiguousRepaint() {\n        this.createTerrain2DContiguous();\n        this.clearFrame();\n        if (this.drawContext.pickingMode) {\n            if (this.drawContext.makePickFrustum()) {\n                this.pick2DContiguous();\n                this.resolvePick();\n            }\n        } else {\n            this.draw2DContiguous();\n        }\n    };\n\n    resolvePick() {\n        if (this.drawContext.pickTerrainOnly) {\n            this.resolveTerrainPick();\n        } else if (this.drawContext.regionPicking) {\n            this.resolveRegionPick();\n        } else {\n            this.resolveTopPick();\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    beginFrame() {\n        var gl = this.drawContext.currentGlContext;\n        gl.enable(gl.BLEND);\n        gl.enable(gl.CULL_FACE);\n        gl.enable(gl.DEPTH_TEST);\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n        gl.depthFunc(gl.LEQUAL);\n\n        if (this.drawContext.pickingMode) {\n            this.drawContext.makePickFramebuffer();\n            this.drawContext.bindFramebuffer(this.drawContext.pickFramebuffer);\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    endFrame() {\n        var gl = this.drawContext.currentGlContext;\n        gl.disable(gl.BLEND);\n        gl.disable(gl.CULL_FACE);\n        gl.disable(gl.DEPTH_TEST);\n        gl.blendFunc(gl.ONE, gl.ZERO);\n        gl.depthFunc(gl.LESS);\n        gl.clearColor(0, 0, 0, 1);\n\n        this.drawContext.bindFramebuffer(null);\n        this.drawContext.bindProgram(null);\n    };\n\n    // Internal function. Intentionally not documented.\n    clearFrame() {\n        var dc = this.drawContext,\n            gl = dc.currentGlContext;\n\n        gl.clearColor(dc.clearColor.red, dc.clearColor.green, dc.clearColor.blue, dc.clearColor.alpha);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    };\n\n    // Internal function. Intentionally not documented.\n    doDraw() {\n        this.drawContext.renderShapes = true;\n\n        if (this.subsurfaceMode && this.hasStencilBuffer) {\n            // Draw the surface and collect the ordered renderables.\n            this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST);\n            this.drawContext.surfaceShapeTileBuilder.clear();\n            this.drawLayers(true);\n            this.drawSurfaceRenderables();\n            this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n\n            if (!this.deferOrderedRendering) {\n                // Clear the depth and stencil buffers prior to rendering the ordered renderables. This allows\n                // sub-surface renderables to be drawn beneath the terrain. Turn on stenciling to capture the\n                // fragments that ordered renderables draw. The terrain and surface shapes will be subsequently\n                // drawn again, and the stencil buffer will ensure that they are drawn only where they overlap\n                // the fragments drawn by the ordered renderables.\n                this.drawContext.currentGlContext.clear(\n                    this.drawContext.currentGlContext.DEPTH_BUFFER_BIT | this.drawContext.currentGlContext.STENCIL_BUFFER_BIT);\n                this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST);\n                this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS, 1, 1);\n                this.drawContext.currentGlContext.stencilOp(\n                    this.drawContext.currentGlContext.REPLACE, this.drawContext.currentGlContext.REPLACE, this.drawContext.currentGlContext.REPLACE);\n                this.drawOrderedRenderables();\n            }\n        } else {\n            this.drawContext.surfaceShapeTileBuilder.clear();\n            this.drawLayers(true);\n            this.drawSurfaceRenderables();\n            this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n\n            if (!this.deferOrderedRendering) {\n                this.drawOrderedRenderables();\n                this.drawScreenRenderables();\n            }\n        }\n    };\n\n    redrawSurface() {\n        // Draw the terrain and surface shapes but only where the current stencil buffer is non-zero.\n        // The non-zero fragments are from drawing the ordered renderables previously.\n        this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST);\n        this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.EQUAL, 1, 1);\n        this.drawContext.currentGlContext.stencilOp(\n            this.drawContext.currentGlContext.KEEP, this.drawContext.currentGlContext.KEEP, this.drawContext.currentGlContext.KEEP);\n        this.drawContext.surfaceShapeTileBuilder.clear();\n        this.drawLayers(false);\n        this.drawSurfaceRenderables();\n        this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n        this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST);\n    };\n\n    // Internal function. Intentionally not documented.\n    doPick() {\n        if (this.drawContext.terrain) {\n            this.drawContext.terrain.pick(this.drawContext);\n        }\n\n        if (!this.drawContext.pickTerrainOnly) {\n            if (this.subsurfaceMode && this.hasStencilBuffer) {\n                // Draw the surface and collect the ordered renderables.\n                this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST);\n                this.drawContext.surfaceShapeTileBuilder.clear();\n                this.drawLayers(true);\n                this.drawSurfaceRenderables();\n                this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n\n                if (!this.deferOrderedRendering) {\n                    // Clear the depth and stencil buffers prior to rendering the ordered renderables. This allows\n                    // sub-surface renderables to be drawn beneath the terrain. Turn on stenciling to capture the\n                    // fragments that ordered renderables draw. The terrain and surface shapes will be subsequently\n                    // drawn again, and the stencil buffer will ensure that they are drawn only where they overlap\n                    // the fragments drawn by the ordered renderables.\n                    this.drawContext.currentGlContext.clear(\n                        this.drawContext.currentGlContext.DEPTH_BUFFER_BIT | this.drawContext.currentGlContext.STENCIL_BUFFER_BIT);\n                    this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST);\n                    this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS, 1, 1);\n                    this.drawContext.currentGlContext.stencilOp(\n                        this.drawContext.currentGlContext.REPLACE, this.drawContext.currentGlContext.REPLACE, this.drawContext.currentGlContext.REPLACE);\n                    this.drawOrderedRenderables();\n                    this.drawContext.terrain.pick(this.drawContext);\n                    this.drawScreenRenderables();\n                }\n            } else {\n                this.drawContext.surfaceShapeTileBuilder.clear();\n\n                this.drawLayers(true);\n                this.drawSurfaceRenderables();\n\n                this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n\n                if (!this.deferOrderedRendering) {\n                    this.drawOrderedRenderables();\n                    this.drawScreenRenderables();\n                }\n            }\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    createTerrain() {\n        var dc = this.drawContext;\n        dc.terrain = this.globe.tessellator.tessellate(dc);\n        dc.frameStatistics.setTerrainTileCount(dc.terrain ? dc.terrain.surfaceGeometry.length : 0);\n    };\n\n    makeCurrent(offset) {\n        var dc = this.drawContext;\n        dc.globe.offset = offset;\n        dc.globeStateKey = dc.globe.stateKey;\n\n        switch (offset) {\n            case -1:\n                dc.terrain = this.terrainLeft;\n                break;\n\n            case 0:\n                dc.terrain = this.terrainCenter;\n                break;\n\n            case 1:\n                dc.terrain = this.terrainRight;\n                break;\n        }\n    };\n\n    createTerrain2DContiguous() {\n        var dc = this.drawContext;\n\n        this.terrainCenter = null;\n        dc.globe.offset = 0;\n        dc.globeStateKey = dc.globe.stateKey;\n        if (dc.globe.intersectsFrustum(dc.frustumInModelCoordinates)) {\n            this.terrainCenter = dc.globe.tessellator.tessellate(dc);\n        }\n\n        this.terrainRight = null;\n        dc.globe.offset = 1;\n        dc.globeStateKey = dc.globe.stateKey;\n        if (dc.globe.intersectsFrustum(dc.frustumInModelCoordinates)) {\n            this.terrainRight = dc.globe.tessellator.tessellate(dc);\n        }\n\n        this.terrainLeft = null;\n        dc.globe.offset = -1;\n        dc.globeStateKey = dc.globe.stateKey;\n        if (dc.globe.intersectsFrustum(dc.frustumInModelCoordinates)) {\n            this.terrainLeft = dc.globe.tessellator.tessellate(dc);\n        }\n    };\n\n    draw2DContiguous() {\n        var drawing = \"\";\n\n        if (this.terrainCenter) {\n            drawing += \" 0 \";\n            this.makeCurrent(0);\n            this.deferOrderedRendering = this.terrainLeft || this.terrainRight;\n            this.doDraw();\n        }\n\n        if (this.terrainRight) {\n            drawing += \" 1 \";\n            this.makeCurrent(1);\n            this.deferOrderedRendering = this.terrainLeft || this.terrainLeft;\n            this.doDraw();\n        }\n\n        this.deferOrderedRendering = false;\n\n        if (this.terrainLeft) {\n            drawing += \" -1 \";\n            this.makeCurrent(-1);\n            this.doDraw();\n        }\n        //\n        //console.log(drawing);\n\n        if (this.subsurfaceMode && this.hasStencilBuffer) {\n            this.deferOrderedRendering = true;\n\n            if (this.terrainCenter) {\n                drawing += \" 0 \";\n                this.makeCurrent(0);\n                this.redrawSurface();\n            }\n\n            if (this.terrainRight) {\n                drawing += \" 1 \";\n                this.makeCurrent(1);\n                this.redrawSurface();\n            }\n\n            if (this.terrainLeft) {\n                drawing += \" -1 \";\n                this.makeCurrent(-1);\n                this.redrawSurface();\n            }\n        }\n\n        this.drawScreenRenderables();\n    };\n\n    pick2DContiguous() {\n        if (this.terrainCenter) {\n            this.makeCurrent(0);\n            this.deferOrderedRendering = this.terrainLeft || this.terrainRight;\n            this.doPick();\n        }\n\n        if (this.terrainRight) {\n            this.makeCurrent(1);\n            this.deferOrderedRendering = this.terrainLeft || this.terrainLeft;\n            this.doPick();\n        }\n\n        this.deferOrderedRendering = false;\n\n        if (this.terrainLeft) {\n            this.makeCurrent(-1);\n            this.doPick();\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    drawLayers(accumulateOrderedRenderables) {\n        // Draw all the layers attached to this WorldWindow.\n\n        var beginTime = Date.now(),\n            dc = this.drawContext,\n            layers = dc.layers,\n            layer;\n\n        dc.accumulateOrderedRenderables = accumulateOrderedRenderables;\n\n        for (var i = 0, len = layers.length; i < len; i++) {\n            layer = layers[i];\n            if (layer) {\n                dc.currentLayer = layer;\n                try {\n                    layer.render(dc);\n                } catch (e) {\n                    Logger.log(Logger.LEVEL_SEVERE, \"Error while rendering layer \" + layer.displayName + \".\\n\"\n                        + e.toString());\n                    // Keep going. Render the rest of the layers.\n                }\n            }\n        }\n        dc.currentLayer = null;\n        var now = Date.now();\n        dc.frameStatistics.layerRenderingTime = now - beginTime;\n    };\n\n    /**\n     * Adds a specified layer to the end of this WorldWindow.\n     * @param {Layer} layer The layer to add. May be null or undefined, in which case this WorldWindow is not\n     * modified.\n     */\n    addLayer(layer) {\n        if (layer) {\n            this.layers.push(layer);\n        }\n    };\n\n    /**\n     * Removes the first instance of a specified layer from this WorldWindow.\n     * @param {Layer} layer The layer to remove. May be null or undefined, in which case this WorldWindow is not\n     * modified. This WorldWindow is also not modified if the specified layer does not exist in this WorldWindow's\n     * layer list.\n     */\n    removeLayer(layer) {\n        var index = this.indexOfLayer(layer);\n        if (index >= 0) {\n            this.layers.splice(index, 1);\n        }\n    };\n\n    /**\n     * Inserts a specified layer at a specified position in this WorldWindow.\n     * @param {Number} index The index at which to insert the layer. May be negative to specify the position\n     * from the end of the array.\n     * @param {Layer} layer The layer to insert. May be null or undefined, in which case this WorldWindow is not\n     * modified.\n     */\n    insertLayer(index, layer) {\n        if (layer) {\n            this.layers.splice(index, 0, layer);\n        }\n    };\n\n    /**\n     * Returns the index of a specified layer in this WorldWindow.\n     * @param {Layer} layer The layer to search for.\n     * @returns {Number} The index of the specified layer or -1 if it doesn't exist in this WorldWindow.\n     */\n    indexOfLayer(layer) {\n        return this.layers.indexOf(layer);\n    };\n\n    // Internal function. Intentionally not documented.\n    drawSurfaceRenderables() {\n        var dc = this.drawContext,\n            sr;\n\n        dc.reverseSurfaceRenderables();\n\n        while (sr = dc.popSurfaceRenderable()) {\n            try {\n                sr.renderSurface(dc);\n            } catch (e) {\n                Logger.logMessage(Logger.LEVEL_WARNING, \"WorldWindow\", \"drawSurfaceRenderables\",\n                    \"Error while rendering a surface renderable.\\n\" + e.message);\n                // Keep going. Render the rest of the surface renderables.\n            }\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    drawOrderedRenderables() {\n        var beginTime = Date.now(),\n            dc = this.drawContext,\n            or;\n\n        dc.sortOrderedRenderables();\n\n        if (this._orderedRenderingFilters) {\n            for (var f = 0; f < this._orderedRenderingFilters.length; f++) {\n                this._orderedRenderingFilters[f](this.drawContext);\n            }\n        }\n\n        dc.orderedRenderingMode = true;\n\n        while (or = dc.popOrderedRenderable()) {\n            try {\n                or.renderOrdered(dc);\n            } catch (e) {\n                Logger.logMessage(Logger.LEVEL_WARNING, \"WorldWindow\", \"drawOrderedRenderables\",\n                    \"Error while rendering an ordered renderable.\\n\" + e.message);\n                // Keep going. Render the rest of the ordered renderables.\n            }\n        }\n\n        dc.orderedRenderingMode = false;\n        dc.frameStatistics.orderedRenderingTime = Date.now() - beginTime;\n    };\n\n    drawScreenRenderables() {\n        var dc = this.drawContext,\n            or;\n\n        while (or = dc.nextScreenRenderable()) {\n            try {\n                or.renderOrdered(dc);\n            } catch (e) {\n                Logger.logMessage(Logger.LEVEL_WARNING, \"WorldWindow\", \"drawOrderedRenderables\",\n                    \"Error while rendering a screen renderable.\\n\" + e.message);\n                // Keep going. Render the rest of the screen renderables.\n            }\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    resolveTopPick() {\n        if (this.drawContext.objectsAtPickPoint.objects.length == 0) {\n            return; // nothing picked; avoid calling readPickColor unnecessarily\n        }\n\n        // Make a last reading to determine what's on top.\n\n        var pickedObjects = this.drawContext.objectsAtPickPoint,\n            pickColor = this.drawContext.readPickColor(this.drawContext.pickPoint),\n            topObject = null,\n            terrainObject = null;\n\n        if (pickColor) {\n            // Find the picked object with the top color code and set its isOnTop flag.\n            for (var i = 0, len = pickedObjects.objects.length; i < len; i++) {\n                var po = pickedObjects.objects[i];\n\n                if (po.isTerrain) {\n                    terrainObject = po;\n                }\n\n                if (po.color.equals(pickColor)) {\n                    po.isOnTop = true;\n                    topObject = po;\n\n                    if (terrainObject) {\n                        break; // no need to search for more than the top object and the terrain object\n                    }\n                }\n            }\n\n            // In single-pick mode provide only the top-most object and the terrain object, if any.\n            if (!this.drawContext.deepPicking) {\n                pickedObjects.clear();\n                if (topObject) {\n                    pickedObjects.add(topObject);\n                }\n                if (terrainObject && terrainObject != topObject) {\n                    pickedObjects.add(terrainObject);\n                }\n            }\n        } else {\n            pickedObjects.clear(); // nothing drawn at the pick point\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    resolveTerrainPick() {\n        var pickedObjects = this.drawContext.objectsAtPickPoint,\n            po;\n\n        // Mark the first picked terrain object as \"on top\". The picked object list should contain only one entry\n        // indicating the picked terrain object, but we iterate over the list contents anyway.\n        for (var i = 0, len = pickedObjects.objects.length; i < len; i++) {\n            po = pickedObjects.objects[i];\n            if (po.isTerrain) {\n                po.isOnTop = true;\n                break;\n            }\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    resolveRegionPick() {\n        if (this.drawContext.objectsAtPickPoint.objects.length == 0) {\n            return; // nothing picked; avoid calling readPickColors unnecessarily\n        }\n\n        // Mark every picked object with a color in the pick buffer as \"on top\".\n\n        var pickedObjects = this.drawContext.objectsAtPickPoint,\n            uniquePickColors = this.drawContext.readPickColors(this.drawContext.pickRectangle),\n            po,\n            color;\n\n        for (var i = 0, len = pickedObjects.objects.length; i < len; i++) {\n            po = pickedObjects.objects[i];\n            if (!po) continue;\n            var poColor = po.color.toByteString();\n            color = uniquePickColors[poColor];\n            if (color) {\n                po.isOnTop = true;\n            } else if (po.userObject instanceof SurfaceShape) {\n                // SurfaceShapes ALWAYS get added to the pick list, since their rendering is deferred\n                // until the tile they are cached by is rendered. So a SurfaceShape may be in the pick list\n                // but is not seen in the pick rectangle.\n                //\n                // Remove the SurfaceShape that was not visible to the pick rectangle.\n                pickedObjects.objects.splice(i, 1);\n                i -= 1;\n            }\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    callRedrawCallbacks(stage) {\n        for (var i = 0, len = this._redrawCallbacks.length; i < len; i++) {\n            try {\n                this._redrawCallbacks[i](this, stage);\n            } catch (e) {\n                Logger.log(Logger.LEVEL_SEVERE, \"Exception calling redraw callback.\\n\" + e.toString());\n                // Keep going. Execute the rest of the callbacks.\n            }\n        }\n    };\n\n    /**\n     * Moves this WorldWindow's navigator to a specified location or position.\n     * @param {Location | Position} position The location or position to move the navigator to. If this\n     * argument contains an \"altitude\" property, as {@link Position} does, the end point of the navigation is\n     * at the specified altitude. Otherwise the end point is at the current altitude of the navigator.\n     *\n     * This function uses this WorldWindow's {@link GoToAnimator} property to perform the move. That object's\n     * properties can be specified by the application to modify its behavior during calls to this function.\n     * It's cancel method can also be used to cancel the move initiated by this function.\n     * @param {Function} completionCallback If not null or undefined, specifies a function to call when the\n     * animation completes. The completion callback is called with a single argument, this animator.\n     * @throws {ArgumentError} If the specified location or position is null or undefined.\n     */\n    goTo(position, completionCallback) {\n        this.goToAnimator.goTo(position, completionCallback);\n    };\n\n    /**\n     * Declutters the current ordered renderables with a specified group ID. This function is not called by\n     * applications directly. It's meant to be invoked as an ordered rendering filter in this WorldWindow's\n     * [orderedRenderingFilters]{@link WorldWindow#orderedRenderingFilters} property.\n     * <p>\n     * The function operates by setting the target visibility of occluded shapes to 0 and unoccluded shapes to 1.\n     * @param {DrawContext} dc The current draw context.\n     * @param {Number} groupId The ID of the group to declutter. Must not be null, undefined or 0.\n     * @throws {ArgumentError} If the specified group ID is null, undefined or 0.\n     */\n    declutter(dc, groupId) {\n        if (!groupId) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"declutter\",\n                    \"Group ID is null, undefined or 0.\"));\n        }\n\n        // Collect all the declutterables in the specified group.\n        var declutterables = [];\n        for (var i = 0; i < dc.orderedRenderables.length; i++) {\n            var orderedRenderable = dc.orderedRenderables[i].orderedRenderable;\n            if (orderedRenderable.declutterGroup === groupId) {\n                declutterables.push(orderedRenderable);\n            }\n        }\n\n        // Filter the declutterables by determining which are partially occluded. Since the ordered renderable\n        // list was already sorted from front to back, the front-most will represent an entire occluded group.\n        var rects = [];\n        for (var j = 0; j < declutterables.length; j++) {\n            var declutterable = declutterables[j],\n                screenBounds = declutterable.screenBounds;\n\n            if (screenBounds && screenBounds.intersectsRectangles(rects)) {\n                declutterable.targetVisibility = 0;\n            } else {\n                declutterable.targetVisibility = 1;\n                if (screenBounds) {\n                    rects.push(screenBounds);\n                }\n            }\n        }\n    };\n\n    /**\n     * Computes a ray originating at the eyePoint and extending through the specified point in window\n     * coordinates.\n     * <p>\n     * The specified point is understood to be in the window coordinate system of the WorldWindow, with the origin\n     * in the top-left corner and axes that extend down and to the right from the origin point.\n     * <p>\n     * The results of this method are undefined if the specified point is outside of the WorldWindow's\n     * bounds.\n     *\n     * @param {Vec2} point The window coordinates point to compute a ray for.\n     * @returns {Line} A new Line initialized to the origin and direction of the computed ray, or null if the\n     * ray could not be computed.\n     */\n    rayThroughScreenPoint(point) {\n        if (!point) {\n            throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"rayThroughScreenPoint\",\n                \"missingPoint\"));\n        }\n\n        // Convert the point's xy coordinates from window coordinates to WebGL screen coordinates.\n        var screenPoint = new Vec3(point[0], this.viewport.height - point[1], 0),\n            nearPoint = new Vec3(0, 0, 0),\n            farPoint = new Vec3(0, 0, 0);\n\n        this.computeViewingTransform(this.scratchProjection, this.scratchModelview);\n        var modelviewProjection = Matrix.fromIdentity();\n        modelviewProjection.setToMultiply(this.scratchProjection, this.scratchModelview);\n        var modelviewProjectionInv = Matrix.fromIdentity();\n        modelviewProjectionInv.invertMatrix(modelviewProjection);\n\n        // Compute the model coordinate point on the near clip plane with the xy coordinates and depth 0.\n        if (!modelviewProjectionInv.unProject(screenPoint, this.viewport, nearPoint)) {\n            return null;\n        }\n\n        // Compute the model coordinate point on the far clip plane with the xy coordinates and depth 1.\n        screenPoint[2] = 1;\n        if (!modelviewProjectionInv.unProject(screenPoint, this.viewport, farPoint)) {\n            return null;\n        }\n\n        var eyePoint = this.scratchModelview.extractEyePoint(new Vec3(0, 0, 0));\n\n        // Compute a ray originating at the eye point and with direction pointing from the xy coordinate on the near\n        // plane to the same xy coordinate on the far plane.\n        var origin = new Vec3(eyePoint[0], eyePoint[1], eyePoint[2]),\n            direction = new Vec3(farPoint[0], farPoint[1], farPoint[2]);\n\n        direction.subtract(nearPoint);\n        direction.normalize();\n\n        return new Line(origin, direction);\n    };\n}\n\nexport default WorldWindow;","const CLICK_DELAY = 200; //ms\nconst CLICK_MIN_TIME = 50; //ms\nconst TYPE_TIMEOUT = 'timeoutClick';\nconst TYPE_COMMON = 'commonClick';\n/**\n * @exports ClickPickController\n */\nclass ClickPickController {\n\t/**\n\t * Constructs a ClickPickController.\n\t * @alias ClickPickController\n\t * @constructor\n\t * @classdesc The ClickPickController\n\t * @param {WorldWindow} wwd The WorldWindow instance.\n\t * @param {Function} cb A callback function to call with the current clicked renderables after mouseUp/touchEnd.\n\t * @param {number} clickDelay Ignore click longer than clickDelay\n\t * @param {number} minClickTime Minimum click time to be registered\n\t * @param {number} clickTimeout After this time will be triggered callback\n\t */\n\tconstructor(wwd, cb, clickDelay = CLICK_DELAY, minClickTime = CLICK_MIN_TIME, clickTimeout) {\n\t\tthis.clickTimeout = clickTimeout;\n\t\tthis.clickDelay = clickDelay;\n\t\tthis.minClickTime = minClickTime;\n        this.mouseDown = false;\n        this.tpCache = [];\n        this.clickTimeoutKey = null;\n\t\tthis.eventListener = this.eventListener.bind(this, wwd, cb);\n\n\t\tconst events = ['mousedown', 'mouseup', 'mousemove', 'touchstart', 'touchend', 'touchmove'];\n\t\tevents.forEach(event => {\n\t\t\twwd.addEventListener(event, this.eventListener);\n\t\t});\n\t}\n\n\teventListener(wwd, cb, event) {\n\t\tswitch (event.type) {\n\t\t\tcase 'touchmove':\n\t\t\t\tthis.onTouchMove(cb, event);\n\t\t\t\treturn;\n\t\t\tcase 'mousemove':\n\t\t\t\tthis.onMouseMove(wwd, cb, event, true);\n\t\t\t\treturn;\n\t\t\tcase 'touchstart':\n                this.onTouchStart(wwd, cb, event);\n                return;\n\t\t\tcase 'mousedown':\n\t\t\t\tthis.onMouseDown(wwd, cb, event);\n\t\t\t\treturn;\n\t\t\tcase 'touchend':\n\t\t\t\tthis.onTouchEnd(wwd, cb, event);\n\t\t\t\treturn;\t\n\t\t\tcase 'mouseup':\n\t\t\t\tthis.onMouseUp(wwd, cb, event);\n\t\t\t\treturn;\n\t\t}\n\t}\n\n\tgetRenderablesByMouse(wwd, cb, event, x, y, type) {\n\t\t\tconst pickList = wwd.pick(wwd.canvasCoordinates(x, y));\n\n\t\t\tif (cb) {\n\t\t\t\tconst timeDiff = this.getClickTime();\n\t\t\t\tcb(pickList, event, x, y, timeDiff, type);\n\t\t\t}\n\t}\n\n\tgetClickTime() {\n\t\tif(this.clickTimeoutKey && this.clickTimeoutKey.time) {\n\t\t\tconst curTime = new Date().getTime();\n\t\t\tconst timeDiff = curTime - this.clickTimeoutKey.time;\n\t\t\treturn timeDiff;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Check if minClickTime is set and if click is longer than it.\n\t */\n\tcouldClick() {\n\t\tif(this.minClickTime && typeof this.minClickTime === 'number') {\n\t\t\tconst timeDiff = this.getClickTime();\n\t\t\tif(timeDiff > this.minClickTime) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n    onClick(wwd, cb, evt, x, y, type) {\n        this.getRenderablesByMouse(wwd, cb, evt, x, y, type);\n    }\n\n\tclearTouchEventCache() {\n\t\tthis.tpCache = [];\n\t}\n\n\tremoveTouchEventByIdentifier(identifier) {\n\t\tthis.tpCache = this.tpCache.filter((ev) => {\n\t\t\treturn ev.identifier !== identifier;\n\t\t});\n    }\n    \n\tcacheEvents(evts) {\n\t\tfor (let i=0; i < evts.length; i++) {\n\t\t\tthis.tpCache.push(evts[i]);\n\t\t}\n    }\n\n    resetClickTimeout() {\n        if(this.clickTimeoutKey && this.clickTimeoutKey.key) {\n            window.clearTimeout(this.clickTimeoutKey.key);\n            this.clickTimeoutKey = null;\n        }\n    }\n\n    setClickTimeout(key) {\n        if(key) {\n            this.clickTimeoutKey = {\n\t\t\t\tkey,\n\t\t\t\ttime: new Date().getTime()\n\t\t\t};\n        }\n    }\n\n    setPointerDownTimeout(wwd, cb, evt) {\n        const clickKey = window.setTimeout(() => {\n\t\t\tthis.resetClickTimeout();\n        }, this.clickDelay);\n\n\t\tthis.setClickTimeout(clickKey);\n\t\t\n\n\t\tif(this.clickTimeout && typeof this.clickTimeout === 'number') {\n\t\t\tlet x,y;\n\t\t\tif(evt.changedTouches && evt.changedTouches.length === 1 && this.clickTimeoutKey) {\n\t\t\t\tx = evt.changedTouches[0].clientX;\n\t\t\t\ty = evt.changedTouches[0].clientY;\n\t\t\t} else {\n\t\t\t\tx = evt.clientX;\n\t\t\t\ty = evt.clientY;\n\t\t\t}\n\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tif(this.couldClick() && this.clickTimeoutKey) {\n\t\t\t\t\tthis.onClick(wwd, cb, evt, x, y, TYPE_TIMEOUT);\n\t\t\t\t}\t\n\t\t\t}, this.clickTimeout);\n\t\n\t\t}\n    }\n\n\tonTouchStart(wwd, cb, evt) {\n        if(this.tpCache.length > 0) {\n\t\t\tfor (let i = 0; i < evt.touches.length; i++) {\n\t\t\t\tthis.removeTouchEventByIdentifier(evt.touches[i].identifier);\n\t\t\t}\n\t\t}\n\t\t// Cache the touch points for later processing of 2-touch pinch/zoom\n\t\tthis.cacheEvents(evt.touches);\n\n        //clear clickTimeoutKey\n        this.resetClickTimeout();\n\n        if(evt.touches.length === 1) {\n            this.setPointerDownTimeout(wwd, cb, evt);\n        }\n\t}\n\tonTouchEnd(wwd, cb, evt) {\n\n\t\t//remove from cache by identifier\t\t\n\t\tfor (let i = 0; i < evt.changedTouches.length; i++) {\n\t\t\tthis.removeTouchEventByIdentifier(evt.changedTouches[i].identifier);\n\t\t}\n\n\t\t//FIX - sometime touchend or touchcancel is not called and touch stick in cache \n\t\tif(evt.touches.length === 0 && this.tpCache.length > 0) {\n\t\t\tthis.clearTouchEventCache();\n        }\n\n        if(evt.changedTouches.length === 1 && this.clickTimeoutKey) {\n\t\t\tconst x = evt.changedTouches[0].clientX;\n\t\t\tconst y = evt.changedTouches[0].clientY;\n\t\t\t//kontrola timeoutu\n\t\t\tif(this.couldClick()) {\n\t\t\t\tthis.onClick(wwd, cb, evt, x, y, TYPE_COMMON);\n\t\t\t}\n\t\t\tthis.resetClickTimeout();\n        }\n\n    }\n    \n\tonTouchMove(cb, event) {\n        //identify touch by one touch\n        if(this.tpCache.length === 1) {\n            this.clearTouchEventCache();\n            this.resetClickTimeout();\n        }\n    }\n\n\tonMouseDown(wwd, cb, evt) {\n        this.resetClickTimeout();\n        this.setPointerDownTimeout(wwd, cb, evt);\n\t}\n\tonMouseUp(wwd, cb, evt) {\n        if(this.clickTimeoutKey) {\n\t\t\tconst x = evt.clientX;\n\t\t\tconst y = evt.clientY;\n\t\t\t//kontrola timeoutu\n\t\t\tif(this.couldClick()) {\n\t\t\t\tthis.onClick(wwd, cb, evt, x, y, TYPE_COMMON);\n\t\t\t}\n\t\t\tthis.resetClickTimeout();\n        }\n    }\n\n\tonMouseMove() {\n        this.resetClickTimeout();\n    }\n}\n\nexport default ClickPickController;","import WorldWind from 'webworldwind-esa';\n\nconst {\n    Angle,\n    WWMath\n} = WorldWind;\n\n/**\n * \n * @param {WorldWindController} basicController \n */\nexport default function(basicController) {\n    //Customized applyLimits function that call onNavigatorChanged on every execution\n    const applyLimits = () => {\n        const wwd = basicController.wwd || basicController.worldWindow;\n        var navigator = wwd.navigator;\n\n        // Clamp latitude to between -90 and +90, and normalize longitude to between -180 and +180.\n        navigator.lookAtLocation.latitude = WWMath.clamp(navigator.lookAtLocation.latitude, -90, 90);\n        navigator.lookAtLocation.longitude = Angle.normalizedDegreesLongitude(navigator.lookAtLocation.longitude);\n\n        // Clamp range to values greater than 1 in order to prevent degenerating to a first-person navigator when\n        // range is zero.\n        navigator.range = WWMath.clamp(navigator.range, 1, Number.MAX_VALUE);\n\n        // Normalize heading to between -180 and +180.\n        navigator.heading = Angle.normalizedDegrees(navigator.heading);\n\n        // Clamp tilt to between 0 and +90 to prevent the viewer from going upside down.\n        navigator.tilt = WWMath.clamp(navigator.tilt, 0, 90);\n\n        // Normalize heading to between -180 and +180.\n        navigator.roll = Angle.normalizedDegrees(navigator.roll);\n\n        // Apply 2D limits when the globe is 2D.\n        if (wwd.globe.is2D() && navigator.enable2DLimits) {\n            // Clamp range to prevent more than 360 degrees of visible longitude. Assumes a 45 degree horizontal\n            // field of view.\n            var maxRange = 2 * Math.PI * wwd.globe.equatorialRadius;\n            navigator.range = WWMath.clamp(navigator.range, 1, maxRange);\n\n            // Force tilt to 0 when in 2D mode to keep the viewer looking straight down.\n            navigator.tilt = 0;\n        }\n\n        //event map changed\n        if(typeof basicController.onNavigatorChanged === 'function') {\n            basicController.onNavigatorChanged(navigator);\n        }\n    };\n\n    basicController.applyLimits = applyLimits;\n    basicController.onNavigatorChanged = null;\n};\n","\nfunction getChangedViewParams(prev, next) {\n\t\tlet changed = {};\n\n\t\tif (prev.boxRange !== next.boxRange){\n\t\t\tchanged.boxRange = next.boxRange;\n\t\t}\n\n\t\tif (typeof next.heading === 'number' && prev.heading !== next.heading){\n\t\t\tchanged.heading = next.heading;\n\t\t}\n\n\t\tif (typeof next.tilt === 'number' && prev.tilt !== next.tilt){\n\t\t\tchanged.tilt = next.tilt;\n\t\t}\n\n\t\tif (typeof next.roll === 'number' && prev.roll !== next.roll){\n\t\t\tchanged.roll = next.roll;\n\t\t}\n\n\t\tif (typeof next.headingCorrection === 'number' && prev.headingCorrection !== next.headingCorrection){\n\t\t\tchanged.headingCorrection = next.headingCorrection;\n\t\t}\n\n\t\tif ((prev.center.lat !== next.center.lat) ||\n\t\t\t(prev.center.lon !== next.center.lon) ||\n\t\t\t(prev.center.altitude !== next.center.altitude)) {\n\t\t\tchanged.center = {\n\t\t\t\tlat: next.center.lat,\n\t\t\t\tlon: next.center.lon,\n\t\t\t\taltitude: next.center.altitude,\n\t\t\t}\n\t\t}\n\n\t\treturn changed;\n}\n\n/**\n * Update navigator of given World Window\n * @param wwd {WorldWindow}\n * @param view {Object}\n */\nfunction update(wwd, view) {\n\tlet state = wwd.navigator;\n\tlet wwdUpdate = getWorldWindNavigatorFromViewParams(view);\n\t\n\tlet shouldRedraw = false;\n\n\tif (wwdUpdate.range && state.range !== wwdUpdate.range){\n\t\tstate.range = wwdUpdate.range;\n\t\tshouldRedraw = true;\n\t}\n\n\tif (typeof wwdUpdate.tilt === 'number' && state.tilt !== wwdUpdate.tilt){\n\t\tstate.tilt = wwdUpdate.tilt;\n\t\tshouldRedraw = true;\n\t}\n\n\tif (typeof wwdUpdate.roll === 'number' && state.roll !== wwdUpdate.roll){\n\t\tstate.roll = wwdUpdate.roll;\n\t\tshouldRedraw = true;\n\t}\n\n\tif (typeof wwdUpdate.heading === 'number' && state.heading !== wwdUpdate.heading){\n\t\tstate.heading = wwdUpdate.heading;\n\t\tshouldRedraw = true;\n\t}\n\n\tif (wwdUpdate.lookAtLocation && wwdUpdate.lookAtLocation.latitude && state.lookAtLocation.latitude !== wwdUpdate.lookAtLocation.latitude){\n\t\tstate.lookAtLocation.latitude = wwdUpdate.lookAtLocation.latitude;\n\t\tshouldRedraw = true;\n\t}\n\n\tif (wwdUpdate.lookAtLocation && wwdUpdate.lookAtLocation.longitude && state.lookAtLocation.longitude !== wwdUpdate.lookAtLocation.longitude){\n\t\tstate.lookAtLocation.longitude = wwdUpdate.lookAtLocation.longitude;\n\t\tshouldRedraw = true;\n\t}\n\n\tif (wwdUpdate.lookAtLocation && wwdUpdate.lookAtLocation.altitude && state.lookAtLocation.altitude !== wwdUpdate.lookAtLocation.altitude){\n\t\tstate.lookAtLocation.altitude = wwdUpdate.lookAtLocation.altitude;\n\t\tshouldRedraw = true;\n\t}\n\n\tif (state.lookAtLocation && state.lookAtLocation.altitude && wwdUpdate.lookAtLocation && !wwdUpdate.lookAtLocation.hasOwnProperty('altitude')){\n\t\tstate.lookAtLocation.altitude = 0;\n\t\tshouldRedraw = true;\n\t}\n\n\t// if (wwd.verticalExaggeration && wwdUpdate.elevation && wwd.verticalExaggeration !== wwdUpdate.elevation){\n\t// \twwd.verticalExaggeration = wwdUpdate.elevation;\n\t// \tshouldRedraw = true;\n\t// }\n\n\tif (shouldRedraw) {\n\t\twwd.redraw();\n\t}\n}\n\n/**\n * Convert view to World Wind Navigator params\n * @param view {Object}\n * @returns {WorldWind.Navigator}\n */\nfunction getWorldWindNavigatorFromViewParams(view) {\n\tlet {center, boxRange, ...navigator} = view;\n\n\tif (boxRange) {\n\t\tnavigator.range = boxRange;\n\t}\n\n\tif (center) {\n\t\tnavigator.lookAtLocation = {};\n\t\tif (center.lat) {\n\t\t\tnavigator.lookAtLocation.latitude = center.lat;\n\t\t}\n\t\tif (center.lon) {\n\t\t\tnavigator.lookAtLocation.longitude = center.lon;\n\t\t}\n\n\t\tif (center.altitude) {\n\t\t\tnavigator.lookAtLocation.altitude = center.altitude;\n\t\t}\n\t}\n\n\treturn navigator;\n}\n\n\nfunction getViewParamsFromWorldWindNavigator(navigator) {\n\tlet view = {};\n\tlet {lookAtLocation, range} = navigator;\n\n\tif (range) {\n\t\tview.boxRange = range;\n\t}\n\n\tif (lookAtLocation) {\n\t\tview.center = {};\n\t\tif (lookAtLocation.latitude) {\n\t\t\tview.center.lat = lookAtLocation.latitude;\n\t\t}\n\t\tif (lookAtLocation.longitude) {\n\t\t\tview.center.lon = lookAtLocation.longitude;\n\t\t}\n\t\tif (lookAtLocation.altitude) {\n\t\t\tview.center.altitude = lookAtLocation.altitude;\n\t\t}\n\t}\n\n\tif (navigator.heading || navigator.heading === 0) {\n\t\tview.heading = navigator.heading;\n\t}\n\n\tif (navigator.tilt || navigator.tilt === 0) {\n\t\tview.tilt = navigator.tilt;\n\t}\n\n\tif (navigator.roll || navigator.roll === 0) {\n\t\tview.roll = navigator.roll;\n\t}\n\n\treturn view;\n}\n\nconst updateFixedView = (wwd, viewFixed) => {\n\tconst navigator = wwd.navigator;\n\tconst worldWindowController = wwd.worldWindowController;\n\tlet changed = false;\n\tif(navigator.camera._isFixed !== viewFixed) {\n\t\tnavigator.camera._isFixed = viewFixed;\n\t\tchanged = true;\n\t}\n\tif(worldWindowController._isFixed !== viewFixed) {\n\t\tworldWindowController._isFixed = viewFixed;\n\t\tchanged = true;\n\t}\n\n\tif(changed) {\n\t\twwd.redraw();\n\t}\n}\n\nexport default {\n\tgetChangedViewParams,\n\tgetViewParamsFromWorldWindNavigator,\n\tupdate,\n\tupdateFixedView,\n}","import WorldWind from 'webworldwind-esa';\r\nimport TWEEN from '@tweenjs/tween.js';\r\nconst {\r\n    BEGAN,\r\n    CHANGED,\r\n    Vec2,\r\n    WWMath,\r\n    Angle,\r\n    Matrix,\r\n    Vec3\r\n} = WorldWind;\r\n\r\n/**\r\n * Alternative controller for World wind, which controls the globe via user interaction as if the user was moving around\r\n * a different center of the view then the center of the globe.\r\n * Using wheel of the mouse moves the user nearer and further away from the chosen point.\r\n * Using the mouse to move in the x and y moves the camera on the surface of the sphere. After this movement is applied,\r\n *   all the other attributes of the camera are updated so that the camera points in the center of the controller.\r\n * @param worldWindow {WorldWindow} WorldWindow this controller is associated with.\r\n * @param point {Position} The Point which serves as the center of the controller.\r\n * @constructor\r\n */\r\nclass FixedPointController  {\r\n    constructor(worldWindow) {\r\n        /**\r\n         * WorldWindow associated with the current Controller. There is 1:1 relationship between controller and\r\n         * WorldWindow\r\n         * @type {WorldWindow}\r\n         */\r\n        this.worldWindow = worldWindow;\r\n\r\n        /**\r\n         * Internal representation of current location of the viewer.\r\n         * @type {Object}\r\n         */\r\n        this.lookAt = this.worldWindow.navigator;\r\n\r\n        /**\r\n         * Object containing different types of recognizers. This is basically stored for the preparation of the\r\n         * deconstruction of the Controller.\r\n         * @type {Object}\r\n         */\r\n        this.recognizers = {};\r\n\r\n        /**\r\n         * It contains starting point of the users interaction with the globe.\r\n         * @type {Vec2}\r\n         */\r\n        this.lastPoint = new Vec2(0, 0);\r\n\r\n        /**\r\n         * It contains starting range for the case when user starts pinch gesture.\r\n         * @type {Number}\r\n         */\r\n        this.beginRange = 0;\r\n\r\n        this.sign = 1;\r\n\r\n        this.animate = this.animate.bind(this);\r\n        this.animationId = null;\r\n        this.isAnimating = false;\r\n        this.lastDegrees = new Vec2(0, 0);\r\n        this.preventContinuousInnertial = false;\r\n\r\n        // Intentionally not documented.\r\n        this.beginPoint = new Vec2(0, 0);\r\n        this.lastPoint = new Vec2(0, 0);\r\n        this.beginHeading = 0;\r\n        this.beginTilt = 0;\r\n        this.lastRotation = 0;\r\n        this.touchStart = 0;\r\n        this.startTimestamp = 0;\r\n        this.panEnd = 0;\r\n        this.touchStartPosition = [-1, -1];\r\n        this.touchEndPosition = [-1, -1];\r\n    }\r\n\r\n    get navigator() {\r\n        return this.worldWindow.navigator;\r\n    }\r\n\r\n    get globe() {\r\n        return this.worldWindow.globe;\r\n    }\r\n\r\n    handlePanOrDrag(recognizer) {\r\n        if (this.worldWindow.globe.is2D()) {\r\n            // this.handlePanOrDrag2D(recognizer);\r\n        } else {\r\n            this.handlePanOrDrag3D(recognizer);\r\n        }\r\n    }\r\n\r\n    handlePanOrDrag3D(recognizer) {\r\n        var state = recognizer.state,\r\n            tx = recognizer.translationX,\r\n            ty = recognizer.translationY;\r\n\r\n        if (state === WorldWind.BEGAN) {\r\n            this.lastPoint.set(0, 0);\r\n            this.startTimestamp = Date.now();\r\n\r\n            this.stopAnimation();\r\n        }\r\n        else if (state === WorldWind.CHANGED) {\r\n            // Convert the translation from screen coordinates to arc degrees. Use this navigator's range as a\r\n            // metric for converting screen pixels to meters, and use the globe's radius for converting from meters\r\n            // to arc degrees.\r\n            var canvas = this.worldWindow.canvas,\r\n                globe = this.worldWindow.globe,\r\n                globeRadius = WWMath.max(globe.equatorialRadius, globe.polarRadius),\r\n                // distance = WWMath.max(1, this.lookAt.range),\r\n                // distance = WWMath.max(1, this.lookAt.lookAtLocation.altitude),\r\n                distance = 20000000,\r\n                metersPerPixel = WWMath.perspectivePixelSize(canvas.clientWidth, canvas.clientHeight, distance),\r\n                forwardMeters = (ty - this.lastPoint[1]) * metersPerPixel,\r\n                sideMeters = -(tx - this.lastPoint[0]) * metersPerPixel,\r\n                forwardDegrees = (forwardMeters / globeRadius) * Angle.RADIANS_TO_DEGREES,\r\n                sideDegrees = (sideMeters / globeRadius) * Angle.RADIANS_TO_DEGREES;\r\n\r\n            // Apply the change in latitude and longitude to this navigator, relative to the current heading.\r\n            var sinHeading = Math.sin(this.lookAt.heading * Angle.DEGREES_TO_RADIANS),\r\n                cosHeading = Math.cos(this.lookAt.heading * Angle.DEGREES_TO_RADIANS);\r\n\r\n            // this.lookAt.lookAtLocation.latitude += forwardDegrees * cosHeading - sideDegrees * sinHeading;\r\n            // this.lookAt.lookAtLocation.longitude += forwardDegrees * sinHeading + sideDegrees * cosHeading;\r\n\r\n            this.lookAt.heading -= sideDegrees;\r\n            this.lookAt.tilt += forwardDegrees;\r\n\r\n            this.lastPoint.set(tx, ty);\r\n            this.lastDegrees.set(forwardDegrees, sideDegrees);\r\n            this.applyLimits(this.lookAt);\r\n            this.worldWindow.redraw();\r\n        }\r\n        else if (state === WorldWind.ENDED) {\r\n            this.panEnd = Date.now();\r\n            var isContinuous = false;\r\n            if (this.isContinuousInertial()) {\r\n                isContinuous = true;\r\n            }\r\n            else if (this.panEnd - this.startTimestamp > 150) {\r\n                return;\r\n            }\r\n\r\n            this.stopAnimation();\r\n\r\n            var animated = {\r\n                tx: this.lastDegrees[0],\r\n                ty: this.lastDegrees[1]\r\n            };\r\n\r\n            var to = {\r\n                tx: 0,\r\n                ty: 0\r\n            };\r\n\r\n            var animationDuration = isContinuous ? Infinity : 1500;\r\n            this.touchStart = 0;\r\n            this.touchStartPosition[0] = -1;\r\n            this.touchStartPosition[0] = -1;\r\n            this.touchEndPosition[0] = -1;\r\n            this.touchEndPosition[1] = -1;\r\n\r\n            this.currentTween = new TWEEN.Tween(animated)\r\n                .to(to, animationDuration)\r\n                .easing(TWEEN.Easing.Sinusoidal.Out)\r\n                .onStart(() => {\r\n                    this.beginHeading = this.lookAt.heading;\r\n                    this.beginTilt = this.lookAt.tilt;\r\n                })\r\n                .onUpdate(() => {\r\n                    if (!isFinite(animated.tx) && !isFinite(animated.ty)) {\r\n                        this.stopAnimation();\r\n                        return;\r\n                    }\r\n\r\n                    var sinHeading = Math.sin(this.lookAt.heading * Angle.DEGREES_TO_RADIANS),\r\n                        cosHeading = Math.cos(this.lookAt.heading * Angle.DEGREES_TO_RADIANS);\r\n\r\n                    // this.lookAt.lookAtLocation.latitude += animated.tx * cosHeading - animated.ty * sinHeading;\r\n                    // this.lookAt.lookAtLocation.longitude += animated.tx * sinHeading + animated.ty * cosHeading;\r\n\r\n                    this.lookAt.heading -= animated.ty;\r\n                    this.lookAt.tilt += animated.tx;\r\n\r\n                    this.applyLimits(this.lookAt);\r\n                    this.worldWindow.redraw();\r\n                })\r\n                .onComplete(() => {\r\n                    this.stopAnimation();\r\n                })\r\n                .onStop(() => {\r\n                    this.stopAnimation();\r\n                })\r\n                .start();\r\n\r\n            this.animate();\r\n        }\r\n    }\r\n\r\n    // handlePanOrDrag2D(recognizer) {\r\n    //     var state = recognizer.state,\r\n    //         x = recognizer.clientX,\r\n    //         y = recognizer.clientY,\r\n    //         tx = recognizer.translationX,\r\n    //         ty = recognizer.translationY;\r\n\r\n    //     if (state === WorldWind.BEGAN) {\r\n    //         this.beginPoint.set(x, y);\r\n    //         this.lastPoint.set(x, y);\r\n    //         this.startTimestamp = Date.now();\r\n\r\n    //         this.stopAnimation();\r\n    //     } else if (state === WorldWind.CHANGED) {\r\n    //         var x1 = this.lastPoint[0],\r\n    //             y1 = this.lastPoint[1],\r\n    //             x2 = this.beginPoint[0] + tx,\r\n    //             y2 = this.beginPoint[1] + ty;\r\n    //         this.lastPoint.set(x2, y2);\r\n\r\n    //         var navState = this.currentState(),\r\n    //             globe = this.worldWindow.globe,\r\n    //             ray = navState.rayFromScreenPoint(this.worldWindow.canvasCoordinates(x1, y1)),\r\n    //             point1 = new Vec3(0, 0, 0),\r\n    //             point2 = new Vec3(0, 0, 0),\r\n    //             origin = new Vec3(0, 0, 0);\r\n    //         if (!globe.intersectsLine(ray, point1)) {\r\n    //             return;\r\n    //         }\r\n\r\n    //         ray = navState.rayFromScreenPoint(this.worldWindow.canvasCoordinates(x2, y2));\r\n    //         if (!globe.intersectsLine(ray, point2)) {\r\n    //             return;\r\n    //         }\r\n\r\n    //         // Transform the original navigator state's modelview matrix to account for the gesture's change.\r\n    //         var modelview = Matrix.fromIdentity();\r\n    //         modelview.copy(navState.modelview);\r\n\r\n    //         var modelTy = point2[1] - point1[1];\r\n    //         var screenTy = y1 - y2;\r\n\r\n    //         //this.get2DLatitudeLimits(navState, screenTy, modelTy);\r\n\r\n    //         var translationY = this.get2DYTranslation(navState, screenTy, modelTy);\r\n    //         modelview.multiplyByTranslation(point2[0] - point1[0], translationY, point2[2] - point1[2]);\r\n\r\n    //         // Compute the globe point at the screen center from the perspective of the transformed navigator state.\r\n    //         modelview.extractEyePoint(ray.origin);\r\n    //         modelview.extractForwardVector(ray.direction);\r\n    //         if (!globe.intersectsLine(ray, origin)) {\r\n    //             return;\r\n    //         }\r\n\r\n    //         // Convert the transformed modelview matrix to a set of navigator properties, then apply those\r\n    //         // properties to this navigator.\r\n    //         var params = modelview.extractViewingParameters(origin, this.roll, globe, {});\r\n    //         this.lookAtLocation.copy(params.origin);\r\n    //         this.range = params.range;\r\n    //         this.heading = params.heading;\r\n    //         this.tilt = params.tilt;\r\n    //         this.roll = params.roll;\r\n    //         this.applyLimits();\r\n\r\n    //         this.deltaLookAtLocation.latitude = this.lastLookAtLocation.latitude - this.lookAtLocation.latitude;\r\n    //         this.deltaLookAtLocation.longitude = this.lastLookAtLocation.longitude - this.lookAtLocation.longitude;\r\n    //         this.lastLookAtLocation.copy(this.lookAtLocation);\r\n    //         this.pan2DInterpreted = true;\r\n\r\n    //         this.worldWindow.redraw();\r\n    //     }\r\n    //     else if (state === WorldWind.ENDED) {\r\n    //         if (!this.pan2DInterpreted) {\r\n    //             return;\r\n    //         }\r\n    //         this.pan2DInterpreted = false;\r\n    //         this.panEnd = Date.now();\r\n    //         var isContinuous = false;\r\n    //         if (this.isContinuousInertial()) {\r\n    //             isContinuous = true;\r\n    //         }\r\n    //         else if(this.panEnd - this.startTimestamp > 150) {\r\n    //             return;\r\n    //         }\r\n\r\n    //         this.stopAnimation();\r\n\r\n    //         var animated = {\r\n    //             tx: this.deltaLookAtLocation.latitude,\r\n    //             ty: this.deltaLookAtLocation.longitude\r\n    //         };\r\n\r\n    //         var to = {\r\n    //             tx: 0,\r\n    //             ty: 0\r\n    //         };\r\n\r\n    //         var animationDuration = isContinuous ? Infinity : 1500;\r\n    //         this.touchStart = 0;\r\n    //         this.touchStartPosition[0] = -1;\r\n    //         this.touchStartPosition[0] = -1;\r\n    //         this.touchEndPosition[0] = -1;\r\n    //         this.touchEndPosition[1] = -1;\r\n\r\n    //         const {north, south} = this.get2DLatitudeLimits(navState, 0, 0);\r\n\r\n    //         this.currentTween = new TWEEN.Tween(animated)\r\n    //             .to(to, animationDuration)\r\n    //             .easing(TWEEN.Easing.Sinusoidal.Out)\r\n    //             .onStart(() => {\r\n    //                 //this.beginHeading = this.heading;\r\n    //                 //this.beginTilt = this.tilt;\r\n    //             })\r\n    //             .onUpdate(() => {\r\n    //                 if (!isFinite(animated.tx) && !isFinite(animated.ty)) {\r\n    //                     this.stopAnimation();\r\n    //                     return;\r\n    //                 }\r\n\r\n    //                 this.lookAtLocation.latitude -= animated.tx;\r\n    //                 this.lookAtLocation.latitude = WWMath.clamp(this.lookAtLocation.latitude, south, north);\r\n    //                 this.lookAtLocation.longitude -= animated.ty;\r\n\r\n    //                 this.applyLimits();\r\n    //                 this.worldWindow.redraw();\r\n    //             })\r\n    //             .onComplete(() => {\r\n    //                 this.stopAnimation();\r\n    //             })\r\n    //             .onStop(() => {\r\n    //                 this.stopAnimation();\r\n    //             })\r\n    //             .start();\r\n\r\n    //         this.animate();\r\n    //     }\r\n    // }\r\n\r\n    handleFling(recognizer) {\r\n    }\r\n\r\n    handleSecondaryDrag(recognizer) {\r\n        var state = recognizer.state,\r\n        tx = recognizer.translationX,\r\n        ty = recognizer.translationY;\r\n        var navigator = this.wwd.navigator;\r\n        if (state === WorldWind.BEGAN) {\r\n            this.beginHeading = navigator.heading;\r\n            this.beginTilt = navigator.tilt;\r\n        } else if (state === WorldWind.CHANGED) {\r\n            // Compute the current translation from screen coordinates to degrees. Use the canvas dimensions as a\r\n            // metric for converting the gesture translation to a fraction of an angle.\r\n            var headingDegrees = 180 * tx / this.wwd.canvas.clientWidth,\r\n                tiltDegrees = 90 * ty / this.wwd.canvas.clientHeight;\r\n            // Apply the change in heading and tilt to this navigator's corresponding properties.\r\n            navigator.heading = this.beginHeading + headingDegrees;\r\n            navigator.tilt = this.beginTilt + tiltDegrees;\r\n            this.applyLimits();\r\n            this.wwd.redraw();\r\n        }\r\n    }\r\n\r\n    isContinuousInertial() {\r\n        const longPressTime = this.startTimestamp - this.touchStart;\r\n        const travelTime = this.panEnd - this.startTimestamp;\r\n        return (\r\n            !this.preventContinuousInnertial &&\r\n            this.touchStart !== 0 &&\r\n            this.startTimestamp !== 0 &&\r\n            this.panEnd !== 0 &&\r\n            longPressTime >= 2000 &&\r\n            travelTime <= 150\r\n        );\r\n    }\r\n\r\n\r\n    /**\r\n     * This function handles the behavior of the Navigator on the wheel event. In this case it is zooming in or out from\r\n     * the fixed point.\r\n     * @param recognizer\r\n     */\r\n    handleWheelEvent (event) {\r\n        const lookAt = this.lookAt;\r\n        // Normalize the wheel delta based on the wheel delta mode. This produces a roughly consistent delta across\r\n        // browsers and input devices.\r\n        var normalizedDelta;\r\n        if (event.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {\r\n            normalizedDelta = event.deltaY;\r\n        } else if (event.deltaMode === WheelEvent.DOM_DELTA_LINE) {\r\n            normalizedDelta = event.deltaY * 40;\r\n        } else if (event.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\r\n            normalizedDelta = event.deltaY * 400;\r\n        }\r\n\r\n        // Compute a zoom scale factor by adding a fraction of the normalized delta to 1. When multiplied by the\r\n        // navigator's range, this has the effect of zooming out or zooming in depending on whether the delta is\r\n        // positive or negative, respectfully.\r\n        var scale = 1 + (normalizedDelta / 1000);\r\n\r\n        // Apply the scale to this navigator's properties.\r\n        lookAt.range *= scale;\r\n\r\n        this.applyLimits(lookAt);\r\n        this.worldWindow.redraw();\r\n    };\r\n\r\n    handleRotation(recognizer) {\r\n    }\r\n\r\n    handleTilt(recognizer) {\r\n    }\r\n\r\n    handlePinch(recognizer) {\r\n        var state = recognizer.state,\r\n            scale = recognizer.scale;\r\n        if (state === WorldWind.BEGAN) {\r\n            this.beginRange = this.lookAt.range;\r\n        } else if (state === WorldWind.CHANGED) {\r\n            if (scale !== 0) {\r\n                // Apply the change in pinch scale to this navigator's range, relative to the range when the gesture\r\n                // began.\r\n                this.lookAt.range = this.beginRange / scale;\r\n                this.applyLimits(this.lookAt);\r\n                this.worldWindow.redraw();\r\n            }\r\n        }\r\n    }\r\n\r\nanimate() {\r\n    this.animationId = requestAnimationFrame(this.animate);\r\n    this.isAnimating = true;\r\n    TWEEN.update();\r\n}\r\n\r\nstopAnimation() {\r\n    TWEEN.removeAll();\r\n    window.cancelAnimationFrame(this.animationId);\r\n    this.isAnimating = false;\r\n    if (this.currentTween) {\r\n        this.currentTween.stop();\r\n    }\r\n}\r\n\r\n\r\n    /**\r\n     * Heading must always remain in the bounds: -2PI, 2PI\r\n     * Tilt must always remain in the bounds: -PI, PI\r\n     * @param state\r\n     */\r\n    applyLimits(state) {\r\n        if(state.tilt < 0) {\r\n            state.heading -= 180;\r\n            state.tilt = 0 - state.tilt;\r\n            this.sign = -this.sign;\r\n\r\n            if(state.roll === 180) {\r\n                state.roll = 0;\r\n            } else {\r\n                state.roll = 180;\r\n            }\r\n        } else if (state.tilt > 180) {\r\n            state.heading -= 180;\r\n            state.tilt = 180 - (state.tilt - 180);\r\n            this.sign = -this.sign;\r\n\r\n            if(state.roll === 180) {\r\n                state.roll = 0;\r\n            } else {\r\n                state.roll = 180;\r\n            }\r\n        } else if (state.tilt > 100) {\r\n            state.tilt = 100;\r\n        }\r\n\r\n        if(state.heading < 0) {\r\n            state.heading += 360;\r\n        } else if(state.heading > 360) {\r\n            state.heading -= 360;\r\n        }\r\n\r\n        if(state.roll > 180) {\r\n            state.roll -=  180;\r\n        } else if (state.roll < 0) {\r\n            state.roll += 180;\r\n        }\r\n\r\n        if(state.range >= (40 * state.lookAtLocation.altitude)) {\r\n            state.range = 40 * state.lookAtLocation.altitude;\r\n        }\r\n\r\n        if(state.range <= 230000) {\r\n            state.range = 230000;\r\n        }\r\n    };\r\n}\r\n\r\nexport default FixedPointController;","import WorldWind from 'webworldwind-esa';\r\nimport FixedPointController from \"./FixedPointController\";\r\nimport TWEEN from '@tweenjs/tween.js';\r\n\r\nconst {\r\n    BasicWorldWindowController,\r\n    WWMath,\r\n    Angle,\r\n    Vec2,\r\n} = WorldWind;\r\n\r\nclass EnabledController extends BasicWorldWindowController {\r\n    constructor(worldWindow) {\r\n        super(worldWindow);\r\n\r\n        this._enabled = true;\r\n        this._isFixed = false;\r\n\r\n        this.isAnimating = false;\r\n        this.animate = this.animate.bind(this);\r\n        this.handlePanOrDrag = this.handlePanOrDrag.bind(this);\r\n        this.animationId = null;\r\n        this.currentTween = null;\r\n\r\n        this.panEnd = 0;\r\n        this.startTimestamp = 0;\r\n        this.touchStart = 0;\r\n        this.touchStartPosition = [-1, -1];\r\n        this.touchEndPosition = [-1, -1];\r\n        this.lastDegrees = new Vec2(0, 0);\r\n        this.fixedController = new FixedPointController(worldWindow);\r\n    }\r\n\r\n    enable() {\r\n        this._enabled = true;\r\n    }\r\n\r\n    disable() {\r\n        this._enabled = false;\r\n    }\r\n\r\n    handlePanOrDrag(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                if (this.wwd.globe.is2D()) {\r\n                    super.handlePanOrDrag2D(recognizer);\r\n                } else {\r\n                    this.handlePanOrDrag3D(recognizer);\r\n                }\r\n            } else {\r\n                this.fixedController.handlePanOrDrag(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    handleFling(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleFling(recognizer);\r\n            } else {\r\n                this.fixedController.handleFling(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handlePinch(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handlePinch(recognizer);\r\n            } else {\r\n                this.fixedController.handlePinch(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleSecondaryDrag(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                this.handleSecondaryDrag(recognizer);\r\n            } else {\r\n                this.fixedController.handleSecondaryDrag(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleRotation(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleRotation(recognizer);\r\n            } else {\r\n                this.fixedController.handleRotation(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleTilt(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleTilt(recognizer);\r\n            } else {\r\n                this.fixedController.handleTilt(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleWheelEvent(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleWheelEvent(recognizer);\r\n            } else {\r\n                this.fixedController.handleWheelEvent(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    applyLimits() {\r\n        if(!this._isFixed) {\r\n            super.applyLimits()\r\n        } else {\r\n            this.fixedController.applyLimits(this.wwd.navigator);\r\n        }\r\n    }\r\n\r\n    handlePanOrDrag3D(recognizer) {\r\n        var state = recognizer.state,\r\n            tx = recognizer.translationX,\r\n            ty = recognizer.translationY;\r\n\r\n        if (state === WorldWind.BEGAN) {\r\n            this.lastPoint.set(0, 0);\r\n            this.startTimestamp = Date.now();\r\n\r\n            this.stopAnimation();\r\n        }\r\n        else if (state === WorldWind.CHANGED) {\r\n            // Convert the translation from screen coordinates to arc degrees. Use this navigator's range as a\r\n            // metric for converting screen pixels to meters, and use the globe's radius for converting from meters\r\n            // to arc degrees.\r\n            var canvas = this.wwd.canvas,\r\n                globe = this.wwd.globe,\r\n                globeRadius = WWMath.max(globe.equatorialRadius, globe.polarRadius),\r\n                distance = WWMath.max(1, this.wwd.navigator.range),\r\n                metersPerPixel = WWMath.perspectivePixelSize(canvas.clientWidth, canvas.clientHeight, distance),\r\n                forwardMeters = (ty - this.lastPoint[1]) * metersPerPixel,\r\n                sideMeters = -(tx - this.lastPoint[0]) * metersPerPixel,\r\n                forwardDegrees = (forwardMeters / globeRadius) * Angle.RADIANS_TO_DEGREES,\r\n                sideDegrees = (sideMeters / globeRadius) * Angle.RADIANS_TO_DEGREES;\r\n\r\n            // Apply the change in latitude and longitude to this navigator, relative to the current heading.\r\n            var sinHeading = Math.sin(this.wwd.navigator.heading * Angle.DEGREES_TO_RADIANS),\r\n                cosHeading = Math.cos(this.wwd.navigator.heading * Angle.DEGREES_TO_RADIANS);\r\n\r\n            this.wwd.navigator.lookAtLocation.latitude += forwardDegrees * cosHeading - sideDegrees * sinHeading;\r\n            this.wwd.navigator.lookAtLocation.longitude += forwardDegrees * sinHeading + sideDegrees * cosHeading;\r\n            this.lastPoint.set(tx, ty);\r\n            this.lastDegrees.set(forwardDegrees, sideDegrees);\r\n            this.applyLimits();\r\n            this.wwd.redraw();\r\n        }\r\n        else if (state === WorldWind.ENDED) {\r\n            this.panEnd = Date.now();\r\n            var isContinuous = false;\r\n            if (this.isContinuousInertial()) {\r\n                isContinuous = true;\r\n            }\r\n            else if (this.panEnd - this.startTimestamp > 150) {\r\n                return;\r\n            }\r\n\r\n            this.stopAnimation();\r\n\r\n            var animated = {\r\n                tx: this.lastDegrees[0],\r\n                ty: this.lastDegrees[1]\r\n            };\r\n\r\n            var to = {\r\n                tx: 0,\r\n                ty: 0\r\n            };\r\n\r\n            var animationDuration = isContinuous ? Infinity : 1500;\r\n            this.touchStart = 0;\r\n            this.touchStartPosition[0] = -1;\r\n            this.touchStartPosition[0] = -1;\r\n            this.touchEndPosition[0] = -1;\r\n            this.touchEndPosition[1] = -1;\r\n\r\n            this.currentTween = new TWEEN.Tween(animated)\r\n                .to(to, animationDuration)\r\n                .easing(TWEEN.Easing.Sinusoidal.Out)\r\n                .onStart(() => {\r\n                    this.beginHeading = this.wwd.navigator.heading;\r\n                    this.beginTilt = this.wwd.navigator.tilt;\r\n                })\r\n                .onUpdate(() => {\r\n                    if (!isFinite(animated.tx) && !isFinite(animated.ty)) {\r\n                        this.stopAnimation();\r\n                        return;\r\n                    }\r\n\r\n                    var sinHeading = Math.sin(this.wwd.navigator.heading * Angle.DEGREES_TO_RADIANS),\r\n                        cosHeading = Math.cos(this.wwd.navigator.heading * Angle.DEGREES_TO_RADIANS);\r\n\r\n                    this.wwd.navigator.lookAtLocation.latitude += animated.tx * cosHeading - animated.ty * sinHeading;\r\n                    this.wwd.navigator.lookAtLocation.longitude += animated.tx * sinHeading + animated.ty * cosHeading;\r\n\r\n                    this.applyLimits();\r\n                    this.wwd.redraw();\r\n                })\r\n                .onComplete(() => {\r\n                    this.stopAnimation();\r\n                })\r\n                .onStop(() => {\r\n                    this.stopAnimation();\r\n                })\r\n                .start();\r\n\r\n            this.animate();\r\n        }\r\n    }\r\n\r\n    handleSecondaryDrag(recognizer) {\r\n        var state = recognizer.state,\r\n            tx = recognizer.translationX,\r\n            ty = recognizer.translationY;\r\n\r\n        if (state === WorldWind.BEGAN) {\r\n            this.beginHeading = this.wwd.navigator.heading;\r\n            this.beginTilt = this.wwd.navigator.tilt;\r\n            this.startTimestamp = Date.now();\r\n\r\n            this.stopAnimation();\r\n        }\r\n        else if (state === WorldWind.CHANGED) {\r\n            // Compute the current translation from screen coordinates to degrees. Use the canvas dimensions as a\r\n            // metric for converting the gesture translation to a fraction of an angle.\r\n            var headingDegrees = 180 * tx / this.wwd.canvas.clientWidth,\r\n                tiltDegrees = 90 * ty / this.wwd.canvas.clientHeight;\r\n\r\n            // Apply the change in heading and tilt to this navigator's corresponding properties.\r\n            this.wwd.navigator.heading = this.beginHeading + headingDegrees;\r\n            this.wwd.navigator.tilt = this.beginTilt + tiltDegrees;\r\n\r\n            this.lastPoint.set(headingDegrees, tiltDegrees);\r\n\r\n\r\n            this.applyLimits();\r\n            this.wwd.redraw();\r\n        }\r\n        else if (state === WorldWind.ENDED) {\r\n            this.panEnd = Date.now();\r\n\r\n            var isContinuous = false;\r\n            if (this.isContinuousInertial()) {\r\n                isContinuous = true;\r\n            }\r\n            else if (this.panEnd - this.startTimestamp > 150) {\r\n                return;\r\n            }\r\n\r\n            this.stopAnimation();\r\n\r\n            var animated = {\r\n                tx: this.lastPoint[0] / 5,\r\n                ty: this.lastPoint[1] / 8\r\n            };\r\n\r\n            var to = {\r\n                tx: 0,\r\n                ty: 0\r\n            };\r\n\r\n            var animationDuration = isContinuous ? Infinity : 1500;\r\n            this.touchStart = 0;\r\n            this.touchStartPosition[0] = -1;\r\n            this.touchStartPosition[0] = -1;\r\n            this.touchEndPosition[0] = -1;\r\n            this.touchEndPosition[1] = -1;\r\n\r\n            this.currentTween = new TWEEN.Tween(animated)\r\n                .to(to, animationDuration)\r\n                .easing(TWEEN.Easing.Sinusoidal.Out)\r\n                .onStart(() => {\r\n                    this.beginHeading = this.wwd.navigator.heading;\r\n                    this.beginTilt = this.wwd.navigator.tilt;\r\n                })\r\n                .onUpdate(() => {\r\n                    if (!isFinite(animated.tx) && !isFinite(animated.ty)) {\r\n                        this.stopAnimation();\r\n                        return;\r\n                    }\r\n\r\n                    this.wwd.navigator.heading += animated.tx;\r\n                    this.wwd.navigator.tilt += animated.ty;\r\n \r\n                    this.applyLimits();\r\n                    this.wwd.redraw();\r\n                })\r\n                .onComplete(() => {\r\n                    this.stopAnimation();\r\n                })\r\n                .onStop(() => {\r\n                    this.stopAnimation();\r\n                })\r\n                .start();\r\n\r\n            this.animate();\r\n        }\r\n    }\r\n\r\n    isContinuousInertial() {\r\n        const longPressTime = this.startTimestamp - this.touchStart;\r\n        const travelTime = this.panEnd - this.startTimestamp;\r\n        return (\r\n            !this.preventContinuousInnertial &&\r\n            this.touchStart !== 0 &&\r\n            this.startTimestamp !== 0 &&\r\n            this.panEnd !== 0 &&\r\n            longPressTime >= 2000 &&\r\n            travelTime <= 150\r\n        );\r\n    }\r\n\r\n    animate() {\r\n        this.animationId = requestAnimationFrame(this.animate);\r\n        this.isAnimating = true;\r\n        TWEEN.update();\r\n    }\r\n\r\n    stopAnimation() {\r\n        TWEEN.removeAll();\r\n        window.cancelAnimationFrame(this.animationId);\r\n        this.isAnimating = false;\r\n        if (this.currentTween) {\r\n            this.currentTween.stop();\r\n        }\r\n    }\r\n}\r\n\r\nexport default EnabledController;","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    Angle,\r\n    ArcBallCamera,\r\n    WWMath\r\n} = WorldWind;\r\n\r\nclass FreeCamera extends ArcBallCamera {\r\n    constructor(wwd) {\r\n        super(wwd);\r\n\r\n        this._isFixed = false;\r\n    }\r\n\r\n    applyLimits() {\r\n        // Clamp latitude to between -90 and +90, and normalize longitude to between -180 and +180.\r\n        this.position.latitude = WWMath.clamp(this.position.latitude, -90, 90);\r\n        this.position.longitude = Angle.normalizedDegreesLongitude(this.position.longitude);\r\n\r\n        // Clamp altitude to values greater than 0 in order to prevent looking undergound.\r\n        this.position.altitude = WWMath.clamp(this.position.altitude, 0, Number.MAX_VALUE);\r\n\r\n        // Normalize heading to between -180 and +180.\r\n        this.heading = Angle.normalizedDegrees(this.heading);\r\n\r\n        if(!this._isFixed) {\r\n            // Clamp tilt to between 0 and +90 to prevent the viewer from going upside down.\r\n            this.tilt = WWMath.clamp(this.tilt, 0, 90);\r\n        } else {\r\n            this.tilt = WWMath.clamp(this.tilt, 0, 180);\r\n        }\r\n\r\n        // Normalize roll to between -180 and +180.\r\n        this.roll = Angle.normalizedDegrees(this.roll);\r\n    }\r\n}\r\n\r\nexport default FreeCamera;","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    ArgumentError,\r\n    Location,\r\n    Logger,\r\n    Position,\r\n    Vec3\r\n} = WorldWind;\r\n\r\nclass Animator {\r\n    /**\r\n     * Constructs a GoTo animator.\r\n     * @alias GoToAnimator\r\n     * @constructor\r\n     * @classdesc Incrementally and smoothly moves a {@link Navigator} to a specified position.\r\n     * @param {WorldWindow} worldWindow The WorldWindow in which to perform the animation.\r\n     * @throws {ArgumentError} If the specified WorldWindow is null or undefined.\r\n     */\r\n    constructor(worldWindow) {\r\n        if (!worldWindow) {\r\n            throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"GoToAnimator\", \"constructor\",\r\n                \"missingWorldWindow\"));\r\n        }\r\n\r\n        /**\r\n         * The WorldWindow associated with this animator.\r\n         * @type {WorldWindow}\r\n         * @readonly\r\n         */\r\n        this.wwd = worldWindow;\r\n\r\n        /**\r\n         * The frequency in milliseconds at which to animate the position change.\r\n         * @type {Number}\r\n         * @default 20\r\n         */\r\n        this.animationFrequency = 20;\r\n\r\n        /**\r\n         * The animation's duration, in milliseconds. When the distance is short, less than twice the viewport\r\n         * size, the travel time is reduced proportionally to the distance to travel. It therefore takes less\r\n         * time to move shorter distances.\r\n         * @type {Number}\r\n         * @default 3000\r\n         */\r\n        this.travelTime = 3000;\r\n\r\n        /**\r\n         * Indicates whether the current or most recent animation has been cancelled. Use the cancel() function\r\n         * to cancel an animation.\r\n         * @type {Boolean}\r\n         * @default false\r\n         * @readonly\r\n         */\r\n        this.cancelled = false;\r\n    }\r\n\r\n    cancel() {\r\n        this.cancelled = true;\r\n    }\r\n\r\n    /**\r\n     * Moves the navigator to a specified location or position.\r\n     * @param {Location | Position} position The location or position to move the navigator to. If this\r\n     * argument contains an \"altitude\" property, as {@link Position} does, the end point of the navigation is\r\n     * at the specified altitude. Otherwise the end point is at the current altitude of the navigator.\r\n     * @param fromSatellite\r\n     * @param toSatellite\r\n     * @param {Function} completionCallback If not null or undefined, specifies a function to call when the\r\n     * animation completes. The completion callback is called with a single argument, this animator.\r\n     * @throws {ArgumentError} If the specified location or position is null or undefined.\r\n     */\r\n    goTo(position, finalRange, completionCallback) {\r\n        if (!position) {\r\n            throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"GoToAnimator\", \"goTo\",\r\n                \"missingPosition\"));\r\n        }\r\n\r\n        // I need to build a simple navigator, which takes the Great Circle Distance between the current state and\r\n        // the next state and then gradually moves to the new state. It will be done in a simple linear way.\r\n\r\n        // What is the difference between\r\n        const heading = this.wwd.navigator.heading;\r\n        const rotation = this.wwd.navigator.roll;\r\n        const tilt = this.wwd.navigator.tilt;\r\n        const range = finalRange - this.wwd.navigator.range;\r\n        this.finalRange = finalRange;\r\n\r\n        // Get gradually to the range that represents the altitude of the satellite.\r\n\r\n        this.completionCallback = completionCallback;\r\n\r\n        // Reset the cancellation flag.\r\n        this.cancelled = false;\r\n\r\n        this.wwd.navigator.lookAtLocation.altitude = position.altitude || 0;\r\n\r\n        // Capture the target position and determine its altitude.\r\n        this.targetPosition = new Position(position.latitude, position.longitude, this.wwd.navigator.range);\r\n\r\n        // Capture the start position and start time.\r\n        this.startPosition = new Position(\r\n            this.wwd.navigator.lookAtLocation.latitude,\r\n            this.wwd.navigator.lookAtLocation.longitude,\r\n            this.wwd.navigator.lookAtLocation.altitude + this.wwd.navigator.range);\r\n        this.startTime = Date.now();\r\n\r\n        // Determination of the pan and range velocities requires the distance to be travelled.\r\n        var animationDuration = this.travelTime,\r\n            panDistance = Location.greatCircleDistance(this.startPosition, this.targetPosition),\r\n            rangeDistance;\r\n\r\n        // Determine how high we need to go to give the user context. The max altitude computed is approximately\r\n        // that needed to fit the start and end positions in the same viewport assuming a 45 degree field of view.\r\n        var pA = this.wwd.globe.computePointFromLocation(\r\n            this.startPosition.latitude, this.startPosition.longitude, new Vec3(0, 0, 0)),\r\n            pB = this.wwd.globe.computePointFromLocation(\r\n                this.targetPosition.latitude, this.targetPosition.longitude, new Vec3(0, 0, 0));\r\n        this.maxAltitude = pA.distanceTo(pB);\r\n\r\n        // Determine an approximate viewport size in radians in order to determine whether we actually change\r\n        // the range as we pan to the new location. We don't want to change the range if the distance between\r\n        // the start and target positions is small relative to the current viewport.\r\n        var viewportSize = this.wwd.pixelSizeAtDistance(this.startPosition.altitude)\r\n            * this.wwd.canvas.clientWidth / this.wwd.globe.equatorialRadius;\r\n\r\n        if (panDistance <= 2 * viewportSize) {\r\n            // Start and target positions are close, so don't back out.\r\n            this.maxAltitude = this.startPosition.altitude;\r\n        }\r\n\r\n        // We need to capture the time the max altitude is reached in order to begin decreasing the range\r\n        // midway through the animation. If we're already above the max altitude, then that time is now since\r\n        // we don't back out if the current altitude is above the computed max altitude.\r\n        this.maxAltitudeReachedTime = this.maxAltitude <= this.wwd.navigator.range ? Date.now() : null;\r\n\r\n        // Compute the total range to travel since we need that to compute the range velocity.\r\n        // Note that the range velocity and pan velocity are computed so that the respective animations, which\r\n        // operate independently, finish at the same time.\r\n        if (this.maxAltitude > this.startPosition.altitude) {\r\n            rangeDistance = Math.max(0, this.maxAltitude - this.startPosition.altitude);\r\n            rangeDistance += Math.abs(this.targetPosition.altitude - this.maxAltitude);\r\n        } else {\r\n            rangeDistance = Math.abs(this.targetPosition.altitude - this.startPosition.altitude);\r\n        }\r\n\r\n        // Determine which distance governs the animation duration.\r\n        var animationDistance = Math.max(panDistance, rangeDistance / this.wwd.globe.equatorialRadius);\r\n        if (animationDistance === 0) {\r\n            return; // current and target positions are the same\r\n        }\r\n\r\n        if (animationDistance < 2 * viewportSize) {\r\n            // Start and target positions are close, so reduce the travel time based on the\r\n            // distance to travel relative to the viewport size.\r\n            animationDuration = Math.min((animationDistance / viewportSize) * this.travelTime, this.travelTime);\r\n        }\r\n\r\n        // Don't let the animation duration go to 0.\r\n        animationDuration = Math.max(1, animationDuration);\r\n\r\n        // Determine the pan velocity, in radians per millisecond.\r\n        this.panVelocity = panDistance / animationDuration;\r\n\r\n        // Determine the range velocity, in meters per millisecond.\r\n        this.rangeVelocity = rangeDistance / animationDuration; // meters per millisecond\r\n\r\n        this.headingVelocity = heading / animationDuration;\r\n        this.rotationVelocity = rotation / animationDuration;\r\n        this.tiltVelocity = tilt / animationDuration;\r\n        this.rangeVelocity = range / animationDuration;\r\n\r\n        // Set up the animation timer.\r\n        var thisAnimator = this;\r\n        var timerCallback = function () {\r\n            if (thisAnimator.cancelled) {\r\n                if (thisAnimator.completionCallback) {\r\n                    thisAnimator.completionCallback(thisAnimator);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (thisAnimator.update()) {\r\n                setTimeout(timerCallback, thisAnimator.animationFrequency);\r\n            } else if (thisAnimator.completionCallback) {\r\n                thisAnimator.completionCallback(thisAnimator);\r\n            }\r\n        };\r\n        setTimeout(timerCallback, this.animationFrequency); // invoke it the first time\r\n    };\r\n\r\n    // Intentionally not documented.\r\n    update() {\r\n        // This is the timer callback function. It invokes the range animator and the pan animator.\r\n\r\n        var currentPosition = new Position(\r\n            this.wwd.navigator.lookAtLocation.latitude,\r\n            this.wwd.navigator.lookAtLocation.longitude,\r\n            this.wwd.navigator.range);\r\n\r\n        var continueAnimation = this.updateRange(currentPosition);\r\n        continueAnimation = this.updateLocation(currentPosition) || continueAnimation;\r\n        continueAnimation = this.updateTilt() || continueAnimation;\r\n        continueAnimation = this.updateHeading() || continueAnimation;\r\n        continueAnimation = this.updateRotation() || continueAnimation;\r\n\r\n        this.wwd.redraw();\r\n\r\n        return continueAnimation;\r\n    };\r\n\r\n    updateTilt() {\r\n        this.wwd.navigator.tilt -= this.tiltVelocity;\r\n\r\n        return this.wwd.navigator.tilt > 0;\r\n    }\r\n\r\n    updateHeading() {\r\n        this.wwd.navigator.heading -= this.headingVelocity;\r\n\r\n        return this.wwd.navigator.heading > 0;\r\n    }\r\n\r\n    updateRotation() {\r\n        this.wwd.navigator.roll -= this.rotationVelocity;\r\n\r\n        return this.wwd.navigator.roll > 0;\r\n    }\r\n\r\n    // This breaks something and I have no idea why.\r\n    updateRange() {\r\n        this.wwd.navigator.range -= this.rangeVelocity;\r\n\r\n        return Math.abs(this.finalRange - this.wwd.navigator.range) < 10;\r\n    }\r\n\r\n    // Gradually change the tilt, heading and rotation to 0. Even during the short time.\r\n    // Intentionally not documented.\r\n    updateRange(currentPosition) {\r\n        // This function animates the range.\r\n        var continueAnimation = false,\r\n            nextRange, elapsedTime;\r\n\r\n        // If we haven't reached the maximum altitude, then step-wise increase it. Otherwise step-wise change\r\n        // the range towards the target altitude.\r\n        if (!this.maxAltitudeReachedTime) {\r\n            elapsedTime = Date.now() - this.startTime;\r\n            nextRange = Math.min(this.startPosition.altitude + this.rangeVelocity * elapsedTime, this.maxAltitude);\r\n            // We're done if we get withing 1 meter of the desired range.\r\n            if (Math.abs(this.wwd.navigator.range - nextRange) < 1) {\r\n                this.maxAltitudeReachedTime = Date.now();\r\n            }\r\n            this.wwd.navigator.range = nextRange;\r\n            continueAnimation = true;\r\n        } else {\r\n            elapsedTime = Date.now() - this.maxAltitudeReachedTime;\r\n            if (this.maxAltitude > this.targetPosition.altitude) {\r\n                nextRange = this.maxAltitude - (this.rangeVelocity * elapsedTime);\r\n                nextRange = Math.max(nextRange, this.targetPosition.altitude);\r\n            } else {\r\n                nextRange = this.maxAltitude + (this.rangeVelocity * elapsedTime);\r\n                nextRange = Math.min(nextRange, this.targetPosition.altitude);\r\n            }\r\n            this.wwd.navigator.range = nextRange;\r\n            // We're done if we get withing 1 meter of the desired range.\r\n            continueAnimation = Math.abs(this.wwd.navigator.range - this.targetPosition.altitude) > 1;\r\n        }\r\n\r\n        return continueAnimation;\r\n    };\r\n\r\n    // Intentionally not documented.\r\n    updateLocation(currentPosition) {\r\n        // This function animates the pan to the desired location.\r\n        var elapsedTime = Date.now() - this.startTime,\r\n            distanceTravelled = Location.greatCircleDistance(this.startPosition, currentPosition),\r\n            distanceRemaining = Location.greatCircleDistance(currentPosition, this.targetPosition),\r\n            azimuthToTarget = Location.greatCircleAzimuth(currentPosition, this.targetPosition),\r\n            distanceForNow = this.panVelocity * elapsedTime,\r\n            nextDistance = Math.min(distanceForNow - distanceTravelled, distanceRemaining),\r\n            nextLocation = Location.greatCircleLocation(currentPosition, azimuthToTarget, nextDistance,\r\n                new Location(0, 0)),\r\n            locationReached = false;\r\n\r\n        this.wwd.navigator.lookAtLocation.latitude = nextLocation.latitude;\r\n        this.wwd.navigator.lookAtLocation.longitude = nextLocation.longitude;\r\n\r\n        // We're done if we're within a meter of the desired location.\r\n        if (nextDistance < 1 / this.wwd.globe.equatorialRadius) {\r\n            locationReached = true;\r\n        }\r\n\r\n        return !locationReached;\r\n    };\r\n}\r\n\r\nexport default Animator;","import React, { Component } from 'react';\r\nimport PropTypes from \"prop-types\";\r\nimport WorldWindow from '../../worldwind/WorldWindow';\r\nimport WorldWind from 'webworldwind-esa';\r\nimport ClickPickController from './utils/ClickPickController';\r\nimport decorateWorldWindowController from './controllers/WorldWindowControllerDecorator';\r\nimport navigator from './navigator/helpers';\r\nimport {isEqual, isEmpty} from 'lodash';\r\nimport {\r\n    getLayers,\r\n    getLayerKeyFromConfig,\r\n    getLayerIdFromConfig,\r\n    reloadLayersRenderable,\r\n} from './layers';\r\nimport './style.css';\r\nimport EnabledController from \"../../worldwind/EnabledController\";\r\nimport FreeCamera from '../../worldwind/FreeCamera';\r\nimport Animator from '../../worldwind/Animator';\r\n\r\nconst {\r\n    EarthElevationModel\r\n} = WorldWind;\r\n\r\nexport const defaultMapView = {\r\n\tcenter: {\r\n\t\tlat: 50.099577,\r\n\t\tlon: 14.425960\r\n\t},\r\n\tboxRange: 10000000,\r\n\ttilt: 0,\r\n\troll: 0,\r\n\theading: 0\r\n};\r\n\r\nconst MINRANGE = 3000;\r\nconst MAXRANGE = 100000000;\r\n\r\n/**\r\n * This component displays Web World Wind in the application. In order to decide what will the map look like and what\r\n * should be displayed on top of that it is possible to work with the wwd inside of the copmonentDidMount, where the\r\n * Web World Wind instance is also created.\r\n */\r\nclass Map extends Component {\r\n    static propsTypes = {\r\n        onLayerChanged: PropTypes.func,\r\n        onProductsClick: PropTypes.func,\r\n        searchOnCoords: PropTypes.func,\r\n        onViewChange: PropTypes.func,\r\n        view: PropTypes.object,\r\n        layers: PropTypes.array,\r\n        preventReload: PropTypes.bool,\r\n        time: PropTypes.object, //select time\r\n        currentTime: PropTypes.object, //current time\r\n    }\r\n\r\n    static defaultProps = {    \r\n        onLayerChanged: () => {},\r\n        onProductsClick: () => {},\r\n        searchOnCoords: () => {},\r\n        onViewChange: () => {},\r\n        layers: [],\r\n        view: {},\r\n    }\r\n    constructor(props){\r\n        super(props);\r\n        this.wwd = null;\r\n        this.wwdCreated = false;\r\n    }\r\n\r\n    componentDidUpdate (prevProps) {\r\n        const {time, currentTime, view, onLayerChanged, preventReload, viewFixed} = this.props;\r\n\r\n        if (view && prevProps.view !== view) {\r\n            this.updateNavigator(null);\r\n        }\r\n\r\n        if (viewFixed !== prevProps.viewFixed) {\r\n            this.updateViewFixed(viewFixed);\r\n        }\r\n        \r\n        const enabledLayersKeys = this.props.layers.filter(l => !l.disabled);\r\n\r\n        if(prevProps.layers !== this.props.layers) {\r\n            const prevVisibleLayers = new Set([\r\n                ...prevProps.layers.map((l) => getLayerKeyFromConfig(l)).sort(),\r\n            ])\r\n\r\n            const visibleLayers = new Set([\r\n                ...this.props.layers.map((l) => getLayerKeyFromConfig(l)).sort(),\r\n            ])\r\n            \r\n            // layer ID is composed by layer, satellite, end date, start date\r\n            const prevLayers = new Set([\r\n                ...prevProps.layers.map((l) => getLayerIdFromConfig(l)).sort(),\r\n            ]);\r\n\r\n            const Layers = new Set([\r\n                ...this.props.layers.map((l) => getLayerIdFromConfig(l)).sort(),\r\n            ])\r\n\r\n            // layer ID is composed by layer, satellite, end date, start date\r\n            const disabledPrevLayers = new Set(prevProps.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l)).sort())\r\n            const disabledLayers = new Set(this.props.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l)).sort())\r\n\r\n            const visibilityChanged = !isEqual(prevVisibleLayers, visibleLayers);\r\n            const newlyEnabledLayersKeys = [...visibleLayers].filter(l => !prevVisibleLayers.has(l));\r\n            //check visibility change\r\n            if(visibilityChanged && !newlyEnabledLayersKeys.some(lk => disabledLayers.has(lk))) {\r\n                //visibility changed\r\n                const wwdLayers = getLayers(enabledLayersKeys, time, this.wwd, onLayerChanged, currentTime);\r\n                this.handleLayers(wwdLayers);\r\n                \r\n                //start loading layer\r\n                //reload only new layers\r\n                \r\n                const newlyEnabledLayersCfg = this.props.layers.filter((cfg) => newlyEnabledLayersKeys.includes(getLayerKeyFromConfig(cfg)));\r\n                reloadLayersRenderable(newlyEnabledLayersCfg, wwdLayers, this.wwd, onLayerChanged, this.onRendarableAdd.bind(this));\r\n            }  else if(!isEqual(disabledPrevLayers, disabledLayers)) {\r\n                //disabled changed\r\n                const disabledLayersKeys = this.props.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l));\r\n                const disabledPrevLayersKeys = prevProps.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l));\r\n                const enabledLayersKeys = this.props.layers.filter(l => !l.disabled).map((l) => getLayerKeyFromConfig(l));\r\n                const newlyEnabledLayersKeys = disabledPrevLayersKeys.filter(l => enabledLayersKeys.includes(l));\r\n                const wwdLayers = getLayers(this.props.layers, time, this.wwd, onLayerChanged, currentTime);\r\n\r\n                wwdLayers.forEach(l => {\r\n                    if(newlyEnabledLayersKeys.includes(l.displayName)) {\r\n                        l.enabled = true;\r\n                    };\r\n\r\n                    if(disabledLayersKeys.includes(l.displayName)) {\r\n                        l.enabled = false;\r\n                    };\r\n                    //redraw\r\n                    this.wwd.redraw();\r\n                })\r\n            } else if(time.toString() !== prevProps.time.toString() || currentTime.toString() !== prevProps.currentTime.toString()) {\r\n                const notDisabledLayers = this.props.layers.filter(l => !l.disabled);\r\n                const wwdLayers = getLayers(notDisabledLayers, time, this.wwd, onLayerChanged, currentTime);\r\n                this.handleLayers(wwdLayers);\r\n                \r\n            }\r\n            \r\n            if(!visibilityChanged && !isEqual(prevLayers, Layers)) {\r\n                //layers date changed\r\n                //TODO reload only changed layers\r\n                const wwdLayers = getLayers(enabledLayersKeys, time, this.wwd, onLayerChanged, currentTime);\r\n                if(!preventReload) {\r\n                    reloadLayersRenderable(enabledLayersKeys, wwdLayers, this.wwd, onLayerChanged, this.onRendarableAdd.bind(this));\r\n                }\r\n            }\r\n        }\r\n        \r\n        if(prevProps.preventReload !== preventReload && !preventReload) {\r\n            const disabledLayersKeys = this.props.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l));\r\n            const wwdLayers = getLayers(enabledLayersKeys, time, this.wwd, onLayerChanged, currentTime);\r\n            //dont reload disabled layers\r\n            reloadLayersRenderable(enabledLayersKeys.filter(lk => !disabledLayersKeys.includes(lk)), wwdLayers, this.wwd, onLayerChanged, this.onRendarableAdd.bind(this));\r\n        }\r\n    }\r\n\r\n    handleLayers(nextLayersData = []) {\r\n        if(nextLayersData !== this.wwd.layers) {\r\n            this.wwd.layers = nextLayersData;\r\n            this.wwd.redraw();\r\n        }\r\n    }\r\n    \r\n    onRendarableAdd() {\r\n        const {time, currentTime, view, onLayerChanged, preventReload} = this.props;\r\n        const wwdLayers = getLayers(this.props.layers, time, this.wwd, onLayerChanged, currentTime);\r\n        this.handleLayers(wwdLayers);\r\n        \r\n    }\r\n\r\n    longClickHandler(clickedRenderables = [], evt, x, y, time, type) {\r\n        const {searchOnCoords} = this.props;\r\n        const terrainPick = this.wwd.pickTerrain([x, y]);\r\n        if(type === 'timeoutClick' && terrainPick && terrainPick.objects && terrainPick.objects[0]){\r\n            const terrainCoords = terrainPick.objects[0].position;\r\n            //searchOnCoords\r\n            searchOnCoords(terrainCoords);\r\n        }\r\n    }\r\n\r\n    clickHandler(clickedRenderables = [], evt) {\r\n        const renderables = clickedRenderables.objects.filter(r => {\r\n\t\t\treturn !r.isTerrain;\r\n        }).reverse();\r\n        const products = new Set();\r\n\r\n        renderables.forEach(r => {\r\n            // products.add(r.parentLayer.displayName);\r\n            products.add(r.userObject.userProperties.key);\r\n        })\r\n\r\n        if(products.size > 0) {\r\n            this.props.onProductsClick([...products]);\r\n        }\r\n    }\r\n\r\n    // Handler called after user interaction\r\n    onNavigatorChange(event) {\r\n        const {view} = this.props;\r\n\t\tif (event) {\r\n            const viewParams = navigator.getViewParamsFromWorldWindNavigator(event);\r\n            \r\n            const changedViewParams = navigator.getChangedViewParams({...defaultMapView, ...view}, viewParams);\r\n            \r\n            if(changedViewParams.boxRange < MINRANGE){\r\n                changedViewParams.boxRange = MINRANGE;\r\n            }\r\n\r\n            if(changedViewParams.boxRange > MAXRANGE){\r\n                changedViewParams.boxRange = MAXRANGE;\r\n            }\r\n\r\n\t\t\tif(this.props.onViewChange) {\r\n\t\t\t\tif (!isEmpty(changedViewParams)) {\r\n                    this.props.onViewChange(changedViewParams);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n    /**\r\n     * In this method we create the Web World Wind component itself and store it in the state for the later usage.\r\n     */\r\n    componentDidMount(){\r\n        const {time, currentTime, onLayerChanged} = this.props;\r\n        if(!this.wwdCreated) {\r\n            const elevationModel = new EarthElevationModel();\r\n            this.wwd = new WorldWindow(\"wwd-results\", elevationModel, EnabledController, FreeCamera);\r\n            \r\n            decorateWorldWindowController(this.wwd.worldWindowController);\r\n            this.wwd.worldWindowController.onNavigatorChanged = this.onNavigatorChange.bind(this);\r\n\r\n            if(this.wwd.worldWindowController.fixedController) {\r\n                decorateWorldWindowController(this.wwd.worldWindowController.fixedController);\r\n                this.wwd.worldWindowController.fixedController.onNavigatorChanged = this.onNavigatorChange.bind(this);\r\n            }\r\n\r\n            this.wwd.animator = new Animator(this.wwd);\r\n            this.wwd.deepPicking = true;\r\n\r\n            window.wwd = this.wwd;\r\n            this.pickController = new ClickPickController(this.wwd, this.clickHandler.bind(this));\r\n            this.longClickPickController = new ClickPickController(this.wwd, this.longClickHandler.bind(this), 1500, 1000, 1000);\r\n            this.wwdCreated=true;\r\n            const enabledLayers = this.props.layers.filter(l => !l.disabled);\r\n            const wwdLayers = getLayers(enabledLayers, time, this.wwd, onLayerChanged, currentTime);\r\n            this.handleLayers(wwdLayers);\r\n            this.updateNavigator(defaultMapView);\r\n        }\r\n    }\r\n\r\n    // Apply changed mapView into WWW navigator\r\n\tupdateNavigator(defaultView) {\r\n        const {view} = this.props;\r\n        let currentView = defaultView || navigator.getViewParamsFromWorldWindNavigator(this.wwd.navigator);\r\n        \r\n        let nextView = {...currentView, ...view};\r\n\r\n        //call onUpdateNavigator on each wwd layer\r\n        const layers = this.wwd.layers;\r\n        for (const layer of layers) {\r\n            if(layer.onUpdateNavigator && typeof layer.onUpdateNavigator === 'function') {\r\n                layer.onUpdateNavigator(nextView);\r\n            }\r\n        }\r\n\r\n\t\tnavigator.update(this.wwd, nextView);\r\n    }\r\n    \r\n    updateViewFixed(viewFixed) {\r\n        navigator.updateFixedView(this.wwd, viewFixed);\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div id=\"map\">\r\n                <canvas id=\"wwd-results\" style={{\r\n                    width: \"100%\",\r\n                    height: \"100%\"\r\n                }}></canvas>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Map;","import types from '../../../types';\n\nimport {loadLatestProducts} from '../../../../components/WorldWindMap/layers';\nimport select from '../../../selectors/';\nimport {changeSelectTime} from '../../../actions';\nimport {getActiveSatProductsPairs} from '../../../selectors/rootSelectors'\n\nconst componentID = 'searchToolbar';\nexport const setGeometry = (geometry) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: componentID,\n        path: 'geometry',\n        value: geometry,\n    };\n};\n\nexport const setActiveIndex = (index) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: componentID,\n        path: 'activeOrderedResultIndex',\n        value: index,\n    };\n};\n\nexport const setLoading = (loading) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: componentID,\n        path: 'loading',\n        value: loading,\n    };\n};\n\nexport const setActiveIndexAndUpdateTime = (dispatch, state, index) => {\n    const product = select.components.searchToolbar.getResultByIndex(state, index);\n    if(product) {\n        dispatch(setActiveIndex(index));\n        const productTime = getResultMiddleDate(product).toUTCString();\n        dispatch(changeSelectTime(productTime, dispatch, select.rootSelectors.getSelectTime(state), state));\n    } else {\n        dispatch(setActiveIndex(null));\n    }\n};\n\nexport const clearComponent = () => {\n    return {\n        type: types.COMPONENTS.SEARCH_TOOLBAR.CLEAR,\n    };\n};\n\nconst getResultBeginDate = (result) => {\n    const beginPositionIndex = result.date.findIndex((d) => d.name === 'beginposition');\n    const strDate = result.date[beginPositionIndex].content;\n    return strDate ? new Date(strDate) : null;\n}\n\nconst getResultEndDate = (result) => {\n    const beginPositionIndex = result.date.findIndex((d) => d.name === 'endposition');\n    const strDate = result.date[beginPositionIndex].content;\n    return strDate ? new Date(strDate) : null;\n}\n\nconst getResultMiddleDate = (result) => {\n    const beginDate = getResultBeginDate(result);\n    const endDate = getResultEndDate(result);\n\n    if(beginDate && endDate) {\n        const middleTime =  beginDate.getTime() + ((endDate.getTime() - beginDate.getTime()) / 2)\n        return new Date(middleTime);\n    } else {\n        return null;\n    }\n    \n}\n\n/**\n * \n * @param {Array} results [['s1b', [results]],...]\n */\nexport const saveResults = (results) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: componentID,\n        path: 'orderedResults',\n        value: results,\n    };\n}\n\n/**\n * \n * @param {Array} results [['s1b', [results]],...]\n */\nexport const orderResults = (results) => {\n    const allResults = results.map(r => r[1]).flat().filter((a) => a);\n    const sortedResults = [...allResults].sort((a, b) => {\n        const aTime = getResultBeginDate(a);\n        const bTime = getResultBeginDate(b);\n        if(aTime && bTime) {\n            return bTime.getTime() - aTime.getTime() ;\n        }\n    })\n\n    return sortedResults;\n}\n\nexport const updateSearch = async (dispatch, state) => {\n    const activeSatProductsPairs = getActiveSatProductsPairs(state);\n    const selectTime = select.rootSelectors.getSelectTime(state);\n    const geometry = select.components.searchToolbar.getGeometry(state);\n    if(activeSatProductsPairs && activeSatProductsPairs.length > 0 && geometry) {\n        const location = {latitude: geometry.latitude, longitude: geometry.longitude};\n        const promises = activeSatProductsPairs.map((pair) => {\n            return searchProducts(pair[0], pair[1], location, selectTime, 0);\n        });\n        dispatch(setLoading(true));\n        const results = await Promise.all(promises);\n        dispatch(setLoading(false));\n        const satResults = activeSatProductsPairs.map((pair, index) => [pair[0], results[index]]);\n        const orderedResults = satResults && orderResults(satResults);\n        if(satResults && satResults.length > 0 && orderedResults && orderedResults.length > 0) {\n            dispatch(saveResults(orderedResults));\n            dispatch(setActiveIndex(0));\n            //FIXME - disable now Tracking\n            dispatch(changeSelectTime(getResultMiddleDate(orderedResults[0]).toUTCString() ,dispatch,select.rootSelectors.getSelectTime(state), state));\n            // setActiveIndexAndUpdateTime(dispatch, state, 0);\n        } else {\n            dispatch(saveResults([]));\n            dispatch(setActiveIndex(null));                \n        }\n    } else {\n        //clear results\n        dispatch(saveResults([]));\n        dispatch(setActiveIndex(null));\n        //do nothing\n        return;\n    }\n;\n\n            \n            //display satName and product type in search toolbar\n            //move camera to product boundaries\n            //move select time to nearest product time\n\n    // const aps = await getAllAcquisitionPlans()\n    // dispatch(setAcquisitionPlans(aps));\n}\n\nconst searchProducts = async (satelliteId, productId, location, time, statrIndex) => {\n    const shortName = `${satelliteId[0].toUpperCase()}-${satelliteId.substring(1,3).toUpperCase()}`;\n    const endTime = time;\n    const beginTime = new Date(new Date(endTime).setYear(endTime.getUTCFullYear() - 1));\n    return await loadLatestProducts(shortName, [...productId], location, beginTime, endTime, statrIndex);\n}\n\nexport const setVisibility = (visible) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: componentID,\n        path: 'visible',\n        value: visible,\n    };\n};","import React from 'react';\r\nimport Presentation from './presentation';\r\nimport select from '../../context/selectors/';\r\nimport {withContext} from '../../context/withContext';\r\nimport {\r\n    updateActiveLayer,\r\n    updateInfoModal,\r\n    setActiveInfoModal,\r\n    dataUpdateAcquisitionPlan,\r\n    dataAcquisitionPlanSetVisibleCount,\r\n    // clearComponent,\r\n    // updateComponent,\r\n} from '../../context/actions';\r\n\r\nimport{\r\n    updateStatistics,\r\n} from '../../context/actions/map';\r\n\r\nimport{\r\n    setHeadingAndUpdateViewHeadingCorrection\r\n} from '../../context/actions/data/satellites/actions';\r\n\r\nimport {\r\n    setView,\r\n    updateMapView,\r\n} from '../../context/actions/map';\r\n\r\n// import {setGeometry} from '../../context/actions/components/searchForm/actions';\r\nimport {setGeometry, clearComponent, setVisibility, updateSearch} from '../../context/actions/components/searchToolbar';\r\n// import selectors from '../../context/selectors/';\r\n\r\nconst WorldWindMap = (props) => {\r\n    const {dispatch, state} = props;\r\n\r\n    const onLayerChanged = (layerKey, change) => {\r\n        if(layerKey && layerKey.layerKey && layerKey.layerKey.indexOf('acquisitionPlans_') === 0) {\r\n            if(change.plans && change.plans.length > 0) {\r\n                change.plans.forEach((url) => {\r\n                    dispatch(dataUpdateAcquisitionPlan(layerKey, change.sat, url, change.update));\r\n                });\r\n            };\r\n\r\n            if(change.hasOwnProperty('count')) {\r\n                dispatch(dataAcquisitionPlanSetVisibleCount(change.sat, change.count));\r\n            }\r\n        } else if(layerKey && layerKey.layerKey && layerKey.layerKey.indexOf('statistics_') === 0) {\r\n            //TODO -set statistics are loading\r\n            // dispatch(updateActiveLayer(layerKey, change))\r\n            dispatch(updateStatistics(layerKey.satKey, change));\r\n        } else if(layerKey && layerKey.type && layerKey.type === 'SatelliteModelLayer') {\r\n            //set heading to satellite\r\n            dispatch(setHeadingAndUpdateViewHeadingCorrection(layerKey.layerKey, change.update.heading));\r\n        } else {\r\n            dispatch(updateActiveLayer(layerKey, change))\r\n        }     \r\n    }\r\n\r\n    const onProductsClick = (products) => {\r\n        const {state} = props;\r\n\r\n        //if search form modal open, then terminate all clicks\r\n        const activeModalKey = select.rootSelectors.getActiveInfoModalKey(state);\r\n        const infoModal = select.rootSelectors.getInfoModal(state, activeModalKey);\r\n        if(infoModal && infoModal.type === 'SEARCH') {\r\n            return;\r\n        }\r\n\r\n        const modalKey = products.join(',');\r\n        const modalState = select.rootSelectors.getInfoModal(state, modalKey)\r\n        const open = modalState && modalState.open ? false : true;\r\n        const modalContent = {\r\n            type: 'PRODUCTS',\r\n            products,\r\n            open,\r\n        };\r\n        dispatch(updateInfoModal(modalKey, modalContent));\r\n        dispatch(setActiveInfoModal(modalKey));\r\n    }\r\n\r\n    const searchOnCoords = (coordinates) => {\r\n        const {state} = props;\r\n        \r\n        const geometry = {\r\n            latitude:coordinates.latitude,\r\n            longitude:coordinates.longitude,\r\n            altitude:coordinates.altitude\r\n        }\r\n\r\n\r\n        //open search toolbar component\r\n        dispatch(clearComponent());\r\n        dispatch(setVisibility(true));\r\n        dispatch(setGeometry(geometry));\r\n        // updateSearch(dispatch, state, geometry);\r\n       \r\n        // Old search\r\n        // const modalKey = `${coordinates.longitude}-${coordinates.latitude}`;\r\n        // const modalState = select.rootSelectors.getInfoModal(state, modalKey)\r\n        // const open = modalState && modalState.open ? false : true;\r\n        // const modalContent = {\r\n        //     type: 'SEARCH',\r\n        //     coordinates,\r\n        //     open,\r\n        // };\r\n        // //clear previous state\r\n        // dispatch(clearComponent('search'));\r\n\r\n        // const geometry = {\r\n        //     latitude:coordinates.latitude,\r\n        //     longitude:coordinates.longitude,\r\n        //     altitude:coordinates.altitude\r\n        // }\r\n\r\n        // dispatch(setGeometry(geometry));\r\n\r\n        // dispatch(updateInfoModal(modalKey, modalContent));\r\n        // dispatch(setActiveInfoModal(modalKey));\r\n        \r\n        // dispatch(updateComponent('timeline', {visible: false}));\r\n        // dispatch(updateComponent('timeWidget', {visible: false}));\r\n        // dispatch(updateComponent('satelliteSelect', {visible: false}));\r\n        \r\n    }\r\n\r\n    // prevent reloading layers while moving timeline\r\n    const timelineState = select.components.timeline.getSubstate(state);\r\n    const preventReloadLayers = select.rootSelectors.getPreventReloadLayers(state) || timelineState.moving;\r\n    const selectTime = select.rootSelectors.getSelectTime(state);\r\n    const currentTime = new Date(select.rootSelectors.getCurrentTime(state));\r\n    const focusedSatellite = select.rootSelectors.getFocusedSatellite(state);\r\n    const layers = select.rootSelectors.getActiveLayers(state, selectTime);\r\n    const view = select.map.getView(state);\r\n    const viewFixed = !!focusedSatellite;\r\n\r\n    const onViewChange = (view) => {\r\n        const mapView = select.map.getView(state);\r\n        const updateView = {...view};\r\n        const validHeadingCorrection = mapView.hasOwnProperty('headingCorrection') && (mapView.headingCorrection >= 0 || mapView.headingCorrection <= 0)\r\n        const validHeading = updateView.hasOwnProperty('heading') && (updateView.heading >= 0 || updateView.heading <= 0)\r\n        if(validHeadingCorrection && validHeading) {\r\n            updateView.heading += mapView.headingCorrection;\r\n        }\r\n        dispatch(updateMapView(updateView));\r\n    }\r\n\r\n    return (\r\n        <Presentation \r\n            viewFixed={viewFixed}\r\n            time={selectTime}\r\n            currentTime={currentTime}\r\n            layers = {layers}\r\n            onLayerChanged={onLayerChanged}\r\n            onProductsClick={onProductsClick}\r\n            searchOnCoords={searchOnCoords}\r\n            preventReload={preventReloadLayers}\r\n            onViewChange={onViewChange}\r\n            view={view}\r\n            />\r\n    )\r\n}\r\n\r\nexport default withContext(WorldWindMap);","import types from '../../../types';\n\n\nexport const setHeading = (satId, heading) => {\n    return {\n        type: types.DATA.SATELLITES.SET_HEADING,\n        id: satId,\n        heading: heading,\n    };\n};\n\nexport const setHeadingAndUpdateViewHeadingCorrection = (satId, heading) => {\n    return {\n        type: types.DATA.SATELLITES.SET_HEADING_AND_UPDATE_VIEW_HEADING_CORRECTION,\n        id: satId,\n        heading: heading,\n    };\n};","import React from 'react';// import { jsx } from '@emotion/core';\n\nconst SatelliteGroupOption = (props) => {\n  const {\n    children,\n    className,\n    cx,\n    getStyles,\n    Heading,\n    headingProps,\n    label,\n    theme,\n    selectProps,\n    data\n  } = props;\n  return (\n    <div style={getStyles('group', props)} className={cx({ group: true }, className)} >\n      <Heading\n        {...headingProps}\n        selectProps={selectProps}\n        theme={theme}\n        getStyles={getStyles}\n        cx={cx}\n        groupData={data.groupData}\n      >\n        {label}\n      </Heading>\n      <div>\n        {children}\n      </div>\n    </div>\n  );\n};\n\nexport const GroupHeading = (props) => {\n  const { className, cx, getStyles, theme, selectProps, ...cleanProps } = props;\n  return (\n    <div\n      css={getStyles('groupHeading', { theme, ...cleanProps })}\n      className={cx({ 'group-heading': true }, className)}\n      {...cleanProps}\n    />\n  );\n};\n\nexport default SatelliteGroupOption;","import React from 'react';\nimport './loaderStyle.css';\n\nconst Loader = (props) => {\n    return (<div className=\"loader\"></div>);\n}\n\nexport default React.memo(Loader)\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst styles = {\n  container: {},\n\n  badge: {\n    WebkitTransition: 'all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms',\n    MozTransition: 'all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms',\n    msTransition: 'all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms',\n    transition: 'all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms',\n    display: 'inline-block',\n    position: 'absolute',\n    minWidth: '10px',\n    padding: '3px 7px',\n    fontSize: '12px',\n    fontWeight: '700',\n    lineHeight: '1',\n    color: '#fff',\n    textAlign: 'center',\n    whiteSpace: 'nowrap',\n    verticalAlign: 'baseline',\n    backgroundColor: 'rgba(212, 19, 13, 1)',\n    borderRadius: '10px',\n    top: '-1px',\n  },\n};\n\nclass NotificationBadge extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    const badgeStyle = this.merge(styles.badge, this.props.style);\n    const containerStyle = this.merge(styles.container, this.props.containerStyle);\n    const value = this.props.label || this.props.count;\n\n    return (\n      <div style={containerStyle}>\n        <span style={badgeStyle} className={this.props.className}>\n            {value}\n        </span>\n      </div>\n    );\n  }\n\n  merge(obj1, obj2) {\n    const obj = {};\n    for (const attrname1 in obj1) {\n      if (obj1.hasOwnProperty(attrname1)) {\n        obj[attrname1] = obj1[attrname1];\n      }\n    }\n    for (const attrname2 in obj2) {\n      if (obj2.hasOwnProperty(attrname2)) {\n        obj[attrname2] = obj2[attrname2];\n      }\n    }\n    return obj;\n  }\n}\n\nNotificationBadge.propTypes = {\n  containerStyle: PropTypes.object,\n  count: PropTypes.number,\n  label: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n  ]),\n  style: PropTypes.object,\n  className: PropTypes.string,\n  effect: PropTypes.array,\n  fps: PropTypes.number,\n  frameLength: PropTypes.number,\n};\n\nNotificationBadge.defaultProps = {\n  count: 0,\n  style: {},\n  containerStyle: {},\n};\n\nexport default NotificationBadge;","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { components } from 'react-select';\nimport Icon from '../atoms/Icon';\nimport Loader from './Loader';\nimport NotificationBadge from '../NotificationBadge';\n\nconst LayerOption = (props) => {\n    props.innerProps.onClick = () => {};\n    props.innerProps.onMouseOver = () => {};\n    props.innerProps.onMouseMove = () => {};\n\n\n    //TODO extract into file\n    // const maxHeight = '32px'\n\n    // const iconsWrapperStyle = {\n    //     flex: '0 1 auto',\n    //     maxHeight: maxHeight,\n    //     display: 'flex',\n    //     alignItems: 'center',\n    // }\n\n    const dataInfoWrapperStyle = {\n        display: 'flex',\n        justifyContent: 'left',\n        minWidth: '2rem',\n        height: '100%',\n        flex: '0 0 auto',\n        maxHeight: '32px',\n        alignItems: 'center',\n    }\n\n    // const infoIconStyle = css({\n    //     cursor: 'pointer',\n    //     maxWidth: '1.25rem',\n    //     ':hover,:focus': {\n    //         fill: 'rgb(255, 255, 255)',\n    //         stroke: 'rgb(255, 255, 255)',\n    //     }\n    //   })\n\n    const layerLabelStyle = {\n        flex: '1 1 auto',\n        marginLeft: '0.5rem',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n    }\n\n    const badgeLabel = props.data.totalCount === props.data.loadedCount ? props.data.totalCount : `${props.data.loadedCount}/${props.data.totalCount}`\n    const CountBadge = <NotificationBadge label={badgeLabel} style={{position: 'relative'}} containerStyle={{position: 'relative'}}/>;\n    return (\n        <div onClick={props.onClick} data-satkey={props.data.satKey} data-id={props.data.id}>\n            <components.Option {...props} isFocused={false} data-satkey={props.data.satKey} data-id={props.data.id}>\n                <div style={dataInfoWrapperStyle}>\n                    {!props.data.disabled && props.data.active ? CountBadge : null}\n                </div>\n                <span style={layerLabelStyle}>\n                    {props.data.label}\n                </span>\n                {/* <span style={iconsWrapperStyle}  onClick={(evt) => {evt.preventDefault();evt.stopPropagation();props.onInfoClick(props.data)}}> */}\n                    {/* <Icon icon='info' className='ptr-icon-warning' css={infoIconStyle}/> */}\n                    {/* <Icon icon='warning' className='ptr-icon-warning' style={infoIconStyle}/> */}\n                {/* </span> */}\n            </components.Option>\n            <div style={{position:'relative', height: '1px'}}>\n                {props.data.status === 'loading' ? <Loader lkey={props.data.label}/> : null}\n            </div>\n        </div>\n    );\n};\n\n// const CachedLayerOption = React.memo(LayerOption);\n\nconst getLayerOption = (onClick) => {    \n    return (props) => {\n        // return <LayerOption {...props} onClick={() => onClick(props.data)} />\n        // return <LayerOption {...props} onClick={onClick} data-satkey={props.data.satKey} data-id={props.data.id}/>\n        return <LayerOption {...props} onClick={onClick}/>\n    } \n}\n\nexport {\n    LayerOption,\n    getLayerOption,\n}","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { components } from 'react-select';\nimport Icon from '../atoms/Icon';\nimport Loader from './Loader';\nimport NotificationBadge from '../NotificationBadge';\n\nconst AcquisitionPlanOption = (props) => {\n    props.innerProps.onClick = () => {};\n    props.innerProps.onMouseOver = () => {};\n    props.innerProps.onMouseMove = () => {};\n\n\n    //TODO extract into file\n    // const maxHeight = '32px'\n\n    // const iconsWrapperStyle = {\n    //     flex: '0 1 auto',\n    //     maxHeight: maxHeight,\n    //     display: 'flex',\n    //     alignItems: 'center',\n    // }\n\n    const dataInfoWrapperStyle = {\n        display: 'flex',\n        justifyContent: 'left',\n        minWidth: '2rem',\n        height: '100%',\n        flex: '0 0 auto',\n        maxHeight: '32px',\n        alignItems: 'center',\n    }\n\n    // const infoIconStyle = css({\n    //     cursor: 'pointer',\n    //     maxWidth: '1.25rem',\n    //     ':hover,:focus': {\n    //         fill: 'rgb(255, 255, 255)',\n    //         stroke: 'rgb(255, 255, 255)',\n    //     }\n    //   })\n\n    const layerLabelStyle = {\n        flex: '1 1 auto',\n        marginLeft: '0.5rem',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n    }\n\n    const badgeLabel = `${props.data.loadedCount}`;\n    const CountBadge = <NotificationBadge label={badgeLabel} style={{position: 'relative'}} containerStyle={{position: 'relative'}}/>;\n    return (\n        <div onClick={props.onClick} data-satkey={props.data.satKey}>\n            <components.Option {...props} isFocused={false}>\n                <div style={dataInfoWrapperStyle}>\n                    {!props.data.disabled && props.data.active ? CountBadge : null}\n                </div>\n                <span style={layerLabelStyle}>\n                    {props.data.label}\n                </span>\n                {/* <span style={iconsWrapperStyle}  onClick={(evt) => {evt.preventDefault();evt.stopPropagation();props.onInfoClick(props.data)}}> */}\n                    {/* <Icon icon='info' className='ptr-icon-warning' css={infoIconStyle}/> */}\n                    {/* <Icon icon='warning' className='ptr-icon-warning' style={infoIconStyle}/> */}\n                {/* </span> */}\n            </components.Option>\n            <div style={{position:'relative', height: '1px'}}>\n                {props.data.status === 'loading' ? <Loader lkey={props.data.label}/> : null}\n            </div>\n        </div>\n    );\n};\n\n// const CachedAcquisitionPlanOption = React.memo(AcquisitionPlanOption);\n\nconst getAcquisitionPlanOption = (onClick) => {    \n    return (props) => {\n        // return <AcquisitionPlanOption {...props} onClick={() => {onClick(props.data.satKey)}} />\n        return <AcquisitionPlanOption {...props} onClick={onClick} data-satkey={props.data.satKey} />\n    } \n}\n\nexport {\n    getAcquisitionPlanOption,\n    AcquisitionPlanOption\n}","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { components } from 'react-select';\nimport Icon from '../atoms/Icon';\nimport Loader from './Loader';\nimport NotificationBadge from '../NotificationBadge';\n\nconst StatisticsOption = (props) => {\n    props.innerProps.onClick = () => {};\n    props.innerProps.onMouseOver = () => {};\n    props.innerProps.onMouseMove = () => {};\n\n\n    //TODO extract into file\n    // const maxHeight = '32px'\n\n    // const iconsWrapperStyle = {\n    //     flex: '0 1 auto',\n    //     maxHeight: maxHeight,\n    //     display: 'flex',\n    //     alignItems: 'center',\n    // }\n\n    const dataInfoWrapperStyle = {\n        display: 'flex',\n        justifyContent: 'left',\n        minWidth: '2rem',\n        height: '100%',\n        flex: '0 0 auto',\n        maxHeight: '32px',\n        alignItems: 'center',\n    }\n\n    // const infoIconStyle = css({\n    //     cursor: 'pointer',\n    //     maxWidth: '1.25rem',\n    //     ':hover,:focus': {\n    //         fill: 'rgb(255, 255, 255)',\n    //         stroke: 'rgb(255, 255, 255)',\n    //     }\n    //   })\n\n    const layerLabelStyle = {\n        flex: '1 1 auto',\n        marginLeft: '0.5rem',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n    }\n\n    const badgeLabel = `${props.data.loadedCount}`;\n    // const CountBadge = <NotificationBadge label={badgeLabel} style={{position: 'relative'}} containerStyle={{position: 'relative'}}/>;\n    return (\n        <div onClick={props.onClick} data-satkey={props.data.satKey}>\n            <components.Option {...props} isFocused={false}>\n                <div style={dataInfoWrapperStyle}>\n                    {/* {!props.data.disabled && props.data.active ? CountBadge : null} */}\n                </div>\n                <span style={layerLabelStyle}>\n                    {props.data.label}\n                </span>\n                {/* <span style={iconsWrapperStyle}  onClick={(evt) => {evt.preventDefault();evt.stopPropagation();props.onInfoClick(props.data)}}> */}\n                    {/* <Icon icon='info' className='ptr-icon-warning' css={infoIconStyle}/> */}\n                    {/* <Icon icon='warning' className='ptr-icon-warning' style={infoIconStyle}/> */}\n                {/* </span> */}\n            </components.Option>\n            <div style={{position:'relative', height: '1px'}}>\n                {props.data.status === 'loading' ? <Loader lkey={props.data.label}/> : null}\n            </div>\n        </div>\n    );\n};\n\n// const CachedStatisticsOption = React.memo(StatisticsOption);\n\nconst getStatisticsOption = (onClick) => {    \n    return (props) => {\n        // return <StatisticsOption {...props} onClick={() => {onClick(props.data.satKey)}} />\n        return <StatisticsOption {...props} onClick={onClick} />\n    } \n}\n\nexport {\n    StatisticsOption,\n    getStatisticsOption,\n}","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport {LayerOption} from './LayerOption'\nimport {AcquisitionPlanOption} from './AcquisitionPlanOption'\nimport {StatisticsOption} from './StatisticsOption'\n\nconst getOption = ({onLayerClick, onAcquisitionPlanClick, onStatisticsClick}) => {    \n    return (props) => {\n        if(props.data.type === 'product') {\n            return <LayerOption {...props} onClick={onLayerClick}/>\n        };\n\n        if(props.data.type === 'acquisitionPlan') {\n            return <AcquisitionPlanOption {...props} onClick={onAcquisitionPlanClick}/>\n        };\n\n        if(props.data.type === 'statistics') {\n            return <StatisticsOption {...props} onClick={onStatisticsClick}/>\n        };\n\n        return null;\n    } \n}\n\nexport {\n    getOption,\n}","import React from 'react';\n// this comment tells babel to convert jsx to calls to a function called jsx instead of React.createElement\n/** @jsx jsx */\nimport { css, jsx } from '@emotion/core'\nimport PropTypes from 'prop-types';\nimport { components } from 'react-select';\nimport Loader from './Loader';\n\nimport Icon from '../atoms/Icon';\n\nconst SatelliteGroupHeading = props => {\n    const {\n        className,\n        cx,\n        getStyles,\n        theme,\n        selectProps,\n        groupData,\n        restProps,\n        onClick,\n        onAcquisitionPlanClick,\n        onStatisticsClick,\n      } = props;\n\n    const active = groupData.active;\n    const disabled = groupData.disabled;\n    const activeAPS = groupData.activeAPS;\n    const availableAPS = groupData.availableAPS;\n\n    //TODO -> extract into file\n    const color = 'rgb(189, 189, 189)';\n    const activeColor = 'rgb(93, 93, 253)';\n    const activeGreenColor = '#0f9914';\n    const activeStyle = {\n        color: activeColor,\n        fill: activeColor,\n        stroke: activeColor,\n    }\n\n    const activeAPSStyle = {\n        color: activeGreenColor,\n        fill: activeGreenColor,\n        stroke: activeGreenColor,\n    }\n\n    const satIconStyle = {\n        flex: '1 1 auto',\n        maxWidth: '32px',\n        color,\n        fill: color,\n        ...(active && activeStyle)\n    }\n\n    const labelStyle = {\n        flex: '1 1 auto',\n        marginLeft: '.25rem',\n        fontSize: '1.25rem',\n        color,\n        ...(active && activeStyle)\n    }\n\n    const posIconStyle = {\n        flex: '2 2 auto',\n        maxWidth: '1.25rem',\n        color,\n        fill: color,\n        stroke: color,\n        ...(active && activeStyle)\n    }\n\n    const apsWrapStyle = {\n        flex: '2 2 auto',\n        maxWidth: '1.25rem',\n        maxHeight: '2rem',\n        marginLeft: '0.25rem',\n    }\n\n    const apsIconStyle = {\n        maxWidth: '1.25rem',\n        color,\n        fill: color,\n        stroke: color,\n        '&:hover': activeAPSStyle,\n        ...(activeAPS && activeAPSStyle),\n    }\n    \n    return (\n            <div onClick={onClick} data-satkey={groupData.satKey}>\n                <div css={{...getStyles('groupHeading', { theme, ...restProps, disabled }),...(active && activeStyle)}} className={cx({ 'group-heading': true }, `${className || ''} ${active ? 'active' : ''} ${disabled ? 'disabled' : ''}`)} >\n                    <div style={{display: \"flex\",minWidth: '100%'}}>\n                        <Icon icon={groupData.icon} style={satIconStyle}/>\n                        <span style={labelStyle}>\n                            {props.children}\n                        </span>\n                        <Icon icon={'location'} style={posIconStyle}/>\n                    </div>\n                    {groupData.loading ? <div style={{minWidth: '100%'}}>\n                        <div style={{position: 'absolute',height: '1px',minWidth: '100%', marginLeft: '-12px'}}>\n                            <Loader lkey={groupData.value}/>\n                        </div>\n                    </div> : null}\n                </div>\n            </div>\n    );\n};\n\nconst getSatelliteGroupHeading = (onClick) => {\n    return (props) => {\n        return <SatelliteGroupHeading {...props} onClick={onClick} />\n    } \n}\n// export default React.memo(SatelliteGroupHeading);\nexport {\n    getSatelliteGroupHeading,\n    SatelliteGroupHeading,\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport SelectBase, { components } from 'react-select';\nimport SatelliteGroupOption from './SatelliteGroupOption';\nimport {getOption} from './OptionFactory';\nimport {SatelliteGroupHeading} from './SatelliteGroupHeading';\nimport _ from 'lodash';\n\nconst ValueContainer = ({ children, ...props }) => (\n    <components.ValueContainer {...props}><span>Products</span></components.ValueContainer>\n);\n\nconst SelectContainer = ({ children, ...props }) => (\n    // <div onClick={() => {console.log('on click')}}>\n    <div>\n        <components.SelectContainer {...props}>\n            {children}\n        </components.SelectContainer>\n    </div>\n);\n  \nclass Select extends React.PureComponent {\n    static defaultProps = {\n        onLayerClick: () => {},\n        onCollapsClick: () => {},\n        onSatelliteClick: () => {},\n        onAcquisitionPlanClick: () => {},\n        onStatisticsClick: () => {},\n    }\n\n    static propTypes = {\n        options: PropTypes.array,\n        open: PropTypes.bool,\n        selectedLayers: PropTypes.array,\n        onLayerClick: PropTypes.func,\n        onInfoClick: PropTypes.func,\n        onCollapsClick: PropTypes.func,\n        onSatelliteClick: PropTypes.func,\n        onAcquisitionPlanClick: PropTypes.func,\n        onStatisticsClick: PropTypes.func,\n        onReleaseCamera: PropTypes.func,\n        onFixCamera: PropTypes.func,\n    }\n\n    render() {\n        const {open, options, onCollapsClick, onSatelliteClick, maxHeight, onLayerClick, onAcquisitionPlanClick, onStatisticsClick} = this.props;\n\n        // style\n        //TODO -> extract style to file\n        const color = 'rgb(189, 189, 189)';\n        const activeColor = 'rgb(235, 235, 235)';\n        const activeBackgroundColor = 'rgb(93, 93, 253)';\n        const disabledBackgroundColor = 'rgba(175, 175, 179, 0.4)';\n        const disabledActiveBackgroundColor = 'rgba(93, 93, 253, 0.4)';\n        const hoverBackgroundColor = 'rgba(139, 139, 208, 0.6)';\n        // const menuBackgroundColor = 'rgba(42, 46, 52, 0.64)';\n        const menuContainerBackgroundColor = 'rgba(0, 0, 0, 0.7)';\n        const menuBackgroundColor = 'rgba(0, 0, 0, 0.6)';\n        // end style\n\n        const customStyles = {\n            menu: (provided, state) => ({\n              ...provided,\n              backgroundColor: menuBackgroundColor,\n            }),\n            menuList: (provided, state) => ({\n              ...provided,\n              maxHeight: maxHeight,\n            }),\n            container: (provided, state) => ({\n              ...provided,\n              position: 'absolute',\n              top: '0.5rem',\n              left: '0.5rem',\n              width: '200px',\n            }),\n            valueContainer: (provided, state) => ({\n                ...provided,\n                color: 'rgb(237, 237, 237)',\n            }),\n            control: (provided, state) => ({\n                ...provided,\n                backgroundColor: menuContainerBackgroundColor,\n                borderColor: 'rgba(236, 235, 255, 0.66)',\n            }),\n            groupHeading:(provided, state) => {\n                const disabled = state.disabled;\n                const disabledStyle = {\n                    backgroundColor: disabledBackgroundColor,\n                    color: activeColor,\n                    fill: activeColor,\n                    stroke: activeColor,\n                    cursor: 'not-allowed',\n                }\n\n                const style = {\n                    ...provided,\n                    alignItems: 'center',\n                    cursor: 'pointer',\n                    display: 'flex',\n                    flexFlow: 'column',\n                    padding: '0 .75rem',\n                    '&:hover': {\n                        backgroundColor: hoverBackgroundColor\n                    },\n                    ...(disabled && disabledStyle),\n                  }\n\n                  return style;\n            },\n            dropdownIndicator: (provided, state) => {\n                const style = {\n                    ...provided,\n                    cursor: 'pointer',\n                }\n                return style;\n            },\n            option: (provided, state) => {\n\n                const activeStyle = {\n                    backgroundColor: activeBackgroundColor,\n                    color: activeColor,\n                    fill: activeColor,\n                    stroke: activeColor,\n                }\n\n                const disabledStyle = {\n                    backgroundColor: disabledBackgroundColor,\n                    color: activeColor,\n                    fill: activeColor,\n                    stroke: activeColor,\n                    cursor: 'not-allowed',\n                }\n\n                // const disabledActiveStyle = {\n                //     backgroundColor: disabledActiveBackgroundColor,\n                // }\n\n                const active = state.data.active;\n                const disabled = state.data.disabled;\n                const style = {\n                    ...provided,\n                    paddingTop: '0px',\n                    paddingBottom: '0px',\n                    cursor: 'pointer',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'space-between',\n                    color: color,\n                    fill: color,\n                    stroke: color,\n                    ':hover': {\n                        backgroundColor: hoverBackgroundColor\n                    },\n                    ...(active && activeStyle),\n                    // ...(disabled && disabledStyle),\n                    // ...(disabled && active && disabledActiveStyle),\n                  }\n\n                  return style;\n            },\n          }\n\n        const components = {\n            ValueContainer: ValueContainer,\n            Option: getOption({onLayerClick, onAcquisitionPlanClick, onStatisticsClick}),\n            GroupHeading: (props) => <SatelliteGroupHeading {...props} onClick={onSatelliteClick} />,\n            Group: SatelliteGroupOption,\n            SelectContainer,\n        }\n\n        return (\n            <SelectBase\n                className={'ptr-satellite-selector'}\n                classNamePrefix={'ptr-select-satellite'}\n                styles={customStyles}\n                hideSelectedOptions={true}\n                title={'Satellites'}\n                components={components}\n                options={options}\n                menuIsOpen={open}\n                closeMenuOnSelect={false}\n                blurInputOnSelect={true}\n                onMenuClose={onCollapsClick}\n                onMenuOpen={onCollapsClick}\n            />\n        );\n    }\n\n}\n\n// export default Select;\nfunction areEqual(prevProps, nextProps) {\n    const shalowEqual = prevProps.options === nextProps.options && prevProps.open === nextProps.open && prevProps.maxHeight === nextProps.maxHeight;\n    if(shalowEqual) {\n        return shalowEqual;\n    } else {\n        return _.isEqual(prevProps.options, nextProps.options) && _.isEqual(prevProps.open, nextProps.open) && _.isEqual(prevProps.maxHeight, nextProps.maxHeight);\n    }\n  }\n  export default React.memo(Select, areEqual);","import React, {useRef} from 'react';\nimport Presentation from './presentation';\nimport select from '../../context/selectors/';\nimport {withContext} from '../../context/withContext';\n\nimport {\n    toggleLayer,\n    toggleAcquisitionPlan,\n    toggleStatistics,\n    updateComponent,\n    setNavigatorFromOrbit,\n    focusSatellite,\n    clearComponent,\n} from '../../context/actions';\n\nimport {\n    updateMapView,\n    updateViewHeadingCorrectionByFocusSatellite\n} from '../../context/actions/map';\n\nconst SetalliteSelect = (props) => {\n    const {dispatch, state, maxHeight} = props;\n\n    const satelliteSelectState = select.components.satelliteSelect.getSubstate(state);\n    const selectTime = select.rootSelectors.getSelectTime(state);\n    const sateliteOptions = select.components.satelliteSelect.getSatelitesSelectOptions(state, selectTime);\n    \n    const mapViewRef = useRef();\n    mapViewRef.current = select.map.getView(state);\n    \n    const selectTimeRef = useRef();\n    selectTimeRef.current = selectTime;\n\n    const onLayerClick = (evt) => {\n        dispatch(toggleLayer(evt.currentTarget.dataset.satkey, evt.currentTarget.dataset.id))\n    }\n\n    const onAcquisitionPlanClick = (evt) => {\n        dispatch(toggleAcquisitionPlan(state, evt.currentTarget.dataset.satkey));\n    }\n\n    const onStatisticsClick = (evt) => {\n        dispatch(toggleStatistics(state, evt.currentTarget.dataset.satkey));\n    }\n\n    const onSatelliteClick = (evt) => {\n        const satKey = evt.currentTarget.dataset.satkey;\n        const focusedSatellite = select.rootSelectors.getFocusedSatellite(state);\n        const mapView = mapViewRef.current;\n        const satelliteIsFocused = focusedSatellite === satKey;\n        if(satelliteIsFocused) {\n            //disable focused satellite\n            dispatch(focusSatellite(null))\n            let heading = 0 - mapView.headingCorrection;\n\n            dispatch(updateMapView({\n                headingCorrection: 0,\n                heading,\n                roll: 0,\n                tilt: 0,\n                center: {...mapView.center ,altitude: 0}\n            }));\n            dispatch(clearComponent('navigatorBackup'));\n        } else {\n            //set focused satellite\n            dispatch(focusSatellite(satKey))\n            const orbitInfo = select.data.orbits.getByKey(state, `orbit-${satKey}`);\n            const selectTime = selectTimeRef.current;\n            dispatch(setNavigatorFromOrbit(selectTime, orbitInfo, mapView, mapView.heading, mapView.roll, mapView.tilt));\n\n            dispatch(updateViewHeadingCorrectionByFocusSatellite());\n        }\n    }\n\n    const onSatelliteCollapsClick = (evt) => {\n        const {state} = props;\n        const satelliteSelectState = select.components.satelliteSelect.getSubstate(state);\n        if(satelliteSelectState.open) {\n            dispatch(updateComponent('satelliteSelect', {open: false}))\n        } else {\n            dispatch(updateComponent('satelliteSelect', {open: true}))\n        }\n    }\n\n    return (\n        <Presentation \n            options={sateliteOptions}\n            open={satelliteSelectState.open}\n            onLayerClick={onLayerClick}\n            onSatelliteClick={onSatelliteClick}\n            onAcquisitionPlanClick={onAcquisitionPlanClick}\n            onStatisticsClick={onStatisticsClick}\n            onCollapsClick={onSatelliteCollapsClick}\n            maxHeight = {maxHeight}\n            />\n    )\n}\n\nexport default withContext(SetalliteSelect);","import React from \"react\";\n\nexport default React.createContext(null);","import React from 'react';\n\nimport hoverContext from '../HoverHandler/context';\n\n\nclass TimelineHover extends React.PureComponent {\n\tstatic contextType = hoverContext;\n\tconstructor (props) {\n\t\tsuper(props);\n\t\tthis.onHover = this.onHover.bind(this);\n\t}\n\n\tonHover(evt) {\n\t\tif(evt) {\n\t\t\tthis.context.onHover('timeline', {\n\t\t\t\tpopup: {\n\t\t\t\t\tx: evt.x,\n\t\t\t\t\ty: evt.y,\n\t\t\t\t\tcontent: this.props.getHoverContent(evt.x, evt.time) || null\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\tthis.context.onHoverOut()\n\t\t}\n\t}\n\n\trender() {\n\t\tconst children = React.Children.map(this.props.children, child =>\n\t\t\tReact.cloneElement(child, { ...child.props,  onHover: this.onHover}));\n\n\t\treturn (<>{children}</>)\n\t}\n\n}\n\nexport default TimelineHover;\n","const getAbsoluteElementPosition = (element) => {\n\tconst rect = element.getBoundingClientRect();\n\tconst docEl = document.documentElement;\n\tconst top = rect.top + window.pageYOffset - docEl.clientTop;\n\tconst left = rect.left + window.pageXOffset - docEl.clientLeft;;\n\n\treturn {\n\t\ttop,\n\t\tleft,\n\t}\n}\n\n//top\nconst getTopPossition = (origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint) => {\n\tconst top = hoveredElemen ? hoveredElemen.getBoundingClientRect().top : origPosY;\n\tconst posY = top - padding - height;\n\tconst topAbsoplute = hoveredElemen ? getAbsoluteElementPosition(hoveredElemen).top : origPosY;\n\tconst posYAbsoplute = topAbsoplute - padding - height;\n\tlet posX;\n\tlet posXIncrement;\n\tswitch (referencePoint) {\n\t\tcase 'center':\n\t\t\tposXIncrement = -(width / 2);\n\t\t\tbreak;\n\t\tcase 'corner':\n\t\t\tposXIncrement = 0; //left top/bottom corner\n\t\t\tbreak;\n\t};\n\n\tconst overflowRight = (origPosX + posXIncrement + width + padding) >  BBox[1];\n\tconst overflowLeft = (origPosX + posXIncrement - padding) <  BBox[3];\n\n\tif(overflowRight) {\n\t\tposX = BBox[1] - padding - width;\n\t} else if(overflowLeft) {\n\t\tposX = BBox[3] + padding;\n\t} else {\n\t\tposX = origPosX + posXIncrement;\n\t}\n\n\tconst boundingRect = [posYAbsoplute, posX + width, posYAbsoplute + height, posX];\n\n\t// return [posX, posY]\n\treturn {\n\t\tposition: {posX: posX - BBox[3], posY: posY},\n\t\tboundingRect,\n\t}\n}\n\n//bottom\nconst getBottomPossition = (origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint) => {\n\tconst bottom = hoveredElemen ? hoveredElemen.getBoundingClientRect().top + hoveredElemen.offsetHeight : origPosY;\n\tconst posY = bottom + padding;\n\tconst bottomAbsoplute = hoveredElemen ? getAbsoluteElementPosition(hoveredElemen).top + hoveredElemen.offsetHeight : origPosY;\n\tconst posYAbsoplute = bottomAbsoplute + padding;\n\tlet posX;\n\tlet posXIncrement;\n\tswitch (referencePoint) {\n\t\tcase 'center':\n\t\t\tposXIncrement = -(width / 2);\n\t\t\tbreak;\n\t\tcase 'corner':\n\t\t\tposXIncrement = 0; //left top/bottom corner\n\t\t\tbreak;\n\t}\n\n\tconst overflowRight = (origPosX + posXIncrement + width + padding) >  BBox[1];\n\tconst overflowLeft = (origPosX + posXIncrement - padding) <  BBox[3];\n\n\tif(overflowRight) {\n\t\tposX = BBox[1] - padding - width;\n\t} else if(overflowLeft) {\n\t\tposX = BBox[3] + padding;\n\t} else {\n\t\tposX = origPosX + posXIncrement;\n\t}\n\n\tconst boundingRect = [posYAbsoplute, posX + width, posYAbsoplute + height, posX];\n\n\treturn {\n\t\tposition: {posX: posX - BBox[3], posY: posY},\n\t\tboundingRect,\n\t}\n}\n\n//right\nconst getRightPossition = (origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint) => {\n\tconst rightAbsoplute = hoveredElemen ? getAbsoluteElementPosition(hoveredElemen).left + hoveredElemen.offsetWidth : origPosX;\n\tconst posXAbsoplute = rightAbsoplute + padding;\n\tlet posY;\n\tlet posYIncrement;\n\tswitch (referencePoint) {\n\t\tcase 'center':\n\t\t\t\tposYIncrement = -(height / 2)\n\t\t\tbreak;\n\t\tcase 'corner':\n\t\t\t\tposYIncrement = 0; //left/right top corner\n\t\t\tbreak;\n\t}\n\n\tconst overflowTop = (origPosY + posYIncrement - padding) <  BBox[0];\n\tconst overflowBottom = (origPosY + posYIncrement + height + padding) >  BBox[2];\n\n\tif(overflowTop) {\n\t\tposY = BBox[0] + padding;\n\t} else if(overflowBottom) {\n\t\tposY = BBox[2] - padding - height;\n\t} else {\n\t\tposY = origPosY + posYIncrement;\n\t}\n\n\tconst boundingRect = [posY + height, posXAbsoplute + width, posY, posXAbsoplute];\n\n\treturn {\n\t\tposition: {posX: posXAbsoplute - BBox[3], posY: posY - BBox[0]},\n\t\tboundingRect,\n\t}\n}\n\n//left\nconst getLeftPossition = (origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint) => {\n\tconst leftAbsoplute = hoveredElemen ? getAbsoluteElementPosition(hoveredElemen).left : origPosX;\n\tconst posXAbsoplute = leftAbsoplute - padding - width;\n\tlet posY;\n\tlet posYIncrement;\n\tswitch (referencePoint) {\n\t\tcase 'center':\n\t\t\t\tposYIncrement = -(height / 2)\n\t\t\tbreak;\n\t\tcase 'corner':\n\t\t\t\tposYIncrement = 0; //left/right top corner\n\t\t\tbreak;\n\t}\n\n\tconst overflowTop = (origPosY + posYIncrement - padding) <  BBox[0];\n\tconst overflowBottom = (origPosY + posYIncrement + height + padding) >  BBox[2];\n\n\tif(overflowTop) {\n\t\tposY = BBox[0] + padding;\n\t} else if(overflowBottom) {\n\t\tposY = BBox[2] - padding - height;\n\t} else {\n\t\tposY = origPosY + posYIncrement;\n\t}\n\n\tconst boundingRect = [posY + height, posXAbsoplute + width, posY, posXAbsoplute];\n\n\treturn {\n\t\tposition: {posX: posXAbsoplute - BBox[3], posY: posY - BBox[0]}, //relative to element\n\t\tboundingRect,\n\t}\n}\n\nconst checkBoundatiesConflict = (innerBoundingRect, padding, BBox) => {\n\tconst topInside = innerBoundingRect[0] - padding >= BBox[0];\n\tconst rightInside = innerBoundingRect[1] + padding <= BBox[1];\n\tconst bottomInside = innerBoundingRect[2] + padding <= BBox[2];\n\tconst leftInside = innerBoundingRect[3] - padding >= BBox[3];\n\treturn !(topInside && rightInside && bottomInside && leftInside);\n}\n\nconst getTootlipPosition = (referencePoint, positions, BBox, padding) => {\n    const getPosition = (position, origPosX, origPosY, width, height, hoveredElemen) => {\n        let conflict = true;\n        let pos = null;\n        switch (position) {\n            case 'top':\n                const topPos = getTopPossition(origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint);\n                conflict = checkBoundatiesConflict(topPos.boundingRect, padding, BBox);\n                pos = {\n                    'position': topPos,\n                    conflict\n                }\n                break;\n            case 'bottom':\n                const bottomPos = getBottomPossition(origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint);\n                conflict = checkBoundatiesConflict(bottomPos.boundingRect, padding, BBox);\n                pos = {\n                    'position': bottomPos,\n                    conflict\n                }\n                break;\n            case 'left':\n                const leftPos = getLeftPossition(origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint);\n                conflict = checkBoundatiesConflict(leftPos.boundingRect, padding, BBox);\n                pos = {\n                    'position': leftPos,\n                    conflict\n                }\n                break;\n            case 'right':\n                const rightPos = getRightPossition(origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint);\n                conflict = checkBoundatiesConflict(rightPos.boundingRect, padding, BBox);\n                pos = {\n                    'position': rightPos,\n                    conflict\n                }\n                break;\n            default:\n                break;\n        }\n        return pos;\n    }\n\n    return (origPosX, origPosY, width, height, hoveredElemen) => {\n\n        let validPosition = null;\n\n        for (const position of positions) {\n            const pos = getPosition(position, origPosX, origPosY, width, height, hoveredElemen);\n\n            if(!pos.conflict) {\n                validPosition = {\n                    top: pos.position.position.posY,\n                    left: pos.position.position.posX,\n                    width\n                };\n                break;\n            }\n        }\n\n\n        if(!validPosition) {\n            const pos = getPosition(positions[0], origPosX, origPosY, width, height, hoveredElemen);\n            \n            validPosition = {\n                top: pos.position.position.posY,\n                left: pos.position.position.posX,\n                width\n            };\n        }\n\n        return validPosition;\n    }\n}\n\n\nexport {\n\tgetTootlipPosition,\n\tgetAbsoluteElementPosition,\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {getTootlipPosition} from '../position';\n\nimport './style.css';\n\nconst WIDTH = 250;\nconst HEIGHT = 50;\nconst TOOLTIP_PADDING = 15;\n\nconst getTooltipStyle = () => {\n\t// bbox for tooltip default defined by window\n\tconst windowScrollTop = window.document.documentElement.scrollTop;\n\tconst windowScrollLeft = window.document.documentElement.scrollLeft;\n\tconst windowHeight = window.document.documentElement.clientHeight;\n\tconst windowWidth = window.document.documentElement.clientWidth;\n\tconst windowBBox = [windowScrollTop, windowScrollLeft + windowWidth, windowScrollTop + windowHeight, windowScrollLeft];\n\n\treturn getTootlipPosition('corner', ['right', 'left', 'top', 'bottom'], windowBBox, TOOLTIP_PADDING);\n}\n\nclass Popup extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\tx: PropTypes.number,\n\t\ty: PropTypes.number,\n\t\tmaxX: PropTypes.number,\n\t\tcontent: PropTypes.element,\n\t\tgetStyle: PropTypes.func,\n\t\thoveredElemen: PropTypes.oneOfType([\n\t\t\tPropTypes.element,\n\t\t\tPropTypes.object,\n\t\t  ]),\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.ref = React.createRef();\n\t}\n\n\trender() {\n\t\tlet posX = this.props.x;\n\t\tlet posY = this.props.y;\n\n\t\tlet width = this.ref.current && this.ref.current.offsetWidth ? this.ref.current.offsetWidth : WIDTH;\n\t\tlet height = this.ref.current && this.ref.current.offsetHeight ? this.ref.current.offsetHeight : HEIGHT;\n\n\t\tlet style;\n\n\t\tif(typeof this.props.getStyle === 'function' && this.props.hoveredElemen) {\n\t\t\tstyle = this.props.getStyle()(posX, posY, width, height, this.props.hoveredElemen);\n\t\t} else {\n\t\t\t//right corner on mouse position\n\t\t\tstyle = getTooltipStyle()(posX, posY, width, height);\n\t\t}\n\n\t\treturn (\n\t\t\t<div style={style} className={\"ptr-popup\"} ref={this.ref}>\n\t\t\t\t{this.props.content ? React.cloneElement(this.props.content) : this.props.children}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Popup;\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport _ from 'lodash';\n\nimport HoverContext from './context';\nimport Popup from \"./Popup/Popup\";\n\nclass HoverHandler extends React.PureComponent {\n\tstatic propTypes = {\n\t\tgetStyle: PropTypes.func,\n\t}\n\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.ref = React.createRef();\n\t\tthis.state = {\n\t\t\thoveredItems: null,\n\t\t\tpopup: null\n\t\t};\n\n\t\tthis.onHover = this.onHover.bind(this);\n\t\tthis.onHoverOut = this.onHoverOut.bind(this);\n\t}\n\n\tonHover(hoveredItems, options) {\n\t\tlet update = {};\n\n\t\tif (hoveredItems) {\n\t\t\tupdate.hoveredItems = hoveredItems;\n\t\t}\n\n\t\tif (options && options.popup) {\n\t\t\tupdate.popup = options.popup;\n\t\t}\n\n\t\tif (!_.isEmpty(update)) {\n\t\t\tthis.setState(update);\n\t\t}\n\t}\n\n\tonHoverOut() {\n\t\tthis.setState({\n\t\t\thoveredItems: null,\n\t\t\tpopup: null\n\t\t});\n\t}\n\n\trender() {\n\t\tconst {children} = this.props;\n\t\tconst {popup, hoveredItems} = this.state;\n\t\treturn (\n\t\t\t<HoverContext.Provider value={{\n\t\t\t\thoveredItems: hoveredItems,\n\t\t\t\tonHover: this.onHover,\n\t\t\t\tonHoverOut: this.onHoverOut\n\t\t\t}}>\n\t\t\t\t<div ref={this.ref} style={{height: '100%',width: '100%'}}>\n\t\t\t\t\t{children}\n\t\t\t\t\t{popup ? this.renderPopup() : null}\n\t\t\t\t</div>\n\t\t\t</HoverContext.Provider>\n\t\t);\n\t}\n\n\trenderPopup() {\n\t\tconst {getStyle} = this.props;\n\t\tconst {popup} = this.state;\n\n\t\treturn <Popup\n\t\t\t\t\tx={popup.x}\n\t\t\t\t\ty={popup.y}\n\t\t\t\t\tcontent={popup.content}\n\t\t\t\t\tgetStyle={getStyle}\n\t\t\t\t\thoveredElemen={this.ref.current}\n\t\t\t\t/>\n\t}\n}\n\nexport default HoverHandler;\n","import React from 'react';\nimport './picker.css';\nimport PropTypes from 'prop-types';\n\nclass Picker extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\twidth: PropTypes.number\n\t};\n\n\trender() {\n\t\tconst {width, height, vertical} = this.props;\n\t\tconst indicatorWidth = 10;\n\t\tif (width) {\n\t\t\tconst position = width / 2;\n\t\t\tconst x = vertical ? 0 : position - indicatorWidth;\n\t\t\tconst y = vertical ? position - indicatorWidth : 0;\n\t\t\tconst eHeight = vertical ? indicatorWidth * 2 + 1 : height;\n\t\t\tconst eWidth = vertical ? height : indicatorWidth * 2 + 1;\n\n\t\t\treturn (\n\t\t\t\t<g\n\t\t\t\t\tclassName=\"ptr-timeline-picker\"\n\t\t\t\t>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tx={x}\n\t\t\t\t\t\twidth={eWidth}\n\t\t\t\t\t\ty={y}\n\t\t\t\t\t\theight={eHeight}\n\t\t\t\t\t/>\n\t\t\t\t\t<line\n\t\t\t\t\t\tx1={vertical ? 0 : position + 0.5}\n\t\t\t\t\t\tx2={vertical ? height : position + 0.5}\n\t\t\t\t\t\ty1={vertical ? position + 0.5 : 0}\n\t\t\t\t\t\ty2={vertical ? position + 0.5 : height}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n}\n\nPicker.propTypes = {\n\theight: PropTypes.number,\n\twidth: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nPicker.defaultProps = {\n\tvertical: false,\n}\n\nexport default Picker;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css'\n\nconst Mouse = (props) => {\n\tconst {mouseX, mouseBufferWidth, height, vertical} = props;\n\tif (mouseX) {\n\t\tconst x = vertical ? 0 : mouseX - mouseBufferWidth;\n\t\tconst y = vertical ? mouseX - mouseBufferWidth : 0;\n\t\tconst eHeight = vertical ? mouseBufferWidth * 2 + 1 : height;\n\t\tconst width = vertical ? height : mouseBufferWidth * 2 + 1;\n\n\t\treturn (\n\t\t\t<g\n\t\t\t\tclassName=\"ptr-timeline-mouse\"\n\t\t\t>\n\t\t\t\t<rect\n\t\t\t\t\tx={x}\n\t\t\t\t\twidth={width}\n\t\t\t\t\ty={y}\n\t\t\t\t\theight={eHeight}\n\t\t\t\t/>\n\t\t\t\t<line\n\t\t\t\t\tx1={vertical ? 0 : mouseX + 0.5}\n\t\t\t\t\tx2={vertical ? height : mouseX + 0.5}\n\t\t\t\t\ty1={vertical ? mouseX + 0.5 : 0}\n\t\t\t\t\ty2={vertical ? mouseX + 0.5 : height}\n\t\t\t\t/>\n\t\t\t</g>\n\t\t);\n\t} else {\n\t\treturn null;\n\t}\n};\n\nMouse.propTypes = {\n\tmouseX: PropTypes.number,\n\tmouseBufferWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nMouse.defaultProps = {\n\tvertical: false,\n}\n\nexport default Mouse;","import moment from 'moment';\n\nexport const getYears = (start, end) => {\n    const years = [];\n    let current = moment(start);\n\n    while (end > current || current.format('YYYY') === end.format('YYYY')) {\n        years.push({\n            year: current.format('YYYY'),\n            start: (current.format('YYYY') === start.format('YYYY')) ? start : moment(current).startOf('year'),\n            end: (current.format('YYYY') === end.format('YYYY')) ? end : moment(current).endOf('year')\n        });\n        current.add(1,'year');\n    }\n    return years;\n}\nexport const getMonths = (start, end) => {\n    const months = [];\n    let current = moment(start);\n\n    while (end > current || current.format('YYYY-MM') === end.format('YYYY-MM')) {\n        months.push({\n            year: current.format('YYYY'),\n            month: current.format('MM'),\n            start: (current.format('YYYY-MM') === start.format('YYYY-MM')) ? start : moment(current).startOf('month'),\n            end: (current.format('YYYY-MM') === end.format('YYYY-MM')) ? end : moment(current).endOf('month')\n        });\n        current.add(1,'month');\n    }\n\n    return months;\n}\n\nexport const getDays = (start, end) => {\n    const days = [];\n    let current = moment(start);\n\n    while (end > current || current.format('D') === end.format('D')) {\n        days.push({\n            year: current.format('YYYY'),\n            month: current.format('MM'),\n            day: current.format('DD'),\n            start: (current.format('YYYY-MM-DD') === start.format('YYYY-MM-DD')) ? start : moment(current).startOf('day'),\n            end: (current.format('YYYY-MM-DD') === end.format('YYYY-MM-DD')) ? end : moment(current).endOf('day')\n        });\n        current.add(1,'day');\n    }\n\n    return days;\n}\n\nexport const getHours = (start, end) => {\n    const hours = [];\n    let current = moment(start);\n\n    while (end > current || current.format('HH') === end.format('HH')) {\n        hours.push({\n            year: current.format('YYYY'),\n            month: current.format('MM'),\n            day: current.format('DD'),\n            hour: current.format('HH'),\n            start: (current.format('YYYY-MM-DD-HH') === start.format('YYYY-MM-DD-HH')) ? start : moment(current).startOf('hour'),\n            end: (current.format('YYYY-MM-DD-HH') === end.format('YYYY-MM-DD-HH')) ? end : moment(current).endOf('hour')\n        });\n        current.add(1,'hour');\n    }\n    return hours;\n}\n\nexport const getMinutes = (start, end) => {\n    const minutes = [];\n    let current = moment(start);\n\n    while (end > current || current.format('mm') === end.format('mm')) {\n        minutes.push({\n            year: current.format('YYYY'),\n            month: current.format('MM'),\n            day: current.format('DD'),\n            hour: current.format('HH'),\n            minute: current.format('mm'),\n            start: (current.format('YYYY-MM-DD-HH-mm') === start.format('YYYY-MM-DD-HH-mm')) ? start : moment(current).startOf('minute'),\n            end: (current.format('YYYY-MM-DD-HH-mm') === end.format('YYYY-MM-DD-HH-mm')) ? end : moment(current).endOf('minute')\n        });\n        current.add(1,'minute');\n    }\n    return minutes;\n}\n\n/**\n * \n * @param {Moment} periodStart - visible periodLimit\n * @param {Moment} periodEnd - visible periodLimit\n * @param {Moment} periodLimitStart - visible periodLimit\n * @param {Moment} periodLimitEnd - visible periodLimit\n */\nexport const getPeriodLimits = (periodStart, periodEnd, periodLimitStart, periodLimitEnd) => {\n    const periodStartMom = moment(periodStart)\n    const periodEndMom = moment(periodEnd)\n    const periodLimitStartMom = moment(periodLimitStart)\n    const periodLimitEndMom = moment(periodLimitEnd)\n\n    const periodLimitsCfg = [];\n\n    if(periodLimitStartMom.isBefore(periodStartMom)) {\n        periodLimitsCfg.push({\n            key: 'before',\n            start: periodLimitStartMom,\n            end: periodStartMom,\n        })\n    }\n\n    if(periodLimitEndMom.isAfter(periodEndMom)) {\n        periodLimitsCfg.push({\n            key: 'after',\n            start: periodEndMom,\n            end: periodLimitEndMom,\n        })\n    }\n\n    return periodLimitsCfg;\n}\n\n/**\n * \n * @param {Moment} periodStart - visible periodLimit\n * @param {Moment} periodEnd - visible periodLimit\n * @param {Array} overlays \n *  overlay.label\n *  overlay.key\n *  overlay.classes\n *  overlay.height\n *  overlay.backdroundColor\n *  overlay.top\n */\nexport const getOverlays = (periodStart, periodEnd, overlays) => {\n    const periodLimitStart = moment(periodStart)\n    const periodLimitEnd = moment(periodEnd)\n    const overlaysCfg = [];\n    for (const overlay of overlays) {\n        const start = moment(overlay.start);\n        const end = moment(overlay.end);\n\n        if(end.isAfter(periodLimitStart) && start.isBefore(periodLimitEnd)) {\n            overlaysCfg.push(\n                {\n                    label: overlay.label,\n                    key: overlay.key,\n                    classes: overlay.classes,\n                    height: overlay.height,\n                    top: overlay.top || 0,\n                    backgound: overlay.backdroundColor,\n                    start: start.isBefore(periodLimitStart) ? periodLimitStart : start,\n                    end: end.isAfter(periodLimitEnd) ? periodLimitEnd : end,\n                }\n            )\n        }\n    }\n    return overlaysCfg;\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {getOverlays} from '../utils/interval';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport moment from 'moment';\nimport './style.css';\n\nconst Overlay = (props) => {\n\tconst {period, overlays, getX, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\t\n\tconst overlaysCfg = getOverlays(periodStart, periodEnd, overlays);\n\n\tconst overlaysElms = _.map(overlaysCfg, overlay => {\n\t\tconst start = getX(overlay.start);\n\t\tconst end = getX(overlay.end);\n\t\tlet label = null\n\t\t\n\t\tconst diff = end-start > 2 ? end-start : 2;\n\t\tconst x = vertical ? overlay.top : start;\n\t\tconst yL = vertical ? start : (overlay.top + overlay.height - 2);\n\t\tconst yR = vertical ? start : overlay.top;\n\t\tconst eHeight = vertical ? diff : overlay.height;\n\t\tconst width = vertical ? overlay.height : diff;\n\n\t\t//TODO - solve label in vertical\n\t\tif(overlay.label && !vertical) {\n\t\t\tlabel = (\n\t\t\t\t<text\n\t\t\t\t\tx={x}\n\t\t\t\t\ty={yL}\n\t\t\t\t\tclassName=\"ptr-timeline-overlay-label\"\n\t\t\t\t>\n\t\t\t\t\t{overlay.label}\n\t\t\t\t</text>\n\t\t\t);\n\t\t}\n\t\treturn (\n\t\t\t<g\n\t\t\t\tkey={`${overlay.key}`}\n\t\t\t\tclassName={classNames(\"ptr-timeline-overlay\", overlay.classes)}\n\t\t\t>\n\t\t\t\t<rect\n\t\t\t\t\tx={x}\n\t\t\t\t\twidth={width}\n\t\t\t\t\ty={yR}\n\t\t\t\t\theight={eHeight}\n\t\t\t\t\tfill={overlay.backgound}\n\t\t\t\t/>\n\t\t\t\t{label}\n\t\t\t</g>\n\t\t);\n\t});\n\n\treturn (\n\t\t<g>\n\t\t\t{overlaysElms}\n\t\t</g>\n\t);\n};\n\n\nOverlay.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}),\n\tgetX: PropTypes.func,\n\toverlays: PropTypes.array.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nOverlay.defaultProps = {\n\tvertical: false,\n}\n\n// export default Overlay;\nexport default React.memo(Overlay);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {getPeriodLimits} from '../utils/interval';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport moment from 'moment';\nimport './style.css';\n\nclass PeriodLimit extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\tperiodLimit: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}),\n\t\tperiod: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}),\n\t\tgetX: PropTypes.func,\n\t\theight: PropTypes.number,\n\t\tvertical: PropTypes.bool,\n\t};\n\n\tstatic defaultProps = {\n\t\tvertical: false,\n\t};\n\n\trender() {\n\t\tconst {periodLimit, period, getX, height, vertical} = this.props;\n\t\tconst periodStart = moment(periodLimit.start);\n        const periodEnd = moment(periodLimit.end);\n\t\tconst periodLimitStart = moment(period.start);\n        const periodLimitEnd = moment(period.end);\n        \n\t\tconst periodLimitCfg = getPeriodLimits(periodStart, periodEnd, periodLimitStart, periodLimitEnd);\n\t\tconst periodLimitsElms = _.map(periodLimitCfg, limit => {\n\t\t\tconst start = getX(limit.start);\n\t\t\tconst end = getX(limit.end);\n\t\t\t\n\t\t\tconst x = vertical ? 0 : start;\n\t\t\tconst y = vertical ? start : 0;\n\t\t\tconst eHeight = vertical ? end-start : height;\n\t\t\tconst width = vertical ? height : end-start;\n            \n\t\t\treturn (\n\t\t\t\t<g\n\t\t\t\t\tkey={`${limit.key}`}\n\t\t\t\t\tclassName={classNames(\"ptr-timeline-periodLimit-limit\")}\n\t\t\t\t>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tx={x}\n\t\t\t\t\t\twidth={width}\n\t\t\t\t\t\ty={y}\n\t\t\t\t\t\theight={eHeight}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t);\n\t\t});\n\n\t\treturn React.createElement('g', null, (<>{periodLimitsElms}</>));\n\t}\n\n}\n\nexport default PeriodLimit;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass TextLabel extends React.PureComponent {\n\n    static propTypes = {\n        label: PropTypes.string.isRequired,\n        className: PropTypes.string,\n        x: PropTypes.number.isRequired,\n        height: PropTypes.number.isRequired,\n        vertical: PropTypes.bool,\n    };\n\n    static defaultProps = {\n        vertical: false,\n        className: '',\n    }\n\n\tconstructor(props){\n        super(props);\n\t\tthis.node = React.createRef();\n        this.state = {\n            elHeight: 0,\n            elWidth: 0,\n        };\n    }\n    \n    componentDidMount() {\n        const elHeight = this.node.current.getBoundingClientRect().height;\n        const elWidth = this.node.current.getBoundingClientRect().width;\n        this.setState({elHeight, elWidth});\n    }\n\n\trender() {\n        const {label, vertical, height, x, className} = this.props;\n        const {elHeight, elWidth} = this.state;\n        \n        const xTransform = vertical ? -height + 3 : x + 3;\n        const yTransform = vertical ? x + elHeight + 3 : height - 2;\n        const transform = vertical ? `scale(-1,1)` : '';\n        // const xTransform = vertical ? x + elHeight + 3 : x + 3;\n        // const transform = vertical ? `rotate(270, ${xTransform}, ${height})` : ''\n\t\treturn (\n            <g>\n                <rect \n                    transform={transform}\n                    x={xTransform}\n                    y={yTransform - elHeight + 3}\n                    width={elWidth}\n                    height={elHeight}\n                    style={{stroke: 'none'}}\n                    >\n                </rect>\n                <text\n                    ref={this.node}\n                    transform={transform}\n                    x={xTransform}\n                    y={yTransform}\n                    className={className}>\n                    {label}\n                </text>\n            </g>\n\t\t);\n\t}\n}\n\nexport default TextLabel;\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nexport const D1 = (props) => {\n    const {x, height, vertical} = props;\n    const width = 0.7;\n    const dHeight = height || '100%';\n    return (\n        <line\n            x1={vertical ? 0 : x + width}\n            x2={vertical ? dHeight : x + width}\n            y1={vertical ? x + width : 0 }\n            y2={vertical ? x + width : dHeight }\n            />\n    );\n}\n\nD1.propTypes = {\n\tx: PropTypes.number.isRequired,\n\theight: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nD1.defaultProps = {\n\tvertical: false,\n}\nexport const D2 = (props) => {\n    const {x, height, vertical} = props;\n    const width = 0.7;\n    const dHeight = height || '50%';\n    return (\n        <line\n            x1={vertical ? dHeight : x + width}\n            x2={vertical ? 0 : x + width}\n            y1={vertical ? x + width : 0 }\n            y2={vertical ? x + width : dHeight }\n            />\n    );\n}\n\n\nD2.propTypes = {\n\tx: PropTypes.number.isRequired,\n\theight: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nD2.defaultProps = {\n\tvertical: false,\n}\nexport const D3 = (props) => {\n    const {x, height, vertical} = props;\n    const width = 0.7;\n    const dHeight = height || '33%';\n    return (\n        <line\n            x1={vertical ? 0 : x + width}\n            x2={vertical ? dHeight : x + width}\n            y1={vertical ? x + width : 0 }\n            y2={vertical ? x + width : dHeight }\n            />\n    );\n}\n\nD3.propTypes = {\n\tx: PropTypes.number.isRequired,\n\theight: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nD3.defaultProps = {\n\tvertical: false,\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1} from '../utils/dash';\n\nconst YearsDash = (props) => {\n\tconst {x, label, vertical} = props;\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-year'}\n\t\t>\n\t\t\t<D1 x={x} vertical={vertical}/>\n\t\t\t{label}\n\t\t</g>\n\t);\n};\n\n\nYearsDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nYearsDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default YearsDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1, D2} from '../utils/dash';\n\nconst MonthDash = (props) => {\n\tconst {x, label, vertical, height} = props;\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-month'}\n\t\t>\n\t\t\t{height === 2 ? <D2 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 1 ? <D1 x={x} vertical={vertical}/> : null}\n\t\t\t{label}\n\t\t</g>\n\t);\n} ;\n\nMonthDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nMonthDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default MonthDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Label from '../utils/textLabel';\nimport YearDash from './YearDash';\nimport MonthDash from '../months/MonthDash';\nimport {getYears, getMonths} from '../utils/interval';\nimport './style.css';\n\nimport _ from 'lodash';\nimport moment from 'moment';\n\nexport const Years = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst yearsCfg = getYears(periodStart, periodEnd);\n\t\n\tconst years = _.map(yearsCfg, year => {\n\t\tlet x = getX(year.start);\n\t\tlet label = <Label label={year.year} vertical={vertical} x={x} height={height} className={'ptr-timeline-year-label'} />\n\t\treturn (<YearDash key={year.year} label={label} x={x} vertical={vertical}/>);\n\t});\n\n\n\tlet months = [];\n\n\t//render every sixth month without label\n\tif(dayWidth > 0.7) {\n\t\tconst monthsCfg = getMonths(periodStart, periodEnd);\n\t\tmonths = _.map(monthsCfg, month => {\n\t\t\tif(month.month === '07') {\n\t\t\t\tlet x = getX(month.start);\n\t\t\t\treturn (<MonthDash key={`${month.year}-${month.month}`} x={x} vertical={vertical}/>);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn (\n\t\t<g className={'levels'}>\n\t\t\t{months}{years.reverse()}\n\t\t</g>\n\t)\n}\n\nYears.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nYears.defaultProps = {\n\tvertical: false,\n}\n\nexport default Years;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Label from '../utils/textLabel';\nimport MonthDash from './MonthDash';\nimport YearDash from '../years/YearDash';\nimport {getYears, getMonths} from '../utils/interval';\nimport './style.css';\n\nimport map from 'lodash/map';\nimport moment from 'moment';\n\nconst Months = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst monthsCfg = getMonths(periodStart, periodEnd);\n\tconst yearsCfg = getYears(periodStart, periodEnd);\n\n\tconst months = map(monthsCfg, month => {\n\t\tif(month.month !== '01') {\n\t\t\tlet x = getX(month.start);\n\t\t\tlet label = null;\n\t\t\tif (dayWidth > 1.5) {\n\t\t\t\tlabel = (\n\t\t\t\t\t<Label label={month.month} vertical={vertical} x={x} height={height} className={'ptr-timeline-month-label'} />\n\t\t\t\t);\n\t\t\t}\n\t\n\t\t\treturn (<MonthDash key={`${month.year}-${month.month}`} x={x} label={label} vertical={vertical} height={2}/>);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\tconst years = map(yearsCfg, year => {\n\t\tlet x = getX(year.start);\n\t\tlet label = <Label label={year.year} vertical={vertical} x={x} height={height} className={'ptr-timeline-year-label'} />\n\t\treturn (<YearDash key={year.year} label={label} x={x} vertical={vertical}/>);\n\t});\n\n\treturn (\n\t\t<g className={'levels'}>\n\t\t\t{months}{years.reverse()}\n\t\t</g>\n\t)\n}\n\n\nMonths.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nMonths.defaultProps = {\n\tvertical: false,\n}\n\nexport default Months;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1, D2, D3} from '../utils/dash';\n\nconst HoursDash = (props) => {\n\tconst {x, label, vertical, height} = props;\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-hour'}\n\t\t>\n\t\t\t{height === 1 ? <D1 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 2 ? <D2 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 3 ? <D3 x={x} vertical={vertical}/> : null}\n\t\t\t{label}\n\t\t</g>\n\t);\n} ;\n\n\nHoursDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nHoursDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default HoursDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1, D2} from '../utils/dash';\n\nconst DaysDash = (props) => {\n\tconst {x, label, vertical, height} = props;\n\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-day'}\n\t\t>\n\t\t\t{height === 1 ? <D1 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 2 ? <D2 x={x} vertical={vertical}/> : null}\n\t\t\t{label}\n\t\t</g>\n\t);\n} ;\n\n\nDaysDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nDaysDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default DaysDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\nimport map from 'lodash/map';\nimport moment from 'moment';\nimport {getYears, getMonths, getDays, getHours} from '../utils/interval';\nimport Label from '../utils/textLabel';\nimport HourDash from '../hours/HourDash';\nimport DayDash from './DayDash';\nimport MonthDash from '../months/MonthDash';\nimport YearDash from '../years/YearDash';\n\nconst Days = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst daysCfg = getDays(periodStart, periodEnd);\n\tconst monthsCfg = getMonths(periodStart, periodEnd);\n\tconst yearsCfg = getYears(periodStart, periodEnd);\n\n\tconst months = map(monthsCfg, month => {\n\t\tif(month.month !== '01') {\n\t\t\tlet x = getX(month.start);\n\t\t\tlet label = (<Label label={month.month} vertical={vertical} x={x} height={height} className={'ptr-timeline-month-label'} />);\n\t\t\treturn (<MonthDash key={`${month.year}-${month.month}`} x={x} label={label} vertical={vertical} height={1}/>);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\tconst years = map(yearsCfg, year => {\n\t\tlet x = getX(year.start);\n\t\tlet label = <Label label={year.year} vertical={vertical} x={x} height={height} className={'ptr-timeline-year-label'} />\n\t\treturn (<YearDash key={year.year} label={label} x={x} vertical={vertical}/>);\n\t});\n\n\tconst days = map(daysCfg, day => {\n\t\tlet x = getX(day.start);\n\t\tlet label = null;\n\t\tif (dayWidth > 17) {\n\t\t\tlabel = (\n\t\t\t\t<Label label={day.day} vertical={vertical} x={x} height={height} className={'ptr-timeline-day-label'} />\n\t\t\t);\n\t\t}\n\t\treturn (<DayDash key={`${day.year}-${day.month}-${day.day}`} label={label} x={x} vertical={vertical} height={2}/>);\n\t});\n\t\n\tlet hours = null;\n\tif (dayWidth > 150) {\n\t\tconst hoursCfg = getHours(periodStart, periodEnd);\n\t\thours = map(hoursCfg, hour => {\n\t\t\tif(hour.hour === '12') {\n\t\t\t\tlet x = getX(hour.start);\n\t\t\t\treturn (<HourDash key={`${hour.year}-${hour.month}-${hour.day}-${hour.hour}`} x={x} vertical={vertical} height={3}/>);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn(\n\t\t<g className={'levels'}>\n\t\t\t{hours}{days}{months}{years.reverse()}\n\t\t</g>\n\t);\n};\n\n\nDays.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nDays.defaultProps = {\n\tvertical: false,\n}\n\n\nexport default Days;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1, D2, D3} from '../utils/dash';\n\nconst MinutesDash = (props) => {\n\tconst {x, label, vertical, height} = props;\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-minute'}\n\t\t>\n\t\t\t{height === 1 ? <D1 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 2 ? <D2 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 3 ? <D3 x={x} vertical={vertical}/> : null}\n\t\t\t{label}\n\t\t</g>\n\t);\n} ;\n\nMinutesDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nMinutesDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default MinutesDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport map from 'lodash/map';\nimport moment from 'moment';\nimport {getMinutes, getDays, getHours} from '../utils/interval';\nimport Label from '../utils/textLabel';\nimport MinuteDash from '../minutes/MinuteDash';\nimport HourDash from './HourDash';\nimport DayDash from '../days/DayDash';\nimport './style.css';\n\nconst Hours = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst hoursCfg = getHours(periodStart, periodEnd);\n\tconst daysCfg = getDays(periodStart, periodEnd);\n\n\tlet days = map(daysCfg, day => {\n\t\tconst x = getX(day.start);\n\t\tconst label = (\n\t\t\t<Label label={day.day} vertical={vertical} x={x} height={height} className={'ptr-timeline-month-label'} />\n\t\t);\n\t\treturn (<DayDash key={`${day.year}-${day.month}-${day.day}`} label={label} x={x} vertical={vertical} height={1}/>);\n\t});\n\n\tlet hours = map(hoursCfg, hour => {\n\t\tlet x = getX(hour.start);\n\n\t\tlet label = null\n\t\tif (dayWidth > 580) {\n\t\t\tlabel = (\n\t\t\t\t<Label label={hour.hour} vertical={vertical} x={x} height={height} className={'ptr-timeline-day-label'} />\n\t\t\t);\n\t\t}\n\n\t\treturn (<HourDash key={`hours-${hour.year}-${hour.month}-${hour.day}-${hour.hour}`} label={label} x={x} vertical={vertical} height={2}/>);\n\t});\n\n\tlet minutes = null;\n\tif (dayWidth > 4000) {\n\t\tconst minutesCfg = getMinutes(periodStart, periodEnd);\n\t\tminutes = map(minutesCfg, minute => {\n\t\t\tif(dayWidth > 7000) {\n\t\t\t\tlet x = getX(minute.start);\n\t\t\t\treturn (<MinuteDash key={`${minute.year}-${minute.month}-${minute.day}-${minute.hour}-${minute.minute}`} x={x} vertical={vertical} height={3}/>);\n\t\t\t} else if(minute.minute === '30') {\n\t\t\t\tlet x = getX(minute.start);\n\t\t\t\treturn (<MinuteDash key={`${minute.year}-${minute.month}-${minute.day}-${minute.hour}-${minute.minute}`} x={x} vertical={vertical} height={3}/>);\n\t\t\t} else if(dayWidth > 6000 && (minute.minute === '15' || minute.minute === '45')) {\n\t\t\t\tlet x = getX(minute.start);\n\t\t\t\treturn (<MinuteDash key={`${minute.year}-${minute.month}-${minute.day}-${minute.hour}-${minute.minute}`} x={x} vertical={vertical} height={3}/>);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t}\n\treturn (\n\t\t<g className={'levels'}>\n\t\t\t{minutes}{hours}{days.reverse()}\n\t\t</g>\n\t)\n}\n\nHours.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nHours.defaultProps = {\n\tvertical: false,\n}\n\nexport default Hours;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport map from 'lodash/map';\nimport moment from 'moment';\nimport {getMinutes, getHours} from '../utils/interval';\nimport Label from '../utils/textLabel';\nimport MinuteDash from './MinuteDash';\nimport HourDash from '../hours/HourDash';\nimport './style.css';\n\nconst Minutes = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst hoursCfg = getHours(periodStart, periodEnd);\n\tconst minutesCfg = getMinutes(periodStart, periodEnd);\n\n\tlet hours = map(hoursCfg, hour => {\n\t\tlet x = getX(hour.start);\n\t\tconst label = (\n\t\t\t\t<Label label={hour.hour} vertical={vertical} x={x} height={height} className={'ptr-timeline-day-label'} />\n\t\t\t);\n\t\treturn (<HourDash key={`minutes-${hour.year}-${hour.month}-${hour.day}-${hour.hour}`} label={label} x={x} vertical={vertical} height={1}/>);\n\t});\n\n\tconst minutes = map(minutesCfg, minute => {\n\t\tlet x = getX(minute.start);\n\t\tlet label = null\n\t\t\n\t\tif(dayWidth > 20000) {\n\t\t\tlabel = (\n\t\t\t\t<Label label={`${minute.hour} : ${minute.minute}`} vertical={vertical} x={x} height={height} className={'ptr-timeline-day-label'} />\n\t\t\t);\n\t\t}\n\n\t\treturn (<MinuteDash key={`minutes-${minute.year}-${minute.month}-${minute.day}-${minute.hour}-${minute.minute}`} label={label} x={x} vertical={vertical} height={3}/>);\n\t});\n\treturn (\n\t\t<g className={'levels'}>\n\t\t\t{minutes}{hours.reverse()}\n\t\t</g>\n\t)\n}\n\nMinutes.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nMinutes.defaultProps = {\n\tvertical: false,\n}\n\nexport default Minutes;\n","import React, {createContext} from 'react'\r\nexport const Context = createContext({\r\n    updateContext: null,\r\n    width: null,\r\n    height: null,\r\n    getX: null,\r\n    getTime: null,\r\n    centerTime: null,\r\n    centerTimeUtc: null,\r\n    getActiveLevel: null,\r\n    dayWidth: null,\r\n    maxDayWidth: null,\r\n    minDayWidth: null,\r\n    periodLimit: null,\r\n    period: null,\r\n    mouseX: null,\r\n    activeLevel: null,\r\n    periodLimitVisible: null,\r\n    onClick: null,\r\n    onHover: null,\r\n    vertical: null,\r\n    periodLimitOnCenter: null,\r\n    selectMode: null,\r\n    moving: null,\r\n});\r\n\r\nexport const ContextProvider = (props) => {\r\n    // const [state, dispatch] =  React.useReducer(reducer, initialState);\r\n    // const value = {state, dispatch};\r\n    const {children, ...propsWithoutChildren} = props;\r\n    return <Context.Provider value={{...propsWithoutChildren.value}}>{children}</Context.Provider>;\r\n}","import React from 'react';\nimport moment from 'moment';\nimport {Context as TimeLineContext} from './context';\n\n/**\n * \n * @param {Event} evt \n * @param {boolean} vertical \n */\nconst getPageXFromEvent = (evt, vertical = false, targetBoudingBox) => {\n\tlet clientX;\n\tconst touch = (evt.touches && evt.touches[0]) || (evt.changedTouches && evt.changedTouches[0])\n\tconst scrollLeft = window.document.documentElement.scrollLeft;\n\tconst scrollTop = window.document.documentElement.scrollTop;\n\tif(touch) {\n\t\tclientX = vertical ? touch.pageY - scrollTop : touch.pageX - scrollLeft;\n\t} else {\n\t\tclientX = vertical ? evt.pageY - scrollTop : evt.pageX - scrollLeft;\n\t}\n\n\tif(vertical) {\n\t\tclientX = clientX - targetBoudingBox.top;  //y position within the element.\n\t} else {\n\t\tclientX = clientX - targetBoudingBox.left;  //y position within the element.\n\t}\n\n\treturn clientX;\n}\n\nconst calculateEventDistance = (point1, point2) => {\n\treturn Math.hypot(point1.clientX - point2.clientX, point1.clientY - point2.clientY)\n}\n\nconst getPoint = (index, cachedEvents, tpCache, targetTouches) => {\n\tconst identifier = tpCache[index].identifier;\n\tlet evIndex = null;\n\tfor (let i = 0; i < targetTouches.length; i++) {\n\t\tconst equals = targetTouches[i].identifier === identifier;\n\t\tif(equals) {\n\t\t\tevIndex = i;\n\t\t}\n\t}\n\n\tif(evIndex) {\n\t\treturn targetTouches[evIndex]\n\t} else {\n\t\treturn tpCache[index];\n\t}\n}\n\nclass TimelineEventsWrapper extends React.PureComponent {\n\tstatic contextType = TimeLineContext;\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.node = React.createRef();\n\t\tthis._drag = null;\n\t\tthis._lastX = null;\n\t\tthis._mouseDownX = null;\n\t\tthis.decelerating = false;\n\t\tthis._pointerLastX = null;\n\t\tthis.multiplier = 5;\n\t\tthis.friction = 0.91; //default 0.92\n\t\tthis.stopThreshold = 0.3;\n\t\tthis.targetX = 0;\n\t\tthis.trackingPoints = [];\n\t\tthis.decVelX = 0;\n\n\t\tthis.onWheel = this.onWheel.bind(this);\n\t\tthis.onPinch = this.onPinch.bind(this);\n\t\tthis.onDrag = this.onDrag.bind(this);\n\t\tthis.onMouseDown = this.onMouseDown.bind(this);\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.onMouseUp = this.onMouseUp.bind(this);\n\t\tthis.onMouseMove = this.onMouseMove.bind(this);\n\t\tthis.onMouseLeave = this.onMouseLeave.bind(this);\n\t\t\n\t\tthis.start_handler = this.start_handler.bind(this);\n\t\tthis.end_handler = this.end_handler.bind(this);\n\t\tthis.move_handler = this.move_handler.bind(this);\n\n\t\t// Global vars to cache event state\n\t\tthis.tpCache = [];\n\t\tthis.prevDiff = -1;\n\t}\n\tcomponentDidMount() {\n\t\tthis.node.current.addEventListener('touchstart', this.start_handler);\n\t\tthis.node.current.addEventListener('touchmove', this.move_handler);\n\t\tthis.node.current.addEventListener('touchend', this.end_handler);\n\t\tthis.node.current.addEventListener('touchcancel', this.end_handler);\n\t}\n\t\n\tcomponentWillUnmount() {\n\t\tthis.node.current.removeEventListener('touchstart', this.start_handler);\n\t\tthis.node.current.removeEventListener('touchmove', this.move_handler);\n\t\t\n\t\tthis.node.current.removeEventListener('touchend', this.end_handler);\n\t\tthis.node.current.removeEventListener('touchcancel', this.end_handler);\n\t}\n\n\tend_handler(ev) {\n\t\tconst {vertical} = this.context;\n\t\tev.preventDefault();\n\t\tconst clientX = getPageXFromEvent(ev, vertical, this.node.current.getBoundingClientRect());\n\t\t\n\t\t//identify stop touch move by one touch\n\t\tif(ev.changedTouches.length === 1 && this.tpCache.length === 1) {\n\t\t\tthis.onPointerUp(clientX)\n\t\t}\n\n\t\t//remove from cache by identifier\t\t\n\t\tfor (let i = 0; i < ev.changedTouches.length; i++) {\n\t\t\tthis.removeTouchEventByIdentifier(ev.changedTouches[i].identifier);\n\t\t}\n\n\t\t//FIX - sometime touchend or touchcancel is not called and touch stick in cache \n\t\tif(ev.touches.length === 0 && this.tpCache.length > 0) {\n\t\t\tthis.clearTouchEventCache();\n\t\t}\n\t}\n\n\tclearTouchEventCache() {\n\t\tthis.tpCache = [];\n\t}\n\n\tremoveTouchEventByIdentifier(identifier) {\n\t\tthis.tpCache = this.tpCache.filter((ev) => {\n\t\t\treturn ev.identifier !== identifier;\n\t\t});\n\t}\n\n\tcacheEvents(evts) {\n\t\tfor (let i=0; i < evts.length; i++) {\n\t\t\tthis.tpCache.push(evts[i]);\n\t\t}\n\t}\n\n\tstart_handler(ev) {\n\t\tconst {vertical} = this.context;\n\t\t// If the user makes simultaneious touches, the browser will fire a \n\t\t// separate touchstart event for each touch point. Thus if there are \n\t\t// three simultaneous touches, the first touchstart event will have \n\t\t// targetTouches length of one, the second event will have a length \n\t\t// of two, and so on.\n\t\tev.preventDefault();\n\t\tif(this.tpCache.length > 0) {\n\t\t\tfor (let i = 0; i < ev.touches.length; i++) {\n\t\t\t\tthis.removeTouchEventByIdentifier(ev.touches[i].identifier);\n\t\t\t}\n\t\t}\n\t\t// Cache the touch points for later processing of 2-touch pinch/zoom\n\t\tthis.cacheEvents(ev.touches);\n\n\t\t//identify only one touch\n\t\tthis.trackingPoints = [];\n\t\tthis._pointerLastX = null;\n\t\tthis.resetMouseTouchProps();\n\t\tif(this.tpCache.length === 1) {\n\t\t\tconst clientX = getPageXFromEvent(ev, vertical, this.node.current.getBoundingClientRect());\n\t\t\tthis.onPointerDown(clientX);\n\t\t}\n\t   }\n\n\tmove_handler(ev) {\n\t\tconst {vertical} = this.context;\n\t\tev.preventDefault();\n\t\t\n\t\t//identify pinch/zoom touch\n\t\tif(this.tpCache.length === 2) {\n\t\t\tthis.handle_pinch_zoom(ev.touches);\n\t\t}\n\t\t\n\t\t//identify touch by one touch\n\t\tif(this.tpCache.length === 1) {\n\t\t\tconst clientX = getPageXFromEvent(ev, vertical, this.node.current.getBoundingClientRect());\n\t\t\tthis.onPointerMove(clientX);\n\n\t\t\tthis.clearTouchEventCache();\n\t\t\t// Cache the touch points for later processing\n\t\t\tthis.cacheEvents([ev.touches[0]]);\n\t   }\n\t}\n\n\tonPointerMove(clientX) {\n\t\tconst distance = clientX - this._lastX;\n\t\tif(distance !== 0) {\n\t\t\tthis.onDrag({\n\t\t\t\tdistance: Math.abs(distance),\n\t\t\t\tdirection: distance < 0 ? 'future': 'past'\n\t\t\t});\n\t\t\tthis.registerMovements(clientX);\n\t\t}\n\t}\n\n\tsetMoving(moving = false) {\n\t\tconst {updateContext} = this.context;\n\t\tupdateContext({\n\t\t\tmoving: moving,\n\t\t});\n\n\t}\n\n\tonPointerDown(clientX) {\n\t\tthis.setMoving(true);\n\t\tthis._drag = true;\n\t\tthis.trackingPoints = [];\n\t\tthis._lastX = clientX;\n\t\tthis._pointerLastX = clientX;\n\t\tthis._mouseDownX = clientX;\n\t\tthis.addTrackingPoint(this._pointerLastX);\n\t}\n\n\tonPointerUp(clientX) {\n\t\tconst isClick = Math.abs(this._mouseDownX - clientX) < 1;\n\t\tthis.resetMouseTouchProps()\n\t\tif (isClick) {\n\t\t\tthis.onClick(clientX)\n\t\t}\n\n\t\tthis.stopTracking();\n\t}\n\n\t// This is a very basic 2-touch move/pinch/zoom handler that does not include\n\t// error handling, only handles horizontal moves, etc.\n\thandle_pinch_zoom(touches) {\n\t\tconst cachedEvents = [];\n\n\t\tfor(let i = 0; i < touches.length; i++) {\n\t\t\tconst found = this.tpCache.findIndex(e => e.identifier === touches[i].identifier);\n\t\t\tif(found > -1) {\n\t\t\t\tcachedEvents[i] = found;\n\t\t\t}\n\t\t}\n\n\t\tconst prevPoint1 = this.tpCache[0];\n\t\tconst prevPoint2 = this.tpCache[1];\n\t\tconst point1 = getPoint(0, cachedEvents, this.tpCache, touches);\n\t\tconst point2 = getPoint(1, cachedEvents, this.tpCache, touches);\n\t\tconst prevDist = calculateEventDistance(prevPoint1, prevPoint2);\n\t\tconst dist = calculateEventDistance(point1, point2);\n\n\t\tthis.clearTouchEventCache();\n\n\t\t// Cache the touch points for later processing of 2-touch pinch/zoom\n\t\tthis.cacheEvents([point1, point2]);\n\t\tconst targetBox = this.node.current.getBoundingClientRect();\n\t\tconst centerPoint = [((point1.clientX + point2.clientX) / 2) - targetBox.left, ((point1.clientY + point2.clientY) / 2) - targetBox.top];\n\t\tthis.onPinch(dist/prevDist, centerPoint)\n   }\n\n   resetMouseTouchProps() {\n\t\tthis._drag = false;\n\t\tthis._lastX = null;\n\t\tthis._mouseDownX = null;\n   }\n\n\tonMouseUp(e) {\t\t\n\t\tconst {vertical} = this.context;\n\t\tconst clientX = getPageXFromEvent(e, vertical, this.node.current.getBoundingClientRect());\n\t\tthis.onPointerUp(clientX);\n\t}\n\n\tonMouseDown(e) {\n\t\tconst {vertical} = this.context;\n\t\tconst clientX = getPageXFromEvent(e, vertical, this.node.current.getBoundingClientRect());\n\t\tthis.onPointerDown(clientX);\n\t}\n\n\tonClick(clientX) {\n\t\tconst {onClick, getTime} = this.context;\n\n\t\tonClick({\n\t\t\ttype: 'time',\n\t\t\tx: clientX,\n\t\t\ttime: getTime(clientX)\n\t\t})\n\t}\n\n\tonMouseMove(e) {\n\t\tconst {vertical, getTime, updateContext, onHover} = this.context;\n\t\tconst clientX = getPageXFromEvent(e, vertical, this.node.current.getBoundingClientRect());\n\t\n\t\tonHover({\n\t\t\tx: e.pageX,\n\t\t\ty: e.pageY,\n\t\t\ttime: getTime(clientX),\n\t\t\tvertical: vertical\n\t\t})\n\t\t\n\t\tupdateContext({\n\t\t\tmouseX: clientX,\n\t\t\tmouseTime: getTime(clientX).toDate()\n\t\t});\n\t\t\n\t\tif(this._drag) {\n\t\t\tthis.onPointerMove(clientX);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\n\t/**\n\t * When the user drags the timeline, if it is still permitted, it updates the available and visible periodLimit and\n\t * therefore redraws the information.\n\t * @param dragInfo {Object}\n\t * @param dragInfo.distance {Number} Amount of pixels to move in given direction\n\t * @param dragInfo.direction {String} Either past or future. Based on this.\n\t */\n\tonDrag(dragInfo) {\n\t\tconst {dayWidth, periodLimit, period, width, updateContext, periodLimitOnCenter} = this.context;\n\t\tconst allDays = width / dayWidth;\n\t\tconst periodStart = moment(periodLimit.start);\n    \tconst periodEnd = moment(periodLimit.end);\n\t\tlet periodLimitStart =  moment(period.start)\n\t\tlet periodLimitEnd = moment(period.end)\n\t\t\n\t\t//center time\n\t\tconst halfDays = allDays / 2;\n\t\tlet periodLimitCenter = moment(period.end).subtract(halfDays * (60 * 60 * 24 * 1000), 'ms')\n\n    \t// Either add  to start and end.\n\t\tlet daysChange = Math.abs(dragInfo.distance) / dayWidth;\n\t\tif(dragInfo.direction === 'past') {\n\t\t\tperiodLimitStart.subtract(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t    \tperiodLimitEnd.subtract(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t\t\tif(periodLimitOnCenter) {\n\t\t\t\tperiodLimitCenter.subtract(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t\t\t\t\n\t\t\t\tif(periodLimitCenter.isBefore(periodStart)) {\n\t\t\t\t\t//use last periodLimit limit\n\t\t\t\t\tperiodLimitStart = moment(period.start);\n\t\t\t\t\tperiodLimitEnd = moment(period.end);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(periodLimitStart.isBefore(periodStart)) {\n\t\t\t\t\t//use last periodLimit limit\n\t\t\t\t\tperiodLimitStart = moment(period.start);\n\t\t\t\t\tperiodLimitEnd = moment(period.end);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t} else {\n\t\t\tperiodLimitStart.add(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t\t\tperiodLimitEnd.add(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t\t\tperiodLimitCenter.add(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\n\t\t\tif(periodLimitOnCenter) {\n\t\t\t\tif(periodLimitCenter.isAfter(periodEnd)) {\n\t\t\t\t\t//use last periodLimit limit\n\t\t\t\t\tperiodLimitStart = moment(period.start);\n\t\t\t\t\tperiodLimitEnd = moment(period.end);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(periodLimitEnd.isAfter(periodEnd)) {\n\t\t\t\t\t//use last periodLimit limit\n\t\t\t\t\tperiodLimitStart = moment(period.start);\n\t\t\t\t\tperiodLimitEnd = moment(period.end);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet widthOfTimeline = width;\n\t\t// If the result is smaller than width of the timeline\n\t\tlet widthOfResult = (periodLimitEnd.diff(periodLimitStart, 'ms') / (60 * 60 * 24 * 1000)) * dayWidth;\n\t\t// Make sure that we stay within the limits.\n\t\tif(widthOfResult < widthOfTimeline) {\n\t\t\tlet daysNeededToUpdate = (widthOfTimeline - widthOfResult) / dayWidth;\n\t\t\tif(dragInfo.direction === 'past') {\n\t\t\t\tperiodLimitEnd.add(daysNeededToUpdate * (60 * 60 * 24 * 1000), 'ms');\n\t\t\t} else {\n\t\t\t\tperiodLimitStart.subtract(daysNeededToUpdate * (60 * 60 * 24 * 1000), 'ms');\n\t\t\t}\n\t\t}\n\n\t\tupdateContext({\n\t\t\tperiod: {\n\t\t\t\tend: periodLimitEnd.toDate().toString(),\n\t\t\t\tstart: periodLimitStart.toDate().toString()\n\t\t\t}\n\t\t});\n\t}\n\n\n\t/**\n\t * Handles move events\n\t * @param  {clientX} ev Normalized event\n\t */\n \t registerMovements(clientX) {\n\t\tthis._lastX = clientX;\n\t\tif (this._drag) {\n\t\t\tthis.addTrackingPoint(this._lastX);\n\t\t}\n\n\t\tconst pointerChangeX = this._lastX - this._pointerLastX;\n\n\t\tthis.targetX += pointerChangeX * this.multiplier;\n\n\t\tthis._pointerLastX = this._lastX;\n\t}\n\n\n\t/**\n\t * Records movement for the last 100ms\n\t * @param {number} x\n\t */\n\taddTrackingPoint(x) {\n\t\tconst time = Date.now();\n\t\twhile (this.trackingPoints.length > 0) {\n\t\t\tif (time - this.trackingPoints[0].time <= 100) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.trackingPoints.shift();\n\t\t}\n\n\t\tthis.trackingPoints.push({x, time});\n\t}\n\n\t/**\n\t * Stops movement tracking, starts animation\n\t */\n\tstopTracking() {\n\t\tthis.addTrackingPoint(this._pointerLastX);\n\t\t\n\t\tthis.startDecelAnim();\n\t}\n\n\n    /**\n     * Initialize animation of values coming to a stop\n     */\n    startDecelAnim() {\n\t\tconst firstPoint = this.trackingPoints[0];\n\t\tconst lastPoint = this.trackingPoints[this.trackingPoints.length - 1];\n  \n\t\tconst xOffset = lastPoint.x - firstPoint.x;\n\t\tconst timeOffset = lastPoint.time - firstPoint.time;\n  \n\t\tconst D = (timeOffset / 15) / this.multiplier;\n  \n\t\tthis.decVelX = (xOffset / D) || 0; // prevent NaN\n  \n\t\t//check difference start/stop\n\t\tif ((Math.abs(this.decVelX) > 1)) {\n\t\t\tthis.decelerating = true;\n\t\t\t// end\n\t\t\trequestAnimFrame(() => this.stepDecelAnim());\n\t\t} else {\n\t\t  this.clearScroll()\n\t\t}\n\t}\n\n\n  /**\n   * Animates values slowing down\n   */\n  stepDecelAnim() {\n    if (!this.decelerating) {\n        return;\n    }\n\n    this.decVelX *= this.friction;\n\n    this.targetX += this.decVelX;\n    \n    if (Math.abs(this.decVelX) > this.stopThreshold) {\n\n\t\tthis.onDrag({\n\t\t\tdistance: Math.abs(this.decVelX),\n\t\t\tdirection: this.decVelX < 0 ? 'future': 'past'\n\t\t});\n\n        requestAnimFrame(this.stepDecelAnim.bind(this));\n    } else {\n        this.clearScroll();\n    }\n  }\n\n\tclearScroll() {\n\t\tthis.setMoving(false);\n\t\tthis.decelerating = false;\n\t  }\n\n\tonMouseLeave(e) {\n\t\tconst {onHover, updateContext} = this.context;\n\t\tthis._drag = false;\n\t\tthis._lastX = null;\n\t\tthis._mouseDownX = null;\n\n\t\tonHover(null);\n\n\t\tupdateContext({\n\t\t\tmouseX: null,\n\t\t\tmouseTime: null\n\t\t});\n\n\t}\n\n\t/**\n\t * Based on the amount of pixels the wheel moves update the size of the visible pixels.\n\t * @param e {SyntheticEvent}\n\t *\n\t */\n\tonWheel(e) {\n\t\tconst {dayWidth} = this.context;\n\t\te.preventDefault();\n\t\tlet change;\n\n\t\tif (e.deltaY > 0) {\n\t\t\t// zoom out\n\t\t\tchange = 1 - Math.abs(e.deltaY / (10 * 100));\n\t\t} else {\n\t\t\t// zoom in\n\t\t\tchange = 1 + Math.abs(e.deltaY / (10 * 100));\n\t\t}\n\n\t\tlet newDayWidth = dayWidth * change;\n\t\tthis.zoom(newDayWidth);\n\t}\n\n\tonPinch(scale, point) {\n\t\tconst {vertical, dayWidth} = this.context;\n\t\tlet zoomX;\n\t\tif(vertical) {\n\t\t\tzoomX = point[1];\n\t\t} else {\n\t\t\tzoomX = point[0];\n\t\t}\n\t\t\n\t\tlet change;\n\t\tif (scale === 1) {\n\t\t\tchange = 1;\n\t\t} else if (scale > 1) {\n\t\t\t// zoom out\n\t\t\tchange = 1 + scale / 10;\n\t\t} else {\n\t\t\t// zoom in\n\t\t\tchange = 1 - scale / 10;\n\t\t}\n\n\t\tlet newDayWidth = dayWidth * change;\n\t\tthis.zoom(newDayWidth, zoomX);\n\t}\n\n\tzoom(newDayWidth, x) {\n\t\tconst {mouseX, getTime, updateContext, periodLimit, period, periodLimitOnCenter, selectMode, maxDayWidth, minDayWidth, width} = this.context;\n\t\tconst zoomX = x || mouseX;\n\t\tconst centerX = width/2;\n\t\tconst mouseTime = zoomX ? getTime(zoomX) : getTime(mouseX);\n\t\tconst centerTime = getTime(centerX);\n\t\tconst periodLimitStart =  moment(period.start)\n\t\tconst periodLimitEnd = moment(period.end)\n\n\t\t\n\t\tif(newDayWidth > maxDayWidth) {\n\t\t\tnewDayWidth = maxDayWidth;\n\t\t}\n\n\t\t//don't allow zoom out outside initial zoom\n\t\tif (newDayWidth < minDayWidth) {\n\t\t\tnewDayWidth = minDayWidth;\n\t\t}\n\n\t\tconst allDays = width / newDayWidth;\n\t\tlet start;\n\t\tlet end;\n\t\tlet beforeMouseDays;\n\t\t\n\t\t\n\t\tif(selectMode) {\n\t\t\tbeforeMouseDays = zoomX / newDayWidth;\n\t\t\tstart = moment(mouseTime).subtract(moment.duration(beforeMouseDays * (60 * 60 * 24 * 1000), 'ms'));\n\t\t\tend = moment(start).add(moment.duration(allDays * (60 * 60 * 24 * 1000), 'ms'));\n\t\t} else {\n\t\t\tbeforeMouseDays = centerX / newDayWidth;\n\t\t\tstart = moment(centerTime).subtract(moment.duration(beforeMouseDays * (60 * 60 * 24 * 1000), 'ms'));\n\t\t\tend = moment(start).add(moment.duration(allDays * (60 * 60 * 24 * 1000), 'ms'));\n\t\t}\n\t\t\n\t\tconst center = moment(start).add(moment.duration((allDays / 2) * (60 * 60 * 24 * 1000), 'ms'));\n\t\t\n\t\t//Don't allow zoom center out of periodLimit\n\t\tif(periodLimitOnCenter) {\n\t\t\tif(center.isBefore(periodLimit.start)) {\n\t\t\t\tconst diff = moment(periodLimit.start).diff(center, 'ms');\n\t\t\t\tstart.add(diff, 'ms')\n\t\t\t\tend.add(diff, 'ms')\n\t\t\t}\n\n\t\t\tif(center.isAfter(periodLimit.end)) {\n\t\t\t\tconst diff = moment(periodLimit.end).diff(center, 'ms');\n\t\t\t\tstart.add(diff, 'ms')\n\t\t\t\tend.add(diff, 'ms')\n\t\t\t}\n\t\t} else {\n\t\t\t//Don`t allow show date out of periodLimit\n\t\t\tif(start.isBefore(periodLimit.start)) {\n\t\t\t\tconst diff = moment(periodLimit.start).diff(periodLimitStart, 'ms');\n\t\t\t\tstart.add(diff, 'ms')\n\t\t\t\tend.add(diff, 'ms')\n\t\t\t}\n\n\t\t\tif(end.isAfter(periodLimit.end)) {\n\t\t\t\tconst diff = moment(periodLimit.end).diff(periodLimitEnd, 'ms');\n\t\t\t\tstart.add(diff, 'ms')\n\t\t\t\tend.add(diff, 'ms')\n\t\t\t}\n\t\t}\n\n\t\tupdateContext({\n\t\t\tperiod: {\n\t\t\t\tstart: start.toDate().toString(),\n\t\t\t\tend: end.toDate().toString()\n\t\t\t},\n\t\t\t//Its possible, that center for new limit is not same as current centerTime because rounding. New center time is usualy lower by one second.\n\t\t\t//this option lock modify select time on zoom when periodLimitOnCenter is set to true.\n\t\t\tlockCenter: periodLimitOnCenter,\n\t\t});\n\t}\n\n\n\trender() {\n\t\tconst {children} = this.props;\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tref={this.node}\n\t\t\t\tonMouseLeave={this.onMouseLeave}\n\t\t\t\tonWheel={this.onWheel}\n\t\t\t\tonMouseDown={this.onMouseDown}\n\t\t\t\tonMouseUp={this.onMouseUp}\n\t\t\t\tonMouseMove={this.onMouseMove}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t);\n\t}\n\n}\n\n\n\n/**\n * @see http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\nconst requestAnimFrame = (function(){\n\treturn window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(callback) {\n\t\twindow.setTimeout(callback, 1000 / 60);\n\t};\n  })();\n  \n\nexport default TimelineEventsWrapper;\n","import React from 'react';\n\nimport {Context as TimeLineContext} from './context';\n\nimport TimelineEventsWrapper from './TimelineEventsWrapper';\n\nimport './style.css';\n\nclass TimelineContent extends React.PureComponent {\n\tstatic contextType = TimeLineContext;\n\n\trender() {\n\t\tconst {periodLimit, height, width,dayWidth, period, mouseX, vertical, activeLevel} = this.context;\n\t\tconst {children} = this.props;\n\n\t\tconst elementWidth = vertical ? height : width;\n\t\tconst elementHeight = vertical ? width : height;\n\t\tconst transform = vertical ? `scale(-1,1) translate(-${height},0)` : '';\n\n\t\tconst childrenWithProps = [];\n\t\tif(children && children.length > 0) {\n\t\t\tchildren.forEach(child => {\n\t\t\t\tconst {children, ...propsWithoutChildren} = this.props;\n\t\n\t\t\t\tchildrenWithProps.push(React.cloneElement(child, {\n\t\t\t\t\t...propsWithoutChildren,\n\t\t\t\t\tperiod: period,\n\t\t\t\t\tperiodLimit: periodLimit,\n\t\t\t\t\tgetX: (dayWidth) => this.context.getX(dayWidth),\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width,\n\t\t\t\t\tdayWidth: dayWidth,\n\t\t\t\t\tvertical: vertical,\n\t\t\t\t\tmouseX: mouseX,\n\t\t\t\t\tactiveLevel: activeLevel,\n\t\t\t\t}))\n\t\t\t})\n\t\t}\n\n\t\treturn (\n\t\t\t\t<TimelineEventsWrapper>\n\t\t\t\t\t<div className=\"ptr-timeline-content\">\n\t\t\t\t\t\t<svg version={\"1.1\"}\n\t\t\t\t\t\t\txmlns={\"http://www.w3.org/2000/svg\"}\n\t\t\t\t\t\t\txmlnsXlink={\"http://www.w3.org/1999/xlink\"} \n     \t\t\t\t\t\twidth={elementWidth}\n\t\t\t\t\t\t\theight={elementHeight}>\n\t\t\t\t\t\t\t<g transform={transform}>\n\t\t\t\t\t\t\t\t{childrenWithProps}\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t</TimelineEventsWrapper>\n\t\t);\n\t}\n\n}\n\nexport default TimelineContent;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport {withResizeDetector} from 'react-resize-detector';\n\nimport {ContextProvider} from './context';\nimport TimelineContent from './timelineContent';\n\nconst CONTROLS_WIDTH = 0;\n\nexport const LEVELS = [\n\t{\n\t\tend: 1,\n\t\tlevel: 'year',\n\t},\n\t{\n\t\tend: 10,\n\t\tlevel: 'month',\n\t},\n\t{\n\t\tend: 250,\n\t\tlevel: 'day',\n\t},\n\t{\n\t\tend: 15000,\n\t\tlevel: 'hour',\n\t},\n\t{\n\t\tend: 70000,\n\t\tlevel: 'minute',\n\t}\n]\n\nconst DEFAULT_VERTICAL_HEIGHT = 70;\nconst DEFAULT_HORIZONTAL_HEIGHT = 45;\n\nclass Timeline extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\tperiodLimit: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}).isRequired,\n\t\tperiod: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}),\n\t\tdayWidth: PropTypes.number,\n\t\tcenterTime: PropTypes.func,\n\t\tcontentHeight: PropTypes.number,\n\t\twidth: PropTypes.number,\n\t\theight: PropTypes.number,\n\t\t\n\t\tonHover: PropTypes.func,\n\t\tonClick: PropTypes.func,\n\n\t\tperiodLimitOnCenter: PropTypes.bool,\n\t\tvertical: PropTypes.bool,\n\t\t\n\t\tlevels: PropTypes.arrayOf(PropTypes.shape({\n\t\t\tend: PropTypes.number,\n\t\t\tlevel: PropTypes.string\n\t\t})),\t\t\t\t\t\t\t\t\t\t//ordered levels by higher level.end \n\t\tonChange: PropTypes.func,\n\t\tselectMode: PropTypes.bool,\t\t\t\t\t//whether change time while zoom \n\t};\n\n\tstatic defaultProps = {\n\t\tdayWidth: 1.5,\n\t\tlevels: LEVELS,\n\t\tonHover: () => {},\n\t\tonClick: () => {},\n\t\twidth: 100,\n\t\theight: 100,\n\t\tselectMode: false,\n\t}\n\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.updateContext = this.updateContext.bind(this);\n\t\tthis.getX = this.getX.bind(this);\n\t\tthis.getTime = this.getTime.bind(this);\n\t\tthis.getActiveLevel = this.getActiveLevel.bind(this);\n\n\n\t\tconst state = this.getStateUpdate({\n\t\t\tperiodLimit: props.periodLimit,\n\t\t\tperiod: props.period || props.periodLimit,\n\t\t\tcenterTime: props.time,\n\t\t})\n\n\t\tthis.state = state;\n\n\t\tif(typeof props.onChange === 'function') {\n\t\t\tprops.onChange(this.state)\n\t\t}\n\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tconst {dayWidth, time, width, height, periodLimit} = this.props;\n\t\t//if parent component set dayWidth\n\t\tif(prevProps.dayWidth !== dayWidth && this.state.dayWidth !== dayWidth) {\n\t\t\tthis.updateContext({dayWidth, centerTime: time})\n\t\t}\n\t\n\t\t//if parent component set time\n\t\tif(prevProps.time && time && (prevProps.time.toString() !== time.toString()) && (this.state.centerTime.toString() !== time.toString())) {\n\n\t\t\tconst period = this.getPeriodLimitByTime(time);\n\n\t\t\t//zoom to dayWidth\n\t\t\tthis.updateContext({period, centerTime: time})\n\t\t}\n\n\t\t//if parent component set time\n\t\tif((prevProps.width !== width) || (prevProps.height !== height)) {\n\t\t\t//pepotat day width aby bylo v period\n\n\t\t\t//todo take time from state\n\t\t\t// const period = this.getPeriodLimitByTime(time);\n\t\t\tconst xAxis = this.getXAxisWidth();\n\t\t\tconst minPeriodDayWidth = this.getDayWidthForPeriod(periodLimit, xAxis);\n\t\t\tlet dayWidth = this.state.dayWidth;\n\t\t\tif(minPeriodDayWidth >= this.state.dayWidth) {\n\t\t\t\tdayWidth = minPeriodDayWidth;\n\t\t\t}\n\t\t\tconst period = this.getPeriodLimitByTime(this.state.centerTime, xAxis, periodLimit, dayWidth)\n\n\t\t\t//zoom to dayWidth\n\t\t\tthis.updateContext({period})\n\t\t}\n\t}\n\n\tgetPeriodLimitByTime(time, axesWidth = this.getXAxisWidth(), periodLimit = this.state.periodLimit, dayWidth = this.state.dayWidth) {\n\t\tconst allDays = axesWidth / dayWidth;\n\t\tlet setTime = moment(time);\n\n\t\t//check if setTime is in periodLimit\n\t\tif (setTime.isBefore(periodLimit.start)){\n\t\t\tsetTime = periodLimit.start\n\t\t}\n\n\t\tif (setTime.isAfter(periodLimit.end)){\n\t\t\tsetTime = periodLimit.end\n\t\t}\n\n\t\tconst halfDays = allDays / 2;\n\t\tconst start = moment(setTime).subtract(moment.duration(halfDays * (60 * 60 * 24 * 1000), 'ms')).toDate().toString();\n\t\tconst end = moment(setTime).add(moment.duration(halfDays * (60 * 60 * 24 * 1000), 'ms')).toDate().toString();\n\t\treturn {\n\t\t\tstart,\n\t\t\tend\n\t\t}\n\t}\n\n\tgetX(date) {\n\t\tdate = moment(date);\n\t\tlet diff = date.unix() - moment(this.state.period.start).unix();\n\t\tlet diffDays = diff / (60 * 60 * 24);\n\t\treturn diffDays * this.state.dayWidth;\n\t}\n\n\tgetTime(x, dayWidth = this.state.dayWidth, startTime = this.state.period.start) {\n\t\tlet diffDays = x / dayWidth;\n\t\tlet diff = diffDays * (60 * 60 * 24 * 1000);\n\t\treturn moment(startTime).add(moment.duration(diff, 'ms'));\n\t}\n\n\t//Find first level with smaller start level.\n\tgetActiveLevel(dayWidth) {\n\t\tconst {levels} = this.props;\n\t\treturn levels.find((l) => dayWidth <= l.end)\n\t}\n\n\n\tgetDayWidthForPeriod(periodLimit, axesWidth, maxDayWidth = this.getMaxDayWidth()) {\n\t\tconst start = moment(periodLimit.start);\n\t\tconst end = moment(periodLimit.end);\n\n\t\tconst diff = end.diff(start, 'ms');\n\t\tconst diffDays = diff / (60 * 60 * 24 * 1000);\n\n\t\tlet dayWidth = (axesWidth - CONTROLS_WIDTH) / diffDays;\n\t\tif(dayWidth > maxDayWidth) {\n\t\t\tdayWidth = maxDayWidth;\n\t\t}\n\n\t\treturn dayWidth;\n\t}\n\n\tgetPeriodLimitByDayWidth(dayWidth) {\n\t\tconst {centerTime} = this.state;\n\n\t\tconst allDays = this.getXAxisWidth() / dayWidth;\n\t\tconst halfMouseDays = allDays / 2;\n\n\t\tconst start = moment(centerTime).subtract(moment.duration(halfMouseDays * (60 * 60 * 24 * 1000), 'ms')).toDate().toString();\n\t\tconst end = moment(centerTime).add(moment.duration(halfMouseDays * (60 * 60 * 24 * 1000), 'ms')).toDate().toString();\n\t\treturn {\n\t\t\tstart,\n\t\t\tend\n\t\t}\n\t}\n\n\tupdateContext(options) {\n\t\tif (options) {\n\t\t\tconst stateUpdate = this.getStateUpdate(options);\n\t\t\tthis.setState(stateUpdate, () => {\n\t\t\t\tif(typeof this.props.onChange === 'function') {\n\t\t\t\t\tthis.props.onChange(this.state);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tgetStateUpdate(options) {\n\t\tconst {levels, periodLimit} = this.props;\n\n\t\tif (options) {\n\t\t\tconst updateContext = {};\n\t\t\tObject.assign(updateContext, {...options});\n\t\t\t\n\t\t\t//on change dayWidth calculate period\n\t\t\tif(options.dayWidth) {\n\t\t\t\tObject.assign(updateContext, {period: this.getPeriodLimitByDayWidth(options.dayWidth)})\n\t\t\t}\n\t\t\t\n\t\t\t//on change period calculate dayWidth\n\t\t\tif(options.period) {\n\t\t\t\tObject.assign(updateContext, {dayWidth: this.getDayWidthForPeriod(options.period, this.getXAxisWidth())})\n\t\t\t}\n\n\t\t\tif(updateContext.dayWidth) {\n\t\t\t\tObject.assign(updateContext, {activeLevel: this.getActiveLevel(updateContext.dayWidth, levels).level})\n\t\t\t}\n\n\t\t\tif(updateContext.dayWidth && !options.centerTime && !options.lockCenter) {\n\t\t\t\tObject.assign(updateContext, {centerTime: this.getTime(this.getXAxisWidth() / 2, updateContext.dayWidth, updateContext.period.start).toDate()})\n\t\t\t}\n\n\t\t\tif(options.centerTime && !updateContext.period) {\n\t\t\t\tObject.assign(updateContext, {period: this.getPeriodLimitByTime(options.centerTime, this.getXAxisWidth(), periodLimit, updateContext.dayWidth)})\n\t\t\t}\n\n\t\t\tif(updateContext.centerTime) {\n\t\t\t\tconst utcTime = new Date(updateContext.centerTime);\n\t\t\t\tutcTime.setTime( utcTime.getTime() - utcTime.getTimezoneOffset()*60*1000 )\n\t\t\t\tObject.assign(updateContext, {centerTimeUtc:utcTime.toUTCString()})\n\t\t\t}\n\t\t\treturn updateContext\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t}\n\n\tgetMaxDayWidth(levels = this.props.levels) {\n\t\tconst lastLevel = levels[levels.length - 1];\n\t\tconst maxDayWidth = lastLevel.end;\n\t\treturn maxDayWidth;\n\t}\n\n\tgetXAxisWidth() {\n\t\tconst {width, height, vertical} = this.props;\n\t\treturn vertical ? height : width;\n\t}\n\n\tgetContentHeight() {\n\t\tconst {contentHeight, vertical} = this.props;\n\t\treturn contentHeight || (vertical ? DEFAULT_VERTICAL_HEIGHT : DEFAULT_HORIZONTAL_HEIGHT);\n\t}\n\n\trender() {\n\t\tconst {levels, periodLimit, onHover, onClick, vertical, children, periodLimitOnCenter, selectMode} = this.props;\n\t\tconst {dayWidth, period, mouseX, moving} = this.state;\n\n\t\tconst maxDayWidth = this.getMaxDayWidth();\n\t\tconst activeDayWidth = dayWidth >= maxDayWidth ? maxDayWidth : dayWidth;\n\t\tconst activeLevel = this.getActiveLevel(activeDayWidth, levels).level;\n\t\tconst minDayWidth = this.getDayWidthForPeriod(periodLimit, this.getXAxisWidth())\n\t\treturn (\n\t\t\t<ContextProvider value={{\n\t\t\t\tupdateContext: this.updateContext,\n\t\t\t\twidth: this.getXAxisWidth(),\n\t\t\t\theight: this.getContentHeight(),\n\t\t\t\tgetX: this.getX,\n\t\t\t\tgetTime: this.getTime,\n\t\t\t\tcenterTime: this.state.centerTime,\n\t\t\t\tgetActiveLevel: this.getActiveLevel,\n\t\t\t\tdayWidth,\n\t\t\t\tmaxDayWidth,\n\t\t\t\tminDayWidth,\n\t\t\t\tperiodLimit,\n\t\t\t\tperiod,\n\t\t\t\tmouseX,\n\t\t\t\tactiveLevel,\n\t\t\t\tperiodLimitVisible: true,\n\t\t\t\tonClick,\n\t\t\t\tonHover,\n\t\t\t\tvertical,\n\t\t\t\tperiodLimitOnCenter,\n\t\t\t\tselectMode,\n\t\t\t\tmoving,\n\t\t\t\t}}>\n\t\t\t\t<TimelineContent>\n\t\t\t\t\t{children}\n\t\t\t\t</TimelineContent>\n\t\t\t</ContextProvider>\n\t\t);\n\n\t}\n\n}\n\nexport default withResizeDetector(Timeline);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\n\nimport TimeLineHover from '../TimeLine/TimeLineHover';\nimport HoverHandler from '../HoverHandler/HoverHandler';\nimport {getTootlipPosition} from \"../HoverHandler/position\";\nimport {isInside} from '../../utils/period';\n\nimport Picker from '../TimeLine/centerPicker';\nimport Mouse from '../TimeLine/mouse';\nimport Overlays from '../TimeLine/overlay';\nimport PeriodLimit from '../TimeLine/periodLimit';\n\nimport Years from '../TimeLine/years';\nimport Months from '../TimeLine/months';\nimport Days from '../TimeLine/days';\nimport Hours from '../TimeLine/hours';\nimport Minutes from '../TimeLine/minutes';\nimport Timeline from '../TimeLine';\n\nconst TOOLTIP_PADDING = 5;\nconst MOUSE_BUFFER_WIDTH = 5;\n\nconst LevelElement = (props) => {\n\tconst {activeLevel} = props;\n\tswitch (activeLevel) {\n\t\tcase 'year':\n\t\t\treturn React.createElement(Years, props);\n\t\tcase 'month':\n\t\t\treturn React.createElement(Months, props);\n\t\tcase 'day':\n\t\t\treturn React.createElement(Days, props);\n\t\tcase 'hour':\n\t\t\treturn React.createElement(Hours, props);\n\t\tcase 'minute':\n\t\t\treturn React.createElement(Minutes, props);\n\t\tdefault:\n\t\t\treturn React.createElement(Years, props);\n\t}\n}\n\nclass MapsTimeline extends React.PureComponent {\n\tconstructor (props) {\n\t\tsuper(props);\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.getHoverContent = this.getHoverContent.bind(this);\n\t\tthis.getTooltipStyle = this.getTooltipStyle.bind(this);\n\t}\n\n\tstatic propTypes = {\n\t\tperiod: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}).isRequired,\n\t\tinitialPeriod: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}).isRequired,\n\t\tdayWidth: PropTypes.number, //1.5\n\t\t// layers: , //for tooltip\n\t\tcontainerWidth: PropTypes.number,\n\t\tcontainerHeight: PropTypes.number,\n\t\tonChange: PropTypes.func,\n\t\tactiveLevel: PropTypes.string,\n\t\tonTimeClick: PropTypes.func,\n\t\tvertical: PropTypes.bool,\n\t};\n\n\tonClick(evt) {\n\t\tconst {onTimeClick, onClick} = this.props\n\t\tswitch (evt.type) {\n\t\t\tcase 'time':\n\t\t\t\tif(typeof onTimeClick === 'function') {\n\t\t\t\t\tonTimeClick(evt);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif(typeof onClick === 'function') {\n\t\t\t\t\tonClick(evt);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonTimelineChange(timelineState) {\n\t\tif(typeof this.props.onChange === 'function') {\n\t\t\tthis.props.onChange(timelineState);\n\t\t}\n\t}\n\n\tgetOverlaysContent(x, time) {\n\t\tconst {overlays} = this.props;\n\n\t\tconst content = []\n\t\tconst hoveredOverlays = overlays.filter(o => isInside(o, time));\n\t\tconst hoveredOverlaysContent = hoveredOverlays.map(o => {\n\t\t\treturn (<div className={'hover-overlay'} key={o.key}>\n\t\t\t\t\t\t<span className=\"dot\" style={{backgroundColor: o.backdroundColor}}></span>\n\t\t\t\t\t\t<span>{o.label}</span>\n\t\t\t\t\t</div>)\n\t\t})\n\n\t\tcontent.push(...hoveredOverlaysContent);\n\t\treturn content;\n\t}\n\n\tgetHoverContent(x, time) {\n\t\tconst overlaysContent = this.getOverlaysContent(x, time);\n\t\treturn (\n\t\t\t<div>\n\t\t\t\ttime: {` ${time.format(\"YYYY MM D H:mm:ss\")}`}\n\t\t\t\t{overlaysContent}\n\t\t\t</div>\n\t\t)\n\t}\n\n\tgetTooltipStyle() {\n\t\tconst referencePoint = 'center';\n\t\treturn () => {\n\t\t\tconst windowScrollTop = window.document.documentElement.scrollTop;\n\t\t\tconst windowScrollLeft = window.document.documentElement.scrollLeft;\n\t\t\tconst windowHeight = window.document.documentElement.clientHeight;\n\t\t\tconst windowWidth = window.document.documentElement.clientWidth;\n\t\t\tconst windowBBox = [windowScrollTop, windowScrollLeft + windowWidth, windowScrollTop + windowHeight, windowScrollLeft];\n\t\t\treturn getTootlipPosition(referencePoint, ['left', 'top', 'right', 'bottom'], windowBBox, TOOLTIP_PADDING)\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {activeLevel, time, overlays, LEVELS, containerWidth, containerHeight, dayWidth, period, initialPeriod, vertical} = this.props; // consume unneeded props (though we'll probably use them in the future)\n\n\t\treturn (\n\t\t\t<div className={'ptr-timeline-container'}>\n\t\t\t\t<HoverHandler getStyle={this.getTooltipStyle()}>\n\t\t\t\t\t<TimeLineHover getHoverContent={this.getHoverContent}>\n\t\t\t\t\t\t<Timeline \n\t\t\t\t\t\t\tdayWidth={dayWidth}\n\t\t\t\t\t\t\tperiodLimit={period}\n\t\t\t\t\t\t\tmouseBufferWidth= {MOUSE_BUFFER_WIDTH}\n\t\t\t\t\t\t\tselectedDate= {null}\n\t\t\t\t\t\t\tonChange= {(timelineState) => {this.onTimelineChange(timelineState)}}\n\t\t\t\t\t\t\tactiveLevel={activeLevel}\n\t\t\t\t\t\t\ttime={time}\n\t\t\t\t\t\t\tLEVELS={LEVELS}\n\t\t\t\t\t\t\tcontainerWidth={containerWidth}\n\t\t\t\t\t\t\tcontainerHeight={containerHeight}\n\t\t\t\t\t\t\tonClick= {this.onClick}\n\t\t\t\t\t\t\tvertical={vertical}\n\t\t\t\t\t\t\tperiod={initialPeriod}\n\t\t\t\t\t\t\tperiodLimitOnCenter={true}\n\t\t\t\t\t\t\tselectMode={false}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<PeriodLimit key=\"periodLimit\"/>\n\t\t\t\t\t\t\t<Overlays overlays={overlays} key=\"overlays\"/>\n\t\t\t\t\t\t\t<LevelElement key=\"levelElement\"/>\n\t\t\t\t\t\t\t<Picker key=\"picker\"/>\n\t\t\t\t\t\t\t<Mouse mouseBufferWidth={20} key=\"mouse\"/>\n\t\t\t\t\t\t</Timeline>\n\t\t\t\t\t</TimeLineHover>\n\t\t\t\t</HoverHandler>\t\t\t\t\n\t\t\t</div>\n\t\t)\n\t}\n\n}\n\nconst areEqual = (prevProps, props) => {\n    const {activeLevel, vertical, period, initialPeriod, time, overlays, LEVELS, dayWidth} = props;\n\tconst {activeLevel: prevActiveLevel, vertical: prevVertical, period: prevPeriod, initialPeriod: prevInitialPeriod, time: prevTime, overlays: prevOverlays, LEVELS: prevLEVELS, dayWidth: prevDayWidth} = prevProps;\n    return prevActiveLevel===activeLevel && prevVertical===vertical && prevPeriod===period && prevInitialPeriod===initialPeriod && (prevTime &&prevTime.toString())===(time && time.toString()) && overlays === prevOverlays && LEVELS === prevLEVELS && dayWidth === prevDayWidth;\n}\nexport default React.memo(MapsTimeline, areEqual);","import React from 'react';\nimport Presentation from './presentation';\nimport select from '../../context/selectors/';\nimport {withContext} from '../../context/withContext';\nimport {convertToUTC} from '../../utils/date';\nimport {LEVELS} from '../TimeLine';\nimport moment from 'moment';\nimport {\n    setPreventReloadLayers,\n    updateComponent,\n    scrollToTime,\n    changeSelectTime,\n    stopFollowNow,\n    stopTimer,\n} from '../../context/actions';\n\n\nimport period from '../../utils/period'\nimport {getNowUTCString} from '../../utils/date'\n\nconst now = moment(getNowUTCString());\nconst start = now.clone().subtract(1, 'w');\nconst end = now.clone().add(1, 'w');\nconst initialTimelinePeriod = period(`${start.format('YYYY-MM-DD')}/${end.format('YYYY-MM-DD')}`);\nconst strInitialTimelinePeriod = {\n\tstart: initialTimelinePeriod.start.toDate().toUTCString(),\n\tend: initialTimelinePeriod.end.toDate().toUTCString(),\n}\n\n\nconst MapsTimeline = (props) => {\n    const {dispatch, state} = props;\n\n\tconst vertical = select.rootSelectors.getLandscape(state);\n\tconst periodLimit = select.rootSelectors.getPeriodLimit(state);\n\tconst timelineState = select.components.timeline.getSubstate(state);\n    const timelineOverlays = select.components.timeline.getOverlays(state);\n    const selectTime = select.rootSelectors.getSelectTime(state)\n    const time = selectTime ? convertToUTC(selectTime) : null;\n\tconst onTimeChange = (timelineState) => {\n        const {state} = props;\n        const curTimelineState = select.components.timeline.getSubstate(state);\n        \n        if(timelineState.moving !== curTimelineState.moving) {\n            dispatch(updateComponent('timeline', {moving: timelineState.moving}))\n        }\n        \n        if(selectTime && timelineState.centerTimeUtc && timelineState.centerTimeUtc !== selectTime.toGMTString()) {\n            dispatch(stopFollowNow());\n            dispatch(stopTimer());\n            dispatch(changeSelectTime(timelineState.centerTimeUtc, dispatch, selectTime, state));\n        }\n\n        if(timelineState.activeLevel && timelineState.activeLevel !== curTimelineState.activeTimeLevel) {\n            dispatch(updateComponent('timeline', {activeTimeLevel: timelineState.activeLevel}))\n        }\n\n        if(timelineState.mouseTime !== curTimelineState.mouseTime) {\n            dispatch(updateComponent('timeline', {mouseTime: timelineState.mouseTime ? timelineState.mouseTime.getTime() - timelineState.mouseTime.getTimezoneOffset()*60*1000 : null}))\n        }\n\n        if(timelineState.dayWidth && timelineState.dayWidth !== curTimelineState.dayWidth) {\n            dispatch(updateComponent('timeline', {dayWidth: timelineState.dayWidth}))\n        }\n\t}\n\n\tconst onTimeClick = (evt) => {\n        const {state} = props;\n        const periodLimit = select.rootSelectors.getPeriodLimit(state);\n        dispatch(stopFollowNow());\n        dispatch(stopTimer());\n\n        dispatch(setPreventReloadLayers(true));\n        scrollToTime(state, dispatch, new Date(select.rootSelectors.getSelectTime(state)), moment(evt.time.toDate().getTime() - evt.time.toDate().getTimezoneOffset()*60*1000), periodLimit, () => {\n            dispatch(setPreventReloadLayers(false));\n        });\n\t}\n\n    return (\n        <Presentation \n\t\t\tactiveLevel={timelineState.activeTimeLevel}\n\t\t\tvertical = {vertical}\n\t\t\tperiod = {periodLimit}\n\t\t\tinitialPeriod = {strInitialTimelinePeriod}\n\t\t\t// onLayerPeriodClick: this.onLayerPeriodClick,\n\t\t\tonChange = {onTimeChange}\n\t\t\ttime={time}\n\t\t\toverlays={timelineOverlays}\n\t\t\tLEVELS={LEVELS}\n\t\t\tdayWidth={timelineState.dayWidth}\n\t\t\tonTimeClick={onTimeClick}\n            />\n    )\n}\n\nexport default withContext(MapsTimeline);","import React from 'react';\nimport moment from 'moment';\nimport classnames from 'classnames';\nimport './style.css';\n\nclass TimeWidget extends React.PureComponent{\n    constructor(props) {\n        super(props);\n        this.state = {\n            timer: null,\n        }\n\n        this.tick = this.tick.bind(this);\n        this.stopTimer = this.stopTimer.bind(this);\n        this.startTimer = this.startTimer.bind(this);\n    }\n\n    tick() {\n        const {onSetTime, trackTimeActive, time} = this.props;\n        const selectTime = time ? moment(time).utc() : null;\n\n        if(trackTimeActive && selectTime && this.state.timer) {\n            onSetTime(selectTime.add(1, 'second').toDate().toUTCString());\n        }\n    }\n\n    stopTimer() {\n        const {onStopTimer,onStopFollowNow, nowActive} = this.props;\n        if(nowActive) {\n            onStopFollowNow();\n        }\n        if(this.state.timer) {\n            window.clearInterval(this.state.timer);\n            this.setState({timer: null});\n            onStopTimer();\n        }\n    }\n    startTimer() {\n        const {onStartTimer} = this.props;\n        if(this.state.timer) {\n            this.stopTimer();\n        }\n        const timer = window.setInterval(this.tick, 1000);\n        this.setState({timer});\n        onStartTimer();\n    }\n\n    render() {\n        const {time, mouseTime, nowActive, active, onSelectActive, onStartFollowNow, onStopFollowNow, trackTimeActive} = this.props;\n        const currentTime = time ? moment(time) : null;\n        const mouseTimeMom = mouseTime ? moment(mouseTime) : null;\n        const timeMom = mouseTimeMom || currentTime;\n        if(timeMom) {\n            timeMom.utc();\n        }\n        const classes = classnames('time-widget', {\n            'mouse-time': mouseTimeMom\n        })\n        return (\n            <div className={classes}>\n                {timeMom ?\n                <>\n                    <div onClick={() => (trackTimeActive || nowActive) ? this.stopTimer() : this.startTimer()} className={`now time-cell ${(trackTimeActive || nowActive) ? 'active' : '' }`}>\n                        Play\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n                    <div onClick={() => nowActive ? onStopFollowNow() : onStartFollowNow()} className={`now time-cell ${nowActive ? 'active' : '' }`}>\n                        NOW\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n                    <div className={`time-cell ${active === 'month' ? 'active' : '' }`} onClick={() => onSelectActive('month')}>\n                        <span className={'month'}>\n                            {timeMom.format('MMM')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n\n                    <div className={`time-cell ${active === 'day' ? 'active' : '' }`} onClick={() => onSelectActive('day')}>\n                        <span className={'day'}>\n                            {timeMom.format('DD')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n\n                    <div className={`time-cell ${active === 'year' ? 'active' : '' }`} onClick={() => onSelectActive('year')}>\n                        <span className={'year'}>\n                            {timeMom.format('YYYY')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n\n                    <div className={`time-cell ${active === 'hour' ? 'active' : '' }`} onClick={() => onSelectActive('hour')}>\n                        <span>\n                            {timeMom.format('HH')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>:\n\n                    <div className={`time-cell ${active === 'minute' ? 'active' : '' }`} onClick={() => onSelectActive('minute')}>\n                        <span>\n                            {timeMom.format('mm')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>:\n\n                    <div>\n                        <span>\n                            {timeMom.format('ss')}\n                        </span>\n                    </div>\n                </> : null}\n            </div>\n        )\n    }\n}\n\nconst areEqual = (prevProps, props) => {\n    const {time, active, nowActive, trackTimeActive, mouseTime} = props;\n    const {time: prevTime, active: prevActive, nowActive: prevNowActive, trackTimeActive: prevTrackTimeActive, mouseTime: prevMouseTime} = prevProps;\n    return prevTime===time && prevActive===active && prevNowActive===nowActive && prevTrackTimeActive===trackTimeActive && prevMouseTime===mouseTime\n}\nexport default React.memo(TimeWidget, areEqual);","import React, {useEffect, useRef} from 'react';\nimport moment from 'moment';\nimport Presentation from './presentation';\nimport select from '../../context/selectors/';\nimport {withContext} from '../../context/withContext';\nimport {LEVELS} from '../TimeLine';\nimport {getNowUTCString} from '../../utils/date'\nimport {\n    setFollowNow,\n    scrollToTime,\n    zoomToTimeLevel,\n    changeSelectTime,\n    stopTimer,\n    startTimer,\n    stopFollowNow,\n} from '../../context/actions';\n\nconst TimeWidget = (props) => {\n    const {dispatch, state} = props;\n    const timelineState = select.components.timeline.getSubstate(state);\n    \n    const ref = useRef();\n    useEffect(() => {\n        ref.current = state;\n    })\n\n    const onSetActiveTimeLevel = (level) => {\n        const {state} = props;\n        const timelineState = select.components.timeline.getSubstate(state);\n        const timeLevelDayWidth = LEVELS.find(l => l.level === level).end;\n        zoomToTimeLevel(dispatch, level, timeLevelDayWidth, timelineState.dayWidth);\n    }\n\n    const onSetTime = (time) => {\n        //ref.current is state\n        dispatch(changeSelectTime(time, dispatch, select.rootSelectors.getSelectTime(ref.current), ref.current));\n    }\n\n    const onStartFollowNow = () => {\n        const {state} = props;\n        const selectTime = select.rootSelectors.getSelectTime(state);\n        const periodLimit = select.rootSelectors.getPeriodLimit(state);\n        const scrollTime = selectTime ? moment(selectTime) : getNowUTCString();\n        dispatch(stopTimer());\n        dispatch(setFollowNow(true));\n        scrollToTime(state, dispatch, scrollTime, moment(getNowUTCString()), periodLimit, () => {\n            dispatch(setFollowNow(true));\n        });\n    }\n\n    const onStopFollowNow = () => {\n        dispatch(stopFollowNow());\n    }\n\n    const onStartTimer = () => {\n        dispatch(startTimer());\n    }\n\n    const onStopTimer = () => {\n        dispatch(stopTimer());\n    }    \n\n    return (\n        <Presentation \n            time={select.rootSelectors.getSelectTime(state)}\n            active={timelineState.activeTimeLevel}\n            onSelectActive={onSetActiveTimeLevel}\n            onSetTime={onSetTime}\n            onStartFollowNow={onStartFollowNow}\n            onStopFollowNow={onStopFollowNow}\n            onStartTimer={onStartTimer}\n            onStopTimer={onStopTimer}\n            nowActive={select.rootSelectors.getFollowNow(state)}\n            trackTimeActive={select.rootSelectors.getTrackTimeActive(state)}\n            // mouseTime={timelineState.mouseTime}\n            mouseTime={null}\n            />\n    )\n\n}\n\nexport default withContext(TimeWidget);","import React, {useEffect} from 'react';\nimport PropTypes from \"prop-types\";\nimport Icon from '../atoms/Icon';\nimport usePrevious from '../../utils/hooks/usePrevious';\nimport Button from '../atoms/Button';\nimport { css } from '@emotion/core'\nimport './style.scss';\n\nconst closeIconStyle = {\n  width: '1.5rem',\n};\n\nconst closeStyle = {\n  display: 'flex',\n  flexFlow: 'column',\n  position: 'absolute',\n  cursor: 'pointer',\n  top: '0px',\n  right: '0px',\n  fill: 'rgb(226, 236, 249)',\n  stroke: 'rgb(226, 236, 249)',\n  ':hover:focus': {\n      fill: 'rgb(93, 93, 253)',\n      stroke: 'rgb(93, 93, 253)',        \n  }\n}\n\nconst getSatPairsInString = (satPairs = []) => {\n  return satPairs.map((a) => `${a[0]}-${a[1].join(',')}`).join(',');\n}\n\nconst SearchToolbarPresentation = (props) => {\n    const {onClose, vertical, onPreviousResultClick, onNextResultClick, loading, displayNoProductsActive, activeSatProductsPairs, onSearchParamsChanged, geometry, activeProduct} = props;\n\n    const prevAmount = usePrevious({activeSatProductsPairs, geometry});\n\n    useEffect(() => {\n      if(prevAmount) {\n        const activeSatProductsPairsSame = (prevAmount.activeSatProductsPairs === activeSatProductsPairs) || (prevAmount.activeSatProductsPairs && getSatPairsInString(prevAmount.activeSatProductsPairs) === (activeSatProductsPairs && getSatPairsInString(activeSatProductsPairs)));\n        const geometryChanged = prevAmount.geometry !== geometry;\n        if(!activeSatProductsPairsSame || geometryChanged) {\n          onSearchParamsChanged();\n        }\n      }\n    });\n\n    return (<div className={'search-toolbar'}>\n            { !displayNoProductsActive && loading ? <div>loading</div> : null}\n            { displayNoProductsActive ? <div>No products selected</div> : null}\n            { !loading && !displayNoProductsActive &&!activeProduct && activeSatProductsPairs ? <div>No data</div> : null}\n            {!loading && activeProduct ? \n              <>\n                <Button \n                  ghost\n                  onClick={() => onPreviousResultClick()}\n                  disabled = {onPreviousResultClick === null}\n                  >\n                    Previous\n                </Button>\n                <div className={'title'}>\n                  {activeProduct.title}\n                </div>\n                <Button \n                  ghost\n                  onClick={() => onNextResultClick()}\n                  disabled = {onNextResultClick === null}\n                  >\n                    next\n                </Button>\n              </> : null\n            }\n            <span onClick={() => {onClose()}} style={closeStyle}>\n              <Icon icon={'times'} style={closeIconStyle}/>\n            </span>\n    </div>)\n}\n\nSearchToolbarPresentation.propTypes = {\n    vertical: PropTypes.bool,\n    onClose: PropTypes.func,\n    onPreviousResultClick: PropTypes.func,\n    onNextResultClick: PropTypes.func,\n    loading: PropTypes.bool,\n    displayNoProductsActive: PropTypes.bool,\n    activeSatProductsPairs: PropTypes.array,\n    onSearchParamsChanged: PropTypes.func,\n    geometry: PropTypes.object,\n    activeProduct: PropTypes.object,\n  }\n\n  SearchToolbarPresentation.defaultProps = {\n    vertical:false,\n    onClose:() => {},\n    onPreviousResultClick: () => {},\n    onNextResultClick: () => {},\n    loading: false,\n    displayNoProductsActive: false,\n    activeSatProductsPairs: [],\n    onSearchParamsChanged: () => {},\n    geometry: null,\n    activeProduct: null,\n  }\n\nexport default SearchToolbarPresentation;","import {useRef, useEffect} from 'react';\n\n// https://stackoverflow.com/questions/53446020/how-to-compare-oldvalues-and-newvalues-on-react-hooks-useeffect\n// https://blog.logrocket.com/how-to-get-previous-props-state-with-react-hooks/\nexport default (value) => {\n    const ref = useRef();\n    useEffect(() => {\n      ref.current = value;\n    });\n    return ref.current;\n  }","import React from 'react';\nimport Presentation from './presentation';\nimport {withContext} from '../../context/withContext';\nimport select from '../../context/selectors/';\n\nimport {\n    setVisibility,\n    setActiveIndexAndUpdateTime,\n    updateSearch,\n} from '../../context/actions/components/searchToolbar';\n\nimport {\n    setTrackTime,\n    stopFollowNow,\n    stopTimer\n} from '../../context/actions';\n\n\nconst SearchToolbar = ({dispatch, state}) => {\n    //info modal state\n    // const activeInfoModalKey = select.rootSelectors.getActiveInfoModalKey(state);\n    // const activeInfoModal = select.rootSelectors.getInfoModal(state, activeInfoModalKey);\n    // const visible = !!activeInfoModalKey && activeInfoModal.type === 'SEARCH';\n    // const coordinates = visible ? activeInfoModal.coordinates : null;\n    const vertical = select.rootSelectors.getLandscape(state);\n    const loading = select.components.searchToolbar.getLoading(state);\n    const activeResultIndex = select.components.searchToolbar.getActiveResultIndex(state);\n    const lastResultIndex = select.components.searchToolbar.getLastResultIndex(state);\n    const geometry = select.components.searchToolbar.getGeometry(state);\n    const previousResultIndex = activeResultIndex !== 0 ? activeResultIndex - 1 : null;\n    const nextResultIndex = activeResultIndex !== lastResultIndex ? activeResultIndex + 1 : null;\n    const activeSatProductsPairs = select.rootSelectors.getActiveSatProductsPairs(state);\n    const noProductsActive = activeSatProductsPairs.length === 0;\n    const activeProduct =  !noProductsActive ? select.components.searchToolbar.getActiveResult(state) : null;\n\n    const onClose = () => {\n        dispatch(setVisibility(false));\n        //clear\n    }\n\n    const onSearchParamsChanged = () => {\n        dispatch(stopFollowNow());\n        dispatch(stopTimer());\n        updateSearch(dispatch, state);\n    }\n\n    const onNextResultClick = nextResultIndex !== null ? () => {\n        dispatch(stopFollowNow());\n        dispatch(stopTimer());\n\n        setActiveIndexAndUpdateTime(dispatch, state, nextResultIndex);\n    } : null;\n\n    const onPreviousResultClick = previousResultIndex !== null ? () => {\n        dispatch(stopFollowNow());\n        dispatch(stopTimer());\n\n        setActiveIndexAndUpdateTime(dispatch, state, previousResultIndex);\n    } : null;\n    \n    return (\n        <Presentation \n            vertical={vertical}\n            onClose={onClose}\n            displayNoProductsActive={noProductsActive}\n            loading={loading}\n            activeProduct={activeProduct}\n            title={activeSatProductsPairs}\n            onNextResultClick={onNextResultClick}\n            onPreviousResultClick={onPreviousResultClick}\n            activeSatProductsPairs={activeSatProductsPairs}\n            onSearchParamsChanged = {onSearchParamsChanged}\n            geometry = {geometry}\n            />\n    )\n}\n\nexport default withContext(SearchToolbar);","import React from 'react';\nimport ReactResizeDetector from 'react-resize-detector';\nimport className from 'classnames';\nimport Div100vh from 'react-div-100vh'\n\nimport {Context} from './context/context';\nimport {\n    setOrientation,\n    updateTleData,\n    updateApsData,\n    changeSelectTime,\n    setFollowNow,\n    nowTick\n} from './context/actions';\nimport select from './context/selectors/';\nimport ProductsModal from './components/ProductsModal/';\nimport SearchModal from './components/SearchModal/';\nimport WorldWindMap from './components/WorldWindMap';\nimport SatelliteSelect from './components/SatelliteSelect';\nimport MapsTimeline from './components/MapsTimeline';\nimport TimeWidget from './components/TimeWidget/';\nimport SearchToolbar from './components/SearchToolbar/';\nimport {getNowUTCString} from './utils/date';\n\nclass App extends React.PureComponent {\n    static contextType = Context\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            height: 0\n        }\n\n        this.onResize = this.onResize.bind(this);\n        this.startTrackNowTime = this.startTrackNowTime.bind(this);\n        this.tick = this.tick.bind(this);\n    }\n\n    componentDidMount() {\n        const {state, dispatch} = this.context;\n        this.startTrackNowTime();\n        const initTime = getNowUTCString();\n        changeSelectTime(initTime, dispatch, initTime)\n        //set Tle data\n        updateTleData(dispatch, initTime);\n        \n        //set Acquisition plans data\n        updateApsData(dispatch);\n\n        //Re-set follow now, because setting time in timeline set followNow to false.\n        setTimeout(() => {\n            dispatch(setFollowNow(true));\n        }, 500);\n    }\n\n\n    tick() {\n        const {state, dispatch} = this.context;\n        nowTick(dispatch, state);\n    }\n\n    startTrackNowTime() {\n        const {state, dispatch} = this.context;\n        const timer = window.setInterval(this.tick, 1000);\n        nowTick(dispatch, state);\n    }\n\n    onResize(width, height) {\n        const {state, dispatch} = this.context;\n        let landscape = true;\n        if(window.innerHeight > window.innerWidth){\n            landscape = false;\n        }\n        \n        if (select.rootSelectors.getLandscape(state) !== landscape) {\n            dispatch(setOrientation(landscape));\n        }\n\n        this.setState({height});\n    }\n\n    getMaxSatelliteSelectHeight() {\n        const {state} = this.context;\n        const vertical = select.rootSelectors.getLandscape(state);\n        const windowHeight = this.state.height;\n        const timelineHeight = 45;\n        const timeWidgetHeight = 46;\n        const satelliteSelectHeight = 38;\n        const satelliteSelectMargin = 2*8;\n        const satelliteSelectTop = 8;\n        const maxSelectHeight = !vertical ?  (windowHeight - timelineHeight - timeWidgetHeight - satelliteSelectHeight - satelliteSelectMargin - satelliteSelectTop) : (windowHeight - satelliteSelectHeight - satelliteSelectMargin - satelliteSelectTop)\n        return maxSelectHeight;\n    }\n\n    render() {\n        const {state} = this.context;\n        const vertical = select.rootSelectors.getLandscape(state);\n        const satelliteSelectVisible = select.components.satelliteSelect.getVisible(state);\n        const mapsTimelineVisible = select.components.timeline.getVisible(state);\n        const timeWidgetVisible = select.components.timeWidget.getVisible(state);\n        const searchToolbarVisible = select.components.searchToolbar.getVisible(state);\n        const maxSelectHeight = this.getMaxSatelliteSelectHeight();\n\n        return (\n            <Div100vh>\n                <div className={'app'}>\n                    <ReactResizeDetector\n                        onResize = {this.onResize}\n                        handleWidth\n                        handleHeight />                \n                    <ProductsModal />\n                    <SearchModal/>\n                    {satelliteSelectVisible ? <SatelliteSelect  \n                        maxHeight = {maxSelectHeight}\n                    /> : null}\n                    <div className={className('timelineWrapper', {\n                        vertical: vertical,\n                        horizontal: !vertical,\n                    })}>\n                        {mapsTimelineVisible ? <MapsTimeline /> : null}\n                    </div>\n                    <div className={className('search-toolbar-wrapper', {\n                        vertical: vertical,\n                        horizontal: !vertical,\n                    })}>\n                        {searchToolbarVisible ? <SearchToolbar /> : null}\n                    </div>\n                    <div className={className('time-widget-wrapper', {\n                        vertical: vertical,\n                        horizontal: !vertical,\n                    })}>\n                        {timeWidgetVisible ? <TimeWidget /> : null}\n                    </div>\n                    <WorldWindMap />\n                </div>\n            </Div100vh>\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import './worldwind/www-overrides/DrawContext';\nimport './worldwind/www-overrides/SurfaceShapeTileBuilder';\nimport './worldwind/www-overrides/SurfaceShape';\nimport './worldwind/www-overrides/SurfaceShapeTile';\nimport './worldwind/www-overrides/TiledImageLayer';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {ContextProvider} from './context/context';\nimport {forceSetPassiveEvents} from './utils/events';\n\nimport './styles/reset.css';\nimport './styles/index.scss';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\ndocument.getElementsByTagName('body')[0].classList.add('ptr-dark');\n\n//prevent scrolling page\n//first solution\n// document.body.addEventListener('touchmove', function(e){ e.preventDefault(); }, { passive: false });\n\n//second solution\n// window.addEventListener(\"scroll\", preventMotion, false);\n// window.addEventListener(\"touchmove\", preventMotion, false);\n\n// function preventMotion(event)\n// {\n//     window.scrollTo(0, 0);\n//     event.preventDefault();\n//     event.stopPropagation();\n// }\n\n//Fix for passive events\nforceSetPassiveEvents();\n\nReactDOM.render(\n    <ContextProvider>\n        <App/>\n    </ContextProvider>,\n    document.getElementById('root')\n);\n\nconst setPageHeight = () => {\n    window.setTimeout(() => {\n        let vh = window.innerHeight * 0.01;\n        document.documentElement.style.setProperty('--vh', `${vh}px`);\n    }, 50)\n}\n\n// We listen to the resize event\nwindow.addEventListener('resize', setPageHeight)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// \n// Chrome 73 breaks wheel events.\n// url: https://github.com/facebook/react/issues/14856\n// \nexport function forceSetPassiveEvents() {\n    const PASSIVE_EVENTS = ['touchstart', 'touchmove', 'touchend', 'touchcancel', 'wheel'];\n\n    const checkType = (type, options) => {\n        if (!PASSIVE_EVENTS.includes(type)) return null;\n    \n        const modOptions = {\n            boolean: {\n                capture: options,\n                passive: false,\n            },\n            object: {\n                ...options,\n                passive: false,\n            },\n        };\n    \n        return modOptions[typeof options];\n    };\n    \n    const addEventListener = document.addEventListener.bind();\n    document.addEventListener = (type, listener, options, wantsUntrusted) => (\n        addEventListener(type, listener, checkType(type, options) || options, wantsUntrusted)\n    );\n    \n    const removeEventListener = document.removeEventListener.bind();\n    document.removeEventListener = (type, listener, options) => (\n        removeEventListener(type, listener, checkType(type, options) || options)\n    );\n}"],"sourceRoot":""}