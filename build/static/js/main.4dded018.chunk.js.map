{"version":3,"sources":["components/WorldWindMap/utils/KML.worker.js","components/WorldWindMap/utils/togeojson.js","worldwind/framebuffer/FramebufferTexture.js","worldwind/framebuffer/Framebuffer.js","worldwind/www-overrides/SurfaceShapeTileBuilder.js","worldwind/www-overrides/SurfaceShapeTile.js","worldwind/www-overrides/TiledImageLayer.js","context/types.js","context/selectors/_common.js","context/selectors/data/satellites.js","context/selectors/map/index.js","context/selectors/data/layers.js","context/selectors/data/acquisitionPlans.js","context/selectors/data/orbits.js","context/selectors/components/search.js","utils/acquisitionPlans.js","utils/satellites.js","context/satData.js","context/selectors/rootSelectors.js","context/selectors/components/satellitesSelect.js","context/selectors/components/timeline.js","context/selectors/index.js","utils/arrayManipulation.js","utils/objectManipulation.js","context/reducer.js","utils/date.js","utils/period.js","context/context.js","utils/tle.js","context/actions.js","components/atoms/Icon/components/AngleDoubleDown.js","components/atoms/Icon/components/AngleDoubleLeft.js","components/atoms/Icon/components/AngleDoubleRight.js","components/atoms/Icon/components/AngleDoubleUp.js","components/atoms/Icon/components/ArrowLeft.js","components/atoms/Icon/components/Circle.js","components/atoms/Icon/components/ChevronLeft.js","components/atoms/Icon/components/ChevronRight.js","components/atoms/Icon/components/Delete.js","components/atoms/Icon/components/Dots.js","components/atoms/Icon/components/Download.js","components/atoms/Icon/components/Edit.js","components/atoms/Icon/components/Expand.js","components/atoms/Icon/components/ExpandRow.js","components/atoms/Icon/components/Filter.js","components/atoms/Icon/components/Info.js","components/atoms/Icon/components/Opacity.js","components/atoms/Icon/components/Layers.js","components/atoms/Icon/components/Legend.js","components/atoms/Icon/components/MapPin.js","components/atoms/Icon/components/Minus.js","components/atoms/Icon/components/MinusThick.js","components/atoms/Icon/components/NorthArrow.js","components/atoms/Icon/components/Plus.js","components/atoms/Icon/components/PlusThick.js","components/atoms/Icon/components/Pushpin.js","components/atoms/Icon/components/Restore.js","components/atoms/Icon/components/RotateLeft.js","components/atoms/Icon/components/RotateRight.js","components/atoms/Icon/components/Search.js","components/atoms/Icon/components/Share.js","components/atoms/Icon/components/TiltMore.js","components/atoms/Icon/components/TiltLess.js","components/atoms/Icon/components/Times.js","components/atoms/Icon/components/TriangleDown.js","components/atoms/Icon/components/Upload.js","components/atoms/Icon/components/Loader-oval.js","components/atoms/Icon/components/Location.js","components/atoms/Icon/components/Warning.js","components/atoms/Icon/components/Clock.js","components/atoms/Icon/components/satellites/Sentinel1.js","components/atoms/Icon/components/satellites/Sentinel2.js","components/atoms/Icon/components/satellites/Sentinel3.js","components/atoms/Icon/components/satellites/Sentinel4.js","components/atoms/Icon/components/satellites/Sentinel5.js","components/atoms/Icon/index.js","components/Modal/index.js","components/ProductsModal/productInformation.js","context/withContext.js","components/ProductsModal/presentation.js","worldwind/collada/ColladaScene.js","worldwind/Model.js","components/WorldWindMap/SatelliteModelLayer.js","components/WorldWindMap/utils/Orbit.js","components/WorldWindMap/OrbitLayer.js","components/WorldWindMap/SentinelCloudlessLayer.js","components/WorldWindMap/SentinelTopologyLayer.js","components/WorldWindMap/utils/AcquisitionPlansParser.js","worldwind/textured/libtess.js","worldwind/textured/ScreenColorProgram.js","worldwind/textured/ScreenTextureProgram.js","worldwind/textured/TexturedSurfaceShape.js","worldwind/textured/TexturedSurfacePolygon.js","components/WorldWindMap/AcquisitionPlanLayer.js","components/WorldWindMap/utils/eo/satellite.js","components/WorldWindMap/utils/eo/utils.js","components/WorldWindMap/SwathLayer.js","utils/product.js","components/WorldWindMap/utils/wmsLayer.js","components/WorldWindMap/satellitesModels.js","worldwind/products/QuickLook.js","worldwind/products/Product.js","worldwind/products/Query.js","worldwind/products/Products.js","components/WorldWindMap/layers.js","config.js","components/ProductsModal/index.js","components/atoms/Button/index.js","components/atoms/Select/Key.js","utils/utils.js","components/atoms/Select/Select.js","components/SearchModal/components/searchForm/presentation.js","context/actions/components/searchForm/actions.js","components/SearchModal/components/searchForm/index.js","components/SearchModal/components/result/presentation.js","components/SearchModal/components/result/index.js","components/SearchModal/presentation.js","components/SearchModal/index.js","worldwind/WorldWindow.js","components/WorldWindMap/utils/ClickPickController.js","worldwind/FixedPointController.js","worldwind/EnabledController.js","worldwind/FreeCamera.js","worldwind/Animator.js","components/WorldWindMap/presentation.js","components/WorldWindMap/index.js","components/SatelliteSelect/SatelliteGroupOption.js","components/SatelliteSelect/Loader.js","components/NotificationBadge/index.js","components/SatelliteSelect/LayerOption.js","components/SatelliteSelect/AcquisitionPlanOption.js","components/SatelliteSelect/OptionFactory.js","components/SatelliteSelect/SatelliteGroupHeading.js","components/SatelliteSelect/presentation.js","components/SatelliteSelect/index.js","components/HoverHandler/context.js","components/TimeLine/TimeLineHover.js","components/HoverHandler/position.js","components/HoverHandler/Popup/Popup.js","components/HoverHandler/HoverHandler.js","components/TimeLine/centerPicker/index.js","components/TimeLine/mouse/index.js","components/TimeLine/utils/interval.js","components/TimeLine/overlay/index.js","components/TimeLine/periodLimit/index.js","components/TimeLine/utils/textLabel.js","components/TimeLine/utils/dash.js","components/TimeLine/years/YearDash.js","components/TimeLine/months/MonthDash.js","components/TimeLine/years/index.js","components/TimeLine/months/index.js","components/TimeLine/hours/HourDash.js","components/TimeLine/days/DayDash.js","components/TimeLine/days/index.js","components/TimeLine/minutes/MinuteDash.js","components/TimeLine/hours/index.js","components/TimeLine/minutes/index.js","components/TimeLine/context.js","components/TimeLine/TimelineEventsWrapper.js","components/TimeLine/timelineContent.js","components/TimeLine/index.js","components/MapsTimeline/presentation.js","components/MapsTimeline/index.js","components/TimeWidget/presentation.js","components/TimeWidget/index.js","App.js","serviceWorker.js","index.js","utils/events.js"],"names":["module","exports","Worker","__webpack_public_path__","toGeoJSON","serializer","removeSpace","trimSpace","splitSpace","okhash","x","length","i","h","charCodeAt","get","y","getElementsByTagName","attr","getAttribute","attrf","parseFloat","get1","n","numarray","j","o","nodeVal","el","normalize","textContent","coord1","v","replace","split","coord","coords","push","coordPair","e","ll","ele","heartRate","time","isNaN","coordinates","xml2str","str","undefined","xml","serializeToString","XMLSerializer","process","browser","kml","doc","gj","type","features","styleIndex","geotypes","placemarks","styles","styleMaps","k","st","l","toString","concat","getPlacemark","kmlColor","color","opacity","substr","parseInt","gxCoords","root","elems","times","timeElems","geomsAndTimes","getGeometry","geomNode","geomNodes","geoms","coordTimes","gasit","rings","outerArr","track","properties","name","styleUrl","description","timeSpan","extendedData","lineStyle","polyStyle","a","node","lTextContent","querySelector","lColor","pTextCOntent","polySyle","pColor","lineColor","polyColor","parseStyle","begin","end","timespan","linestyles","width","stroke","polystyles","pcolor","popacity","fill","outline","datas","simpleDatas","feature","geometry","geometries","id","gpx","tracks","routes","waypoints","getTrack","getRoute","getPoint","getPoints","pointname","pts","line","heartRates","c","segments","getProperties","prop","sym","meta","clean","FramebufferTexture","textureId","height","this","imageWidth","imageHeight","size","originalImageWidth","originalImageHeight","creationTime","Date","dc","currentGlContext","bindTexture","TEXTURE_2D","frameStatistics","incrementTextureLoadCount","gl","deleteTexture","Framebuffer","framebufferId","texture","createTexture","framebufferTexture2D","FRAMEBUFFER","COLOR_ATTACHMENT0","createFramebuffer","bindFramebuffer","viewport","clearColor","clear","COLOR_BUFFER_BIT","fbo","canvas","console","log","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","ArgumentError","WorldWind","Logger","SurfaceShapeTileBuilder","SurfaceShape","PickedObject","prototype","buildTiles","logMessage","LEVEL_SEVERE","surfaceShapes","assembleTiles","__fboBound__","getFbo","unbind","currentFramebuffer","splice","idx","len","surfaceShapeTiles","clearShapes","addTile","tile","pickingMode","pickSequence","needsUpdate","bind","tileWidth","tileHeight","updateTexture","doDeepPickingRender","idxTile","lenTiles","idxShape","lenShapes","idxPick","lenPicks","po","shape","deepPickShapes","objectsAtPickPoint","objects","userObject","indexOf","resolvablePickObjects","setShapes","surfaceTileRenderer","renderTiles","pickColor","readPickColor","pickPoint","equals","clone","pickDelegate","layer","gpuResourceCache","resourceForKey","putResource","__frameStart__","SurfaceShapeTile","xScale","sector","deltaLongitude","yScale","deltaLatitude","xOffset","minLongitude","yOffset","maxLatitude","asRenderedSurfaceShapeStateKeys","attachTexture","surfaceShapeStateKeys","renderToTexture","gpuCacheKey","getCacheKey","TiledImageLayer","retrieveTileImage","suppressRedraw","pendingRequests","MAX_REQUESTS","currentRetrievals","imagePath","some","t","absentResourceList","isResourceAbsent","resourceUrlForTile","retrievalImageFormat","shift","fetchMoreImages","currentTilesInvalid","before","filter","pendingTile","isTileVisible","url","cache","fetchImage","err","image","removeFromCurrentRetrievals","markResourceAbsent","unmarkResourceAbsent","document","createEvent","initEvent","REDRAW_EVENT_TYPE","window","dispatchEvent","cb","Image","onload","onerror","Error","crossOrigin","webkit","AndroidApp","src","doRender_","terrain","lasTtMVP","navigatorState","modelviewProjection","globeStateKey","lastGlobeStateKey","currentTiles","surfaceOpacity","incrementImageTileCount","inCurrentFrame","cleanCache","getSubstate","createSelector","state","substate","getByPath","path","getByKey","key","common","getSatelliteByKey","satKey","find","s","getVisibleAcquisitionsPlans","isVisibleAcquisitionPlanByKey","acquisitionsPlans","includes","createCachedSelector","getPlansForDate","date","dateString","moment","format","getDateString","map","satAps","plans","aps","startDate","start","endDate","apsForTime","getActiveResultIndex","getResults","getFilterTime","getSearchLayer","activeResultIndex","results","Number","isInteger","getSatAPSUrl","getSatIntervalAPSUrl","toUpperCase","satellites","Map","getPlansKeys","join","parseAPSfiles","result","reduce","acc","kmlName","satName","getAcquisitionPlans","has","then","request","fetch","response","text","set","getAllAcquisitionPlans","Promise","all","isSatelliteReleaseBeforeDate","satellite","satData","launchDate","getTime","orbit","activeSatelliteKey","Color","shortName","satIndex","swathTypes","swathColors","colorFromKmlHex","swatModes","tleLineOne","tleLineTwo","hasModel","filePath","fileName","rotations","z","headingAxis","headingAdd","headingMultiply","preRotations","scale","translations","ignoreLocalTransforms","groundPosition","latitude","longitude","altitude","getSatDataByKey","getDefaultSatOrbitBySatKey","sat","specs","getSelectTimePastOrCurrent","getCurrentTime","currentTime","getPreventReloadLayers","getActiveInfoModalKey","getInfoModal","infoModalKey","getSelectTime","selectTime","getBeginDataTime","momentjs","subtract","toDate","getPureActiveLayers","activeLayers","layerKey","getFollowNow","getTrackTimeActive","getPeriodLimit","getLandscape","getFocusedSattelite","getBeginTime","productsTimeWindow","getSatelliteForLayer","satellitesSubstate","getActiveLayers","getOrbitsSubstate","getSatellitesSubstate","selectTimePastOrCurrent","orbitsSubstate","acquisitionPlans","visibleAcquisitionsPlans","focusedSatellite","searchLayer","activeLayersWithDates","forEach","beginTime","endTime","disabled","satellitesUtils","orbitLayers","getOrbitForLayer","orbitKey","satellitesLayers","model","tle","acquisitionPlanLayers","p","range","acquisitionPlanTimeWindow","stringSelectTime","orbitSubstate","orbitKeys","satellitesKeys","activeLayersKeys","cacheKey","getActiveLayerByKey","getSatelitesSelectOptions","getLayersSubstate","loadingPlans","plan","loading","layersSubState","focusedSattelite","acquisitionPlansData","loadingAcquisitionsPlans","satConfig","hasAPS","activeAPS","satOption","groupData","value","icon","iconClass","active","label","options","loadedCount","visiblePlans","totalCount","layers","getLayerByKey","activeLayerCfg","status","message","getLayerOption","addItemToIndex","array","index","item","slice","removeItemByIndex","getOverlays","overlays","now","overlayIndex","findIndex","nowOverlay","nowOverlayPlusSecond","withoutOverlay","rootSelectors","data","components","satelliteSelect","timeline","search","replaceItemOnIndex","removeItemByKey","object","EoUtils","WorldWindX","deactivateLayer","action","payload","select","activeIndex","activateLayer","setSelectTime","followNow","selectTimeMoment","isAfter","setHelper","remainingPath","currentKey","updateInfoModal","modalKey","modalState","infoModalState","modalPath","modal","updateModal","types","FOCUS_SATELLITE","focus","focusSatelite","TOGGLE_LAYER","toggleLayer","PREVENT_RELOAD_LAYERS","preventReloadLayers","setPreventReloadLayers","ACTIVATE_LAYER","DEACTIVATE_LAYER","CHANGE_SELECTTIME","CHANGE_CURRENTTIME","selectTimeState","orbitInfo","orbits","wwd","satrec","computeSatrec","position","getOrbitPosition","goTo","setCurrentTime","CHANGE_ACTIVE_TIME_LEVEL","activeTimeLevel","setActiveTimeLevel","FOLLOW_NOW","setFollowNow","TRACK_TIME","trackTime","setTrackTime","CHANGE_TIME_LINE_DAY_WIDTH","timeLine","dayWidth","setTimeLineDayWidth","TIME_LINE_SET_MOUSE_TIME","mouseTime","setTimeLineMouseTime","CHANGE_LANDSCAPE","landscape","setLandscape","SET_OVERLAYS","setOverlays","COMPONENT","UPDATE","component","update","updateComponent","SET","setComponent","CLEAR","clearComponent","UPDATE_ACTIVE_LAYER","change","layerIndex","layerInfo","updateActiveLayer","UPDATE_INFO_MODAL","SET_ACTIVE_INFO_MODAL","infoModal","setActiveInfoModal","SET_ORBITS","setOrbits","SET_ACQUISITION_PLANS","setAcquisitionPlans","DATA_UPDATE_ACQUISITIONPLANS","acquisitionPlansKeyIndex","acquisitionPlanUrlIndex","acquisitionPlan","updatedAcquisitionPlan","merge","cloneDeep","updatedAcquisitionPlans","dataUpdateAcquisitionPlan","DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT","count","setVisibleAcquisitionPlan","SET_WWD","setWwd","MAP_ADD_VISIBLE_ACQUISITION_PLAN","acquisitionPlanKey","mapAddVisibleAcquisitionPlan","MAP_REMOVE_VISIBLE_ACQUISITION_PLAN","acquisitionPlanKeyIndex","mapRemoveVisibleAcquisitionPlan","convertToUTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getNowUTCString","toUTCString","parseOne","string","match","endOf","source","parse","dates","periodLimit","period","stringPeriodLimit","Context","createContext","initialState","open","moving","backdroundColor","classes","top","getUrl","SENTINELTLENAMES","SENTINELTLEKEYSPAIRS","parseSatellitesData","lines","trim","line1","line2","transformTleFormat","getTle","WordWindX","nowTimer","Position","intervalKeyZoom","intervalKeyScroll","toggleSatelliteFocus","satelliteId","satteliteIsFocused","worldWindowController","_isFixed","navigator","camera","lookAtLocation","redraw","currentPosition","heading","tilt","roll","scrollToTime","dispatch","newTime","callback","clearInterval","timeInPeriod","isBefore","getInside","peace","diff","setInterval","newSelectedTime","add","selectedTime","changeSelectTime","selectYearDay","year","dayOfYear","momentTime","updateTleData","isReleased","nowTick","stopTimer","stopFollowNow","nowTimeMoment","updateApsData","props","className","d","points","strokeWidth","strokeLinejoin","strokeLinecap","cx","cy","r","transform","fillRule","strokeOpacity","attributeName","from","to","dur","repeatCount","fontFamily","fontSize","letterSpacing","wordSpacing","style","fontFeatureSettings","fontVariantCaps","fontVariantLigatures","fontVariantNumeric","lineHeight","version","xmlns","xmlnsXlink","viewBox","xmlSpace","AngleDoubleRight","AngleDoubleLeft","AngleDoubleUp","AngleDoubleDown","ArrowLeft","Circle","ChevronLeft","ChevronRight","Delete","Dots","Download","Edit","Expand","ExpandRow","Filter","Info","Legend","MapPin","Minus","MinusThick","NorthArrow","Opacity","Plus","PlusThick","Pushpin","Restore","RotateLeft","RotateRight","Search","Share","TiltLess","TiltMore","Times","TriangleDown","Warning","Upload","Sentinel1","Sentinel2","Sentinel3","Sentinel4","Sentinel5","Location","Clock","strokeMiterlimit","x1","y1","x2","y2","ReactModal","setAppElement","isOpen","content","onClose","header","closeStyle","css","cursor","right","closeIconStyle","headerStyle","borderBottom","minHeight","backgroundColor","contentLabel","overlay","zIndex","border","onClick","Icon","titleStyle","display","minWidth","justifyContent","getDataListItem","title","getDataList","_attributes","_text","ProductInformation","product","int","summary","dateList","intList","strList","Object","entries","summaryItem","titleItem","platformname","producttype","defaultProps","withContext","Component","Consumer","contexts","ProductsModal","visible","products","showProducts","Modal","BasicTextureProgram","Matrix","Renderable","Vec3","ColladaScene","sceneData","call","_position","_nodes","_meshes","_materials","_images","_upAxis","_dirPath","_xRotation","_yRotation","_zRotation","preX","preY","preZ","_xTranslation","_yTranslation","_zTranslation","_scale","_altitudeMode","ABSOLUTE","_localTransforms","_useTexturePaths","_nodesToHide","_hideNodes","_placePoint","_transformationMatrix","fromIdentity","_mvpMatrix","_normalTransformMatrix","_normalMatrix","_texCoordMatrix","setToUnitYFlip","_entities","_activeTexture","_tmpVector","_tmpColor","_vboCacheKey","_iboCacheKey","setSceneData","create","constructor","defineProperties","nodes","meshes","materials","images","upAxis","dirPath","xRotation","yRotation","zRotation","xTranslation","yTranslation","zTranslation","placePoint","altitudeMode","transformationMatrix","normalMatrix","localTransforms","useTexturePaths","nodesToHide","hideNodes","children","metadata","up_axis","flattenModel","nodesLen","flattenNode","sort","b","va","imageKey","vb","mesh","meshKey","buffers","bufLen","materialBuf","material","symbol","materialKey","textures","uvs","diffuse","mapId","reflective","render","orderedScene","frustum","frustumInModelCoordinates","enabled","lastFrameTime","timestamp","makeOrderedRenderable","containsPoint","currentLayer","addOrderedRenderable","surfacePointForMode","eyeDistance","eyePoint","distanceTo","renderOrdered","drawOrderedScene","resolvePick","beginDrawing","endDrawing","vboId","iboId","setupBuffers","bindBuffer","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","findAndBindProgram","enableVertexAttribArray","uniquePickColor","computeTransformationMatrix","globe","mustRenderNode","draw","sizeOfFloat32","Float32Array","BYTES_PER_ELEMENT","sizeOfUint16","Uint16Array","sizeOfUint32","Uint32Array","is32BitIndices","numIndices","numVertices","indexedRendering","indices","vertices","normals","vbo","createBuffer","bufferData","STATIC_DRAW","offset","vertexOffset","bufferSubData","uvOffset","normalOffset","uIntExt","indexSize","indexBufferSize","getExtension","ibo","indexOffset","generateCacheKey","entity","program","currentProgram","nodeWorldMatrix","worldMatrix","nodeNormalMatrix","hasLighting","applyColor","filename","textureCacheKey","wrapMode","isClamp","REPEAT","retrieveTexture","loadTextureEnabled","vertexAttribPointer","FLOAT","loadModulateColor","disableVertexAttribArray","loadApplyLighting","applyMatrix","indexOffsetBytes","drawElements","TRIANGLES","UNSIGNED_INT","UNSIGNED_SHORT","drawArrays","Math","floor","techniqueType","g","depthMask","loadColor","loadOpacity","hasTexture","copy","multiplyMatrix","modelviewNormalTransform","loadModelviewInverse","loadTextureMatrix","loadModelviewProjection","setToIdentity","multiplyByLocalCoordinateTransform","multiplyByRotation","multiplyByScale","multiplyByTranslation","computeNormalMatrix","extractRotationAngles","nodeId","Model","_satellite","satelliteModel","_model","modelData","satShortName","jsonData","hasOwnProperty","eVertices","eNormals","eUvs","eIndices","info","RenderableLayer","DEFAULT_MODEL_OPTIONS","SatelliteModelLayer","satelliteOptions","_satelliteOptions","_rerenderMap","Tle","removeAllRenderables","addRenderable","doRerender","setPosition","alignWithOrbit","nextPosition","headingRad","headingAngleRadians","rad2deg","angle","rerenderer","Path","ShapeAttributes","Orbits","startTime","orbitPoints","_satrec","_orbitPoints","_trail","trail","trailAttributes","_currentEndTime","_previousEndTime","_currentStartTime","_previousStartTime","populate","satelliteRecord","force","previousStartTime","previousTime","changeStart","previousEndTime","changeEnd","timeWindow","tick","positionsToReplace","ceil","abs","positions","positionIndex","getOrbitPositionWithPositionalData","pop","attributes","numSubSegments","outlineColor","outlineWidth","drawOutline","drawInterior","OrbitLayer","satRec","_beforeCurrentOrbit","Orbit","_afterCurrentOrbit","setSatRec","setTime","removeRenderable","Sector","SentinelCloudlessLayer","location","host","service","layerNames","levelZeroDelta","numLevels","WmsLayer","SentinelTopologyLayer","AcquisitionPlansParser","workers","InteriorCtor","SurfacePolygon","OutlineCtor","ShapeAttributesCtor","PositionCtor","ColorCtor","domParser","shapeAttributesMap","fileInfo","filterDate","toISOString","parsedShapes","outlines","interiors","interval","shapes","parseSync","error","makeRenderables","formatOutput","kmlString","DOMParser","kmlDoc","parseFromString","isSentinel2","nowDate","isInTheFuture","Mode","Timeliness","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","makePositions","pathAttributes","makePathAttributes","outlineAlpha","followTerrain","expiryTime","setTimeInterval","kmlProps","interior","surfacePolygonAttributes","makeSurfacePolygonAttributes","interiorAlpha","surfacePolygon","highlightAttributes","makeSurfacePolygonHighlightAttributes","highlightAlpha","pos","hexColor","alpha","makeColor","interiorColor","blue","substring","green","red","renderable","dateStringToUTC","ObservationTimeStart","ObservationTimeStop","startTimeMs","endTimeMs","toLowerCase","libtess","condition","opt_message","DEBUG","GLU_TESS_WINDING_ODD","GLU_TESS_WINDING_NONZERO","GLU_TESS_WINDING_POSITIVE","GLU_TESS_WINDING_NEGATIVE","GLU_TESS_WINDING_ABS_GEQ_TWO","GL_LINE_LOOP","GL_TRIANGLES","GL_TRIANGLE_STRIP","GL_TRIANGLE_FAN","GLU_TESS_MISSING_BEGIN_POLYGON","GLU_TESS_MISSING_END_POLYGON","GLU_TESS_MISSING_BEGIN_CONTOUR","GLU_TESS_MISSING_END_CONTOUR","GLU_TESS_COORD_TOO_LARGE","GLU_TESS_NEED_COMBINE_CALLBACK","GLU_TESS_BEGIN","GLU_TESS_VERTEX","GLU_TESS_END","GLU_TESS_ERROR","GLU_TESS_EDGE_FLAG","GLU_TESS_COMBINE","GLU_TESS_BEGIN_DATA","GLU_TESS_VERTEX_DATA","GLU_TESS_END_DATA","GLU_TESS_ERROR_DATA","GLU_TESS_EDGE_FLAG_DATA","GLU_TESS_COMBINE_DATA","GLU_TESS_MESH","GLU_TESS_TOLERANCE","GLU_TESS_WINDING_RULE","GLU_TESS_BOUNDARY_ONLY","GLU_INVALID_ENUM","GLU_INVALID_VALUE","geom","vertEq","u","vertLeq","edgeEval","w","gapL","gapR","edgeSign","transLeq","transEval","transSign","edgeGoesLeft","dst","org","edgeGoesRight","vertL1dist","vertCCW","interpolate_","edgeIntersect","o1","d1","o2","d2","z1","z2","tmp","makeEdge","makeEdgePair_","eHead","makeVertex_","vHead","makeFace_","fHead","meshSplice","eOrg","eDst","joiningLoops","joiningVertices","killVertex_","lFace","killFace_","splice_","anEdge","deleteEdge","eDel","eDelSym","rFace","oNext","oPrev","killEdge_","addEdgeVertex","eNew","eNewSym","lNext","splitEdge","winding","connect","zapFace","fZap","eStart","eNext","eSym","fPrev","prev","fNext","next","meshUnion","mesh1","mesh2","f1","v1","e1","f2","v2","e2","deleteMesh","GluHalfEdge","ePrev","aONext","bONext","eOrig","vNext","vPrev","vNew","GluVertex","fNew","GluFace","inside","vDel","newOrg","fDel","newLFace","normal","S_UNIT_X_","S_UNIT_Y_","projectPolygon","tess","computedNormal","norm","computeNormal_","sUnit","tUnit","longAxis_","TRUE_PROJECT","normalize_","dot_","checkOrientation_","sqrt","maxVal","GLU_TESS_MAX_COORD","minVal","maxVert","minVert","maxLen2","tNorm","tLen2","area","f","renderMesh","flagEdges","beginOrBeginDataCalled","edgeState","callBeginOrBeginData","primitiveType","newState","callEdgeFlagOrEdgeFlagData","callVertexOrVertexData","callEndOrEndData","renderBoundary","sweep","SENTINEL_COORD_","TOLERANCE_NONZERO_","computeInterior","fatalError","removeDegenerateEdges_","initPriorityQ_","initEdgeDict_","pq","extractMin","minimum","spliceMergeVertices_","sweepEvent_","minRegion","dict","getMin","getKey","event","eUp","doneEdgeDict_","donePriorityQ_","removeDegenerateFaces_","checkMesh","addWinding_","eSrc","edgeLeq_","reg1","reg2","deleteRegion_","reg","fixUpperEdge","activeRegion","deleteNode","nodeUp","fixUpperEdge_","newEdge","topLeftRegion_","regionAbove","regionBelow","topRightRegion_","addRegionBelow_","regAbove","eNewUp","regNew","ActiveRegion","insertBefore","isWindingInside_","windingRule","computeWinding_","windingNumber","finishRegion_","finishLeftRegions_","regFirst","regLast","regPrev","lPrev","addRightEdges_","regUp","eFirst","eLast","eTopLeft","cleanUp","firstTime","rPrev","dirty","checkForRightSplice_","walkDirtyRegions_","callCombine_","isect","weights","needed","callCombineOrCombineData","callErrorOrErrorData","errorType","vertexWeights_","weightIndex","t1","t2","i0","i1","getIntersectData_","orgUp","dstUp","orgLo","dstLo","regLo","eLo","remove","pqHandle","checkForLeftSplice_","checkForIntersect_","min","max","orgMin","insert","connectRightVertex_","eBottomLeft","degenerate","connectLeftDegenerate_","vEvent","eTopRight","connectLeftVertex_","dNext","addSentinel_","sentinel","Dict","eLNext","PriorityQ","init","deleteQ","tessmono","tessellateMonoRegion_","face","up","tempHalfEdge","lo","tessellateInterior","discardExterior","setWindingNumber","keepOnlyBoundary","frame","leq","head_","DictNode","frame_","leq_","deleteDict_","newNode","getMax","opt_key","opt_nextNode","opt_prevNode","getSuccessor","getPredecessor","CachedVertex","GluTesselator","tessState_","T_DORMANT","lastEdge_","callError_","relTolerance","GLU_TESS_DEFAULT_TOLERANCE","boundaryOnly","callBegin_","callEdgeFlag_","callVertex_","callEnd_","callMesh_","callBeginData_","callEdgeFlagData_","callVertexData_","callEndData_","callErrorData_","callCombineData_","polygonData_","emptyCache","cacheCount","Array","TESS_MAX_CACHE","T_IN_POLYGON","T_IN_CONTOUR","gluDeleteTess","requireState_","gluTessProperty","which","gluEnum","gluGetTessProperty","gluTessNormal","gluTessCallback","opt_fn","fn","gluTessVertex","tooLarge","clamped","emptyCache_","cacheVertex_","addVertex_","gluTessBeginPolygon","gluTessBeginContour","gluTessEndContour","gluTessEndPolygon","makeDormant_","gotoState_","GluMesh","flag","weight","interpData","errno","opt_nextFace","opt_prevFace","opt_nextEdge","dPrev","rNext","eHeadSym","opt_nextVertex","opt_prevVertex","PQHandleElem","realloc","oldArray","newArray","PQNode","handle","keys_","PQKeyRealloc_","INIT_SIZE_","order_","size_","max_","initialized_","heap_","PriorityQHeap","deleteHeap","keys","comparator","keyNew","curr","keyLessThan_","keyX","keyY","keyGreaterThan_","sortMin","isEmpty","heapMin","isEmpty_","nodes_","handles_","freeList_","floatDown_","free","floatUp_","hMin","hCurr","child","hChild","parent","hParent","ScreenColorProgram","resolutionLocation","uniformLocation","colorLocation","localCache","resolution","uniform2f","cacheColor","uniform4f","GpuProgram","ScreenTextureProgram","texUnitLocation","textureUnit","unit","uniform1i","TEXTURE0","Angle","Texture","TexturedSurfaceShape","_image","_imageUUID","_interiorVboCacheKey","_outlineVboCacheKey","_contoursPrepered","_contoursInfo","stateKeyInvalid","highlighted","_highlightAttributes","_attributesStateKey","stateKey","minLatitude","maxLongitude","displayName","pathType","maximumNumEdgeIntervals","polarThrottle","dx","dy","_highlighted","_isInteriorInhibited","interiorGeometry","mapGeometry","_interiorGeometry","wo","windingOrder_all","crossesAntiMeridian","containsPole","renderColor","getCorners","anglesMap","topLeftIndex","computeUvs","tessGeom","tessellate_p1","tessIndices","px","py","iboData","vboData","renderTexture","tessellate","tessTris","loadResolution","RADIANS_TO_DEGREES","bindInteriorVbo","frontFace","CW","CCW","loadTextureUnit","imageTextureKey","imageTexture","bindInteriorIbo","valuesPerVertex","locations1","locations","side","uv","nextSide","sideStart","sideEnd","jIndex","sideDistance","greatCircleDistance","distance","contours","contour","vboUsage","bindVbo","vboEntry","vboSize","iboUsage","_interiorIboCacheKey","bindIbo","iboSize","tesselator","triangles","prim","newCoords","tris","vertex","DEGREES_TO_RADIANS","bbox","minX","maxX","minY","maxY","point","angles","prevX","prevY","currentX","currentY","nextX","nextY","atan2","p0","p1","p2","p3","corners","findWhichCorners","userProps","userProperties","identifier","cornerLocations","c0","c1","newCorners","corner","reindexCorners","isEqualPoints","getBbox","getSlope","list","sum","p1x","p1y","img","TexturedSurfacePolygon","boundaries","isArray","_boundaries","removeDuplicateLocations","staticStateKey","newBoundaries","removeDuplicateLocationsFromContour","loc","loc2","isPrepared","Workers","AcquisitionPlans","numWorkers","getCoreCount","KMLWorker","parser","filterPlansByUrl","cachedPlans","cachedPlan","AcquisitionPlanLayer","onLayerChanged","Set","updateId","crypto","getRandomValues","filteredPlans","unloadedPlans","pHash","catch","delete","terminateWorkers","getFootprints","addRenderables","pi","PI","twoPi","deg2rad","xke","earthRadius","vkmpersec","tumin","j2","j3","j4","j3oj2","days2mdhms","days","lmonth","dayofyr","inttemp","mon","day","temp","hr","minute","sec","jdayInternal","msec","arguments","jday","getUTCMilliseconds","dpper","alfdp","betdp","cosip","sinip","cosop","sinop","f3","pe","pgh","ph","pinc","pl","sinzf","xls","xnoh","zf","zm","e3","ee2","peo","pgho","pho","pinco","plo","se2","se3","sgh2","sgh3","sgh4","sh2","sh3","si2","si3","sl2","sl3","sl4","xgh2","xgh3","xgh4","xh2","xh3","xi2","xi3","xl2","xl3","xl4","zmol","zmos","opsmode","ep","inclp","nodep","argpp","mp","sin","ses","cos","sis","sls","sghs","shs","gstimeInternal","jdut1","tut1","gstime","apply","sgp4","tsince","coseo1","sineo1","cosisq","delomg","eo1","argpm","su","t3","t4","tc","tem5","tempa","tempe","templ","inclm","mm","nm","nodem","xincp","xlm","xmdf","mo","mdot","argpdf","argpo","argpdot","nodedf","nodeo","nodedot","nodecf","cc1","bstar","cc4","t2cof","isimp","omgcof","delmtemp","eta","xmcof","delmo","d3","d4","cc5","sinmao","t3cof","t4cof","t5cof","no","em","ecco","inclo","method","dspaceResult","delt","x2li","x2omi","xl","xldot","xnddt","xndt","xomi","irez","d2201","d2211","d3210","d3222","d4410","d4422","d5220","d5232","d5421","d5433","dedt","del1","del2","del3","didt","dmdt","dnodt","domdt","gsto","xfact","xlamo","atime","xli","xni","g22","g32","g44","g52","g54","dndt","ft","theta","iretn","dspace","am","pow","dpperResult","operationmode","aycof","xlcof","axnl","aynl","ktr","ecose","esine","el2","rl","rdotl","rvdotl","betal","sinu","cosu","sin2u","cos2u","temp1","temp2","con41","x1mth2","x7thm1","mrt","velocity","xnode","xinc","mvt","rvdot","sinsu","cossu","snod","cnod","sini","cosi","xmx","xmy","ux","uy","uz","sgp4init","cosim","sinim","cc1sq","cc2","cc3","coef","coef1","cosio4","emsq","eeta","etasq","perige","pinvsq","psisq","qzms24","s1","s2","s3","s4","s5","sfour","ss1","ss2","ss3","ss4","ss5","sz1","sz3","sz11","sz13","sz21","sz23","sz31","sz33","temp3","tsi","xpidot","xhdot1","z3","z11","z13","z21","z23","z31","z33","satn","epoch","xbstar","xecco","xargpo","xinclo","xmo","xno","xnodeo","initlResult","eccsq","omeosq","rteosq","cosio","cosio2","ak","delPrime","adel","ao","sinio","con42","ainv","posq","rp","ts70","ds70","initl","qzms2ttemp","qzms24temp","delmotemp","dscomResult","a1","a2","a3","a4","a5","a6","a7","a8","a9","a10","cc","x3","x4","x5","x6","x7","x8","zcosg","zsing","zcosh","zsinh","zcosi","zsini","ss6","ss7","sz2","sz12","sz22","sz32","s6","s7","z12","z22","z32","np","snodm","cnodm","sinomm","cosomm","betasq","rtemsq","xnodce","stem","ctem","zcosil","zsinil","zsinhl","zcoshl","gam","zx","zy","zcosgl","zsingl","xnoi","lsflg","dscom","dsinitResult","f220","f330","g211","g310","g322","g410","g422","g520","g521","g532","g533","sini2","aonv","eoc","rptim","znl","zns","shll","emo","emsqo","dsinit","_toConsumableArray","arr","arr2","_arrayWithoutHoles","iter","Symbol","iterator","_iterableToArray","TypeError","_nonIterableSpread","radiansToDegrees","radians","degreesLat","RangeError","degreesLong","eciToGeodetic","eci","gmst","R","C","topocentric","observerGeodetic","satelliteEcf","observerEcf","geodetic","geodeticToEcf","rx","ry","rz","topS","topE","topZ","ecfToLookAngles","rangeSat","El","asin","azimuth","elevation","topocentricToLookAngles","deg","getPositionEci","_len","args","_key","m","jdsatepoch","getGmst","pointToPointDistance","point1","point2","lat1","lon1","lat2","lon2","dLat","dLon","getDistanceFromLatLonInKm","tleLine1","tleLine2","longstr1","longstr2","xpdotp","satnum","epochyr","epochdays","ndot","nddot","alta","altp","mdhmsResult","getElevationWithPositionalData","position_eci","observerGd","position_gd","positionEci","latStart","longStart","latEnd","longEnd","headingAngle","northPoleCurrentPositionDiff","nextPositionCurrentPositionDiff","northPoleNextPositionDiff","cosAngleCurrentPosition","acos","projectPosition","origin","coordinate","rtd","dtr","brng","toPrecision","fmod","rad","SwathCone","SwathLayer","swath","RED","utils","nNextPosition","currentHeading","nextHeadingRad","nextHeading","swathWidth","translateDistance","swathHeight","getParams","productBounds","WmsCapabilities","polygon","Polygon","addBoundariesAltitude","bs","RELATIVE_TO_GROUND","extrude","polygonAttributes","BLUE","drawVerticals","applyLighting","getBoundaries","modelsCache","QuickLook","iconUrl","_icon","_fetch","headers","ok","blob","blobData","URL","createObjectURL","createImage","revokeObjectURL","resolve","reject","imageOfQuickLook","addEventListener","Wkt","Product","entry","_id","_entry","_footprint","footprint","icons","link","rel","href","load","wkt","footprintAttributes","shapeAttributes","Query","startIndex","_shortName","_products","_location","_beginTime","_endTime","_startIndex","toSerialize","serializeLocation","serializeTime","platformNameQuery","serializeFileName","productsQuery","serializeProductType","queryValue","encodeURIComponent","shortSatName","getCacheID","hour","parseEntry","parsedEntry","element","Products","searchCache","baseUrl","_baseUrl","_cache","_searchCache","hours","filteredProducts","processed","processProducts","startDateMoment","utc","endDateMoment","beginpositionDate","beginposition","endpositionDate","endposition","isBetween","getProductsInTime","hourLoader","loadSearchByHour","promises","searchResults","momentBeginTime","startOf","momentEndTime","duration","durationInHours","asHours","getChachedSearch","loadSearch","hoursString","firstHour","lastHour","beforeFirstHour","afterLastHour","marginHours","parseSearchResults","resultsPerPage","currentPage","productsLocal","renderables","errors","productIndex","total","feed","cached","query","JSON","atomFeed","xml2js","compact","totalResults","itemsPerPage","stringify","StarFieldLayer","AtmosphereLayer","csiRenderablesCache","layersCache","productsScihub","SciHubProducts","Authorization","btoa","defaultBackgroundLayer","defaultStarfieldLayer","defaultAtmosphereLayer","productsRequests","defaultTopologyLayer","getLayerKeyFromConfig","layerConfig","getLayerKeySCIHubResult","getLayerIdFromConfig","filterOrbitLayersConfigs","layersConfig","filterAcquisitionPlanLayersConfigs","filterSatelliteLayersConfigs","filterSentinelDataLayersConfigs","getLayerByName","getSentinelLayer","cacheLayer","getFootprintLayer","getSatelliteLayer","setTle","setRerender","json","setModel","getLayers","searchResult","sentinelLayers","getOrbitLayer","satelliteLayers","acquisitionPlanLayersConfigs","setPlans","getAcquisitionPlanLayer","swathLayers","layerAcquisitionKey","cacheLayerAcquisition","setType","setColor","setVisible","getSwathLayer","stringTime","stringCurrentTime","sentinelDataLayersConfigs","orbitLayersConfigs","satellitesLayersConfigs","acquisitionPlanLayersKeys","searchLayerKey","getSciProducts","setRenderablesFromConfig","redrawCallback","cancelled","rejected","msg","requests","productsIDs","renderablesToRemove","renderedRenderables","newRenderables","productID","uncompleateBoundaries","setRenderables","changedLayer","reloadLayer","layerCfg","wwdLayer","activeRequestReject","dispatchChange","stack","reloadFootprint","reloadLayersRenderable","wwdLayers","activeInfoModalKey","activeInfoModal","productKey","Button","focused","menuOpen","onBlur","onKeyPress","setState","charCode","iconInsert","hasContent","React","Children","Fragment","isValidElement","cloneElement","classNames","circular","ghost","invisible","inverted","large","primary","secondary","small","tabIndex","unfocusable","PureComponent","clipboard","writeText","stopPropagation","shortKey","Uint8Array","Select","getLabel","onChange","onCreate","option","optionValue","_","optionLabel","isDisabled","selectedObject","selected","originalObject","values","getFormattedOptions","classnames","valueIsTitle","clearable","multi","renderCreatable","renderBase","placeholder","classNamePrefix","formatOptionLabel","hideSelectedOptions","isClearable","isOptionDisabled","isMulti","menuPortal","base","rest","menuPortalTarget","getElementById","onCreateOption","opt","labelPrefix","labelText","withKeyPrefix","Key","SearchForm","previousResultIndex","nextResultIndex","changeActiveResultIndex","useState","selectedSatellite","setSelectedSatellite","selectedProduct","setSelectedProduct","satellitesOptions","productsOptions","displayMoveButtons","round","loadLatestProducts","setSearchResults","setSearchTime","setActiveResultIndex","curIndex","maxIndex","filterTime","minIndex","getPreviousIndex","searchCoords","productId","statrIndex","setYear","Result","parsedResult","ArcBallCamera","BasicWorldWindowController","DrawContext","EarthElevationModel","FrameStatistics","Frustum","Globe","GoToAnimator","Globe2D","Line","GpuResourceCache","LookAtNavigator","Navigator","PickedObjectList","Rectangle","Vec2","Terrain","WWMath","WorldWindow","canvasElem","elevationModel","controllerConstructor","cameraConstructor","WebGLRenderingContext","HTMLCanvasElement","preventDefaultListener","preventDefault","drawContext","eventListeners","redrawRequested","redrawRequestId","scratchModelview","scratchProjection","hasStencilBuffer","getContextAttributes","stencil","depthBits","getParameter","DEPTH_BITS","drawingBufferWidth","drawingBufferHeight","verticalExaggeration","deepPicking","subsurfaceMode","goToAnimator","_redrawCallbacks","_orderedRenderingFilters","thisWindow","declutter","pixelScale","onGestureEvent","handleRedrawEvent","PointerEvent","setProperty","handleContextLost","handleContextRestored","animationFrameLoop","getBoundingClientRect","xc","left","clientLeft","yc","clientTop","listener","thisWorldWindow","listeners","worldWindow","removeEventListener","isContextLost","resize","resetDrawContext","pickRay","rayThroughScreenPoint","drawFrame","pickTerrainOnly","rectangle","regionPicking","pickRectangle","glAttrs","antialias","getContext","LEVEL_INFO","statusMessage","contextLost","cancelAnimationFrame","contextRestored","redrawIfNeeded","requestAnimationFrame","previousRedrawTimestamp","callRedrawCallbacks","BEFORE_REDRAW","AFTER_REDRAW","clientWidth","clientHeight","projection","modelview","createViewMatrix","globeRadius","equatorialRadius","polarRadius","extractEyePoint","eyePos","computePositionFromPoint","eyeHorizon","horizonDistanceForGlobeRadius","atmosphereHorizon","farDistance","nearDistance","perspectiveNearDistanceForFarDistance","distanceToSurface","elevationAtLocation","maxNearDistance","perspectiveNearDistance","setToPerspectiveProjection","projectionInv","invertMatrix","nbl","ntr","fbl","ftr","multiplyByMatrix","nrRectWidth","fabs","frRectWidth","nrDistance","frustumWidthScale","frustumWidthOffset","pixelSizeFactor","pixelSizeOffset","computeViewingTransform","pixelMetrics","computePixelMetrics","setToMultiply","modelviewInv","invertOrthonormalMatrix","setToTransposeOfMatrix","upper3By3","modelviewTranspose","fromProjectionMatrix","transformByMatrix","reset","screenCreditController","computeDrawContext","beginFrame","is2D","continuous","do2DContiguousRepaint","doNormalRepaint","endFrame","createTerrain","clearFrame","deferOrderedRendering","makePickFrustum","doPick","doDraw","redrawSurface","drawScreenRenderables","createTerrain2DContiguous","pick2DContiguous","draw2DContiguous","resolveTerrainPick","resolveRegionPick","resolveTopPick","enable","BLEND","CULL_FACE","DEPTH_TEST","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","depthFunc","LEQUAL","makePickFramebuffer","pickFramebuffer","disable","ZERO","LESS","bindProgram","DEPTH_BUFFER_BIT","renderShapes","STENCIL_TEST","surfaceShapeTileBuilder","drawLayers","drawSurfaceRenderables","doRender","STENCIL_BUFFER_BIT","stencilFunc","ALWAYS","stencilOp","REPLACE","drawOrderedRenderables","EQUAL","KEEP","pick","tessellator","setTerrainTileCount","surfaceGeometry","terrainLeft","terrainCenter","terrainRight","intersectsFrustum","makeCurrent","accumulateOrderedRenderables","layerRenderingTime","indexOfLayer","sr","reverseSurfaceRenderables","popSurfaceRenderable","renderSurface","LEVEL_WARNING","or","sortOrderedRenderables","orderedRenderingMode","popOrderedRenderable","orderedRenderingTime","nextScreenRenderable","pickedObjects","topObject","terrainObject","isTerrain","isOnTop","uniquePickColors","readPickColors","toByteString","stage","completionCallback","groupId","declutterables","orderedRenderables","orderedRenderable","declutterGroup","rects","declutterable","screenBounds","intersectsRectangles","targetVisibility","screenPoint","nearPoint","farPoint","modelviewProjectionInv","unProject","direction","ClickPickController","clickDelay","minClickTime","clickTimeout","mouseDown","tpCache","clickTimeoutKey","eventListener","events","onTouchMove","onMouseMove","onTouchStart","onMouseDown","onTouchEnd","onMouseUp","pickList","canvasCoordinates","getClickTime","evt","getRenderablesByMouse","ev","evts","clearTimeout","clickKey","setTimeout","resetClickTimeout","setClickTimeout","changedTouches","clientX","clientY","couldClick","touches","removeTouchEventByIdentifier","cacheEvents","setPointerDownTimeout","clearTouchEventCache","BEGAN","CHANGED","FixedPointController","lookAt","recognizers","lastPoint","beginRange","sign","recognizer","previousX","previousY","metersPerPixel","perspectivePixelSize","forwardDegrees","sideDegrees","applyLimits","normalizedDelta","deltaMode","WheelEvent","DOM_DELTA_PIXEL","deltaY","DOM_DELTA_LINE","DOM_DELTA_PAGE","EnabledController","_enabled","fixedController","handlePanOrDrag","handleFling","handlePinch","handleRotation","handleTilt","handleWheelEvent","FreeCamera","clamp","normalizedDegreesLongitude","MAX_VALUE","normalizedDegrees","Animator","animationFrequency","travelTime","finalRange","rotation","targetPosition","startPosition","rangeDistance","animationDuration","panDistance","pA","computePointFromLocation","pB","maxAltitude","viewportSize","pixelSizeAtDistance","maxAltitudeReachedTime","animationDistance","panVelocity","rangeVelocity","headingVelocity","rotationVelocity","tiltVelocity","thisAnimator","timerCallback","continueAnimation","updateRange","updateLocation","updateTilt","updateHeading","updateRotation","nextRange","elapsedTime","distanceTravelled","distanceRemaining","azimuthToTarget","greatCircleAzimuth","distanceForNow","nextDistance","nextLocation","greatCircleLocation","locationReached","wwdCreated","nextProps","layersChanged","preventMovingChanged","preventReload","prevProps","searchLayers","enabledLayersKeys","prevVisibleLayers","visibleLayers","prevLayers","Layers","disabledPrevLayers","disabledLayers","visibilityChanged","isEqual","newlyEnabledLayersKeys","lk","handleLayers","newlyEnabledLayersCfg","cfg","notDisabledLayers","disabledLayersKeys","disabledPrevLayersKeys","nextLayersData","searchOnCoords","terrainPick","pickTerrain","screenX","screenY","terrainCoords","clickedRenderables","reverse","onProductsClick","animator","pickController","clickHandler","longClickPickController","longClickHandler","enabledLayers","onWwdCreated","propsTypes","PropTypes","func","bool","timelineState","modalContent","SatelliteGroupOption","getStyles","Heading","headingProps","theme","selectProps","group","memo","WebkitTransition","MozTransition","msTransition","transition","padding","fontWeight","textAlign","whiteSpace","verticalAlign","borderRadius","NotificationBadge","badgeStyle","containerStyle","obj1","obj2","obj","attrname1","attrname2","CachedLayerOption","innerProps","badgeLabel","CountBadge","Option","isFocused","flex","maxHeight","alignItems","marginLeft","overflow","textOverflow","lkey","CachedAcquisitionPlanOption","getOption","onLayerClick","onAcquisitionPlanClick","getAcquisitionPlanOption","SatelliteGroupHeading","restProps","availableAPS","activeStyle","activeAPSStyle","satIconStyle","maxWidth","labelStyle","posIconStyle","apsIconStyle","getSatelliteGroupHeading","ValueContainer","SelectContainer","onCollapsClick","onSatteliteClick","activeColor","customStyles","menu","provided","menuList","container","valueContainer","control","borderColor","groupHeading","disabledStyle","flexFlow","dropdownIndicator","paddingTop","paddingBottom","GroupHeading","Group","menuIsOpen","closeMenuOnSelect","blurInputOnSelect","onMenuClose","onMenuOpen","satelliteSelectState","sateliteOptions","satelliteKey","toggleAcquisitionPlan","TimelineHover","onHover","context","popup","getHoverContent","onHoverOut","contextType","hoverContext","getAbsoluteElementPosition","rect","docEl","documentElement","pageYOffset","pageXOffset","checkBoundatiesConflict","innerBoundingRect","BBox","topInside","rightInside","bottomInside","leftInside","getTootlipPosition","referencePoint","getPosition","origPosX","origPosY","hoveredElemen","topPos","posX","posXIncrement","posY","posYAbsoplute","overflowRight","overflowLeft","boundingRect","getTopPossition","conflict","bottomPos","offsetHeight","getBottomPossition","leftPos","posYIncrement","posXAbsoplute","overflowTop","overflowBottom","getLeftPossition","rightPos","offsetWidth","getRightPossition","validPosition","Popup","ref","createRef","current","getStyle","windowScrollTop","scrollTop","windowScrollLeft","scrollLeft","windowHeight","windowWidth","getTooltipStyle","HoverHandler","hoveredItems","Provider","renderPopup","Picker","vertical","eHeight","indicatorWidth","eWidth","Mouse","mouseX","mouseBufferWidth","getYears","years","getMonths","months","month","getDays","getHours","getMinutes","minutes","Overlay","getX","overlaysCfg","periodStart","periodEnd","periodLimitStart","periodLimitEnd","backgound","overlaysElms","yL","yR","PeriodLimit","periodLimitCfg","periodStartMom","periodEndMom","periodLimitStartMom","periodLimitEndMom","periodLimitsCfg","getPeriodLimits","periodLimitsElms","limit","createElement","TextLabel","elHeight","elWidth","xTransform","yTransform","D1","dHeight","D2","D3","YearsDash","MonthDash","Years","yearsCfg","YearDash","monthsCfg","Months","HoursDash","DaysDash","Days","daysCfg","DayDash","hoursCfg","HourDash","MinutesDash","Hours","minutesCfg","MinuteDash","Minutes","updateContext","centerTime","centerTimeUtc","getActiveLevel","maxDayWidth","minDayWidth","activeLevel","periodLimitVisible","periodLimitOnCenter","selectMode","ContextProvider","propsWithoutChildren","getPageXFromEvent","targetBoudingBox","touch","pageY","pageX","calculateEventDistance","hypot","cachedEvents","targetTouches","evIndex","TimelineEventsWrapper","_drag","_lastX","_mouseDownX","decelerating","_pointerLastX","multiplier","friction","stopThreshold","targetX","trackingPoints","decVelX","onWheel","onPinch","onDrag","onMouseLeave","start_handler","end_handler","move_handler","prevDiff","onPointerUp","resetMouseTouchProps","onPointerDown","handle_pinch_zoom","onPointerMove","registerMovements","setMoving","addTrackingPoint","isClick","stopTracking","found","prevPoint1","prevPoint2","prevDist","dist","targetBox","centerPoint","dragInfo","allDays","halfDays","periodLimitCenter","daysChange","widthOfTimeline","widthOfResult","daysNeededToUpdate","pointerChangeX","startDecelAnim","firstPoint","D","requestAnimFrame","stepDecelAnim","clearScroll","newDayWidth","zoom","zoomX","centerX","beforeMouseDays","center","lockCenter","TimeLineContext","webkitRequestAnimationFrame","mozRequestAnimationFrame","TimelineContent","elementWidth","elementHeight","childrenWithProps","LEVELS","level","Timeline","getStateUpdate","getPeriodLimitByTime","xAxis","getXAxisWidth","minPeriodDayWidth","getDayWidthForPeriod","axesWidth","unix","diffDays","levels","getMaxDayWidth","halfMouseDays","stateUpdate","assign","getPeriodLimitByDayWidth","utcTime","getTimezoneOffset","lastLevel","contentHeight","activeDayWidth","getContentHeight","withResizeDetector","LevelElement","MapsTimeline","onTimeClick","hoveredOverlaysContent","isInside","overlaysContent","getOverlaysContent","containerWidth","containerHeight","initialPeriod","TimeLineHover","selectedDate","onTimelineChange","initialTimelinePeriod","strInitialTimelinePeriod","timelineOverlays","curTimelineState","TimeWidget","timer","startTimer","onSetTime","trackTimeActive","onStopTimer","onStopFollowNow","nowActive","onStartTimer","onSelectActive","onStartFollowNow","mouseTimeMom","timeMom","timeLevelDayWidth","levelDayWidth","currentDayWidth","zoomToTimeLevel","scrollTime","App","onResize","startTrackNowTime","initTime","innerHeight","innerWidth","setOrientation","maxSelectHeight","getMaxSatelliteSelectHeight","handleWidth","handleHeight","SearchModal","SatelliteSelect","horizontal","Boolean","hostname","classList","PASSIVE_EVENTS","checkType","boolean","capture","passive","wantsUntrusted","forceSetPassiveEvents","ReactDOM","useReducer","reducer","vh","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.4dded018.chunk.js","sourcesContent":["module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"b9232d3625614bd14794.worker.js\");\n};","var toGeoJSON = (function () {\n    'use strict';\n\n    var removeSpace = (/\\s*/g),\n        trimSpace = (/^\\s*|\\s*$/g),\n        splitSpace = (/\\s+/);\n    // generate a short, numeric hash of a string\n    function okhash(x) {\n        if (!x || !x.length) {\n            return 0;\n        }\n        for (var i = 0, h = 0; i < x.length; i++) {\n            h = ((h << 5) - h) + x.charCodeAt(i) | 0;\n        }\n        return h;\n    }\n\n    // all Y children of X\n    function get(x, y) {\n        return x.getElementsByTagName(y);\n    }\n\n    function attr(x, y) {\n        return x.getAttribute(y);\n    }\n\n    function attrf(x, y) {\n        return parseFloat(attr(x, y));\n    }\n\n    // one Y child of X, if any, otherwise null\n    function get1(x, y) {\n        var n = get(x, y);\n        return n.length ? n[0] : null;\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/Node.normalize\n    function norm(el) {\n        if (el.normalize) {\n            el.normalize();\n        }\n        return el;\n    }\n\n    // cast array x into numbers\n    function numarray(x) {\n        for (var j = 0, o = []; j < x.length; j++) {\n            o[j] = parseFloat(x[j]);\n        }\n        return o;\n    }\n\n    function clean(x) {\n        var o = {};\n        for (var i in x) {\n            if (x[i]) {\n                o[i] = x[i];\n            }\n        }\n        return o;\n    }\n\n    // get the content of a text node, if any\n    function nodeVal(x) {\n        if (x) {\n            norm(x);\n        }\n        return (x && x.textContent) || '';\n    }\n\n    // get one coordinate from a coordinate array, if any\n    function coord1(v) {\n        return numarray(v.replace(removeSpace, '').split(','));\n    }\n\n    // get all coordinates from a coordinate array as [[],[]]\n    function coord(v) {\n        var coords = v.replace(trimSpace, '').split(splitSpace),\n            o = [];\n        for (var i = 0; i < coords.length; i++) {\n            o.push(coord1(coords[i]));\n        }\n        return o;\n    }\n\n    function coordPair(x) {\n        var ll = [attrf(x, 'lon'), attrf(x, 'lat')],\n            ele = get1(x, 'ele'),\n            // handle namespaced attribute in browser\n            heartRate = get1(x, 'gpxtpx:hr') || get1(x, 'hr'),\n            time = get1(x, 'time'),\n            e;\n        if (ele) {\n            e = parseFloat(nodeVal(ele));\n            if (!isNaN(e)) {\n                ll.push(e);\n            }\n        }\n        return {\n            coordinates: ll,\n            time: time ? nodeVal(time) : null,\n            heartRate: heartRate ? parseFloat(nodeVal(heartRate)) : null\n        };\n    }\n\n    // create a new feature collection parent object\n    function fc() {\n        return {\n            type: 'FeatureCollection',\n            features: []\n        };\n    }\n\n    var serializer;\n    if (typeof XMLSerializer !== 'undefined') {\n        /* istanbul ignore next */\n        serializer = new XMLSerializer();\n        // only require xmldom in a node environment\n    }\n    else if (typeof exports === 'object' && typeof process === 'object' && !process.browser) {\n        //serializer = new (require('xmldom').XMLSerializer)();\n    }\n    function xml2str(str) {\n        // IE9 will create a new XMLSerializer but it'll crash immediately.\n        // This line is ignored because we don't run coverage tests in IE9\n        /* istanbul ignore next */\n        if (str.xml !== undefined) {\n            return str.xml;\n        }\n        return serializer.serializeToString(str);\n    }\n\n    function parseStyle(node) {\n\n        var lineStyle = node.querySelector('LineStyle');\n        var lTextContent;\n        if (lineStyle) {\n            var lColor = lineStyle.querySelector('color');\n            var lWidth = lineStyle.querySelector('width');\n            if (!lColor) {\n                lTextContent = \"ffffffff\";\n            }\n            else {\n                lTextContent = lColor.textContent;\n            }\n\n        }\n        var polySyle = node.querySelector('PolyStyle');\n        var pTextCOntent;\n        if (polySyle) {\n            var pColor = polySyle.querySelector('color');\n            var pFill = polySyle.querySelector('fill');\n            pTextCOntent = pColor.textContent;\n        }\n        var lineColor = lTextContent,\n            polyColor = pTextCOntent;\n        return {\n            lineColor: lineColor,\n            polyColor: polyColor\n        };\n    }\n\n    var t = {\n        kml: function (doc) {\n\n            var gj = fc(),\n                // styleindex keeps track of hashed styles in order to match features\n                styleIndex = {},\n                // atomic geospatial types supported by KML - MultiGeometry is\n                // handled separately\n                geotypes = ['Polygon', 'LineString', 'Point', 'Track', 'gx:Track', 'LinearRing'],\n                // all root placemarks in the file\n                placemarks = get(doc, 'Placemark'),\n                styles = get(doc, 'Style'),\n                styleMaps = get(doc, 'StyleMap');\n\n            for (var k = 0; k < styles.length; k++) {\n                var st = styles[k];\n\n                var strSt = xml2str(styles[k]);\n                var hash = okhash(strSt);\n                //styleIndex['#' + attr(styles[k], 'id')] = okhash(xml2str(styles[k])).toString(16);\n                styleIndex['#' + attr(styles[k], 'id')] = st;\n\n            }\n            for (var l = 0; l < styleMaps.length; l++) {\n                styleIndex['#' + attr(styleMaps[l], 'id')] = okhash(xml2str(styleMaps[l])).toString(16);\n            }\n            for (var j = 0; j < placemarks.length; j++) {\n                gj.features = gj.features.concat(getPlacemark(placemarks[j]));\n            }\n            function kmlColor(v) {\n                var color, opacity;\n                v = v || '';\n                if (v.substr(0, 1) === '#') {\n                    v = v.substr(1);\n                }\n                if (v.length === 6 || v.length === 3) {\n                    color = v;\n                }\n                if (v.length === 8) {\n                    opacity = parseInt(v.substr(0, 2), 16) / 255;\n                    color = '#' + v.substr(2);\n                }\n                return [color, isNaN(opacity) ? undefined : opacity];\n            }\n\n            function gxCoord(v) {\n                return numarray(v.split(' '));\n            }\n\n            function gxCoords(root) {\n                var elems = get(root, 'coord', 'gx'), coords = [], times = [];\n                if (elems.length === 0) {\n                    elems = get(root, 'gx:coord');\n                }\n                for (var i = 0; i < elems.length; i++) {\n                    coords.push(gxCoord(nodeVal(elems[i])));\n                }\n                var timeElems = get(root, 'when');\n                for (var j = 0; j < timeElems.length; j++) {\n                    times.push(nodeVal(timeElems[j]));\n                }\n                return {\n                    coords: coords,\n                    times: times\n                };\n            }\n\n            function getGeometry(root) {\n                var geomNode, geomNodes, i, j, k, geoms = [], coordTimes = [];\n                if (get1(root, 'MultiGeometry')) {\n                    return getGeometry(get1(root, 'MultiGeometry'));\n                }\n                if (get1(root, 'MultiTrack')) {\n                    return getGeometry(get1(root, 'MultiTrack'));\n                }\n                if (get1(root, 'gx:MultiTrack')) {\n                    return getGeometry(get1(root, 'gx:MultiTrack'));\n                }\n                var gasit = false;\n                for (i = 0; i < geotypes.length; i++) {\n                    geomNodes = get(root, geotypes[i]);\n                    if (geomNodes) {\n                        for (j = 0; j < geomNodes.length; j++) {\n                            geomNode = geomNodes[j];\n                            if (geotypes[i] === 'Point') {\n                                geoms.push({\n                                    type: 'Point',\n                                    coordinates: coord1(nodeVal(get1(geomNode, 'coordinates')))\n                                });\n                                gasit = true;\n                            }\n                            else if (geotypes[i] === 'Polygon') {\n                                var rings = get(geomNode, 'LinearRing'),\n                                    coords = [];\n                                for (k = 0; k < rings.length; k++) {\n                                    coords.push(coord(nodeVal(get1(rings[k], 'coordinates'))));\n                                }\n                                geoms.push({\n                                    type: 'Polygon',\n                                    coordinates: coords\n                                });\n                                gasit = true;\n                            }\n                            else if (geotypes[i] === 'LineString' /*|| geotypes[i] === 'LinearRing'*/) {\n                                geoms.push({\n                                    type: 'LineString',\n                                    coordinates: coord(nodeVal(get1(geomNode, 'coordinates')))\n                                });\n                                gasit = true;\n                            }\n                            else if (geotypes[i] === 'LinearRing') {\n                                //console.log('here');\n                                var coords1 = [];\n                                coords1 = coord(nodeVal(get1(geomNode, 'coordinates')));\n                                var outerArr = [coords1];\n                                geoms.push({\n                                    type: 'LinearRing',\n                                    coordinates: outerArr\n                                });\n                                gasit = true;\n                            }\n                            else if (geotypes[i] === 'Track' ||\n                                geotypes[i] === 'gx:Track') {\n                                var track = gxCoords(geomNode);\n                                geoms.push({\n                                    type: 'LineString',\n                                    coordinates: track.coords\n                                });\n                                if (track.times.length) {\n                                    coordTimes.push(track.times);\n                                }\n                                gasit = true;\n                            }\n                        }\n                        if (gasit) {\n                            break;\n                        }\n                    }\n                }\n                return {\n                    geoms: geoms,\n                    coordTimes: coordTimes\n                };\n            }\n\n            function getPlacemark(root) {\n                var geomsAndTimes = getGeometry(root), i, properties = {},\n                    name = nodeVal(get1(root, 'name')),\n                    styleUrl = nodeVal(get1(root, 'styleUrl')),\n                    description = nodeVal(get1(root, 'description')),\n                    timeSpan = get1(root, 'TimeSpan'),\n                    extendedData = get1(root, 'ExtendedData'),\n                    lineStyle = get1(root, 'LineStyle'),\n                    polyStyle = get1(root, 'PolyStyle');\n\n                if (!geomsAndTimes.geoms.length) {\n                    return [];\n                }\n                if (name) {\n                    properties.name = name;\n                }\n                if (styleUrl[0] !== '#') {\n                    styleUrl = '#' + styleUrl;\n                }\n                if (styleUrl && styleIndex[styleUrl]) {\n                    properties.styleUrl = styleUrl;\n                    //properties.styleHash = styleIndex[styleUrl];\n                    var styleDoc = styleIndex[styleUrl];\n                    var a = parseStyle(styleDoc);\n                    properties.lineColor = a.lineColor;\n                    properties.polyColor = a.polyColor;\n                }\n                if (description) {\n                    properties.description = description;\n                }\n                if (timeSpan) {\n                    var begin = nodeVal(get1(timeSpan, 'begin'));\n                    var end = nodeVal(get1(timeSpan, 'end'));\n                    properties.timespan = {begin: begin, end: end};\n                }\n                if (lineStyle) {\n                    var linestyles = kmlColor(nodeVal(get1(lineStyle, 'color'))),\n                        color = linestyles[0],\n                        opacity = linestyles[1],\n                        width = parseFloat(nodeVal(get1(lineStyle, 'width')));\n                    if (color) {\n                        properties.stroke = color;\n                    }\n                    if (!isNaN(opacity)) {\n                        properties['stroke-opacity'] = opacity;\n                    }\n                    if (!isNaN(width)) {\n                        properties['stroke-width'] = width;\n                    }\n                }\n                if (polyStyle) {\n                    var polystyles = kmlColor(nodeVal(get1(polyStyle, 'color'))),\n                        pcolor = polystyles[0],\n                        popacity = polystyles[1],\n                        fill = nodeVal(get1(polyStyle, 'fill')),\n                        outline = nodeVal(get1(polyStyle, 'outline'));\n                    if (pcolor) {\n                        properties.fill = pcolor;\n                    }\n                    if (!isNaN(popacity)) {\n                        properties['fill-opacity'] = popacity;\n                    }\n                    if (fill) {\n                        properties['fill-opacity'] = fill === '1' ? 1 : 0;\n                    }\n                    if (outline) {\n                        properties['stroke-opacity'] = outline === '1' ? 1 : 0;\n                    }\n                }\n                if (extendedData) {\n                    var datas = get(extendedData, 'Data'),\n                        simpleDatas = get(extendedData, 'SimpleData');\n\n                    for (i = 0; i < datas.length; i++) {\n                        properties[datas[i].getAttribute('name')] = nodeVal(get1(datas[i], 'value'));\n                    }\n                    for (i = 0; i < simpleDatas.length; i++) {\n                        properties[simpleDatas[i].getAttribute('name')] = nodeVal(simpleDatas[i]);\n                    }\n                }\n                if (geomsAndTimes.coordTimes.length) {\n                    properties.coordTimes = (geomsAndTimes.coordTimes.length === 1) ?\n                        geomsAndTimes.coordTimes[0] : geomsAndTimes.coordTimes;\n                }\n                var feature = {\n                    type: 'Feature',\n                    geometry: (geomsAndTimes.geoms.length === 1) ? geomsAndTimes.geoms[0] : {\n                            type: 'GeometryCollection',\n                            geometries: geomsAndTimes.geoms\n                        },\n                    properties: properties\n                };\n                if (attr(root, 'id')) {\n                    feature.id = attr(root, 'id');\n                }\n                return [feature];\n            }\n\n            return gj;\n        },\n        gpx: function (doc) {\n            var i,\n                tracks = get(doc, 'trk'),\n                routes = get(doc, 'rte'),\n                waypoints = get(doc, 'wpt'),\n                // a feature collection\n                gj = fc(),\n                feature;\n            for (i = 0; i < tracks.length; i++) {\n                feature = getTrack(tracks[i]);\n                if (feature) {\n                    gj.features.push(feature);\n                }\n            }\n            for (i = 0; i < routes.length; i++) {\n                feature = getRoute(routes[i]);\n                if (feature) {\n                    gj.features.push(feature);\n                }\n            }\n            for (i = 0; i < waypoints.length; i++) {\n                gj.features.push(getPoint(waypoints[i]));\n            }\n            function getPoints(node, pointname) {\n                var pts = get(node, pointname),\n                    line = [],\n                    times = [],\n                    heartRates = [],\n                    l = pts.length;\n                if (l < 2) {\n                    return {};\n                }  // Invalid line in GeoJSON\n                for (var i = 0; i < l; i++) {\n                    var c = coordPair(pts[i]);\n                    line.push(c.coordinates);\n                    if (c.time) {\n                        times.push(c.time);\n                    }\n                    if (c.heartRate) {\n                        heartRates.push(c.heartRate);\n                    }\n                }\n                return {\n                    line: line,\n                    times: times,\n                    heartRates: heartRates\n                };\n            }\n\n            function getTrack(node) {\n                var segments = get(node, 'trkseg'),\n                    track = [],\n                    times = [],\n                    heartRates = [],\n                    line;\n                for (var i = 0; i < segments.length; i++) {\n                    line = getPoints(segments[i], 'trkpt');\n                    if (line.line) {\n                        track.push(line.line);\n                    }\n                    if (line.times && line.times.length) {\n                        times.push(line.times);\n                    }\n                    if (line.heartRates && line.heartRates.length) {\n                        heartRates.push(line.heartRates);\n                    }\n                }\n                if (track.length === 0) {\n                    return;\n                }\n                var properties = getProperties(node);\n                if (times.length) {\n                    properties.coordTimes = track.length === 1 ? times[0] : times;\n                }\n                if (heartRates.length) {\n                    properties.heartRates = track.length === 1 ? heartRates[0] : heartRates;\n                }\n                return {\n                    type: 'Feature',\n                    properties: properties,\n                    geometry: {\n                        type: track.length === 1 ? 'LineString' : 'MultiLineString',\n                        coordinates: track.length === 1 ? track[0] : track\n                    }\n                };\n            }\n\n            function getRoute(node) {\n                var line = getPoints(node, 'rtept');\n                if (!line.line) {\n                    return;\n                }\n                var routeObj = {\n                    type: 'Feature',\n                    properties: getProperties(node),\n                    geometry: {\n                        type: 'LineString',\n                        coordinates: line.line\n                    }\n                };\n                return routeObj;\n            }\n\n            function getPoint(node) {\n                var prop = getProperties(node);\n                prop.sym = nodeVal(get1(node, 'sym'));\n                return {\n                    type: 'Feature',\n                    properties: prop,\n                    geometry: {\n                        type: 'Point',\n                        coordinates: coordPair(node).coordinates\n                    }\n                };\n            }\n\n            function getProperties(node) {\n                var meta = ['name', 'desc', 'author', 'copyright', 'link',\n                        'time', 'keywords'],\n                    prop = {},\n                    k;\n                for (k = 0; k < meta.length; k++) {\n                    prop[meta[k]] = nodeVal(get1(node, meta[k]));\n                }\n                return clean(prop);\n            }\n\n            return gj;\n        }\n    };\n    return t;\n})();\n\nexport default toGeoJSON;","export default class FramebufferTexture {\n\n    constructor(textureId, width, height) {\n        this.textureId = textureId || null;\n        this.imageWidth = width;\n        this.imageHeight = height;\n        this.size = width * height * 4;\n        this.originalImageWidth = width;\n        this.originalImageHeight = height;\n        this.creationTime = new Date();\n    }\n\n    bind(dc) {\n        dc.currentGlContext.bindTexture(dc.currentGlContext.TEXTURE_2D, this.textureId);\n        dc.frameStatistics.incrementTextureLoadCount(1);\n        return true;\n    }\n\n    dispose(gl) {\n        gl.deleteTexture(this.textureId);\n        delete this.textureId;\n    }\n\n}","import FramebufferTexture from './FramebufferTexture';\n\nexport default class Framebuffer {\n\n    constructor() {\n        this.framebufferId = null;\n        this.textureId = null;\n        this.width = 0;\n        this.height = 0;\n        this.texture = null;\n    }\n\n    attachTexture(gl, width, height) {\n        this.textureId = this.createTexture(gl, width, height);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.textureId, 0);\n\n        /*const e = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n        if (e !== gl.FRAMEBUFFER_COMPLETE) {\n            console.log('bind Error creating framebuffer', e);\n            this.framebufferId = null;\n            this.textureId = null;\n            return false;\n        }*/\n\n        this.texture = new FramebufferTexture(this.textureId, width, height);\n\n        return true;\n    }\n\n    bind(gl, width, height) {\n        if(!this.framebufferId) {\n            this.framebufferId = gl.createFramebuffer();\n        }\n\n        this.width = width;\n        this.height = height;\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebufferId);\n        gl.viewport(0, 0, width, height);\n    }\n\n    bind_or(gl, width, height) {\n        /*if (!this.framebufferId) {\n            return false;\n        }*/\n\n        if(!this.framebufferId) {\n            this.framebufferId = gl.createFramebuffer();\n        }\n\n        this.width = width;\n        this.height = height;\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebufferId);\n        gl.viewport(0, 0, width, height);\n        this.textureId = this.createTexture(gl, width, height);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.textureId, 0);\n\n        /*const e = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n        if (e !== gl.FRAMEBUFFER_COMPLETE) {\n            console.log('bind Error creating framebuffer', e);\n            this.framebufferId = null;\n            this.textureId = null;\n            return false;\n        }*/\n\n        this.texture = new FramebufferTexture(this.textureId, width, height);\n\n        return true;\n    }\n\n    clear(gl) {\n        gl.clearColor(0, 0, 0, 0);\n        gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n\n    unbind(gl, fbo) {\n        if (!fbo) {\n            gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n            gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n        }\n        else {\n            gl.bindFramebuffer(gl.FRAMEBUFFER, fbo.framebufferId);\n            gl.viewport(0, 0, fbo.width, fbo.height);\n\n        }\n    }\n\n    createTexture(gl, width, height) {\n        if (width !== 256) {\n            console.log('width', width);\n        }\n        if (height !== 256) {\n            console.log('width', height);\n        }\n        const textureId = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, textureId);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n\n        /*var ext = (\n            gl.getExtension(\"EXT_texture_filter_anisotropic\") ||\n            gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\"));\n        if (ext) {\n            gl.texParameteri(gl.TEXTURE_2D, ext.TEXTURE_MAX_ANISOTROPY_EXT, 16);\n        }*/\n\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\n        //gl.generateMipmap(gl.TEXTURE_2D);\n        //gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, textureId, 0);\n        return textureId;\n    }\n\n}","import Framebuffer from '../framebuffer/Framebuffer';\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    ArgumentError,\n    Logger,\n    SurfaceShapeTileBuilder,\n    SurfaceShape,\n    PickedObject\n} = WorldWind;\n\nconst fboCacheKey = 'SurfaceShapeFBO';\n\nSurfaceShapeTileBuilder.prototype.buildTiles = function (dc) {\n    if (!dc) {\n        throw new ArgumentError(\n            Logger.logMessage(Logger.LEVEL_SEVERE, 'SurfaceShapeTileBuilder', 'buildTiles', 'missingDc'));\n    }\n\n    if (!this.surfaceShapes || this.surfaceShapes.length < 1) {\n        return;\n    }\n\n    // Assemble the current visible tiles and update their associated textures if necessary.\n    this.assembleTiles(dc);\n\n    if (SurfaceShapeTileBuilder.__fboBound__) {\n        const fbo = SurfaceShapeTileBuilder.getFbo(dc);\n        fbo.unbind(dc.currentGlContext, dc.currentFramebuffer);\n        SurfaceShapeTileBuilder.__fboBound__ = false;\n    }\n\n    // Clean up references to all surface shapes to avoid dangling references. The surface shape list is no\n    // longer needed, now that the shapes are held by each tile.\n    this.surfaceShapes.splice(0, this.surfaceShapes.length);\n    for (var idx = 0, len = this.surfaceShapeTiles.length; idx < len; idx += 1) {\n        var tile = this.surfaceShapeTiles[idx];\n        tile.clearShapes();\n    }\n};\n\n\nSurfaceShapeTileBuilder.prototype.addTile = function (dc, tile) {\n    if (dc.pickingMode) {\n        tile.pickSequence = SurfaceShapeTileBuilder.pickSequence;\n    }\n\n    if (tile.needsUpdate(dc)) {\n\n        //debugger;\n        const fbo = SurfaceShapeTileBuilder.getFbo(dc);\n        if (!SurfaceShapeTileBuilder.__fboBound__) {\n            fbo.bind(dc.currentGlContext, this.tileWidth, this.tileHeight);\n            SurfaceShapeTileBuilder.__fboBound__ = true;\n        }\n\n        tile.updateTexture(dc);\n    }\n\n    this.surfaceShapeTiles.push(tile);\n};\n\nSurfaceShapeTileBuilder.prototype.doDeepPickingRender = function (dc) {\n    var idxTile, lenTiles, idxShape, lenShapes, idxPick, lenPicks, po, shape, tile;\n\n    // Determine the shapes that were drawn during buildTiles. These shapes may not actually be\n    // at the pick point, but they are candidates for deep picking.\n    var deepPickShapes = [];\n    for (idxPick = 0, lenPicks = dc.objectsAtPickPoint.objects.length; idxPick < lenPicks; idxPick += 1) {\n        po = dc.objectsAtPickPoint.objects[idxPick];\n        if (po.userObject instanceof SurfaceShape) {\n            shape = po.userObject;\n\n            // If the shape was not already in the collection of deep picked shapes, ...\n            if (deepPickShapes.indexOf(shape) < 0) {\n                deepPickShapes.push(shape);\n\n                // Delete the shape that was drawn during buildTiles from the pick list.\n                dc.objectsAtPickPoint.objects.splice(idxPick, 1);\n\n                // Update the index and length to reflect the deletion.\n                idxPick -= 1;\n                lenPicks -= 1;\n            }\n        }\n    }\n\n    if (deepPickShapes.length <= 0) {\n        return;\n    }\n\n    // For all shapes,\n    //  1) force that shape to be the only shape in a tile,\n    //  2) re-render the tile, and\n    //  3) use the surfaceTileRenderer to render the tile on the terrain,\n    //  4) read the color to see if it is attributable to the current shape.\n    var resolvablePickObjects = [];\n    for (idxShape = 0, lenShapes = deepPickShapes.length; idxShape < lenShapes; idxShape += 1) {\n        shape = deepPickShapes[idxShape];\n\n        const fbo = SurfaceShapeTileBuilder.getFbo(dc);\n        if (!SurfaceShapeTileBuilder.__fboBound__) {\n            fbo.bind(dc.currentGlContext, this.tileWidth, this.tileHeight);\n            SurfaceShapeTileBuilder.__fboBound__ = true;\n        }\n\n        for (idxTile = 0, lenTiles = this.surfaceShapeTiles.length; idxTile < lenTiles; idxTile += 1) {\n            tile = this.surfaceShapeTiles[idxTile];\n            tile.setShapes([shape]);\n\n            tile.updateTexture(dc);\n        }\n\n        if (SurfaceShapeTileBuilder.__fboBound__) {\n            const fbo = SurfaceShapeTileBuilder.getFbo(dc);\n            fbo.unbind(dc.currentGlContext, dc.currentFramebuffer);\n            SurfaceShapeTileBuilder.__fboBound__ = false;\n        }\n\n        dc.surfaceTileRenderer.renderTiles(dc, this.surfaceShapeTiles, 1);\n\n        var pickColor = dc.readPickColor(dc.pickPoint);\n        if (!!pickColor && shape.pickColor.equals(pickColor)) {\n            po = new PickedObject(shape.pickColor.clone(),\n                shape.pickDelegate ? shape.pickDelegate : shape, null, shape.layer, false);\n            resolvablePickObjects.push(po);\n        }\n    }\n\n    // Flush surface shapes that have accumulated in the updateTexture pass just completed on all shapes.\n    for (idxPick = 0, lenPicks = dc.objectsAtPickPoint.objects.length; idxPick < lenPicks; idxPick += 1) {\n        po = dc.objectsAtPickPoint.objects[idxPick];\n        if (po.userObject instanceof SurfaceShape) {\n            // Delete the shape that was picked in the most recent pass.\n            dc.objectsAtPickPoint.objects.splice(idxPick, 1);\n\n            // Update the index and length to reflect the deletion.\n            idxPick -= 1;\n            lenPicks -= 1;\n        }\n    }\n\n    // Add the resolvable pick objects for surface shapes that were actually visible at the pick point\n    // to the pick list.\n    for (idxPick = 0, lenPicks = resolvablePickObjects.length; idxPick < lenPicks; idxPick += 1) {\n        po = resolvablePickObjects[idxPick];\n        dc.objectsAtPickPoint.objects.push(po);\n    }\n};\n\nSurfaceShapeTileBuilder.getFbo = function (dc) {\n    let fbo = dc.gpuResourceCache.resourceForKey(fboCacheKey);\n    if (!fbo) {\n        fbo = new Framebuffer();\n        dc.gpuResourceCache.putResource(fboCacheKey, fbo, 1);\n    }\n    return fbo;\n};\n\nSurfaceShapeTileBuilder.__frameStart__ = false;\nSurfaceShapeTileBuilder.__fboBound__ = false;","import Framebuffer from '../framebuffer/Framebuffer';\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    SurfaceShapeTile\n} = WorldWind;\n\nSurfaceShapeTile.prototype.updateTexture = function (dc) {\n    var gl = dc.currentGlContext;\n    // Mapping from lat/lon to x/y:\n    //  lon = minlon => x = 0\n    //  lon = maxLon => x = 256\n    //  lat = minLat => y = 256\n    //  lat = maxLat => y = 0\n    //  (assuming texture size is 256)\n    // So:\n    //  x = 256 / sector.dlon * (lon - minLon)\n    //  y = -256 / sector.dlat * (lat - maxLat)\n    var xScale = this.tileWidth / this.sector.deltaLongitude(),\n        yScale = -this.tileHeight / this.sector.deltaLatitude(),\n        xOffset = -this.sector.minLongitude * xScale,\n        yOffset = -this.sector.maxLatitude * yScale;\n\n    // Reset the surface shape state keys\n    this.asRenderedSurfaceShapeStateKeys = [];\n\n    var fbo = dc.gpuResourceCache.resourceForKey('SurfaceShapeFBO');\n    fbo.attachTexture(gl, this.tileWidth, this.tileHeight);\n    fbo.clear(gl);\n\n    for (var idx = 0, len = this.surfaceShapes.length; idx < len; idx += 1) {\n        var shape = this.surfaceShapes[idx];\n        this.asRenderedSurfaceShapeStateKeys.push(this.surfaceShapeStateKeys[idx]);\n\n        shape.renderToTexture(dc, fbo, xScale, yScale, xOffset, yOffset);\n    }\n\n    this.gpuCacheKey = this.getCacheKey();\n\n    var gpuResourceCache = dc.gpuResourceCache;\n    var texture = fbo.texture;\n    gpuResourceCache.putResource(this.gpuCacheKey, texture, texture.size);\n\n    return texture;\n};","import WorldWind from 'webworldwind-esa';\n\nconst {\n    TiledImageLayer\n} = WorldWind;\n\nvar index = 0;\n\nTiledImageLayer.prototype.retrieveTileImage = function (dc, tile, suppressRedraw) {\n    if (!this.pendingRequests) {\n        this.pendingRequests = [];\n    }\n    if (!this.MAX_REQUESTS) {\n        this.MAX_REQUESTS = 16;\n    }\n\n    const isBeingRetrieved = this.currentRetrievals.indexOf(tile.imagePath) >= 0;\n    if (isBeingRetrieved) {\n        return;\n    }\n\n    const isPending = this.pendingRequests.some(t => t.imagePath === tile.imagePath);\n    if (isPending) {\n        return;\n    }\n\n    if (this.absentResourceList.isResourceAbsent(tile.imagePath)) {\n        return;\n    }\n\n    const url = this.resourceUrlForTile(tile, this.retrievalImageFormat);\n    //const imagePath = tile.imagePath;\n\n    if (!url) {\n        this.currentTilesInvalid = true;\n        return;\n    }\n\n    /*this.pendingRequests.push(tile);\n    if (this.pendingRequests.length === 100) {\n        console.log('pendingRequests', this.pendingRequests.length, 'currentRetrievals', this.currentRetrievals.length);\n        //console.log('pendingRequests', this.pendingRequests.slice());\n\n        this.pendingRequests = this.pendingRequests.slice(80);\n\n        console.log('pendingRequests', this.pendingRequests.length, 'currentRetrievals', this.currentRetrievals.length);\n    }*/\n    if (this.pendingRequests.length === 20) {\n        //console.log(20);\n        this.pendingRequests.shift();\n    }\n    this.pendingRequests.push(tile);\n\n    if (this.currentRetrievals.length <= this.MAX_REQUESTS) {\n        this.fetchMoreImages(dc, this);\n    }\n};\n\nTiledImageLayer.prototype.fetchMoreImages = function (dc, layer) {\n    const before = layer.pendingRequests.length;\n    layer.pendingRequests = layer.pendingRequests.filter(pendingTile => layer.isTileVisible(dc, pendingTile));\n    if (!layer.pendingRequests.length) {\n        return;\n    }\n\n    const skip = before - layer.pendingRequests.length\n\n    //if (skip) console.log('skip tiles', skip);\n\n    var pendingTile = layer.pendingRequests.shift();\n    var imagePath = pendingTile.imagePath;\n    var url = layer.resourceUrlForTile(pendingTile, layer.retrievalImageFormat);\n\n    if (!imagePath || !url) {\n        return;\n    }\n\n    const cache = dc.gpuResourceCache;\n    //const layer = self;\n\n    layer.fetchImage(url, function (err, image) {\n        if (err) {\n            layer.removeFromCurrentRetrievals(imagePath);\n            layer.absentResourceList.markResourceAbsent(imagePath);\n\n            if (layer.currentRetrievals.length <= layer.MAX_REQUESTS) {\n                layer.fetchMoreImages(dc, layer);\n            }\n            return;\n        }\n\n        var texture = layer.createTexture(dc, null, image);\n        layer.removeFromCurrentRetrievals(imagePath);\n\n        if (texture) {\n            cache.putResource(imagePath, texture, texture.size);\n\n            layer.currentTilesInvalid = true;\n            layer.absentResourceList.unmarkResourceAbsent(imagePath);\n\n            var e = document.createEvent('Event');\n            e.initEvent(WorldWind.REDRAW_EVENT_TYPE, true, true);\n            window.dispatchEvent(e);\n        }\n\n        if (layer.currentRetrievals.length <= layer.MAX_REQUESTS) {\n            layer.fetchMoreImages(dc, layer);\n        }\n    });\n\n    layer.currentRetrievals.push(imagePath);\n};\n\nTiledImageLayer.prototype.fetchImage = function (url, cb) {\n    const image = new Image();\n\n    image.onload = function () {\n        cb(null, image);\n    };\n\n    image.onerror = function () {\n        cb(new Error('Image retrieval failed'), null);\n    };\n\n    image.crossOrigin = 'anonymous';\n\n    if (window.webkit) {\n        // url = '/proxy?url=' + encodeURIComponent(url);\n    }\n    else if (!window.webkit && !window.AndroidApp) {\n        // url = '/proxy?url=' + encodeURIComponent(url);\n    }\n\n    image.src = url;\n};\n\nTiledImageLayer.prototype.doRender_ = function (dc) {\n    if (!dc.terrain)\n        return;\n\n    if (this.currentTilesInvalid\n        || !this.lasTtMVP || !dc.navigatorState.modelviewProjection.equals(this.lasTtMVP)\n        || dc.globeStateKey !== this.lastGlobeStateKey) {\n        this.currentTilesInvalid = false;\n\n        this.assembleTiles(dc);\n\n        // Tile fading works visually only when the surface tiles are opaque, otherwise the surface flashes\n        // when two tiles are drawn over the same area, even though one of them is semi-transparent.\n        // So do not provide fading when the surface opacity is less than 1;\n        /*if (dc.surfaceOpacity >= 1 && this.opacity >= 1) {\n            // Fading of outgoing tiles requires determination of the those tiles. Prepare an object with all of\n            // the preceding frame's tiles so that we can subsequently compare the list of newly selected tiles\n            // with the previously selected tiles.\n            this.previousTiles = {};\n            for (var j = 0; j < this.currentTiles.length; j++) {\n                this.previousTiles[this.currentTiles[j].imagePath] = this.currentTiles[j];\n            }\n\n            this.assembleTiles(dc);\n            this.fadeOutgoingTiles(dc);\n        } else {\n            this.assembleTiles(dc);\n        }*/\n\n    }\n\n    this.lasTtMVP = dc.navigatorState.modelviewProjection;\n    this.lastGlobeStateKey = dc.globeStateKey;\n\n    //this.cleanCache(dc);\n\n    if (this.currentTiles.length > 0) {\n        dc.surfaceTileRenderer.renderTiles(dc, this.currentTiles, this.opacity, dc.surfaceOpacity >= 1);\n        dc.frameStatistics.incrementImageTileCount(this.currentTiles.length);\n        this.inCurrentFrame = true;\n    }\n};\n\nTiledImageLayer.prototype.cleanCache = function () {\n\n};","\nexport default {\n    'FOCUS_SATELLITE': 'FOCUS_SATELLITE',\n    'TOGGLE_LAYER': 'TOGGLE_LAYER',\n    'PREVENT_RELOAD_LAYERS': 'PREVENT_RELOAD_LAYERS',\n    'DEACTIVATE_LAYER': 'DEACTIVATE_LAYER',\n    'ACTIVATE_LAYER': 'ACTIVATE_LAYER',\n    'UPDATE_ACTIVE_LAYER': 'UPDATE_ACTIVE_LAYER',\n    'CHANGE_SELECTTIME': 'CHANGE_SELECTTIME',\n    'CHANGE_CURRENTTIME': 'CHANGE_CURRENTTIME',\n    'CHANGE_ACTIVE_TIME_LEVEL': 'CHANGE_ACTIVE_TIME_LEVEL',\n    'FOLLOW_NOW': 'FOLLOW_NOW',\n    'TRACK_TIME': 'TRACK_TIME',\n    'CHANGE_TIME_LINE_DAY_WIDTH': 'CHANGE_TIME_LINE_DAY_WIDTH',\n    'TIME_LINE_SET_MOUSE_TIME': 'TIME_LINE_SET_MOUSE_TIME',\n    'SET_OVERLAYS': 'SET_OVERLAYS',\n    'UPDATE_INFO_MODAL': 'UPDATE_INFO_MODAL',\n    'SET_ACTIVE_INFO_MODAL': 'SET_ACTIVE_INFO_MODAL',\n    'SET_ORBITS': 'SET_ORBITS',\n    'SET_ACQUISITION_PLANS': 'SET_ACQUISITION_PLANS',\n    'MAP_ADD_VISIBLE_ACQUISITION_PLAN': 'MAP_ADD_VISIBLE_ACQUISITION_PLAN',\n    'DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT': 'DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT',\n    'MAP_REMOVE_VISIBLE_ACQUISITION_PLAN': 'MAP_REMOVE_VISIBLE_ACQUISITION_PLAN',\n    'DATA_UPDATE_ACQUISITIONPLANS': 'DATA_UPDATE_ACQUISITIONPLANS',\n    'COMPONENT': {\n        'SET': 'COMPONENT.SET',\n        'UPDATE': 'COMPONENT.UPDATE',\n    },\n    'COMPONENTS' :{\n        'SEARCH': {\n            'SET_PRODUCTS': 'COMPONENTS.SEARCH.SET_PRODUCTS',\n        }\n    },\n    'SET_WWD': 'SET_WWD'\n}","import { createSelector } from 'reselect'\nimport {get} from 'lodash';\n\nconst getSubstate = createSelector([\n        state => state,\n        (state, substate) => substate,\n    ], (state, substate) => state[substate]\n)\n\nconst getByPath = createSelector([\n        state => state,\n        (state, path) => path,\n    ], (state, path) => get(state, path, null));\n\nconst getByKey = createSelector([\n        state => state,\n        (state, key) => key,\n    ], (state, key) => state[key]\n)\n\nexport default{\n    getSubstate,\n    getByPath,\n    getByKey,\n}","import common from '../_common';\n\nconst getSubstate = (state) => common.getByPath(state, ['data', 'satellites']);\nconst getSatelliteByKey = (state, satKey) => getSubstate(state).find(s => s.id === satKey);\n\nexport {\n    getSubstate,\n    getSatelliteByKey,\n}","import common from '../_common';\n\nconst getSubstate = (state) => common.getByPath(state, ['map']);\nconst getVisibleAcquisitionsPlans = (state) => getSubstate(state)['acquisitionPlans'];\nconst isVisibleAcquisitionPlanByKey = (state, key) => {\n    const acquisitionsPlans = getVisibleAcquisitionsPlans(state);\n    return acquisitionsPlans && acquisitionsPlans.includes(key);\n};\n\nexport {\n    getSubstate,\n    getVisibleAcquisitionsPlans,\n    isVisibleAcquisitionPlanByKey,\n}","import common from '../_common';\nimport createCachedSelector from 're-reselect';\n\nconst getSubstate = (state) => common.getByPath(state, ['data', 'layers']);\nconst getByKey = createCachedSelector([\n    state => state,\n    (state, key) => key\n], (state, key) => common.getByKey(state, key))((state, key) => key);\n\nexport {\n    getSubstate,\n    getByKey,\n}","import common from '../_common';\nimport moment from 'moment';\n\nconst getSubstate = (state) => common.getByPath(state, ['data', 'acquisitionPlans']);\n\nconst getDateString = (date) => moment(date).format('YYYYMMDD');\n\n/**\n * \n * @param {Array.<object>} aps \n * @param {string} dateString - Date string like \"20190405\"\n */\nconst apsForTime = (aps, dateString) => {\n    const startDate = aps.start;\n    const endDate = aps.end;\n\n    const start = dateString;\n    const end = dateString;\n\n    const fullyInside = startDate > start && endDate < end;\n    const partiallyBefore = startDate < start && endDate > start;\n    const partiallyAfter = startDate < end && endDate > end;\n    \n    return fullyInside || partiallyBefore || partiallyAfter;\n}\n\n/**\n * @param {Date} date - Date string like \"20190405\"\n */\nconst getPlansForDate = (state, date) => {\n    const dateString = getDateString(date);\n    const substate = getSubstate(state);\n    if(substate && substate.length) {\n        return substate.map(satAps => {\n            return {\n                ...satAps,\n                plans:  satAps.plans.filter(aps => apsForTime(aps, dateString))\n            }\n        })\n    } else {\n        return [];\n    }\n}\n\nconst getLoadingAcquisitionsPlans = (state) => {\n    const substate = getSubstate(state);\n    if(substate && substate.length) {\n        return substate.reduce((acc, satAps) => {\n            const loadingPlans = satAps.plans.reduce((acc, plan) => {\n                if(plan.loading) {\n                    return [...acc, plan];\n                } else {\n                    return acc;\n                }\n            }, []);\n\n            if(loadingPlans && loadingPlans.length > 0) {\n                return [...acc, {key: satAps.key, plans: loadingPlans}]\n            } else {\n                return acc;\n            }\n        }, [])\n    } else {\n        return [];\n    }\n\n}\n\nexport {\n    getSubstate,\n    getPlansForDate,\n    getLoadingAcquisitionsPlans,\n}","import common from '../_common';\nimport createCachedSelector from 're-reselect';\n\nconst getSubstate = (state) => common.getByPath(state, ['data', 'orbits']);\nconst getByKey = createCachedSelector([\n    state => state,\n    (state, key) => key\n], (state, key) => common.getByKey(state, key))((state, key) => key);\n\nexport {\n    getSubstate,\n    getByKey,\n}","import { createSelector } from 'reselect'\nimport moment from 'moment';\nimport common from '../_common';\nimport {getCurrentTime} from '../rootSelectors';\n\n// export const addItemToIndex = (array, index, item) => [...array.slice(0, index), item, ...array.slice(index)];\n// export const removeItemByIndex = (array, index) => [...array.slice(0, index), ...array.slice(index + 1)];\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'search']);\nconst getActiveResultIndex = (state) => common.getByPath(state, ['components', 'search', 'activeResultIndex']);\nconst getResults = (state) => common.getByPath(state, ['components', 'search', 'results']);\nconst getFilterTime = (state) => common.getByPath(state, ['components', 'search', 'filterTime']);\n\nconst getSearchLayer = (state) => {\n    const activeResultIndex = getActiveResultIndex(state);\n    const results = getResults(state);\n    if(Number.isInteger(activeResultIndex) && results && results.length > 0 && activeResultIndex <= results.length) {\n        return results[activeResultIndex];\n    } else {\n        return null;\n    }\n}\n\nexport {\n    getActiveResultIndex,\n    getFilterTime,\n    getResults,\n    getSubstate,\n    getSearchLayer,\n}","const getSatAPSUrl = (satKey) => `https://eoapps.solenix.ch/aps/${satKey}/`;\nconst getSatIntervalAPSUrl = (satKey, start, end) => `https://eoapps.solenix.ch/aps/${satKey}/${satKey.toUpperCase()}_${start}_${end}.kml`;\n// const satellites = ['s1a', 's1b', 's2a', 's2b', 's3a', 's3b', 's5p'];\nconst satellites = ['s1a', 's1b', 's2a', 's2b'];\n//cache tle in Map\nconst cache = new Map();\n\nexport const getPlansKeys = (aps) => aps && aps.length ? aps.map(a => `${a.start}_${a.end}`).join('') : '';\n\nconst parseAPSfiles = (result, satKey) => {\n        const kmls = result.split('\\n');\n\n        return kmls.reduce((acc, kmlName) => {\n            if (kmlName === '') {\n                return acc;\n            } else {\n                let kml = kmlName.replace('.kml', '').split('_');\n                return [...acc, {\n                    start: kml[1],\n                    end: kml[2],\n                    name: kmlName,\n                    satName: satKey,\n                    url: getSatIntervalAPSUrl(satKey, kml[1], kml[2]),\n                }];\n            }\n        }, [])\n}\n\n/**\n * @param {string} satKey - Satellite key for acquisition plans\n */\nexport const getAcquisitionPlans = async (satKey) => {\n    \n    let aps = null;\n\n    if(cache.has(satKey)) {\n        aps = cache.get(satKey);\n        //check if aps is Promise\n        if(aps && typeof aps.then == 'function') {\n            aps = await aps;\n            return aps;\n        } else {\n            return aps;\n        }\n    } else {\n        const request = fetch(getSatAPSUrl(satKey)).then(response => response.text()).then(text => parseAPSfiles(text, satKey));\n        cache.set(satKey, request);\n        return await request;\n    }\n}\n\nexport const getAllAcquisitionPlans = async () => {\n    return await Promise.all(\n        satellites.map(async (satKey) => {\n            const aps = await getAcquisitionPlans(satKey);\n            return {\n                key: satKey,\n                plans: aps,\n            }\n        })\n    );\n};","\n/**\n * Compare release date from satData to given date. If date of release is before given date, then return true.\n * @param {Object} satellite Satellite data for questioned satellite\n * @param {Date} date Date that is compared\n */\nconst isSatelliteReleaseBeforeDate = (satellite, date) => {\n    return satellite.satData.launchDate.getTime() < new Date(date).getTime();\n}\n\n/**\n * Find satellite by given orbit by orbit key, then check if is satellite released.\n * @param {Object} orbit Orbit of questioned satellite\n * @param {Array.<Object>} satellites Array of satellite data \n * @param {Date} date Date that is compared\n */\nconst filterByReleasedSatellite = (orbit, satellites, date) => {\n    const satKey = orbit.key.split(\"orbit-\")[1];\n    const satellite = satellites.find((s) => s.id === satKey);\n    return isSatelliteReleaseBeforeDate(satellite, date);\n};\n\nconst filterByActiveSatellite = (orbit, activeSatelliteKey) => {\n    if(activeSatelliteKey) {\n        const satKey = orbit.key.split(\"orbit-\")[1];\n        return satKey === activeSatelliteKey;\n    } else {\n        return true;\n    }\n};\n\nexport default {\n    isSatelliteReleaseBeforeDate,\n    filterByReleasedSatellite,\n    filterByActiveSatellite,\n}","import WorldWind from 'webworldwind-esa';\nconst {\n    Color\n} = WorldWind;\n\nconst satData = [\n    {\n        key: 's1a',\n        name: 'SENTINEL-1A',\n        shortName: 'S-1A',\n        satIndex: 0,\n        swathTypes: ['black', 'red', 'green', 'white'],\n        swathColors: [\n            Color.colorFromKmlHex('ff000000'), //black\n            Color.colorFromKmlHex('ff0000ff'), //red\n            Color.colorFromKmlHex('ff00ff00'), //green\n            Color.colorFromKmlHex('ffffffff')  //white\n        ],\n        swatModes: ['IW', 'EW', 'SM'],\n        tleLineOne: '1 39634U 14016A   18124.03591006  .00000001  00000-0  10014-4 0  9998',\n        tleLineTwo: '2 39634  98.1819 132.0838 0001369  78.7198 281.4156 14.59198520217480',\n        hasModel: true,\n        filePath: 'satellites/sentinel1/',\n        fileName: 's1.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 500000,\n        translations: {\n            x: -0.1,\n            y: -0.1,\n            z: 0\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2014-04-03T21:02:00.000Z'),\n    },\n    {\n        key: 's2a',\n        name: 'SENTINEL-2A',\n        shortName: 'S-2A',\n        satIndex: 1,\n        swathTypes: ['red', 'purple', 'white', 'darkGrey', 'green', 'greener'],\n        swathColors: [\n            Color.colorFromKmlHex('ff0000ff'), //red\n            Color.colorFromKmlHex('ffff00ff'), //purple\n            Color.colorFromKmlHex('ffffffff'), //white\n            Color.colorFromKmlHex('ff7f7f7f'), //dark grey\n            Color.colorFromKmlHex('ff00ff00'),  //green\n            Color.colorFromKmlHex('ff00fff7')  //greener\n        ],\n        swatModes: ['NOBS'],\n        tleLineOne: '1 40697U 15028A   18124.08865983  .00000004  00000-0  17994-4 0  9993',\n        tleLineTwo: '2 40697  98.5686 199.4434 0001286  92.5669 267.5666 14.30817033149583',\n        hasModel: true,\n        filePath: 'satellites/senti2version6/',\n        fileName: 's2.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 1000000,\n        translations: {\n            x: 0.1,\n            y: 0.385,\n            z: 0.02\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2015-06-23T01:52:00.000Z'),\n    },\n    {\n        key: 's3a',\n        name: 'SENTINEL-3A',\n        shortName: 'S-3A',\n        satIndex: 2,\n        tleLineOne: '1 41335U 16011A   18124.14356592 -.00000000  00000-0  18017-4 0  9998',\n        tleLineTwo: '2 41335  98.6266 192.0005 0001035 100.1921 259.9376 14.26736754115121',\n        hasModel: true,\n        filePath: 'satellites/Sentinel3/',\n        fileName: 's3.json',\n        rotations: {\n            x: 0, //0\n            y: 0, //180\n            z: 0, //165\n            headingAxis: [0, 0, 1], //0,0,1\n            headingAdd: 180, //-20\n            headingMultiply: 1 //1\n        },\n        preRotations: {\n            x: 0,\n            y: 180,\n            z: 0\n        },\n        scale: 1000000,\n        translations: {\n            x: 0.01, //-0.01\n            y: 1.98, //1.9\n            z: 0.07 //-0.07\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2016-02-16T17:57:00.000Z'),\n    },\n    {\n        key: 's1b',\n        name: 'SENTINEL-1B',\n        shortName: 'S-1B',\n        satIndex: 3,\n        swathTypes: ['black', 'red', 'green', 'white'],\n        swathColors: [\n            Color.colorFromKmlHex('ff000000'), //black\n            Color.colorFromKmlHex('ff0000ff'), //red\n            Color.colorFromKmlHex('ff00ff00'), //green\n            Color.colorFromKmlHex('ffffffff')  //white\n        ],\n        swatModes: ['IW', 'EW', 'SM'],\n        tleLineOne: '1 41456U 16025A   18124.13828432 -.00000022  00000-0  49756-5 0  9992',\n        tleLineTwo: '2 41456  98.1817 132.0102 0001487  82.9964 277.1419 14.59197806107664',\n        hasModel: true,\n        filePath: 'satellites/sentinel1/',\n        fileName: 's1.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 500000,\n        translations: {\n            x: -0.1,\n            y: -0.1,\n            z: 0\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2016-04-25T21:02:00.000Z'),\n    },\n    {\n        key: 's2b',\n        name: 'SENTINEL-2B',\n        shortName: 'S-2B',\n        satIndex: 4,\n        swathTypes: ['blue'],\n        swathColors: [\n            Color.colorFromKmlHex('ffffff00'),\n        ],\n        swatModes: ['NOBS'],\n        tleLineOne: '1 42063U 17013A   18124.12358125  .00000002  00000-0  17497-4 0  9994',\n        tleLineTwo: '2 42063  98.5687 199.4702 0001382  97.5073 262.6270 14.30817718 60503',\n        groundPosition: {latitude: 5.2079, longitude: -52.7724, altitude: 0},\n        hasModel: true,\n        filePath: 'satellites/senti2version6/',\n        fileName: 's2.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 1000000,\n        translations: {\n            x: 0.1,\n            y: 0.385,\n            z: 0.02\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2017-03-07T01:49:00.000Z'),\n    },\n    {\n        key: 's5p',\n        name: 'SENTINEL-5P',\n        shortName: 'S-5P',\n        satIndex: 5,\n        swathTypes: [],\n        swathColors: [],\n\n        tleLineOne: '1 42969U 17064A   18123.85141871 -.00000009  00000-0  16636-4 0  9994',\n        tleLineTwo: '2 42969  98.7352  64.1585 0001101  78.1817 281.9482 14.19565315 28712',\n\n        groundPosition: {latitude: 62.927860, longitude: 40.574830, altitude: 0},\n        hasModel: true,\n        filePath: 'satellites/sentinel5p/',\n        fileName: 's5p.json',\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 180 + 30,\n            y: 0,\n            z: 0\n        },\n        scale: 70000,\n        translations: {\n            x: 0.5,\n            y: 0.4,\n            z: -1.2\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2017-10-13T09:27:00.000Z'),\n    },\n    {\n        key: 's3b',\n        name: 'SENTINEL-3B',\n        shortName: 'S-3B',\n        satIndex: 6,\n        tleLineOne: '1 43437U 18039A   18122.61596633  .00002473  00000-0  10753-2 0  9999',\n        tleLineTwo: '2 43437  98.6226 190.4610 0008811 292.4467  67.5830 14.24954518   977',\n        groundPosition: {\n            latitude: 62.925556,\n            longitude: 40.577778,\n            altitude: 0,\n        },\n        hasModel: true,\n        filePath: 'satellites/Sentinel3/',\n        fileName: 's3.json',\n        rotations: {\n            x: 0, //0\n            y: 0, //180\n            z: 0, //165\n            headingAxis: [0, 0, 1], //0,0,1\n            headingAdd: 180, //-20\n            headingMultiply: 1 //1\n        },\n        preRotations: {\n            x: 0,\n            y: 180,\n            z: 0\n        },\n        scale: 1000000,\n        translations: {\n            x: 0.01, //-0.01\n            y: 1.98, //1.9\n            z: 0.07 //-0.07\n        },\n        ignoreLocalTransforms: true,\n        launchDate: new Date('2018-04-25T17:57:00.000Z'),\n    },\n];\n\nexport const getSatDataByKey = (satKey) => {\n    return satData.find((s) => s.key === satKey);\n};\nexport const getDefaultSatOrbitBySatKey = (satKey) => {\n    const sat = getSatDataByKey(satKey);\n    // const launchDate = `${sat.launchDate.getUTCFullYear()}-${sat.launchDate.getUTCMonth()}-${sat.launchDate.getUTCDate()}`\n    return {\n        // key: `${satKey}-${launchDate}`,\n        key: `orbit-${satKey}`,\n        specs: [\n            sat.tleLineOne,\n            sat.tleLineTwo,\n        ]\n    }\n};\n\nexport default satData;","import createCachedSelector from 're-reselect';\nimport momentjs from 'moment';\nimport common from './_common';\nimport {getSubstate as getOrbitsSubstate} from './data/orbits';\nimport {getSubstate as getSatellitesSubstate} from './data/satellites';\nimport {getSearchLayer} from './components/search';\nimport {getSubstate as getAcquisitionPlansSubstate, getPlansForDate} from './data/acquisitionPlans';\nimport {getVisibleAcquisitionsPlans} from './map';\nimport {getPlansKeys} from '../../utils/acquisitionPlans';\nimport satellitesUtils from '../../utils/satellites';\nimport {getSatDataByKey} from '../satData';\nexport const getSelectTimePastOrCurrent = (state) => common.getByPath(state, ['selectTimePastOrCurrent']);\n\nexport const getCurrentTime = createCachedSelector(\n    (state) => common.getByPath(state, ['currentTime']),\n    (currentTime) => currentTime\n)((state) => common.getByPath(state, ['currentTime']))\n\nexport const getPreventReloadLayers = (state) => common.getByPath(state, ['preventReloadLayers']);\nexport const getActiveInfoModalKey = (state) => common.getByPath(state, ['infoModal', 'active']);\nexport const getInfoModal = (state, infoModalKey) => common.getByPath(state, ['infoModal', infoModalKey]);\n\nexport const getSelectTime = createCachedSelector(\n    (state) => common.getByPath(state, ['selectTime']),\n    (selectTime) => {\n        return selectTime\n    }\n)((state) => {\n    const key = common.getByPath(state, ['selectTime'])\n    return key;\n})\n\n//round time on minutes to prevent rerender on every second?\nexport const getBeginDataTime = createCachedSelector(\n    getSelectTime,\n    (selectTime) => {\n        const beginDataTime = momentjs(selectTime).subtract(5, 'minutes').toDate().toString();\n        return beginDataTime;\n    }\n)((state) => {\n    const selectTime = new Date(getSelectTime(state));\n    const cacheKey = momentjs(selectTime).subtract(5, 'minutes').toDate().toString();\n    return cacheKey;\n\n})\n\nexport const getPureActiveLayers = createCachedSelector(\n    (state) => common.getByPath(state, ['activeLayers']),\n    (activeLayers) => {\n        return activeLayers\n    }\n)((state) => {\n    const activeLayers = common.getByPath(state, ['activeLayers'])\n    const cacheKey = activeLayers.map(l => `${l.layerKey}${l.satKey}`).join(',');\n    return cacheKey;\n})\n\nexport function getFollowNow (state)  {return common.getByPath(state, ['followNow'])};\n\nexport function getTrackTimeActive (state)  {return common.getByPath(state, ['trackTime'])};\n\nexport function getPeriodLimit (state)  {return common.getByPath(state, ['periodLimit'])};\n\nexport function getLandscape (state)  {return common.getByPath(state, ['landscape'])};\n\nexport function getFocusedSattelite (state)  {return common.getByPath(state, ['focus'])};\n\n//round time on minutes to prevent rerender on every second?\n\nconst getBeginTime = (selectTime, productsTimeWindow) => {\n    return momentjs(selectTime).subtract(productsTimeWindow, 'millisecond').toDate();\n}\n\n\nconst getSatelliteForLayer = (satellitesSubstate, satKey) => {\n    const salellite = satellitesSubstate.find(s => s.id === satKey);\n    return salellite || null;\n}\n\n\nexport const getActiveLayers = createCachedSelector(\n    getPureActiveLayers,\n    getSelectTimePastOrCurrent,\n    getOrbitsSubstate,\n    getSatellitesSubstate,\n    getPlansForDate,\n    getVisibleAcquisitionsPlans,\n    (state, selectTime) => selectTime,\n    getFocusedSattelite,\n    getSearchLayer,\n    (activeLayers, selectTimePastOrCurrent, orbitsSubstate, satellitesSubstate, acquisitionPlans, visibleAcquisitionsPlans, selectTime, focusedSatellite, searchLayer) => {\n\n    const activeLayersWithDates = []\n\n    activeLayers.forEach(l => {\n        const satData = getSatDataByKey(l.satKey);\n        const layer = {...l,\n            type: 'sentinelData',\n            beginTime: getBeginTime(selectTime, getSatelliteForLayer(satellitesSubstate, l.satKey).productsTimeWindow),\n            endTime: selectTime,\n            disabled: selectTimePastOrCurrent || !satellitesUtils.isSatelliteReleaseBeforeDate({satData}, selectTime),\n            satData,\n        }\n        activeLayersWithDates.push(layer);\n    });\n\n    //search layer\n    if(searchLayer) {\n        activeLayersWithDates.push({\n            type: 'sentinelFootprint',\n            results: [searchLayer],\n        });\n    }\n\n    const orbitLayers = orbitsSubstate.filter((o) =>\n        satellitesUtils.filterByReleasedSatellite(o, satellitesSubstate, selectTime)\n        ).filter((o) =>\n            satellitesUtils.filterByActiveSatellite(o, focusedSatellite)\n        ).map(o => ({...o, type: 'orbit'}));    \n\n    const getOrbitForLayer = (orbitKey) => {\n        const orbit = orbitsSubstate.find(o => o.key === orbitKey);\n        return (orbit && orbit.specs) || null;\n    }\n\n    const satellitesLayers = satellitesSubstate.filter((s) => satellitesUtils.isSatelliteReleaseBeforeDate(s, selectTime)).map(s => ({key:s.id, name: s.name, model: s.model, type: 'satellite', satData: s.satData, time: selectTime, tle: getOrbitForLayer(`orbit-${s.id}`)}));\n    let acquisitionPlanLayers = [];\n    \n    //todo filter by visible APS data\n\n    if(selectTimePastOrCurrent) {\n        acquisitionPlanLayers = acquisitionPlans.filter(p => visibleAcquisitionsPlans.includes(p.key)).map(aps => ({key:`acquisitionPlans_${aps.key}`, name: aps.key, type: 'acquisitionPlan', plans: aps.plans, selectTime, satName:aps.key, tle: getOrbitForLayer(`orbit-${aps.key}`), range: getSatelliteForLayer(satellitesSubstate, aps.key).acquisitionPlanTimeWindow}));\n    };\n    activeLayersWithDates.push(...orbitLayers, ...satellitesLayers, ...acquisitionPlanLayers);\n    \n    return activeLayersWithDates;\n})((state, selectTime) => {\n    const stringSelectTime = selectTime ? selectTime.toString() : '';\n    const activeLayers = common.getByPath(state, ['activeLayers']);\n    const orbitSubstate = getOrbitsSubstate(state);\n    const satellitesSubstate = getSatellitesSubstate(state);\n    const endTime = selectTime;\n    const selectTimePastOrCurrent = getSelectTimePastOrCurrent(state);\n    const acquisitionPlans = getPlansForDate(state, selectTime);\n    const visibleAcquisitionsPlans = getVisibleAcquisitionsPlans(state);\n    let acquisitionPlanLayers = '';\n    if(selectTimePastOrCurrent){\n        acquisitionPlanLayers = getPlansKeys(acquisitionPlans.filter(p => visibleAcquisitionsPlans.includes(p.key)));\n    };\n\n    const orbitKeys = orbitSubstate.map(l => l.key).join(',');\n    const satellitesKeys = satellitesSubstate.map(s => s.id).join(',');\n    const activeLayersKeys = activeLayers.map(l => `${l.layerKey}${l.satKey}${getBeginTime(selectTime, getSatelliteForLayer(satellitesSubstate, l.satKey).productsTimeWindow)}${endTime}`).join(',');\n    const cacheKey = `${stringSelectTime}-${satellitesKeys}-${orbitKeys}-${activeLayersKeys}-${acquisitionPlanLayers}`;\n    return cacheKey === '' ? 'nodata' : cacheKey;\n});\n\nexport const getActiveLayerByKey = createCachedSelector(\n    (activeLayers) => activeLayers,\n    (activeLayers, layerKey) => layerKey,\n    (activeLayers, layerKey, satKey) => satKey,\n    (activeLayers, layerKey, satKey) => activeLayers.find(l => l.layerKey === layerKey && l.satKey === satKey))((state, layerKey, satKey) => `${satKey}-${layerKey}`);\n\n\nexport default {\n    getCurrentTime,\n    getFollowNow,\n    getSelectTime,\n    getInfoModal,\n}","import { createSelector } from 'reselect'\nimport common from '../_common';\nimport {getSubstate as getSatellitesSubstate} from '../data/satellites';\nimport {getVisibleAcquisitionsPlans} from '../map';\nimport {getSubstate as getLayersSubstate, getByKey as getLayerByKey} from '../data/layers';\nimport {getPlansForDate, getLoadingAcquisitionsPlans} from '../data/acquisitionPlans';\nimport {getActiveLayers, getActiveLayerByKey, getFocusedSattelite, isLayerDisabled, getSelectTimePastOrCurrent, getSelectTime} from '../rootSelectors';\nimport satellitesUtils from '../../../utils/satellites';\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'satelliteSelect']);\n\nconst getSatelitesSelectOptions = createSelector(\n    getSatellitesSubstate,\n    getLayersSubstate,\n    getActiveLayers,\n    getFocusedSattelite,\n    getSelectTimePastOrCurrent,\n    getVisibleAcquisitionsPlans,\n    getPlansForDate,\n    getLoadingAcquisitionsPlans,\n    getSelectTime,\n    (satellites, layersSubState, activeLayers, focusedSattelite, selectTimePastOrCurrent, visibleAcquisitionsPlans, acquisitionPlansData, loadingAcquisitionsPlans, selectTime) => {\n        \n        const getLayerOption = (layerKey, satConfig) => {\n            const satKey = satConfig.id;\n            const layer = getLayerByKey(layersSubState, layerKey);\n            const activeLayerCfg = getActiveLayerByKey(activeLayers, layerKey, satKey)\n            \n            return {\n                type: 'product',\n                id: layerKey,\n                label: layer.name,\n                // disabled: false,\n                disabled: selectTimePastOrCurrent || !satellitesUtils.isSatelliteReleaseBeforeDate(satConfig, selectTime),\n                satKey: satKey,\n                active: activeLayerCfg ? true : false,\n                status: activeLayerCfg && activeLayerCfg.status,\n                message: activeLayerCfg && activeLayerCfg.message,\n                loadedCount: activeLayerCfg && activeLayerCfg.loadedCount,\n                totalCount: activeLayerCfg && activeLayerCfg.totalCount,\n            }\n        }\n\n        const getSateliteOption = (satConfig) => {\n            // const availableAPS = selectTimePastOrCurrent && acquisitionPlansData.some((p) => p.key === satConfig.id && p.plans.length > 0);\n            const hasAPS = acquisitionPlansData.find((p) => p.key === satConfig.id);\n            const activeAPS = visibleAcquisitionsPlans.includes(satConfig.id);\n            const satOption = {\n                groupData: {\n                    value: satConfig.id,\n                    icon: satConfig.iconClass,\n                    disabled: !satellitesUtils.isSatelliteReleaseBeforeDate(satConfig, selectTime),\n                    active: focusedSattelite === satConfig.id,\n                    loading: loadingAcquisitionsPlans.some(l => l.key === satConfig.id), //todo\n                },\n                label: satConfig.name,\n                options: []\n            }\n\n            //add acquisition plan option if sattelite contains data for it\n            if(hasAPS) {\n                satOption.options.push({\n                    type: 'acquisitionPlan',\n                    id: `acg_${satConfig.id}`,\n                    satKey: satConfig.id,\n                    label: 'Acquisition plan',\n                    disabled: false,\n                    active: activeAPS,\n                    loadedCount: selectTimePastOrCurrent && hasAPS.plans && hasAPS.plans.length > 0 ? hasAPS.visiblePlans || 0 : 0,\n                    totalCount: 0,\n                })\n            }\n\n            if(satConfig.layers && satConfig.layers.length > 0) {\n                satOption.options = [...satOption.options, ...satConfig.layers.map((layerKey) => getLayerOption(layerKey, satConfig))];\n            }\n\n            return satOption;\n        }\n\n        const satOptions = satellites.map(getSateliteOption);\n\n        return satOptions;\n    }\n)\n\nexport {\n    getSatelitesSelectOptions,\n    getSubstate,\n}","import { createSelector } from 'reselect'\nimport moment from 'moment';\n\n\nimport common from '../_common';\nimport {getCurrentTime} from '../rootSelectors';\n\nexport const addItemToIndex = (array, index, item) => [...array.slice(0, index), item, ...array.slice(index)];\nexport const removeItemByIndex = (array, index) => [...array.slice(0, index), ...array.slice(index + 1)];\n\nconst getSubstate = (state) => common.getByPath(state, ['components', 'timeline']);\n\n\nconst getOverlays = (state) => {\n    const nowOverlayKey = 'now';\n\n    const overlays = common.getByPath(state, ['components', 'timeline', 'overlays']);\n    const now = moment(getCurrentTime(state));\n\n    const overlayIndex = overlays.findIndex(o => o.key === nowOverlayKey);\n    const nowOverlay = overlays[overlayIndex];\n    const nowOverlayPlusSecond = {...nowOverlay, start: now.clone(), end: now.clone()};\n    const withoutOverlay = removeItemByIndex(overlays, overlayIndex);\n\tconst updatedOverlays = addItemToIndex(withoutOverlay, overlayIndex, nowOverlayPlusSecond);\n    return updatedOverlays;\n};\n\nexport {\n    getSubstate,\n    getOverlays,\n}","import * as satelliteSelect from './components/satellitesSelect';\nimport * as timeline from './components/timeline';\nimport * as search from './components/search';\nimport * as satellites from './data/satellites';\nimport * as layers from './data/layers';\nimport * as map from './map';\nimport * as rootSelectors from './rootSelectors';\n\nexport default {\n    rootSelectors,\n    data: {\n        satellites,\n        layers,\n    },\n    components: {\n        satelliteSelect,\n        timeline,\n        search,\n    },\n    map,\n}","export const addItemToIndex = (array, index, item) => [...array.slice(0, index), item, ...array.slice(index)];\nexport const removeItemByIndex = (array, index) => [...array.slice(0, index), ...array.slice(index + 1)];\nexport const replaceItemOnIndex = (array, index, item) => [...array.slice(0, index), item, ...array.slice(index + 1)];","export const removeItemByKey = (object, key) => {\n\tconst {[key]: value, ...withoutKey} = object;\n\treturn withoutKey;\n};","import moment from 'moment';\nimport types from './types';\nimport select from './selectors/';\nimport {removeItemByIndex,replaceItemOnIndex, addItemToIndex} from '../utils/arrayManipulation';\nimport {removeItemByKey} from '../utils/objectManipulation';\nimport WorldWindX from 'webworldwind-x';\nimport {merge, cloneDeep} from 'lodash';\n\nconst {\n    EoUtils\n} = WorldWindX;\n\nconst deactivateLayer = (state, action) => {\n    const satKey = action.payload.satKey;\n    const layerKey = action.payload.layerKey;\n    const selectTime = new Date(select.rootSelectors.getSelectTime(state));\n    const activeLayers = select.rootSelectors.getPureActiveLayers(state, selectTime);\n    const activeIndex = activeLayers.findIndex(l => l.satKey === satKey && l.layerKey === layerKey);\n\n    if(activeIndex > -1) {\n        return {\n            ...state,\n            activeLayers: removeItemByIndex(activeLayers, activeIndex)\n        };\n    } else {\n        return state\n    }\n}\n\nconst activateLayer = (state, action) => {\n    const satKey = action.payload.satKey;\n    const layerKey = action.payload.layerKey;\n    const selectTime = new Date(select.rootSelectors.getSelectTime(state));\n    const activeLayers = select.rootSelectors.getPureActiveLayers(state, selectTime);\n    const activeIndex = activeLayers.findIndex(l => l.satKey === satKey && l.layerKey === layerKey);\n\n    if(activeIndex === -1) {\n        return {\n            ...state,\n            activeLayers: [...activeLayers, {satKey, layerKey}]\n        };\n    } else {\n        return state\n    }\n}\n\nconst toggleLayer = (state, action) => {\n    const satKey = action.payload.satKey;\n    const layerKey = action.payload.layerKey;\n    const selectTime = new Date(select.rootSelectors.getSelectTime(state));\n    const activeLayers = select.rootSelectors.getPureActiveLayers(state, selectTime);\n    const activeIndex = activeLayers.findIndex(l => l.satKey === satKey && l.layerKey === layerKey);\n    \n    if(activeIndex > -1) {\n        return deactivateLayer(state, {\n            payload: {\n                satKey,\n                layerKey\n            }\n        })\n    } else {\n        return activateLayer(state, {\n            payload: {\n                satKey,\n                layerKey\n            }\n        })\n    }\n}\n\nconst setPreventReloadLayers = (state, action) => {\n    return {\n        ...state,\n        preventReloadLayers: action.payload\n    };\n}\n\nconst focusSatelite = (state, action) => {\n    return {\n        ...state,\n        focus: action.payload\n    };\n}\n\nconst setSelectTime = (state, action) => {\n    //FIXME - should be dispatched separated to set selectTimePastOrCurrent\n    const currentTime = select.rootSelectors.getCurrentTime(state);\n    const selectTime = action.payload;\n    let followNow = false;\n    if(select.rootSelectors.getFollowNow(state)) {\n        followNow = true;\n    }\n    const selectTimeMoment = moment(selectTime);\n    return {\n        ...state,\n        selectTime: action.payload,\n        selectTimePastOrCurrent: selectTimeMoment.isAfter(currentTime) || followNow,\n    };\n}\n\nconst setCurrentTime = (state, action) => {\n    //FIXME - should be dispatched separated to set selectTimePastOrCurrent and setSelectTime\n    const currentTime = action.payload;\n    let selectTime = select.rootSelectors.getSelectTime(state);\n    //if follow now\n    let selectTimeState = {};\n\n    //not clear solution, because I don't know, how to acces to current state in timer in action\n    let followNow = false;\n    if(select.rootSelectors.getFollowNow(state)) {\n        followNow = true;\n        selectTimeState = setSelectTime(state, {\n            payload: currentTime\n        });\n\n        const focusedSatellite = select.rootSelectors.getFocusedSattelite(state);\n        if(focusedSatellite) {\n            const orbitInfo = state.data.orbits\n                .filter(orbit => {\n                    return orbit.key === 'orbit-' + focusedSatellite\n                })[0];\n            if (state.wwd && orbitInfo) {\n                const satrec = EoUtils.computeSatrec(orbitInfo.specs[0], orbitInfo.specs[1]);\n                const position = EoUtils.getOrbitPosition(satrec, new Date(currentTime));\n                state.wwd.goTo(position);\n            }\n        }\n    }\n    \n    const selectTimeMoment = moment(selectTime);\n\n    return {\n        ...state,\n        ...selectTimeState,\n        currentTime: currentTime,\n        selectTimePastOrCurrent: selectTimeMoment.isAfter(currentTime) || followNow,\n    };\n}\n\nconst setActiveTimeLevel = (state, action) => {\n    return {\n        ...state,\n        activeTimeLevel: action.payload\n    };\n}\n\nconst setFollowNow = (state, action) => {\n    return {\n        ...state,\n        followNow: action.payload\n    };\n}\n\nconst setTrackTime = (state, action) => {\n    return {\n        ...state,\n        trackTime: action.payload\n    };\n}\n\nconst setTimeLineDayWidth = (state, action) => {\n    return {\n        ...state,\n        timeLine: {...state.timeLine, dayWidth: action.payload}\n    };\n}\n\nconst setTimeLineMouseTime = (state, action) => {\n    return {\n        ...state,\n        timeLine: {...state.timeLine, mouseTime: action.payload}\n    };\n}\n\nconst setLandscape = (state, action) => {\n    return {\n        ...state,\n        landscape: action.payload\n    };\n}\n\nconst setOverlays = (state, action) => {\n    return {\n        ...state,\n        timeLine: {...state.timeLine, overlays: action.payload}\n    };\n}\n\nconst setHelper = (state, path, value) => {\n\tlet remainingPath = [...path];\n\tlet currentKey = remainingPath.shift();\n\tif (remainingPath.length) {\n\t\treturn {...state, [currentKey]: setHelper(state[currentKey], remainingPath, value)};\n\t} else {\n\t\treturn {...state, [currentKey]: value};\n\t}\n}\n\nconst updateComponent = (state, action) => {\n\treturn {...state, components: {...state.components, [action.component]: state.components[action.component] ? {...state.components[action.component], ...action.update} : action.update}};\n}\n\nconst setComponent = (state, action) => {\n\tlet path = action.path.split('.');\n\treturn {...state, components: {...state.components, [action.component]: setHelper(state.components[action.component], path, action.value)}};\n}\n\nconst clearComponent = (state, action) => {\n\treturn {...state, components: {...removeItemByKey(state.components, action.component)}};\n}\n\nconst updateModal = (state, modalPath, modal) => {\n    // return {...state, components: {...state.components, [action.component]: setHelper(state.components[action.component], path, action.value)}};\n    return {...setHelper(state, modalPath, modal)};\n}\n\nconst updateInfoModal = (state, action) => {\n    const {modalKey, modalState} = action.payload\n    const infoModalState = select.rootSelectors.getInfoModal(state, modalKey);\n    return updateModal(state, ['infoModal', modalKey], {...infoModalState, ...modalState, modalKey});\n}\n\nconst setActiveInfoModal = (state, action) => {\n    const {modalKey} = action.payload\n    return {...state, infoModal: {...state.infoModal, active: modalKey}};\n}\n\nconst setWwd = (state, action) => {\n    return {...state, wwd: action.payload};\n}\n\nconst updateActiveLayer = (state, action) => {\n    //get layer by key\n    const layerKey = action.payload.layerKey.layerKey;\n    const satKey = action.payload.layerKey.satKey;\n    const change = action.payload.change;\n    const selectTime = new Date(select.rootSelectors.getSelectTime(state));\n    const activeLayers = select.rootSelectors.getPureActiveLayers(state, selectTime);\n    const layerIndex = activeLayers.findIndex(l => l.satKey === satKey && l.layerKey === layerKey);\n\n    if(layerIndex > -1) {\n        const layerInfo = state.activeLayers[layerIndex];\n        delete layerInfo.message;\n        delete layerInfo.status;\n        delete layerInfo.loadedCount;\n        delete layerInfo.totalCount;\n        return {\n            ...state,\n            activeLayers: replaceItemOnIndex(activeLayers, layerIndex, {...layerInfo, ...change})\n        };\n    } else {\n        return state\n    }\n}\n\nconst setOrbits = (state, action) => {\n    const orbits = action.payload.orbits;\n    return {...state, data: {...state.data, orbits}};\n};\n\nconst setAcquisitionPlans = (state, action) => {\n    const aps = action.payload.aps;\n    return {...state, data: {...state.data, acquisitionPlans: aps}};\n};\n\nconst dataUpdateAcquisitionPlan = (state, action) => {\n    const key = action.payload.key;\n    const url = action.payload.url;\n    const update = action.payload.update;\n    const acquisitionPlansKeyIndex = state.data.acquisitionPlans.findIndex((acquisitionPlans) => acquisitionPlans.key === key);\n    const acquisitionPlanUrlIndex = state.data.acquisitionPlans[acquisitionPlansKeyIndex].plans.findIndex((acquisitionPlan) => acquisitionPlan.url === url);\n    \n    const updatedAcquisitionPlan = merge(cloneDeep(state.data.acquisitionPlans[acquisitionPlansKeyIndex].plans[acquisitionPlanUrlIndex]), update);\n    const updatedAcquisitionPlans = replaceItemOnIndex(state.data.acquisitionPlans[acquisitionPlansKeyIndex].plans, acquisitionPlanUrlIndex, updatedAcquisitionPlan);\n    \n    return {...state, data: {...state.data, acquisitionPlans: [...replaceItemOnIndex(state.data.acquisitionPlans, acquisitionPlansKeyIndex, {...state.data.acquisitionPlans[acquisitionPlansKeyIndex],plans: updatedAcquisitionPlans})]}};\n};\n\nconst setVisibleAcquisitionPlan = (state, action) => {\n    const key = action.payload.key;\n    const count = action.payload.count;\n    const acquisitionPlansKeyIndex = state.data.acquisitionPlans.findIndex((acquisitionPlans) => acquisitionPlans.key === key);\n    return {...state, data: {...state.data, acquisitionPlans: [...replaceItemOnIndex(state.data.acquisitionPlans, acquisitionPlansKeyIndex, {...state.data.acquisitionPlans[acquisitionPlansKeyIndex], visiblePlans: count})]}};\n};\n\nconst mapAddVisibleAcquisitionPlan = (state, action) => {\n    const acquisitionPlanKey = action.payload.key;\n    return {...state, map: {...state.map, acquisitionPlans: [...state.map.acquisitionPlans, acquisitionPlanKey]}};\n};\n\nconst mapRemoveVisibleAcquisitionPlan = (state, action) => {\n    const acquisitionPlanKey = action.payload.key;\n    const acquisitionPlanKeyIndex = state.map.acquisitionPlans.indexOf(acquisitionPlanKey);\n    return {...state, map: {...state.map, acquisitionPlans: removeItemByIndex(state.map.acquisitionPlans, acquisitionPlanKeyIndex)}};\n};\n\nexport default (state, action) => {\n    //change state logging\n    console.log(\"beforeState\", state, \"action\", action);\n    \n    switch(action.type) {\n        case types.FOCUS_SATELLITE:\n            return focusSatelite(state, action)\n        case types.TOGGLE_LAYER:\n            return toggleLayer(state, action);\n        case types.PREVENT_RELOAD_LAYERS:\n            return setPreventReloadLayers(state, action);\n        case types.ACTIVATE_LAYER:\n            return activateLayer(state, action);\n        case types.DEACTIVATE_LAYER:\n            return deactivateLayer(state, action);\n        case types.CHANGE_SELECTTIME:\n            return setSelectTime(state, action);\n        case types.CHANGE_CURRENTTIME:\n            return setCurrentTime(state, action);\n        case types.CHANGE_ACTIVE_TIME_LEVEL:\n            return setActiveTimeLevel(state, action);\n        case types.FOLLOW_NOW:\n            return setFollowNow(state, action);\n        case types.TRACK_TIME:\n            return setTrackTime(state, action);\n        case types.CHANGE_TIME_LINE_DAY_WIDTH:\n            return setTimeLineDayWidth(state, action);\n        case types.TIME_LINE_SET_MOUSE_TIME:\n            return setTimeLineMouseTime(state, action);\n        case types.CHANGE_LANDSCAPE:\n            return setLandscape(state, action);\n        case types.SET_OVERLAYS:\n            return setOverlays(state, action);\n        case types.COMPONENT.UPDATE:\n            return updateComponent(state, action);\n        case types.COMPONENT.SET:\n            return setComponent(state, action);\n        case types.COMPONENT.CLEAR:\n            return clearComponent(state, action);\n        case types.UPDATE_ACTIVE_LAYER:\n            return updateActiveLayer(state, action);\n        case types.UPDATE_INFO_MODAL:\n            return updateInfoModal(state, action);\n        case types.SET_ACTIVE_INFO_MODAL:\n            return setActiveInfoModal(state, action);\n        case types.SET_ORBITS:\n            return setOrbits(state, action);\n        case types.SET_ACQUISITION_PLANS:\n            return setAcquisitionPlans(state, action);\n        case types.DATA_UPDATE_ACQUISITIONPLANS:\n            return dataUpdateAcquisitionPlan(state, action);\n        case types.DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT:\n            return setVisibleAcquisitionPlan(state, action);\n        case types.SET_WWD:\n            return setWwd(state, action);\n        case types.MAP_ADD_VISIBLE_ACQUISITION_PLAN:\n            return mapAddVisibleAcquisitionPlan(state, action);\n        case types.MAP_REMOVE_VISIBLE_ACQUISITION_PLAN:\n            return mapRemoveVisibleAcquisitionPlan(state, action);\n        default:\n            return state;\n    }\n}","export const convertToUTC = (date) => {\n    if(typeof date === 'string') {\n        date = new Date(date);\n    }\n    if(date) {\n        return new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n    } else {\n        return null;\n    }\n}\n\nexport const getNowUTC = () => {\n    var now = new Date();\n    return convertToUTC(now);\n}\n\nexport const getNowUTCString = () => {\n    return new Date().toUTCString();\n}","import moment from 'moment';\nimport _ from 'lodash';\n\nconst parse = string => {\n\tif (string.match(/\\/P/)) {\n\t\t// start date & duration\n\t\tthrow new Error('Durations not implemented');\n\t}\n\tif (string.match(/\\//)) {\n\t\t// start & end date\n\t\tlet dates = string.split('/');\n\t\treturn {\n\t\t\tstart: parseOne(dates[0]).start,\n\t\t\tend: parseOne(dates[1]).end,\n\t\t\tsource: string,\n\t\t\ttype: 'interval'\n\t\t};\n\t}\n\t// anything else\n\treturn parseOne(string);\n\n};\n\nconst parseOne = string => {\n\tif (string.match(/^[0-9]{4}$/)) {\n\t\t// year\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('year'),\n\t\t\tsource: string,\n\t\t\ttype: 'year'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}$/)) {\n\t\t// month\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('month'),\n\t\t\tsource: string,\n\t\t\ttype: 'month'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/)) {\n\t\t// day\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('day'),\n\t\t\tsource: string,\n\t\t\ttype: 'day'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}$/)) {\n\t\t// hour\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('hour'),\n\t\t\tsource: string,\n\t\t\ttype: 'hour'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}$/)) {\n\t\t// minute\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('minute'),\n\t\t\tsource: string,\n\t\t\ttype: 'minute'\n\t\t};\n\t}\n\tif (\n\t\tstring.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}$/)\n\t\t|| string.match(/^[0-9]{4}[0-9]{2}[0-9]{2}T[0-9]{2}[0-9]{2}[0-9]{2}$/)\n\t) {\n\t\t// second\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('second'),\n\t\t\tsource: string,\n\t\t\ttype: 'second'\n\t\t};\n\t}\n\tif (string.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}/)) {\n\t\t// full datetime incl. timezone\n\t\treturn {\n\t\t\tstart: moment(string),\n\t\t\tend: moment(string).endOf('second'),\n\t\t\tsource: string,\n\t\t\ttype: 'full'\n\t\t};\n\t}\n};\n\nexport default parse;\n\nexport const toString = period => {\n\tif (!(_.isObject(period) && period.start && period.end && period.type)) throw new Error('Invalid period supplied to period.toString');\n\tswitch (period.type) {\n\t\tcase 'interval':\n\t\t\treturn period.start.format('YYYY-MM-DD h:mm:ss') + ' - ' + period.end.format('YYYY-MM-DD h:mm:ss');\n\t\tcase 'second':\n\t\tcase 'full':\n\t\t\treturn period.start.format('YYYY-MM-DD h:mm:ss');\n\t\tcase 'minute':\n\t\t\treturn period.start.format('YYYY-MM-DD h:mm');\n\t\tcase 'hour':\n\t\t\treturn period.start.format('YYYY-MM-DD h') + 'h';\n\t\tdefault:\n\t\t\treturn period.source;\n\t}\n};\n\nexport const isInside = (period, time) => {\n\treturn period.start.isBefore(time) && period.end.isAfter(time);\n}\n\nexport const getInside = (period, time) => {\n\tif(time.isBefore(period.start)) {\n\t\treturn period.start;\n\t} else if(time.isAfter(period.end)) {\n\t\treturn period.end;\n\t} else {\n\t\treturn time;\n\t}\n}","import React, {createContext} from 'react'\r\nimport reducer from './reducer';\r\nimport {getNowUTCString} from '../utils/date'\r\nimport moment from 'moment';\r\nimport period from '../utils/period';\r\nimport {getSatDataByKey, getDefaultSatOrbitBySatKey} from './satData';\r\n\r\nconst now = moment(getNowUTCString());\r\n\r\nconst periodLimit = period('2010/2025');\r\nconst stringPeriodLimit = {\r\n    start: periodLimit.start.toDate().toString(),\r\n    end: periodLimit.end.toDate().toString(),\r\n}\r\n\r\nexport const Context = createContext({\r\n    periodLimit: null,\r\n    satellites: [],\r\n    activeLayers: [],\r\n    focus: null,\r\n    selectTime: null,\r\n    currentTime: null,\r\n    followNow: null,\r\n    preventReloadLayers: null,\r\n    selectTimePastOrCurrent: null,\r\n    components:{},\r\n    infoModal: {},\r\n});\r\n\r\nconst initialState = {\r\n    data: {\r\n        layers: {\r\n            //sentinel 1\r\n            'SLC': {\r\n                key: 'SLC',\r\n                name: 'SLC',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'GRD': {\r\n                key: 'GRD',\r\n                name: 'GRD',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'OCN': {\r\n                key: 'OCN',\r\n                name: 'OCN',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            //sentinel 2\r\n            'S2MSI1C': {\r\n                key: 'S2MSI1C',\r\n                name: 'S2MSI1C',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'S2MSI2A': {\r\n                key: 'S2MSI2A',\r\n                name: 'S2MSI2A',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'S2MSI2Ap': {\r\n                key: 'S2MSI2Ap',\r\n                name: 'S2MSI2Ap',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            //sentinel 3\r\n            'OL_1_EFR': {\r\n                key: 'OL_1_EFR',\r\n                name: 'OL_1_EFR',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'OL_1_ERR': {\r\n                key: 'OL_1_ERR',\r\n                name: 'OL_1_ERR',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'OL_2_LFR': {\r\n                key: 'OL_2_LFR',\r\n                name: 'OL_2_LFR',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'OL_2_LRR': {\r\n                key: 'OL_2_LRR',\r\n                name: 'OL_2_LRR',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_1_SRA': {\r\n                key: 'SR_1_SRA',\r\n                name: 'SR_1_SRA',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_1_SRA_A': {\r\n                key: 'SR_1_SRA_A',\r\n                name: 'SR_1_SRA_A',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_1_SRA_BS': {\r\n                key: 'SR_1_SRA_BS',\r\n                name: 'SR_1_SRA_BS',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_2_LAN': {\r\n                key: 'SR_2_LAN',\r\n                name: 'SR_2_LAN',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SR_1_RBT': {\r\n                key: 'SR_1_RBT',\r\n                name: 'SR_1_RBT',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SL_2_LST': {\r\n                key: 'SL_2_LST',\r\n                name: 'SL_2_LST',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SY_2_SYN': {\r\n                key: 'SY_2_SYN',\r\n                name: 'SY_2_SYN',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SY_2_V10': {\r\n                key: 'SY_2_V10',\r\n                name: 'SY_2_V10',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SY_2_VG1': {\r\n                key: 'SY_2_VG1',\r\n                name: 'SY_2_VG1',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n            'SY_2_VGP': {\r\n                key: 'SY_2_VGP',\r\n                name: 'SY_2_VGP',\r\n                description: 'Level-1 Single Look Complex (SLC) products consist of focused SAR data geo-referenced using orbit and attitude data from the satellite and provided in zero-Doppler slant-range geometry. The products include a single look in each dimension using the full transmit signal bandwidth and consist of complex samples preserving the phase information.'\r\n            },\r\n        },\r\n        satellites: [\r\n            {id: 's1a', name: 'S1-A', model: 'S1', iconClass: 'sentinel-1', satData: getSatDataByKey('s1a'), layers:['SLC', 'GRD', 'OCN'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's1b', name: 'S1-B', model: 'S1', iconClass: 'sentinel-1', satData: getSatDataByKey('s1b'), layers:['SLC', 'GRD', 'OCN'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's2a', name: 'S2-A', model: 'S2', iconClass: 'sentinel-2', satData: getSatDataByKey('s2a'), layers:['S2MSI1C','S2MSI2A','S2MSI2Ap'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's2b', name: 'S2-B', model: 'S2', iconClass: 'sentinel-2', satData: getSatDataByKey('s2b'), layers:['S2MSI1C','S2MSI2A','S2MSI2Ap'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's3a', name: 'S3-A', model: 'S3', iconClass: 'sentinel-3', satData: getSatDataByKey('s3a'), layers:['OL_1_EFR','OL_1_ERR','OL_2_LFR','OL_2_LRR','SR_1_SRA','SR_1_SRA_A','SR_1_SRA_BS','SR_2_LAN','SR_1_RBT','SL_2_LST','SY_2_SYN','SY_2_V10','SY_2_VG1','SY_2_VGP'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's3b', name: 'S3-B', model: 'S3', iconClass: 'sentinel-3', satData: getSatDataByKey('s3b'), layers:['OL_1_EFR','OL_1_ERR','OL_2_LFR','OL_2_LRR','SR_1_SRA','SR_1_SRA_A','SR_1_SRA_BS','SR_2_LAN','SR_1_RBT','SL_2_LST','SY_2_SYN','SY_2_V10','SY_2_VG1','SY_2_VGP'], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000},\r\n            {id: 's5p', name: 'S-5', model: 'S5', iconClass: 'sentinel-5', satData: getSatDataByKey('s5p'), layers:[], acquisitionPlanTimeWindow: 1200000, productsTimeWindow: 300000}\r\n        ], // All the available satellites.\r\n        orbits: [\r\n            getDefaultSatOrbitBySatKey('s1a'),\r\n            getDefaultSatOrbitBySatKey('s1b'),\r\n            getDefaultSatOrbitBySatKey('s2a'),\r\n            getDefaultSatOrbitBySatKey('s2b'),\r\n            getDefaultSatOrbitBySatKey('s3a'),\r\n            getDefaultSatOrbitBySatKey('s3b'),\r\n            getDefaultSatOrbitBySatKey('s5p'),\r\n        ],\r\n        acquisitionPlans: [],\r\n    },\r\n    map: {\r\n        acquisitionPlans: []\r\n    },\r\n    periodLimit: stringPeriodLimit,\r\n    activeLayers: [],\r\n    focus: null, // Fix camera on sattelite\r\n    selectTime: null,\r\n    currentTime: getNowUTCString(),\r\n    landscape: true,\r\n    infoModal: {},\r\n    followNow: true,\r\n    trackTime: false,\r\n    preventReloadLayers: false,\r\n    selectTimePastOrCurrent: false,\r\n    components:{\r\n        satelliteSelect: {\r\n            open: true,\r\n        },\r\n        timeline: {\r\n            moving: false,\r\n            mouseTime: null,\r\n            dayWidth: null,\r\n            activeTimeLevel: 'month',\r\n            overlays: [\r\n                {\r\n                    key: 'now',\r\n                    start: now.clone(),\r\n                    end: now.clone(),\r\n                    backdroundColor: 'rgba(77, 77, 239, 0.7)',\r\n                    label: 'Mission',\r\n                    classes: 'overlay1',\r\n                    height: 70,\r\n                    top: 0,\r\n                },\r\n            ]\r\n        },\r\n        search: {\r\n            satellites: ['s1a', 's1b', 's2a', 's2b', 's3a', 's3b', '5p'],\r\n            geometry: null,\r\n            type: null, //types by active satellite? SLC/GRD/OCN\r\n            activeResultIndex: null,\r\n            results: []    \r\n        }\r\n    }\r\n};\r\n\r\nexport const ContextProvider = (props) => {\r\n    const [state, dispatch] =  React.useReducer(reducer, initialState);\r\n    const value = {state, dispatch};\r\n\r\n    return <Context.Provider value={value}>{props.children}</Context.Provider>;\r\n}","const getUrl = (dateString) => `https://eoapps.solenix.ch/tle-server/${dateString}/resource.txt`\n\n//cache tle in Map\nconst cache = new Map();\n\nconst SENTINELTLENAMES = ['SENTINEL-1A', 'SENTINEL-1B', 'SENTINEL-2A', 'SENTINEL-2B', 'SENTINEL-3A', 'SENTINEL-3B', 'SENTINEL-5P']\nconst SENTINELTLEKEYSPAIRS = [['SENTINEL-1A', 's1a'], ['SENTINEL-1B', 's1b'], ['SENTINEL-2A', 's2a'], ['SENTINEL-2B', 's2b'], ['SENTINEL-3A', 's3a'], ['SENTINEL-3B', 's3b'], ['SENTINEL-5P', 's5p']]\n\nconst parseSatellitesData = (text) => {\n    const lines = text.split('\\r\\n');\n    const satellites = [];\n    lines.forEach((line, index) => {\n            //satellite name is on every thirth line;\n            const isSatNameLine = index % 3 === 0;\n            if(isSatNameLine) {\n                satellites.push({\n                    name: line.trim(),\n                    line1: lines[index + 1],\n                    line2: lines[index + 2]\n                });\n            }\n    });\n    return satellites;\n}\n\nconst transformTleFormat = (tle) => {\n    const satKey = SENTINELTLEKEYSPAIRS.find((s => s[0] === tle.name))[1];\n    return {\n        key: `orbit-${satKey}`,\n        specs: [\n            tle.line1,\n            tle.line2,\n        ]\n    }\n}\n\n/**\n * @param {string} dateString - Date string in format YYYY-MM-DD like \"2019-06-07\"\n */\nexport const getTle = async (dateString) => {\n    \n    let tle = null;\n    if(cache.has(dateString)) {\n        tle = cache.get(dateString);\n        //check if tle is Promise\n        if(tle && typeof tle.then == 'function') {\n            tle = await tle;\n            return tle;\n        } else {\n            return tle;\n        }\n    } else {\n        const request = fetch(getUrl(dateString)).then(response => response.text()).then(text => parseSatellitesData(text).filter(t => SENTINELTLENAMES.includes(t.name)).map(transformTleFormat));\n        cache.set(dateString, request);\n        const orbits = await request;\n        \n        return orbits;\n    }\n}\n\n","import types from './types';\nimport moment from 'moment';\nimport select from './selectors/';\nimport {getInside} from '../utils/period';\nimport {getNowUTCString} from '../utils/date';\nimport {getTle} from '../utils/tle';\nimport {getAllAcquisitionPlans} from '../utils/acquisitionPlans';\nimport satellitesUtils from '../utils/satellites';\nimport WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nconst {\n    EoUtils\n} = WordWindX;\n\nconst {\n    Position\n} = WorldWind;\n\n\nlet timer = null;\nlet nowTimer = null;\nlet intervalKeyZoom = null;\nlet intervalKeyScroll = null;\n/**\n * \n * @param {string} satelliteId \n * @param {Object} state \n */\nexport const toggleSatelliteFocus = (satelliteId, state) => {\n    const focusedSattelite = select.rootSelectors.getFocusedSattelite(state);\n    const satteliteIsFocused = focusedSattelite === satelliteId;\n\n    const orbitInfo = state.data.orbits\n        .filter(orbit => {return orbit.key === 'orbit-' + satelliteId})[0];\n\n    state.wwd.worldWindowController._isFixed = !satteliteIsFocused;\n    state.wwd.navigator.camera._isFixed = !satteliteIsFocused;\n    if(state.wwd && orbitInfo && !satteliteIsFocused) {\n        const satrec = EoUtils.computeSatrec(orbitInfo.specs[0], orbitInfo.specs[1]);\n        const position = EoUtils.getOrbitPosition(satrec, new Date(state.selectTime));\n        // The range needs to be changed gradually to tha altitude of the satellite.\n        // This one needs to properly clean to the satellite.\n\n        state.wwd.navigator.range = 2 * position.altitude;\n        state.wwd.navigator.lookAtLocation.latitude = position.latitude;\n        state.wwd.navigator.lookAtLocation.longitude = position.longitude;\n        state.wwd.navigator.lookAtLocation.altitude = position.altitude;\n        state.wwd.redraw();\n    }\n\n    if (satteliteIsFocused) {\n        const currentPosition = state.wwd.navigator.lookAtLocation;\n        // Simply clean heading, roll and tilt to 0 gradually. The range should change to twice the current.\n        // No position change necessary.\n        state.wwd.navigator.range = 2 * currentPosition.altitude;\n        state.wwd.navigator.lookAtLocation.latitude = currentPosition.latitude;\n        state.wwd.navigator.lookAtLocation.longitude = currentPosition.longitude;\n        state.wwd.navigator.lookAtLocation.altitude = currentPosition.altitude;\n        state.wwd.navigator.heading = 0;\n        state.wwd.navigator.tilt = 0;\n        state.wwd.navigator.roll = 0;\n        state.wwd.redraw();\n\n        return {\n            type: types.FOCUS_SATELLITE,\n            payload: null\n        };\n    } else {\n        return {\n            type: types.FOCUS_SATELLITE,\n            payload: satelliteId\n        };\n    }\n};\n\nexport const setWwd = (wwd) => {\n    return {\n        type: types.SET_WWD,\n        payload: wwd\n    }\n};\n\n/**\n * \n * @param {string} satelliteKey \n * @param {string} layerKey \n */\nexport const toggleLayer = (satelliteKey, layerKey) => {\n    return {\n        type: types.TOGGLE_LAYER,\n        payload: {\n            type: 'product',\n            satKey: satelliteKey,\n            layerKey: layerKey,\n        }\n    }\n};\n\n/**\n * \n * @param {string} modalKey \n * @param {string} content \n */\nexport const updateInfoModal = (modalKey, modalState) => {\n    return {\n        type: types.UPDATE_INFO_MODAL,\n        payload: {\n            modalKey,\n            modalState,\n        }\n    }\n};\n\n/**\n * \n * @param {string} modalKey \n */\nexport const setActiveInfoModal = (modalKey) => {\n    return {\n        type: types.SET_ACTIVE_INFO_MODAL,\n        payload: {\n            modalKey,\n        }\n    }\n};\n\n/**\n * \n * @param {string} satelliteKey \n * @param {string} layerKey \n */\nexport const setPreventReloadLayers = (preventReloadLayers) => {\n    return {\n        type: types.PREVENT_RELOAD_LAYERS,\n        payload: preventReloadLayers\n    }\n};\n\nexport const zoomToTimeLevel = (dispatch, level, levelDayWidth, currentDayWidth) => {\n    window.clearInterval(intervalKeyZoom);\n    //zoom to dayWidth\n    const steps = 16;\n    const finalDayWidth = levelDayWidth - 0.1;\n    const dayWidthDiff =  finalDayWidth - currentDayWidth;\n    const peace = dayWidthDiff / steps;\n    let index = 0;\n\n    intervalKeyZoom = window.setInterval(() => {\n        index++;\n        if(index > steps) {\n            index = 0;\n            window.clearInterval(intervalKeyZoom);\n        } else {\n            dispatch(updateComponent('timeline', {dayWidth: currentDayWidth + (peace * index)}))\n        }\n    }, 60)\n};\n\nexport const scrollToTime = (state, dispatch, selectTime, newTime, period, callback) => {\n    window.clearInterval(intervalKeyScroll);\n    const steps = 12;\n    let timeInPeriod = newTime;\n    if(period) {\n        timeInPeriod = moment(getInside(period, moment(newTime)));\n    }\n    const diff = timeInPeriod.diff(moment(selectTime));\n    const peace = diff / steps;\n    let index = 0;\n    intervalKeyScroll = window.setInterval(() => {\n        index++;\n        if(index > steps) {\n            index = 0;\n            window.clearInterval(intervalKeyScroll);\n            if(typeof callback === 'function') {\n                callback();\n            }\n        } else {\n            const newSelectedTime = moment(selectTime).add(peace * index).toDate().toUTCString();\n            const selectedTime = moment(selectTime).add(peace * (index - 1)).toDate().toUTCString();\n            // If the focus is there, move the navigator with the satellite.\n\n            dispatch(changeSelectTime(newSelectedTime, dispatch, selectedTime, state));\n        }\n    }, 60)\n};\n\n/**\n * \n * @param {string} time New time\n * @param {function} dispatch\n * @param {string} selectTime */\nexport const changeSelectTime = (time, dispatch, selectTime, state) => {\n    const selectTimeMoment = moment(selectTime);\n    const selectYearDay = `${selectTimeMoment.year()}-${selectTimeMoment.dayOfYear()}`\n    const momentTime = moment(time);\n    const timeYearDay = `${momentTime.year()}-${momentTime.dayOfYear()}`\n    const newTimeIsSameDay = selectYearDay === timeYearDay;\n\n    //Check if new time is in another day. If so, reload orbits\n    // future TLE are not available at the moment\n    if(!newTimeIsSameDay) {\n        updateTleData(dispatch, time);\n    }\n\n\n    const focusedSattelite = select.rootSelectors.getFocusedSattelite(state);\n\n    if(focusedSattelite) {\n        const satellite = select.data.satellites.getSatelliteByKey(state, focusedSattelite);\n        const isReleased = satellitesUtils.isSatelliteReleaseBeforeDate(satellite, selectTime)\n\n        if(isReleased && state.wwd.worldWindowController._isFixed) {\n            const orbitInfo = state.data.orbits\n            .filter(orbit => {return orbit.key === 'orbit-' + focusedSattelite})[0];\n            const satrec = EoUtils.computeSatrec(orbitInfo.specs[0], orbitInfo.specs[1]);\n            const position = EoUtils.getOrbitPosition(satrec, new Date(time));\n            // The range needs to be changed gradually to tha altitude of the satellite.\n            // This one needs to properly clean to the satellite.\n            // state.wwd.navigator.range = 2 * position.altitude;\n            \n            state.wwd.navigator.lookAtLocation.latitude = position.latitude;\n            state.wwd.navigator.lookAtLocation.longitude = position.longitude;\n            state.wwd.navigator.lookAtLocation.altitude = position.altitude;\n            state.wwd.redraw();\n        } else if(!isReleased && state.wwd.worldWindowController._isFixed){\n            //release focused satellite if selected date is before satellite release\n            dispatch(toggleSatelliteFocus(focusedSattelite, state));\n        }\n    }\n\n    return {\n        type: types.CHANGE_SELECTTIME,\n        payload: time\n    }\n}\n\n/**\n * \n * @param {string} time \n */\nexport const changeCurrentTime = time => {\n    return {\n        type: types.CHANGE_CURRENTTIME,\n        payload: time\n    }\n}\n\n/**\n * \n * @param {bool} followNow \n */\nexport const setFollowNow = followNow => {\n    return {\n        type: types.FOLLOW_NOW,\n        payload: followNow\n      };\n}\n\n/**\n * \n * @param {bool} trackTime \n */\nexport const setTrackTime = trackTime => {\n    return {\n        type: types.TRACK_TIME,\n        payload: trackTime\n      };\n}\n\nexport const updateComponent = (component, data) => {\n\treturn {\n\t\ttype: types.COMPONENT.UPDATE,\n\t\tcomponent: component,\n\t\tupdate: data\n\t}\n}\n\nexport const setComponent = (component, path, value) => {\n\treturn {\n\t\ttype: types.COMPONENT.SET,\n\t\tcomponent,\n\t\tpath,\n\t\tvalue\n\t}\n}\nexport const clearComponent = (component) => {\n\treturn {\n\t\ttype: types.COMPONENT.CLEAR,\n\t\tcomponent,\n\t}\n}\n\nexport const startTrackNowTime = (state, dispatch) => {\n    window.clearInterval(nowTimer);\n    nowTimer = window.setInterval(() => dispatch(nowTick()), 1000);\n    dispatch(nowTick())\n}\n\nconst nowTick = () => {\n    const now = getNowUTCString();\n    return changeCurrentTime(now.toString());\n};\n\nexport const stopTimer = () => {\n    return setTrackTime(false);\n}\n\nexport const startTimer = (state, dispatch) => {\n    return setTrackTime(true);\n}\n\nexport const stopFollowNow = () => {\n    return setFollowNow(false);\n}\n\n/**\n * \n * @param {bool} landscape \n */\nexport const setOrientation = (landscape) => {\n    return {\n        type: types.CHANGE_LANDSCAPE,\n        payload: landscape\n    }\n}\n\n/**\n * \n * @param {string} layerKey \n * @param {object} change \n */\nexport const updateActiveLayer = (layerKey, change) => {\n    return {\n        type: types.UPDATE_ACTIVE_LAYER,\n        payload: {\n            layerKey,\n            change\n        }\n    }\n}\n\n/**\n * @param {Array.<Object>} - orbits\n */\nexport const setOrbits = (orbits) => {\n    return {\n        type: types.SET_ORBITS,\n        payload: {\n            orbits\n        }\n    }\n}\n\n/**\n * \n */\nexport const updateTleData = (dispatch, selectTime) => {\n    const selectTimeMoment = moment(selectTime);\n    const nowTimeMoment = moment();\n    if(selectTimeMoment.isBefore(nowTimeMoment)) {\n        getTle(selectTimeMoment.format('YYYY-MM-DD')).then((data) => {\n            if(data && data.length > 0) {\n                return dispatch(setOrbits(data));\n            }\n        });\n    }\n}\n\n\n/**\n * @param {Array.<Object>} - orbits\n */\nexport const setAcquisitionPlans = (aps) => {\n    return {\n        type: types.SET_ACQUISITION_PLANS,\n        payload: {\n            aps\n        }\n    }\n}\n\n/**\n * \n */\nexport const updateApsData = async (dispatch) => {\n    const aps = await getAllAcquisitionPlans()\n    dispatch(setAcquisitionPlans(aps));\n}\n\n/**\n * \n */\nexport const mapAddVisibleAcquisitionPlanKey = (acquisitionPlanKey) => {\n    return {\n        type: types.MAP_ADD_VISIBLE_ACQUISITION_PLAN,\n        payload: {\n            key: acquisitionPlanKey\n        }\n    }\n}\n\n/**\n * \n */\nexport const mapRemoveVisibleAcquisitionPlanKey = (acquisitionPlanKey) => {\n    return {\n        type: types.MAP_REMOVE_VISIBLE_ACQUISITION_PLAN,\n        payload: {\n            key: acquisitionPlanKey\n        }\n    }\n}\n\n/**\n * \n */\nexport const dataUpdateAcquisitionPlan = (layerKey, satName, url, update) => {\n    return {\n        type: types.DATA_UPDATE_ACQUISITIONPLANS,\n        payload: {\n            key: satName,\n            url,\n            update,\n        }\n    }\n}\n\nexport const dataAcquisitionPlanSetVisibleCount = (satName, count) => {\n    return {\n        type: types.DATA_ACQUISITIONPLANS_SET_VISIBLE_COUNT,\n        payload: {\n            key: satName,\n            count,\n        }\n    }\n}\n\n/**\n * \n */\nexport const toggleAcquisitionPlan = (state, acquisitionPlanKey) => {\n    const acquisitionPlanVisible = select.map.isVisibleAcquisitionPlanByKey(state, acquisitionPlanKey);\n    const action = acquisitionPlanVisible ? types.MAP_REMOVE_VISIBLE_ACQUISITION_PLAN : types.MAP_ADD_VISIBLE_ACQUISITION_PLAN;\n    return {\n        type: action,\n        payload: {\n            key: acquisitionPlanKey\n        }\n    }\n}\n\n\nexport const searchProducts = (satelliteId, layerId) => {\n    \n}\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M16,18.692c-0.192,0-0.361-0.073-0.509-0.221L5.17,8.149C5.022,8.003,4.948,7.833,4.948,7.641\n\tc0-0.191,0.074-0.362,0.222-0.509l1.107-1.107c0.148-0.147,0.316-0.222,0.509-0.222s0.362,0.074,0.51,0.222L16,14.729l8.704-8.704\n\tc0.147-0.147,0.317-0.222,0.51-0.222c0.191,0,0.361,0.074,0.509,0.222l1.107,1.107c0.147,0.146,0.222,0.317,0.222,0.509\n\tc0,0.192-0.074,0.362-0.222,0.509L16.51,18.472C16.361,18.619,16.192,18.692,16,18.692z M16,27.197\n\tc-0.192,0-0.361-0.073-0.509-0.222L5.17,16.654c-0.147-0.146-0.222-0.316-0.222-0.509c0-0.191,0.074-0.362,0.222-0.51l1.107-1.107\n\tc0.148-0.146,0.316-0.221,0.509-0.221s0.362,0.074,0.51,0.221L16,23.233l8.704-8.705c0.147-0.146,0.317-0.221,0.51-0.221\n\tc0.191,0,0.361,0.074,0.509,0.221l1.107,1.107c0.147,0.147,0.222,0.318,0.222,0.51c0,0.192-0.074,0.362-0.222,0.509L16.51,26.976\n\tC16.361,27.124,16.192,27.197,16,27.197z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M13.308,16c0-0.192,0.073-0.361,0.221-0.509L23.851,5.17c0.146-0.147,0.316-0.222,0.509-0.222\n\tc0.191,0,0.362,0.074,0.509,0.222l1.107,1.107c0.147,0.148,0.222,0.316,0.222,0.509s-0.074,0.362-0.222,0.51L17.271,16l8.704,8.704\n\tc0.147,0.147,0.222,0.317,0.222,0.51c0,0.191-0.074,0.361-0.222,0.509l-1.107,1.107c-0.146,0.147-0.317,0.222-0.509,0.222\n\tc-0.192,0-0.362-0.074-0.509-0.222L13.528,16.51C13.381,16.361,13.308,16.192,13.308,16z M4.803,16c0-0.192,0.073-0.361,0.222-0.509\n\tL15.346,5.17c0.146-0.147,0.316-0.222,0.509-0.222c0.191,0,0.362,0.074,0.51,0.222l1.107,1.107c0.146,0.148,0.221,0.316,0.221,0.509\n\ts-0.074,0.362-0.221,0.51L8.767,16l8.705,8.704c0.146,0.147,0.221,0.317,0.221,0.51c0,0.191-0.074,0.361-0.221,0.509l-1.107,1.107\n\tc-0.147,0.147-0.318,0.222-0.51,0.222c-0.192,0-0.362-0.074-0.509-0.222L5.024,16.51C4.876,16.361,4.803,16.192,4.803,16z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M18.692,16c0,0.192-0.073,0.361-0.221,0.509L8.15,26.83c-0.147,0.147-0.317,0.222-0.509,0.222\n\tc-0.191,0-0.362-0.074-0.509-0.222l-1.107-1.107c-0.147-0.148-0.222-0.316-0.222-0.509s0.074-0.362,0.222-0.51L14.729,16\n\tL6.024,7.296C5.877,7.148,5.803,6.979,5.803,6.787s0.074-0.362,0.222-0.509L7.132,5.17C7.279,5.022,7.45,4.948,7.641,4.948\n\tc0.192,0,0.362,0.074,0.509,0.222l10.322,10.32C18.619,15.639,18.692,15.808,18.692,16z M27.197,16c0,0.192-0.073,0.361-0.222,0.509\n\tL16.654,26.83c-0.146,0.147-0.316,0.222-0.509,0.222c-0.191,0-0.362-0.074-0.51-0.222l-1.107-1.107\n\tc-0.147-0.148-0.221-0.316-0.221-0.509s0.074-0.362,0.221-0.51L23.233,16l-8.705-8.704c-0.147-0.147-0.221-0.317-0.221-0.509\n\ts0.074-0.362,0.221-0.509l1.107-1.107c0.147-0.148,0.318-0.222,0.51-0.222c0.192,0,0.362,0.074,0.509,0.222l10.321,10.32\n\tC27.124,15.639,27.197,15.808,27.197,16z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M16,13.308c0.192,0,0.361,0.073,0.509,0.221L26.83,23.851c0.147,0.146,0.222,0.316,0.222,0.509\n\tc0,0.191-0.074,0.362-0.222,0.509l-1.107,1.107c-0.148,0.147-0.316,0.222-0.509,0.222s-0.362-0.074-0.51-0.222L16,17.271\n\tl-8.704,8.704c-0.147,0.147-0.317,0.222-0.509,0.222s-0.362-0.074-0.509-0.222L5.17,24.868c-0.148-0.146-0.222-0.317-0.222-0.509\n\tc0-0.192,0.074-0.362,0.222-0.509l10.32-10.322C15.639,13.381,15.808,13.308,16,13.308z M16,4.803c0.192,0,0.361,0.073,0.509,0.222\n\tL26.83,15.346c0.147,0.146,0.222,0.316,0.222,0.509c0,0.191-0.074,0.362-0.222,0.51l-1.107,1.107\n\tc-0.148,0.146-0.316,0.221-0.509,0.221s-0.362-0.074-0.51-0.221L16,8.767l-8.704,8.705c-0.147,0.146-0.317,0.221-0.509,0.221\n\ts-0.362-0.074-0.509-0.221L5.17,16.364c-0.148-0.147-0.222-0.318-0.222-0.51c0-0.192,0.074-0.362,0.222-0.509l10.32-10.321\n\tC15.639,4.876,15.808,4.803,16,4.803z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<rect className=\"line\" x=\"5.578\" y=\"15\" width=\"21.125\" height=\"2\"/>\n\t\t<polygon className=\"line\" points=\"12.977,25.095 3.882,16 12.977,6.905 14.391,8.319 6.71,16 14.391,23.681\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 26,16 A 10,10 0 0 1 16,26 10,10 0 0 1 6,16 10,10 0 0 1 16,6 10,10 0 0 1 26,16 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 21.292969,3.2929688 8.5859375,16 21.292969,28.707031 22.707031,27.292969 11.414062,16 22.707031,4.7070312 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 10,3.2929688 8.5859375,4.7070312 19.878906,16 8.5859375,27.292969 10,28.707031 22.707031,16 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"polygon\" d=\"M8 8 l0 18 l16 0 l0 -18\" strokeWidth=\"2\" stroke=\"black\" strokeLinejoin=\"round\" fill=\"transparent\"/>\n\t\t<path className=\"line\" d=\"M5 8 l22 0\" strokeWidth=\"2\" stroke=\"black\" strokeLinecap=\"round\"/>\n\t\t<path className=\"line\" d=\"M14 12 l0 10\" strokeWidth=\"2\" stroke=\"black\" strokeLinecap=\"round\"/>\n\t\t<path className=\"line\" d=\"M18 12 l0 10\" strokeWidth=\"2\" stroke=\"black\" strokeLinecap=\"round\"/>\n\t\t<path className=\"polygon\" d=\"M10 8 l3 -4 l6 0 l3 4\" strokeWidth=\"2\" stroke=\"black\" strokeLinejoin=\"round\" fill=\"transparent\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<circle className=\"line\" cx=\"16\" cy=\"8\" r=\"2.4\"/>\n\t\t<circle className=\"line\" cx=\"16\" cy=\"16\" r=\"2.4\"/>\n\t\t<circle className=\"line\" cx=\"16\" cy=\"24\" r=\"2.4\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M5 27 l22 0\" strokeWidth=\"2\" stroke=\"black\"/>\n\t\t<path className=\"line\" d=\"M16 5 l0 18\" strokeWidth=\"2\" stroke=\"black\"/>\n\t\t<path className=\"line\" d=\"M9 16 l8 8\" strokeWidth=\"2\" stroke=\"black\"/>\n\t\t<path className=\"line\" d=\"M23 16 l-8 8\" strokeWidth=\"2\" stroke=\"black\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M5.382,26.619l1.641-5.399l0.059-0.059l15.781-15.78l3.757,3.758L10.78,24.977L5.382,26.619z M7.597,21.562\n\t\tl-1.242,4.083l4.082-1.242L25.703,9.139l-2.841-2.842L7.597,21.562z\"/>\n\t\t<rect className=\"line\" x=\"6.628\" y=\"22.713\" transform=\"matrix(-0.7071 -0.7071 0.7071 -0.7071 -0.9941 45.6625)\" width=\"4.664\" height=\"0.649\"/>\n\t\t<polygon className=\"line\" points=\"7.99,25.49 5.968,26.031 6.509,24.009\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g transform=\"scale(0.015,-0.015) translate(300,-1636)\">\n\t\t<path className=\"line\"\n\t\t\t   d=\"M755 480q0 -13 -10 -23l-332 -332l144 -144q19 -19 19 -45t-19 -45t-45 -19h-448q-26 0 -45 19t-19 45v448q0 26 19 45t45 19t45 -19l144 -144l332 332q10 10 23 10t23 -10l114 -114q10 -10 10 -23zM1536 1344v-448q0 -26 -19 -45t-45 -19t-45 19l-144 144l-332 -332\nq-10 -10 -23 -10t-23 10l-114 114q-10 10 -10 23t10 23l332 332l-144 144q-19 19 -19 45t19 45t45 19h448q26 0 45 -19t19 -45z\" />\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M26,12.832c0,0.174-0.066,0.327-0.2,0.461l-9.339,9.337c-0.134,0.134-0.287,0.201-0.461,0.201s-0.327-0.067-0.461-0.201\n\tL6.2,13.293C6.066,13.159,6,13.006,6,12.832s0.066-0.327,0.2-0.461l1.002-1.002c0.134-0.134,0.287-0.2,0.461-0.2\n\ts0.327,0.066,0.461,0.2L16,19.243l7.876-7.874c0.134-0.134,0.287-0.2,0.461-0.2s0.327,0.066,0.461,0.2l1.002,1.002\n\tC25.934,12.505,26,12.658,26,12.832z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 5,4 H 28 L 18.535874,15 18.453432,25 13,27 V 15 L 4,4 h 1\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M20.653,25.472h-1.695V13.243c0-0.423-0.343-0.766-0.766-0.766h-3.207h-1.179h-2.46c-0.423,0-0.766,0.343-0.766,0.766v0.563\n\tc0,0.424,0.343,0.766,0.766,0.766h1.694v10.899h-1.695c-0.423,0-0.766,0.343-0.766,0.766v0.563c0,0.424,0.343,0.766,0.766,0.766\n\th2.456c0.002,0,0.003,0.001,0.005,0.001h4.386c0.002,0,0.003-0.001,0.005-0.001h2.456c0.423,0,0.766-0.342,0.766-0.766v-0.563\n\tC21.419,25.814,21.076,25.472,20.653,25.472z\"/>\n\t\t<circle className=\"line\" cx=\"16\" cy=\"7.583\" r=\"3.151\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path d=\"M5 5 l0 17 l5 0 l0 -12 l12 0 l0 -5\" strokeWidth=\"2\" className=\"polygonFilled\"/>\n\t\t<path d=\"M10 22 l0 5 l17 0 l0 -17 l-5 0 l0 12 l-12 0\" strokeWidth=\"2\" className=\"polygon\"/>\n\t\t<path d=\"M10 10 L22 22\" strokeWidth=\"2\" className=\"line\"/>\n\t\t<path d=\"M16 10 L22 16\" strokeWidth=\"2\" className=\"line\"/>\n\t\t<path d=\"M10 16 L16 22\" strokeWidth=\"2\" className=\"line\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 16,2.8828125 1.7636719,10 3.5527344,10.894531 16,17.117188 30.236328,10 Z M 16,5.1171875 25.763672,10 16,14.882812 6.2363281,10 Z\"/>\n\t\t<path className=\"line\" d=\"M 9.5527344,12.105469 1.7636719,16 16,23.117188 30.236328,16 22.447266,12.105469 21.552734,13.894531 25.763672,16 16,20.882812 6.2363281,16 10.447266,13.894531 Z\"/>\n\t\t<path className=\"line\" d=\"M 9.5527344,18.105469 1.7636719,22 16,29.117188 30.236328,22 22.447266,18.105469 21.552734,19.894531 25.763672,22 16,26.882812 6.2363281,22 10.447266,19.894531 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 10,25 A 3.5,3.5 0 0 1 6.5,28.5 3.5,3.5 0 0 1 3,25 3.5,3.5 0 0 1 6.5,21.5 3.5,3.5 0 0 1 10,25 Z\"/>\n\t\t<path className=\"line\" d=\"m 4,12.5 h 5 c 0.554,0 1,0.446 1,1 v 5 c 0,0.554 -0.446,1 -1,1 H 4 c -0.554,0 -1,-0.446 -1,-1 v -5 c 0,-0.554 0.446,-1 1,-1 z\"/>\n\t\t<path className=\"line\" d=\"M 6.5488281,4.0214844 C 6.3688189,4.0168495 6.200219,4.1093556 6.1074219,4.2636719 l -3,4.9785156 C 2.9071078,9.5751818 3.1465554,9.9994087 3.5351562,10 h 6 C 9.9237571,9.9994087 10.163205,9.5751818 9.9628906,9.2421875 l -3,-4.9785156 C 6.8751262,4.1176904 6.7190891,4.0264234 6.5488281,4.0214844 Z M 8.6503906,9 V 9 H 4.4199219 Z\"/>\n\t\t<path className=\"line\" d=\"m 14.080078,6 a 1.0001,1.0001 0 1 0 0,2 h 13.853516 a 1.0001,1.0001 0 1 0 0,-2 z\"/>\n\t\t<path className=\"line\" d=\"m 14.080078,15 a 1.0001,1.0001 0 1 0 0,2 h 13.853516 a 1.0001,1.0001 0 1 0 0,-2 z\"/>\n\t\t<path className=\"line\" d=\"m 14.080078,24 a 1.0001,1.0001 0 1 0 0,2 h 13.853516 a 1.0001,1.0001 0 1 0 0,-2 z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"m 19.703125,14.544922 -3.705078,5.810547 -3.697266,-5.78125 -4.2128904,2.693359 7.9140624,12.376953 7.916016,-12.410156 z M 16,2.5 c -5.217094,0 -9.5,4.2829065 -9.5,9.5 0,5.217094 4.282906,9.5 9.5,9.5 5.217094,0 9.5,-4.282906 9.5,-9.5 0,-5.2170935 -4.282906,-9.5 -9.5,-9.5 z m 0,5 c 2.514893,0 4.5,1.985107 4.5,4.5 0,2.514893 -1.985107,4.5 -4.5,4.5 -2.514893,0 -4.5,-1.985107 -4.5,-4.5 0,-2.514893 1.985107,-4.5 4.5,-4.5 z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<rect className=\"line\" x=\"4\" y=\"15.2\" width=\"24\" height=\"1.6\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M27.088,17.484c0,0.423-0.343,0.766-0.766,0.766H5.677c-0.423,0-0.766-0.343-0.766-0.766v-2.969\n\tc0-0.423,0.343-0.766,0.766-0.766h20.646c0.423,0,0.766,0.343,0.766,0.766V17.484z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M16.983,3.272l7.351,22.055c0.139,0.398,0.055,0.75-0.252,1.057c-0.037,0.038-0.104,0.089-0.193,0.148\n\tc-0.209,0.13-0.431,0.182-0.667,0.149c-0.237-0.029-0.44-0.131-0.609-0.298l-6.617-6.616l-6.617,6.616\n\tc-0.168,0.167-0.371,0.269-0.609,0.298c-0.237,0.032-0.459-0.02-0.666-0.149c-0.207-0.13-0.352-0.306-0.437-0.528\n\tc-0.084-0.222-0.087-0.446-0.011-0.677l7.352-22.055c0.045-0.153,0.131-0.292,0.253-0.414c0.207-0.206,0.452-0.306,0.735-0.298\n\tc0.223-0.008,0.425,0.054,0.609,0.184C16.788,2.874,16.915,3.05,16.983,3.272z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<rect className=\"line\" x=\"15.2\" y=\"4\" width=\"1.6\" height=\"24\"/>\n\t\t<rect className=\"line\" x=\"4\" y=\"15.2\" width=\"24\" height=\"1.6\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M27.088,17.484c0,0.423-0.343,0.766-0.766,0.766H5.677c-0.423,0-0.766-0.343-0.766-0.766v-2.969\n\tc0-0.423,0.343-0.766,0.766-0.766h20.646c0.423,0,0.766,0.343,0.766,0.766V17.484z\"/>\n\t\t<path className=\"line\" d=\"M17.484,4.912c0.423,0,0.766,0.343,0.766,0.766v20.646c0,0.423-0.343,0.766-0.766,0.766h-2.969\n\tc-0.423,0-0.766-0.343-0.766-0.766V5.677c0-0.423,0.343-0.766,0.766-0.766H17.484z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g transform=\"scale(0.016,-0.016) translate(450,-1636)\">\n\t\t<path className=\"line\"\n\t\t\t   d=\"M480 672v448q0 14 -9 23t-23 9t-23 -9t-9 -23v-448q0 -14 9 -23t23 -9t23 9t9 23zM1152 320q0 -26 -19 -45t-45 -19h-429l-51 -483q-2 -12 -10.5 -20.5t-20.5 -8.5h-1q-27 0 -32 27l-76 485h-404q-26 0 -45 19t-19 45q0 123 78.5 221.5t177.5 98.5v512q-52 0 -90 38\nt-38 90t38 90t90 38h640q52 0 90 -38t38 -90t-38 -90t-90 -38v-512q99 0 177.5 -98.5t78.5 -221.5z\" />\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"polygon\" d=\"M11 11 L11 5 L27 5 L27 21 L21 21\" strokeWidth=\"3\"/>\n\t\t<rect className=\"polygon\" x=\"5\" y=\"11\" width=\"16\" height=\"16\" strokeWidth=\"3\"/>\n\t\t<rect className=\"line\" x=\"5\" y=\"11\" width=\"16\" height=\"4\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M27,16c0,1.489-0.292,2.913-0.874,4.269c-0.581,1.354-1.366,2.526-2.349,3.509s-2.154,1.768-3.509,2.349\n\tC18.913,26.708,17.489,27,16,27c-1.642,0-3.204-0.346-4.684-1.038c-1.48-0.693-2.741-1.669-3.781-2.93\n\tc-0.067-0.095-0.098-0.202-0.093-0.322s0.045-0.216,0.122-0.293l1.962-1.977c0.096-0.086,0.215-0.129,0.358-0.129\n\tc0.152,0.02,0.263,0.077,0.329,0.172c0.697,0.907,1.552,1.609,2.564,2.105c1.012,0.495,2.086,0.744,3.223,0.744\n\tc0.994,0,1.94-0.193,2.843-0.58s1.684-0.909,2.342-1.568c0.659-0.658,1.182-1.439,1.568-2.342s0.58-1.849,0.58-2.843\n\tc0-0.993-0.193-1.941-0.58-2.843s-0.909-1.683-1.568-2.342c-0.658-0.659-1.439-1.182-2.342-1.568S16.994,8.667,16,8.667\n\tc-0.936,0-1.833,0.17-2.693,0.509s-1.623,0.823-2.292,1.454l1.962,1.977c0.296,0.287,0.363,0.616,0.2,0.988\n\tc-0.162,0.382-0.444,0.573-0.845,0.573H5.917c-0.248,0-0.463-0.091-0.645-0.272C5.091,13.713,5,13.499,5,13.25V6.833\n\tc0-0.401,0.191-0.683,0.573-0.845c0.373-0.163,0.702-0.095,0.988,0.201l1.862,1.848c1.021-0.965,2.189-1.712,3.502-2.242\n\tC13.238,5.265,14.596,5,16,5c1.489,0,2.913,0.292,4.269,0.874c1.354,0.583,2.526,1.366,3.509,2.349s1.768,2.153,2.349,3.509\n\tC26.708,13.087,27,14.51,27,16z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M5.874,11.732c0.581-1.356,1.366-2.526,2.349-3.509s2.154-1.767,3.509-2.349C13.087,5.292,14.511,5,16,5\n\tc1.403,0,2.762,0.265,4.074,0.795c1.313,0.53,2.48,1.277,3.502,2.242l1.862-1.848c0.286-0.296,0.616-0.363,0.988-0.201\n\tC26.809,6.151,27,6.432,27,6.833v6.417c0,0.249-0.091,0.463-0.272,0.645s-0.396,0.272-0.645,0.272h-6.417\n\tc-0.4,0-0.683-0.191-0.845-0.573c-0.162-0.373-0.096-0.702,0.2-0.988l1.963-1.977c-0.669-0.63-1.433-1.115-2.292-1.454\n\tS16.936,8.667,16,8.667c-0.994,0-1.94,0.193-2.843,0.58s-1.684,0.91-2.342,1.568c-0.659,0.659-1.182,1.439-1.568,2.342\n\ts-0.58,1.85-0.58,2.843c0,0.994,0.193,1.94,0.58,2.843s0.909,1.684,1.568,2.342c0.658,0.659,1.439,1.182,2.342,1.568\n\ts1.849,0.58,2.843,0.58c1.136,0,2.21-0.249,3.223-0.744c1.012-0.496,1.866-1.198,2.563-2.105c0.066-0.095,0.177-0.152,0.329-0.172\n\tc0.144,0,0.263,0.043,0.358,0.129l1.962,1.977c0.077,0.077,0.117,0.173,0.122,0.293s-0.026,0.228-0.093,0.322\n\tc-1.041,1.261-2.302,2.236-3.781,2.93C19.203,26.654,17.642,27,16,27c-1.489,0-2.913-0.292-4.269-0.874\n\tc-1.354-0.581-2.526-1.366-3.509-2.349s-1.768-2.154-2.349-3.509C5.292,18.913,5,17.489,5,16C5,14.51,5.292,13.087,5.874,11.732z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 13,3 C 7.4889972,3 3,7.4889972 3,13 3,18.511003 7.4889972,23 13,23 18.511003,23 23,18.511003 23,13 23,7.4889972 18.511003,3 13,3 Z m 0,2 c 4.430123,0 8,3.5698773 8,8 0,4.430123 -3.569877,8 -8,8 C 8.5698773,21 5,17.430123 5,13 5,8.5698773 8.5698773,5 13,5 Z\"/>\n\t\t<path className=\"line\" d=\"m 20.707031,19.292969 -1.414062,1.414062 9,9 1.414062,-1.414062 z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<circle className=\"line\" cx=\"6.998\" cy=\"16\" r=\"3.15\"/>\n\t\t<circle className=\"line\" cx=\"24.005\" cy=\"8.513\" r=\"3.149\"/>\n\t\t<circle className=\"line\" cx=\"24.005\" cy=\"23.484\" r=\"3.149\"/>\n\t\t<path className=\"line\" d=\"M19.623,10.034c-0.003-0.005-0.002-0.012-0.004-0.018c-0.003-0.005-0.008-0.009-0.012-0.014\n\tc-0.042-0.082-0.111-0.149-0.206-0.184l0,0l-0.264-0.096L16.36,8.711c-0.199-0.072-0.418,0.03-0.492,0.229l-0.095,0.265\n\tc-0.073,0.2,0.029,0.418,0.229,0.49l1.724,0.627l-6.156,2.87c-0.192,0.089-0.275,0.317-0.185,0.509l0.119,0.255\n\tc0.09,0.192,0.317,0.275,0.509,0.185l6.155-2.87l-0.627,1.722c-0.072,0.199,0.029,0.418,0.229,0.491l0.264,0.096\n\tc0.199,0.072,0.418-0.03,0.492-0.229l1.01-2.778l0.097-0.263V10.31C19.665,10.216,19.658,10.119,19.623,10.034z\"/>\n\t\t<path className=\"line\" d=\"M19.623,21.83c-0.003,0.006-0.002,0.013-0.004,0.018c-0.003,0.006-0.008,0.01-0.012,0.015\n\tc-0.042,0.081-0.111,0.149-0.206,0.185l0,0l-0.264,0.096l-2.777,1.012c-0.199,0.071-0.418-0.031-0.492-0.229l-0.095-0.265\n\tc-0.073-0.199,0.029-0.418,0.229-0.49l1.724-0.627l-6.156-2.871c-0.192-0.089-0.275-0.316-0.185-0.508l0.119-0.256\n\tc0.09-0.191,0.317-0.274,0.509-0.185l6.155,2.87l-0.627-1.723c-0.072-0.199,0.029-0.418,0.229-0.49l0.264-0.097\n\tc0.199-0.071,0.418,0.03,0.492,0.229l1.01,2.777l0.097,0.264l0,0C19.665,21.648,19.658,21.746,19.623,21.83z\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n<g transform=\"matrix(0.05117622,0,0,0.05117622,2.9443694,-1.5263058)\">\n\t<path className=\"line\" d=\"m 224.595,201.822 h -93.576 c -6.879,0 -13.674,3.236 -15.211,7.307 l -24.902,66.025 c -2.188,5.797 2.867,10.61 11.34,10.61 h 115.271 c 8.477,0 15.584,-4.813 15.873,-10.611 l 3.295,-66.024 c 0.203,-4.072 -5.211,-7.307 -12.09,-7.307 z\"/>\n\t<path className=\"line\" d=\"m 379.204,201.821 -93.574,0.001 c -6.879,0 -12.293,3.236 -12.092,7.307 l 3.293,66.024 c 0.291,5.798 7.4,10.611 15.873,10.611 h 115.275 c 8.473,0 13.525,-4.813 11.338,-10.611 l -24.902,-66.024 c -1.536,-4.072 -8.334,-7.308 -15.211,-7.308 z\"/>\n\t<path className=\"line\" d=\"M 419.61,319.696 H 295.565 c -9.117,0 -16.227,5.703 -15.865,12.927 l 6.236,125.035 c 0.586,11.742 10.93,21.594 23.078,21.594 h 165.289 c 12.148,0 18.283,-9.852 13.855,-21.594 L 440.994,332.623 c -2.722,-7.225 -12.267,-12.927 -21.384,-12.927 z\"/>\n\t<path className=\"line\" d=\"m 214.657,319.696 -124.043,10e-4 c -9.121,0 -18.662,5.702 -21.387,12.926 L 22.065,457.657 c -4.428,11.742 1.703,21.594 13.855,21.594 h 165.285 c 12.152,0 22.492,-9.852 23.076,-21.594 l 6.24,-125.035 c 0.363,-7.223 -6.745,-12.926 -15.864,-12.926 z\"/>\n</g>\n);\n","import React from 'react';\n\nexport default props => (\n<g transform=\"matrix(0.05016772,0,0,0.05016772,3.2140793,3.141888)\">\n\t<path className=\"line\" d=\"M 210.81,37.038 H 55.599 c -11.047,0 -20,8.954 -20,20 v 155.211 c 0,11.046 8.953,20 20,20 H 210.81 c 11.045,0 20,-8.954 20,-20 V 57.038 c 0,-11.046 -8.956,-20 -20,-20 z\"/>\n\t<path className=\"line\" d=\"m 454.127,37.038 h -155.21 c -11.047,0 -20,8.954 -20,20 v 155.211 c 0,11.046 8.953,20 20,20 h 155.211 c 11.045,0 20,-8.954 20,-20 V 57.038 c -10e-4,-11.046 -8.956,-20 -20.001,-20 z\"/>\n\t<path className=\"line\" d=\"m 454.127,280.369 h -155.21 c -11.047,0 -20,8.954 -20,20 V 455.58 c 0,11.046 8.953,20 20,20 h 155.211 c 11.045,0 20,-8.954 20,-20 V 300.369 c -10e-4,-11.046 -8.956,-20 -20.001,-20 z\"/>\n\t<path className=\"line\" d=\"M 210.81,280.369 H 55.599 c -11.047,0 -20,8.954 -20,20 V 455.58 c 0,11.046 8.953,20 20,20 H 210.81 c 11.045,0 20,-8.954 20,-20 V 300.369 c 0,-11.046 -8.956,-20 -20,-20 z\"/>\n</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M 7.7070312,6.2929688 6.2929688,7.7070312 24.292969,25.707031 25.707031,24.292969 Z\"/>\n\t\t<path className=\"line\" d=\"M 24.292969,6.2929688 6.2929688,24.292969 7.7070312,25.707031 25.707031,7.7070312 Z\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<polygon className=\"line\" points=\"23.313,10.729 16.001,23.396 8.688,10.729\"/>\n\t</g>\n);\n","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path className=\"line\" d=\"M4 27 l24 0\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M4 28 l0 -6\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M28 28 l0 -6\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M16 5 l0 18\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M16 5 l7 7\" strokeWidth=\"2\"/>\n\t\t<path className=\"line\" d=\"M16 5 l-7 7\" strokeWidth=\"2\"/>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n\n<g transform=\"matrix(.8602 0 0 .86486 -.4301 -.43243)\" fill=\"none\" fillRule=\"evenodd\">\n    <g fill=\"none\" fillRule=\"evenodd\" >\n      <g transform=\"translate(1 1)\" strokeWidth=\"2\">\n        <circle strokeOpacity=\".5\" cx=\"18\" cy=\"18\" r=\"18\" />\n        <path d=\"M 36,18 C 36,8.06 27.94,0 18,0\">\n          <animateTransform\n            attributeName=\"transform\"\n            type=\"rotate\"\n            from=\"0 18 18\"\n            to=\"360 18 18\"\n            dur=\"1s\"\n            repeatCount=\"indefinite\"\n          />\n        </path>\n      </g>\n    </g>\n</g>\n\n);","import React from 'react';\n\nexport default props => (\n    <g>\n        <g transform=\"matrix(.029895 0 0 .029895 1.0698 1.0507)\">\n            <path className=\"line\" d=\"m500 10c-270.2 0-490 219.8-490 490s219.8 490 490 490 490-219.8 490-490-219.8-490-490-490zm0 896.3c-224 0-406.3-182.3-406.3-406.3s182.3-406.3 406.3-406.3 406.3 182.3 406.3 406.3-182.3 406.3-406.3 406.3z\"/>\n        </g>\n        <g transform=\"matrix(.58975 0 0 1.0043 -4.8033 -.3654)\">\n            <rect className=\"polygon\" x=\"9.322\" y=\"14.812\" width=\"13.449\" height=\"2.3305\"/>\n        <circle className=\"polygon\" transform=\"scale(1,-1)\" cx=\"22.732\" cy=\"-15.977\" r=\"1.1622\"/>\n        <circle className=\"polygon\" cx=\"9.3099\" cy=\"15.978\" r=\"1.1653\"/>\n        </g>\n        <g transform=\"matrix(0 .58975 -1.0043 0 32.365 17.909)\">\n            <rect className=\"polygon\" x=\"9.322\" y=\"14.812\" width=\"13.449\" height=\"2.3305\"/>\n        <circle className=\"polygon\" transform=\"scale(1,-1)\" cx=\"22.732\" cy=\"-15.977\" r=\"1.1622\"/>\n        <circle className=\"polygon\" cx=\"9.3099\" cy=\"15.978\" r=\"1.1653\"/>\n        </g>\n        <g transform=\"matrix(.58975 0 0 1.0043 17.909 -.33431)\">\n            <rect className=\"polygon\" x=\"9.322\" y=\"14.812\" width=\"13.449\" height=\"2.3305\"/>\n        <circle className=\"polygon\" transform=\"scale(1,-1)\" cx=\"22.732\" cy=\"-15.977\" r=\"1.1622\"/>\n        <circle className=\"polygon\" cx=\"9.3099\" cy=\"15.978\" r=\"1.1653\"/>\n        </g>\n        <g transform=\"matrix(0 .58975 -1.0043 0 32.148 -4.8033)\">\n            <rect className=\"polygon\" x=\"9.322\" y=\"14.812\" width=\"13.449\" height=\"2.3305\"/>\n        <circle className=\"polygon\" transform=\"scale(1,-1)\" cx=\"22.732\" cy=\"-15.977\" r=\"1.1622\"/>\n        <circle className=\"polygon\" cx=\"9.3099\" cy=\"15.978\" r=\"1.1653\"/>\n        </g>\n    </g>\n);","import React from 'react';\n\nexport default props => (\n\t<g>\n\t\t<path d=\"m1.6121 28h28.775c1.037 0 1.4028-0.6125 1.512-0.87611 0.10439-0.25136 0.2684-0.89265-0.3531-1.5882l-13.894-22.385-0.0644-0.10438-0.0868-0.0869c-0.80267-0.80207-2.2002-0.80158-3.0018 0l-0.0869 0.0869-13.958 22.489c-0.6221 0.69554-0.45808 1.3368-0.35418 1.5882 0.10918 0.26321 0.47452 0.8762 1.512 0.8762zm14.388-23.472 13.246 21.341-26.492-4.9e-4z\" strokeWidth=\".097921\"/>\n\t\t<text x=\"12.918264\" y=\"22.888712\" fontFamily=\"Sans\" fontSize=\"15.667px\" letterSpacing=\"0px\" strokeWidth=\".097921px\" wordSpacing=\"0px\" style={{fontFeatureSettings:'normal',fontVariantCaps:'normal',fontVariantLigatures:'normal',fontVariantNumeric:'normal',lineHeight:'125%'}} >\n\t\t\t<tspan x=\"12.918264\" y=\"22.888712\" strokeWidth=\".097921px\">!</tspan>\n\t\t</text>\n\t</g>\n);","import React from 'react';\n\nexport default props => (\n  <g transform=\"matrix(0.03061224,0,0,0.03061224,0.69387695,0.69387695)\">\n    <path className={'polygon'} d=\"M 500,10 C 229.8,10 10,229.8 10,500 10,770.2 229.8,990 500,990 770.2,990 990,770.2 990,500 990,229.8 770.2,10 500,10 Z m 0,896.3 C 276,906.3 93.7,724 93.7,500 93.7,276 276,93.7 500,93.7 724,93.7 906.3,276 906.3,500 906.3,724 724,906.3 500,906.3 Z M 325.3,500 c -19.4,0 -35.1,15.6 -35.1,35 0,19.4 15.7,35 35.1,35 h 210 c 19.4,0 35,-15.6 35,-35 V 255.1 c 0,-19.4 -15.6,-35.1 -35,-35.1 -19.4,0 -35,15.7 -35,35.1 V 500 Z\"/>\n  </g>\n)","import React from 'react';\n\nexport default props => (\n  <g transform=\"matrix(.017982 0 0 .017982 -3.9362 -5.3783)\">\n  <path d=\"m956.9 981.1-47-100.6 177.1-82.7 47 100.6z\" />\n  <path d=\"m1124.1 1373.3-41.1-88.2 203.2-94.8 41.1 88.2z\" />\n  <path d=\"m862.1 1633.8-55-77.5 882.5-411.5 55 77.5z\" />\n  <path d=\"m218.9 1372.3 597.7-286.2 144.3 55.7-49.6 147.4-597.7 286.1z\" />\n  <path d=\"m1998.5 785.5-589.8 270.2-144.3-55.6 49.6-147.4 589.8-270.2z\" />\n  <path d=\"m1067.1 1249.4-104.1-228.3l203.2-94.8 104 228.3z\" />\n </g>\n\n);","import React from 'react';\n\nexport default props => (\n  <path d=\"m13.366 8.252 14.345-7.752 3.7891 7.5504-13.011 9.9884zm-2.1152 18.86-0.019375-0.83894-1.6443 1.0405-7.7729-6.7224-1.2572-6.1776 8.7244 6.7688-0.062-1.2639-8.7194-6.9812 6.4564-3.4129l8.5345 5.8099 0.14793 1.6479-4.5853 2.9173 0.09591 1.6233 5.9585 4.3854 0.13805-1.2966-5.5024-4.0204 4.5878-3.0534 5.384 3.0398-0.7347 6.1259-4.3979 4.3745-1.6344-0.97243-1.6048 1.3946-2.8129-2.4487-0.10598-1.4463 0.92196-0.42228z\" strokeWidth=\".025913\"/>\n\n);","import React from 'react';\n\nexport default props => (\n  <path d=\"m17.393 11.325-1.5709-2.6164-0.78004 3.7866 2.2744-0.69643zm8.5956 2.7215 1.0152 1.1523 0.29741-0.35795-1.2396-1.4195zm3.7083-1.3341 1.5958 1.4658-0.63046 2.7928-3.5587 1.1328-1.4302-1.6297-1.1293 0.09494-3.2594-3.7474-1.3341 0.25827-2.3332-0.98851-2.709 0.82818-12.388 9.1726-2.2281-3.0582 15.636-10.845 1.8933 3.1365 2.2941 0.99026 0.70176-0.093 0.03197-3.4019 3.8579 4.3477 0.03391-0.55568-3.792-4.255 4.3548-0.60024 4.4243 3.9914z\" strokeWidth=\".017811\"/>\n\n);","import React from 'react';\n\nexport default props => (\n  <path d=\"m13.577 14.433 0.28406-0.19542-0.41097-5.1072-4.8695 3.4975zm8.1212 7.4342 3.9225 1.2753 4.7547 5.8123-5.8406 2.7218-4.7063-5.3248-0.15714-0.12495-0.23576-2.9172-3.9648 2.5264-0.40292-0.52778-1.8656 1.2108-3.2315-3.4552 0.10679-0.0787 1.0557-2.8367-0.54191-0.71113 1.4767-3.9709 0.957-0.65478-5.0125-1.8112-6.2576-7.279 5.6089-5.0447 6.5356 8.0144 0.08676 0.074235 0.41106 5.1052 3.9608-2.7117 2.7218 3.439c-0.78572 0.3506-1.3317 1.0738-1.3317 1.924 0 1.2028 1.0939 2.1497 2.4056 2.1497 0.1652 0 0.32833-0.0161 0.48548-0.04471l0.0098 2.603zm-1.7246 1.1 0.25383 3.157 4.6902-2.6957-3.8038-1.1906zm2.3511-8.3187c1.1907 0 2.1275 0.85423 2.1275 1.8737s-0.93679 1.8737-2.1275 1.8737c-1.1927 0-2.1295-0.85423-2.1295-1.8737s0.93679-1.8737 2.1295-1.8737z\" strokeWidth=\".020147\"/>\n\n);","import React from 'react';\n\nexport default props => (\n  <path d=\"m12.933 12.306c-0.01259 0.19792 0.07653 0.36386 0.23831 0.48728-2.1363 0.15742-2.6129-0.46384-2.7895-0.98309-0.30428-0.9022 1.0384-2.4852 3.3874-3.3087 2.3491-0.82354 4.4046-0.47876 4.7089 0.42344 0.16595 0.49358 0 1.3767-1.5214 2.4576-0.02519-0.56178-0.87875-0.82993-1.9512-0.59791-1.1108 0.23831-2.0384 0.91915-2.0725 1.5213zm3.496 3.3173 2.1044 0.42557-0.91712 0.69789zm6.1196 1.2341 1.2533 7.1239-4.0386 3.4918-2.1427-10.182 1.5873-1.1086zm-11.918-1.5129-0.64054 0.61496-0.021312-0.46384zm1.2277-0.23192-0.03584-0.06975-0.42131-1.6618c0.56168 0.14473 1.1362 0.183 1.5256 0.18726 1.815-0.07653 3.3322-0.67028 4.5471-1.7831 0.31068-0.25323 0.71494-0.60857 1.0512-1.032l1.0299 0.10637 0.20421 0.67667-4.9833 3.696h-0.14464l2.398 2.2236 2.1831 10.165-6.0195-0.95112-3.1598-9.7581zm-0.80426-0.38721-10.554 2.4044 0.33402-4.7174 8.9092-1.5554c-0.13194 0.37665-0.15539 0.76182-0.053281 1.1469 0.1426 0.53194 0.52991 0.88515 1.0023 1.1192zm7.1345-10.662 5.9686 0.92981-4.5855 5.2302-0.64897-0.08041c0.22126-0.43613 0.3256-0.91915 0.19152-1.4192-0.31494-1.1702-1.8958-1.4958-3.6832-1.2447zm3.0875 7.075 10.224 1.6235-5.8429 4.1237-9.6263-1.9895z\" strokeWidth=\".021278\"/>\n);","import React from 'react';\n\nimport AngleDoubleDown from \"./components/AngleDoubleDown\";\nimport AngleDoubleLeft from \"./components/AngleDoubleLeft\";\nimport AngleDoubleRight from \"./components/AngleDoubleRight\";\nimport AngleDoubleUp from \"./components/AngleDoubleUp\";\nimport ArrowLeft from './components/ArrowLeft';\nimport Circle from './components/Circle';\nimport ChevronLeft from './components/ChevronLeft';\nimport ChevronRight from './components/ChevronRight';\nimport Delete from './components/Delete';\nimport Dots from './components/Dots';\nimport getAngleRight from './components/angle-right-solid';\nimport getAngleLeft from './components/angle-left-solid';\nimport getAngleUp from './components/angle-up-solid';\nimport getAngleDown from './components/angle-down-solid';\nimport Download from './components/Download';\nimport Edit from './components/Edit';\nimport Expand from './components/Expand';\nimport ExpandRow from './components/ExpandRow';\nimport Filter from './components/Filter';\nimport Info from \"./components/Info\";\nimport Opacity from './components/Opacity';\nimport Layers from './components/Layers';\nimport Legend from './components/Legend';\nimport MapPin from './components/MapPin';\nimport Minus from './components/Minus';\nimport MinusThick from './components/MinusThick';\nimport NorthArrow from './components/NorthArrow';\nimport Plus from './components/Plus';\nimport PlusThick from './components/PlusThick';\nimport Pushpin from './components/Pushpin';\nimport Restore from './components/Restore';\nimport RotateLeft from \"./components/RotateLeft\";\nimport RotateRight from \"./components/RotateRight\";\nimport Search from './components/Search';\nimport Share from \"./components/Share\";\nimport getSortDown from './components/sort-down-solid';\nimport getSortUp from './components/sort-up-solid';\nimport TiltMore from './components/TiltMore';\nimport TiltLess from './components/TiltLess';\nimport Times from './components/Times';\nimport TriangleDown from \"./components/TriangleDown\";\nimport getTimes from './components/times-solid';\nimport Upload from './components/Upload';\nimport RotateLeftCircularArrow from './components/RotateLeftCircularArrow';\nimport RotateRightCircularArrow from './components/RotateRightCircularArrow';\nimport LoaderOval from './components/Loader-oval';\nimport Location from './components/Location';\nimport Warning from './components/Warning';\nimport Clock from './components/Clock';\n\nimport Sentinel1 from './components/satellites/Sentinel1';\nimport Sentinel2 from './components/satellites/Sentinel2';\nimport Sentinel3 from './components/satellites/Sentinel3';\nimport Sentinel4 from './components/satellites/Sentinel4';\nimport Sentinel5 from './components/satellites/Sentinel5';\n\nimport './icon.css';\n\nconst icon = key => {\n\tswitch(key) {\n\t\tcase 'angle-double-right':\n\t\t\treturn <AngleDoubleRight />;\n\t\tcase 'angle-double-left':\n\t\t\treturn <AngleDoubleLeft/>;\n\t\tcase 'angle-double-up':\n\t\t\treturn <AngleDoubleUp/>;\n\t\tcase 'angle-double-down':\n\t\t\treturn <AngleDoubleDown/>;\n\t\t// case 'angle-right':\n\t\t// \treturn getAngleRight();\n\t\t// case 'angle-left':\n\t\t// \treturn getAngleLeft();\n\t\t// case 'angle-up':\n\t\t// \treturn getAngleUp();\n\t\t// case 'angle-down':\n\t\t// \treturn getAngleDown();\n\t\tcase 'arrow-left':\n\t\tcase 'back':\n\t\t\treturn <ArrowLeft />;\n\t\tcase 'circle':\n\t\t\treturn <Circle />;\n\t\tcase 'chevron-left':\n\t\t\treturn <ChevronLeft />;\n\t\tcase 'chevron-right':\n\t\t\treturn <ChevronRight />;\n\t\tcase 'delete':\n\t\t\treturn <Delete />; //todo\n\t\tcase 'dots':\n\t\t\treturn <Dots />;\n\t\tcase 'download':\n\t\t\treturn <Download />; //todo\n\t\tcase 'edit':\n\t\t\treturn <Edit />;\n\t\tcase 'expand':\n\t\t\treturn <Expand />; //todo\n\t\tcase 'expand-row':\n\t\t\treturn <ExpandRow />;\n\t\tcase 'filter':\n\t\t\treturn <Filter />;\n\t\tcase 'info':\n\t\t\treturn <Info />;\n\t\tcase 'layers':\n\t\t\treturn <Layers/>;\n\t\tcase 'legend':\n\t\t\treturn <Legend/>;\n\t\tcase 'map-pin':\n\t\t\treturn <MapPin/>;\n\t\tcase 'minus':\n\t\t\treturn <Minus />;\n\t\tcase 'minus-thick':\n\t\t\treturn <MinusThick />;\n\t\tcase 'north-arrow':\n\t\t\treturn <NorthArrow />;\n\t\tcase 'opacity':\n\t\t\treturn <Opacity />; //todo\n\t\tcase 'plus':\n\t\t\treturn <Plus />;\n\t\tcase 'plus-thick':\n\t\t\treturn <PlusThick />;\n\t\tcase 'pushpin':\n\t\t\treturn <Pushpin />; //todo\n\t\tcase 'restore':\n\t\t\treturn <Restore />;\n\t\tcase 'rotate-left':\n\t\t\treturn <RotateLeft />;\n\t\tcase 'rotate-right':\n\t\t\treturn <RotateRight />;\n\t\tcase 'search':\n\t\t\treturn <Search />; //todo\n\t\tcase 'share':\n\t\t\treturn <Share />;\n\t\tcase 'tilt-less':\n\t\t\treturn <TiltLess />; //todo\n\t\tcase 'tilt-more':\n\t\t\treturn <TiltMore />; //todo\n\t\tcase 'times':\n\t\tcase 'close':\n\t\t\treturn <Times />;\n\t\tcase 'triangle-down':\n\t\t\treturn <TriangleDown />;\n\t\tcase 'warning':\n\t\t\treturn <Warning />;\n\t\t// case 'sort-down':\n\t\t// \treturn getSortDown();\n\t\t// case 'sort-up':\n\t\t// \treturn getSortUp();\n\t\tcase 'upload':\n\t\t\treturn <Upload />; //todo\n\t\tcase 'sentinel-1':\n\t\t\treturn <Sentinel1 />;\n\t\tcase 'sentinel-2':\n\t\t\treturn <Sentinel2 />;\n\t\tcase 'sentinel-3':\n\t\t\treturn <Sentinel3 />;\n\t\tcase 'sentinel-4':\n\t\t\treturn <Sentinel4 />;\n\t\tcase 'sentinel-5':\n\t\t\treturn <Sentinel5 />;\n\t\tcase 'location':\n\t\t\treturn <Location />;\n\t\tcase 'loader-oval':\n\t\t\treturn <LoaderOval />;\n\t\tcase 'clock':\n\t\t\treturn <Clock />;\n\t\t// case 'times':\n\t\t// \treturn getTimes();\n\t\tdefault:\n\t\t\treturn (\n\t\t\t\t<g>\n\t\t\t\t\t<rect x=\"4.844\" y=\"4.844\" fill=\"none\" stroke=\"#FF3333\" strokeMiterlimit=\"10\" width=\"22.313\" height=\"22.313\"/>\n\t\t\t\t\t<line fill=\"none\" stroke=\"#FF3333\" strokeMiterlimit=\"10\" x1=\"27.156\" y1=\"4.844\" x2=\"4.844\" y2=\"27.156\"/>\n\t\t\t\t\t<line fill=\"none\" stroke=\"#FF3333\" strokeMiterlimit=\"10\" x1=\"4.844\" y1=\"4.844\" x2=\"27.156\" y2=\"27.156\"/>\n\t\t\t\t</g>\n\t\t\t);\n\t}\n};\n\nexport default props => (\n\t<svg\n\t\tstyle={props.style} //todo better solution (used for transform: rotate)\n\t\tversion=\"1.1\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\txmlnsXlink=\"http://www.w3.org/1999/xlink\"\n\t\tx=\"0px\"\n\t\ty=\"0px\"\n\t\twidth=\"32px\"\n\t\theight=\"32px\"\n\t\tviewBox=\"0 0 32 32\"\n\t\txmlSpace=\"preserve\"\n\t\tclassName={`ptr-icon ${props.className || ''}`}\n\t>\n\t\t{typeof props.icon === \"function\" ? props.icon() : icon(props.icon)}\n\t</svg>\n);\n","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport React from 'react';\nimport ReactModal from 'react-modal';\nimport Icon from '../atoms/Icon';\n\nReactModal.setAppElement('#root');\n\nexport default (props) => {\n    const {modalKey, isOpen, content, onClose, header} = props;\n\n    const closeStyle = css({\n        position: 'absolute',\n        cursor: 'pointer',\n        top: '16px',\n        right: '16px',\n        fill: 'rgb(226, 236, 249)',\n        stroke: 'rgb(226, 236, 249)',\n        ':hover:focus': {\n            fill: 'rgb(93, 93, 253)',\n            stroke: 'rgb(93, 93, 253)',        \n        }\n    })\n\n    const closeIconStyle = css({\n        width: '1.5rem',\n    })\n\n    const headerStyle = css({\n        borderBottom: '1px solid rgb(233, 233, 233)',\n        minHeight: '1.9rem',\n        backgroundColor: 'rgba(8, 11, 18, 0.9)',\n        fontSize: '2rem',\n    })\n\n    return (\n        <ReactModal \n            isOpen={isOpen}\n            contentLabel=\"Inline Styles Modal Example\"\n            style={{\n                overlay: {\n                    backgroundColor: 'rgba(115, 117, 187, 0.14)',\n                    zIndex: '1000',\n                },\n                content: {\n                    color: 'rgb(226, 236, 249)',\n                    backgroundColor: 'rgba(8, 11, 18, 0.9)',\n                    border: '1px solid rgba(204, 204, 204, 0.51)',\n                }\n            }}\n        >\n            <div css={headerStyle}>{header}</div>\n            {content}\n            <span onClick={() => {onClose(modalKey)}} css={closeStyle}>\n                <Icon icon={'times'} css={closeIconStyle}/>\n            </span>\n        </ReactModal>)\n}","import styled from '@emotion/styled';\nimport React from 'react';\nimport PropTypes from \"prop-types\";\nimport \"./style.css\";\n\n// const itemStyle = {\n//     display: 'flex',\n// };\n\nconst titleStyle = {\n    display: 'flex',\n    minWidth: '15rem',\n    justifyContent: 'flex-start',\n}\n\nconst getDataListItem = (title, value, key) => {\n    return (<div className={'item'} key={key}><span style={titleStyle}>{title}:</span><span>{value}</span></div>);\n};\n\nconst getDataList = (data) => {\n    return data.map((i, index) => {\n        return getDataListItem(i._attributes.name, i._text, `${index}_${i._attributes.name}`);\n    });\n};\n\nconst ProductInformation = ({product, heading}) => {\n    const {title, id, date, int, str, summary} = product;\n\n    //dates\n    // const beginpositionDate = date.find((d) => d._attributes.name === \"beginposition\");\n    // const endpositionDate = date.find((d) => d._attributes.name === \"endposition\");\n    // const ingestiondateDate = date.find((d) => d._attributes.name === \"ingestiondate\");\n    const dateList = date ? getDataList(date) : null;\n\n    //int\n    const intList = int ? getDataList(int) : null;\n\n    //str\n    const strList = str ? Object.entries(str).map(([title, value], index) => getDataListItem(title, value, `${index}_${title}`)) : null;\n\n    //summary\n    const summaryItem = summary && summary._text ? getDataListItem('summary', summary._text, 'summary') : null;\n\n    //title\n    const titleItem = title && title._text ? getDataListItem('title', title._text, 'title') : null;\n\n\n    //styles\n    // const productStyle = {\n    //     margin: '2rem',\n    // };\n    \n    // const headingStyle = {\n    //     fontSize: '1.25rem',\n    //     marginLeft: '2rem',\n    //     marginBottom: '1rem',\n    // }\n    \n    // const sectionStyle = css({\n    //     'div': {\n    //         display: 'flex'\n    //     }\n    // })\n    // `\n\n    return (\n        <div className={'product-info'}>\n            <h1>\n                {heading ? heading : `${str.platformname} - ${str.producttype}`}\n            </h1>\n            <section>\n                {titleItem}\n            </section>\n            <section>\n                {dateList}\n            </section>\n            <section>\n                {intList}\n            </section>\n            <section>\n                {strList}\n            </section>\n            <section>\n                {summaryItem}\n            </section>\n            {/* line */}\n        </div>\n    )\n}\n\nProductInformation.propTypes = {\n    product:PropTypes.object,\n}\n\nProductInformation.defaultProps = {\n    product: {},\n}\n\nexport default ProductInformation;","import * as React from 'react';\nimport {Context} from './context';\nexport function withContext(Component) {\n  return (props) => {\n    return (\n      <Context.Consumer>\n        {(contexts) => <Component {...props} {...contexts} />\n        }\n      </Context.Consumer>\n    )\n  }\n}","import React from 'react';\nimport PropTypes from \"prop-types\";\nimport Modal from '../Modal';\nimport ProductInformation from './productInformation';\nimport {withContext} from '../../context/withContext';\n\nconst ProductsModal = (props) => {\n    const {visible, onClose, showProducts, products, modalKey} = props;\n\n    const content = products.map((product) => {\n        return (<ProductInformation key={product.id} product={product} />)\n    })\n\n    const header = (<h1 className={'modal-header'}>Sentinel products [{products.length}]</h1>);\n\n    return (\n        visible ? <Modal \n                modalKey = {modalKey}\n                isOpen = {visible}\n                content = {content}\n                header = {header}\n                onClose = {onClose}\n                /> : null\n    )\n}\n\nProductsModal.propTypes = {\n    visible:PropTypes.bool,\n    onClose:PropTypes.func,\n    showProducts:PropTypes.array,\n    products:PropTypes.array,\n    modalKey:PropTypes.string,\n  }\n\n  ProductsModal.defaultProps = {\n    visible:false,\n    onClose:() => {},\n    showProducts: [],\n    products: [],\n    modalKey: '',\n  }\n\nexport default withContext(ProductsModal);","/*\n * Copyright 2003-2006, 2009, 2017, United States Government, as represented by the Administrator of the\n * National Aeronautics and Space Administration. All rights reserved.\n *\n * The NASAWorldWind/WebWorldWind platform is licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @exports ColladaScene\n */\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    ArgumentError,\n    BasicTextureProgram,\n    Color,\n    Logger,\n    Matrix,\n    Position,\n    PickedObject,\n    Renderable,\n    Vec3\n} = WorldWind;\n\n\n/**\n * Constructs a collada scene\n * @alias ColladaScene\n * @constructor\n * @augments Renderable\n * @classdesc Represents a scene. A scene is a collection of nodes with meshes, materials and textures.\n * @param {Position} position The scene's geographic position.\n * @param {Object} sceneData The scene's data containing the nodes, meshes, materials, textures and other\n * info needed to render the scene.\n */\nvar ColladaScene = function (position, sceneData) {\n    if (!position) {\n        throw new ArgumentError(\n            Logger.logMessage(Logger.LEVEL_SEVERE, \"ColladaScene\", \"constructor\", \"missingPosition\"));\n    }\n\n    Renderable.call(this);\n\n    // Documented in defineProperties below.\n    this._position = position;\n\n    // Documented in defineProperties below.\n    this._nodes = [];\n    this._meshes = {};\n    this._materials = {};\n    this._images = {};\n    this._upAxis = '';\n    this._dirPath = '';\n\n    // Documented in defineProperties below.\n    this._xRotation = 0;\n    this._yRotation = 0;\n    this._zRotation = 0;\n\n    this.preX = 0;\n    this.preY = 0;\n    this.preZ = 0;\n\n    // Documented in defineProperties below.\n    this._xTranslation = 0;\n    this._yTranslation = 0;\n    this._zTranslation = 0;\n\n    // Documented in defineProperties below.\n    this._scale = 1;\n\n    // Documented in defineProperties below.\n    this._altitudeMode = WorldWind.ABSOLUTE;\n\n    // Documented in defineProperties below.\n    this._localTransforms = true;\n\n    // Documented in defineProperties below.\n    this._useTexturePaths = true;\n\n    // Documented in defineProperties below.\n    this._nodesToHide = [];\n    this._hideNodes = false;\n\n    // Documented in defineProperties below.\n    this._placePoint = new Vec3(0, 0, 0);\n\n    // Documented in defineProperties below.\n    this._transformationMatrix = Matrix.fromIdentity();\n    this._mvpMatrix = Matrix.fromIdentity();\n\n    // Documented in defineProperties below.\n    this._normalTransformMatrix = Matrix.fromIdentity();\n    this._normalMatrix = Matrix.fromIdentity();\n    this._texCoordMatrix = Matrix.fromIdentity().setToUnitYFlip();\n\n    //Internal. Intentionally not documented.\n    this._entities = [];\n\n    //Internal. Intentionally not documented.\n    this._activeTexture = null;\n\n    //Internal. Intentionally not documented.\n    this._tmpVector = new Vec3(0, 0, 0);\n    this._tmpColor = new Color(1, 1, 1, 1);\n\n    //Internal. Intentionally not documented.\n    this._vboCacheKey = '';\n    this._iboCacheKey = '';\n\n    this.setSceneData(sceneData);\n};\n\nColladaScene.prototype = Object.create(Renderable.prototype);\nColladaScene.prototype.constructor = ColladaScene;\n\nObject.defineProperties(ColladaScene.prototype, {\n\n    /**\n     * The scene's geographic position.\n     * @memberof ColladaScene.prototype\n     * @type {Position}\n     */\n    position: {\n        get: function () {\n            return this._position;\n        },\n        set: function (value) {\n            this._position = value;\n        }\n    },\n\n    /**\n     * An array of nodes extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {ColladaNode[]}\n     */\n    nodes: {\n        get: function () {\n            return this._nodes;\n        },\n        set: function (value) {\n            this._nodes = value;\n        }\n    },\n\n    /**\n     * An object with meshes extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {{ColladaMesh}}\n     */\n    meshes: {\n        get: function () {\n            return this._meshes;\n        },\n        set: function (value) {\n            this._meshes = value;\n        }\n    },\n\n    /**\n     * An object with materials and their effects extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {ColladaMaterial}\n     */\n    materials: {\n        get: function () {\n            return this._materials;\n        },\n        set: function (value) {\n            this._materials = value;\n        }\n    },\n\n    /**\n     * An object with images extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {ColladaImage}\n     */\n    images: {\n        get: function () {\n            return this._images;\n        },\n        set: function (value) {\n            this._images = value;\n        }\n    },\n\n    /**\n     * The up axis of the collada model extracted from the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {String}\n     */\n    upAxis: {\n        get: function () {\n            return this._upAxis;\n        },\n        set: function (value) {\n            this._upAxis = value;\n        }\n    },\n\n    /**\n     * The path to the directory of the collada file.\n     * @memberof ColladaScene.prototype\n     * @type {String}\n     */\n    dirPath: {\n        get: function () {\n            return this._dirPath;\n        },\n        set: function (value) {\n            this._dirPath = value;\n        }\n    },\n\n    /**\n     * The scene's rotation angle in degrees for the x axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    xRotation: {\n        get: function () {\n            return this._xRotation;\n        },\n        set: function (value) {\n            this._xRotation = value;\n        }\n    },\n\n    /**\n     * The scene's rotation angle in degrees for the x axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    yRotation: {\n        get: function () {\n            return this._yRotation;\n        },\n        set: function (value) {\n            this._yRotation = value;\n        }\n    },\n\n    /**\n     * The scene's rotation angle in degrees for the x axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    zRotation: {\n        get: function () {\n            return this._zRotation;\n        },\n        set: function (value) {\n            this._zRotation = value;\n        }\n    },\n\n    /**\n     * The scene's translation for the x axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    xTranslation: {\n        get: function () {\n            return this._xTranslation;\n        },\n        set: function (value) {\n            this._xTranslation = value;\n        }\n    },\n\n    /**\n     * The scene's translation for the y axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    yTranslation: {\n        get: function () {\n            return this._yTranslation;\n        },\n        set: function (value) {\n            this._yTranslation = value;\n        }\n    },\n\n    /**\n     * The scene's translation for the z axis.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    zTranslation: {\n        get: function () {\n            return this._zTranslation;\n        },\n        set: function (value) {\n            this._zTranslation = value;\n        }\n    },\n\n    /**\n     * The scene's scale.\n     * @memberof ColladaScene.prototype\n     * @type {Number}\n     */\n    scale: {\n        get: function () {\n            return this._scale;\n        },\n        set: function (value) {\n            this._scale = value;\n        }\n    },\n\n    /**\n     * The scene's Cartesian point on the globe for the specified position.\n     * @memberof ColladaScene.prototype\n     * @type {Vec3}\n     */\n    placePoint: {\n        get: function () {\n            return this._placePoint;\n        },\n        set: function (value) {\n            this._placePoint = value;\n        }\n    },\n\n    /**\n     * The scene's altitude mode. May be one of\n     * <ul>\n     *  <li>[WorldWind.ABSOLUTE]{@link WorldWind#ABSOLUTE}</li>\n     *  <li>[WorldWind.RELATIVE_TO_GROUND]{@link WorldWind#RELATIVE_TO_GROUND}</li>\n     *  <li>[WorldWind.CLAMP_TO_GROUND]{@link WorldWind#CLAMP_TO_GROUND}</li>\n     * </ul>\n     * @default WorldWind.ABSOLUTE\n     * @memberof ColladaScene.prototype\n     * @type {String}\n     */\n    altitudeMode: {\n        get: function () {\n            return this._altitudeMode;\n        },\n        set: function (value) {\n            this._altitudeMode = value;\n        }\n    },\n\n    /**\n     * The scene's transformation matrix containing the scale, rotations and translations\n     * @memberof ColladaScene.prototype\n     * @type {Matrix}\n     */\n    transformationMatrix: {\n        get: function () {\n            return this._transformationMatrix;\n        },\n        set: function (value) {\n            this._transformationMatrix = value;\n        }\n    },\n\n    /**\n     * The scene's normal matrix\n     * @memberof ColladaScene.prototype\n     * @type {Matrix}\n     */\n    normalMatrix: {\n        get: function () {\n            return this._normalMatrix;\n        },\n        set: function (value) {\n            this._normalMatrix = value;\n        }\n    },\n\n    /**\n     * Force the use of the nodes transformation info. Some 3d software may break the transformations when\n     * importing/exporting models to collada format. Set to false to ignore the the nodes transformation.\n     * Only use this option if the model does not render properly.\n     * @memberof ColladaScene.prototype\n     * @default true\n     * @type {Boolean}\n     */\n    localTransforms: {\n        get: function () {\n            return this._localTransforms;\n        },\n        set: function (value) {\n            this._localTransforms = value;\n        }\n    },\n\n    /**\n     * Force the use of the texture path specified in the collada file. Set to false to ignore the paths of the\n     * textures in the collada file and instead get the textures from the same dir as the collada file.\n     * @memberof ColladaScene.prototype\n     * @default true\n     * @type {Boolean}\n     */\n    useTexturePaths: {\n        get: function () {\n            return this._useTexturePaths;\n        },\n        set: function (value) {\n            this._useTexturePaths = value;\n        }\n    },\n\n    /**\n     * An array of node id's to not render.\n     * @memberof ColladaScene.prototype\n     * @type {String[]}\n     */\n    nodesToHide: {\n        get: function () {\n            return this._nodesToHide;\n        },\n        set: function (value) {\n            this._nodesToHide = value;\n        }\n    },\n\n    /**\n     * Set to true to force the renderer to not draw the nodes passed to the nodesToHide list.\n     * @memberof ColladaScene.prototype\n     * @default false\n     * @type {Boolean}\n     */\n    hideNodes: {\n        get: function () {\n            return this._hideNodes;\n        },\n        set: function (value) {\n            this._hideNodes = value;\n        }\n    }\n\n});\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.setSceneData = function (sceneData) {\n    if (sceneData) {\n        this._nodes = sceneData.root.children;\n        this._meshes = sceneData.meshes;\n        this._materials = sceneData.materials;\n        this._images = sceneData.images;\n        this._upAxis = sceneData.metadata.up_axis;\n        this._dirPath = sceneData.dirPath;\n\n        this.flattenModel();\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.flattenModel = function () {\n    for (var i = 0, nodesLen = this._nodes.length; i < nodesLen; i++) {\n        this.flattenNode(this._nodes[i]);\n    }\n\n    this._entities.sort(function (a, b) {\n        var va = (a.imageKey === null) ? \"\" : \"\" + a,\n            vb = (b.imageKey === null) ? \"\" : \"\" + b;\n        return va > vb ? 1 : (va === vb ? 0 : -1);\n    });\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.flattenNode = function (node) {\n    if (node.mesh) {\n        var meshKey = node.mesh;\n        var buffers = this._meshes[meshKey].buffers;\n\n        for (var i = 0, bufLen = buffers.length; i < bufLen; i++) {\n            var materialBuf = buffers[i].material;\n\n            for (var j = 0; j < node.materials.length; j++) {\n                if (materialBuf === node.materials[j].symbol) {\n                    var materialKey = node.materials[j].id;\n                    break;\n                }\n            }\n\n            var material = this._materials[materialKey];\n            var imageKey = null;\n            var hasTexture = material && material.textures && buffers[i].uvs && buffers[i].uvs.length > 0;\n            if (hasTexture) {\n                if (material.textures.diffuse) {\n                    imageKey = material.textures.diffuse.mapId;\n                } else if (material.textures.reflective) {\n                    imageKey = material.textures.reflective.mapId;\n                }\n            }\n\n            this._entities.push({\n                mesh: buffers[i],\n                material: material,\n                node: node,\n                imageKey: imageKey\n            });\n        }\n    }\n\n    for (var k = 0; k < node.children.length; k++) {\n        this.flattenNode(node.children[k]);\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.render = function (dc) {\n    var orderedScene;\n    var frustum = dc.frustumInModelCoordinates;\n\n    if (!this.enabled) {\n        return;\n    }\n\n    if (this.lastFrameTime !== dc.timestamp) {\n        orderedScene = this.makeOrderedRenderable(dc);\n    }\n\n    if (!orderedScene) {\n        return;\n    }\n\n    if (!frustum.containsPoint(this._placePoint)) {\n        return;\n    }\n\n    orderedScene.layer = dc.currentLayer;\n\n    this.lastFrameTime = dc.timestamp;\n\n    dc.addOrderedRenderable(orderedScene);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.makeOrderedRenderable = function (dc) {\n    dc.surfacePointForMode(this._position.latitude, this._position.longitude, this._position.altitude,\n        this._altitudeMode, this._placePoint);\n\n    this.eyeDistance = dc.eyePoint.distanceTo(this._placePoint);\n\n    return this;\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.renderOrdered = function (dc) {\n    this.drawOrderedScene(dc);\n\n    if (dc.pickingMode) {\n        var po = new PickedObject(this.pickColor.clone(), this, this._position, this.layer, false);\n        dc.resolvePick(po);\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.drawOrderedScene = function (dc) {\n    try {\n        this.beginDrawing(dc);\n    } finally {\n        this.endDrawing(dc);\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.beginDrawing = function (dc) {\n    var gl = dc.currentGlContext;\n    var gpuResourceCache = dc.gpuResourceCache;\n\n    var vboId = gpuResourceCache.resourceForKey(this._vboCacheKey);\n    var iboId = gpuResourceCache.resourceForKey(this._iboCacheKey);\n\n    if (!vboId) {\n        this.setupBuffers(dc);\n        vboId = gpuResourceCache.resourceForKey(this._vboCacheKey);\n        iboId = gpuResourceCache.resourceForKey(this._iboCacheKey);\n    }\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n    if (iboId) {\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, iboId);\n    }\n\n    dc.findAndBindProgram(BasicTextureProgram);\n    gl.enableVertexAttribArray(0);\n\n    if (dc.pickingMode) {\n        this.pickColor = dc.uniquePickColor();\n    }\n\n    this.computeTransformationMatrix(dc.globe);\n\n    for (var i = 0, len = this._entities.length; i < len; i++) {\n        var mustRenderNode = this.mustRenderNode(this._entities[i].node.id);\n        if (mustRenderNode) {\n            this.draw(dc, this._entities[i]);\n        }\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.setupBuffers = function (dc) {\n    var gl = dc.currentGlContext;\n    var sizeOfFloat32 = Float32Array.BYTES_PER_ELEMENT || 4;\n    var sizeOfUint16 = Uint16Array.BYTES_PER_ELEMENT || 2;\n    var sizeOfUint32 = Uint32Array.BYTES_PER_ELEMENT || 4;\n    var is32BitIndices = false;\n    var numIndices = 0;\n    var numVertices = 0;\n\n    for (var i = 0, len = this._entities.length; i < len; i++) {\n        var mesh = this._entities[i].mesh;\n        if (mesh.indexedRendering) {\n            numIndices += mesh.indices.length;\n            if (mesh.indices instanceof Uint32Array) {\n                is32BitIndices = true;\n            }\n        }\n        numVertices += mesh.vertices.length;\n        if (this._entities[i].imageKey) {\n            numVertices += mesh.uvs.length;\n        }\n        if (mesh.normals && mesh.normals.length) {\n            numVertices += mesh.normals.length;\n        }\n    }\n\n    var vbo = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n    gl.bufferData(gl.ARRAY_BUFFER, numVertices * sizeOfFloat32, gl.STATIC_DRAW);\n\n    var offset = 0;\n    for (i = 0, len = this._entities.length; i < len; i++) {\n        var data = this._entities[i].mesh.vertices;\n        this._entities[i].vertexOffset = offset;\n        gl.bufferSubData(gl.ARRAY_BUFFER, offset * sizeOfFloat32, data);\n        offset += data.length;\n    }\n\n    for (i = 0, len = this._entities.length; i < len; i++) {\n        if (this._entities[i].imageKey) {\n            data = this._entities[i].mesh.uvs;\n            this._entities[i].uvOffset = offset;\n            gl.bufferSubData(gl.ARRAY_BUFFER, offset * sizeOfFloat32, data);\n            offset += data.length;\n        }\n    }\n\n    for (i = 0, len = this._entities.length; i < len; i++) {\n        data = data = this._entities[i].mesh.normals;\n        if (data && data.length) {\n            this._entities[i].normalOffset = offset;\n            gl.bufferSubData(gl.ARRAY_BUFFER, offset * sizeOfFloat32, data);\n            offset += data.length;\n        }\n    }\n\n    var indexSize = sizeOfUint16;\n    var indexBufferSize = numIndices * indexSize;\n    var uIntExt;\n    if (is32BitIndices) {\n        uIntExt = dc.getExtension('OES_element_index_uint');\n\n        if (!uIntExt) {\n            Logger.log(Logger.LEVEL_SEVERE,\n                'The 3D model is too big and might not render properly. \\n' +\n                'Your browser does not support the \"OES_element_index_uint\" extension, ' +\n                'required to render large models.'\n            );\n        } else {\n            indexSize = sizeOfUint32;\n            indexBufferSize = numIndices * indexSize;\n        }\n    }\n\n    if (numIndices) {\n        var ibo = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indexBufferSize, gl.STATIC_DRAW);\n\n        offset = 0;\n        for (i = 0, len = this._entities.length; i < len; i++) {\n            mesh = this._entities[i].mesh;\n            if (mesh.indexedRendering) {\n                data = mesh.indices;\n                if (data instanceof Uint32Array && !uIntExt) {\n                    data = new Uint16Array(data);\n                }\n                this._entities[i].indexOffset = offset;\n                this._entities[i].indexSize = indexSize;\n                gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, offset * indexSize, data);\n                offset += data.length;\n            }\n        }\n    }\n\n    this._vboCacheKey = dc.gpuResourceCache.generateCacheKey();\n    dc.gpuResourceCache.putResource(this._vboCacheKey, vbo, numVertices * sizeOfFloat32);\n\n    if (numIndices) {\n        this._iboCacheKey = dc.gpuResourceCache.generateCacheKey();\n        dc.gpuResourceCache.putResource(this._iboCacheKey, ibo, indexBufferSize);\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.draw = function (dc, entity) {\n    var gl = dc.currentGlContext;\n    var program = dc.currentProgram;\n    var gpuResourceCache = dc.gpuResourceCache;\n\n    var buffers = entity.mesh;\n    var material = entity.material;\n\n    var nodeWorldMatrix = entity.node.worldMatrix;\n    var nodeNormalMatrix = entity.node.normalMatrix;\n\n    var hasLighting = buffers.normals && buffers.normals.length;\n\n    var imageKey = entity.imageKey;\n\n    this.applyColor(dc, material);\n\n    if (imageKey) {\n        var imagePath = this._useTexturePaths ? this._images[imageKey].path : this._images[imageKey].filename;\n        var textureCacheKey = this._dirPath + imagePath;\n        this._activeTexture = gpuResourceCache.resourceForKey(textureCacheKey);\n        if (!this._activeTexture) {\n            var wrapMode = buffers.isClamp ? gl.CLAMP_TO_EDGE : gl.REPEAT;\n            this._activeTexture = gpuResourceCache.retrieveTexture(gl, textureCacheKey, wrapMode);\n        }\n        var textureBound = this._activeTexture && this._activeTexture.bind(dc);\n        if (textureBound) {\n            program.loadTextureEnabled(gl, true);\n            gl.vertexAttribPointer(2, 2, gl.FLOAT, false, 8, entity.uvOffset * 4);\n            gl.enableVertexAttribArray(2);\n            program.loadModulateColor(gl, dc.pickingMode);\n        } else {\n            program.loadTextureEnabled(gl, false);\n            gl.disableVertexAttribArray(2);\n        }\n    } else {\n        program.loadTextureEnabled(gl, false);\n        gl.disableVertexAttribArray(2);\n    }\n\n    if (hasLighting && !dc.pickingMode) {\n        program.loadApplyLighting(gl, 1);\n        gl.vertexAttribPointer(1, 3, gl.FLOAT, false, 12, entity.normalOffset * 4);\n        gl.enableVertexAttribArray(1);\n    } else {\n        program.loadApplyLighting(gl, 0);\n        gl.disableVertexAttribArray(1);\n    }\n\n    this.applyMatrix(dc, hasLighting, textureCacheKey, nodeWorldMatrix, nodeNormalMatrix);\n\n    gl.vertexAttribPointer(0, 3, gl.FLOAT, false, 12, entity.vertexOffset * 4);\n\n    if (buffers.indexedRendering) {\n        var indexOffsetBytes = entity.indexOffset * entity.indexSize;\n        if (buffers.indices instanceof Uint32Array && dc.getExtension('OES_element_index_uint')) {\n            gl.drawElements(gl.TRIANGLES, buffers.indices.length, gl.UNSIGNED_INT, indexOffsetBytes);\n        } else {\n            gl.drawElements(gl.TRIANGLES, buffers.indices.length, gl.UNSIGNED_SHORT, indexOffsetBytes);\n        }\n    } else {\n        gl.drawArrays(gl.TRIANGLES, 0, Math.floor(buffers.vertices.length / 3));\n    }\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.applyColor = function (dc, material) {\n    var gl = dc.currentGlContext,\n        program = dc.currentProgram;\n\n    if (material) {\n        if (material.techniqueType === 'constant') {\n            var diffuse = material.reflective;\n        } else {\n            diffuse = material.diffuse;\n        }\n    }\n\n    var opacity;\n    var r = 1, g = 1, b = 1, a = 1;\n\n    if (diffuse) {\n        r = diffuse[0];\n        g = diffuse[1];\n        b = diffuse[2];\n        a = diffuse[3] != null ? diffuse[3] : 1;\n    }\n\n    this._tmpColor.set(r, g, b, a);\n    opacity = a * this.layer.opacity;\n    gl.depthMask(opacity >= 1 || dc.pickingMode);\n    program.loadColor(gl, dc.pickingMode ? this.pickColor : this._tmpColor);\n    program.loadOpacity(gl, dc.pickingMode ? (opacity > 0 ? 1 : 0) : opacity);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.applyMatrix = function (dc, hasLighting, hasTexture, nodeWorldMatrix, nodeNormalMatrix) {\n    this._mvpMatrix.copy(dc.modelviewProjection);\n    this._mvpMatrix.multiplyMatrix(this._transformationMatrix);\n\n    if (nodeWorldMatrix && this._localTransforms) {\n        this._mvpMatrix.multiplyMatrix(nodeWorldMatrix);\n    }\n\n    if (hasLighting && !dc.pickingMode) {\n        this._normalMatrix.copy(dc.modelviewNormalTransform);\n        this._normalMatrix.multiplyMatrix(this._normalTransformMatrix);\n        if (nodeNormalMatrix && this._localTransforms) {\n            this._normalMatrix.multiplyMatrix(nodeNormalMatrix);\n        }\n\n        dc.currentProgram.loadModelviewInverse(dc.currentGlContext, this._normalMatrix);\n    }\n\n    if (hasTexture && this._activeTexture) {\n        dc.currentProgram.loadTextureMatrix(dc.currentGlContext, this._texCoordMatrix);\n        this._activeTexture = null;\n    }\n\n    dc.currentProgram.loadModelviewProjection(dc.currentGlContext, this._mvpMatrix);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.endDrawing = function (dc) {\n    var gl = dc.currentGlContext;\n    var program = dc.currentProgram;\n\n    gl.disableVertexAttribArray(1);\n    gl.disableVertexAttribArray(2);\n    program.loadApplyLighting(gl, 0);\n    program.loadTextureEnabled(gl, false);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.computeTransformationMatrix = function (globe) {\n    this._transformationMatrix.setToIdentity();\n\n    this._transformationMatrix.multiplyByLocalCoordinateTransform(this._placePoint, globe);\n\n    this._transformationMatrix.multiplyByRotation(1, 0, 0, this._xRotation);\n    this._transformationMatrix.multiplyByRotation(0, 1, 0, this._yRotation);\n    this._transformationMatrix.multiplyByRotation(0, 0, 1, this._zRotation);\n\n    this._transformationMatrix.multiplyByScale(this._scale, this._scale, this._scale);\n\n    this._transformationMatrix.multiplyByTranslation(this._xTranslation, this._yTranslation, this._zTranslation);\n\n    this._transformationMatrix.multiplyByRotation(1, 0, 0, this.preX);\n    this._transformationMatrix.multiplyByRotation(0, 1, 0, this.preY);\n    this._transformationMatrix.multiplyByRotation(0, 0, 1, this.preZ);\n\n    this.computeNormalMatrix();\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.computeNormalMatrix = function () {\n    this._transformationMatrix.extractRotationAngles(this._tmpVector);\n    this._normalTransformMatrix.setToIdentity();\n    this._normalTransformMatrix.multiplyByRotation(-1, 0, 0, this._tmpVector[0]);\n    this._normalTransformMatrix.multiplyByRotation(0, -1, 0, this._tmpVector[1]);\n    this._normalTransformMatrix.multiplyByRotation(0, 0, -1, this._tmpVector[2]);\n};\n\n// Internal. Intentionally not documented.\nColladaScene.prototype.mustRenderNode = function (nodeId) {\n    var draw = true;\n    if (this._hideNodes) {\n        var pos = this._nodesToHide.indexOf(nodeId);\n        draw = (pos === -1);\n    }\n    return draw;\n};\n\nexport default ColladaScene;","import WorldWind from 'webworldwind-esa';\r\nimport ColladaScene from \"./collada/ColladaScene\";\r\n\r\nconst {\r\n    Matrix,\r\n    Renderable\r\n} = WorldWind;\r\n\r\n/**\r\n * @exports Model\r\n */\r\nclass Model extends Renderable {\r\n    /**\r\n     * Constructs model of the satellite on the given position.\r\n     * @param model {Object} Model information. Collada information.\r\n     * @param satellite {Object} The details about the satellite and the way it should be transformed and presented.\r\n     * @param position {Position} The exact position of the center of the satellite.\r\n     */\r\n    constructor(model, satellite, position) {\r\n        super();\r\n\r\n        this._satellite = satellite;\r\n        const satelliteModel = this.parse(model);\r\n        this.draw(position, satelliteModel);\r\n    }\r\n\r\n    /**\r\n     * Updates the position of the model.\r\n     * @param position {Position} Current position of the model.\r\n     */\r\n    position(position) {\r\n        this._model.position = position;\r\n    }\r\n\r\n    /**\r\n     * Draws the collada model into a Collada Scene.\r\n     * @param position {Position} Position of the satellite.\r\n     * @param modelData Collada Model Information.\r\n     */\r\n    draw(position, modelData) {\r\n        const nodesToHide = [\r\n            'PlatformCircleAndName', 'SolarWingsCircleAndName', 'C-SarCircleAndName',\r\n            'PlatformTextsAndArrows', 'SolarWingsTextsAndArrows', 'C-SarTextsAndArrows',\r\n\r\n            'SolarArrayGroup', 'WingsDetailsGroup', 'Group004', 'MsiGroup', 'SatteliteGroup',\r\n\r\n            'SatteliteDimensionsGroup', 'MWRGroup', 'SRALGroup', 'OLCIGroup', 'SLSTRGroup'\r\n        ];\r\n        const {\r\n            rotations,\r\n            translations,\r\n            preRotations,\r\n            scale,\r\n            shortName,\r\n            ignoreLocalTransforms\r\n        } = this._satellite;\r\n\r\n        const model = new ColladaScene(position, modelData);\r\n        model.type = this.type;\r\n        model.satShortName = shortName;\r\n\r\n        model.nodesToHide = nodesToHide;\r\n        model.hideNodes = true;\r\n        model.useTexturePaths = false;\r\n        model.localTransforms = ignoreLocalTransforms;\r\n        model.scale = scale;\r\n        model.xRotation = rotations.x;\r\n        model.yRotation = rotations.y;\r\n        model.zRotation = rotations.z;\r\n        model.xTranslation = translations.x;\r\n        model.yTranslation = translations.y;\r\n        model.zTranslation = translations.z;\r\n        model.preX = preRotations.x;\r\n        model.preY = preRotations.y;\r\n        model.preZ = preRotations.z;\r\n\r\n        this._model = model;\r\n        modelData = null;\r\n    }\r\n\r\n    /**\r\n     * Parses the collada model and update the information relevant to the satellites.\r\n     * @param {{ meshes:Object, root:Object, materials:{reflective:Array, diffuse:Array} }} jsonData\r\n     * @return {Object} Collada model.\r\n     */\r\n    parse(jsonData) {\r\n        const meshes = jsonData.meshes;\r\n        const nodes = jsonData.root.children;\r\n        const materials = jsonData.materials;\r\n\r\n        for (let key in meshes) {\r\n            if (meshes.hasOwnProperty(key)) {\r\n                const buffers = meshes[key].buffers;\r\n\r\n                for (let i = 0; i < buffers.length; i++) {\r\n                    const vertices = buffers[i].vertices || [];\r\n                    const normals = buffers[i].normals || [];\r\n                    const uvs = buffers[i].uvs || [];\r\n                    const indices = buffers[i].indices || [];\r\n\r\n                    const eVertices = new Float32Array(vertices);\r\n                    const eNormals = new Float32Array(normals);\r\n                    const eUvs = new Float32Array(uvs);\r\n                    const eIndices = new Uint16Array(indices);\r\n\r\n                    buffers[i].vertices = eVertices;\r\n                    buffers[i].normals = eNormals;\r\n                    buffers[i].uvs = eUvs;\r\n                    buffers[i].indices = eIndices;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            const node = nodes[i];\r\n            if (node.mesh) {\r\n                const worldMatrix = node.worldMatrix.slice(0);\r\n                node.worldMatrix = Matrix.fromIdentity();\r\n                node.worldMatrix.copy(worldMatrix);\r\n\r\n                if (node.children.length) {\r\n                    console.info('node has children', node);\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let key in materials) {\r\n            if (materials.hasOwnProperty(key)) {\r\n                const material = materials[key];\r\n\r\n                if (material.id === '_3_-_Default-material') {\r\n                    if (material.reflective) {\r\n                        material.reflective[0] = 0.289219;\r\n                        material.reflective[1] = 0.713497;\r\n                        material.reflective[2] = 0.870753;\r\n                        material.reflective[3] = 1;\r\n                    }\r\n                } else if (material.id === '_1_-_Default_004-material') {\r\n                    material.diffuse[3] = 0;\r\n                } else if (material.id === '_1_-_Default-material') {\r\n                    material.diffuse[3] = 0;\r\n                } else if (material.id === 'Chrome-material') {\r\n                    material.textures = null;\r\n                    material.diffuse[0] = 0.3137;\r\n                    material.diffuse[1] = 0.3137;\r\n                    material.diffuse[2] = 0.3137;\r\n                } else if (material.id === 'Satellite_panel-material') {\r\n                    material.textures.reflective.mapId = 'image9';\r\n                } else if (material.id === '_3_-_Default') {\r\n                    material.textures.reflective.mapId = 'image4';\r\n                } else if (material.id === '_4_-_Default-material') {\r\n                    material.textures.reflective.mapId = 'image5';\r\n                } else if (material.id === '_5_-_Default_002-material') {\r\n                    material.textures.reflective.mapId = 'image6';\r\n                } else if (material.id === '_5_-_Default-material') {\r\n                    material.textures.reflective.mapId = 'image5';\r\n                }\r\n            }\r\n        }\r\n\r\n        return jsonData;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    render(dc) {\r\n        if(!this._model || !this.enabled) {\r\n            return;\r\n        }\r\n\r\n        this._model.render(dc);\r\n    }\r\n}\r\n\r\nexport default Model;","import WorldWind from 'webworldwind-esa';\nimport WorldWindX from 'webworldwind-x';\nimport Model from '../../worldwind/Model';\n\nconst {\n    RenderableLayer,\n    Position,\n} = WorldWind;\n\nconst {\n    EoUtils\n} = WorldWindX;\n\n\nconst DEFAULT_MODEL_OPTIONS = {\n    rotations: {\n        x: 0,\n        y: 0,\n        z: 0,\n        headingAxis: [0, 0, 1],\n        headingAdd: -90,\n        headingMultiply: 1\n    },\n    preRotations: {\n        x: 0,\n        y: 0,\n        z: 0\n    },\n    scale: 500000,\n    translations: {\n        x: -0.1,\n        y: -0.1,\n        z: 0\n    },\n    ignoreLocalTransforms: true\n}\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer can render only one model of satellite. It`s possible to set position data of model.\n * @param options {Object}\n * @param options.key {String}\n * @param options.time {Date} Time of the satellite.\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass SatelliteModelLayer extends RenderableLayer {\n\tconstructor(options, satelliteOptions) {\n        super(options);\n        this._satelliteOptions = satelliteOptions;\n        this._rerenderMap = null;\n        this.key = options.key;\n        this.model = null;\n        this.time = options.time;\n        this.Tle = null;\n    };\n    \n    /**\n     * \n     * @param {Object} collada model \n     * @param {Object} options\n     * @param {Position} position\n     */\n    setModel(model, options = DEFAULT_MODEL_OPTIONS, position) {\n        if(model) {\n            this.model = new Model(model, options, position);\n\n            this.removeAllRenderables();\n            this.addRenderable(this.model);\n            this.doRerender();\n        }\n    }\n\n    /**\n     * @param position {Position} Position of the satellite.\n     */\n    setPosition(position) {\n        if(position && this.model) {\n            this.model.position(position);\n        }\n    }\n\n    \n    /**\n     * @param position {Array.<lte>} Lte.\n     */\n    setTle(Tle) {\n        if(Tle) {\n            this.Tle = Tle;\n            this.update();\n        }\n    }\n    \n    /**\n     * @param position {Array.<lte>} Lte.\n     */\n    update() {\n        if(this.Tle && this.time) {\n            const satrec = EoUtils.computeSatrec(...this.Tle);\n            const position = EoUtils.getOrbitPosition(satrec, new Date(this.time));\n            this.setPosition(new Position(position.latitude, position.longitude, position.altitude));\n            if(this.model) {\n                this.alignWithOrbit(this.time, position, EoUtils.computeSatrec(...this.Tle), this._satelliteOptions.rotations, this.model._model);\n            }\n            this.doRerender();\n        }\n    }\n\n    alignWithOrbit(date, currentPosition, satrec, rotations, model) {\n        const now = date.getTime();\n        const nextPosition = EoUtils.getOrbitPosition(satrec, new Date(now + 10000));\n        const headingRad = EoUtils.headingAngleRadians(currentPosition.latitude, currentPosition.longitude, nextPosition.latitude, nextPosition.longitude);\n        const heading = EoUtils.rad2deg(headingRad);\n        const angle = (heading + rotations.headingAdd) * rotations.headingMultiply;\n\n        if (heading !== 0) {\n            if (rotations.headingAxis[0] === 1) {\n                model.xRotation = angle;\n            }\n            else if (rotations.headingAxis[1] === 1) {\n                model.yRotation = angle;\n            }\n            else if (rotations.headingAxis[2] === 1) {\n                model.zRotation = angle;\n            }\n        }\n    }\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    setTime(time) {\n        if(time) {\n            this.time = time;\n            this.update();\n        }\n    }\n    \n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n\t}\n}\n\nexport default SatelliteModelLayer;\n\n","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nconst {\n    EoUtils,\n} = WordWindX;\n\nconst {\n    ABSOLUTE,\n    Color,\n    Renderable,\n    Path,\n    ShapeAttributes\n} = WorldWind;\n\n\n/**\n * @exports Orbits\n */\nclass Orbits extends Renderable {\n    /**\n     * Constructs Orbits displaying the past and future position. The positions are calculated from the satrec. The\n     * orbits are displayed from now back to past and\n     * @param satrec {Object} SDG format representing the satellite.\n     * @param time {Date} Date for which the orbits will be displayed.\n     * @param timeWindow {Number} Amount of milliseconds for the time window.\n     * @param orbitPoints {Number} Amount of the Panther.\n     */\n    constructor(satrec, startTime = new Date(), endTime = new Date(), color, orbitPoints = 720) {\n        super();\n\n        if(!satrec) {\n            throw new Error('Orbits#constructor Satellite Record is missing.');\n        }\n\n        this._satrec = satrec;\n\n        // this._timeWindow = timeWindow;\n        this._orbitPoints = orbitPoints;\n\n        this._trail = this.trail(this.trailAttributes(color));\n        // this._futureTrail = this.trail(this.trailAttributes(new Color(1, 1, 0, 1)));\n\n        if(endTime.getTime() === startTime.getTime()) {\n            this._currentEndTime = new Date(startTime.getTime() + orbitPoints * 1000);\n            this._previousEndTime = new Date(startTime.getTime() + orbitPoints * 1000);\n        } else {\n            this._currentEndTime = endTime;\n            this._previousEndTime = endTime;\n        }\n\n        this._currentStartTime = startTime;\n        this._previousStartTime = startTime;\n\n        this.populate();\n    }\n\n    /**\n     * Update information about when and where the satellite was. It fully rebuilds the positions for the trails.\n     * @param satelliteRecord SPG format representing the satellite.\n     */\n    satrec(satelliteRecord) {\n        if(!satelliteRecord) {\n            throw Error('No satellite record was provided');\n        }\n        this._satrec = satelliteRecord;\n        // This must signalize somehow that it needs to be recalculated.\n\n        this.populate();\n    }\n\n    /**\n     * Update current time for this set of orbits.\n     * @param startTime {Date} Start date for the orbit.\n     * @param endTime {Date} End date for the orbit.\n     */\n    time(startTime, endTime) {\n        if(!startTime) {\n            throw Error('No startTime was provided');\n        }\n        if(!endTime) {\n            throw Error('No endTime was provided');\n        }\n        this._previousStartTime = this._currentStartTime;\n        this._previousEndTime = this._currentEndTime;\n        this._currentStartTime = startTime;\n        this._currentEndTime = endTime;\n\n        this.update();\n    }\n\n    /**\n     * Renders all trails belonging to this Orbit if it is enabled.\n     * @param dc {DrawContext} Shared state for one rendering.\n     */\n    render(dc) {\n        if(!this.enabled) {\n            return;\n        }\n\n        this._trail.render(dc);\n        // this._futureTrail.render(dc);\n    }\n\n    /**\n     * Updates the trails associated with this Orbit based on the current time and satrec. If there is no change in\n     * either of these parameters nothing changes.\n     * @param force {Boolean} If force, recalculate all positions\n     * @private\n     */\n    update(force = false) {\n        const startDate = this._currentStartTime.getTime();\n        const now = startDate;\n        const previousStartTime = this._previousStartTime.getTime();\n        const previousTime = previousStartTime;\n        const changeStart = startDate - previousStartTime;\n        const endDate = this._currentEndTime.getTime();\n        const previousEndTime = this._previousEndTime.getTime();\n        const changeEnd = endDate - previousEndTime;\n        if(changeStart === 0 && changeEnd === 0 && !force) {\n            return;\n        }\n\n        if(force) {\n            this.populate();\n            return;\n        }\n\n        const timeWindow = endDate - startDate;\n\n        const tick = Math.floor(timeWindow / this._orbitPoints);\n        let positionsToReplace = (Math.ceil(Math.abs(now - previousTime) / tick)) + Math.ceil(Math.abs(endDate - previousEndTime) / tick);\n        if(positionsToReplace > this._orbitPoints) {\n            this.populate();\n            return;\n        }\n\n        //if start change\n        //update start\n        if(changeStart) {\n            //change to future\n            if(changeStart > 0) {\n                //remove olded possitions than current startDate\n                let i = 0;\n                while (this._trail.positions[i].time < startDate) {\n                    this._trail.positions.shift();\n                }\n            }\n\n            if(changeStart < 0) {\n                //add possitions to startDate\n                const positionsToReplace = Math.ceil(Math.abs(now - previousTime) / tick);\n                for(let positionIndex = 0; positionIndex < positionsToReplace; positionIndex++) {\n                    const time = new Date(previousTime - positionIndex * tick);\n                    const position = EoUtils.getOrbitPositionWithPositionalData(this._satrec, time).position;\n                    position.time = time.getTime();\n                    this._trail.positions = [position, ...this._trail.positions];\n                }\n            }\n        }\n        \n\n        //if end change\n        //update end\n        if(changeEnd) {\n            //change to future\n            if(changeEnd > 0) {\n                //change to future\n                const positionsToReplace = Math.ceil(Math.abs(endDate - previousEndTime) / tick);\n                for(let positionIndex = 0; positionIndex < positionsToReplace; positionIndex++) {\n                    const time = new Date(previousEndTime + positionIndex * tick);\n                    const position = EoUtils.getOrbitPositionWithPositionalData(this._satrec, time).position;\n                    position.time = time.getTime();\n                    this._trail.positions.push(position);\n                }\n            }\n\n            if(changeEnd < 0) {\n                //remove olded possitions than current endDate\n                let i = this._trail.positions.length - 1;\n                while (this._trail.positions[i].time > endDate) {\n                    this._trail.positions.pop();\n                    i = this._trail.positions.length - 1;\n                }\n            }\n        }\n        this._trail.positions = [...this._trail.positions];\n    }\n\n    populate() {\n        const startDate = this._currentStartTime.getTime();\n        const endDate = this._currentEndTime.getTime();\n        const timeWindow = endDate - startDate;\n        const tick = Math.floor(timeWindow / this._orbitPoints);\n\n        const positions = [];\n        for(let positionIndex = 0; positionIndex < this._orbitPoints; positionIndex++) {\n            const time = new Date(startDate + positionIndex * tick);\n            const position = EoUtils.getOrbitPositionWithPositionalData(this._satrec, time).position;\n            position.time = time.getTime();\n            positions.push(position);\n        }\n        this._trail.positions = [...positions];\n    }\n\n    /**\n     * Create the relevant shape which is used to display the orbit on the globe.\n     * @private\n     * @param attributes\n     */\n    trail(attributes) {\n        const trail = new Path([]);\n        trail.enabled = true;\n        trail.altitudeMode = ABSOLUTE;\n        trail.numSubSegments = 1;\n        trail.attributes = attributes;\n        return trail;\n    }\n\n    /**\n     * Create attributes for the proper visualization of the Orbit in more than one color.\n     * @private\n     * @param color\n     */\n    trailAttributes(color) {\n        const attributes = new ShapeAttributes(null);\n        attributes.outlineColor = color;\n        attributes.outlineWidth = 1;\n        attributes.drawOutline = true;\n        attributes.drawInterior = false;\n        return attributes;\n    }\n}\n\nexport default Orbits;","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nimport Orbit from './utils/Orbit';\nconst {\n    RenderableLayer,\n    Color\n} = WorldWind;\n\nconst {\n    EoUtils,\n} = WordWindX;\n\n/**\n * Class extending WorldWind.RenderableLayer. It`s possible to set time of orbit.\n * @param options {Object}\n * @param options.key {String}\n * @param options.time {Date} Selected time\n * @param options.currentTime {Date} \n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass OrbitLayer extends RenderableLayer {\n\tconstructor(options) {\n        super(options);\n        this._rerenderMap = null;\n        this.satRec = null;\n        this.key = options.key;\n        this.timeWindow = 90 * 60 * 1000; //90 minutes\n        this._beforeCurrentOrbit = new Orbit(EoUtils.computeSatrec(...options.satRec), new Date(), new Date(), new Color(213 / 255, 214  / 255, 210 / 255, 1));\n        this._afterCurrentOrbit = new Orbit(EoUtils.computeSatrec(...options.satRec), new Date(), new Date(), new Color(1, 1, 0, 1));\n        this.addRenderable(this._beforeCurrentOrbit);\n        this.addRenderable(this._afterCurrentOrbit);\n        this.currentTime = null;\n        this.selectTime = null;\n        this.endTime = null;\n        this.endTime = null;\n        this.satRec = null;\n        this.setSatRec(options.satRec);\n        this.setTime(options.currentTime, options.time);\n    };\n\n    \n    /**\n     * @param {Array.<lte>} satRec  Lte.\n     */\n    setSatRec(satRec) {\n        if(satRec) {\n            this.satRec = satRec;\n            const satrec = EoUtils.computeSatrec(...satRec);\n            this._beforeCurrentOrbit.satrec(satrec);\n            this._beforeCurrentOrbit.update();\n            this._afterCurrentOrbit.satrec(satrec);\n            this._afterCurrentOrbit.update();\n            this.doRerender();\n        }\n    }\n\n    /**\n     * @param {Date} time Time of the orbit.\n     */\n    setTime(currentTime, selectTime) {\n        if(currentTime && selectTime) {\n            this.currentTime = currentTime;\n            this.selectTime = selectTime;\n\n            this.startTime = new Date(selectTime.getTime() - this.timeWindow);\n            this.endTime = new Date(selectTime.getTime() + this.timeWindow);\n\n            this.removeRenderable(this._beforeCurrentOrbit);\n            this.removeRenderable(this._afterCurrentOrbit);\n\n            if(currentTime.getTime() < this.startTime.getTime()) {\n                //all in future\n                this._afterCurrentOrbit.time(this.startTime, this.endTime);\n                this.addRenderable(this._afterCurrentOrbit);\n            } else if(this.startTime.getTime() < currentTime.getTime() && currentTime.getTime() < this.endTime.getTime()) {\n                //select time visible\n                this._beforeCurrentOrbit.time(this.startTime, currentTime);\n                this._afterCurrentOrbit.time(currentTime, this.endTime);\n                this.addRenderable(this._beforeCurrentOrbit);\n                this.addRenderable(this._afterCurrentOrbit);\n            } else if(currentTime.getTime() > this.endTime.getTime()) {\n                //all in past\n                this._beforeCurrentOrbit.time(this.startTime, this.endTime);\n                this.addRenderable(this._beforeCurrentOrbit);\n            }\n\n            this.doRerender();\n        }\n    }\n    \n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n\t}\n}\n\nexport default OrbitLayer;\n\n","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    Location,\r\n    Sector,\r\n    WmsLayer\r\n} = WorldWind;\r\n\r\nclass SentinelCloudlessLayer extends WmsLayer {\r\n    constructor(){\r\n        let url = 'https://tiles.maps.eox.at/wms';\r\n        if(window.location.host === 'dashboard.eoapps.eu') {\r\n            url = 'https://tiles.esa.maps.eox.at/wms'\r\n        }\r\n\r\n        super({\r\n            service: url,\r\n            layerNames: \"s2cloudless-2018\",\r\n            title: \"Sentinel Cloudless Layer\",\r\n            sector: new Sector(-90, 90, -180, 180),\r\n            levelZeroDelta: new Location(45, 45),\r\n            numLevels: 19,\r\n            format: \"image/jpg\",\r\n            opacity: 1,\r\n            size: 256,\r\n            version: \"1.3.0\"\r\n        });\r\n    }\r\n}\r\n\r\nexport default SentinelCloudlessLayer;","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    Location,\r\n    Sector,\r\n    WmsLayer\r\n} = WorldWind;\r\n\r\nclass SentinelTopologyLayer extends WmsLayer {\r\n    constructor(){\r\n        let url = 'https://tiles.maps.eox.at/wms';\r\n        if(window.location.host === 'dashboard.eoapps.eu') {\r\n            url = 'https://tiles.esa.maps.eox.at/wms'\r\n        }\r\n\r\n        super({\r\n            service: url,\r\n            layerNames: \"overlay\",\r\n            title: \"Overlay layer by EOX - 4326\",\r\n            sector: new Sector(-90, 90, -180, 180),\r\n            levelZeroDelta: new Location(45, 45),\r\n            numLevels: 19,\r\n            format: \"image/jpg\",\r\n            opacity: 1,\r\n            size: 256,\r\n            version: \"1.3.0\"\r\n        });\r\n    }\r\n}\r\n\r\nexport default SentinelTopologyLayer;","import toGeoJSON from './togeojson';\nimport WorldWind from 'webworldwind-esa';\n\nexport class AcquisitionPlansParser {\n\n    /**\n     * @alias AcquisitionPlansParser\n     * @constructor\n     * @param {Workers} workers \n     */\n    constructor(workers) {\n        if (!workers) {\n            throw (new Error('AcquisitionPlansParser - constructor - missing workers instance'));\n        }\n\n        this.workers = workers;\n\n        this.InteriorCtor = WorldWind ? WorldWind.SurfacePolygon : null;\n        this.OutlineCtor = WorldWind ? WorldWind.Path : null;\n        this.ShapeAttributesCtor = WorldWind ? WorldWind.ShapeAttributes : null;\n        this.PositionCtor = WorldWind ? WorldWind.Position : null;\n        this.ColorCtor = WorldWind ? WorldWind.Color : null;\n\n        /**\n         * @type {DOMParser|null}\n         */\n        this.domParser = null;\n\n        /**\n         * @type {Object}\n         */\n        this.shapeAttributesMap = Object.create(null);\n    }\n\n    /**\n     * Parses an acquisition plan kml file.\n     * Parsing will be attempted in a web worker and if that fails it will be attemped on the main thread.\n     * \n     * @param {{ satName: String, url: String, type: String, interior: Boolean, outline: Boolean, outlineAlpha: Number, interiorAlpha: Number, highlightAlpha: Number, filterDate: String }} fileInfo\n     * \n     * @param {String} fileInfo.satName The satellite name for the acquisition plan. The convention is to use the short name: \"s1a\", \"s2b\", \"s5p\", etc.\n     * @param {String} fileInfo.url The url for the acquisition plan file\n     * @param {String} fileInfo.type A type for the web workers. Default is \"downloadAndParseKmls\"\n     * @param {Boolean} fileInfo.interior A flag that indicates if interior renderables should be created. Default is true\n     * @param {Boolean} fileInfo.outline A flag that indicates if outline renderables should be created. Default is true\n     * @param {Number} fileInfo.outlineAlpha Alpha value fot the outline. Default is 1\n     * @param {Number} fileInfo.interiorAlpha Alpha value for the interior. Default is 0.2\n     * @param {Number} fileInfo.highlightAlpha Alpha value for the interior highlight. Default is 0.5\n     * @param {String} fileInfo.filterDate An ISODate string used for filtering out shapes that lees than this value. Default is the current date\n     * \n     * @param {Function} cb A callback function, will be called with error and entry params\n     */\n    parse(fileInfo, cb) {\n        fileInfo.type = fileInfo.type || 'downloadAndParseKmls';\n        fileInfo.filterDate = fileInfo.filterDate || new Date().toISOString();\n\n        this.workers.process(fileInfo, (err, result) => {\n            if (err) {\n                return cb(err);\n            }\n\n            const { shapes, satName, url } = result;\n            let parsedShapes;\n\n            if (typeof shapes === 'string') {\n                console.info('Worker unable to parse kml file', url);\n                try {\n                    parsedShapes = this.parseSync(shapes, satName, fileInfo.filterDate);\n                }\n                catch (error) {\n                    return cb(error);\n                }\n            }\n            else {\n                parsedShapes = shapes;\n            }\n\n            let outlines;\n            let interiors;\n            let interval;\n\n            try {\n                ({ outlines, interiors, interval } = this.makeRenderables(parsedShapes, fileInfo));\n            }\n            catch (error) {\n                return cb(error);\n            }\n\n            if ((outlines || interiors) && interval) {\n                return cb(null, this.formatOutput({ satName, url }, interval, outlines, interiors));\n            }\n        });\n    }\n\n    parseSync(kmlString, satName, filterDate) {\n        if (!this.domParser) {\n            this.domParser = new DOMParser();\n        }\n\n        const kmlDoc = this.domParser.parseFromString(kmlString, 'text/xml');\n        const geoJson = toGeoJSON.kml(kmlDoc);\n        let shapes = geoJson.features;\n\n        const isSentinel2 = satName.includes('s2');\n        const nowDate = new Date(filterDate);\n        shapes = shapes.filter(shape => {\n            const isInTheFuture = new Date(shape.properties.timespan.end) >= nowDate;\n\n            if (isSentinel2) {\n                return (\n                    isInTheFuture &&\n                    shape.properties.Mode === 'NOBS' &&\n                    shape.properties.Timeliness === 'NOMINAL'\n                );\n            }\n\n            return isInTheFuture;\n        });\n\n        return shapes;\n    }\n\n    makeRenderables(shapes, fileInfo) {\n        const outlines = [];\n        const interiors = [];\n\n        const interval = {\n            startDate: Number.MAX_SAFE_INTEGER,\n            endDate: Number.MIN_SAFE_INTEGER\n        };\n\n        for (let i = 0; i < shapes.length; i++) {\n            let shape = shapes[i];\n            let coords = shape.coordinates;\n            let color = shape.color;\n            let extendedData = shape.extendedData;\n\n            if (shape.geometry) {\n                coords = shape.geometry.coordinates[0];\n            }\n            if (shape.properties) {\n                color = shape.properties.lineColor;\n                extendedData = shape.properties;\n            }\n\n            let positions = this.makePositions(coords);\n\n            if (fileInfo.outline !== false) {\n                let pathAttributes = this.makePathAttributes(color, fileInfo.outlineAlpha);\n                let path = new this.OutlineCtor(positions, pathAttributes);\n                path.altitudeMode = 'clampToGround';\n                path.followTerrain = true;\n                path.expiryTime = Number.MAX_SAFE_INTEGER;\n                this.setTimeInterval(path, extendedData, interval);\n                path.kmlProps.satName = fileInfo.satName;\n                outlines.push(path);\n            }\n\n            if (fileInfo.interior !== false) {\n                let surfacePolygonAttributes = this.makeSurfacePolygonAttributes(color, fileInfo.interiorAlpha);\n                let surfacePolygon = new this.InteriorCtor(positions, surfacePolygonAttributes);\n                surfacePolygon.highlightAttributes = this.makeSurfacePolygonHighlightAttributes(color, fileInfo.highlightAlpha);\n                this.setTimeInterval(surfacePolygon, extendedData, interval);\n                surfacePolygon.kmlProps.satName = fileInfo.satName;\n                interiors.push(surfacePolygon);\n            }\n        }\n\n        interval.startDate = new Date(interval.startDate);\n        interval.endDate = new Date(interval.endDate);\n\n        return {\n            outlines,\n            interiors,\n            interval,\n        };\n    }\n\n    makePositions(coords) {\n        const positions = [];\n\n        for (let i = 0, len = coords.length; i < len; i++) {\n            let coord = coords[i];\n            let pos = new this.PositionCtor(\n                coord[1] || coord.latitude,\n                coord[0] || coord.longitude,\n                coord[2] || 0\n            );\n            if (pos.longitude < -180) {\n                pos.longitude = pos.longitude + 360;\n            }\n            if (pos.longitude > 180) {\n                pos.longitude = pos.longitude - 360;\n            }\n            positions.push(pos);\n        }\n\n        return positions;\n    }\n\n    makePathAttributes(hexColor, alpha = 1) {\n        const key = hexColor + 'path';\n        \n        if (this.shapeAttributesMap[key]) {\n            return this.shapeAttributesMap[key];\n        }\n\n        const attributes =  new this.ShapeAttributesCtor(null);\n        attributes.drawOutline = true;\n        attributes.drawInterior = false;\n        attributes.outlineColor = this.makeColor(hexColor, alpha);\n\n        this.shapeAttributesMap[key] = attributes;\n\n        return attributes;\n    }\n\n    makeSurfacePolygonAttributes(props, alpha = 0.2) {\n        const hexColor = props.lineColor || props;\n        const key = hexColor + 'poly';\n\n        if (this.shapeAttributesMap[key]) {\n            return this.shapeAttributesMap[key];\n        }\n\n        const attributes = new this.ShapeAttributesCtor(null);\n        attributes.drawOutline = false;\n        attributes.drawInterior = true;\n        attributes.interiorColor = this.makeColor(hexColor, alpha);\n\n        this.shapeAttributesMap[key] = attributes;\n\n        return attributes;\n    }\n\n    makeSurfacePolygonHighlightAttributes(props, alpha = 0.5) {\n        const hexColor = props.lineColor || props;\n\n        const attributes = new this.ShapeAttributesCtor(null);\n        attributes.drawOutline = false;\n        attributes.drawInterior = true;\n        attributes.interiorColor = this.makeColor(hexColor, alpha);\n\n        return attributes;\n    }\n\n    makeColor(hexColor, alpha) {\n        const blue = hexColor.substring(2, 4);\n        const green = hexColor.substring(4, 6);\n        const red = hexColor.substring(6, 8);\n\n        const r = parseInt(red, 16) / 255;\n        const g = parseInt(green, 16) / 255;\n        const b = parseInt(blue, 16) / 255;\n\n        return new this.ColorCtor(r, g, b, alpha);\n    }\n\n    setTimeInterval(renderable, props, interval) {\n        const startTime = this.dateStringToUTC(props.ObservationTimeStart || props.timespan.begin);\n        const endTime = this.dateStringToUTC(props.ObservationTimeStop || props.timespan.end);\n        const startTimeMs = (new Date(startTime)).getTime();\n        const endTimeMs = (new Date(endTime)).getTime();\n\n        if (interval.startDate > startTimeMs) {\n            interval.startDate = startTimeMs;\n        }\n        if (interval.endDate < endTimeMs) {\n            interval.endDate = endTimeMs;\n        }\n\n        renderable.kmlProps = props;\n        renderable.kmlProps.startDate = new Date(startTimeMs);\n        renderable.kmlProps.endDate = new Date(endTimeMs);\n        renderable.type = 'acqPlan';\n    }\n\n    dateStringToUTC(dateString) {\n        const lastChar = dateString[dateString.length - 1];\n        if (lastChar.toLowerCase() !== 'z') {\n            return dateString + 'Z';\n        }\n        return dateString;\n    }\n\n    formatOutput(fileInfo, interval, outlines = [], interiors = []) {\n        return {\n            url: fileInfo.url,\n            satName: fileInfo.satName,\n            outlines: outlines,\n            interiors: interiors,\n            startDate: interval.startDate,\n            endDate: interval.endDate,\n        };\n    }\n\n}","/*\n * @license\n * Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.\n * Copyright 2014, Google Inc. All Rights Reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to\n * deal in the Software without restriction, including without limitation the\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n * sell copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice including the dates of first publication and\n * either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/\n * shall be included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n * SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR\n * IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n *\n * Original Code. The Original Code is: OpenGL Sample Implementation,\n * Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,\n * Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.\n * Copyright in any portions created by third parties is as indicated\n * elsewhere herein. All Rights Reserved.\n */\n/*\n * @author ericv@cs.stanford.edu (Eric Veach)\n * @author bckenny@google.com (Brendan Kenny)\n */\n\n/*\n * Base namespace.\n * @const\n */\nvar libtess = {};\n\n/**\n * Whether to run asserts and extra debug checks.\n * @define {boolean}\n */\nlibtess.DEBUG = false;\n\n/**\n * Checks if the condition evaluates to true if libtess.DEBUG is true.\n * @param {*} condition The condition to check.\n * @param {string=} opt_message Error message in case of failure.\n * @throws {Error} Assertion failed, the condition evaluates to false.\n */\nlibtess.assert = function(condition, opt_message) {\n  if (libtess.DEBUG && !condition) {\n    throw new Error('Assertion failed' +\n        (opt_message ? ': ' + opt_message : ''));\n  }\n};\n\n/**\n * The maximum vertex coordinate size, 1e150. Anything larger will trigger a\n * GLU_TESS_COORD_TOO_LARGE error callback and the vertex will be clamped to\n * this value for all tessellation calculations.\n * @const {number}\n */\nlibtess.GLU_TESS_MAX_COORD = 1e150;\n// NOTE(bckenny): value from glu.pl generator\n\n/**\n * Normally the polygon is projected to a plane perpendicular to one of the\n * three coordinate axes before tessellating in 2d. This helps numerical\n * accuracy by forgoing a transformation step by simply dropping one coordinate\n * dimension.\n *\n * However, this can affect the placement of intersection points for non-axis-\n * aligned polygons. Setting TRUE_PROJECT to true will instead project onto a\n * plane actually perpendicular to the polygon's normal.\n *\n * NOTE(bckenny): I can find no instances on the internet in which this mode has\n * been used, but it's difficult to search for. This was a compile-time setting\n * in the original, so setting this as constant. If this is exposed in the\n * public API, remove the ignore coverage directives on\n * libtess.normal.projectPolygon and libtess.normal.normalize_.\n * @const {boolean}\n */\nlibtess.TRUE_PROJECT = false;\n\n/**\n * We cache vertex data for single-contour polygons so that we can try a\n * quick-and-dirty decomposition first.\n * @const {number}\n */\nlibtess.TESS_MAX_CACHE = 100;\n\n/**\n * The default tolerance for merging features, 0, meaning vertices are only\n * merged if they are exactly coincident\n * If a higher tolerance is needed, significant rewriting will need to occur.\n * See libtess.sweep.TOLERANCE_NONZERO_ as a starting place.\n * @const {number}\n */\nlibtess.GLU_TESS_DEFAULT_TOLERANCE = 0;\n\n/**\n * The input contours parition the plane into regions. A winding\n * rule determines which of these regions are inside the polygon.\n *\n * For a single contour C, the winding number of a point x is simply\n * the signed number of revolutions we make around x as we travel\n * once around C (where CCW is positive). When there are several\n * contours, the individual winding numbers are summed. This\n * procedure associates a signed integer value with each point x in\n * the plane. Note that the winding number is the same for all\n * points in a single region.\n *\n * The winding rule classifies a region as \"inside\" if its winding\n * number belongs to the chosen category (odd, nonzero, positive,\n * negative, or absolute value of at least two). The current GLU\n * tesselator implements the \"odd\" rule. The \"nonzero\" rule is another\n * common way to define the interior. The other three rules are\n * useful for polygon CSG operations.\n * @enum {number}\n */\nlibtess.windingRule = {\n  // NOTE(bckenny): values from enumglu.spec\n  GLU_TESS_WINDING_ODD: 100130,\n  GLU_TESS_WINDING_NONZERO: 100131,\n  GLU_TESS_WINDING_POSITIVE: 100132,\n  GLU_TESS_WINDING_NEGATIVE: 100133,\n  GLU_TESS_WINDING_ABS_GEQ_TWO: 100134\n};\n\n/**\n * The type of primitive return from a \"begin\" callback. GL_LINE_LOOP is only\n * returned when GLU_TESS_BOUNDARY_ONLY is true. GL_TRIANGLE_STRIP and\n * GL_TRIANGLE_FAN are no longer returned since 1.1.0 (see release notes).\n * @enum {number}\n */\nlibtess.primitiveType = {\n  GL_LINE_LOOP: 2,\n  GL_TRIANGLES: 4,\n  GL_TRIANGLE_STRIP: 5,\n  GL_TRIANGLE_FAN: 6\n};\n\n/**\n * The types of errors provided in the error callback.\n * @enum {number}\n */\nlibtess.errorType = {\n  // TODO(bckenny) doc types\n  // NOTE(bckenny): values from enumglu.spec\n  GLU_TESS_MISSING_BEGIN_POLYGON: 100151,\n  GLU_TESS_MISSING_END_POLYGON: 100153,\n  GLU_TESS_MISSING_BEGIN_CONTOUR: 100152,\n  GLU_TESS_MISSING_END_CONTOUR: 100154,\n  GLU_TESS_COORD_TOO_LARGE: 100155,\n  GLU_TESS_NEED_COMBINE_CALLBACK: 100156\n};\n\n/**\n * Enum values necessary for providing settings and callbacks. See the readme\n * for details.\n * @enum {number}\n */\nlibtess.gluEnum = {\n  // TODO(bckenny): rename so not always typing libtess.gluEnum.*?\n\n  // NOTE(bckenny): values from enumglu.spec\n  GLU_TESS_BEGIN: 100100,\n  GLU_TESS_VERTEX: 100101,\n  GLU_TESS_END: 100102,\n  GLU_TESS_ERROR: 100103,\n  GLU_TESS_EDGE_FLAG: 100104,\n  GLU_TESS_COMBINE: 100105,\n  GLU_TESS_BEGIN_DATA: 100106,\n  GLU_TESS_VERTEX_DATA: 100107,\n  GLU_TESS_END_DATA: 100108,\n  GLU_TESS_ERROR_DATA: 100109,\n  GLU_TESS_EDGE_FLAG_DATA: 100110,\n  GLU_TESS_COMBINE_DATA: 100111,\n\n  GLU_TESS_MESH: 100112,  //  NOTE(bckenny): from tess.c\n  GLU_TESS_TOLERANCE: 100142,\n  GLU_TESS_WINDING_RULE: 100140,\n  GLU_TESS_BOUNDARY_ONLY: 100141,\n\n  // TODO(bckenny): move this to libtess.errorType?\n  GLU_INVALID_ENUM: 100900,\n  GLU_INVALID_VALUE: 100901\n};\n\n/** @typedef {number} */\n//libtess.PQHandle;\n\n// TODO(bckenny): better typing on key?\n/** @typedef {Object} */\n//libtess.PQKey;\n\n\n/* global libtess */\n\n/** @const */\nlibtess.geom = {};\n\n/**\n * Returns whether vertex u and vertex v are equal.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @return {boolean}\n */\nlibtess.geom.vertEq = function(u, v) {\n  return u.s === v.s && u.t === v.t;\n};\n\n/**\n * Returns whether vertex u is lexicographically less than or equal to vertex v.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @return {boolean}\n */\nlibtess.geom.vertLeq = function(u, v) {\n  return (u.s < v.s) || (u.s === v.s && u.t <= v.t);\n};\n\n/**\n * Given three vertices u,v,w such that geom.vertLeq(u,v) && geom.vertLeq(v,w),\n * evaluates the t-coord of the edge uw at the s-coord of the vertex v.\n * Returns v.t - (uw)(v.s), ie. the signed distance from uw to v.\n * If uw is vertical (and thus passes thru v), the result is zero.\n *\n * The calculation is extremely accurate and stable, even when v\n * is very close to u or w.  In particular if we set v.t = 0 and\n * let r be the negated result (this evaluates (uw)(v.s)), then\n * r is guaranteed to satisfy MIN(u.t,w.t) <= r <= MAX(u.t,w.t).\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @param {libtess.GluVertex} w\n * @return {number}\n */\nlibtess.geom.edgeEval = function(u, v, w) {\n\n  var gapL = v.s - u.s;\n  var gapR = w.s - v.s;\n\n  if (gapL + gapR > 0) {\n    if (gapL < gapR) {\n      return (v.t - u.t) + (u.t - w.t) * (gapL / (gapL + gapR));\n    } else {\n      return (v.t - w.t) + (w.t - u.t) * (gapR / (gapL + gapR));\n    }\n  }\n\n  // vertical line\n  return 0;\n};\n\n/**\n * Returns a number whose sign matches geom.edgeEval(u,v,w) but which\n * is cheaper to evaluate.  Returns > 0, == 0 , or < 0\n * as v is above, on, or below the edge uw.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @param {libtess.GluVertex} w\n * @return {number}\n */\nlibtess.geom.edgeSign = function(u, v, w) {\n\n  var gapL = v.s - u.s;\n  var gapR = w.s - v.s;\n\n  if (gapL + gapR > 0) {\n    return (v.t - w.t) * gapL + (v.t - u.t) * gapR;\n  }\n\n  // vertical line\n  return 0;\n};\n\n/**\n * Version of VertLeq with s and t transposed.\n * Returns whether vertex u is lexicographically less than or equal to vertex v.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @return {boolean}\n */\nlibtess.geom.transLeq = function(u, v) {\n  return (u.t < v.t) || (u.t === v.t && u.s <= v.s);\n};\n\n/**\n * Version of geom.edgeEval with s and t transposed.\n * Given three vertices u,v,w such that geom.transLeq(u,v) &&\n * geom.transLeq(v,w), evaluates the t-coord of the edge uw at the s-coord of\n * the vertex v. Returns v.s - (uw)(v.t), ie. the signed distance from uw to v.\n * If uw is vertical (and thus passes thru v), the result is zero.\n *\n * The calculation is extremely accurate and stable, even when v\n * is very close to u or w.  In particular if we set v.s = 0 and\n * let r be the negated result (this evaluates (uw)(v.t)), then\n * r is guaranteed to satisfy MIN(u.s,w.s) <= r <= MAX(u.s,w.s).\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @param {libtess.GluVertex} w\n * @return {number}\n */\nlibtess.geom.transEval = function(u, v, w) {\n\n  var gapL = v.t - u.t;\n  var gapR = w.t - v.t;\n\n  if (gapL + gapR > 0) {\n    if (gapL < gapR) {\n      return (v.s - u.s) + (u.s - w.s) * (gapL / (gapL + gapR));\n    } else {\n      return (v.s - w.s) + (w.s - u.s) * (gapR / (gapL + gapR));\n    }\n  }\n\n  // vertical line\n  return 0;\n};\n\n/**\n * Version of geom.edgeSign with s and t transposed.\n * Returns a number whose sign matches geom.transEval(u,v,w) but which\n * is cheaper to evaluate.  Returns > 0, == 0 , or < 0\n * as v is above, on, or below the edge uw.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @param {libtess.GluVertex} w\n * @return {number}\n */\nlibtess.geom.transSign = function(u, v, w) {\n\n  var gapL = v.t - u.t;\n  var gapR = w.t - v.t;\n\n  if (gapL + gapR > 0) {\n    return (v.s - w.s) * gapL + (v.s - u.s) * gapR;\n  }\n\n  // vertical line\n  return 0;\n};\n\n/**\n * Returns whether edge is directed from right to left.\n * @param {libtess.GluHalfEdge} e\n * @return {boolean}\n */\nlibtess.geom.edgeGoesLeft = function(e) {\n  return libtess.geom.vertLeq(e.dst(), e.org);\n};\n\n/**\n * Returns whether edge is directed from left to right.\n * @param {libtess.GluHalfEdge} e\n * @return {boolean}\n */\nlibtess.geom.edgeGoesRight = function(e) {\n  return libtess.geom.vertLeq(e.org, e.dst());\n};\n\n/**\n * Calculates the L1 distance between vertices u and v.\n * @param {libtess.GluVertex} u\n * @param {libtess.GluVertex} v\n * @return {number}\n */\nlibtess.geom.vertL1dist = function(u, v) {\n  return Math.abs(u.s - v.s) + Math.abs(u.t - v.t);\n};\n\n// NOTE(bckenny): vertCCW is called nowhere in libtess and isn't part of the\n// public API.\n/* istanbul ignore next */\n/**\n * For almost-degenerate situations, the results are not reliable.\n * Unless the floating-point arithmetic can be performed without\n * rounding errors, *any* implementation will give incorrect results\n * on some degenerate inputs, so the client must have some way to\n * handle this situation.\n * @param {!libtess.GluVertex} u\n * @param {!libtess.GluVertex} v\n * @param {!libtess.GluVertex} w\n * @return {boolean}\n */\nlibtess.geom.vertCCW = function(u, v, w) {\n  return (u.s * (v.t - w.t) + v.s * (w.t - u.t) + w.s * (u.t - v.t)) >= 0;\n};\n\n/**\n * Given parameters a,x,b,y returns the value (b*x+a*y)/(a+b),\n * or (x+y)/2 if a==b==0. It requires that a,b >= 0, and enforces\n * this in the rare case that one argument is slightly negative.\n * The implementation is extremely stable numerically.\n * In particular it guarantees that the result r satisfies\n * MIN(x,y) <= r <= MAX(x,y), and the results are very accurate\n * even when a and b differ greatly in magnitude.\n * @private\n * @param {number} a\n * @param {number} x\n * @param {number} b\n * @param {number} y\n * @return {number}\n */\nlibtess.geom.interpolate_ = function(a, x, b, y) {\n  // from Macro RealInterpolate:\n  //(a = (a < 0) ? 0 : a, b = (b < 0) ? 0 : b, ((a <= b) ? ((b == 0) ? ((x+y) / 2) : (x + (y-x) * (a/(a+b)))) : (y + (x-y) * (b/(a+b)))))\n  a = (a < 0) ? 0 : a;\n  b = (b < 0) ? 0 : b;\n\n  if (a <= b) {\n    if (b === 0) {\n      return (x + y) / 2;\n    } else {\n      return x + (y - x) * (a / (a + b));\n    }\n  } else {\n    return y + (x - y) * (b / (a + b));\n  }\n};\n\n/**\n * Given edges (o1,d1) and (o2,d2), compute their point of intersection.\n * The computed point is guaranteed to lie in the intersection of the\n * bounding rectangles defined by each edge.\n * @param {!libtess.GluVertex} o1\n * @param {!libtess.GluVertex} d1\n * @param {!libtess.GluVertex} o2\n * @param {!libtess.GluVertex} d2\n * @param {!libtess.GluVertex} v\n */\nlibtess.geom.edgeIntersect = function(o1, d1, o2, d2, v) {\n  // This is certainly not the most efficient way to find the intersection\n  // of two line segments, but it is very numerically stable.\n\n  // Strategy: find the two middle vertices in the VertLeq ordering,\n  // and interpolate the intersection s-value from these. Then repeat\n  // using the TransLeq ordering to find the intersection t-value.\n  var z1;\n  var z2;\n  var tmp;\n  if (!libtess.geom.vertLeq(o1, d1)) {\n    // Swap(o1, d1);\n    tmp = o1;\n    o1 = d1;\n    d1 = tmp;\n  }\n  if (!libtess.geom.vertLeq(o2, d2)) {\n    // Swap(o2, d2);\n    tmp = o2;\n    o2 = d2;\n    d2 = tmp;\n  }\n  if (!libtess.geom.vertLeq(o1, o2)) {\n    // Swap(o1, o2);\n    tmp = o1;\n    o1 = o2;\n    o2 = tmp;\n    // Swap(d1, d2);\n    tmp = d1;\n    d1 = d2;\n    d2 = tmp;\n  }\n\n  if (!libtess.geom.vertLeq(o2, d1)) {\n    // Technically, no intersection -- do our best\n    v.s = (o2.s + d1.s) / 2;\n\n  } else if (libtess.geom.vertLeq(d1, d2)) {\n    // Interpolate between o2 and d1\n    z1 = libtess.geom.edgeEval(o1, o2, d1);\n    z2 = libtess.geom.edgeEval(o2, d1, d2);\n    if (z1 + z2 < 0) { z1 = -z1; z2 = -z2; }\n    v.s = libtess.geom.interpolate_(z1, o2.s, z2, d1.s);\n\n  } else {\n    // Interpolate between o2 and d2\n    z1 = libtess.geom.edgeSign(o1, o2, d1);\n    z2 = -libtess.geom.edgeSign(o1, d2, d1);\n    if (z1 + z2 < 0) { z1 = -z1; z2 = -z2; }\n    v.s = libtess.geom.interpolate_(z1, o2.s, z2, d2.s);\n  }\n\n  // Now repeat the process for t\n  if (!libtess.geom.transLeq(o1, d1)) {\n    // Swap(o1, d1);\n    tmp = o1;\n    o1 = d1;\n    d1 = tmp;\n  }\n  if (!libtess.geom.transLeq(o2, d2)) {\n    // Swap(o2, d2);\n    tmp = o2;\n    o2 = d2;\n    d2 = tmp;\n  }\n  if (!libtess.geom.transLeq(o1, o2)) {\n    // Swap(o1, o2);\n    tmp = o1;\n    o1 = o2;\n    o2 = tmp;\n    // Swap(d1, d2);\n    tmp = d1;\n    d1 = d2;\n    d2 = tmp;\n  }\n\n  if (!libtess.geom.transLeq(o2, d1)) {\n    // Technically, no intersection -- do our best\n    v.t = (o2.t + d1.t) / 2;\n\n  } else if (libtess.geom.transLeq(d1, d2)) {\n    // Interpolate between o2 and d1\n    z1 = libtess.geom.transEval(o1, o2, d1);\n    z2 = libtess.geom.transEval(o2, d1, d2);\n    if (z1 + z2 < 0) { z1 = -z1; z2 = -z2; }\n    v.t = libtess.geom.interpolate_(z1, o2.t, z2, d1.t);\n\n  } else {\n    // Interpolate between o2 and d2\n    z1 = libtess.geom.transSign(o1, o2, d1);\n    z2 = -libtess.geom.transSign(o1, d2, d1);\n    if (z1 + z2 < 0) { z1 = -z1; z2 = -z2; }\n    v.t = libtess.geom.interpolate_(z1, o2.t, z2, d2.t);\n  }\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): could maybe merge GluMesh and mesh.js since these are\n// operations on the mesh\n\n/** @const */\nlibtess.mesh = {};\n\n/****************** Basic Edge Operations **********************/\n\n\n/**\n * makeEdge creates one edge, two vertices, and a loop (face).\n * The loop consists of the two new half-edges.\n *\n * @param {libtess.GluMesh} mesh [description].\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.makeEdge = function(mesh) {\n  // TODO(bckenny): probably move to GluMesh, but needs Make* methods with it\n\n  var e = libtess.mesh.makeEdgePair_(mesh.eHead);\n\n  // complete edge with vertices and face (see mesh.makeEdgePair_)\n  libtess.mesh.makeVertex_(e, mesh.vHead);\n  libtess.mesh.makeVertex_(e.sym, mesh.vHead);\n  libtess.mesh.makeFace_(e, mesh.fHead);\n\n  return e;\n};\n\n\n/**\n * meshSplice(eOrg, eDst) is the basic operation for changing the\n * mesh connectivity and topology. It changes the mesh so that\n *  eOrg.oNext <- OLD( eDst.oNext )\n *  eDst.oNext <- OLD( eOrg.oNext )\n * where OLD(...) means the value before the meshSplice operation.\n *\n * This can have two effects on the vertex structure:\n *  - if eOrg.org != eDst.org, the two vertices are merged together\n *  - if eOrg.org == eDst.org, the origin is split into two vertices\n * In both cases, eDst.org is changed and eOrg.org is untouched.\n *\n * Similarly (and independently) for the face structure,\n *  - if eOrg.lFace == eDst.lFace, one loop is split into two\n *  - if eOrg.lFace != eDst.lFace, two distinct loops are joined into one\n * In both cases, eDst.lFace is changed and eOrg.lFace is unaffected.\n *\n * Some special cases:\n * If eDst == eOrg, the operation has no effect.\n * If eDst == eOrg.lNext, the new face will have a single edge.\n * If eDst == eOrg.lPrev(), the old face will have a single edge.\n * If eDst == eOrg.oNext, the new vertex will have a single edge.\n * If eDst == eOrg.oPrev(), the old vertex will have a single edge.\n *\n * @param {libtess.GluHalfEdge} eOrg [description].\n * @param {libtess.GluHalfEdge} eDst [description].\n */\nlibtess.mesh.meshSplice = function(eOrg, eDst) {\n  // TODO: more descriptive name?\n\n  var joiningLoops = false;\n  var joiningVertices = false;\n\n  if (eOrg === eDst) {\n    return;\n  }\n\n  if (eDst.org !== eOrg.org) {\n    // We are merging two disjoint vertices -- destroy eDst.org\n    joiningVertices = true;\n    libtess.mesh.killVertex_(eDst.org, eOrg.org);\n  }\n\n  if (eDst.lFace !== eOrg.lFace) {\n    // We are connecting two disjoint loops -- destroy eDst.lFace\n    joiningLoops = true;\n    libtess.mesh.killFace_(eDst.lFace, eOrg.lFace);\n  }\n\n  // Change the edge structure\n  libtess.mesh.splice_(eDst, eOrg);\n\n  if (!joiningVertices) {\n    // We split one vertex into two -- the new vertex is eDst.org.\n    // Make sure the old vertex points to a valid half-edge.\n    libtess.mesh.makeVertex_(eDst, eOrg.org);\n    eOrg.org.anEdge = eOrg;\n  }\n\n  if (!joiningLoops) {\n    // We split one loop into two -- the new loop is eDst.lFace.\n    // Make sure the old face points to a valid half-edge.\n    libtess.mesh.makeFace_(eDst, eOrg.lFace);\n    eOrg.lFace.anEdge = eOrg;\n  }\n};\n\n\n/**\n * deleteEdge(eDel) removes the edge eDel. There are several cases:\n * if (eDel.lFace != eDel.rFace()), we join two loops into one; the loop\n * eDel.lFace is deleted. Otherwise, we are splitting one loop into two;\n * the newly created loop will contain eDel.dst(). If the deletion of eDel\n * would create isolated vertices, those are deleted as well.\n *\n * This function could be implemented as two calls to __gl_meshSplice\n * plus a few calls to memFree, but this would allocate and delete\n * unnecessary vertices and faces.\n *\n * @param {libtess.GluHalfEdge} eDel [description].\n */\nlibtess.mesh.deleteEdge = function(eDel) {\n  var eDelSym = eDel.sym;\n  var joiningLoops = false;\n\n  // First step: disconnect the origin vertex eDel.org.  We make all\n  // changes to get a consistent mesh in this \"intermediate\" state.\n  if (eDel.lFace !== eDel.rFace()) {\n    // We are joining two loops into one -- remove the left face\n    joiningLoops = true;\n    libtess.mesh.killFace_(eDel.lFace, eDel.rFace());\n  }\n\n  if (eDel.oNext === eDel) {\n    libtess.mesh.killVertex_(eDel.org, null);\n\n  } else {\n    // Make sure that eDel.org and eDel.rFace() point to valid half-edges\n    eDel.rFace().anEdge = eDel.oPrev();\n    eDel.org.anEdge = eDel.oNext;\n\n    libtess.mesh.splice_(eDel, eDel.oPrev());\n\n    if (!joiningLoops) {\n      // We are splitting one loop into two -- create a new loop for eDel.\n      libtess.mesh.makeFace_(eDel, eDel.lFace);\n    }\n  }\n\n  // Claim: the mesh is now in a consistent state, except that eDel.org\n  // may have been deleted.  Now we disconnect eDel.dst().\n  if (eDelSym.oNext === eDelSym) {\n    libtess.mesh.killVertex_(eDelSym.org, null);\n    libtess.mesh.killFace_(eDelSym.lFace, null);\n\n  } else {\n    // Make sure that eDel.dst() and eDel.lFace point to valid half-edges\n    eDel.lFace.anEdge = eDelSym.oPrev();\n    eDelSym.org.anEdge = eDelSym.oNext;\n    libtess.mesh.splice_(eDelSym, eDelSym.oPrev());\n  }\n\n  // Any isolated vertices or faces have already been freed.\n  libtess.mesh.killEdge_(eDel);\n};\n\n/******************** Other Edge Operations **********************/\n\n/* All these routines can be implemented with the basic edge\n * operations above.  They are provided for convenience and efficiency.\n */\n\n\n/**\n * addEdgeVertex(eOrg) creates a new edge eNew such that\n * eNew == eOrg.lNext, and eNew.dst() is a newly created vertex.\n * eOrg and eNew will have the same left face.\n *\n * @param {libtess.GluHalfEdge} eOrg [description].\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.addEdgeVertex = function(eOrg) {\n  // TODO(bckenny): why is it named this?\n\n  var eNew = libtess.mesh.makeEdgePair_(eOrg);\n  var eNewSym = eNew.sym;\n\n  // Connect the new edge appropriately\n  libtess.mesh.splice_(eNew, eOrg.lNext);\n\n  // Set the vertex and face information\n  eNew.org = eOrg.dst();\n\n  libtess.mesh.makeVertex_(eNewSym, eNew.org);\n\n  eNew.lFace = eNewSym.lFace = eOrg.lFace;\n\n  return eNew;\n};\n\n\n/**\n * splitEdge(eOrg) splits eOrg into two edges eOrg and eNew,\n * such that eNew == eOrg.lNext. The new vertex is eOrg.dst() == eNew.org.\n * eOrg and eNew will have the same left face.\n *\n * @param {libtess.GluHalfEdge} eOrg [description].\n * @return {!libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.splitEdge = function(eOrg) {\n  var tempHalfEdge = libtess.mesh.addEdgeVertex(eOrg);\n  var eNew = tempHalfEdge.sym;\n\n  // Disconnect eOrg from eOrg.dst() and connect it to eNew.org\n  libtess.mesh.splice_(eOrg.sym, eOrg.sym.oPrev());\n  libtess.mesh.splice_(eOrg.sym, eNew);\n\n  // Set the vertex and face information\n  eOrg.sym.org = eNew.org; // NOTE(bckenny): assignment to dst\n  eNew.dst().anEdge = eNew.sym;  // may have pointed to eOrg.sym\n  eNew.sym.lFace = eOrg.rFace(); // NOTE(bckenny): assignment to rFace\n  eNew.winding = eOrg.winding;  // copy old winding information\n  eNew.sym.winding = eOrg.sym.winding;\n\n  return eNew;\n};\n\n\n/**\n * connect(eOrg, eDst) creates a new edge from eOrg.dst()\n * to eDst.org, and returns the corresponding half-edge eNew.\n * If eOrg.lFace == eDst.lFace, this splits one loop into two,\n * and the newly created loop is eNew.lFace. Otherwise, two disjoint\n * loops are merged into one, and the loop eDst.lFace is destroyed.\n *\n * If (eOrg == eDst), the new face will have only two edges.\n * If (eOrg.lNext == eDst), the old face is reduced to a single edge.\n * If (eOrg.lNext.lNext == eDst), the old face is reduced to two edges.\n *\n * @param {libtess.GluHalfEdge} eOrg [description].\n * @param {libtess.GluHalfEdge} eDst [description].\n * @return {!libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.connect = function(eOrg, eDst) {\n  var joiningLoops = false;\n  var eNew = libtess.mesh.makeEdgePair_(eOrg);\n  var eNewSym = eNew.sym;\n\n  if (eDst.lFace !== eOrg.lFace) {\n    // We are connecting two disjoint loops -- destroy eDst.lFace\n    joiningLoops = true;\n    libtess.mesh.killFace_(eDst.lFace, eOrg.lFace);\n  }\n\n  // Connect the new edge appropriately\n  libtess.mesh.splice_(eNew, eOrg.lNext);\n  libtess.mesh.splice_(eNewSym, eDst);\n\n  // Set the vertex and face information\n  eNew.org = eOrg.dst();\n  eNewSym.org = eDst.org;\n  eNew.lFace = eNewSym.lFace = eOrg.lFace;\n\n  // Make sure the old face points to a valid half-edge\n  eOrg.lFace.anEdge = eNewSym;\n\n  if (!joiningLoops) {\n    // We split one loop into two -- the new loop is eNew.lFace\n    libtess.mesh.makeFace_(eNew, eOrg.lFace);\n  }\n  return eNew;\n};\n\n/******************** Other Operations **********************/\n\n\n/**\n * zapFace(fZap) destroys a face and removes it from the\n * global face list. All edges of fZap will have a null pointer as their\n * left face. Any edges which also have a null pointer as their right face\n * are deleted entirely (along with any isolated vertices this produces).\n * An entire mesh can be deleted by zapping its faces, one at a time,\n * in any order. Zapped faces cannot be used in further mesh operations!\n *\n * @param {libtess.GluFace} fZap [description].\n */\nlibtess.mesh.zapFace = function(fZap) {\n  var eStart = fZap.anEdge;\n\n  // walk around face, deleting edges whose right face is also NULL\n  var eNext = eStart.lNext;\n  var e;\n  do {\n    e = eNext;\n    eNext = e.lNext;\n\n    e.lFace = null;\n    if (e.rFace() === null) {\n      // delete the edge -- see mesh.deleteEdge above\n      if (e.oNext === e) {\n        libtess.mesh.killVertex_(e.org, null);\n\n      } else {\n        // Make sure that e.org points to a valid half-edge\n        e.org.anEdge = e.oNext;\n        libtess.mesh.splice_(e, e.oPrev());\n      }\n\n      var eSym = e.sym;\n\n      if (eSym.oNext === eSym) {\n        libtess.mesh.killVertex_(eSym.org, null);\n\n      } else {\n        // Make sure that eSym.org points to a valid half-edge\n        eSym.org.anEdge = eSym.oNext;\n        libtess.mesh.splice_(eSym, eSym.oPrev());\n      }\n      libtess.mesh.killEdge_(e);\n    }\n  } while (e !== eStart);\n\n  // delete from circular doubly-linked list\n  var fPrev = fZap.prev;\n  var fNext = fZap.next;\n  fNext.prev = fPrev;\n  fPrev.next = fNext;\n\n  // TODO(bckenny): memFree( fZap );\n  // TODO(bckenny): probably null at callsite\n};\n\n// TODO(bckenny): meshUnion isn't called within libtess and isn't part of the\n// public API. Could be useful if more mesh manipulation functions are exposed.\n/* istanbul ignore next */\n/**\n * meshUnion() forms the union of all structures in\n * both meshes, and returns the new mesh (the old meshes are destroyed).\n *\n * @param {!libtess.GluMesh} mesh1\n * @param {!libtess.GluMesh} mesh2\n * @return {!libtess.GluMesh}\n */\nlibtess.mesh.meshUnion = function(mesh1, mesh2) {\n  // TODO(bceknny): probably move to GluMesh method\n  var f1 = mesh1.fHead;\n  var v1 = mesh1.vHead;\n  var e1 = mesh1.eHead;\n\n  var f2 = mesh2.fHead;\n  var v2 = mesh2.vHead;\n  var e2 = mesh2.eHead;\n\n  // Add the faces, vertices, and edges of mesh2 to those of mesh1\n  if (f2.next !== f2) {\n    f1.prev.next = f2.next;\n    f2.next.prev = f1.prev;\n    f2.prev.next = f1;\n    f1.prev = f2.prev;\n  }\n\n  if (v2.next !== v2) {\n    v1.prev.next = v2.next;\n    v2.next.prev = v1.prev;\n    v2.prev.next = v1;\n    v1.prev = v2.prev;\n  }\n\n  if (e2.next !== e2) {\n    e1.sym.next.sym.next = e2.next;\n    e2.next.sym.next = e1.sym.next;\n    e2.sym.next.sym.next = e1;\n    e1.sym.next = e2.sym.next;\n  }\n\n  // TODO(bckenny): memFree(mesh2);\n  // TODO(bckenny): If function is kept, remove mesh2's data to enforce.\n  return mesh1;\n};\n\n\n/**\n * deleteMesh(mesh) will free all storage for any valid mesh.\n * @param {libtess.GluMesh} mesh [description].\n */\nlibtess.mesh.deleteMesh = function(mesh) {\n  // TODO(bckenny): unnecessary, I think.\n  // TODO(bckenny): might want to explicitly null at callsite\n  // lots of memFrees. see also DELETE_BY_ZAPPING\n};\n\n/************************ Utility Routines ************************/\n\n\n/**\n * Creates a new pair of half-edges which form their own loop.\n * No vertex or face structures are allocated, but these must be assigned\n * before the current edge operation is completed.\n *\n * TODO(bckenny): warning about eNext strictly being first of pair? (see code)\n *\n * @private\n * @param {libtess.GluHalfEdge} eNext [description].\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.mesh.makeEdgePair_ = function(eNext) {\n  var e = new libtess.GluHalfEdge();\n  var eSym = new libtess.GluHalfEdge();\n\n  // TODO(bckenny): how do we ensure this? see above comment in jsdoc\n  // Make sure eNext points to the first edge of the edge pair\n  // if (eNext->Sym < eNext ) { eNext = eNext->Sym; }\n\n  // NOTE(bckenny): check this for bugs in current implementation!\n\n  // Insert in circular doubly-linked list before eNext.\n  // Note that the prev pointer is stored in sym.next.\n  var ePrev = eNext.sym.next;\n  eSym.next = ePrev;\n  ePrev.sym.next = e;\n  e.next = eNext;\n  eNext.sym.next = eSym;\n\n  e.sym = eSym;\n  e.oNext = e;\n  e.lNext = eSym;\n\n  eSym.sym = e;\n  eSym.oNext = eSym;\n  eSym.lNext = e;\n\n  return e;\n};\n\n\n/**\n * splice_ is best described by the Guibas/Stolfi paper or the\n * CS348a notes. Basically, it modifies the mesh so that\n * a.oNext and b.oNext are exchanged. This can have various effects\n * depending on whether a and b belong to different face or vertex rings.\n * For more explanation see mesh.meshSplice below.\n *\n * @private\n * @param {libtess.GluHalfEdge} a [description].\n * @param {libtess.GluHalfEdge} b [description].\n */\nlibtess.mesh.splice_ = function(a, b) {\n  var aONext = a.oNext;\n  var bONext = b.oNext;\n\n  aONext.sym.lNext = b;\n  bONext.sym.lNext = a;\n  a.oNext = bONext;\n  b.oNext = aONext;\n};\n\n\n/**\n * makeVertex_(eOrig, vNext) attaches a new vertex and makes it the\n * origin of all edges in the vertex loop to which eOrig belongs. \"vNext\" gives\n * a place to insert the new vertex in the global vertex list.  We insert\n * the new vertex *before* vNext so that algorithms which walk the vertex\n * list will not see the newly created vertices.\n *\n * NOTE: unlike original, acutally allocates new vertex.\n *\n * @private\n * @param {libtess.GluHalfEdge} eOrig [description].\n * @param {libtess.GluVertex} vNext [description].\n */\nlibtess.mesh.makeVertex_ = function(eOrig, vNext) {\n  // insert in circular doubly-linked list before vNext\n  var vPrev = vNext.prev;\n  var vNew = new libtess.GluVertex(vNext, vPrev);\n  vPrev.next = vNew;\n  vNext.prev = vNew;\n\n  vNew.anEdge = eOrig;\n  // leave coords, s, t undefined\n  // TODO(bckenny): does above line mean 0 specifically, or does it matter?\n\n  // fix other edges on this vertex loop\n  var e = eOrig;\n  do {\n    e.org = vNew;\n    e = e.oNext;\n  } while (e !== eOrig);\n};\n\n\n/**\n * makeFace_(eOrig, fNext) attaches a new face and makes it the left\n * face of all edges in the face loop to which eOrig belongs. \"fNext\" gives\n * a place to insert the new face in the global face list.  We insert\n * the new face *before* fNext so that algorithms which walk the face\n * list will not see the newly created faces.\n *\n * NOTE: unlike original, acutally allocates new face.\n *\n * @private\n * @param {libtess.GluHalfEdge} eOrig [description].\n * @param {libtess.GluFace} fNext [description].\n */\nlibtess.mesh.makeFace_ = function(eOrig, fNext) {\n  // insert in circular doubly-linked list before fNext\n  var fPrev = fNext.prev;\n  var fNew = new libtess.GluFace(fNext, fPrev);\n  fPrev.next = fNew;\n  fNext.prev = fNew;\n\n  fNew.anEdge = eOrig;\n\n  // The new face is marked \"inside\" if the old one was.  This is a\n  // convenience for the common case where a face has been split in two.\n  fNew.inside = fNext.inside;\n\n  // fix other edges on this face loop\n  var e = eOrig;\n  do {\n    e.lFace = fNew;\n    e = e.lNext;\n  } while (e !== eOrig);\n};\n\n\n/**\n * killEdge_ destroys an edge (the half-edges eDel and eDel.sym),\n * and removes from the global edge list.\n *\n * @private\n * @param {libtess.GluHalfEdge} eDel [description].\n */\nlibtess.mesh.killEdge_ = function(eDel) {\n  // TODO(bckenny): in this case, no need to worry(?), but check when checking mesh.makeEdgePair_\n  // Half-edges are allocated in pairs, see EdgePair above\n  // if (eDel->Sym < eDel ) { eDel = eDel->Sym; }\n\n  // delete from circular doubly-linked list\n  var eNext = eDel.next;\n  var ePrev = eDel.sym.next;\n  eNext.sym.next = ePrev;\n  ePrev.sym.next = eNext;\n\n  // TODO(bckenny): memFree( eDel ); (which also frees eDel.sym)\n  // TODO(bckenny): need to null at callsites?\n};\n\n\n/**\n * killVertex_ destroys a vertex and removes it from the global\n * vertex list. It updates the vertex loop to point to a given new vertex.\n *\n * @private\n * @param {libtess.GluVertex} vDel [description].\n * @param {libtess.GluVertex} newOrg [description].\n */\nlibtess.mesh.killVertex_ = function(vDel, newOrg) {\n  var eStart = vDel.anEdge;\n\n  // change the origin of all affected edges\n  var e = eStart;\n  do {\n    e.org = newOrg;\n    e = e.oNext;\n  } while (e !== eStart);\n\n  // delete from circular doubly-linked list\n  var vPrev = vDel.prev;\n  var vNext = vDel.next;\n  vNext.prev = vPrev;\n  vPrev.next = vNext;\n\n  // TODO(bckenny): memFree( vDel );\n  // TODO(bckenny): need to null at callsites?\n};\n\n\n/**\n * killFace_ destroys a face and removes it from the global face\n * list. It updates the face loop to point to a given new face.\n *\n * @private\n * @param {libtess.GluFace} fDel [description].\n * @param {libtess.GluFace} newLFace [description].\n */\nlibtess.mesh.killFace_ = function(fDel, newLFace) {\n  var eStart = fDel.anEdge;\n\n  // change the left face of all affected edges\n  var e = eStart;\n  do {\n    e.lFace = newLFace;\n    e = e.lNext;\n  } while (e !== eStart);\n\n  // delete from circular doubly-linked list\n  var fPrev = fDel.prev;\n  var fNext = fDel.next;\n  fNext.prev = fPrev;\n  fPrev.next = fNext;\n\n  // TODO(bckenny): memFree( fDel );\n  // TODO(bckenny): need to null at callsites?\n};\n\n\n/* global libtess */\n\n/** @const */\nlibtess.normal = {};\n\n// TODO(bckenny): Integrate SLANTED_SWEEP somehow?\n/* The \"feature merging\" is not intended to be complete. There are\n * special cases where edges are nearly parallel to the sweep line\n * which are not implemented. The algorithm should still behave\n * robustly (ie. produce a reasonable tesselation) in the presence\n * of such edges, however it may miss features which could have been\n * merged. We could minimize this effect by choosing the sweep line\n * direction to be something unusual (ie. not parallel to one of the\n * coordinate axes).\n * #if defined(SLANTED_SWEEP)\n * #define S_UNIT_X  0.50941539564955385 // Pre-normalized\n * #define S_UNIT_Y  0.86052074622010633\n * #endif\n */\n\n/**\n * X coordinate of local basis for polygon projection.\n * @private\n * @const\n */\nlibtess.normal.S_UNIT_X_ = 1.0;\n\n/**\n * Y coordinate of local basis for polygon projection.\n * @private\n * @const\n */\nlibtess.normal.S_UNIT_Y_ = 0.0;\n\n/**\n * Determines a polygon normal and projects vertices onto the plane of the\n * polygon.\n * @param {!libtess.GluTesselator} tess\n */\nlibtess.normal.projectPolygon = function(tess) {\n  var computedNormal = false;\n\n  var norm = [\n    tess.normal[0],\n    tess.normal[1],\n    tess.normal[2]\n  ];\n  if (norm[0] === 0 && norm[1] === 0 && norm[2] === 0) {\n    libtess.normal.computeNormal_(tess, norm);\n    computedNormal = true;\n  }\n\n  var sUnit = tess.sUnit;\n  var tUnit = tess.tUnit;\n  var i = libtess.normal.longAxis_(norm);\n\n  // NOTE(bckenny): This branch is never taken. See comment on\n  // libtess.TRUE_PROJECT.\n  /* istanbul ignore if */\n  if (libtess.TRUE_PROJECT) {\n    // Choose the initial sUnit vector to be approximately perpendicular\n    // to the normal.\n    libtess.normal.normalize_(norm);\n\n    sUnit[i] = 0;\n    sUnit[(i + 1) % 3] = libtess.normal.S_UNIT_X_;\n    sUnit[(i + 2) % 3] = libtess.normal.S_UNIT_Y_;\n\n    // Now make it exactly perpendicular\n    var w = libtess.normal.dot_(sUnit, norm);\n    sUnit[0] -= w * norm[0];\n    sUnit[1] -= w * norm[1];\n    sUnit[2] -= w * norm[2];\n    libtess.normal.normalize_(sUnit);\n\n    // Choose tUnit so that (sUnit,tUnit,norm) form a right-handed frame\n    tUnit[0] = norm[1] * sUnit[2] - norm[2] * sUnit[1];\n    tUnit[1] = norm[2] * sUnit[0] - norm[0] * sUnit[2];\n    tUnit[2] = norm[0] * sUnit[1] - norm[1] * sUnit[0];\n    libtess.normal.normalize_(tUnit);\n\n  } else {\n    // Project perpendicular to a coordinate axis -- better numerically\n    sUnit[i] = 0;\n    sUnit[(i + 1) % 3] = libtess.normal.S_UNIT_X_;\n    sUnit[(i + 2) % 3] = libtess.normal.S_UNIT_Y_;\n\n    tUnit[i] = 0;\n    tUnit[(i + 1) % 3] = (norm[i] > 0) ?\n        -libtess.normal.S_UNIT_Y_ : libtess.normal.S_UNIT_Y_;\n    tUnit[(i + 2) % 3] = (norm[i] > 0) ?\n        libtess.normal.S_UNIT_X_ : -libtess.normal.S_UNIT_X_;\n  }\n\n  // Project the vertices onto the sweep plane\n  var vHead = tess.mesh.vHead;\n  for (var v = vHead.next; v !== vHead; v = v.next) {\n    v.s = libtess.normal.dot_(v.coords, sUnit);\n    v.t = libtess.normal.dot_(v.coords, tUnit);\n  }\n\n  if (computedNormal) {\n    libtess.normal.checkOrientation_(tess);\n  }\n};\n\n/**\n * Computes the dot product of vectors u and v.\n * @private\n * @param {!Array.<number>} u\n * @param {!Array.<number>} v\n * @return {number}\n */\nlibtess.normal.dot_ = function(u, v) {\n  return u[0] * v[0] + u[1] * v[1] + u[2] * v[2];\n};\n\n// NOTE(bckenny): only called from within libtess.normal.projectPolygon's\n// TRUE_PROJECT branch, so ignoring for code coverage.\n/* istanbul ignore next */\n/**\n * Normalize vector v.\n * @private\n * @param {!Array.<number>} v\n */\nlibtess.normal.normalize_ = function(v) {\n  var len = v[0] * v[0] + v[1] * v[1] + v[2] * v[2];\n\n  len = Math.sqrt(len);\n  v[0] /= len;\n  v[1] /= len;\n  v[2] /= len;\n};\n\n/**\n * Returns the index of the longest component of vector v.\n * @private\n * @param {!Array.<number>} v\n * @return {number}\n */\nlibtess.normal.longAxis_ = function(v) {\n  var i = 0;\n\n  if (Math.abs(v[1]) > Math.abs(v[0])) {\n    i = 1;\n  }\n  if (Math.abs(v[2]) > Math.abs(v[i])) {\n    i = 2;\n  }\n\n  return i;\n};\n\n/**\n * Compute an approximate normal of the polygon from the vertices themselves.\n * Result returned in norm.\n * @private\n * @param {!libtess.GluTesselator} tess\n * @param {!Array.<number>} norm\n */\nlibtess.normal.computeNormal_ = function(tess, norm) {\n  var maxVal = [\n    -2 * libtess.GLU_TESS_MAX_COORD,\n    -2 * libtess.GLU_TESS_MAX_COORD,\n    -2 * libtess.GLU_TESS_MAX_COORD\n  ];\n  var minVal = [\n    2 * libtess.GLU_TESS_MAX_COORD,\n    2 * libtess.GLU_TESS_MAX_COORD,\n    2 * libtess.GLU_TESS_MAX_COORD\n  ];\n  var maxVert = [];\n  var minVert = [];\n\n  var v;\n  var vHead = tess.mesh.vHead;\n  for (v = vHead.next; v !== vHead; v = v.next) {\n    for (var i = 0; i < 3; ++i) {\n      var c = v.coords[i];\n      if (c < minVal[i]) { minVal[i] = c; minVert[i] = v; }\n      if (c > maxVal[i]) { maxVal[i] = c; maxVert[i] = v; }\n    }\n  }\n\n  // Find two vertices separated by at least 1/sqrt(3) of the maximum\n  // distance between any two vertices\n  var index = 0;\n  if (maxVal[1] - minVal[1] > maxVal[0] - minVal[0]) { index = 1; }\n  if (maxVal[2] - minVal[2] > maxVal[index] - minVal[index]) { index = 2; }\n  if (minVal[index] >= maxVal[index]) {\n    // All vertices are the same -- normal doesn't matter\n    norm[0] = 0; norm[1] = 0; norm[2] = 1;\n    return;\n  }\n\n  // Look for a third vertex which forms the triangle with maximum area\n  // (Length of normal == twice the triangle area)\n  var maxLen2 = 0;\n  var v1 = minVert[index];\n  var v2 = maxVert[index];\n  var tNorm = [0, 0, 0];\n  var d1 = [\n    v1.coords[0] - v2.coords[0],\n    v1.coords[1] - v2.coords[1],\n    v1.coords[2] - v2.coords[2]\n  ];\n  var d2 = [0, 0, 0];\n  for (v = vHead.next; v !== vHead; v = v.next) {\n    d2[0] = v.coords[0] - v2.coords[0];\n    d2[1] = v.coords[1] - v2.coords[1];\n    d2[2] = v.coords[2] - v2.coords[2];\n    tNorm[0] = d1[1] * d2[2] - d1[2] * d2[1];\n    tNorm[1] = d1[2] * d2[0] - d1[0] * d2[2];\n    tNorm[2] = d1[0] * d2[1] - d1[1] * d2[0];\n    var tLen2 = tNorm[0] * tNorm[0] + tNorm[1] * tNorm[1] + tNorm[2] * tNorm[2];\n    if (tLen2 > maxLen2) {\n      maxLen2 = tLen2;\n      norm[0] = tNorm[0];\n      norm[1] = tNorm[1];\n      norm[2] = tNorm[2];\n    }\n  }\n\n  if (maxLen2 <= 0) {\n    // All points lie on a single line -- any decent normal will do\n    norm[0] = norm[1] = norm[2] = 0;\n    norm[libtess.normal.longAxis_(d1)] = 1;\n  }\n};\n\n/**\n * Check that the sum of the signed area of all projected contours is\n * non-negative. If not, negate the t-coordinates to reverse the orientation and\n * make it so.\n * @private\n * @param {!libtess.GluTesselator} tess\n */\nlibtess.normal.checkOrientation_ = function(tess) {\n  var area = 0;\n  var fHead = tess.mesh.fHead;\n  for (var f = fHead.next; f !== fHead; f = f.next) {\n    var e = f.anEdge;\n    if (e.winding <= 0) { continue; }\n    do {\n      area += (e.org.s - e.dst().s) * (e.org.t + e.dst().t);\n      e = e.lNext;\n    } while (e !== f.anEdge);\n  }\n\n  if (area < 0) {\n    // Reverse the orientation by flipping all the t-coordinates\n    var vHead = tess.mesh.vHead;\n    for (var v = vHead.next; v !== vHead; v = v.next) {\n      v.t = -v.t;\n    }\n    tess.tUnit[0] = -tess.tUnit[0];\n    tess.tUnit[1] = -tess.tUnit[1];\n    tess.tUnit[2] = -tess.tUnit[2];\n  }\n};\n\n\n/* global libtess */\n\n/** @const */\nlibtess.render = {};\n\n/**\n * Takes a mesh, breaks it into separate triangles, and renders them. The\n * rendering output is provided as callbacks (see the API). Set flagEdges to\n * true to get edgeFlag callbacks (tess.flagBoundary in original libtess).\n * @param {!libtess.GluTesselator} tess\n * @param {!libtess.GluMesh} mesh\n * @param {boolean} flagEdges\n */\nlibtess.render.renderMesh = function(tess, mesh, flagEdges) {\n  var beginOrBeginDataCalled = false;\n\n  // TODO(bckenny): edgeState needs to be boolean, but !== on first call\n  // force edge state output for first vertex\n  var edgeState = -1;\n\n  // We examine all faces in an arbitrary order. Whenever we find\n  // an inside triangle f, we render f.\n  // NOTE(bckenny): go backwards through face list to match original libtess\n  // triangle order\n  for (var f = mesh.fHead.prev; f !== mesh.fHead; f = f.prev) {\n    if (f.inside) {\n      // We're going to emit a triangle, so call begin callback once\n      if (!beginOrBeginDataCalled) {\n        tess.callBeginOrBeginData(libtess.primitiveType.GL_TRIANGLES);\n        beginOrBeginDataCalled = true;\n      }\n\n      // check that face has only three edges\n      var e = f.anEdge;\n      // Loop once for each edge (there will always be 3 edges)\n      do {\n        if (flagEdges) {\n          // Set the \"edge state\" to true just before we output the\n          // first vertex of each edge on the polygon boundary.\n          var newState = !e.rFace().inside ? 1 : 0; // TODO(bckenny): total hack to get edgeState working. fix me.\n          if (edgeState !== newState) {\n            edgeState = newState;\n            // TODO(bckenny): edgeState should be boolean now\n            tess.callEdgeFlagOrEdgeFlagData(!!edgeState);\n          }\n        }\n\n        // emit vertex\n        tess.callVertexOrVertexData(e.org.data);\n\n        e = e.lNext;\n      } while (e !== f.anEdge);\n    }\n  }\n\n  // only call end callback if begin was called\n  if (beginOrBeginDataCalled) {\n    tess.callEndOrEndData();\n  }\n};\n\n/**\n * Takes a mesh, and outputs one contour for each face marked \"inside\". The\n * rendering output is provided as callbacks (see the API).\n * @param {!libtess.GluTesselator} tess\n * @param {!libtess.GluMesh} mesh\n */\nlibtess.render.renderBoundary = function(tess, mesh) {\n  for (var f = mesh.fHead.next; f !== mesh.fHead; f = f.next) {\n    if (f.inside) {\n      tess.callBeginOrBeginData(libtess.primitiveType.GL_LINE_LOOP);\n\n      var e = f.anEdge;\n      do {\n        tess.callVertexOrVertexData(e.org.data);\n        e = e.lNext;\n      } while (e !== f.anEdge);\n\n      tess.callEndOrEndData();\n    }\n  }\n};\n\n\n/* global libtess */\n\n// TODO(bckenny): a number of these never return null (as opposed to original) and should be typed appropriately\n\n/*\n * Invariants for the Edge Dictionary.\n * - each pair of adjacent edges e2=succ(e1) satisfies edgeLeq_(e1,e2)\n *   at any valid location of the sweep event\n * - if edgeLeq_(e2,e1) as well (at any valid sweep event), then e1 and e2\n *   share a common endpoint\n * - for each e, e.dst() has been processed, but not e.org\n * - each edge e satisfies vertLeq(e.dst(),event) && vertLeq(event,e.org)\n *   where \"event\" is the current sweep line event.\n * - no edge e has zero length\n *\n * Invariants for the Mesh (the processed portion).\n * - the portion of the mesh left of the sweep line is a planar graph,\n *   ie. there is *some* way to embed it in the plane\n * - no processed edge has zero length\n * - no two processed vertices have identical coordinates\n * - each \"inside\" region is monotone, ie. can be broken into two chains\n *   of monotonically increasing vertices according to VertLeq(v1,v2)\n *   - a non-invariant: these chains may intersect (very slightly)\n *\n * Invariants for the Sweep.\n * - if none of the edges incident to the event vertex have an activeRegion\n *   (ie. none of these edges are in the edge dictionary), then the vertex\n *   has only right-going edges.\n * - if an edge is marked \"fixUpperEdge\" (it is a temporary edge introduced\n *   by ConnectRightVertex), then it is the only right-going edge from\n *   its associated vertex.  (This says that these edges exist only\n *   when it is necessary.)\n */\n\n/** @const */\nlibtess.sweep = {};\n\n\n/**\n * Make the sentinel coordinates big enough that they will never be\n * merged with real input features.  (Even with the largest possible\n * input contour and the maximum tolerance of 1.0, no merging will be\n * done with coordinates larger than 3 * libtess.GLU_TESS_MAX_COORD).\n * @private\n * @const\n * @type {number}\n */\nlibtess.sweep.SENTINEL_COORD_ = 4 * libtess.GLU_TESS_MAX_COORD;\n\n\n/**\n * Because vertices at exactly the same location are merged together\n * before we process the sweep event, some degenerate cases can't occur.\n * However if someone eventually makes the modifications required to\n * merge features which are close together, the cases below marked\n * TOLERANCE_NONZERO will be useful.  They were debugged before the\n * code to merge identical vertices in the main loop was added.\n * @private\n * @const\n * @type {boolean}\n */\nlibtess.sweep.TOLERANCE_NONZERO_ = false;\n\n\n/**\n * computeInterior(tess) computes the planar arrangement specified\n * by the given contours, and further subdivides this arrangement\n * into regions. Each region is marked \"inside\" if it belongs\n * to the polygon, according to the rule given by tess.windingRule.\n * Each interior region is guaranteed be monotone.\n *\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.computeInterior = function(tess) {\n  tess.fatalError = false;\n\n  // Each vertex defines an event for our sweep line. Start by inserting\n  // all the vertices in a priority queue. Events are processed in\n  // lexicographic order, ie.\n  // e1 < e2  iff  e1.x < e2.x || (e1.x == e2.x && e1.y < e2.y)\n  libtess.sweep.removeDegenerateEdges_(tess);\n  libtess.sweep.initPriorityQ_(tess);\n  libtess.sweep.initEdgeDict_(tess);\n\n  // TODO(bckenny): don't need the cast if pq's key is better typed\n  var v;\n  while ((v = /** @type {libtess.GluVertex} */(tess.pq.extractMin())) !== null) {\n    for (;;) {\n      var vNext = /** @type {libtess.GluVertex} */(tess.pq.minimum());\n      if (vNext === null || !libtess.geom.vertEq(vNext, v)) {\n        break;\n      }\n\n      /* Merge together all vertices at exactly the same location.\n       * This is more efficient than processing them one at a time,\n       * simplifies the code (see connectLeftDegenerate), and is also\n       * important for correct handling of certain degenerate cases.\n       * For example, suppose there are two identical edges A and B\n       * that belong to different contours (so without this code they would\n       * be processed by separate sweep events).  Suppose another edge C\n       * crosses A and B from above.  When A is processed, we split it\n       * at its intersection point with C.  However this also splits C,\n       * so when we insert B we may compute a slightly different\n       * intersection point.  This might leave two edges with a small\n       * gap between them.  This kind of error is especially obvious\n       * when using boundary extraction (GLU_TESS_BOUNDARY_ONLY).\n       */\n      vNext = /** @type {libtess.GluVertex} */(tess.pq.extractMin());\n      libtess.sweep.spliceMergeVertices_(tess, v.anEdge, vNext.anEdge);\n    }\n    libtess.sweep.sweepEvent_(tess, v);\n  }\n\n  // TODO(bckenny): what does the next comment mean? can we eliminate event except when debugging?\n  // Set tess.event for debugging purposes\n  var minRegion = tess.dict.getMin().getKey();\n  tess.event = minRegion.eUp.org;\n  libtess.sweep.doneEdgeDict_(tess);\n  libtess.sweep.donePriorityQ_(tess);\n\n  libtess.sweep.removeDegenerateFaces_(tess.mesh);\n  tess.mesh.checkMesh();\n};\n\n\n/**\n * When we merge two edges into one, we need to compute the combined\n * winding of the new edge.\n * @private\n * @param {libtess.GluHalfEdge} eDst [description].\n * @param {libtess.GluHalfEdge} eSrc [description].\n */\nlibtess.sweep.addWinding_ = function(eDst, eSrc) {\n  // NOTE(bckenny): from AddWinding macro\n  eDst.winding += eSrc.winding;\n  eDst.sym.winding += eSrc.sym.winding;\n};\n\n\n/**\n * Both edges must be directed from right to left (this is the canonical\n * direction for the upper edge of each region).\n *\n * The strategy is to evaluate a \"t\" value for each edge at the\n * current sweep line position, given by tess.event.  The calculations\n * are designed to be very stable, but of course they are not perfect.\n *\n * Special case: if both edge destinations are at the sweep event,\n * we sort the edges by slope (they would otherwise compare equally).\n *\n * @private\n * @param {!libtess.GluTesselator} tess\n * @param {!libtess.ActiveRegion} reg1\n * @param {!libtess.ActiveRegion} reg2\n * @return {boolean}\n */\nlibtess.sweep.edgeLeq_ = function(tess, reg1, reg2) {\n  var event = tess.event;\n  var e1 = reg1.eUp;\n  var e2 = reg2.eUp;\n\n  if (e1.dst() === event) {\n    if (e2.dst() === event) {\n      // Two edges right of the sweep line which meet at the sweep event.\n      // Sort them by slope.\n      if (libtess.geom.vertLeq(e1.org, e2.org)) {\n        return libtess.geom.edgeSign(e2.dst(), e1.org, e2.org) <= 0;\n      }\n\n      return libtess.geom.edgeSign(e1.dst(), e2.org, e1.org) >= 0;\n    }\n\n    return libtess.geom.edgeSign(e2.dst(), event, e2.org) <= 0;\n  }\n\n  if (e2.dst() === event) {\n    return libtess.geom.edgeSign(e1.dst(), event, e1.org) >= 0;\n  }\n\n  // General case - compute signed distance *from* e1, e2 to event\n  var t1 = libtess.geom.edgeEval(e1.dst(), event, e1.org);\n  var t2 = libtess.geom.edgeEval(e2.dst(), event, e2.org);\n  return (t1 >= t2);\n};\n\n\n/**\n * [deleteRegion_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} reg [description].\n */\nlibtess.sweep.deleteRegion_ = function(tess, reg) {\n  if (reg.fixUpperEdge) {\n    // It was created with zero winding number, so it better be\n    // deleted with zero winding number (ie. it better not get merged\n    // with a real edge).\n  }\n\n  reg.eUp.activeRegion = null;\n\n  tess.dict.deleteNode(reg.nodeUp);\n  reg.nodeUp = null;\n\n  // memFree( reg ); TODO(bckenny)\n  // TODO(bckenny): may need to null at callsite\n};\n\n\n/**\n * Replace an upper edge which needs fixing (see connectRightVertex).\n * @private\n * @param {libtess.ActiveRegion} reg [description].\n * @param {libtess.GluHalfEdge} newEdge [description].\n */\nlibtess.sweep.fixUpperEdge_ = function(reg, newEdge) {\n  libtess.mesh.deleteEdge(reg.eUp);\n\n  reg.fixUpperEdge = false;\n  reg.eUp = newEdge;\n  newEdge.activeRegion = reg;\n};\n\n\n/**\n * Find the region above the uppermost edge with the same origin.\n * @private\n * @param {libtess.ActiveRegion} reg [description].\n * @return {libtess.ActiveRegion} [description].\n */\nlibtess.sweep.topLeftRegion_ = function(reg) {\n  var org = reg.eUp.org;\n\n  // Find the region above the uppermost edge with the same origin\n  do {\n    reg = reg.regionAbove();\n  } while (reg.eUp.org === org);\n\n  // If the edge above was a temporary edge introduced by connectRightVertex,\n  // now is the time to fix it.\n  if (reg.fixUpperEdge) {\n    var e = libtess.mesh.connect(reg.regionBelow().eUp.sym, reg.eUp.lNext);\n    libtess.sweep.fixUpperEdge_(reg, e);\n    reg = reg.regionAbove();\n  }\n\n  return reg;\n};\n\n\n/**\n * Find the region above the uppermost edge with the same destination.\n * @private\n * @param {libtess.ActiveRegion} reg [description].\n * @return {libtess.ActiveRegion} [description].\n */\nlibtess.sweep.topRightRegion_ = function(reg) {\n  var dst = reg.eUp.dst();\n\n  do {\n    reg = reg.regionAbove();\n  } while (reg.eUp.dst() === dst);\n\n  return reg;\n};\n\n\n/**\n * Add a new active region to the sweep line, *somewhere* below \"regAbove\"\n * (according to where the new edge belongs in the sweep-line dictionary).\n * The upper edge of the new region will be \"eNewUp\".\n * Winding number and \"inside\" flag are not updated.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regAbove [description].\n * @param {libtess.GluHalfEdge} eNewUp [description].\n * @return {libtess.ActiveRegion} regNew.\n */\nlibtess.sweep.addRegionBelow_ = function(tess, regAbove, eNewUp) {\n  var regNew = new libtess.ActiveRegion();\n\n  regNew.eUp = eNewUp;\n  regNew.nodeUp = tess.dict.insertBefore(regAbove.nodeUp, regNew);\n  eNewUp.activeRegion = regNew;\n\n  return regNew;\n};\n\n\n/**\n * [isWindingInside_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {number} n int.\n * @return {boolean} [description].\n */\nlibtess.sweep.isWindingInside_ = function(tess, n) {\n  switch (tess.windingRule) {\n    case libtess.windingRule.GLU_TESS_WINDING_ODD:\n      return ((n & 1) !== 0);\n    case libtess.windingRule.GLU_TESS_WINDING_NONZERO:\n      return (n !== 0);\n    case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:\n      return (n > 0);\n    case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:\n      return (n < 0);\n    case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:\n      return (n >= 2) || (n <= -2);\n  }\n\n  // TODO(bckenny): not reached\n  return false;\n};\n\n\n/**\n * [computeWinding_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} reg [description].\n */\nlibtess.sweep.computeWinding_ = function(tess, reg) {\n  reg.windingNumber = reg.regionAbove().windingNumber + reg.eUp.winding;\n  reg.inside = libtess.sweep.isWindingInside_(tess, reg.windingNumber);\n};\n\n\n/**\n * Delete a region from the sweep line. This happens when the upper\n * and lower chains of a region meet (at a vertex on the sweep line).\n * The \"inside\" flag is copied to the appropriate mesh face (we could\n * not do this before -- since the structure of the mesh is always\n * changing, this face may not have even existed until now).\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} reg [description].\n */\nlibtess.sweep.finishRegion_ = function(tess, reg) {\n  // TODO(bckenny): may need to null reg at callsite\n\n  var e = reg.eUp;\n  var f = e.lFace;\n\n  f.inside = reg.inside;\n  f.anEdge = e;   // optimization for tessmono.tessellateMonoRegion() // TODO(bckenny): how so?\n  libtess.sweep.deleteRegion_(tess, reg);\n};\n\n\n/**\n * We are given a vertex with one or more left-going edges. All affected\n * edges should be in the edge dictionary. Starting at regFirst.eUp,\n * we walk down deleting all regions where both edges have the same\n * origin vOrg. At the same time we copy the \"inside\" flag from the\n * active region to the face, since at this point each face will belong\n * to at most one region (this was not necessarily true until this point\n * in the sweep). The walk stops at the region above regLast; if regLast\n * is null we walk as far as possible. At the same time we relink the\n * mesh if necessary, so that the ordering of edges around vOrg is the\n * same as in the dictionary.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regFirst [description].\n * @param {libtess.ActiveRegion} regLast [description].\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.sweep.finishLeftRegions_ = function(tess, regFirst, regLast) {\n  var regPrev = regFirst;\n  var ePrev = regFirst.eUp;\n  while (regPrev !== regLast) {\n    // placement was OK\n    regPrev.fixUpperEdge = false;\n    var reg = regPrev.regionBelow();\n    var e = reg.eUp;\n    if (e.org !== ePrev.org) {\n      if (!reg.fixUpperEdge) {\n        /* Remove the last left-going edge. Even though there are no further\n         * edges in the dictionary with this origin, there may be further\n         * such edges in the mesh (if we are adding left edges to a vertex\n         * that has already been processed). Thus it is important to call\n         * finishRegion rather than just deleteRegion.\n         */\n        libtess.sweep.finishRegion_(tess, regPrev);\n        break;\n      }\n\n      // If the edge below was a temporary edge introduced by\n      // connectRightVertex, now is the time to fix it.\n      e = libtess.mesh.connect(ePrev.lPrev(), e.sym);\n      libtess.sweep.fixUpperEdge_(reg, e);\n    }\n\n    // Relink edges so that ePrev.oNext === e\n    if (ePrev.oNext !== e) {\n      libtess.mesh.meshSplice(e.oPrev(), e);\n      libtess.mesh.meshSplice(ePrev, e);\n    }\n\n    // may change reg.eUp\n    libtess.sweep.finishRegion_(tess, regPrev);\n    ePrev = reg.eUp;\n    regPrev = reg;\n  }\n\n  return ePrev;\n};\n\n\n/**\n * Purpose: insert right-going edges into the edge dictionary, and update\n * winding numbers and mesh connectivity appropriately. All right-going\n * edges share a common origin vOrg. Edges are inserted CCW starting at\n * eFirst; the last edge inserted is eLast.oPrev. If vOrg has any\n * left-going edges already processed, then eTopLeft must be the edge\n * such that an imaginary upward vertical segment from vOrg would be\n * contained between eTopLeft.oPrev and eTopLeft; otherwise eTopLeft\n * should be null.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @param {libtess.GluHalfEdge} eFirst [description].\n * @param {libtess.GluHalfEdge} eLast [description].\n * @param {libtess.GluHalfEdge} eTopLeft [description].\n * @param {boolean} cleanUp [description].\n */\nlibtess.sweep.addRightEdges_ = function(tess, regUp, eFirst, eLast, eTopLeft,\n    cleanUp) {\n\n  var firstTime = true;\n\n  // Insert the new right-going edges in the dictionary\n  var e = eFirst;\n  do {\n    libtess.sweep.addRegionBelow_(tess, regUp, e.sym);\n    e = e.oNext;\n  } while (e !== eLast);\n\n  // Walk *all* right-going edges from e.org, in the dictionary order,\n  // updating the winding numbers of each region, and re-linking the mesh\n  // edges to match the dictionary ordering (if necessary).\n  if (eTopLeft === null) {\n    eTopLeft = regUp.regionBelow().eUp.rPrev();\n  }\n  var regPrev = regUp;\n  var ePrev = eTopLeft;\n  var reg;\n  for (;;) {\n    reg = regPrev.regionBelow();\n    e = reg.eUp.sym;\n    if (e.org !== ePrev.org) {\n      break;\n    }\n\n    if (e.oNext !== ePrev) {\n      // Unlink e from its current position, and relink below ePrev\n      libtess.mesh.meshSplice(e.oPrev(), e);\n      libtess.mesh.meshSplice(ePrev.oPrev(), e);\n    }\n    // Compute the winding number and \"inside\" flag for the new regions\n    reg.windingNumber = regPrev.windingNumber - e.winding;\n    reg.inside = libtess.sweep.isWindingInside_(tess, reg.windingNumber);\n\n    // Check for two outgoing edges with same slope -- process these\n    // before any intersection tests (see example in libtess.sweep.computeInterior).\n    regPrev.dirty = true;\n    if (!firstTime && libtess.sweep.checkForRightSplice_(tess, regPrev)) {\n      libtess.sweep.addWinding_(e, ePrev);\n      libtess.sweep.deleteRegion_(tess, regPrev); // TODO(bckenny): need to null regPrev anywhere else?\n      libtess.mesh.deleteEdge(ePrev);\n    }\n    firstTime = false;\n    regPrev = reg;\n    ePrev = e;\n  }\n\n  regPrev.dirty = true;\n\n  if (cleanUp) {\n    // Check for intersections between newly adjacent edges.\n    libtess.sweep.walkDirtyRegions_(tess, regPrev);\n  }\n};\n\n\n/**\n * [callCombine_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.GluVertex} isect [description].\n * @param {Array.<Object>} data [description].\n * @param {Array.<number>} weights [description].\n * @param {boolean} needed [description].\n */\nlibtess.sweep.callCombine_ = function(tess, isect, data, weights, needed) {\n  // Copy coord data in case the callback changes it.\n  var coords = [\n    isect.coords[0],\n    isect.coords[1],\n    isect.coords[2]\n  ];\n\n  isect.data = null;\n  isect.data = tess.callCombineOrCombineData(coords, data, weights);\n  if (isect.data === null) {\n    if (!needed) {\n      // not needed, so just use data from first vertex\n      isect.data = data[0];\n\n    } else if (!tess.fatalError) {\n      // The only way fatal error is when two edges are found to intersect,\n      // but the user has not provided the callback necessary to handle\n      // generated intersection points.\n      tess.callErrorOrErrorData(\n          libtess.errorType.GLU_TESS_NEED_COMBINE_CALLBACK);\n      tess.fatalError = true;\n    }\n  }\n};\n\n\n/**\n * Two vertices with idential coordinates are combined into one.\n * e1.org is kept, while e2.org is discarded.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.GluHalfEdge} e1 [description].\n * @param {libtess.GluHalfEdge} e2 [description].\n */\nlibtess.sweep.spliceMergeVertices_ = function(tess, e1, e2) {\n  // TODO(bckenny): better way to init these? save them?\n  var data = [null, null, null, null];\n  var weights = [0.5, 0.5, 0, 0];\n\n  data[0] = e1.org.data;\n  data[1] = e2.org.data;\n  libtess.sweep.callCombine_(tess, e1.org, data, weights, false);\n  libtess.mesh.meshSplice(e1, e2);\n};\n\n\n/**\n * Find some weights which describe how the intersection vertex is\n * a linear combination of org and dst. Each of the two edges\n * which generated \"isect\" is allocated 50% of the weight; each edge\n * splits the weight between its org and dst according to the\n * relative distance to \"isect\".\n *\n * @private\n * @param {libtess.GluVertex} isect [description].\n * @param {libtess.GluVertex} org [description].\n * @param {libtess.GluVertex} dst [description].\n * @param {Array.<number>} weights [description].\n * @param {number} weightIndex Index into weights for first weight to supply.\n */\nlibtess.sweep.vertexWeights_ = function(isect, org, dst, weights, weightIndex) {\n  // TODO(bckenny): think through how we can use L1dist here and be correct for coords\n  var t1 = libtess.geom.vertL1dist(org, isect);\n  var t2 = libtess.geom.vertL1dist(dst, isect);\n\n  // TODO(bckenny): introduced weightIndex to mimic addressing in original\n  // 1) document (though it is private and only used from getIntersectData)\n  // 2) better way? manually inline into getIntersectData? supply two two-length tmp arrays?\n  var i0 = weightIndex;\n  var i1 = weightIndex + 1;\n  weights[i0] = 0.5 * t2 / (t1 + t2);\n  weights[i1] = 0.5 * t1 / (t1 + t2);\n  isect.coords[0] += weights[i0] * org.coords[0] + weights[i1] * dst.coords[0];\n  isect.coords[1] += weights[i0] * org.coords[1] + weights[i1] * dst.coords[1];\n  isect.coords[2] += weights[i0] * org.coords[2] + weights[i1] * dst.coords[2];\n};\n\n\n/**\n * We've computed a new intersection point, now we need a \"data\" pointer\n * from the user so that we can refer to this new vertex in the\n * rendering callbacks.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.GluVertex} isect [description].\n * @param {libtess.GluVertex} orgUp [description].\n * @param {libtess.GluVertex} dstUp [description].\n * @param {libtess.GluVertex} orgLo [description].\n * @param {libtess.GluVertex} dstLo [description].\n */\nlibtess.sweep.getIntersectData_ = function(tess, isect, orgUp, dstUp, orgLo,\n    dstLo) {\n\n  // TODO(bckenny): called for every intersection event, should these be from a pool?\n  // TODO(bckenny): better way to init these?\n  var weights = [0, 0, 0, 0];\n  var data = [\n    orgUp.data,\n    dstUp.data,\n    orgLo.data,\n    dstLo.data\n  ];\n\n  // TODO(bckenny): it appears isect is a reappropriated vertex, so does need to be zeroed.\n  // double check this.\n  isect.coords[0] = isect.coords[1] = isect.coords[2] = 0;\n\n  // TODO(bckenny): see note in libtess.sweep.vertexWeights_ for explanation of weightIndex. fix?\n  libtess.sweep.vertexWeights_(isect, orgUp, dstUp, weights, 0);\n  libtess.sweep.vertexWeights_(isect, orgLo, dstLo, weights, 2);\n\n  libtess.sweep.callCombine_(tess, isect, data, weights, true);\n};\n\n\n/**\n * Check the upper and lower edge of regUp, to make sure that the\n * eUp.org is above eLo, or eLo.org is below eUp (depending on which\n * origin is leftmost).\n *\n * The main purpose is to splice right-going edges with the same\n * dest vertex and nearly identical slopes (ie. we can't distinguish\n * the slopes numerically). However the splicing can also help us\n * to recover from numerical errors. For example, suppose at one\n * point we checked eUp and eLo, and decided that eUp.org is barely\n * above eLo. Then later, we split eLo into two edges (eg. from\n * a splice operation like this one). This can change the result of\n * our test so that now eUp.org is incident to eLo, or barely below it.\n * We must correct this condition to maintain the dictionary invariants.\n *\n * One possibility is to check these edges for intersection again\n * (i.e. checkForIntersect). This is what we do if possible. However\n * checkForIntersect requires that tess.event lies between eUp and eLo,\n * so that it has something to fall back on when the intersection\n * calculation gives us an unusable answer. So, for those cases where\n * we can't check for intersection, this routine fixes the problem\n * by just splicing the offending vertex into the other edge.\n * This is a guaranteed solution, no matter how degenerate things get.\n * Basically this is a combinatorial solution to a numerical problem.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @return {boolean} [description].\n */\nlibtess.sweep.checkForRightSplice_ = function(tess, regUp) {\n  // TODO(bckenny): fully learn how these two checks work\n\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n\n  if (libtess.geom.vertLeq(eUp.org, eLo.org)) {\n    if (libtess.geom.edgeSign(eLo.dst(), eUp.org, eLo.org) > 0) {\n      return false;\n    }\n\n    // eUp.org appears to be below eLo\n    if (!libtess.geom.vertEq(eUp.org, eLo.org)) {\n      // Splice eUp.org into eLo\n      libtess.mesh.splitEdge(eLo.sym);\n      libtess.mesh.meshSplice(eUp, eLo.oPrev());\n      regUp.dirty = regLo.dirty = true;\n\n    } else if (eUp.org !== eLo.org) {\n      // merge the two vertices, discarding eUp.org\n      // TODO(bckenny): fix pqHandle null situation\n      tess.pq.remove(/** @type {libtess.PQHandle} */(eUp.org.pqHandle));\n      libtess.sweep.spliceMergeVertices_(tess, eLo.oPrev(), eUp);\n    }\n\n  } else {\n    if (libtess.geom.edgeSign(eUp.dst(), eLo.org, eUp.org) < 0) {\n      return false;\n    }\n\n    // eLo.org appears to be above eUp, so splice eLo.org into eUp\n    regUp.regionAbove().dirty = regUp.dirty = true;\n    libtess.mesh.splitEdge(eUp.sym);\n    libtess.mesh.meshSplice(eLo.oPrev(), eUp);\n  }\n\n  return true;\n};\n\n\n/**\n * Check the upper and lower edge of regUp to make sure that the\n * eUp.dst() is above eLo, or eLo.dst() is below eUp (depending on which\n * destination is rightmost).\n *\n * Theoretically, this should always be true. However, splitting an edge\n * into two pieces can change the results of previous tests. For example,\n * suppose at one point we checked eUp and eLo, and decided that eUp.dst()\n * is barely above eLo. Then later, we split eLo into two edges (eg. from\n * a splice operation like this one). This can change the result of\n * the test so that now eUp.dst() is incident to eLo, or barely below it.\n * We must correct this condition to maintain the dictionary invariants\n * (otherwise new edges might get inserted in the wrong place in the\n * dictionary, and bad stuff will happen).\n *\n * We fix the problem by just splicing the offending vertex into the\n * other edge.\n *\n * @private\n * @param {libtess.GluTesselator} tess description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @return {boolean} [description].\n */\nlibtess.sweep.checkForLeftSplice_ = function(tess, regUp) {\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n  var e;\n\n  if (libtess.geom.vertLeq(eUp.dst(), eLo.dst())) {\n    if (libtess.geom.edgeSign(eUp.dst(), eLo.dst(), eUp.org) < 0) {\n      return false;\n    }\n\n    // eLo.dst() is above eUp, so splice eLo.dst() into eUp\n    regUp.regionAbove().dirty = regUp.dirty = true;\n    e = libtess.mesh.splitEdge(eUp);\n    libtess.mesh.meshSplice(eLo.sym, e);\n    e.lFace.inside = regUp.inside;\n\n  } else {\n    if (libtess.geom.edgeSign(eLo.dst(), eUp.dst(), eLo.org) > 0) {\n      return false;\n    }\n\n    // eUp.dst() is below eLo, so splice eUp.dst() into eLo\n    regUp.dirty = regLo.dirty = true;\n    e = libtess.mesh.splitEdge(eLo);\n    libtess.mesh.meshSplice(eUp.lNext, eLo.sym);\n    e.rFace().inside = regUp.inside;\n  }\n\n  return true;\n};\n\n\n/**\n * Check the upper and lower edges of the given region to see if\n * they intersect. If so, create the intersection and add it\n * to the data structures.\n *\n * Returns true if adding the new intersection resulted in a recursive\n * call to addRightEdges_(); in this case all \"dirty\" regions have been\n * checked for intersections, and possibly regUp has been deleted.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @return {boolean} [description].\n */\nlibtess.sweep.checkForIntersect_ = function(tess, regUp) {\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n  var orgUp = eUp.org;\n  var orgLo = eLo.org;\n  var dstUp = eUp.dst();\n  var dstLo = eLo.dst();\n\n  var isect = new libtess.GluVertex();\n\n  if (orgUp === orgLo) {\n    // right endpoints are the same\n    return false;\n  }\n\n  var tMinUp = Math.min(orgUp.t, dstUp.t);\n  var tMaxLo = Math.max(orgLo.t, dstLo.t);\n  if (tMinUp > tMaxLo) {\n    // t ranges do not overlap\n    return false;\n  }\n\n  if (libtess.geom.vertLeq(orgUp, orgLo)) {\n    if (libtess.geom.edgeSign(dstLo, orgUp, orgLo) > 0) {\n      return false;\n    }\n  } else {\n    if (libtess.geom.edgeSign(dstUp, orgLo, orgUp) < 0) {\n      return false;\n    }\n  }\n\n  // At this point the edges intersect, at least marginally\n  libtess.geom.edgeIntersect(dstUp, orgUp, dstLo, orgLo, isect);\n\n  // The following properties are guaranteed:\n\n  if (libtess.geom.vertLeq(isect, tess.event)) {\n    /* The intersection point lies slightly to the left of the sweep line,\n     * so move it until it's slightly to the right of the sweep line.\n     * (If we had perfect numerical precision, this would never happen\n     * in the first place). The easiest and safest thing to do is\n     * replace the intersection by tess.event.\n     */\n    isect.s = tess.event.s;\n    isect.t = tess.event.t;\n  }\n\n  // TODO(bckenny): try to find test54.d\n  /* Similarly, if the computed intersection lies to the right of the\n   * rightmost origin (which should rarely happen), it can cause\n   * unbelievable inefficiency on sufficiently degenerate inputs.\n   * (If you have the test program, try running test54.d with the\n   * \"X zoom\" option turned on).\n   */\n  var orgMin = libtess.geom.vertLeq(orgUp, orgLo) ? orgUp : orgLo;\n  if (libtess.geom.vertLeq(orgMin, isect)) {\n    isect.s = orgMin.s;\n    isect.t = orgMin.t;\n  }\n\n  if (libtess.geom.vertEq(isect, orgUp) || libtess.geom.vertEq(isect, orgLo)) {\n    // Easy case -- intersection at one of the right endpoints\n    libtess.sweep.checkForRightSplice_(tess, regUp);\n    return false;\n  }\n\n  // TODO(bckenny): clean this up; length is distracting\n  if ((!libtess.geom.vertEq(dstUp, tess.event) &&\n      libtess.geom.edgeSign(dstUp, tess.event, isect) >= 0) ||\n      (!libtess.geom.vertEq(dstLo, tess.event) &&\n      libtess.geom.edgeSign(dstLo, tess.event, isect) <= 0)) {\n\n    /* Very unusual -- the new upper or lower edge would pass on the\n     * wrong side of the sweep event, or through it. This can happen\n     * due to very small numerical errors in the intersection calculation.\n     */\n    if (dstLo === tess.event) {\n      // Splice dstLo into eUp, and process the new region(s)\n      libtess.mesh.splitEdge(eUp.sym);\n      libtess.mesh.meshSplice(eLo.sym, eUp);\n      regUp = libtess.sweep.topLeftRegion_(regUp);\n      eUp = regUp.regionBelow().eUp;\n      libtess.sweep.finishLeftRegions_(tess, regUp.regionBelow(), regLo);\n      libtess.sweep.addRightEdges_(tess, regUp, eUp.oPrev(), eUp, eUp, true);\n      return true;\n    }\n\n    if (dstUp === tess.event) {\n      // Splice dstUp into eLo, and process the new region(s)\n      libtess.mesh.splitEdge(eLo.sym);\n      libtess.mesh.meshSplice(eUp.lNext, eLo.oPrev());\n      regLo = regUp;\n      regUp = libtess.sweep.topRightRegion_(regUp);\n      var e = regUp.regionBelow().eUp.rPrev();\n      regLo.eUp = eLo.oPrev();\n      eLo = libtess.sweep.finishLeftRegions_(tess, regLo, null);\n      libtess.sweep.addRightEdges_(tess, regUp, eLo.oNext, eUp.rPrev(), e,\n          true);\n      return true;\n    }\n\n    /* Special case: called from connectRightVertex. If either\n     * edge passes on the wrong side of tess.event, split it\n     * (and wait for connectRightVertex to splice it appropriately).\n     */\n    if (libtess.geom.edgeSign(dstUp, tess.event, isect) >= 0) {\n      regUp.regionAbove().dirty = regUp.dirty = true;\n      libtess.mesh.splitEdge(eUp.sym);\n      eUp.org.s = tess.event.s;\n      eUp.org.t = tess.event.t;\n    }\n\n    if (libtess.geom.edgeSign(dstLo, tess.event, isect) <= 0) {\n      regUp.dirty = regLo.dirty = true;\n      libtess.mesh.splitEdge(eLo.sym);\n      eLo.org.s = tess.event.s;\n      eLo.org.t = tess.event.t;\n    }\n\n    // leave the rest for connectRightVertex\n    return false;\n  }\n\n  /* General case -- split both edges, splice into new vertex.\n   * When we do the splice operation, the order of the arguments is\n   * arbitrary as far as correctness goes. However, when the operation\n   * creates a new face, the work done is proportional to the size of\n   * the new face. We expect the faces in the processed part of\n   * the mesh (ie. eUp.lFace) to be smaller than the faces in the\n   * unprocessed original contours (which will be eLo.oPrev.lFace).\n   */\n  libtess.mesh.splitEdge(eUp.sym);\n  libtess.mesh.splitEdge(eLo.sym);\n  libtess.mesh.meshSplice(eLo.oPrev(), eUp);\n  eUp.org.s = isect.s;\n  eUp.org.t = isect.t;\n  eUp.org.pqHandle = tess.pq.insert(eUp.org);\n  libtess.sweep.getIntersectData_(tess, eUp.org, orgUp, dstUp, orgLo, dstLo);\n  regUp.regionAbove().dirty = regUp.dirty = regLo.dirty = true;\n\n  return false;\n};\n\n\n/**\n * When the upper or lower edge of any region changes, the region is\n * marked \"dirty\". This routine walks through all the dirty regions\n * and makes sure that the dictionary invariants are satisfied\n * (see the comments at the beginning of this file). Of course,\n * new dirty regions can be created as we make changes to restore\n * the invariants.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n */\nlibtess.sweep.walkDirtyRegions_ = function(tess, regUp) {\n  var regLo = regUp.regionBelow();\n\n  for (;;) {\n    // Find the lowest dirty region (we walk from the bottom up).\n    while (regLo.dirty) {\n      regUp = regLo;\n      regLo = regLo.regionBelow();\n    }\n    if (!regUp.dirty) {\n      regLo = regUp;\n      regUp = regUp.regionAbove();\n      if (regUp === null || !regUp.dirty) {\n        // We've walked all the dirty regions\n        return;\n      }\n    }\n\n    regUp.dirty = false;\n    var eUp = regUp.eUp;\n    var eLo = regLo.eUp;\n\n    if (eUp.dst() !== eLo.dst()) {\n      // Check that the edge ordering is obeyed at the dst vertices.\n      if (libtess.sweep.checkForLeftSplice_(tess, regUp)) {\n        // If the upper or lower edge was marked fixUpperEdge, then\n        // we no longer need it (since these edges are needed only for\n        // vertices which otherwise have no right-going edges).\n        if (regLo.fixUpperEdge) {\n          libtess.sweep.deleteRegion_(tess, regLo);\n          libtess.mesh.deleteEdge(eLo);\n          regLo = regUp.regionBelow();\n          eLo = regLo.eUp;\n\n        } else if (regUp.fixUpperEdge) {\n          libtess.sweep.deleteRegion_(tess, regUp);\n          libtess.mesh.deleteEdge(eUp);\n          regUp = regLo.regionAbove();\n          eUp = regUp.eUp;\n        }\n      }\n    }\n\n    if (eUp.org !== eLo.org) {\n      if (eUp.dst() !== eLo.dst() && !regUp.fixUpperEdge &&\n          !regLo.fixUpperEdge &&\n          (eUp.dst() === tess.event || eLo.dst() === tess.event)) {\n        /* When all else fails in checkForIntersect(), it uses tess.event\n         * as the intersection location. To make this possible, it requires\n         * that tess.event lie between the upper and lower edges, and also\n         * that neither of these is marked fixUpperEdge (since in the worst\n         * case it might splice one of these edges into tess.event, and\n         * violate the invariant that fixable edges are the only right-going\n         * edge from their associated vertex).\n         */\n        if (libtess.sweep.checkForIntersect_(tess, regUp)) {\n          // walkDirtyRegions() was called recursively; we're done\n          return;\n        }\n\n      } else {\n        // Even though we can't use checkForIntersect(), the org vertices\n        // may violate the dictionary edge ordering. Check and correct this.\n        libtess.sweep.checkForRightSplice_(tess, regUp);\n      }\n    }\n\n    if (eUp.org === eLo.org && eUp.dst() === eLo.dst()) {\n      // A degenerate loop consisting of only two edges -- delete it.\n      libtess.sweep.addWinding_(eLo, eUp);\n      libtess.sweep.deleteRegion_(tess, regUp);\n      libtess.mesh.deleteEdge(eUp);\n      regUp = regLo.regionAbove();\n    }\n  }\n};\n\n\n/**\n * Purpose: connect a \"right\" vertex vEvent (one where all edges go left)\n * to the unprocessed portion of the mesh. Since there are no right-going\n * edges, two regions (one above vEvent and one below) are being merged\n * into one. regUp is the upper of these two regions.\n *\n * There are two reasons for doing this (adding a right-going edge):\n *  - if the two regions being merged are \"inside\", we must add an edge\n *    to keep them separated (the combined region would not be monotone).\n *  - in any case, we must leave some record of vEvent in the dictionary,\n *    so that we can merge vEvent with features that we have not seen yet.\n *    For example, maybe there is a vertical edge which passes just to\n *    the right of vEvent; we would like to splice vEvent into this edge.\n *\n * However, we don't want to connect vEvent to just any vertex. We don't\n * want the new edge to cross any other edges; otherwise we will create\n * intersection vertices even when the input data had no self-intersections.\n * (This is a bad thing; if the user's input data has no intersections,\n * we don't want to generate any false intersections ourselves.)\n *\n * Our eventual goal is to connect vEvent to the leftmost unprocessed\n * vertex of the combined region (the union of regUp and regLo).\n * But because of unseen vertices with all right-going edges, and also\n * new vertices which may be created by edge intersections, we don't\n * know where that leftmost unprocessed vertex is. In the meantime, we\n * connect vEvent to the closest vertex of either chain, and mark the region\n * as \"fixUpperEdge\". This flag says to delete and reconnect this edge\n * to the next processed vertex on the boundary of the combined region.\n * Quite possibly the vertex we connected to will turn out to be the\n * closest one, in which case we won't need to make any changes.\n *\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @param {libtess.GluHalfEdge} eBottomLeft [description].\n */\nlibtess.sweep.connectRightVertex_ = function(tess, regUp, eBottomLeft) {\n  var eTopLeft = eBottomLeft.oNext;\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n  var degenerate = false;\n\n  if (eUp.dst() !== eLo.dst()) {\n    libtess.sweep.checkForIntersect_(tess, regUp);\n  }\n\n  // Possible new degeneracies: upper or lower edge of regUp may pass\n  // through vEvent, or may coincide with new intersection vertex\n  if (libtess.geom.vertEq(eUp.org, tess.event)) {\n    libtess.mesh.meshSplice(eTopLeft.oPrev(), eUp);\n    regUp = libtess.sweep.topLeftRegion_(regUp);\n    eTopLeft = regUp.regionBelow().eUp;\n    libtess.sweep.finishLeftRegions_(tess, regUp.regionBelow(), regLo);\n    degenerate = true;\n  }\n  if (libtess.geom.vertEq(eLo.org, tess.event)) {\n    libtess.mesh.meshSplice(eBottomLeft, eLo.oPrev());\n    eBottomLeft = libtess.sweep.finishLeftRegions_(tess, regLo, null);\n    degenerate = true;\n  }\n  if (degenerate) {\n    libtess.sweep.addRightEdges_(tess, regUp, eBottomLeft.oNext, eTopLeft,\n        eTopLeft, true);\n    return;\n  }\n\n  // Non-degenerate situation -- need to add a temporary, fixable edge.\n  // Connect to the closer of eLo.org, eUp.org.\n  var eNew;\n  if (libtess.geom.vertLeq(eLo.org, eUp.org)) {\n    eNew = eLo.oPrev();\n  } else {\n    eNew = eUp;\n  }\n  eNew = libtess.mesh.connect(eBottomLeft.lPrev(), eNew);\n\n  // Prevent cleanup, otherwise eNew might disappear before we've even\n  // had a chance to mark it as a temporary edge.\n  libtess.sweep.addRightEdges_(tess, regUp, eNew, eNew.oNext, eNew.oNext,\n      false);\n  eNew.sym.activeRegion.fixUpperEdge = true;\n  libtess.sweep.walkDirtyRegions_(tess, regUp);\n};\n\n\n/**\n * The event vertex lies exacty on an already-processed edge or vertex.\n * Adding the new vertex involves splicing it into the already-processed\n * part of the mesh.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.ActiveRegion} regUp [description].\n * @param {libtess.GluVertex} vEvent [description].\n */\nlibtess.sweep.connectLeftDegenerate_ = function(tess, regUp, vEvent) {\n  var e = regUp.eUp;\n  /* istanbul ignore if */\n  if (libtess.geom.vertEq(e.org, vEvent)) {\n    // NOTE(bckenny): this code is unreachable but remains for a hypothetical\n    // future extension of libtess. See docs on libtess.sweep.TOLERANCE_NONZERO_\n    // for more information. Conditional on TOLERANCE_NONZERO_ to help Closure\n    // Compiler eliminate dead code.\n    // e.org is an unprocessed vertex - just combine them, and wait\n    // for e.org to be pulled from the queue\n    if (libtess.sweep.TOLERANCE_NONZERO_) {\n      libtess.sweep.spliceMergeVertices_(tess, e, vEvent.anEdge);\n    }\n    return;\n  }\n\n  if (!libtess.geom.vertEq(e.dst(), vEvent)) {\n    // General case -- splice vEvent into edge e which passes through it\n    libtess.mesh.splitEdge(e.sym);\n\n    if (regUp.fixUpperEdge) {\n      // This edge was fixable -- delete unused portion of original edge\n      libtess.mesh.deleteEdge(e.oNext);\n      regUp.fixUpperEdge = false;\n    }\n\n    libtess.mesh.meshSplice(vEvent.anEdge, e);\n\n    // recurse\n    libtess.sweep.sweepEvent_(tess, vEvent);\n    return;\n  }\n\n  // NOTE(bckenny): this code is unreachable but remains for a hypothetical\n  // future extension of libtess. See docs on libtess.sweep.TOLERANCE_NONZERO_\n  // for more information. Conditional on TOLERANCE_NONZERO_ to help Closure\n  // Compiler eliminate dead code.\n  // vEvent coincides with e.dst(), which has already been processed.\n  // Splice in the additional right-going edges.\n  /* istanbul ignore next */\n\n  /* istanbul ignore next */\n  if (libtess.sweep.TOLERANCE_NONZERO_) {\n    regUp = libtess.sweep.topRightRegion_(regUp);\n    var reg = regUp.regionBelow();\n    var eTopRight = reg.eUp.sym;\n    var eTopLeft = eTopRight.oNext;\n    var eLast = eTopLeft;\n\n    if (reg.fixUpperEdge) {\n      // Here e.dst() has only a single fixable edge going right.\n      // We can delete it since now we have some real right-going edges.\n\n      // there are some left edges too\n      libtess.sweep.deleteRegion_(tess, reg); // TODO(bckenny): something to null?\n      libtess.mesh.deleteEdge(eTopRight);\n      eTopRight = eTopLeft.oPrev();\n    }\n\n    libtess.mesh.meshSplice(vEvent.anEdge, eTopRight);\n    if (!libtess.geom.edgeGoesLeft(eTopLeft)) {\n      // e.dst() had no left-going edges -- indicate this to addRightEdges()\n      eTopLeft = null;\n    }\n\n    libtess.sweep.addRightEdges_(tess, regUp, eTopRight.oNext, eLast, eTopLeft,\n        true);\n  }\n};\n\n\n/**\n * Connect a \"left\" vertex (one where both edges go right)\n * to the processed portion of the mesh. Let R be the active region\n * containing vEvent, and let U and L be the upper and lower edge\n * chains of R. There are two possibilities:\n *\n * - the normal case: split R into two regions, by connecting vEvent to\n *   the rightmost vertex of U or L lying to the left of the sweep line\n *\n * - the degenerate case: if vEvent is close enough to U or L, we\n *   merge vEvent into that edge chain. The subcases are:\n *  - merging with the rightmost vertex of U or L\n *  - merging with the active edge of U or L\n *  - merging with an already-processed portion of U or L\n *\n * @private\n * @param {libtess.GluTesselator} tess   [description].\n * @param {libtess.GluVertex} vEvent [description].\n */\nlibtess.sweep.connectLeftVertex_ = function(tess, vEvent) {\n  // TODO(bckenny): tmp only used for sweep. better to keep tmp across calls?\n  var tmp = new libtess.ActiveRegion();\n\n  // NOTE(bckenny): this was commented out in the original\n  // libtess.assert(vEvent.anEdge.oNext.oNext === vEvent.anEdge);\n\n  // Get a pointer to the active region containing vEvent\n  tmp.eUp = vEvent.anEdge.sym;\n  var regUp = tess.dict.search(tmp).getKey();\n  var regLo = regUp.regionBelow();\n  var eUp = regUp.eUp;\n  var eLo = regLo.eUp;\n\n  // try merging with U or L first\n  if (libtess.geom.edgeSign(eUp.dst(), vEvent, eUp.org) === 0) {\n    libtess.sweep.connectLeftDegenerate_(tess, regUp, vEvent);\n    return;\n  }\n\n  // Connect vEvent to rightmost processed vertex of either chain.\n  // e.dst() is the vertex that we will connect to vEvent.\n  var reg = libtess.geom.vertLeq(eLo.dst(), eUp.dst()) ? regUp : regLo;\n  var eNew;\n  if (regUp.inside || reg.fixUpperEdge) {\n    if (reg === regUp) {\n      eNew = libtess.mesh.connect(vEvent.anEdge.sym, eUp.lNext);\n\n    } else {\n      var tempHalfEdge = libtess.mesh.connect(eLo.dNext(), vEvent.anEdge);\n      eNew = tempHalfEdge.sym;\n    }\n\n    if (reg.fixUpperEdge) {\n      libtess.sweep.fixUpperEdge_(reg, eNew);\n\n    } else {\n      libtess.sweep.computeWinding_(tess,\n          libtess.sweep.addRegionBelow_(tess, regUp, eNew));\n    }\n    libtess.sweep.sweepEvent_(tess, vEvent);\n\n  } else {\n    // The new vertex is in a region which does not belong to the polygon.\n    // We don''t need to connect this vertex to the rest of the mesh.\n    libtess.sweep.addRightEdges_(tess, regUp, vEvent.anEdge, vEvent.anEdge,\n        null, true);\n  }\n};\n\n\n/**\n * Does everything necessary when the sweep line crosses a vertex.\n * Updates the mesh and the edge dictionary.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {libtess.GluVertex} vEvent [description].\n */\nlibtess.sweep.sweepEvent_ = function(tess, vEvent) {\n  tess.event = vEvent; // for access in edgeLeq_ // TODO(bckenny): wuh?\n\n  /* Check if this vertex is the right endpoint of an edge that is\n   * already in the dictionary.  In this case we don't need to waste\n   * time searching for the location to insert new edges.\n   */\n  var e = vEvent.anEdge;\n  while (e.activeRegion === null) {\n    e = e.oNext;\n    if (e === vEvent.anEdge) {\n      // All edges go right -- not incident to any processed edges\n      libtess.sweep.connectLeftVertex_(tess, vEvent);\n      return;\n    }\n  }\n\n  /* Processing consists of two phases: first we \"finish\" all the\n   * active regions where both the upper and lower edges terminate\n   * at vEvent (ie. vEvent is closing off these regions).\n   * We mark these faces \"inside\" or \"outside\" the polygon according\n   * to their winding number, and delete the edges from the dictionary.\n   * This takes care of all the left-going edges from vEvent.\n   */\n  var regUp = libtess.sweep.topLeftRegion_(e.activeRegion);\n  var reg = regUp.regionBelow();\n  var eTopLeft = reg.eUp;\n  var eBottomLeft = libtess.sweep.finishLeftRegions_(tess, reg, null);\n\n  /* Next we process all the right-going edges from vEvent. This\n   * involves adding the edges to the dictionary, and creating the\n   * associated \"active regions\" which record information about the\n   * regions between adjacent dictionary edges.\n   */\n  if (eBottomLeft.oNext === eTopLeft) {\n    // No right-going edges -- add a temporary \"fixable\" edge\n    libtess.sweep.connectRightVertex_(tess, regUp, eBottomLeft);\n\n  } else {\n    libtess.sweep.addRightEdges_(tess, regUp, eBottomLeft.oNext, eTopLeft,\n        eTopLeft, true);\n  }\n};\n\n\n/**\n * We add two sentinel edges above and below all other edges,\n * to avoid special cases at the top and bottom.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n * @param {number} t [description].\n */\nlibtess.sweep.addSentinel_ = function(tess, t) {\n  var reg = new libtess.ActiveRegion();\n\n  var e = libtess.mesh.makeEdge(tess.mesh);\n\n  e.org.s = libtess.sweep.SENTINEL_COORD_;\n  e.org.t = t;\n  e.dst().s = -libtess.sweep.SENTINEL_COORD_;\n  e.dst().t = t;\n  tess.event = e.dst(); //initialize it\n\n  reg.eUp = e;\n  reg.windingNumber = 0;\n  reg.inside = false;\n  reg.fixUpperEdge = false;\n  reg.sentinel = true;\n  reg.dirty = false;\n  reg.nodeUp = tess.dict.insert(reg);\n};\n\n\n/**\n * We maintain an ordering of edge intersections with the sweep line.\n * This order is maintained in a dynamic dictionary.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.initEdgeDict_ = function(tess) {\n  tess.dict = new libtess.Dict(tess, libtess.sweep.edgeLeq_);\n\n  libtess.sweep.addSentinel_(tess, -libtess.sweep.SENTINEL_COORD_);\n  libtess.sweep.addSentinel_(tess, libtess.sweep.SENTINEL_COORD_);\n};\n\n\n/**\n * [doneEdgeDict_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.doneEdgeDict_ = function(tess) {\n  // NOTE(bckenny): fixedEdges is only used in the assert below, so ignore so\n  // when asserts are removed jshint won't error.\n  /* jshint unused:false */\n  var fixedEdges = 0;\n\n  var reg;\n  while ((reg = tess.dict.getMin().getKey()) !== null) {\n    // At the end of all processing, the dictionary should contain\n    // only the two sentinel edges, plus at most one \"fixable\" edge\n    // created by connectRightVertex().\n    if (!reg.sentinel) {\n    }\n    libtess.sweep.deleteRegion_(tess, reg);\n  }\n\n  // NOTE(bckenny): see tess.dict.deleteDict_() for old delete dict function\n  tess.dict = null;\n};\n\n\n/**\n * Remove zero-length edges, and contours with fewer than 3 vertices.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.removeDegenerateEdges_ = function(tess) {\n  var eHead = tess.mesh.eHead;\n\n  var eNext;\n  for (var e = eHead.next; e !== eHead; e = eNext) {\n    eNext = e.next;\n    var eLNext = e.lNext;\n\n    if (libtess.geom.vertEq(e.org, e.dst()) && e.lNext.lNext !== e) {\n      // Zero-length edge, contour has at least 3 edges\n      libtess.sweep.spliceMergeVertices_(tess, eLNext, e); // deletes e.org\n      libtess.mesh.deleteEdge(e); // e is a self-loop TODO(bckenny): does this comment really apply here?\n      e = eLNext;\n      eLNext = e.lNext;\n    }\n\n    if (eLNext.lNext === e) {\n      // Degenerate contour (one or two edges)\n      if (eLNext !== e) {\n        if (eLNext === eNext || eLNext === eNext.sym) {\n          eNext = eNext.next;\n        }\n        libtess.mesh.deleteEdge(eLNext);\n      }\n\n      if (e === eNext || e === eNext.sym) {\n        eNext = eNext.next;\n      }\n      libtess.mesh.deleteEdge(e);\n    }\n  }\n};\n\n\n/**\n * Construct priority queue and insert all vertices into it, which determines\n * the order in which vertices cross the sweep line.\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.initPriorityQ_ = function(tess) {\n  // TODO(bckenny): libtess.geom.vertLeq needs cast?\n  var pq = new libtess.PriorityQ(\n      /** @type {function(Object, Object): boolean} */(libtess.geom.vertLeq));\n  tess.pq = pq;\n\n  var vHead = tess.mesh.vHead;\n  var v;\n  for (v = vHead.next; v !== vHead; v = v.next) {\n    v.pqHandle = pq.insert(v);\n  }\n\n  pq.init();\n};\n\n\n/**\n * [donePriorityQ_ description]\n * @private\n * @param {libtess.GluTesselator} tess [description].\n */\nlibtess.sweep.donePriorityQ_ = function(tess) {\n  // TODO(bckenny): probably don't need deleteQ. check that function for comment\n  tess.pq.deleteQ();\n  tess.pq = null;\n};\n\n\n/**\n * Delete any degenerate faces with only two edges. walkDirtyRegions()\n * will catch almost all of these, but it won't catch degenerate faces\n * produced by splice operations on already-processed edges.\n * The two places this can happen are in finishLeftRegions(), when\n * we splice in a \"temporary\" edge produced by connectRightVertex(),\n * and in checkForLeftSplice(), where we splice already-processed\n * edges to ensure that our dictionary invariants are not violated\n * by numerical errors.\n *\n * In both these cases it is *very* dangerous to delete the offending\n * edge at the time, since one of the routines further up the stack\n * will sometimes be keeping a pointer to that edge.\n *\n * @private\n * @param {libtess.GluMesh} mesh [description].\n */\nlibtess.sweep.removeDegenerateFaces_ = function(mesh) {\n  var fNext;\n  for (var f = mesh.fHead.next; f !== mesh.fHead; f = fNext) {\n    fNext = f.next;\n    var e = f.anEdge;\n\n    if (e.lNext.lNext === e) {\n      // A face with only two edges\n      libtess.sweep.addWinding_(e.oNext, e);\n      libtess.mesh.deleteEdge(e);\n    }\n  }\n};\n\n\n/* global libtess */\n\n/** @const */\nlibtess.tessmono = {};\n\n/**\n * Tessellates a monotone region (what else would it do??). The region must\n * consist of a single loop of half-edges (see mesh.js) oriented CCW. \"Monotone\"\n * in this case means that any vertical line intersects the interior of the\n * region in a single interval.\n *\n * Tessellation consists of adding interior edges (actually pairs of\n * half-edges), to split the region into non-overlapping triangles.\n * @private\n * @param {!libtess.GluFace} face\n */\nlibtess.tessmono.tessellateMonoRegion_ = function(face) {\n  /* The basic idea is explained in Preparata and Shamos (which I don't\n   * have handy right now), although their implementation is more\n   * complicated than this one. The are two edge chains, an upper chain\n   * and a lower chain. We process all vertices from both chains in order,\n   * from right to left.\n   *\n   * The algorithm ensures that the following invariant holds after each\n   * vertex is processed: the untessellated region consists of two\n   * chains, where one chain (say the upper) is a single edge, and\n   * the other chain is concave. The left vertex of the single edge\n   * is always to the left of all vertices in the concave chain.\n   *\n   * Each step consists of adding the rightmost unprocessed vertex to one\n   * of the two chains, and forming a fan of triangles from the rightmost\n   * of two chain endpoints. Determining whether we can add each triangle\n   * to the fan is a simple orientation test. By making the fan as large\n   * as possible, we restore the invariant (check it yourself).\n   *\n   * All edges are oriented CCW around the boundary of the region.\n   * First, find the half-edge whose origin vertex is rightmost.\n   * Since the sweep goes from left to right, face.anEdge should\n   * be close to the edge we want.\n   */\n  var up = face.anEdge;\n\n  for (; libtess.geom.vertLeq(up.dst(), up.org); up = up.lPrev()) { }\n  for (; libtess.geom.vertLeq(up.org, up.dst()); up = up.lNext) { }\n\n  var lo = up.lPrev();\n\n  var tempHalfEdge;\n  while (up.lNext !== lo) {\n    if (libtess.geom.vertLeq(up.dst(), lo.org)) {\n      // up.dst() is on the left. It is safe to form triangles from lo.org.\n      // The edgeGoesLeft test guarantees progress even when some triangles\n      // are CW, given that the upper and lower chains are truly monotone.\n      while (lo.lNext !== up && (libtess.geom.edgeGoesLeft(lo.lNext) ||\n          libtess.geom.edgeSign(lo.org, lo.dst(), lo.lNext.dst()) <= 0)) {\n\n        tempHalfEdge = libtess.mesh.connect(lo.lNext, lo);\n        lo = tempHalfEdge.sym;\n      }\n      lo = lo.lPrev();\n\n    } else {\n      // lo.org is on the left. We can make CCW triangles from up.dst().\n      while (lo.lNext !== up && (libtess.geom.edgeGoesRight(up.lPrev()) ||\n          libtess.geom.edgeSign(up.dst(), up.org, up.lPrev().org) >= 0)) {\n\n        tempHalfEdge = libtess.mesh.connect(up, up.lPrev());\n        up = tempHalfEdge.sym;\n      }\n      up = up.lNext;\n    }\n  }\n\n  // Now lo.org == up.dst() == the leftmost vertex. The remaining region\n  // can be tessellated in a fan from this leftmost vertex.\n  while (lo.lNext.lNext !== up) {\n    tempHalfEdge = libtess.mesh.connect(lo.lNext, lo);\n    lo = tempHalfEdge.sym;\n  }\n};\n\n/**\n * Tessellates each region of the mesh which is marked \"inside\" the polygon.\n * Each such region must be monotone.\n * @param {!libtess.GluMesh} mesh\n */\nlibtess.tessmono.tessellateInterior = function(mesh) {\n  var next;\n  for (var f = mesh.fHead.next; f !== mesh.fHead; f = next) {\n    // Make sure we don't try to tessellate the new triangles.\n    next = f.next;\n    if (f.inside) {\n      libtess.tessmono.tessellateMonoRegion_(f);\n    }\n  }\n};\n\n/**\n * Zaps (i.e. sets to null) all faces which are not marked \"inside\" the polygon.\n * Since further mesh operations on null faces are not allowed, the main purpose\n * is to clean up the mesh so that exterior loops are not represented in the\n * data structure.\n * @param {!libtess.GluMesh} mesh\n */\nlibtess.tessmono.discardExterior = function(mesh) {\n  var next;\n  for (var f = mesh.fHead.next; f !== mesh.fHead; f = next) {\n    // Since f will be destroyed, save its next pointer.\n    next = f.next;\n    if (!f.inside) {\n      libtess.mesh.zapFace(f);\n    }\n  }\n};\n\n/**\n * Resets the winding numbers on all edges so that regions marked \"inside\" the\n * polygon have a winding number of \"value\", and regions outside have a winding\n * number of 0.\n *\n * If keepOnlyBoundary is true, it also deletes all edges which do not separate\n * an interior region from an exterior one.\n *\n * @param {!libtess.GluMesh} mesh\n * @param {number} value\n * @param {boolean} keepOnlyBoundary\n */\nlibtess.tessmono.setWindingNumber = function(mesh, value, keepOnlyBoundary) {\n  var eNext;\n  for (var e = mesh.eHead.next; e !== mesh.eHead; e = eNext) {\n    eNext = e.next;\n\n    if (e.rFace().inside !== e.lFace.inside) {\n      // This is a boundary edge (one side is interior, one is exterior).\n      e.winding = (e.lFace.inside) ? value : -value;\n\n    } else {\n      // Both regions are interior, or both are exterior.\n      if (!keepOnlyBoundary) {\n        e.winding = 0;\n\n      } else {\n        libtess.mesh.deleteEdge(e);\n      }\n    }\n  }\n};\n\n\n/* global libtess */\n\n/**\n * A list of edges crossing the sweep line, sorted from top to bottom.\n * Implementation is a doubly-linked list, sorted by the injected edgeLeq\n * comparator function. Here it is a simple ordering, but see libtess.sweep for\n * the list of invariants on the edge dictionary this ordering creates.\n * @constructor\n * @struct\n * @param {!libtess.GluTesselator} frame\n * @param {function(!libtess.GluTesselator, !libtess.ActiveRegion, !libtess.ActiveRegion): boolean} leq\n */\nlibtess.Dict = function(frame, leq) {\n\n  /**\n   * The head of the doubly-linked DictNode list. At creation time, links back\n   * and forward only to itself.\n   * @private\n   */\n  this.head_ = new libtess.DictNode();\n\n  /**\n   * The GluTesselator used as the frame for edge/event comparisons.\n   * @private\n   */\n  this.frame_ = frame;\n\n  /**\n   * Comparison function to maintain the invariants of the Dict. See\n   * libtess.sweep.edgeLeq_ for source.\n   * @private\n   * @type {function(!libtess.GluTesselator, !libtess.ActiveRegion, !libtess.ActiveRegion): boolean}\n   */\n  this.leq_ = leq;\n};\n\n/* istanbul ignore next */\n/**\n * Formerly used to delete the dict.\n * NOTE(bckenny): No longer called but left for memFree documentation. Nulled at\n * former callsite instead (sweep.doneEdgeDict_)\n * @private\n */\nlibtess.Dict.prototype.deleteDict_ = function() {\n  // for (var node = this.head_.next; node !== this.head_; node = node.next) {\n  //   memFree(node);\n  // }\n  // memFree(dict);\n};\n\n/**\n * Insert the supplied key into the edge list and return its new node.\n * @param {libtess.DictNode} node\n * @param {!libtess.ActiveRegion} key\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.insertBefore = function(node, key) {\n  do {\n    node = node.prev;\n  } while (node.key !== null && !this.leq_(this.frame_, node.key, key));\n\n  // insert the new node and update the surrounding nodes to point to it\n  var newNode = new libtess.DictNode(key, node.next, node);\n  node.next.prev = newNode;\n  node.next = newNode;\n\n  return newNode;\n};\n\n/**\n * Insert key into the dict and return the new node that contains it.\n * @param {!libtess.ActiveRegion} key\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.insert = function(key) {\n  // NOTE(bckenny): from a macro in dict.h/dict-list.h\n  return this.insertBefore(this.head_, key);\n};\n\n/**\n * Remove node from the list.\n * @param {libtess.DictNode} node\n */\nlibtess.Dict.prototype.deleteNode = function(node) {\n  node.next.prev = node.prev;\n  node.prev.next = node.next;\n\n  // NOTE(bckenny): nulled at callsite (sweep.deleteRegion_)\n  // memFree( node );\n};\n\n/**\n * Search returns the node with the smallest key greater than or equal\n * to the given key. If there is no such key, returns a node whose\n * key is null. Similarly, max(d).getSuccessor() has a null key, etc.\n * @param {!libtess.ActiveRegion} key\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.search = function(key) {\n  var node = this.head_;\n\n  do {\n    node = node.next;\n  } while (node.key !== null && !this.leq_(this.frame_, key, node.key));\n\n  return node;\n};\n\n/**\n * Return the node with the smallest key.\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.getMin = function() {\n  // NOTE(bckenny): from a macro in dict.h/dict-list.h\n  return this.head_.next;\n};\n\n// NOTE(bckenny): libtess.Dict.getMax isn't called within libtess and isn't part\n// of the public API. For now, leaving in but ignoring for coverage.\n/* istanbul ignore next */\n/**\n * Returns the node with the greatest key.\n * @return {!libtess.DictNode}\n */\nlibtess.Dict.prototype.getMax = function() {\n  // NOTE(bckenny): from a macro in dict.h/dict-list.h\n  return this.head_.prev;\n};\n\n\n/* global libtess */\n\n/**\n * A doubly-linked-list node with a libtess.ActiveRegion payload.\n * The key for this node and the next and previous nodes in the parent Dict list\n * can be provided to insert it into an existing list (or all can be omitted if\n * this is to be the founding node of the list).\n * @param {!libtess.ActiveRegion=} opt_key\n * @param {!libtess.DictNode=} opt_nextNode\n * @param {!libtess.DictNode=} opt_prevNode\n * @constructor\n * @struct\n */\nlibtess.DictNode = function(opt_key, opt_nextNode, opt_prevNode) {\n  /**\n   * The ActiveRegion key for this node, or null if the head of the list.\n   * @type {libtess.ActiveRegion}\n   */\n  this.key = opt_key || null;\n\n  /**\n   * Link to next DictNode in parent list or to self if this is the first node.\n   * @type {!libtess.DictNode}\n   */\n  this.next = opt_nextNode || this;\n\n  /**\n   * Link to previous DictNode in parent list or to self if this is the first\n   * node.\n   * @type {!libtess.DictNode}\n   */\n  this.prev = opt_prevNode || this;\n};\n\n/**\n * Get the key from this node.\n * @return {libtess.ActiveRegion}\n */\nlibtess.DictNode.prototype.getKey = function() {\n  return this.key;\n};\n\n/**\n * Get the successor node to this one.\n * @return {!libtess.DictNode}\n */\nlibtess.DictNode.prototype.getSuccessor = function() {\n  return this.next;\n};\n\n/**\n * Get the predecessor node to this one.\n * @return {!libtess.DictNode}\n */\nlibtess.DictNode.prototype.getPredecessor = function() {\n  return this.prev;\n};\n\n\n\n/* global libtess */\n\n/**\n * Cached vertex data for single-countour polygons for quick-and-dirty\n * decomposition.\n * @constructor\n * @struct\n */\nlibtess.CachedVertex = function() {\n  /**\n   * [coords description]\n   * @type {Array.<number>}\n   */\n  this.coords = [0, 0, 0];\n  // TODO(bckenny): better way to init?\n\n  /**\n   * [data description]\n   * @type {Object}\n   */\n  this.data = null;\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): create more javascript-y API, e.g. make gluTessEndPolygon\n// async, don't require so many temp objects created\n\n/**\n * The tesselator main class, providing the public API.\n * @constructor\n * @struct\n */\nlibtess.GluTesselator = function() {\n  // Only initialize fields which can be changed by the api. Other fields\n  // are initialized where they are used.\n\n  // TODO(bckenny): many of these can be made private\n  // TODO(bckenny): can we combine call* and call*Data functions?\n\n  /*** state needed for collecting the input data ***/\n\n  /**\n   * what begin/end calls have we seen?\n   * @type {libtess.GluTesselator.tessState_}\n   */\n  this.state = libtess.GluTesselator.tessState_.T_DORMANT;\n\n  /**\n   * lastEdge_.org is the most recent vertex\n   * @private\n   * @type {libtess.GluHalfEdge}\n   */\n  this.lastEdge_ = null;\n\n  /**\n   * stores the input contours, and eventually the tessellation itself\n   * @type {libtess.GluMesh}\n   */\n  this.mesh = null;\n  // NOTE(bckenny): initialized in this.emptyCache_\n\n  /**\n   * Error callback.\n   * @private\n   * @type {?function((libtess.errorType|libtess.gluEnum))}\n   */\n  this.callError_ = null;\n\n\n  /*** state needed for projecting onto the sweep plane ***/\n\n  /**\n   * user-specified normal (if provided)\n   * @type {!Array.<number>}\n   */\n  this.normal = [0, 0, 0];\n  // TODO(bckenny): better way to init these arrays?\n\n  /**\n   * unit vector in s-direction (debugging)\n   * @type {!Array.<number>}\n   */\n  this.sUnit = [0, 0, 0];\n\n  /**\n   * unit vector in t-direction (debugging)\n   * @type {!Array.<number>}\n   */\n  this.tUnit = [0, 0, 0];\n\n  /*** state needed for the line sweep ***/\n  // TODO(bckenny): this could be moved to a sweep state object of some sort\n\n  /**\n   * tolerance for merging features\n   * @type {number}\n   */\n  this.relTolerance = libtess.GLU_TESS_DEFAULT_TOLERANCE;\n\n  /**\n   * rule for determining polygon interior\n   * @type {libtess.windingRule}\n   */\n  this.windingRule = libtess.windingRule.GLU_TESS_WINDING_ODD;\n\n  /**\n   * fatal error: needed combine callback\n   * @type {boolean}\n   */\n  this.fatalError = false;\n\n  /**\n   * edge dictionary for sweep line\n   * @type {libtess.Dict}\n   */\n  this.dict = null;\n  // NOTE(bckenny): dict initialized in sweep.initEdgeDict_, removed in sweep.doneEdgeDict_\n\n  /**\n   * priority queue of vertex events\n   * @type {libtess.PriorityQ}\n   */\n  this.pq = null;\n  // NOTE(bckenny): pq initialized in sweep.initPriorityQ\n\n  /**\n   * current sweep event being processed\n   * @type {libtess.GluVertex}\n   */\n  this.event = null;\n\n  /**\n   * Combine callback.\n   * @private\n   * @type {?function(Array.<number>, Array.<Object>, Array.<number>): Object}\n   */\n  this.callCombine_ = null;\n\n  /*** state needed for rendering callbacks (see render.js) ***/\n\n  /**\n   * Extract contours, not triangles\n   * @type {boolean}\n   */\n  this.boundaryOnly = false;\n\n  /**\n   * Begin callback.\n   * @private\n   * @type {?function(libtess.primitiveType)}\n   */\n  this.callBegin_ = null;\n\n  /**\n   * Edge flag callback.\n   * @private\n   * @type {?function(boolean)}\n   */\n  this.callEdgeFlag_ = null;\n\n  /**\n   * Vertex callback.\n   * @private\n   * @type {?function(Object)}\n   */\n  this.callVertex_ = null;\n\n  /**\n   * End callback.\n   * @private\n   * @type {?function()}\n   */\n  this.callEnd_ = null;\n\n  /**\n   * Mesh callback.\n   * @private\n   * @type {?function(libtess.GluMesh)}\n   */\n  this.callMesh_ = null;\n\n  /*** rendering callbacks that also pass polygon data  ***/\n  /**\n   * BeginData callback.\n   * @private\n   * @type {?function(libtess.primitiveType, Object)}\n   */\n  this.callBeginData_ = null;\n\n  /**\n   * EdgeFlagData callback.\n   * @private\n   * @type {?function(boolean, Object)}\n   */\n  this.callEdgeFlagData_ = null;\n\n  /**\n   * VertexData callback.\n   * @private\n   * @type {?function(Object, Object)}\n   */\n  this.callVertexData_ = null;\n\n  /**\n   * EndData callback.\n   * @private\n   * @type {?function(Object)}\n   */\n  this.callEndData_ = null;\n\n  /**\n   * ErrorData callback.\n   * @private\n   * @type {?function((libtess.errorType|libtess.gluEnum), Object)}\n   */\n  this.callErrorData_ = null;\n\n  /**\n   * CombineData callback.\n   * @private\n   * @type {?function(Array.<number>, Array.<Object>, Array.<number>, Object): Object}\n   */\n  this.callCombineData_ = null;\n\n  /**\n   * client data for current polygon\n   * @private\n   * @type {Object}\n   */\n  this.polygonData_ = null;\n\n  /*** state needed to cache single-contour polygons for renderCache() ***/\n  /**\n   * empty cache on next vertex() call\n   * @type {boolean}\n   */\n  this.emptyCache = false;\n  // TODO(bckenny): possibly rename to be clear it's a boolean\n\n  /**\n   * number of cached vertices\n   * @type {number}\n   */\n  this.cacheCount = 0;\n\n  /**\n   * the vertex data\n   * @type {Array.<libtess.CachedVertex>}\n   */\n  this.cache = new Array(libtess.TESS_MAX_CACHE);\n\n  // TODO(bckenny): fill now? or init on demand\n  for (var i = 0; i < libtess.TESS_MAX_CACHE; i++) {\n    this.cache[i] = new libtess.CachedVertex();\n  }\n};\n\n/**\n * The begin/end calls must be properly nested. We keep track of the current\n * state to enforce the ordering.\n * @enum {number}\n * @private\n */\nlibtess.GluTesselator.tessState_ = {\n  T_DORMANT: 0,\n  T_IN_POLYGON: 1,\n  T_IN_CONTOUR: 2\n};\n\n/**\n * Destory the tesselator object. See README.\n */\nlibtess.GluTesselator.prototype.gluDeleteTess = function() {\n  // TODO(bckenny): This does nothing but assert that it isn't called while\n  // building the polygon since we rely on GC to handle memory. *If* the public\n  // API changes, this should go.\n  this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT);\n  // memFree(tess); TODO(bckenny)\n};\n\n\n/**\n * Set properties for control over tesselation. See README.\n * @param {libtess.gluEnum} which [description].\n * @param {number|boolean} value [description].\n */\nlibtess.GluTesselator.prototype.gluTessProperty = function(which, value) {\n  // TODO(bckenny): split into more setters?\n  // TODO(bckenny): in any case, we can do better than this switch statement\n\n  switch (which) {\n    case libtess.gluEnum.GLU_TESS_TOLERANCE:\n      if (value < 0 || value > 1) {\n        break;\n      }\n      // TODO(bckenny): libtess doesn't support any tolerance but 0. This should\n      // reject any non-zero tolerance accordingly.\n      this.relTolerance = /** @type {number} */(value);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_WINDING_RULE:\n      var windingRule = /** @type {libtess.windingRule} */(value);\n\n      switch (windingRule) {\n        case libtess.windingRule.GLU_TESS_WINDING_ODD:\n        case libtess.windingRule.GLU_TESS_WINDING_NONZERO:\n        case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:\n        case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:\n        case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:\n          this.windingRule = windingRule;\n          return;\n        default:\n      }\n      break;\n\n    case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:\n      // TODO(bckenny): added boolean param type. make sure ok.\n      this.boundaryOnly = !!value;\n      return;\n\n    default:\n      this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM);\n      return;\n  }\n  this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_VALUE);\n};\n\n\n/**\n * Returns tessellator property\n * @param {libtess.gluEnum} which [description].\n * @return {number|boolean} [description].\n */\nlibtess.GluTesselator.prototype.gluGetTessProperty = function(which) {\n  // TODO(bckenny): as above, split into more getters? and improve on switch statement\n  // why are these being asserted in getter but not setter?\n\n  switch (which) {\n    case libtess.gluEnum.GLU_TESS_TOLERANCE:\n      // tolerance should be in range [0..1]\n      return this.relTolerance;\n\n    case libtess.gluEnum.GLU_TESS_WINDING_RULE:\n      var rule = this.windingRule;\n      return rule;\n\n    case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:\n      return this.boundaryOnly;\n\n    default:\n      this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM);\n      break;\n  }\n  return false;\n};\n\n\n/**\n * Lets the user supply the polygon normal, if known.  All input data\n * is projected into a plane perpendicular to the normal before\n * tesselation. All output triangles are oriented CCW with\n * respect to the normal (CW orientation can be obtained by\n * reversing the sign of the supplied normal). For example, if\n * you know that all polygons lie in the x-y plane, call\n * \"tess.gluTessNormal(0.0, 0.0, 1.0)\" before rendering any polygons.\n *\n * @param {number} x [description].\n * @param {number} y [description].\n * @param {number} z [description].\n */\nlibtess.GluTesselator.prototype.gluTessNormal = function(x, y, z) {\n  this.normal[0] = x;\n  this.normal[1] = y;\n  this.normal[2] = z;\n};\n\n\n/**\n * Specify callbacks. See README. A null or undefined opt_fn removes current callback.\n *\n * @param {libtess.gluEnum} which [description].\n * @param {?Function=} opt_fn [description].\n */\nlibtess.GluTesselator.prototype.gluTessCallback = function(which, opt_fn) {\n  var fn = !opt_fn ? null : opt_fn;\n  // TODO(bckenny): better opt_fn typing?\n\n  switch (which) {\n    case libtess.gluEnum.GLU_TESS_BEGIN:\n      this.callBegin_ = /** @type {function(libtess.primitiveType)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_BEGIN_DATA:\n      this.callBeginData_ =\n          /** @type {function(libtess.primitiveType, Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_EDGE_FLAG:\n      this.callEdgeFlag_ = /** @type {function(boolean)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_EDGE_FLAG_DATA:\n      this.callEdgeFlagData_ = /** @type {function(boolean, Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_VERTEX:\n      this.callVertex_ = /** @type {function(Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_VERTEX_DATA:\n      this.callVertexData_ = /** @type {function(Object, Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_END:\n      this.callEnd_ = /** @type {function()} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_END_DATA:\n      this.callEndData_ = /** @type {function(Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_ERROR:\n      this.callError_ = /** @type {function((libtess.errorType|libtess.gluEnum))} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_ERROR_DATA:\n      this.callErrorData_ =\n          /** @type {function((libtess.errorType|libtess.gluEnum), Object)} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_COMBINE:\n      this.callCombine_ = /** @type {function(Array.<number>, Array.<Object>, Array.<number>): Object} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_COMBINE_DATA:\n      this.callCombineData_ = /** @type {function(Array.<number>, Array.<Object>, Array.<number>, Object): Object} */ (fn);\n      return;\n\n    case libtess.gluEnum.GLU_TESS_MESH:\n      this.callMesh_ = /** @type {function(libtess.GluMesh)} */ (fn);\n      return;\n\n    default:\n      this.callErrorOrErrorData(libtess.gluEnum.GLU_INVALID_ENUM);\n      return;\n  }\n};\n\n\n/**\n * Specify a vertex and associated data. Must be within calls to\n * beginContour/endContour. See README.\n *\n * @param {Array.<number>} coords [description].\n * @param {Object} data [description].\n */\nlibtess.GluTesselator.prototype.gluTessVertex = function(coords, data) {\n  var tooLarge = false;\n\n  // TODO(bckenny): pool allocation?\n  var clamped = [0, 0, 0];\n\n  this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);\n\n  if (this.emptyCache) {\n    this.emptyCache_();\n    this.lastEdge_ = null;\n  }\n\n  for (var i = 0; i < 3; ++i) {\n    var x = coords[i];\n    if (x < -libtess.GLU_TESS_MAX_COORD) {\n      x = -libtess.GLU_TESS_MAX_COORD;\n      tooLarge = true;\n    }\n    if (x > libtess.GLU_TESS_MAX_COORD) {\n      x = libtess.GLU_TESS_MAX_COORD;\n      tooLarge = true;\n    }\n    clamped[i] = x;\n  }\n\n  if (tooLarge) {\n    this.callErrorOrErrorData(libtess.errorType.GLU_TESS_COORD_TOO_LARGE);\n  }\n\n  if (this.mesh === null) {\n    if (this.cacheCount < libtess.TESS_MAX_CACHE) {\n      this.cacheVertex_(clamped, data);\n      return;\n    }\n\n    // cache is full, create mesh and add cached verts to it\n    this.emptyCache_();\n  }\n\n  this.addVertex_(clamped, data);\n};\n\n\n/**\n * [gluTessBeginPolygon description]\n * @param {Object} data Client data for current polygon.\n */\nlibtess.GluTesselator.prototype.gluTessBeginPolygon = function(data) {\n  this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT);\n\n  this.state = libtess.GluTesselator.tessState_.T_IN_POLYGON;\n  this.cacheCount = 0;\n  this.emptyCache = false;\n  this.mesh = null;\n\n  this.polygonData_ = data;\n};\n\n\n/**\n * [gluTessBeginContour description]\n */\nlibtess.GluTesselator.prototype.gluTessBeginContour = function() {\n  this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON);\n\n  this.state = libtess.GluTesselator.tessState_.T_IN_CONTOUR;\n  this.lastEdge_ = null;\n  if (this.cacheCount > 0) {\n    // Just set a flag so we don't get confused by empty contours\n    // -- these can be generated accidentally with the obsolete\n    // NextContour() interface.\n    // TODO(bckenny): we aren't implementing NextContour() interface.\n    this.emptyCache = true;\n  }\n};\n\n\n/**\n * [gluTessEndContour description]\n */\nlibtess.GluTesselator.prototype.gluTessEndContour = function() {\n  this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);\n  this.state = libtess.GluTesselator.tessState_.T_IN_POLYGON;\n};\n\n\n/**\n * [gluTessEndPolygon description]\n */\nlibtess.GluTesselator.prototype.gluTessEndPolygon = function() {\n  this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON);\n  this.state = libtess.GluTesselator.tessState_.T_DORMANT;\n\n  if (this.mesh === null) {\n    // TODO(bckenny): can we eliminate more cache functionality?\n    this.emptyCache_();\n  }\n\n  // Determine the polygon normal and project vertices onto the plane\n  // of the polygon.\n  libtess.normal.projectPolygon(this);\n\n  // computeInterior(tess) computes the planar arrangement specified\n  // by the given contours, and further subdivides this arrangement\n  // into regions. Each region is marked \"inside\" if it belongs\n  // to the polygon, according to the rule given by this.windingRule.\n  // Each interior region is guaranteed be monotone.\n  libtess.sweep.computeInterior(this);\n\n  if (!this.fatalError) {\n    // If the user wants only the boundary contours, we throw away all edges\n    // except those which separate the interior from the exterior.\n    // Otherwise we tessellate all the regions marked \"inside\".\n    // NOTE(bckenny): we know this.mesh has been initialized, so help closure out.\n    var mesh = /** @type {!libtess.GluMesh} */(this.mesh);\n    if (this.boundaryOnly) {\n      libtess.tessmono.setWindingNumber(mesh, 1, true);\n    } else {\n      libtess.tessmono.tessellateInterior(mesh);\n    }\n\n    this.mesh.checkMesh();\n\n    if (this.callBegin_ || this.callEnd_ || this.callVertex_ ||\n        this.callEdgeFlag_ || this.callBeginData_ || this.callEndData_ ||\n        this.callVertexData_ || this.callEdgeFlagData_) {\n\n      if (this.boundaryOnly) {\n        // output boundary contours\n        libtess.render.renderBoundary(this, this.mesh);\n\n      } else {\n        // output triangles (with edge callback if one is set)\n        var flagEdges = !!(this.callEdgeFlag_ || this.callEdgeFlagData_);\n        libtess.render.renderMesh(this, this.mesh, flagEdges);\n      }\n    }\n\n    if (this.callMesh_) {\n      // Throw away the exterior faces, so that all faces are interior.\n      // This way the user doesn't have to check the \"inside\" flag,\n      // and we don't need to even reveal its existence. It also leaves\n      // the freedom for an implementation to not generate the exterior\n      // faces in the first place.\n      libtess.tessmono.discardExterior(this.mesh);\n      // user wants the mesh itself\n      this.callMesh_(this.mesh);\n\n      this.mesh = null;\n      this.polygonData_ = null;\n      return;\n    }\n  }\n\n  libtess.mesh.deleteMesh(this.mesh);\n  this.polygonData_ = null;\n  this.mesh = null;\n};\n\n\n/**\n * Return the tessellator to its original dormant state.\n * @private\n */\nlibtess.GluTesselator.prototype.makeDormant_ = function() {\n  if (this.mesh) {\n    libtess.mesh.deleteMesh(this.mesh);\n  }\n  this.state = libtess.GluTesselator.tessState_.T_DORMANT;\n  this.lastEdge_ = null;\n  this.mesh = null;\n};\n\n\n/**\n * [requireState_ description]\n * @private\n * @param {libtess.GluTesselator.tessState_} state [description].\n */\nlibtess.GluTesselator.prototype.requireState_ = function(state) {\n  if (this.state !== state) {\n    this.gotoState_(state);\n  }\n};\n\n\n/**\n * [gotoState_ description]\n * @private\n * @param  {libtess.GluTesselator.tessState_} newState [description].\n */\nlibtess.GluTesselator.prototype.gotoState_ = function(newState) {\n  while (this.state !== newState) {\n    // We change the current state one level at a time, to get to the desired\n    // state.\n    if (this.state < newState) {\n      switch (this.state) {\n        case libtess.GluTesselator.tessState_.T_DORMANT:\n          this.callErrorOrErrorData(\n              libtess.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);\n          this.gluTessBeginPolygon(null);\n          break;\n\n        case libtess.GluTesselator.tessState_.T_IN_POLYGON:\n          this.callErrorOrErrorData(\n              libtess.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR);\n          this.gluTessBeginContour();\n          break;\n      }\n\n    } else {\n      switch (this.state) {\n        case libtess.GluTesselator.tessState_.T_IN_CONTOUR:\n          this.callErrorOrErrorData(\n              libtess.errorType.GLU_TESS_MISSING_END_CONTOUR);\n          this.gluTessEndContour();\n          break;\n\n        case libtess.GluTesselator.tessState_.T_IN_POLYGON:\n          this.callErrorOrErrorData(\n              libtess.errorType.GLU_TESS_MISSING_END_POLYGON);\n          // this.gluTessEndPolygon() is too much work!\n          this.makeDormant_();\n          break;\n      }\n    }\n  }\n};\n\n\n/**\n * [addVertex_ description]\n * @private\n * @param {Array.<number>} coords [description].\n * @param {Object} data [description].\n */\nlibtess.GluTesselator.prototype.addVertex_ = function(coords, data) {\n  var e = this.lastEdge_;\n  if (e === null) {\n    // Make a self-loop (one vertex, one edge).\n    e = libtess.mesh.makeEdge(this.mesh);\n    libtess.mesh.meshSplice(e, e.sym);\n\n  } else {\n    // Create a new vertex and edge which immediately follow e\n    // in the ordering around the left face.\n    libtess.mesh.splitEdge(e);\n    e = e.lNext;\n  }\n\n  // The new vertex is now e.org.\n  e.org.data = data;\n  e.org.coords[0] = coords[0];\n  e.org.coords[1] = coords[1];\n  e.org.coords[2] = coords[2];\n\n  // The winding of an edge says how the winding number changes as we\n  // cross from the edge''s right face to its left face.  We add the\n  // vertices in such an order that a CCW contour will add +1 to\n  // the winding number of the region inside the contour.\n  e.winding = 1;\n  e.sym.winding = -1;\n\n  this.lastEdge_ = e;\n};\n\n\n/**\n * [cacheVertex_ description]\n * @private\n * @param {Array.<number>} coords [description].\n * @param {Object} data [description].\n */\nlibtess.GluTesselator.prototype.cacheVertex_ = function(coords, data) {\n  var v = this.cache[this.cacheCount];\n\n  v.data = data;\n  v.coords[0] = coords[0];\n  v.coords[1] = coords[1];\n  v.coords[2] = coords[2];\n  ++this.cacheCount;\n};\n\n\n/**\n * [emptyCache_ description]\n * @private\n */\nlibtess.GluTesselator.prototype.emptyCache_ = function() {\n  // NOTE(bckenny): surprise!\n  this.mesh = new libtess.GluMesh();\n\n  for (var i = 0; i < this.cacheCount; i++) {\n    var v = this.cache[i];\n    this.addVertex_(v.coords, v.data);\n  }\n\n  this.cacheCount = 0;\n  this.emptyCache = false;\n};\n\n\n// TODO(bckenny): all following conditional callbacks could be simplified\n// TODO(bckenny): using null for now, but may rework\n// TODO(bckenny): should add documentation that references in callback are volatile (or make a copy)\n// see README callback descriptions\n/**\n * [callBeginOrBeginData description]\n * @param {libtess.primitiveType} type [description].\n */\nlibtess.GluTesselator.prototype.callBeginOrBeginData = function(type) {\n  if (this.callBeginData_) {\n    this.callBeginData_(type, this.polygonData_);\n\n  } else if (this.callBegin_) {\n    this.callBegin_(type);\n  }\n};\n\n\n/**\n * [callVertexOrVertexData description]\n * @param {Object} data [description].\n */\nlibtess.GluTesselator.prototype.callVertexOrVertexData = function(data) {\n  if (this.callVertexData_) {\n    this.callVertexData_(data, this.polygonData_);\n\n  } else if (this.callVertex_) {\n    this.callVertex_(data);\n  }\n};\n\n\n/**\n * [callEdgeFlagOrEdgeFlagData description]\n * @param {boolean} flag [description].\n */\nlibtess.GluTesselator.prototype.callEdgeFlagOrEdgeFlagData = function(flag) {\n  if (this.callEdgeFlagData_) {\n    this.callEdgeFlagData_(flag, this.polygonData_);\n\n  } else if (this.callEdgeFlag_) {\n    this.callEdgeFlag_(flag);\n  }\n};\n\n\n/**\n * [callEndOrEndData description]\n */\nlibtess.GluTesselator.prototype.callEndOrEndData = function() {\n  if (this.callEndData_) {\n    this.callEndData_(this.polygonData_);\n\n  } else if (this.callEnd_) {\n    this.callEnd_();\n  }\n};\n\n\n/**\n * [callCombineOrCombineData description]\n * @param {Array.<number>} coords [description].\n * @param {Array.<Object>} data [description].\n * @param {Array.<number>} weight [description].\n * @return {Object} Interpolated vertex.\n */\nlibtess.GluTesselator.prototype.callCombineOrCombineData =\n    function(coords, data, weight) {\n\n  var interpData;\n  if (this.callCombineData_) {\n    interpData = this.callCombineData_(coords, data, weight, this.polygonData_);\n\n  } else if (this.callCombine_) {\n    interpData = this.callCombine_(coords, data, weight);\n  }\n\n  // TODO(bckenny): can't be undefined\n  if (interpData === undefined) {\n    interpData = null;\n  }\n  return interpData;\n};\n\n\n// TODO(bckenny): combine the enums in libtess\n/**\n * [callErrorOrErrorData description]\n * @param {(libtess.errorType|libtess.gluEnum)} errno [description].\n */\nlibtess.GluTesselator.prototype.callErrorOrErrorData = function(errno) {\n  if (this.callErrorData_) {\n    this.callErrorData_(errno, this.polygonData_);\n\n  } else if (this.callError_) {\n    this.callError_(errno);\n  }\n};\n\n\n\n/* global libtess */\n\n/**\n * Each face has a pointer to the next and previous faces in the\n * circular list, and a pointer to a half-edge with this face as\n * the left face (null if this is the dummy header). There is also\n * a field \"data\" for client data.\n *\n * @param {libtess.GluFace=} opt_nextFace\n * @param {libtess.GluFace=} opt_prevFace\n * @constructor\n * @struct\n */\nlibtess.GluFace = function(opt_nextFace, opt_prevFace) {\n  // TODO(bckenny): reverse order of params?\n\n  /**\n   * next face (never null)\n   * @type {!libtess.GluFace}\n   */\n  this.next = opt_nextFace || this;\n\n  /**\n   * previous face (never NULL)\n   * @type {!libtess.GluFace}\n   */\n  this.prev = opt_prevFace || this;\n\n  /**\n   * A half edge with this left face.\n   * @type {libtess.GluHalfEdge}\n   */\n  this.anEdge = null;\n\n  /**\n   * room for client's data\n   * @type {Object}\n   */\n  this.data = null;\n\n  /**\n   * This face is in the polygon interior.\n   * @type {boolean}\n   */\n  this.inside = false;\n};\n\n\n\n/* global libtess */\n\n/**\n * The fundamental data structure is the \"half-edge\". Two half-edges\n * go together to make an edge, but they point in opposite directions.\n * Each half-edge has a pointer to its mate (the \"symmetric\" half-edge sym),\n * its origin vertex (org), the face on its left side (lFace), and the\n * adjacent half-edges in the CCW direction around the origin vertex\n * (oNext) and around the left face (lNext). There is also a \"next\"\n * pointer for the global edge list (see below).\n *\n * The notation used for mesh navigation:\n *  sym   = the mate of a half-edge (same edge, but opposite direction)\n *  oNext = edge CCW around origin vertex (keep same origin)\n *  dNext = edge CCW around destination vertex (keep same dest)\n *  lNext = edge CCW around left face (dest becomes new origin)\n *  rNext = edge CCW around right face (origin becomes new dest)\n *\n * \"prev\" means to substitute CW for CCW in the definitions above.\n *\n * The circular edge list is special; since half-edges always occur\n * in pairs (e and e.sym), each half-edge stores a pointer in only\n * one direction. Starting at eHead and following the e.next pointers\n * will visit each *edge* once (ie. e or e.sym, but not both).\n * e.sym stores a pointer in the opposite direction, thus it is\n * always true that e.sym.next.sym.next === e.\n *\n * @param {libtess.GluHalfEdge=} opt_nextEdge\n * @constructor\n * @struct\n */\nlibtess.GluHalfEdge = function(opt_nextEdge) {\n  // TODO(bckenny): are these the right defaults? (from gl_meshNewMesh requirements)\n\n  /**\n   * doubly-linked list (prev==sym->next)\n   * @type {!libtess.GluHalfEdge}\n   */\n  this.next = opt_nextEdge || this;\n\n  // TODO(bckenny): how can this be required if created in pairs? move to factory creation only?\n  /**\n   * same edge, opposite direction\n   * @type {libtess.GluHalfEdge}\n   */\n  this.sym = null;\n\n  /**\n   * next edge CCW around origin\n   * @type {libtess.GluHalfEdge}\n   */\n  this.oNext = null;\n\n  /**\n   * next edge CCW around left face\n   * @type {libtess.GluHalfEdge}\n   */\n  this.lNext = null;\n\n  /**\n   * origin vertex (oVertex too long)\n   * @type {libtess.GluVertex}\n   */\n  this.org = null;\n\n  /**\n   * left face\n   * @type {libtess.GluFace}\n   */\n  this.lFace = null;\n\n  // Internal data (keep hidden)\n  // NOTE(bckenny): can't be private, though...\n\n  /**\n   * a region with this upper edge (see sweep.js)\n   * @type {libtess.ActiveRegion}\n   */\n  this.activeRegion = null;\n\n  /**\n   * change in winding number when crossing from the right face to the left face\n   * @type {number}\n   */\n  this.winding = 0;\n};\n\n// NOTE(bckenny): the following came from macros in mesh\n// TODO(bckenny): using methods as aliases for sym connections for now.\n// not sure about this approach. getters? renames?\n\n\n/**\n * [rFace description]\n * @return {libtess.GluFace} [description].\n */\nlibtess.GluHalfEdge.prototype.rFace = function() {\n  return this.sym.lFace;\n};\n\n\n/**\n * [dst description]\n * @return {libtess.GluVertex} [description].\n */\nlibtess.GluHalfEdge.prototype.dst = function() {\n  return this.sym.org;\n};\n\n\n/**\n * [oPrev description]\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.GluHalfEdge.prototype.oPrev = function() {\n  return this.sym.lNext;\n};\n\n\n/**\n * [lPrev description]\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.GluHalfEdge.prototype.lPrev = function() {\n  return this.oNext.sym;\n};\n\n// NOTE(bckenny): libtess.GluHalfEdge.dPrev is called nowhere in libtess and\n// isn't part of the current public API. It could be useful for mesh traversal\n// and manipulation if made public, however.\n/* istanbul ignore next */\n/**\n * The edge clockwise around destination vertex (keep same dest).\n * @return {libtess.GluHalfEdge}\n */\nlibtess.GluHalfEdge.prototype.dPrev = function() {\n  return this.lNext.sym;\n};\n\n\n/**\n * [rPrev description]\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.GluHalfEdge.prototype.rPrev = function() {\n  return this.sym.oNext;\n};\n\n\n/**\n * [dNext description]\n * @return {libtess.GluHalfEdge} [description].\n */\nlibtess.GluHalfEdge.prototype.dNext = function() {\n  return this.rPrev().sym;\n};\n\n\n// NOTE(bckenny): libtess.GluHalfEdge.rNext is called nowhere in libtess and\n// isn't part of the current public API. It could be useful for mesh traversal\n// and manipulation if made public, however.\n/* istanbul ignore next */\n/**\n * The edge CCW around the right face (origin of this becomes new dest).\n * @return {libtess.GluHalfEdge}\n */\nlibtess.GluHalfEdge.prototype.rNext = function() {\n  return this.oPrev().sym;\n};\n\n\n\n/* global libtess */\n\n/**\n * Creates a new mesh with no edges, no vertices,\n * and no loops (what we usually call a \"face\").\n *\n * @constructor\n * @struct\n */\nlibtess.GluMesh = function() {\n  /**\n   * dummy header for vertex list\n   * @type {libtess.GluVertex}\n   */\n  this.vHead = new libtess.GluVertex();\n\n  /**\n   * dummy header for face list\n   * @type {libtess.GluFace}\n   */\n  this.fHead = new libtess.GluFace();\n\n  /**\n   * dummy header for edge list\n   * @type {libtess.GluHalfEdge}\n   */\n  this.eHead = new libtess.GluHalfEdge();\n\n  /**\n   * and its symmetric counterpart\n   * @type {libtess.GluHalfEdge}\n   */\n  this.eHeadSym = new libtess.GluHalfEdge();\n\n  // TODO(bckenny): better way to pair these?\n  this.eHead.sym = this.eHeadSym;\n  this.eHeadSym.sym = this.eHead;\n};\n\n\n// TODO(bckenny): #ifndef NDEBUG\n/**\n * Checks mesh for self-consistency.\n */\nlibtess.GluMesh.prototype.checkMesh = function() {\n  if (!libtess.DEBUG) {\n    return;\n  }\n\n  var fHead = this.fHead;\n  var vHead = this.vHead;\n  var eHead = this.eHead;\n\n  var e;\n\n  // faces\n  var f;\n  var fPrev = fHead;\n  for (fPrev = fHead; (f = fPrev.next) !== fHead; fPrev = f) {\n    e = f.anEdge;\n    do {\n      e = e.lNext;\n    } while (e !== f.anEdge);\n  }\n\n  // vertices\n  var v;\n  var vPrev = vHead;\n  for (vPrev = vHead; (v = vPrev.next) !== vHead; vPrev = v) {\n    e = v.anEdge;\n    do {\n      e = e.oNext;\n    } while (e !== v.anEdge);\n  }\n\n  // edges\n  var ePrev = eHead;\n  for (ePrev = eHead; (e = ePrev.next) !== eHead; ePrev = e) {\n  }\n};\n\n\n\n/* global libtess */\n\n/**\n * Each vertex has a pointer to next and previous vertices in the\n * circular list, and a pointer to a half-edge with this vertex as\n * the origin (null if this is the dummy header). There is also a\n * field \"data\" for client data.\n *\n * @param {libtess.GluVertex=} opt_nextVertex [description].\n * @param {libtess.GluVertex=} opt_prevVertex [description].\n * @constructor\n * @struct\n */\nlibtess.GluVertex = function(opt_nextVertex, opt_prevVertex) {\n  // TODO(bckenny): reverse order of params?\n\n  /**\n   * Next vertex (never null).\n   * @type {!libtess.GluVertex}\n   */\n  this.next = opt_nextVertex || this;\n\n  /**\n   * Previous vertex (never null).\n   * @type {!libtess.GluVertex}\n   */\n  this.prev = opt_prevVertex || this;\n\n  /**\n   * A half-edge with this origin.\n   * @type {libtess.GluHalfEdge}\n   */\n  this.anEdge = null;\n\n  /**\n   * The client's data.\n   * @type {Object}\n   */\n  this.data = null;\n\n  /**\n   * The vertex location in 3D.\n   * @type {!Array.<number>}\n   */\n  this.coords = [0, 0, 0];\n  // TODO(bckenny): we may want to rethink coords, either eliminate (using s\n  // and t and user data) or index into contiguous storage?\n\n  /**\n   * Component of projection onto the sweep plane.\n   * @type {number}\n   */\n  this.s = 0;\n\n  /**\n   * Component of projection onto the sweep plane.\n   * @type {number}\n   */\n  this.t = 0;\n\n  /**\n   * To allow deletion from priority queue.\n   * @type {?libtess.PQHandle}\n   */\n  this.pqHandle = null;\n  // NOTE(bckenny): pqHandle inited in sweep\n  // TODO(bckenny): can we have a numeric default value? null may do bad things\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): more specific typing on key\n\n/**\n * [PQHandleElem description]\n * @constructor\n * @struct\n */\nlibtess.PQHandleElem = function() {\n  // TODO(bckenny): if key could instead be an indexed into another store, makes heap storage a lot easier\n\n  /**\n   * [key description]\n   * @type {libtess.PQKey}\n   */\n  this.key = null;\n\n  /**\n   * [node description]\n   * @type {libtess.PQHandle}\n   */\n  this.node = 0;\n};\n\n\n/**\n * Allocate a PQHandleElem array of size size. If oldArray is not null, its\n * contents are copied to the beginning of the new array. The rest of the array\n * is filled with new PQHandleElems.\n *\n * @param {?Array.<libtess.PQHandleElem>} oldArray [description].\n * @param {number} size [description].\n * @return {Array.<libtess.PQHandleElem>} [description].\n */\nlibtess.PQHandleElem.realloc = function(oldArray, size) {\n  var newArray = new Array(size);\n\n  // TODO(bckenny): better to reallocate array? or grow array?\n  var index = 0;\n  if (oldArray !== null) {\n    for (; index < oldArray.length; index++) {\n      newArray[index] = oldArray[index];\n    }\n  }\n\n  for (; index < size; index++) {\n    newArray[index] = new libtess.PQHandleElem();\n  }\n\n  return newArray;\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): maybe just have these created inline as literals\n// (or unboxed directly - PQHandle is just an array index number)\n\n/**\n * [PQNode description]\n * @constructor\n * @struct\n */\nlibtess.PQNode = function() {\n  /**\n   * [handle description]\n   * @type {libtess.PQHandle}\n   */\n  this.handle = 0;\n};\n\n\n/**\n * Allocate a PQNode array of size size. If oldArray is not null, its contents\n * are copied to the beginning of the new array. The rest of the array is\n * filled with new PQNodes.\n *\n * @param {?Array.<libtess.PQNode>} oldArray [description].\n * @param {number} size [description].\n * @return {Array.<libtess.PQNode>} [description].\n */\nlibtess.PQNode.realloc = function(oldArray, size) {\n  var newArray = new Array(size);\n\n  // TODO(bckenny): better to reallocate array? or grow array?\n  var index = 0;\n  if (oldArray !== null) {\n    for (; index < oldArray.length; index++) {\n      newArray[index] = oldArray[index];\n    }\n  }\n\n  for (; index < size; index++) {\n    newArray[index] = new libtess.PQNode();\n  }\n\n  return newArray;\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): preallocating arrays may actually be hurting us in sort\n// performance (esp if theres some undefs in there)\n\n/**\n * [PriorityQ description]\n * @constructor\n * @struct\n * @param {function(Object, Object): boolean} leq [description].\n */\nlibtess.PriorityQ = function(leq) {\n  /**\n   * [keys description]\n   * @private\n   * @type {Array.<libtess.PQKey>}\n   */\n  this.keys_ = libtess.PriorityQ.prototype.PQKeyRealloc_(null,\n      libtess.PriorityQ.INIT_SIZE_);\n\n  /**\n   * Array of indexes into this.keys_\n   * @private\n   * @type {Array.<number>}\n   */\n  this.order_ = null;\n\n  /**\n   * [size description]\n   * @private\n   * @type {number}\n   */\n  this.size_ = 0;\n\n  /**\n   * [max_ description]\n   * @private\n   * @type {number}\n   */\n  this.max_ = libtess.PriorityQ.INIT_SIZE_;\n\n  /**\n   * [initialized description]\n   * @private\n   * @type {boolean}\n   */\n  this.initialized_ = false;\n\n  // TODO(bckenny): leq was inlined by define in original, but appears to just\n  // be vertLeq, as passed. keep an eye on this as to why its not used.\n  /**\n   * [leq description]\n   * @private\n   * @type {function(libtess.PQKey, libtess.PQKey): boolean}\n   */\n  this.leq_ =\n      /** @type {function(libtess.PQKey, libtess.PQKey): boolean} */(leq);\n\n  /**\n   * [heap_ description]\n   * @private\n   * @type {libtess.PriorityQHeap}\n   */\n  this.heap_ = new libtess.PriorityQHeap(this.leq_);\n};\n\n\n/**\n * [INIT_SIZE_ description]\n * @private\n * @const\n * @type {number}\n */\nlibtess.PriorityQ.INIT_SIZE_ = 32;\n\n\n/**\n * [deleteQ description]\n */\nlibtess.PriorityQ.prototype.deleteQ = function() {\n  // TODO(bckenny): unnecessary, I think.\n  this.heap_.deleteHeap();\n  this.heap_ = null;\n  this.order_ = null;\n  this.keys_ = null;\n  // NOTE(bckenny): nulled at callsite (sweep.donePriorityQ_)\n};\n\n\n/**\n * [init description]\n */\nlibtess.PriorityQ.prototype.init = function() {\n  // TODO(bckenny): reuse. in theory, we don't have to empty this, as access is\n  // dictated by this.size_, but array.sort doesn't know that\n  this.order_ = [];\n\n  // Create an array of indirect pointers to the keys, so that\n  // the handles we have returned are still valid.\n  // TODO(bckenny): valid for when? it appears we can just store indexes into\n  // keys_, but what did this mean?\n  for (var i = 0; i < this.size_; i++) {\n    this.order_[i] = i;\n  }\n\n  // sort the indirect pointers in descending order of the keys themselves\n  // TODO(bckenny): make sure it's ok that keys[a] === keys[b] returns 1\n  // TODO(bckenny): unstable sort means we may get slightly different polys in\n  // different browsers, but only when passing in equal points\n  // TODO(bckenny): make less awkward closure?\n  var comparator = (function(keys, leq) {\n    return function(a, b) {\n      return leq(keys[a], keys[b]) ? 1 : -1;\n    };\n  })(this.keys_, this.leq_);\n  this.order_.sort(comparator);\n\n  this.max_ = this.size_;\n  this.initialized_ = true;\n  this.heap_.init();\n\n  // TODO(bckenny):\n  // #ifndef NDEBUG\n  if (libtess.DEBUG) {\n    var p = 0;\n    var r = p + this.size_ - 1;\n    for (i = p; i < r; ++i) {\n    }\n  }\n  // #endif\n};\n\n\n/**\n * [insert description]\n * @param {libtess.PQKey} keyNew [description].\n * @return {libtess.PQHandle} [description].\n */\nlibtess.PriorityQ.prototype.insert = function(keyNew) {\n  // NOTE(bckenny): originally returned LONG_MAX as alloc failure signal. no\n  // longer does.\n  if (this.initialized_) {\n    return this.heap_.insert(keyNew);\n  }\n\n  var curr = this.size_;\n  if (++this.size_ >= this.max_) {\n    // If the heap overflows, double its size.\n    this.max_ *= 2;\n    this.keys_ =\n        libtess.PriorityQ.prototype.PQKeyRealloc_(this.keys_, this.max_);\n  }\n\n  this.keys_[curr] = keyNew;\n\n  // Negative handles index the sorted array.\n  return -(curr + 1);\n};\n\n\n/**\n * Allocate a PQKey array of size size. If oldArray is not null, its\n * contents are copied to the beginning of the new array. The rest of the array\n * is filled with nulls.\n *\n * @private\n * @param {?Array.<libtess.PQKey>} oldArray [description].\n * @param {number} size [description].\n * @return {Array.<(?libtess.PQKey)>} [description].\n */\nlibtess.PriorityQ.prototype.PQKeyRealloc_ = function(oldArray, size) {\n  // TODO(bckenny): double check return type. can we have ? there?\n  var newArray = new Array(size);\n\n  // TODO(bckenny): better to reallocate array? or grow array?\n  var index = 0;\n  if (oldArray !== null) {\n    for (; index < oldArray.length; index++) {\n      newArray[index] = oldArray[index];\n    }\n  }\n\n  for (; index < size; index++) {\n    newArray[index] = null;\n  }\n\n  return newArray;\n};\n\n// NOTE(bckenny): libtess.PriorityQ.keyLessThan_ is called nowhere in libtess\n// and isn't part of the public API.\n/* istanbul ignore next */\n/**\n * Whether x is less than y according to this.leq_.\n * @private\n * @param {number} x\n * @param {number} y\n * @return {boolean}\n */\nlibtess.PriorityQ.prototype.keyLessThan_ = function(x, y) {\n  // NOTE(bckenny): was macro LT\n  var keyX = this.keys_[x];\n  var keyY = this.keys_[y];\n  return !this.leq_(keyY, keyX);\n};\n\n// NOTE(bckenny): libtess.PriorityQ.keyGreaterThan_ is called nowhere in libtess\n// and isn't part of the public API.\n/* istanbul ignore next */\n/**\n * Whether x is greater than y according to this.leq_.\n * @private\n * @param {number} x\n * @param {number} y\n * @return {boolean}\n */\nlibtess.PriorityQ.prototype.keyGreaterThan_ = function(x, y) {\n  // NOTE(bckenny): was macro GT\n  var keyX = this.keys_[x];\n  var keyY = this.keys_[y];\n  return !this.leq_(keyX, keyY);\n};\n\n\n/**\n * [extractMin description]\n * @return {libtess.PQKey} [description].\n */\nlibtess.PriorityQ.prototype.extractMin = function() {\n  if (this.size_ === 0) {\n    return this.heap_.extractMin();\n  }\n\n  var sortMin = this.keys_[this.order_[this.size_ - 1]];\n  if (!this.heap_.isEmpty()) {\n    var heapMin = this.heap_.minimum();\n    if (this.leq_(heapMin, sortMin)) {\n      return this.heap_.extractMin();\n    }\n  }\n\n  do {\n    --this.size_;\n  } while (this.size_ > 0 && this.keys_[this.order_[this.size_ - 1]] === null);\n\n  return sortMin;\n};\n\n\n/**\n * [minimum description]\n * @return {libtess.PQKey} [description].\n */\nlibtess.PriorityQ.prototype.minimum = function() {\n  if (this.size_ === 0) {\n    return this.heap_.minimum();\n  }\n\n  var sortMin = this.keys_[this.order_[this.size_ - 1]];\n  if (!this.heap_.isEmpty()) {\n    var heapMin = this.heap_.minimum();\n    if (this.leq_(heapMin, sortMin)) {\n      return heapMin;\n    }\n  }\n\n  return sortMin;\n};\n\n// NOTE(bckenny): libtess.PriorityQ.isEmpty_ isn't called within libtess and\n// isn't part of the public API. For now, leaving in but ignoring for coverage.\n/* istanbul ignore next */\n/**\n * Returns whether the priority queue is empty.\n * @private\n * @return {boolean}\n */\nlibtess.PriorityQ.prototype.isEmpty_ = function() {\n  return (this.size_ === 0) && this.heap_.isEmpty();\n};\n\n\n/**\n * [remove description]\n * @param {libtess.PQHandle} curr [description].\n */\nlibtess.PriorityQ.prototype.remove = function(curr) {\n  if (curr >= 0) {\n    this.heap_.remove(curr);\n    return;\n  }\n  curr = -(curr + 1);\n\n  this.keys_[curr] = null;\n  while (this.size_ > 0 && this.keys_[this.order_[this.size_ - 1]] === null) {\n    --this.size_;\n  }\n};\n\n\n\n/* global libtess */\n\n// TODO(bckenny): keys appear to always be GluVertex in this case?\n\n/**\n * [PriorityQHeap description]\n * @constructor\n * @struct\n * @param {function(libtess.PQKey, libtess.PQKey): boolean} leq [description].\n */\nlibtess.PriorityQHeap = function(leq) {\n  /**\n   * The heap itself. Active nodes are stored in the range 1..size. Each node\n   * stores only an index into handles.\n   * @private\n   * @type {Array.<libtess.PQNode>}\n   */\n  this.nodes_ = libtess.PQNode.realloc(null,\n      libtess.PriorityQHeap.INIT_SIZE_ + 1);\n\n  /**\n   * Each handle stores a key, plus a pointer back to the node which currently\n   * represents that key (ie. nodes[handles[i].node].handle == i).\n   * @private\n   * @type {Array.<libtess.PQHandleElem>}\n   */\n  this.handles_ = libtess.PQHandleElem.realloc(null,\n      libtess.PriorityQHeap.INIT_SIZE_ + 1);\n\n  // TODO(bckenny): size and max should probably be libtess.PQHandle for correct\n  // typing (see PriorityQ.js)\n  /**\n   * The size of the queue.\n   * @private\n   * @type {number}\n   */\n  this.size_ = 0;\n\n  /**\n   * The queue's current allocated space.\n   * @private\n   * @type {number}\n   */\n  this.max_ = libtess.PriorityQHeap.INIT_SIZE_;\n\n  /**\n   * The index of the next free hole in the handles array. Handle in that slot\n   * has next item in freeList in its node propert. If there are no holes,\n   * freeList === 0 and one at the end of handles must be use.\n   * @private\n   * @type {libtess.PQHandle}\n   */\n  this.freeList_ = 0;\n\n  /**\n   * Indicates that the heap has been initialized via init. If false, inserts\n   * are fast insertions at the end of a list. If true, all inserts will now be\n   * correctly ordered in the queue before returning.\n   * @private\n   * @type {boolean}\n   */\n  this.initialized_ = false;\n\n  // TODO(bckenny): leq was inlined by define in original, but appears to\n  // be vertLeq, as passed. Using injected version, but is it better just to\n  // manually inline?\n  /**\n   * [leq description]\n   * @private\n   * @type {function(libtess.PQKey, libtess.PQKey): boolean}\n   */\n  this.leq_ = leq;\n\n  // so that minimum returns null\n  this.nodes_[1].handle = 1;\n};\n\n\n/**\n * [INIT_SIZE_ description]\n * @private\n * @const\n * @type {number}\n */\nlibtess.PriorityQHeap.INIT_SIZE_ = 32;\n\n\n/**\n * [deleteHeap description]\n */\nlibtess.PriorityQHeap.prototype.deleteHeap = function() {\n  // TODO(bckenny): unnecessary, I think.\n  this.handles_ = null;\n  this.nodes_ = null;\n  // NOTE(bckenny): nulled at callsite in PriorityQ.deleteQ\n};\n\n\n/**\n * Initializing ordering of the heap. Must be called before any method other\n * than insert is called to ensure correctness when removing or querying.\n */\nlibtess.PriorityQHeap.prototype.init = function() {\n  // This method of building a heap is O(n), rather than O(n lg n).\n  for (var i = this.size_; i >= 1; --i) {\n    this.floatDown_(i);\n  }\n\n  this.initialized_ = true;\n};\n\n\n/**\n * Insert a new key into the heap.\n * @param {libtess.PQKey} keyNew The key to insert.\n * @return {libtess.PQHandle} A handle that can be used to remove the key.\n */\nlibtess.PriorityQHeap.prototype.insert = function(keyNew) {\n  var curr = ++this.size_;\n\n  // if the heap overflows, double its size.\n  if ((curr * 2) > this.max_) {\n    this.max_ *= 2;\n    this.nodes_ = libtess.PQNode.realloc(this.nodes_, this.max_ + 1);\n    this.handles_ = libtess.PQHandleElem.realloc(this.handles_, this.max_ + 1);\n  }\n\n  var free;\n  if (this.freeList_ === 0) {\n    free = curr;\n  } else {\n    free = this.freeList_;\n    this.freeList_ = this.handles_[free].node;\n  }\n\n  this.nodes_[curr].handle = free;\n  this.handles_[free].node = curr;\n  this.handles_[free].key = keyNew;\n\n  if (this.initialized_) {\n    this.floatUp_(curr);\n  }\n\n  return free;\n};\n\n\n/**\n * @return {boolean} Whether the heap is empty.\n */\nlibtess.PriorityQHeap.prototype.isEmpty = function() {\n  return this.size_ === 0;\n};\n\n\n/**\n * Returns the minimum key in the heap. If the heap is empty, null will be\n * returned.\n * @return {libtess.PQKey} [description].\n */\nlibtess.PriorityQHeap.prototype.minimum = function() {\n  return this.handles_[this.nodes_[1].handle].key;\n};\n\n\n/**\n * Removes the minimum key from the heap and returns it. If the heap is empty,\n * null will be returned.\n * @return {libtess.PQKey} [description].\n */\nlibtess.PriorityQHeap.prototype.extractMin = function() {\n  var n = this.nodes_;\n  var h = this.handles_;\n  var hMin = n[1].handle;\n  var min = h[hMin].key;\n\n  if (this.size_ > 0) {\n    n[1].handle = n[this.size_].handle;\n    h[n[1].handle].node = 1;\n\n    h[hMin].key = null;\n    h[hMin].node = this.freeList_;\n    this.freeList_ = hMin;\n\n    if (--this.size_ > 0) {\n      this.floatDown_(1);\n    }\n  }\n\n  return min;\n};\n\n\n/**\n * Remove key associated with handle hCurr (returned from insert) from heap.\n * @param {libtess.PQHandle} hCurr [description].\n */\nlibtess.PriorityQHeap.prototype.remove = function(hCurr) {\n  var n = this.nodes_;\n  var h = this.handles_;\n\n  var curr = h[hCurr].node;\n  n[curr].handle = n[this.size_].handle;\n  h[n[curr].handle].node = curr;\n\n  if (curr <= --this.size_) {\n    if (curr <= 1 ||\n        this.leq_(h[n[curr >> 1].handle].key, h[n[curr].handle].key)) {\n\n      this.floatDown_(curr);\n    } else {\n      this.floatUp_(curr);\n    }\n  }\n\n  h[hCurr].key = null;\n  h[hCurr].node = this.freeList_;\n  this.freeList_ = hCurr;\n};\n\n\n/**\n * [floatDown_ description]\n * @private\n * @param {libtess.PQHandle} curr [description].\n */\nlibtess.PriorityQHeap.prototype.floatDown_ = function(curr) {\n  var n = this.nodes_;\n  var h = this.handles_;\n\n  var hCurr = n[curr].handle;\n  for (;;) {\n    // The children of node i are nodes 2i and 2i+1.\n    // set child to the index of the child with the minimum key\n    var child = curr << 1;\n    if (child < this.size_ &&\n        this.leq_(h[n[child + 1].handle].key, h[n[child].handle].key)) {\n\n      ++child;\n    }\n\n    var hChild = n[child].handle;\n    if (child > this.size_ || this.leq_(h[hCurr].key, h[hChild].key)) {\n      n[curr].handle = hCurr;\n      h[hCurr].node = curr;\n      break;\n    }\n    n[curr].handle = hChild;\n    h[hChild].node = curr;\n    curr = child;\n  }\n};\n\n\n/**\n * [floatUp_ description]\n * @private\n * @param {libtess.PQHandle} curr [description].\n */\nlibtess.PriorityQHeap.prototype.floatUp_ = function(curr) {\n  var n = this.nodes_;\n  var h = this.handles_;\n\n  var hCurr = n[curr].handle;\n  for (;;) {\n    var parent = curr >> 1;\n    var hParent = n[parent].handle;\n    if (parent === 0 || this.leq_(h[hParent].key, h[hCurr].key)) {\n      n[curr].handle = hCurr;\n      h[hCurr].node = curr;\n      break;\n    }\n\n    n[curr].handle = hParent;\n    h[hParent].node = curr;\n    curr = parent;\n  }\n};\n\n\n/* global libtess */\n\n// TODO(bckenny): apparently only visible outside of sweep for debugging routines.\n// find out if we can hide\n\n/**\n * For each pair of adjacent edges crossing the sweep line, there is\n * an ActiveRegion to represent the region between them. The active\n * regions are kept in sorted order in a dynamic dictionary. As the\n * sweep line crosses each vertex, we update the affected regions.\n * @constructor\n * @struct\n */\nlibtess.ActiveRegion = function() {\n  // TODO(bckenny): I *think* eUp and nodeUp could be passed in as constructor params\n\n  /**\n   * The upper edge of the region, directed right to left\n   * @type {libtess.GluHalfEdge}\n   */\n  this.eUp = null;\n\n  /**\n   * Dictionary node corresponding to eUp edge.\n   * @type {libtess.DictNode}\n   */\n  this.nodeUp = null;\n\n  /**\n   * Used to determine which regions are inside the polygon.\n   * @type {number}\n   */\n  this.windingNumber = 0;\n\n  /**\n   * Whether this region is inside the polygon.\n   * @type {boolean}\n   */\n  this.inside = false;\n\n  /**\n   * Marks fake edges at t = +/-infinity.\n   * @type {boolean}\n   */\n  this.sentinel = false;\n\n  /**\n   * Marks regions where the upper or lower edge has changed, but we haven't\n   * checked whether they intersect yet.\n   * @type {boolean}\n   */\n  this.dirty = false;\n\n  /**\n   * marks temporary edges introduced when we process a \"right vertex\" (one\n   * without any edges leaving to the right)\n   * @type {boolean}\n   */\n  this.fixUpperEdge = false;\n};\n\n/**\n * Returns the ActiveRegion below this one.\n * @return {libtess.ActiveRegion}\n */\nlibtess.ActiveRegion.prototype.regionBelow = function() {\n  return this.nodeUp.getPredecessor().getKey();\n};\n\n/**\n * Returns the ActiveRegion above this one.\n * @return {libtess.ActiveRegion}\n */\nlibtess.ActiveRegion.prototype.regionAbove = function() {\n  return this.nodeUp.getSuccessor().getKey();\n};\n\n/* global libtess, module */\n\nexport default libtess;\n","import WorldWind from 'webworldwind-esa';\n\nconst {\n    GpuProgram\n} = WorldWind;\n\nexport default class ScreenColorProgram extends GpuProgram {\n\n    constructor(gl) {\n        const vertexShaderSource =\n            'attribute vec3 a_position;\\n' +\n\n            'uniform vec2 u_resolution;\\n' +\n\n            'void main() {\\n' +\n                // convert the position from pixels to 0.0 to 1.0\n            '   vec2 zeroToOne = a_position.xy / u_resolution;\\n' +\n\n                // convert from 0->1 to 0->2\n            '   vec2 zeroToTwo = zeroToOne * 2.0;\\n' +\n\n                // convert from 0->2 to -1->+1 (clipspace)\n            '   vec2 clipSpace = zeroToTwo - 1.0;\\n' +\n\n            '   gl_Position = vec4(clipSpace, 0, 1);\\n' +\n            '}';\n\n        const fragmentShaderSource =\n            'precision mediump float;\\n' +\n\n            'uniform vec4 color;\\n' +\n\n            'void main() {\\n' +\n            '   gl_FragColor = color;\\n' +\n            '}';\n\n        super(gl, vertexShaderSource, fragmentShaderSource, ['a_position']);\n\n        this.resolutionLocation = this.uniformLocation(gl, 'u_resolution');\n        this.colorLocation = this.uniformLocation(gl, 'color');\n\n        this.localCache = {\n            resolution: {\n                width: null,\n                height: null,\n            },\n            color: {\n                r: null,\n                g: null,\n                b: null,\n                a: null,\n            },\n        };\n    }\n\n    loadResolution(gl, width, height) {\n        if (this.localCache.resolution.width === width && this.localCache.resolution.height === height) {\n            return;\n        }\n        gl.uniform2f(this.resolutionLocation, width, height);\n        this.localCache.resolution.width = width;\n        this.localCache.resolution.height = height;\n    }\n\n    loadColor(gl, color) {\n        const cacheColor = this.localCache.color;\n        if (cacheColor.r === color.red &&\n            cacheColor.g === color.green &&\n            cacheColor.b === color.blue &&\n            cacheColor.a === color.alpha) {\n            return;\n        }\n        const a = color.alpha;\n        gl.uniform4f(this.colorLocation, color.red * a, color.green * a, color.blue * a, color.alpha);\n        cacheColor.r = color.red;\n        cacheColor.g = color.green;\n        cacheColor.b = color.blue;\n        cacheColor.a = color.alpha;\n    }\n\n}\n\nScreenColorProgram.key = 'WorldWindGpuScreenColorProgram';","import WorldWind from 'webworldwind-esa';\n\nconst {\n    GpuProgram\n} = WorldWind;\n\nexport default class ScreenTextureProgram extends GpuProgram {\n\n    constructor(gl) {\n        const vertexShaderSource =\n            'attribute vec3 a_position;\\n' +\n            'attribute vec2 vertexTexCoord;\\n' +\n\n            'uniform vec2 u_resolution;\\n' +\n\n            'varying vec2 texCoord;\\n' +\n\n            'void main() {\\n' +\n            // convert the position from pixels to 0.0 to 1.0\n            '   vec2 zeroToOne = a_position.xy / u_resolution;\\n' +\n\n            // convert from 0->1 to 0->2\n            '   vec2 zeroToTwo = zeroToOne * 2.0;\\n' +\n\n            // convert from 0->2 to -1->+1 (clipspace)\n            '   vec2 clipSpace = zeroToTwo - 1.0;\\n' +\n\n            '   gl_Position = vec4(clipSpace, 0, 1);\\n' +\n            '   gl_PointSize = 3.0;\\n' +\n            '   texCoord = vertexTexCoord;\\n' +\n            '}';\n\n        const fragmentShaderSource =\n            'precision mediump float;\\n' +\n\n            'uniform sampler2D textureSampler;\\n' +\n\n            'varying vec2 texCoord;\\n' +\n\n            'void main() {\\n' +\n            '   gl_FragColor = texture2D(textureSampler, texCoord);\\n' +\n            //'   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\\n' +\n            '}';\n\n        super(gl, vertexShaderSource, fragmentShaderSource, ['a_position', 'vertexTexCoord']);\n\n        this.resolutionLocation = this.uniformLocation(gl, 'u_resolution');\n        this.texUnitLocation = this.uniformLocation(gl, 'textureSampler');\n\n        this.localCache = {\n            resolution: {\n                width: null,\n                height: null,\n            },\n            textureUnit: null,\n        };\n    }\n\n    loadResolution(gl, width, height) {\n        if (this.localCache.resolution.width === width && this.localCache.resolution.height === height) {\n            return;\n        }\n        gl.uniform2f(this.resolutionLocation, width, height);\n        this.localCache.resolution.width = width;\n        this.localCache.resolution.height = height;\n    }\n\n    loadTextureUnit(gl, unit) {\n        if (this.localCache.textureUnit === unit) {\n            return;\n        }\n        gl.uniform1i(this.texUnitLocation, unit - gl.TEXTURE0);\n        this.localCache.textureUnit = unit;\n    }\n\n}\n\nScreenTextureProgram.key = 'WorldWindGpuScreenTextureProgram';","import libtess from './libtess';\nimport ScreenColorProgram from './ScreenColorProgram';\nimport ScreenTextureProgram from './ScreenTextureProgram';\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    Angle,\n    Location,\n    PickedObject,\n    SurfaceShape,\n    Texture\n} = WorldWind;\n\nconst WGS84_SEMI_MAJOR_AXIS = 6378137.0;\n\nexport default class TexturedSurfaceShape extends SurfaceShape {\n\n    static tesselator() {\n        if (!TexturedSurfaceShape.tess) {\n            TexturedSurfaceShape.tess = new libtess.GluTesselator();\n        }\n        return TexturedSurfaceShape.tess;\n    }\n\n    static staticStateKey(shape) {\n        shape.stateKeyInvalid = false;\n\n        if (shape.highlighted) {\n            if (!shape._highlightAttributes) {\n                if (!shape._attributes) {\n                    shape._attributesStateKey = null;\n                } else {\n                    shape._attributesStateKey = shape._attributes.stateKey;\n                }\n            } else {\n                shape._attributesStateKey = shape._highlightAttributes.stateKey;\n            }\n        } else {\n            if (!shape._attributes) {\n                shape._attributesStateKey = null;\n            } else {\n                shape._attributesStateKey = shape._attributes.stateKey;\n            }\n        }\n\n        let sector = ' se []';\n        if(shape.sector) {\n            sector = shape.sector.minLatitude + ',' +\n                shape.sector.maxLatitude + ',' +\n                shape.sector.minLongitude + ',' +\n                shape.sector.maxLongitude;\n        }\n\n        return 'dn ' + shape.displayName +\n            ' at ' + (!shape._attributesStateKey ? 'null' : shape._attributesStateKey) +\n            ' hi ' + shape.highlighted +\n            ' en ' + shape.enabled +\n            ' pt ' + shape.pathType +\n            ' ne ' + shape.maximumNumEdgeIntervals +\n            ' po ' + shape.polarThrottle +\n            ' img ' + !!shape.image +\n            ' se ' + '[' +\n            sector +\n            ']';\n    }\n\n    constructor(attributes) {\n        super(attributes);\n\n        this._image = null;\n        this._imageUUID = '';\n        this._interiorVboCacheKey = '';\n        this._outlineVboCacheKey = '';\n\n        this._contoursPrepered = false;\n        this._contoursInfo = [];\n    }\n\n    get image() {\n        return this._image;\n    }\n\n    set image(img) {\n        this._image = img;\n        this.stateKeyInvalid = true;\n    }\n\n    get imageUUID() {\n        return this._imageUUID;\n    }\n\n    set imageUUID(value) {\n        this._imageUUID = value;\n    }\n\n    renderToTexture(dc, fbo, xScale, yScale, dx, dy) {\n        const attributes = (this._highlighted ? (this._highlightAttributes || this._attributes) : this._attributes);\n        const drawInterior = (!this._isInteriorInhibited && attributes.drawInterior);\n        const drawOutline = (attributes.drawOutline && attributes.outlineWidth > 0);\n\n        if (!drawInterior && !drawOutline) {\n            return;\n        }\n\n        if (dc.pickingMode && !this.pickColor) {\n            this.pickColor = dc.uniquePickColor();\n        }\n\n        //TODO pass width and height from SurfaceShapeTile\n        const tileWidth = 256;\n        const tileHeight = 256;\n\n        var i;\n        const interiorGeometry = this.mapGeometry(this._interiorGeometry, xScale, yScale, dx, dy);\n        for (i = 0; i < interiorGeometry.length; i++) {\n            if (!this._contoursPrepered) {\n                var wo = this.windingOrder_all(interiorGeometry[i]);\n                this._contoursInfo.push({wo: wo});\n            }\n\n            var points = interiorGeometry[i];\n            if (points[0] === points[points.length - 2] && points[1] === points[points.length - 1]) {\n                points.pop();\n                points.pop();\n            }\n        }\n\n        if (this._image && !dc.pickingMode && !this.crossesAntiMeridian && !this.containsPole) {\n            if (!this._contoursPrepered) {\n                if (interiorGeometry.length === 1) {\n                    const {anglesMap, topLeftIndex} = this.getCorners(interiorGeometry[0], this._contoursInfo[0].wo);\n                    if(!anglesMap){\n                        //discarted getCorners\n                        return;\n                    }\n                    const uvs = this.computeUvs(this._contoursInfo[0].wo, anglesMap, topLeftIndex, this._interiorGeometry[0]);\n                    this._contoursInfo[0].anglesMap = anglesMap;\n                    this._contoursInfo[0].topLeftIndex = topLeftIndex;\n                    this._contoursInfo[0].uvs = uvs;\n\n                    var tessGeom = this.tessellate_p1(interiorGeometry[0], uvs);\n                    var tessIndices = [];\n                    for (i = 0; i < tessGeom.length; i += 5) {\n                        var x = tessGeom[i];\n                        var y = tessGeom[i + 1];\n\n                        for (var j = 0; j < interiorGeometry[0].length; j += 2) {\n                            var px = interiorGeometry[0][j];\n                            var py = interiorGeometry[0][j + 1];\n                            if (px === x && py === y) {\n                                tessIndices.push(j / 2);\n                                break;\n                            }\n                        }\n                    }\n                    this._contoursInfo[0].iboData = new Uint16Array(tessIndices);\n\n                    var len = Math.floor(interiorGeometry[0].length / 2) * 5;\n                    this._contoursInfo[0].vboData = new Float32Array(len);\n\n                    var vboData = this._contoursInfo[0].vboData;\n                    var k = 0;\n                    for (i = 0; i < vboData.length; i += 5) {\n                        vboData[i] = interiorGeometry[k];\n                        vboData[i + 1] = interiorGeometry[k + 1];\n                        vboData[i + 2] = 0;\n                        vboData[i + 3] = uvs[k];\n                        vboData[i + 4] = uvs[k + 1];\n                        k += 2;\n                    }\n\n                    this._contoursPrepered = true;\n                }\n                else {\n\n                }\n                //this._contoursPrepered = true;\n            }\n            this.renderTexture(dc, {\n                points: interiorGeometry[0],\n                tileWidth,\n                tileHeight,\n                xScale,\n                yScale,\n                dx,\n                dy,\n            });\n        }\n        else {\n            this.renderColor(dc, {\n                tileWidth,\n                tileHeight,\n                xScale,\n                yScale,\n                dx,\n                dy,\n                drawInterior,\n                interiorColor: attributes.interiorColor,\n                drawOutline,\n                outlineColor: attributes.outlineColor,\n            });\n            this._contoursPrepered = true;\n        }\n\n        if (dc.pickingMode) {\n            var po = new PickedObject(this.pickColor.clone(), this.pickDelegate ? this.pickDelegate : this,\n                null, this.layer, false);\n            dc.resolvePick(po);\n        }\n    }\n\n    renderColor(dc, {tileWidth, tileHeight, xScale, yScale, dx, dy, drawInterior, interiorColor}) {\n        if (!this.tessGeom) {\n            this.tessGeom = this.tessellate(this._interiorGeometry);\n            this.tessTris = new Float32Array(this.tessGeom.length);\n        }\n\n        if (!this.wo) {\n            const interiorGeometry = this.mapGeometry(this._interiorGeometry, xScale, yScale, dx, dy);\n            this.wo = this.windingOrder_all(interiorGeometry[0]);\n        }\n\n        const gl = dc.currentGlContext;\n        const program = dc.findAndBindProgram(ScreenColorProgram);\n        program.loadResolution(gl, tileWidth, tileHeight);\n        gl.enableVertexAttribArray(0);\n\n        if (drawInterior) {\n            program.loadColor(gl, dc.pickingMode ? this.pickColor : interiorColor);\n\n            for (var i = 0; i < this.tessGeom.length; i += 3) {\n                var x = this.tessGeom[i];\n                var y = this.tessGeom[i + 1];\n                this.tessTris[i] = x * Angle.RADIANS_TO_DEGREES * xScale + dx;\n                this.tessTris[i + 1] = y * Angle.RADIANS_TO_DEGREES * yScale + dy;\n                this.tessTris[i + 2] = 0;\n            }\n\n            this.bindInteriorVbo(dc, this.tessTris, null);\n            gl.vertexAttribPointer(0, 3, gl.FLOAT, false, 0, 0);\n\n            if (this.wo === 'CW') {\n                gl.frontFace(gl.CW);\n            }\n            gl.drawArrays(gl.TRIANGLES, 0, Math.floor(this.tessTris.length / 3));\n\n            if (this.wo === 'CW') {\n                gl.frontFace(gl.CCW);\n            }\n        }\n\n        //if (drawOutline || true) {\n        /*program.loadColor(gl, attributes.outlineColor);\n        this.bindOutlineVbo(dc, new Float32Array(outlineGeometry[0]), null);\n        gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0);\n        gl.drawArrays(gl.LINE_STRIP, 0, Math.floor(outlineGeometry[0].length / 2));*/\n        //}\n    }\n\n    renderTexture(dc, {points, tileWidth, tileHeight, xScale, yScale, dx, dy, anglesMap, topLeftIndex}) {\n\n        var vboData = this._contoursInfo[0].vboData;\n        var k = 0;\n        for (var i = 0; i < vboData.length; i += 5) {\n            vboData[i] = points[k];\n            vboData[i + 1] = points[k + 1];\n            k += 2;\n        }\n\n        const gl = dc.currentGlContext;\n        const program = dc.findAndBindProgram(ScreenTextureProgram);\n        program.loadResolution(gl, tileWidth, tileHeight);\n        gl.enableVertexAttribArray(0);\n        gl.enableVertexAttribArray(1);\n        program.loadTextureUnit(gl, gl.TEXTURE0);\n        const imageTextureKey = this._imageUUID || this._image.src;\n        if (!imageTextureKey) {\n            console.error('TexturedSurfaceShape, no uuid for image. Use shape.imageUUID to set a unique id');\n        }\n        let imageTexture = dc.gpuResourceCache.resourceForKey(imageTextureKey);\n\n        if (!imageTexture) {\n            imageTexture = new Texture(gl, this._image, null, true);\n            dc.gpuResourceCache.putResource(imageTextureKey, imageTexture, imageTexture.size);\n        }\n\n        imageTexture.bind(dc);\n\n        this.bindInteriorVbo(dc, vboData, null);\n        this.bindInteriorIbo(dc, this._contoursInfo[0].iboData, null);\n        /*var buf = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buf);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this._contoursInfo[0].iboData, gl.STATIC_DRAW);*/\n        const valuesPerVertex = 3 + 2; //3 values for position and 2 values for uvs\n        const sizeOfFloat32 = 4;\n        const vertexSize = valuesPerVertex * sizeOfFloat32;\n\n        gl.vertexAttribPointer(0, 3, gl.FLOAT, false, vertexSize, 0);\n        gl.vertexAttribPointer(1, 2, gl.FLOAT, false, vertexSize, 3 * sizeOfFloat32);\n\n        if (this._contoursInfo[0].wo === 'CW') {\n            gl.frontFace(gl.CW);\n        }\n\n        gl.drawElements(gl.TRIANGLES, this._contoursInfo[0].iboData.length, gl.UNSIGNED_SHORT, 0);\n\n        //gl.drawArrays(gl.TRIANGLES, 0, Math.floor(this._contoursInfo[0].tessTris.length / 5));\n        //gl.drawArrays(gl.POINTS, 0,  Math.floor(this.tessTris.length / 5));\n        /*for (var i =0 ; i < this.tessTris.length; i += 3) {\n            gl.drawArrays(gl.LINE_LOOP, i, 3);\n        }*/\n\n        if (this._contoursInfo[0].wo === 'CW') {\n            gl.frontFace(gl.CCW);\n        }\n\n        gl.disableVertexAttribArray(1);\n    }\n\n    computeUvs(wo, anglesMap, topLeftIndex, locations1) {\n        const locations = locations1.slice();\n        locations.pop();\n        var uvs = new Float32Array(locations.length * 2);\n        var side = '';\n\n        for (var i = topLeftIndex; i < locations.length + topLeftIndex; i++) {\n            var index = i % locations.length;\n            var uv = {s: -1, t: -1};\n\n            if (anglesMap[index]) {\n                //is corner\n                side = this.nextSide(side, wo);\n\n                var sideStart = locations[index];\n                var sideEnd = null;\n                for (var j = i + 1; j < locations.length + topLeftIndex; j++) {\n                    var jIndex = j % locations.length;\n                    if (anglesMap[jIndex] != null) {\n                        sideEnd = locations[jIndex];\n                        break;\n                    }\n                }\n                if (!sideEnd) {\n                    sideEnd = locations[topLeftIndex];\n                }\n                var sideDistance = Location.greatCircleDistance(sideStart, sideEnd) * WGS84_SEMI_MAJOR_AXIS;\n            }\n\n            var distance = Location.greatCircleDistance(sideStart, locations[index]) * WGS84_SEMI_MAJOR_AXIS;\n\n            if (wo === 'CW') {\n                if (side === 'top') {\n                    uv.s = distance / sideDistance;\n                    uv.t = 0;\n                }\n                else if (side === 'right') {\n                    uv.s = 1;\n                    uv.t = distance / sideDistance;\n                }\n                else if (side === 'bottom') {\n                    uv.s = 1 - distance / sideDistance;\n                    uv.t = 1;\n                }\n                else if (side === 'left') {\n                    uv.s = 0;\n                    uv.t = 1 - distance / sideDistance;\n                }\n            }\n            else {\n                if (side === 'left') {\n                    uv.s = 0;\n                    uv.t = distance / sideDistance;\n                }\n                else if (side === 'bottom') {\n                    uv.s = distance / sideDistance;\n                    uv.t = 1;\n                }\n                else if (side === 'right') {\n                    uv.s = 1;\n                    uv.t = 1 - distance / sideDistance;\n                }\n                else if (side === 'top') {\n                    uv.s = 1 - distance / sideDistance;\n                    uv.t = 0;\n                }\n            }\n\n            uvs[index * 2] = uv.s;\n            uvs[index * 2 + 1] = uv.t;\n        }\n\n        return uvs;\n    }\n\n    nextSide(side, wo) {\n        var nextSide = '';\n        if (wo === 'CW') {\n            nextSide = 'top';\n            if (side === 'top') {\n                nextSide = 'right';\n            }\n            else if (side === 'right') {\n                nextSide = 'bottom';\n            }\n            else if (side === 'bottom') {\n                nextSide = 'left';\n            }\n            else if (side === 'left') {\n                nextSide = 'top';\n            }\n        }\n        else {\n            nextSide = 'left';\n            if (side === 'left') {\n                nextSide = 'bottom';\n            }\n            else if (side === 'bottom') {\n                nextSide = 'right';\n            }\n            else if (side === 'right') {\n                nextSide = 'top';\n            }\n            else if (side === 'top') {\n                nextSide = 'left';\n            }\n        }\n\n        return nextSide;\n    }\n\n    mapGeometry(contours, xScale, yScale, dx, dy) {\n        return contours.map(contour => {\n            return contour.reduce((acc, location) => {\n                const x = location.longitude * xScale + dx;\n                const y = location.latitude * yScale + dy;\n                acc.push(x, y);\n                return acc;\n            }, []);\n        });\n    }\n\n    bindInteriorVbo(dc, vboData, vboUsage) {\n        vboUsage = vboUsage || dc.currentGlContext.STATIC_DRAW;\n        if (!this._interiorVboCacheKey) {\n            this._interiorVboCacheKey = dc.gpuResourceCache.generateCacheKey();\n        }\n\n        this.bindVbo(dc, vboData, vboUsage, this._interiorVboCacheKey);\n    }\n\n    bindOutlineVbo(dc, vboData, vboUsage) {\n        vboUsage = vboUsage || dc.currentGlContext.STATIC_DRAW;\n        if (!this._outlineVboCacheKey) {\n            this._outlineVboCacheKey = dc.gpuResourceCache.generateCacheKey();\n        }\n\n        this.bindVbo(dc, vboData, vboUsage, this._outlineVboCacheKey);\n    }\n\n    bindVbo(dc, vboData, vboUsage, cacheKey) {\n        const gl = dc.currentGlContext;\n\n        let vbo = dc.gpuResourceCache.resourceForKey(cacheKey);\n        const vboEntry = dc.gpuResourceCache.entries.entries[cacheKey];\n        let vboSize = 0;\n        if (vboEntry) {\n            vboSize = vboEntry.size;\n        }\n        if (!vbo || vboSize < vboData.length * vboData.BYTES_PER_ELEMENT) {\n            vbo = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n            gl.bufferData(gl.ARRAY_BUFFER, vboData, vboUsage);\n            dc.gpuResourceCache.putResource(cacheKey, vbo, vboData.length * vboData.BYTES_PER_ELEMENT);\n        }\n        else {\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, vboData);\n        }\n    }\n\n    bindInteriorIbo(dc, iboData, iboUsage) {\n        iboUsage = iboUsage || dc.currentGlContext.STATIC_DRAW;\n        if (!this._interiorIboCacheKey) {\n            this._interiorIboCacheKey = dc.gpuResourceCache.generateCacheKey();\n        }\n\n        this.bindIbo(dc, iboData, iboUsage, this._interiorIboCacheKey);\n    }\n\n    bindIbo(dc, iboData, iboUsage, cacheKey) {\n        const gl = dc.currentGlContext;\n\n        let ibo = dc.gpuResourceCache.resourceForKey(cacheKey);\n        const vboEntry = dc.gpuResourceCache.entries.entries[cacheKey];\n        let iboSize = 0;\n        if (vboEntry) {\n            iboSize = vboEntry.size;\n        }\n        if (!ibo || iboSize < iboData.length * iboData.BYTES_PER_ELEMENT) {\n            ibo = gl.createBuffer();\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, iboData, iboUsage);\n            dc.gpuResourceCache.putResource(cacheKey, ibo, iboData.length * iboData.BYTES_PER_ELEMENT);\n        }\n        else {\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\n        }\n    }\n\n    tessellate_p(points, uvs) {\n        var tess = TexturedSurfaceShape.tesselator();\n        var triangles = [];\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN, function (prim) {\n            if (prim !== libtess.primitiveType.GL_TRIANGLES) {\n                console.error('Tessellation error, primitive is not TRIANGLES.');\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE, function (coords, data, weight) {\n            var newCoords = [coords[0], coords[1], coords[2]];\n\n            if (uvs && uvs.length) {\n                for (var i = 3; i <= 4; i++) {\n                    var value = 0;\n                    for (var w = 0; w < 4; w++) {\n                        if (weight[w] > 0) {\n                            value += weight[w] * data[w][i];\n                        }\n                    }\n\n                    newCoords[i] = value;\n                }\n            }\n\n            return newCoords;\n        });\n\n        //prevents triangle fans and strips\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG, function () {\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA, function (data, tris) {\n            tris.push(data[0]);\n            tris.push(data[1]);\n            tris.push(data[2]);\n\n            if (uvs && uvs.length) {\n                tris.push(data[3]);\n                tris.push(data[4]);\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR, function (errno) {\n            console.error('tess err', errno);\n        });\n\n        tess.gluTessBeginPolygon(triangles);\n        tess.gluTessBeginContour();\n\n        var k = 0;\n        for (var i = 0; i < points.length; i++) {\n\n            var vertex = [points[i].x, points[i].y, 0];\n            if (uvs && uvs.length) {\n                vertex.push(uvs[k], uvs[k + 1]);\n                k += 2;\n            }\n\n            tess.gluTessVertex(vertex, vertex);\n        }\n\n        tess.gluTessEndContour();\n        tess.gluTessEndPolygon();\n\n        return triangles;\n    }\n\n    tessellate_p1(points, uvs) {\n        var tess = TexturedSurfaceShape.tesselator();\n        var triangles = [];\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN, function (prim) {\n            if (prim !== libtess.primitiveType.GL_TRIANGLES) {\n                console.error('Tessellation error, primitive is not TRIANGLES.');\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE, function (coords, data, weight) {\n            var newCoords = [coords[0], coords[1], coords[2]];\n\n            if (uvs && uvs.length) {\n                for (var i = 3; i <= 4; i++) {\n                    var value = 0;\n                    for (var w = 0; w < 4; w++) {\n                        if (weight[w] > 0) {\n                            value += weight[w] * data[w][i];\n                        }\n                    }\n\n                    newCoords[i] = value;\n                }\n            }\n\n            return newCoords;\n        });\n\n        //prevents triangle fans and strips\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG, function () {\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA, function (data, tris) {\n            tris.push(data[0]);\n            tris.push(data[1]);\n            tris.push(data[2]);\n\n            if (uvs && uvs.length) {\n                tris.push(data[3]);\n                tris.push(data[4]);\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR, function (errno) {\n            console.error('tess err', errno);\n        });\n\n        tess.gluTessBeginPolygon(triangles);\n        tess.gluTessBeginContour();\n\n        var k = 0;\n        for (var i = 0; i < points.length; i += 2) {\n\n            var vertex = [points[i], points[i + 1], 0];\n            if (uvs && uvs.length) {\n                vertex.push(uvs[k], uvs[k + 1]);\n                k += 2;\n            }\n\n            tess.gluTessVertex(vertex, vertex);\n        }\n\n        tess.gluTessEndContour();\n        tess.gluTessEndPolygon();\n\n        return triangles;\n    }\n\n    tessellate(contours, uvs) {\n        var tess = TexturedSurfaceShape.tesselator();\n        var triangles = [];\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN, function (prim) {\n            if (prim !== libtess.primitiveType.GL_TRIANGLES) {\n                console.error('Tessellation error, primitive is not TRIANGLES.');\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE, function (coords, data, weight) {\n            var newCoords = [coords[0], coords[1], coords[2]];\n\n            if (uvs && uvs.length) {\n                for (var i = 3; i <= 4; i++) {\n                    var value = 0;\n                    for (var w = 0; w < 4; w++) {\n                        if (weight[w] > 0) {\n                            value += weight[w] * data[w][i];\n                        }\n                    }\n\n                    newCoords[i] = value;\n                }\n            }\n\n            return newCoords;\n        });\n\n        //prevents triangle fans and strips\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG, function () {\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA, function (data, tris) {\n            tris.push(data[0]);\n            tris.push(data[1]);\n            tris.push(data[2]);\n\n            if (uvs && uvs.length) {\n                tris.push(data[3]);\n                tris.push(data[4]);\n            }\n        });\n\n        tess.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR, function (errno) {\n            console.error('tess err', errno);\n        });\n\n        // Tessellate the polygon.\n        tess.gluTessBeginPolygon(triangles);\n        var k = 0;\n        for (var i = 0; i < contours.length; i++) {\n            tess.gluTessBeginContour();\n            var contour = contours[i];\n            for (var j = 0; j < contour.length; j += 1) {\n                var pos = contour[j];\n                var x = pos.longitude * Angle.DEGREES_TO_RADIANS;\n                var y = pos.latitude * Angle.DEGREES_TO_RADIANS;\n                var vertex = [x, y, 0];\n                if (uvs && uvs.length) {\n                    vertex.push(uvs[k], uvs[k + 1]);\n                    k += 2;\n                }\n                //console.log('vertex', vertex);\n                tess.gluTessVertex(vertex, vertex);\n            }\n            tess.gluTessEndContour();\n        }\n        tess.gluTessEndPolygon();\n\n        return triangles;\n    }\n\n    getBbox(points) {\n        const bbox = {\n            minX: Number.MAX_SAFE_INTEGER,\n            maxX: Number.MIN_SAFE_INTEGER,\n            minY: Number.MAX_SAFE_INTEGER,\n            maxY: Number.MIN_SAFE_INTEGER,\n            width: 0,\n            height: 0\n        };\n\n        for (var i = 0; i < points.length; i++) {\n            var point = points[i];\n            bbox.minX = Math.min(bbox.minX, point.x);\n            bbox.maxX = Math.max(bbox.maxX, point.x);\n            bbox.minY = Math.min(bbox.minY, point.y);\n            bbox.maxY = Math.max(bbox.maxY, point.y);\n        }\n\n        bbox.width = Math.abs(bbox.maxX - bbox.minX);\n        bbox.height = Math.abs(bbox.maxY - bbox.minY);\n\n        return bbox;\n    }\n\n    getCorners(points, wo) {\n        if (points.length === 4) {\n            //return this.reindexCorners(points);\n        }\n\n        var angles = [];\n        for (var i = 0; i < points.length; i += 2) {\n            var prevX;\n            var prevY;\n            var currentX;\n            var currentY;\n            var nextX;\n            var nextY;\n\n            if (i === 0) {\n                prevX = points[points.length - 2];\n                prevY = points[points.length - 1];\n            }\n            else {\n                prevX = points[i - 2];\n                prevY = points[i - 1];\n            }\n\n            currentX = points[i];\n            currentY = points[i + 1];\n\n            if (i === points.length - 2) {\n                nextX = points[0];\n                nextY = points[1];\n            }\n            else {\n                nextX = points[i + 2];\n                nextY = points[i + 3];\n            }\n\n            var angle = Math.atan2(nextY - currentY, nextX - currentX) -\n                Math.atan2(prevY - currentY, prevX - currentX);\n\n            angles.push({\n                index: i / 2,\n                angle: Math.abs(angle) * Angle.RADIANS_TO_DEGREES\n            });\n        }\n\n        angles = angles.filter(el => {\n            if (el.angle < 170 || el.angle > 190) {\n                return true;\n            }\n            return false;\n        });\n\n        if(angles.length < 4) {\n            //discart when angles count is less than 4\n            return {};\n        }\n\n        /*var p0 = points[angles[0].index];\n        var p1 = points[angles[1].index];\n        var p2 = points[angles[2].index];\n        var p3 = points[angles[3].index];*/\n\n        var p0 = {x: points[angles[0].index * 2], y: points[angles[0].index * 2 + 1], index: angles[0].index};\n        var p1 = {x: points[angles[1].index * 2], y: points[angles[1].index * 2 + 1], index: angles[1].index};\n        var p2 = {x: points[angles[2].index * 2], y: points[angles[2].index * 2 + 1], index: angles[2].index};\n        var p3 = {x: points[angles[3].index * 2], y: points[angles[3].index * 2 + 1], index: angles[3].index};\n\n       /* p0.index = angles[0].index;\n        p1.index = angles[1].index;\n        p2.index = angles[2].index;\n        p3.index = angles[3].index;*/\n\n        //const corners = this.reindexCorners([p0, p1, p2, p3]);\n        const corners = this.findWhichCorners([p0, p1, p2, p3]);\n        const topLeftIndex = corners[0].index;\n\n        /*const newPoints = [];\n        const topLeftIndex = corners[0].index;\n        for (i = topLeftIndex; i < points.length + topLeftIndex; i++) {\n            newPoints.push(points[i % points.length]);\n        }*/\n\n        var anglesMap = angles.reduce((map, el) => {\n            var type = '';\n            var i = corners.findIndex(c => c.index === el.index);\n            if (wo === 'CW') {\n                if (i === 0) {\n                    type = 'tl';\n                }\n                else if (i === 1) {\n                    type = 'tr';\n                }\n                else if (i === 2) {\n                    type = 'br';\n                }\n                else if (i === 3) {\n                    type = 'bl';\n                }\n            }\n            else {\n                if (i === 0) {\n                    type = 'tl';\n                }\n                else if (i === 1) {\n                    type = 'bl';\n                }\n                else if (i === 2) {\n                    type = 'br';\n                }\n                else if (i === 3) {\n                    type = 'tr';\n                }\n            }\n            map[el.index] = type;\n            return map;\n        }, Object.create(null));\n\n        return {anglesMap, topLeftIndex};\n    }\n\n    findWhichCorners(corners) {\n        const userProps = this.userProperties;\n        if (userProps && userProps.identifier) {\n            var id = userProps.identifier;\n            //id = \"S3A_OL_1_ERR____20190110T190220_20190110T194614_20190110T211413_2634_040_113______SVL_O_NR_002.SEN3\"\n            if (id.indexOf('S3') === 0 && id.indexOf('OL_1_ERR___') !== -1) {\n                //these shapes span from pole to pole and became twisted in 2D\n                var geom = this._interiorGeometry[0];\n                var cornerLocations = corners.map(c => {\n                    var location = geom[c.index];\n                    return {latitude: location.latitude, longitude: location.longitude, index: c.index};\n                });\n                cornerLocations.sort((a, b) => a.latitude - b.latitude);\n                cornerLocations.length = 2;\n                var c0 = cornerLocations[0];\n                var c1 = cornerLocations[1];\n                if ((c0.longitude < 0 && c1.longitude > 0) ||\n                    (c0.longitude > 0 && c1.longitude < 0)) {\n                    cornerLocations.sort((a, b) => Math.abs(b.longitude) - Math.abs(a.longitude));\n                }\n                else {\n                    cornerLocations.sort((a, b) => Math.abs(a.longitude) - Math.abs(b.longitude));\n                }\n\n                var topLeftIndex = corners.findIndex(corner => corner.index === cornerLocations[0].index);\n                var newCorners;\n                if (topLeftIndex > 0) {\n                    newCorners = [];\n                    for (var i = topLeftIndex; i < corners.length + topLeftIndex; i++) {\n                        newCorners.push(corners[i % corners.length]);\n                    }\n                }\n\n                return newCorners || corners;\n            }\n        }\n\n        return this.reindexCorners(corners);\n    }\n\n    getCorners_old(points, bbox) {\n        if (this.isEqualPoints(points[0], points[points.length - 1])) {\n            points.pop();\n        }\n\n        if (points.length === 4) {\n            return this.reindexCorners(points);\n        }\n\n        bbox = bbox || this.getBbox(points);\n\n        var corners = [];\n        for (var i = 0; i < points.length - 1; i++) {\n            var point = points[i];\n            if (point.x === bbox.minX || point.x === bbox.maxX) {\n                corners.push(point);\n            }\n            else if (point.y === bbox.minY || point.y === bbox.maxY) {\n                corners.push(point);\n            }\n        }\n\n        if (corners.length < 4) {\n            return corners;\n        }\n\n        return this.reindexCorners(corners);\n    }\n\n    reindexCorners(corners) {\n        //return corners;\n\n        var topLeftIndex = -1;\n        var c = corners.slice();\n        c.sort((a, b) => b.y - a.y);\n        c.length = 2;\n        c.sort((a, b) => a.x - b.x);\n        topLeftIndex = c[0].index;\n        topLeftIndex = corners.findIndex(corner => corner.index === c[0].index);\n\n        //return topLeftIndex;\n\n        var newCorners;\n        if (topLeftIndex > 0) {\n            newCorners = [];\n            for (var i = topLeftIndex; i < corners.length + topLeftIndex; i++) {\n                newCorners.push(corners[i % corners.length]);\n            }\n        }\n\n        return newCorners || corners;\n    }\n\n    reindexCorners_old(corners) {\n        var topLeftIndex = -1;\n        var slope1 = this.getSlope(corners[0], corners[2]);\n        if (slope1 > 0) {\n            if (corners[0].y < corners[2].y) {\n                topLeftIndex = 0;\n            }\n            else {\n                topLeftIndex = 2;\n            }\n        }\n        var slope2 = this.getSlope(corners[1], corners[3]);\n        if (slope2 > 0) {\n            if (corners[1].y < corners[3].y) {\n                if (topLeftIndex !== -1) {\n                    console.error('slope method is not ok 1');\n                }\n                topLeftIndex = 1;\n            }\n            else {\n                if (topLeftIndex !== -1) {\n                    console.error('slope method is not ok 2');\n                }\n                topLeftIndex = 3;\n            }\n        }\n\n        if (topLeftIndex === -1) {\n            console.error('slope method could not determine topLeft');\n        }\n\n        var newCorners;\n        if (topLeftIndex > 0) {\n            newCorners = [];\n            for (var i = topLeftIndex; i < corners.length + topLeftIndex; i++) {\n                newCorners.push(corners[i % corners.length]);\n            }\n        }\n\n        return newCorners || corners;\n    }\n\n    isEqualPoints(p1, p2) {\n        return (\n            p1.x === p2.x &&\n            p1.y === p2.y\n        );\n    }\n\n    windingOrder(corners) {\n        const e0 = (corners[1].x - corners[0].x) * (corners[1].y + corners[0].y);\n        const e1 = (corners[2].x - corners[1].x) * (corners[2].y + corners[1].y);\n        const e2 = (corners[3].x - corners[2].x) * (corners[3].y + corners[2].y);\n        const e3 = (corners[0].x - corners[3].x) * (corners[0].y + corners[3].y);\n        const sum = e0 + e1 + e2 + e3;\n        if (sum < 0) {\n            return 'CCW';\n        }\n        return 'CW';\n    }\n\n    windingOrder_all(list) {\n        let sum = 0;\n        for (let i = 0; i < list.length - 2; i += 2) {\n            let i1 = (i + 2) % list.length;\n            let i0 = i % list.length;\n            let p1x = list[i1];\n            let p1y = list[i1 + 1];\n            let p0x = list[i0];\n            let p0y = list[i0 + 1];\n            sum += ((p1x - p0x) * (p1y + p0y));\n        }\n        if (sum < 0) {\n            return 'CCW';\n        }\n        return 'CW';\n    }\n\n    getSlope(p1, p2) {\n        return (p1.y - p2.y) / (p1.x - p2.x);\n    }\n\n    distance2D(p1, p2) {\n        var dx = p2.x - p1.x;\n        var dy = p2.y - p1.y;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n\n}\n\nvar a = [\n    {latitude: -71.0573, longitude: -119.968}, //TL\n    {latitude: -79.6085, longitude: -149.754}, //TR\n    {latitude: 55.7391, longitude: 27.7961}, //BR\n    {latitude: 58.487, longitude: 6.61523}, //BL\n];\n\nvar b = [\n    {latitude: -70.6695, longitude: -54.5441}, //TL\n    {latitude: -79.8964, longitude: -85.1012}, //TR\n    {latitude: 55.9681, longitude: 91.5418}, //BR\n    {latitude: 58.7238, longitude: 70.2286}, //BL\n];","import TexturedSurfaceShape from './TexturedSurfaceShape';\n\nexport default class TexturedSurfacePolygon extends TexturedSurfaceShape {\n\n    static staticStateKey(shape) {\n        return TexturedSurfaceShape.staticStateKey(shape);\n    }\n\n    constructor(boundaries, attributes) {\n        super(attributes);\n\n        if (!Array.isArray(boundaries)) {\n            throw new Error('TexturedSurfacePolygon - constructor - The specified boundary is not an array.');\n\n        }\n\n        //this._boundaries = boundaries;\n        this._boundaries = this.removeDuplicateLocations(boundaries);\n    }\n\n    get boundaries() {\n        return this._boundaries;\n    }\n\n    set boundaries(boundaries) {\n        if (!Array.isArray(boundaries)) {\n            throw new Error('TexturedSurfacePolygon - set boundaries - The specified boundary is not an array.');\n        }\n        //this._boundaries = boundaries;\n        this._boundaries = this.removeDuplicateLocations(boundaries);\n        this.isPrepared = false;\n        this.stateKeyInvalid = true;\n    }\n\n    removeDuplicateLocations(boundaries) {\n        if (Array.isArray(boundaries[0])) {\n            const newBoundaries = [];\n            for (var i = 0; i < boundaries.length; i++) {\n                var contour = this.removeDuplicateLocationsFromContour(boundaries[i]);\n                newBoundaries.push(contour);\n            }\n            return newBoundaries;\n        }\n        else {\n            return this.removeDuplicateLocationsFromContour(boundaries);\n        }\n    }\n\n    removeDuplicateLocationsFromContour(contour) {\n        const newBoundaries = [];\n\n        for (var i = 0; i < contour.length - 1; i++) {\n            var loc = contour[i];\n            newBoundaries.push(loc);\n            for (var j = i + 1; j < contour.length; j++) {\n                var loc2 = contour[j];\n                if (loc.latitude !== loc2.latitude || loc.longitude !== loc2.longitude) {\n                    break;\n                }\n                i++;\n            }\n        }\n\n        return newBoundaries;\n    }\n\n    computeStateKey() {\n        return TexturedSurfacePolygon.staticStateKey(this);\n    }\n\n    computeBoundaries(){}\n}","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nimport KMLWorker from './utils/KML.worker'\nimport {AcquisitionPlansParser} from './utils/AcquisitionPlansParser'\nimport TexturedSurfacePolygon from \"../../worldwind/textured/TexturedSurfacePolygon\";\n\nconst {\n    RenderableLayer,\n} = WorldWind;\n\nconst {\n    Workers,\n    AcquisitionPlans,\n} = WordWindX;\n\nconst satNames = ['s1a', 's1b', 's2a', 's2b'];\nconst numWorkers = Workers.getCoreCount();\nconst workers = new Workers(KMLWorker, numWorkers);\nconst acquisitionPlans = new AcquisitionPlans(satNames, workers);\nacquisitionPlans.parser = new AcquisitionPlansParser(workers);\nacquisitionPlans.parser.InteriorCtor = TexturedSurfacePolygon;\n\n/**\n * \n * @param {string} dateString - Datestring like 20190430 with fixed width.\n */\nconst getDate = (dateString) => {\n    return new Date(`${dateString.substr(0,4)}-${dateString.substr(4,2)}-${dateString.substr(6,2)}`);\n}\n\nconst filterPlansByUrl = (plans, cachedPlans) => {\n    return plans.filter((plan) => {\n        return !cachedPlans.some(cachedPlan => cachedPlan.url === plan.url);\n    })\n}\n\nconst generateId = () => {\n    return window.crypto.getRandomValues(new Uint32Array(1))[0];\n}\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer can render only one model of satellite. It`s possible to set position data of model.\n * @param options {Object}\n * @param options.key {String}\n * @param options.satName {String}\n * @param options.time {Date} Time of the satellite.\n * @param options.range {number} Renge in milliseconds. Default is 90 minutes.\n * @param options.onLayerChanged {func}\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass AcquisitionPlanLayer extends RenderableLayer {\n\tconstructor(options) {\n        super(options);\n        this._rerenderMap = null;\n        this.key = options.key;\n        this.satName = options.satName;\n        this.plans = null;\n        this.onLayerChanged = options.onLayerChanged || null;\n        this.time = options.time || new Date();\n\n        this.range = options.range || 90 * 60 * 1000; \n        this.loading = new Set();\n    };\n\n\tasync setPlans(plans, startDate, endDate) {\n        this.plans = plans;\n        this.update();\n    }\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    setTime(time) {\n        if(time) {\n            this.time = time;\n            this.update();\n        }\n    }\n\n\n\n    async getFootprints(range) {\n        const updateId = generateId();\n\n        //filter plans by acquisitionPlans.cache\n        \n        const startDate = new Date(this.time - range);\n        const endDate = new Date(this.time + range);\n        // await Promise.all(this.plans.map(plan => acquisitionPlans.parse({...plan, filterDate: startDate.toISOString()}).catch((err) => {console.error(err)})));\n        const filteredPlans = filterPlansByUrl(this.plans, acquisitionPlans.cache[this.satName]);\n\n        //if already loading, then remove from plans\n        const unloadedPlans = filteredPlans.filter(plan => ![...this.loading].some((pHash) => `${pHash.split('.kml_')[0]}.kml` === plan.url));\n\n        //add loading urls\n        filteredPlans.forEach(plan => this.loading.add(`${plan.url}_${updateId}`));\n\n        //dont filter in cache\n        if(typeof this.onLayerChanged === 'function') {\n            this.onLayerChanged({\n                satKey: this.satName,\n                layerKey: this.key\n            }, {update: {loading: true}, plans: unloadedPlans.map(p => p.url), sat: this.satName});\n        }\n        await Promise.all(unloadedPlans.map(plan => acquisitionPlans.parse({...plan, filterDate: getDate(plan.start).toISOString()}).catch((err) => {console.error(err)})));\n        if(typeof this.onLayerChanged === 'function') {\n            this.onLayerChanged({\n                satKey: this.satName,\n                layerKey: this.key\n            }, {update: {loading: false}, plans: unloadedPlans.map(p => p.url), sat: this.satName});\n        }\n\n        //remove loading urls\n        filteredPlans.forEach(plan => this.loading.delete(`${plan.url}_${updateId}`));\n\n        acquisitionPlans.terminateWorkers();\n        return acquisitionPlans.getFootprints({ satName: this.satName, startDate , endDate });\n    }\n\n    async update() {\n        this.removeAllRenderables();\n        this.doRerender();\n        const { interiors, outlines } = await this.getFootprints(this.range);\n\n        if(typeof this.onLayerChanged === 'function') {\n            this.onLayerChanged({\n                satKey: this.satName,\n                layerKey: this.key\n            }, {count: outlines.length, sat: this.satName});\n        }\n\n        this.addRenderables(interiors);\n        this.addRenderables(outlines);\n        this.doRerender();\n    }\n\n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n\t}\n}\n\nexport default AcquisitionPlanLayer;\n\n","/*!\n * satellite-js v3.0.1\n * (c) 2013 Shashwat Kandadai and UCSC\n * https://github.com/shashwatak/satellite-js\n * License: MIT\n */\n\nvar pi = Math.PI;\nvar twoPi = pi * 2;\nvar deg2rad = pi / 180.0;\nvar rad2deg = 180 / pi;\nvar minutesPerDay = 1440.0;\nvar mu = 398600.5; // in km3 / s2\n\nvar earthRadius = 6378.137; // in km\n\nvar xke = 60.0 / Math.sqrt(earthRadius * earthRadius * earthRadius / mu);\nvar vkmpersec = earthRadius * xke / 60.0;\nvar tumin = 1.0 / xke;\nvar j2 = 0.00108262998905;\nvar j3 = -0.00000253215306;\nvar j4 = -0.00000161098761;\nvar j3oj2 = j3 / j2;\nvar x2o3 = 2.0 / 3.0;\n\nvar constants = /*#__PURE__*/Object.freeze({\n  pi: pi,\n  twoPi: twoPi,\n  deg2rad: deg2rad,\n  rad2deg: rad2deg,\n  minutesPerDay: minutesPerDay,\n  mu: mu,\n  earthRadius: earthRadius,\n  xke: xke,\n  vkmpersec: vkmpersec,\n  tumin: tumin,\n  j2: j2,\n  j3: j3,\n  j4: j4,\n  j3oj2: j3oj2,\n  x2o3: x2o3\n});\n\n/* -----------------------------------------------------------------------------\n *\n *                           procedure days2mdhms\n *\n *  this procedure converts the day of the year, days, to the equivalent month\n *    day, hour, minute and second.\n *\n *  algorithm     : set up array for the number of days per month\n *                  find leap year - use 1900 because 2000 is a leap year\n *                  loop through a temp value while the value is < the days\n *                  perform int conversions to the correct day and month\n *                  convert remainder into h m s using type conversions\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs          description                    range / units\n *    year        - year                           1900 .. 2100\n *    days        - julian day of the year         0.0  .. 366.0\n *\n *  outputs       :\n *    mon         - month                          1 .. 12\n *    day         - day                            1 .. 28,29,30,31\n *    hr          - hour                           0 .. 23\n *    min         - minute                         0 .. 59\n *    sec         - second                         0.0 .. 59.999\n *\n *  locals        :\n *    dayofyr     - day of year\n *    temp        - temporary extended values\n *    inttemp     - temporary int value\n *    i           - index\n *    lmonth[12]  - int array containing the number of days per month\n *\n *  coupling      :\n *    none.\n * --------------------------------------------------------------------------- */\nfunction days2mdhms(year, days) {\n  var lmonth = [31, year % 4 === 0 ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n  var dayofyr = Math.floor(days); //  ----------------- find month and day of month ----------------\n\n  var i = 1;\n  var inttemp = 0;\n\n  while (dayofyr > inttemp + lmonth[i - 1] && i < 12) {\n    inttemp += lmonth[i - 1];\n    i += 1;\n  }\n\n  var mon = i;\n  var day = dayofyr - inttemp; //  ----------------- find hours minutes and seconds -------------\n\n  var temp = (days - dayofyr) * 24.0;\n  var hr = Math.floor(temp);\n  temp = (temp - hr) * 60.0;\n  var minute = Math.floor(temp);\n  var sec = (temp - minute) * 60.0;\n  return {\n    mon: mon,\n    day: day,\n    hr: hr,\n    minute: minute,\n    sec: sec\n  };\n}\n/* -----------------------------------------------------------------------------\n *\n *                           procedure jday\n *\n *  this procedure finds the julian date given the year, month, day, and time.\n *    the julian date is defined by each elapsed day since noon, jan 1, 4713 bc.\n *\n *  algorithm     : calculate the answer in one step for efficiency\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs          description                    range / units\n *    year        - year                           1900 .. 2100\n *    mon         - month                          1 .. 12\n *    day         - day                            1 .. 28,29,30,31\n *    hr          - universal time hour            0 .. 23\n *    min         - universal time min             0 .. 59\n *    sec         - universal time sec             0.0 .. 59.999\n *\n *  outputs       :\n *    jd          - julian date                    days from 4713 bc\n *\n *  locals        :\n *    none.\n *\n *  coupling      :\n *    none.\n *\n *  references    :\n *    vallado       2007, 189, alg 14, ex 3-14\n *\n * --------------------------------------------------------------------------- */\n\nfunction jdayInternal(year, mon, day, hr, minute, sec) {\n  var msec = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;\n  return 367.0 * year - Math.floor(7 * (year + Math.floor((mon + 9) / 12.0)) * 0.25) + Math.floor(275 * mon / 9.0) + day + 1721013.5 + ((msec / 60000 + sec / 60.0 + minute) / 60.0 + hr) / 24.0 // ut in days\n  // # - 0.5*sgn(100.0*year + mon - 190002.5) + 0.5;\n  ;\n}\n\nfunction jday(year, mon, day, hr, minute, sec, msec) {\n  if (year instanceof Date) {\n    var date = year;\n    return jdayInternal(date.getUTCFullYear(), date.getUTCMonth() + 1, // Note, this function requires months in range 1-12.\n    date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds());\n  }\n\n  return jdayInternal(year, mon, day, hr, minute, sec, msec);\n}\n/* -----------------------------------------------------------------------------\n *\n *                           procedure invjday\n *\n *  this procedure finds the year, month, day, hour, minute and second\n *  given the julian date. tu can be ut1, tdt, tdb, etc.\n *\n *  algorithm     : set up starting values\n *                  find leap year - use 1900 because 2000 is a leap year\n *                  find the elapsed days through the year in a loop\n *                  call routine to find each individual value\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs          description                    range / units\n *    jd          - julian date                    days from 4713 bc\n *\n *  outputs       :\n *    year        - year                           1900 .. 2100\n *    mon         - month                          1 .. 12\n *    day         - day                            1 .. 28,29,30,31\n *    hr          - hour                           0 .. 23\n *    min         - minute                         0 .. 59\n *    sec         - second                         0.0 .. 59.999\n *\n *  locals        :\n *    days        - day of year plus fractional\n *                  portion of a day               days\n *    tu          - julian centuries from 0 h\n *                  jan 0, 1900\n *    temp        - temporary double values\n *    leapyrs     - number of leap years from 1900\n *\n *  coupling      :\n *    days2mdhms  - finds month, day, hour, minute and second given days and year\n *\n *  references    :\n *    vallado       2007, 208, alg 22, ex 3-13\n * --------------------------------------------------------------------------- */\n\nfunction invjday(jd, asArray) {\n  // --------------- find year and days of the year -\n  var temp = jd - 2415019.5;\n  var tu = temp / 365.25;\n  var year = 1900 + Math.floor(tu);\n  var leapyrs = Math.floor((year - 1901) * 0.25); // optional nudge by 8.64x10-7 sec to get even outputs\n\n  var days = temp - ((year - 1900) * 365.0 + leapyrs) + 0.00000000001; // ------------ check for case of beginning of a year -----------\n\n  if (days < 1.0) {\n    year -= 1;\n    leapyrs = Math.floor((year - 1901) * 0.25);\n    days = temp - ((year - 1900) * 365.0 + leapyrs);\n  } // ----------------- find remaing data  -------------------------\n\n\n  var mdhms = days2mdhms(year, days);\n  var mon = mdhms.mon,\n      day = mdhms.day,\n      hr = mdhms.hr,\n      minute = mdhms.minute;\n  var sec = mdhms.sec - 0.00000086400;\n\n  if (asArray) {\n    return [year, mon, day, hr, minute, Math.floor(sec)];\n  }\n\n  return new Date(Date.UTC(year, mon - 1, day, hr, minute, Math.floor(sec)));\n}\n\n/* -----------------------------------------------------------------------------\n *\n *                           procedure dpper\n *\n *  this procedure provides deep space long period periodic contributions\n *    to the mean elements.  by design, these periodics are zero at epoch.\n *    this used to be dscom which included initialization, but it's really a\n *    recurring function.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    e3          -\n *    ee2         -\n *    peo         -\n *    pgho        -\n *    pho         -\n *    pinco       -\n *    plo         -\n *    se2 , se3 , sgh2, sgh3, sgh4, sh2, sh3, si2, si3, sl2, sl3, sl4 -\n *    t           -\n *    xh2, xh3, xi2, xi3, xl2, xl3, xl4 -\n *    zmol        -\n *    zmos        -\n *    ep          - eccentricity                           0.0 - 1.0\n *    inclo       - inclination - needed for lyddane modification\n *    nodep       - right ascension of ascending node\n *    argpp       - argument of perigee\n *    mp          - mean anomaly\n *\n *  outputs       :\n *    ep          - eccentricity                           0.0 - 1.0\n *    inclp       - inclination\n *    nodep        - right ascension of ascending node\n *    argpp       - argument of perigee\n *    mp          - mean anomaly\n *\n *  locals        :\n *    alfdp       -\n *    betdp       -\n *    cosip  , sinip  , cosop  , sinop  ,\n *    dalf        -\n *    dbet        -\n *    dls         -\n *    f2, f3      -\n *    pe          -\n *    pgh         -\n *    ph          -\n *    pinc        -\n *    pl          -\n *    sel   , ses   , sghl  , sghs  , shl   , shs   , sil   , sinzf , sis   ,\n *    sll   , sls\n *    xls         -\n *    xnoh        -\n *    zf          -\n *    zm          -\n *\n *  coupling      :\n *    none.\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction dpper(satrec, options) {\n  var e3 = satrec.e3,\n      ee2 = satrec.ee2,\n      peo = satrec.peo,\n      pgho = satrec.pgho,\n      pho = satrec.pho,\n      pinco = satrec.pinco,\n      plo = satrec.plo,\n      se2 = satrec.se2,\n      se3 = satrec.se3,\n      sgh2 = satrec.sgh2,\n      sgh3 = satrec.sgh3,\n      sgh4 = satrec.sgh4,\n      sh2 = satrec.sh2,\n      sh3 = satrec.sh3,\n      si2 = satrec.si2,\n      si3 = satrec.si3,\n      sl2 = satrec.sl2,\n      sl3 = satrec.sl3,\n      sl4 = satrec.sl4,\n      t = satrec.t,\n      xgh2 = satrec.xgh2,\n      xgh3 = satrec.xgh3,\n      xgh4 = satrec.xgh4,\n      xh2 = satrec.xh2,\n      xh3 = satrec.xh3,\n      xi2 = satrec.xi2,\n      xi3 = satrec.xi3,\n      xl2 = satrec.xl2,\n      xl3 = satrec.xl3,\n      xl4 = satrec.xl4,\n      zmol = satrec.zmol,\n      zmos = satrec.zmos;\n  var init = options.init,\n      opsmode = options.opsmode;\n  var ep = options.ep,\n      inclp = options.inclp,\n      nodep = options.nodep,\n      argpp = options.argpp,\n      mp = options.mp; // Copy satellite attributes into local variables for convenience\n  // and symmetry in writing formulae.\n\n  var alfdp;\n  var betdp;\n  var cosip;\n  var sinip;\n  var cosop;\n  var sinop;\n  var dalf;\n  var dbet;\n  var dls;\n  var f2;\n  var f3;\n  var pe;\n  var pgh;\n  var ph;\n  var pinc;\n  var pl;\n  var sinzf;\n  var xls;\n  var xnoh;\n  var zf;\n  var zm; //  ---------------------- constants -----------------------------\n\n  var zns = 1.19459e-5;\n  var zes = 0.01675;\n  var znl = 1.5835218e-4;\n  var zel = 0.05490; //  --------------- calculate time varying periodics -----------\n\n  zm = zmos + zns * t; // be sure that the initial call has time set to zero\n\n  if (init === 'y') {\n    zm = zmos;\n  }\n\n  zf = zm + 2.0 * zes * Math.sin(zm);\n  sinzf = Math.sin(zf);\n  f2 = 0.5 * sinzf * sinzf - 0.25;\n  f3 = -0.5 * sinzf * Math.cos(zf);\n  var ses = se2 * f2 + se3 * f3;\n  var sis = si2 * f2 + si3 * f3;\n  var sls = sl2 * f2 + sl3 * f3 + sl4 * sinzf;\n  var sghs = sgh2 * f2 + sgh3 * f3 + sgh4 * sinzf;\n  var shs = sh2 * f2 + sh3 * f3;\n  zm = zmol + znl * t;\n\n  if (init === 'y') {\n    zm = zmol;\n  }\n\n  zf = zm + 2.0 * zel * Math.sin(zm);\n  sinzf = Math.sin(zf);\n  f2 = 0.5 * sinzf * sinzf - 0.25;\n  f3 = -0.5 * sinzf * Math.cos(zf);\n  var sel = ee2 * f2 + e3 * f3;\n  var sil = xi2 * f2 + xi3 * f3;\n  var sll = xl2 * f2 + xl3 * f3 + xl4 * sinzf;\n  var sghl = xgh2 * f2 + xgh3 * f3 + xgh4 * sinzf;\n  var shll = xh2 * f2 + xh3 * f3;\n  pe = ses + sel;\n  pinc = sis + sil;\n  pl = sls + sll;\n  pgh = sghs + sghl;\n  ph = shs + shll;\n\n  if (init === 'n') {\n    pe -= peo;\n    pinc -= pinco;\n    pl -= plo;\n    pgh -= pgho;\n    ph -= pho;\n    inclp += pinc;\n    ep += pe;\n    sinip = Math.sin(inclp);\n    cosip = Math.cos(inclp);\n    /* ----------------- apply periodics directly ------------ */\n    // sgp4fix for lyddane choice\n    // strn3 used original inclination - this is technically feasible\n    // gsfc used perturbed inclination - also technically feasible\n    // probably best to readjust the 0.2 limit value and limit discontinuity\n    // 0.2 rad = 11.45916 deg\n    // use next line for original strn3 approach and original inclination\n    // if (inclo >= 0.2)\n    // use next line for gsfc version and perturbed inclination\n\n    if (inclp >= 0.2) {\n      ph /= sinip;\n      pgh -= cosip * ph;\n      argpp += pgh;\n      nodep += ph;\n      mp += pl;\n    } else {\n      //  ---- apply periodics with lyddane modification ----\n      sinop = Math.sin(nodep);\n      cosop = Math.cos(nodep);\n      alfdp = sinip * sinop;\n      betdp = sinip * cosop;\n      dalf = ph * cosop + pinc * cosip * sinop;\n      dbet = -ph * sinop + pinc * cosip * cosop;\n      alfdp += dalf;\n      betdp += dbet;\n      nodep %= twoPi; //  sgp4fix for afspc written intrinsic functions\n      //  nodep used without a trigonometric function ahead\n\n      if (nodep < 0.0 && opsmode === 'a') {\n        nodep += twoPi;\n      }\n\n      xls = mp + argpp + cosip * nodep;\n      dls = pl + pgh - pinc * nodep * sinip;\n      xls += dls;\n      xnoh = nodep;\n      nodep = Math.atan2(alfdp, betdp); //  sgp4fix for afspc written intrinsic functions\n      //  nodep used without a trigonometric function ahead\n\n      if (nodep < 0.0 && opsmode === 'a') {\n        nodep += twoPi;\n      }\n\n      if (Math.abs(xnoh - nodep) > pi) {\n        if (nodep < xnoh) {\n          nodep += twoPi;\n        } else {\n          nodep -= twoPi;\n        }\n      }\n\n      mp += pl;\n      argpp = xls - mp - cosip * nodep;\n    }\n  }\n\n  return {\n    ep: ep,\n    inclp: inclp,\n    nodep: nodep,\n    argpp: argpp,\n    mp: mp\n  };\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                           procedure dscom\n *\n *  this procedure provides deep space common items used by both the secular\n *    and periodics subroutines.  input is provided as shown. this routine\n *    used to be called dpper, but the functions inside weren't well organized.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    epoch       -\n *    ep          - eccentricity\n *    argpp       - argument of perigee\n *    tc          -\n *    inclp       - inclination\n *    nodep       - right ascension of ascending node\n *    np          - mean motion\n *\n *  outputs       :\n *    sinim  , cosim  , sinomm , cosomm , snodm  , cnodm\n *    day         -\n *    e3          -\n *    ee2         -\n *    em          - eccentricity\n *    emsq        - eccentricity squared\n *    gam         -\n *    peo         -\n *    pgho        -\n *    pho         -\n *    pinco       -\n *    plo         -\n *    rtemsq      -\n *    se2, se3         -\n *    sgh2, sgh3, sgh4        -\n *    sh2, sh3, si2, si3, sl2, sl3, sl4         -\n *    s1, s2, s3, s4, s5, s6, s7          -\n *    ss1, ss2, ss3, ss4, ss5, ss6, ss7, sz1, sz2, sz3         -\n *    sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33        -\n *    xgh2, xgh3, xgh4, xh2, xh3, xi2, xi3, xl2, xl3, xl4         -\n *    nm          - mean motion\n *    z1, z2, z3, z11, z12, z13, z21, z22, z23, z31, z32, z33         -\n *    zmol        -\n *    zmos        -\n *\n *  locals        :\n *    a1, a2, a3, a4, a5, a6, a7, a8, a9, a10         -\n *    betasq      -\n *    cc          -\n *    ctem, stem        -\n *    x1, x2, x3, x4, x5, x6, x7, x8          -\n *    xnodce      -\n *    xnoi        -\n *    zcosg  , zsing  , zcosgl , zsingl , zcosh  , zsinh  , zcoshl , zsinhl ,\n *    zcosi  , zsini  , zcosil , zsinil ,\n *    zx          -\n *    zy          -\n *\n *  coupling      :\n *    none.\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction dscom(options) {\n  var epoch = options.epoch,\n      ep = options.ep,\n      argpp = options.argpp,\n      tc = options.tc,\n      inclp = options.inclp,\n      nodep = options.nodep,\n      np = options.np;\n  var a1;\n  var a2;\n  var a3;\n  var a4;\n  var a5;\n  var a6;\n  var a7;\n  var a8;\n  var a9;\n  var a10;\n  var cc;\n  var x1;\n  var x2;\n  var x3;\n  var x4;\n  var x5;\n  var x6;\n  var x7;\n  var x8;\n  var zcosg;\n  var zsing;\n  var zcosh;\n  var zsinh;\n  var zcosi;\n  var zsini;\n  var ss1;\n  var ss2;\n  var ss3;\n  var ss4;\n  var ss5;\n  var ss6;\n  var ss7;\n  var sz1;\n  var sz2;\n  var sz3;\n  var sz11;\n  var sz12;\n  var sz13;\n  var sz21;\n  var sz22;\n  var sz23;\n  var sz31;\n  var sz32;\n  var sz33;\n  var s1;\n  var s2;\n  var s3;\n  var s4;\n  var s5;\n  var s6;\n  var s7;\n  var z1;\n  var z2;\n  var z3;\n  var z11;\n  var z12;\n  var z13;\n  var z21;\n  var z22;\n  var z23;\n  var z31;\n  var z32;\n  var z33; // -------------------------- constants -------------------------\n\n  var zes = 0.01675;\n  var zel = 0.05490;\n  var c1ss = 2.9864797e-6;\n  var c1l = 4.7968065e-7;\n  var zsinis = 0.39785416;\n  var zcosis = 0.91744867;\n  var zcosgs = 0.1945905;\n  var zsings = -0.98088458; //  --------------------- local variables ------------------------\n\n  var nm = np;\n  var em = ep;\n  var snodm = Math.sin(nodep);\n  var cnodm = Math.cos(nodep);\n  var sinomm = Math.sin(argpp);\n  var cosomm = Math.cos(argpp);\n  var sinim = Math.sin(inclp);\n  var cosim = Math.cos(inclp);\n  var emsq = em * em;\n  var betasq = 1.0 - emsq;\n  var rtemsq = Math.sqrt(betasq); //  ----------------- initialize lunar solar terms ---------------\n\n  var peo = 0.0;\n  var pinco = 0.0;\n  var plo = 0.0;\n  var pgho = 0.0;\n  var pho = 0.0;\n  var day = epoch + 18261.5 + tc / 1440.0;\n  var xnodce = (4.5236020 - 9.2422029e-4 * day) % twoPi;\n  var stem = Math.sin(xnodce);\n  var ctem = Math.cos(xnodce);\n  var zcosil = 0.91375164 - 0.03568096 * ctem;\n  var zsinil = Math.sqrt(1.0 - zcosil * zcosil);\n  var zsinhl = 0.089683511 * stem / zsinil;\n  var zcoshl = Math.sqrt(1.0 - zsinhl * zsinhl);\n  var gam = 5.8351514 + 0.0019443680 * day;\n  var zx = 0.39785416 * stem / zsinil;\n  var zy = zcoshl * ctem + 0.91744867 * zsinhl * stem;\n  zx = Math.atan2(zx, zy);\n  zx += gam - xnodce;\n  var zcosgl = Math.cos(zx);\n  var zsingl = Math.sin(zx); //  ------------------------- do solar terms ---------------------\n\n  zcosg = zcosgs;\n  zsing = zsings;\n  zcosi = zcosis;\n  zsini = zsinis;\n  zcosh = cnodm;\n  zsinh = snodm;\n  cc = c1ss;\n  var xnoi = 1.0 / nm;\n  var lsflg = 0;\n\n  while (lsflg < 2) {\n    lsflg += 1;\n    a1 = zcosg * zcosh + zsing * zcosi * zsinh;\n    a3 = -zsing * zcosh + zcosg * zcosi * zsinh;\n    a7 = -zcosg * zsinh + zsing * zcosi * zcosh;\n    a8 = zsing * zsini;\n    a9 = zsing * zsinh + zcosg * zcosi * zcosh;\n    a10 = zcosg * zsini;\n    a2 = cosim * a7 + sinim * a8;\n    a4 = cosim * a9 + sinim * a10;\n    a5 = -sinim * a7 + cosim * a8;\n    a6 = -sinim * a9 + cosim * a10;\n    x1 = a1 * cosomm + a2 * sinomm;\n    x2 = a3 * cosomm + a4 * sinomm;\n    x3 = -a1 * sinomm + a2 * cosomm;\n    x4 = -a3 * sinomm + a4 * cosomm;\n    x5 = a5 * sinomm;\n    x6 = a6 * sinomm;\n    x7 = a5 * cosomm;\n    x8 = a6 * cosomm;\n    z31 = 12.0 * x1 * x1 - 3.0 * x3 * x3;\n    z32 = 24.0 * x1 * x2 - 6.0 * x3 * x4;\n    z33 = 12.0 * x2 * x2 - 3.0 * x4 * x4;\n    z1 = 3.0 * (a1 * a1 + a2 * a2) + z31 * emsq;\n    z2 = 6.0 * (a1 * a3 + a2 * a4) + z32 * emsq;\n    z3 = 3.0 * (a3 * a3 + a4 * a4) + z33 * emsq;\n    z11 = -6.0 * a1 * a5 + emsq * (-24.0 * x1 * x7 - 6.0 * x3 * x5);\n    z12 = -6.0 * (a1 * a6 + a3 * a5) + emsq * (-24.0 * (x2 * x7 + x1 * x8) + -6.0 * (x3 * x6 + x4 * x5));\n    z13 = -6.0 * a3 * a6 + emsq * (-24.0 * x2 * x8 - 6.0 * x4 * x6);\n    z21 = 6.0 * a2 * a5 + emsq * (24.0 * x1 * x5 - 6.0 * x3 * x7);\n    z22 = 6.0 * (a4 * a5 + a2 * a6) + emsq * (24.0 * (x2 * x5 + x1 * x6) - 6.0 * (x4 * x7 + x3 * x8));\n    z23 = 6.0 * a4 * a6 + emsq * (24.0 * x2 * x6 - 6.0 * x4 * x8);\n    z1 = z1 + z1 + betasq * z31;\n    z2 = z2 + z2 + betasq * z32;\n    z3 = z3 + z3 + betasq * z33;\n    s3 = cc * xnoi;\n    s2 = -0.5 * s3 / rtemsq;\n    s4 = s3 * rtemsq;\n    s1 = -15.0 * em * s4;\n    s5 = x1 * x3 + x2 * x4;\n    s6 = x2 * x3 + x1 * x4;\n    s7 = x2 * x4 - x1 * x3; //  ----------------------- do lunar terms -------------------\n\n    if (lsflg === 1) {\n      ss1 = s1;\n      ss2 = s2;\n      ss3 = s3;\n      ss4 = s4;\n      ss5 = s5;\n      ss6 = s6;\n      ss7 = s7;\n      sz1 = z1;\n      sz2 = z2;\n      sz3 = z3;\n      sz11 = z11;\n      sz12 = z12;\n      sz13 = z13;\n      sz21 = z21;\n      sz22 = z22;\n      sz23 = z23;\n      sz31 = z31;\n      sz32 = z32;\n      sz33 = z33;\n      zcosg = zcosgl;\n      zsing = zsingl;\n      zcosi = zcosil;\n      zsini = zsinil;\n      zcosh = zcoshl * cnodm + zsinhl * snodm;\n      zsinh = snodm * zcoshl - cnodm * zsinhl;\n      cc = c1l;\n    }\n  }\n\n  var zmol = (4.7199672 + (0.22997150 * day - gam)) % twoPi;\n  var zmos = (6.2565837 + 0.017201977 * day) % twoPi; //  ------------------------ do solar terms ----------------------\n\n  var se2 = 2.0 * ss1 * ss6;\n  var se3 = 2.0 * ss1 * ss7;\n  var si2 = 2.0 * ss2 * sz12;\n  var si3 = 2.0 * ss2 * (sz13 - sz11);\n  var sl2 = -2.0 * ss3 * sz2;\n  var sl3 = -2.0 * ss3 * (sz3 - sz1);\n  var sl4 = -2.0 * ss3 * (-21.0 - 9.0 * emsq) * zes;\n  var sgh2 = 2.0 * ss4 * sz32;\n  var sgh3 = 2.0 * ss4 * (sz33 - sz31);\n  var sgh4 = -18.0 * ss4 * zes;\n  var sh2 = -2.0 * ss2 * sz22;\n  var sh3 = -2.0 * ss2 * (sz23 - sz21); //  ------------------------ do lunar terms ----------------------\n\n  var ee2 = 2.0 * s1 * s6;\n  var e3 = 2.0 * s1 * s7;\n  var xi2 = 2.0 * s2 * z12;\n  var xi3 = 2.0 * s2 * (z13 - z11);\n  var xl2 = -2.0 * s3 * z2;\n  var xl3 = -2.0 * s3 * (z3 - z1);\n  var xl4 = -2.0 * s3 * (-21.0 - 9.0 * emsq) * zel;\n  var xgh2 = 2.0 * s4 * z32;\n  var xgh3 = 2.0 * s4 * (z33 - z31);\n  var xgh4 = -18.0 * s4 * zel;\n  var xh2 = -2.0 * s2 * z22;\n  var xh3 = -2.0 * s2 * (z23 - z21);\n  return {\n    snodm: snodm,\n    cnodm: cnodm,\n    sinim: sinim,\n    cosim: cosim,\n    sinomm: sinomm,\n    cosomm: cosomm,\n    day: day,\n    e3: e3,\n    ee2: ee2,\n    em: em,\n    emsq: emsq,\n    gam: gam,\n    peo: peo,\n    pgho: pgho,\n    pho: pho,\n    pinco: pinco,\n    plo: plo,\n    rtemsq: rtemsq,\n    se2: se2,\n    se3: se3,\n    sgh2: sgh2,\n    sgh3: sgh3,\n    sgh4: sgh4,\n    sh2: sh2,\n    sh3: sh3,\n    si2: si2,\n    si3: si3,\n    sl2: sl2,\n    sl3: sl3,\n    sl4: sl4,\n    s1: s1,\n    s2: s2,\n    s3: s3,\n    s4: s4,\n    s5: s5,\n    s6: s6,\n    s7: s7,\n    ss1: ss1,\n    ss2: ss2,\n    ss3: ss3,\n    ss4: ss4,\n    ss5: ss5,\n    ss6: ss6,\n    ss7: ss7,\n    sz1: sz1,\n    sz2: sz2,\n    sz3: sz3,\n    sz11: sz11,\n    sz12: sz12,\n    sz13: sz13,\n    sz21: sz21,\n    sz22: sz22,\n    sz23: sz23,\n    sz31: sz31,\n    sz32: sz32,\n    sz33: sz33,\n    xgh2: xgh2,\n    xgh3: xgh3,\n    xgh4: xgh4,\n    xh2: xh2,\n    xh3: xh3,\n    xi2: xi2,\n    xi3: xi3,\n    xl2: xl2,\n    xl3: xl3,\n    xl4: xl4,\n    nm: nm,\n    z1: z1,\n    z2: z2,\n    z3: z3,\n    z11: z11,\n    z12: z12,\n    z13: z13,\n    z21: z21,\n    z22: z22,\n    z23: z23,\n    z31: z31,\n    z32: z32,\n    z33: z33,\n    zmol: zmol,\n    zmos: zmos\n  };\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                           procedure dsinit\n *\n *  this procedure provides deep space contributions to mean motion dot due\n *    to geopotential resonance with half day and one day orbits.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    cosim, sinim-\n *    emsq        - eccentricity squared\n *    argpo       - argument of perigee\n *    s1, s2, s3, s4, s5      -\n *    ss1, ss2, ss3, ss4, ss5 -\n *    sz1, sz3, sz11, sz13, sz21, sz23, sz31, sz33 -\n *    t           - time\n *    tc          -\n *    gsto        - greenwich sidereal time                   rad\n *    mo          - mean anomaly\n *    mdot        - mean anomaly dot (rate)\n *    no          - mean motion\n *    nodeo       - right ascension of ascending node\n *    nodedot     - right ascension of ascending node dot (rate)\n *    xpidot      -\n *    z1, z3, z11, z13, z21, z23, z31, z33 -\n *    eccm        - eccentricity\n *    argpm       - argument of perigee\n *    inclm       - inclination\n *    mm          - mean anomaly\n *    xn          - mean motion\n *    nodem       - right ascension of ascending node\n *\n *  outputs       :\n *    em          - eccentricity\n *    argpm       - argument of perigee\n *    inclm       - inclination\n *    mm          - mean anomaly\n *    nm          - mean motion\n *    nodem       - right ascension of ascending node\n *    irez        - flag for resonance           0-none, 1-one day, 2-half day\n *    atime       -\n *    d2201, d2211, d3210, d3222, d4410, d4422, d5220, d5232, d5421, d5433    -\n *    dedt        -\n *    didt        -\n *    dmdt        -\n *    dndt        -\n *    dnodt       -\n *    domdt       -\n *    del1, del2, del3        -\n *    ses  , sghl , sghs , sgs  , shl  , shs  , sis  , sls\n *    theta       -\n *    xfact       -\n *    xlamo       -\n *    xli         -\n *    xni\n *\n *  locals        :\n *    ainv2       -\n *    aonv        -\n *    cosisq      -\n *    eoc         -\n *    f220, f221, f311, f321, f322, f330, f441, f442, f522, f523, f542, f543  -\n *    g200, g201, g211, g300, g310, g322, g410, g422, g520, g521, g532, g533  -\n *    sini2       -\n *    temp        -\n *    temp1       -\n *    theta       -\n *    xno2        -\n *\n *  coupling      :\n *    getgravconst\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction dsinit(options) {\n  var cosim = options.cosim,\n      argpo = options.argpo,\n      s1 = options.s1,\n      s2 = options.s2,\n      s3 = options.s3,\n      s4 = options.s4,\n      s5 = options.s5,\n      sinim = options.sinim,\n      ss1 = options.ss1,\n      ss2 = options.ss2,\n      ss3 = options.ss3,\n      ss4 = options.ss4,\n      ss5 = options.ss5,\n      sz1 = options.sz1,\n      sz3 = options.sz3,\n      sz11 = options.sz11,\n      sz13 = options.sz13,\n      sz21 = options.sz21,\n      sz23 = options.sz23,\n      sz31 = options.sz31,\n      sz33 = options.sz33,\n      t = options.t,\n      tc = options.tc,\n      gsto = options.gsto,\n      mo = options.mo,\n      mdot = options.mdot,\n      no = options.no,\n      nodeo = options.nodeo,\n      nodedot = options.nodedot,\n      xpidot = options.xpidot,\n      z1 = options.z1,\n      z3 = options.z3,\n      z11 = options.z11,\n      z13 = options.z13,\n      z21 = options.z21,\n      z23 = options.z23,\n      z31 = options.z31,\n      z33 = options.z33,\n      ecco = options.ecco,\n      eccsq = options.eccsq;\n  var emsq = options.emsq,\n      em = options.em,\n      argpm = options.argpm,\n      inclm = options.inclm,\n      mm = options.mm,\n      nm = options.nm,\n      nodem = options.nodem,\n      irez = options.irez,\n      atime = options.atime,\n      d2201 = options.d2201,\n      d2211 = options.d2211,\n      d3210 = options.d3210,\n      d3222 = options.d3222,\n      d4410 = options.d4410,\n      d4422 = options.d4422,\n      d5220 = options.d5220,\n      d5232 = options.d5232,\n      d5421 = options.d5421,\n      d5433 = options.d5433,\n      dedt = options.dedt,\n      didt = options.didt,\n      dmdt = options.dmdt,\n      dnodt = options.dnodt,\n      domdt = options.domdt,\n      del1 = options.del1,\n      del2 = options.del2,\n      del3 = options.del3,\n      xfact = options.xfact,\n      xlamo = options.xlamo,\n      xli = options.xli,\n      xni = options.xni;\n  var f220;\n  var f221;\n  var f311;\n  var f321;\n  var f322;\n  var f330;\n  var f441;\n  var f442;\n  var f522;\n  var f523;\n  var f542;\n  var f543;\n  var g200;\n  var g201;\n  var g211;\n  var g300;\n  var g310;\n  var g322;\n  var g410;\n  var g422;\n  var g520;\n  var g521;\n  var g532;\n  var g533;\n  var sini2;\n  var temp;\n  var temp1;\n  var xno2;\n  var ainv2;\n  var aonv;\n  var cosisq;\n  var eoc;\n  var q22 = 1.7891679e-6;\n  var q31 = 2.1460748e-6;\n  var q33 = 2.2123015e-7;\n  var root22 = 1.7891679e-6;\n  var root44 = 7.3636953e-9;\n  var root54 = 2.1765803e-9;\n  var rptim = 4.37526908801129966e-3; // equates to 7.29211514668855e-5 rad/sec\n\n  var root32 = 3.7393792e-7;\n  var root52 = 1.1428639e-7;\n  var znl = 1.5835218e-4;\n  var zns = 1.19459e-5; // -------------------- deep space initialization ------------\n\n  irez = 0;\n\n  if (nm < 0.0052359877 && nm > 0.0034906585) {\n    irez = 1;\n  }\n\n  if (nm >= 8.26e-3 && nm <= 9.24e-3 && em >= 0.5) {\n    irez = 2;\n  } // ------------------------ do solar terms -------------------\n\n\n  var ses = ss1 * zns * ss5;\n  var sis = ss2 * zns * (sz11 + sz13);\n  var sls = -zns * ss3 * (sz1 + sz3 - 14.0 - 6.0 * emsq);\n  var sghs = ss4 * zns * (sz31 + sz33 - 6.0);\n  var shs = -zns * ss2 * (sz21 + sz23); // sgp4fix for 180 deg incl\n\n  if (inclm < 5.2359877e-2 || inclm > pi - 5.2359877e-2) {\n    shs = 0.0;\n  }\n\n  if (sinim !== 0.0) {\n    shs /= sinim;\n  }\n\n  var sgs = sghs - cosim * shs; // ------------------------- do lunar terms ------------------\n\n  dedt = ses + s1 * znl * s5;\n  didt = sis + s2 * znl * (z11 + z13);\n  dmdt = sls - znl * s3 * (z1 + z3 - 14.0 - 6.0 * emsq);\n  var sghl = s4 * znl * (z31 + z33 - 6.0);\n  var shll = -znl * s2 * (z21 + z23); // sgp4fix for 180 deg incl\n\n  if (inclm < 5.2359877e-2 || inclm > pi - 5.2359877e-2) {\n    shll = 0.0;\n  }\n\n  domdt = sgs + sghl;\n  dnodt = shs;\n\n  if (sinim !== 0.0) {\n    domdt -= cosim / sinim * shll;\n    dnodt += shll / sinim;\n  } // ----------- calculate deep space resonance effects --------\n\n\n  var dndt = 0.0;\n  var theta = (gsto + tc * rptim) % twoPi;\n  em += dedt * t;\n  inclm += didt * t;\n  argpm += domdt * t;\n  nodem += dnodt * t;\n  mm += dmdt * t; // sgp4fix for negative inclinations\n  // the following if statement should be commented out\n  // if (inclm < 0.0)\n  // {\n  //   inclm  = -inclm;\n  //   argpm  = argpm - pi;\n  //   nodem = nodem + pi;\n  // }\n  // -------------- initialize the resonance terms -------------\n\n  if (irez !== 0) {\n    aonv = Math.pow(nm / xke, x2o3); // ---------- geopotential resonance for 12 hour orbits ------\n\n    if (irez === 2) {\n      cosisq = cosim * cosim;\n      var emo = em;\n      em = ecco;\n      var emsqo = emsq;\n      emsq = eccsq;\n      eoc = em * emsq;\n      g201 = -0.306 - (em - 0.64) * 0.440;\n\n      if (em <= 0.65) {\n        g211 = 3.616 - 13.2470 * em + 16.2900 * emsq;\n        g310 = -19.302 + 117.3900 * em - 228.4190 * emsq + 156.5910 * eoc;\n        g322 = -18.9068 + 109.7927 * em - 214.6334 * emsq + 146.5816 * eoc;\n        g410 = -41.122 + 242.6940 * em - 471.0940 * emsq + 313.9530 * eoc;\n        g422 = -146.407 + 841.8800 * em - 1629.014 * emsq + 1083.4350 * eoc;\n        g520 = -532.114 + 3017.977 * em - 5740.032 * emsq + 3708.2760 * eoc;\n      } else {\n        g211 = -72.099 + 331.819 * em - 508.738 * emsq + 266.724 * eoc;\n        g310 = -346.844 + 1582.851 * em - 2415.925 * emsq + 1246.113 * eoc;\n        g322 = -342.585 + 1554.908 * em - 2366.899 * emsq + 1215.972 * eoc;\n        g410 = -1052.797 + 4758.686 * em - 7193.992 * emsq + 3651.957 * eoc;\n        g422 = -3581.690 + 16178.110 * em - 24462.770 * emsq + 12422.520 * eoc;\n\n        if (em > 0.715) {\n          g520 = -5149.66 + 29936.92 * em - 54087.36 * emsq + 31324.56 * eoc;\n        } else {\n          g520 = 1464.74 - 4664.75 * em + 3763.64 * emsq;\n        }\n      }\n\n      if (em < 0.7) {\n        g533 = -919.22770 + 4988.6100 * em - 9064.7700 * emsq + 5542.21 * eoc;\n        g521 = -822.71072 + 4568.6173 * em - 8491.4146 * emsq + 5337.524 * eoc;\n        g532 = -853.66600 + 4690.2500 * em - 8624.7700 * emsq + 5341.4 * eoc;\n      } else {\n        g533 = -37995.780 + 161616.52 * em - 229838.20 * emsq + 109377.94 * eoc;\n        g521 = -51752.104 + 218913.95 * em - 309468.16 * emsq + 146349.42 * eoc;\n        g532 = -40023.880 + 170470.89 * em - 242699.48 * emsq + 115605.82 * eoc;\n      }\n\n      sini2 = sinim * sinim;\n      f220 = 0.75 * (1.0 + 2.0 * cosim + cosisq);\n      f221 = 1.5 * sini2;\n      f321 = 1.875 * sinim * (1.0 - 2.0 * cosim - 3.0 * cosisq);\n      f322 = -1.875 * sinim * (1.0 + 2.0 * cosim - 3.0 * cosisq);\n      f441 = 35.0 * sini2 * f220;\n      f442 = 39.3750 * sini2 * sini2;\n      f522 = 9.84375 * sinim * (sini2 * (1.0 - 2.0 * cosim - 5.0 * cosisq) + 0.33333333 * (-2.0 + 4.0 * cosim + 6.0 * cosisq));\n      f523 = sinim * (4.92187512 * sini2 * (-2.0 - 4.0 * cosim + 10.0 * cosisq) + 6.56250012 * (1.0 + 2.0 * cosim - 3.0 * cosisq));\n      f542 = 29.53125 * sinim * (2.0 - 8.0 * cosim + cosisq * (-12.0 + 8.0 * cosim + 10.0 * cosisq));\n      f543 = 29.53125 * sinim * (-2.0 - 8.0 * cosim + cosisq * (12.0 + 8.0 * cosim - 10.0 * cosisq));\n      xno2 = nm * nm;\n      ainv2 = aonv * aonv;\n      temp1 = 3.0 * xno2 * ainv2;\n      temp = temp1 * root22;\n      d2201 = temp * f220 * g201;\n      d2211 = temp * f221 * g211;\n      temp1 *= aonv;\n      temp = temp1 * root32;\n      d3210 = temp * f321 * g310;\n      d3222 = temp * f322 * g322;\n      temp1 *= aonv;\n      temp = 2.0 * temp1 * root44;\n      d4410 = temp * f441 * g410;\n      d4422 = temp * f442 * g422;\n      temp1 *= aonv;\n      temp = temp1 * root52;\n      d5220 = temp * f522 * g520;\n      d5232 = temp * f523 * g532;\n      temp = 2.0 * temp1 * root54;\n      d5421 = temp * f542 * g521;\n      d5433 = temp * f543 * g533;\n      xlamo = (mo + nodeo + nodeo - (theta + theta)) % twoPi;\n      xfact = mdot + dmdt + 2.0 * (nodedot + dnodt - rptim) - no;\n      em = emo;\n      emsq = emsqo;\n    } //  ---------------- synchronous resonance terms --------------\n\n\n    if (irez === 1) {\n      g200 = 1.0 + emsq * (-2.5 + 0.8125 * emsq);\n      g310 = 1.0 + 2.0 * emsq;\n      g300 = 1.0 + emsq * (-6.0 + 6.60937 * emsq);\n      f220 = 0.75 * (1.0 + cosim) * (1.0 + cosim);\n      f311 = 0.9375 * sinim * sinim * (1.0 + 3.0 * cosim) - 0.75 * (1.0 + cosim);\n      f330 = 1.0 + cosim;\n      f330 *= 1.875 * f330 * f330;\n      del1 = 3.0 * nm * nm * aonv * aonv;\n      del2 = 2.0 * del1 * f220 * g200 * q22;\n      del3 = 3.0 * del1 * f330 * g300 * q33 * aonv;\n      del1 = del1 * f311 * g310 * q31 * aonv;\n      xlamo = (mo + nodeo + argpo - theta) % twoPi;\n      xfact = mdot + xpidot + dmdt + domdt + dnodt - (no + rptim);\n    } //  ------------ for sgp4, initialize the integrator ----------\n\n\n    xli = xlamo;\n    xni = no;\n    atime = 0.0;\n    nm = no + dndt;\n  }\n\n  return {\n    em: em,\n    argpm: argpm,\n    inclm: inclm,\n    mm: mm,\n    nm: nm,\n    nodem: nodem,\n    irez: irez,\n    atime: atime,\n    d2201: d2201,\n    d2211: d2211,\n    d3210: d3210,\n    d3222: d3222,\n    d4410: d4410,\n    d4422: d4422,\n    d5220: d5220,\n    d5232: d5232,\n    d5421: d5421,\n    d5433: d5433,\n    dedt: dedt,\n    didt: didt,\n    dmdt: dmdt,\n    dndt: dndt,\n    dnodt: dnodt,\n    domdt: domdt,\n    del1: del1,\n    del2: del2,\n    del3: del3,\n    xfact: xfact,\n    xlamo: xlamo,\n    xli: xli,\n    xni: xni\n  };\n}\n\n/* -----------------------------------------------------------------------------\n *\n *                           function gstime\n *\n *  this function finds the greenwich sidereal time.\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs          description                    range / units\n *    jdut1       - julian date in ut1             days from 4713 bc\n *\n *  outputs       :\n *    d      - greenwich sidereal time        0 to 2pi rad\n *\n *  locals        :\n *    temp        - temporary variable for doubles   rad\n *    tut1        - julian centuries from the\n *                  jan 1, 2000 12 h epoch (ut1)\n *\n *  coupling      :\n *    none\n *\n *  references    :\n *    vallado       2004, 191, eq 3-45\n * --------------------------------------------------------------------------- */\n\nfunction gstimeInternal(jdut1) {\n  var tut1 = (jdut1 - 2451545.0) / 36525.0;\n  var temp = -6.2e-6 * tut1 * tut1 * tut1 + 0.093104 * tut1 * tut1 + (876600.0 * 3600 + 8640184.812866) * tut1 + 67310.54841; // # sec\n\n  temp = temp * deg2rad / 240.0 % twoPi; // 360/86400 = 1/240, to deg, to rad\n  //  ------------------------ check quadrants ---------------------\n\n  if (temp < 0.0) {\n    temp += twoPi;\n  }\n\n  return temp;\n}\n\nfunction gstime() {\n  if ((arguments.length <= 0 ? undefined : arguments[0]) instanceof Date || arguments.length > 1) {\n    return gstimeInternal(jday.apply(void 0, arguments));\n  }\n\n  return gstimeInternal.apply(void 0, arguments);\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                           procedure initl\n *\n *  this procedure initializes the sgp4 propagator. all the initialization is\n *    consolidated here instead of having multiple loops inside other routines.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    ecco        - eccentricity                           0.0 - 1.0\n *    epoch       - epoch time in days from jan 0, 1950. 0 hr\n *    inclo       - inclination of satellite\n *    no          - mean motion of satellite\n *    satn        - satellite number\n *\n *  outputs       :\n *    ainv        - 1.0 / a\n *    ao          - semi major axis\n *    con41       -\n *    con42       - 1.0 - 5.0 cos(i)\n *    cosio       - cosine of inclination\n *    cosio2      - cosio squared\n *    eccsq       - eccentricity squared\n *    method      - flag for deep space                    'd', 'n'\n *    omeosq      - 1.0 - ecco * ecco\n *    posq        - semi-parameter squared\n *    rp          - radius of perigee\n *    rteosq      - square root of (1.0 - ecco*ecco)\n *    sinio       - sine of inclination\n *    gsto        - gst at time of observation               rad\n *    no          - mean motion of satellite\n *\n *  locals        :\n *    ak          -\n *    d1          -\n *    del         -\n *    adel        -\n *    po          -\n *\n *  coupling      :\n *    getgravconst\n *    gstime      - find greenwich sidereal time from the julian date\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction initl(options) {\n  var ecco = options.ecco,\n      epoch = options.epoch,\n      inclo = options.inclo,\n      opsmode = options.opsmode;\n  var no = options.no; // sgp4fix use old way of finding gst\n  // ----------------------- earth constants ---------------------\n  // sgp4fix identify constants and allow alternate values\n  // ------------- calculate auxillary epoch quantities ----------\n\n  var eccsq = ecco * ecco;\n  var omeosq = 1.0 - eccsq;\n  var rteosq = Math.sqrt(omeosq);\n  var cosio = Math.cos(inclo);\n  var cosio2 = cosio * cosio; // ------------------ un-kozai the mean motion -----------------\n\n  var ak = Math.pow(xke / no, x2o3);\n  var d1 = 0.75 * j2 * (3.0 * cosio2 - 1.0) / (rteosq * omeosq);\n  var delPrime = d1 / (ak * ak);\n  var adel = ak * (1.0 - delPrime * delPrime - delPrime * (1.0 / 3.0 + 134.0 * delPrime * delPrime / 81.0));\n  delPrime = d1 / (adel * adel);\n  no /= 1.0 + delPrime;\n  var ao = Math.pow(xke / no, x2o3);\n  var sinio = Math.sin(inclo);\n  var po = ao * omeosq;\n  var con42 = 1.0 - 5.0 * cosio2;\n  var con41 = -con42 - cosio2 - cosio2;\n  var ainv = 1.0 / ao;\n  var posq = po * po;\n  var rp = ao * (1.0 - ecco);\n  var method = 'n'; //  sgp4fix modern approach to finding sidereal time\n\n  var gsto;\n\n  if (opsmode === 'a') {\n    //  sgp4fix use old way of finding gst\n    //  count integer number of days from 0 jan 1970\n    var ts70 = epoch - 7305.0;\n    var ds70 = Math.floor(ts70 + 1.0e-8);\n    var tfrac = ts70 - ds70; //  find greenwich location at epoch\n\n    var c1 = 1.72027916940703639e-2;\n    var thgr70 = 1.7321343856509374;\n    var fk5r = 5.07551419432269442e-15;\n    var c1p2p = c1 + twoPi;\n    gsto = (thgr70 + c1 * ds70 + c1p2p * tfrac + ts70 * ts70 * fk5r) % twoPi;\n\n    if (gsto < 0.0) {\n      gsto += twoPi;\n    }\n  } else {\n    gsto = gstime(epoch + 2433281.5);\n  }\n\n  return {\n    no: no,\n    method: method,\n    ainv: ainv,\n    ao: ao,\n    con41: con41,\n    con42: con42,\n    cosio: cosio,\n    cosio2: cosio2,\n    eccsq: eccsq,\n    omeosq: omeosq,\n    posq: posq,\n    rp: rp,\n    rteosq: rteosq,\n    sinio: sinio,\n    gsto: gsto\n  };\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                           procedure dspace\n *\n *  this procedure provides deep space contributions to mean elements for\n *    perturbing third body.  these effects have been averaged over one\n *    revolution of the sun and moon.  for earth resonance effects, the\n *    effects have been averaged over no revolutions of the satellite.\n *    (mean motion)\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    d2201, d2211, d3210, d3222, d4410, d4422, d5220, d5232, d5421, d5433 -\n *    dedt        -\n *    del1, del2, del3  -\n *    didt        -\n *    dmdt        -\n *    dnodt       -\n *    domdt       -\n *    irez        - flag for resonance           0-none, 1-one day, 2-half day\n *    argpo       - argument of perigee\n *    argpdot     - argument of perigee dot (rate)\n *    t           - time\n *    tc          -\n *    gsto        - gst\n *    xfact       -\n *    xlamo       -\n *    no          - mean motion\n *    atime       -\n *    em          - eccentricity\n *    ft          -\n *    argpm       - argument of perigee\n *    inclm       - inclination\n *    xli         -\n *    mm          - mean anomaly\n *    xni         - mean motion\n *    nodem       - right ascension of ascending node\n *\n *  outputs       :\n *    atime       -\n *    em          - eccentricity\n *    argpm       - argument of perigee\n *    inclm       - inclination\n *    xli         -\n *    mm          - mean anomaly\n *    xni         -\n *    nodem       - right ascension of ascending node\n *    dndt        -\n *    nm          - mean motion\n *\n *  locals        :\n *    delt        -\n *    ft          -\n *    theta       -\n *    x2li        -\n *    x2omi       -\n *    xl          -\n *    xldot       -\n *    xnddt       -\n *    xndt        -\n *    xomi        -\n *\n *  coupling      :\n *    none        -\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction dspace(options) {\n  var irez = options.irez,\n      d2201 = options.d2201,\n      d2211 = options.d2211,\n      d3210 = options.d3210,\n      d3222 = options.d3222,\n      d4410 = options.d4410,\n      d4422 = options.d4422,\n      d5220 = options.d5220,\n      d5232 = options.d5232,\n      d5421 = options.d5421,\n      d5433 = options.d5433,\n      dedt = options.dedt,\n      del1 = options.del1,\n      del2 = options.del2,\n      del3 = options.del3,\n      didt = options.didt,\n      dmdt = options.dmdt,\n      dnodt = options.dnodt,\n      domdt = options.domdt,\n      argpo = options.argpo,\n      argpdot = options.argpdot,\n      t = options.t,\n      tc = options.tc,\n      gsto = options.gsto,\n      xfact = options.xfact,\n      xlamo = options.xlamo,\n      no = options.no;\n  var atime = options.atime,\n      em = options.em,\n      argpm = options.argpm,\n      inclm = options.inclm,\n      xli = options.xli,\n      mm = options.mm,\n      xni = options.xni,\n      nodem = options.nodem,\n      nm = options.nm;\n  var fasx2 = 0.13130908;\n  var fasx4 = 2.8843198;\n  var fasx6 = 0.37448087;\n  var g22 = 5.7686396;\n  var g32 = 0.95240898;\n  var g44 = 1.8014998;\n  var g52 = 1.0508330;\n  var g54 = 4.4108898;\n  var rptim = 4.37526908801129966e-3; // equates to 7.29211514668855e-5 rad/sec\n\n  var stepp = 720.0;\n  var stepn = -720.0;\n  var step2 = 259200.0;\n  var delt;\n  var x2li;\n  var x2omi;\n  var xl;\n  var xldot;\n  var xnddt;\n  var xndt;\n  var xomi;\n  var dndt = 0.0;\n  var ft = 0.0; //  ----------- calculate deep space resonance effects -----------\n\n  var theta = (gsto + tc * rptim) % twoPi;\n  em += dedt * t;\n  inclm += didt * t;\n  argpm += domdt * t;\n  nodem += dnodt * t;\n  mm += dmdt * t; // sgp4fix for negative inclinations\n  // the following if statement should be commented out\n  // if (inclm < 0.0)\n  // {\n  //   inclm = -inclm;\n  //   argpm = argpm - pi;\n  //   nodem = nodem + pi;\n  // }\n\n  /* - update resonances : numerical (euler-maclaurin) integration - */\n\n  /* ------------------------- epoch restart ----------------------  */\n  //   sgp4fix for propagator problems\n  //   the following integration works for negative time steps and periods\n  //   the specific changes are unknown because the original code was so convoluted\n  // sgp4fix take out atime = 0.0 and fix for faster operation\n\n  if (irez !== 0) {\n    //  sgp4fix streamline check\n    if (atime === 0.0 || t * atime <= 0.0 || Math.abs(t) < Math.abs(atime)) {\n      atime = 0.0;\n      xni = no;\n      xli = xlamo;\n    } // sgp4fix move check outside loop\n\n\n    if (t > 0.0) {\n      delt = stepp;\n    } else {\n      delt = stepn;\n    }\n\n    var iretn = 381; // added for do loop\n\n    while (iretn === 381) {\n      //  ------------------- dot terms calculated -------------\n      //  ----------- near - synchronous resonance terms -------\n      if (irez !== 2) {\n        xndt = del1 * Math.sin(xli - fasx2) + del2 * Math.sin(2.0 * (xli - fasx4)) + del3 * Math.sin(3.0 * (xli - fasx6));\n        xldot = xni + xfact;\n        xnddt = del1 * Math.cos(xli - fasx2) + 2.0 * del2 * Math.cos(2.0 * (xli - fasx4)) + 3.0 * del3 * Math.cos(3.0 * (xli - fasx6));\n        xnddt *= xldot;\n      } else {\n        // --------- near - half-day resonance terms --------\n        xomi = argpo + argpdot * atime;\n        x2omi = xomi + xomi;\n        x2li = xli + xli;\n        xndt = d2201 * Math.sin(x2omi + xli - g22) + d2211 * Math.sin(xli - g22) + d3210 * Math.sin(xomi + xli - g32) + d3222 * Math.sin(-xomi + xli - g32) + d4410 * Math.sin(x2omi + x2li - g44) + d4422 * Math.sin(x2li - g44) + d5220 * Math.sin(xomi + xli - g52) + d5232 * Math.sin(-xomi + xli - g52) + d5421 * Math.sin(xomi + x2li - g54) + d5433 * Math.sin(-xomi + x2li - g54);\n        xldot = xni + xfact;\n        xnddt = d2201 * Math.cos(x2omi + xli - g22) + d2211 * Math.cos(xli - g22) + d3210 * Math.cos(xomi + xli - g32) + d3222 * Math.cos(-xomi + xli - g32) + d5220 * Math.cos(xomi + xli - g52) + d5232 * Math.cos(-xomi + xli - g52) + 2.0 * d4410 * Math.cos(x2omi + x2li - g44) + d4422 * Math.cos(x2li - g44) + d5421 * Math.cos(xomi + x2li - g54) + d5433 * Math.cos(-xomi + x2li - g54);\n        xnddt *= xldot;\n      } //  ----------------------- integrator -------------------\n      //  sgp4fix move end checks to end of routine\n\n\n      if (Math.abs(t - atime) >= stepp) {\n        iretn = 381;\n      } else {\n        ft = t - atime;\n        iretn = 0;\n      }\n\n      if (iretn === 381) {\n        xli += xldot * delt + xndt * step2;\n        xni += xndt * delt + xnddt * step2;\n        atime += delt;\n      }\n    }\n\n    nm = xni + xndt * ft + xnddt * ft * ft * 0.5;\n    xl = xli + xldot * ft + xndt * ft * ft * 0.5;\n\n    if (irez !== 1) {\n      mm = xl - 2.0 * nodem + 2.0 * theta;\n      dndt = nm - no;\n    } else {\n      mm = xl - nodem - argpm + theta;\n      dndt = nm - no;\n    }\n\n    nm = no + dndt;\n  }\n\n  return {\n    atime: atime,\n    em: em,\n    argpm: argpm,\n    inclm: inclm,\n    xli: xli,\n    mm: mm,\n    xni: xni,\n    nodem: nodem,\n    dndt: dndt,\n    nm: nm\n  };\n}\n\n/*----------------------------------------------------------------------------\n *\n *                             procedure sgp4\n *\n *  this procedure is the sgp4 prediction model from space command. this is an\n *    updated and combined version of sgp4 and sdp4, which were originally\n *    published separately in spacetrack report //3. this version follows the\n *    methodology from the aiaa paper (2006) describing the history and\n *    development of the code.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    satrec  - initialised structure from sgp4init() call.\n *    tsince  - time since epoch (minutes)\n *\n *  outputs       :\n *    r           - position vector                     km\n *    v           - velocity                            km/sec\n *  return code - non-zero on error.\n *                   1 - mean elements, ecc >= 1.0 or ecc < -0.001 or a < 0.95 er\n *                   2 - mean motion less than 0.0\n *                   3 - pert elements, ecc < 0.0  or  ecc > 1.0\n *                   4 - semi-latus rectum < 0.0\n *                   5 - epoch elements are sub-orbital\n *                   6 - satellite has decayed\n *\n *  locals        :\n *    am          -\n *    axnl, aynl        -\n *    betal       -\n *    cosim   , sinim   , cosomm  , sinomm  , cnod    , snod    , cos2u   ,\n *    sin2u   , coseo1  , sineo1  , cosi    , sini    , cosip   , sinip   ,\n *    cosisq  , cossu   , sinsu   , cosu    , sinu\n *    delm        -\n *    delomg      -\n *    dndt        -\n *    eccm        -\n *    emsq        -\n *    ecose       -\n *    el2         -\n *    eo1         -\n *    eccp        -\n *    esine       -\n *    argpm       -\n *    argpp       -\n *    omgadf      -\n *    pl          -\n *    r           -\n *    rtemsq      -\n *    rdotl       -\n *    rl          -\n *    rvdot       -\n *    rvdotl      -\n *    su          -\n *    t2  , t3   , t4    , tc\n *    tem5, temp , temp1 , temp2  , tempa  , tempe  , templ\n *    u   , ux   , uy    , uz     , vx     , vy     , vz\n *    inclm       - inclination\n *    mm          - mean anomaly\n *    nm          - mean motion\n *    nodem       - right asc of ascending node\n *    xinc        -\n *    xincp       -\n *    xl          -\n *    xlm         -\n *    mp          -\n *    xmdf        -\n *    xmx         -\n *    xmy         -\n *    nodedf      -\n *    xnode       -\n *    nodep       -\n *    np          -\n *\n *  coupling      :\n *    getgravconst-\n *    dpper\n *    dspace\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report //3 1980\n *    hoots, norad spacetrack report //6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction sgp4(satrec, tsince) {\n  /* eslint-disable no-param-reassign */\n  var coseo1;\n  var sineo1;\n  var cosip;\n  var sinip;\n  var cosisq;\n  var delm;\n  var delomg;\n  var eo1;\n  var argpm;\n  var argpp;\n  var su;\n  var t3;\n  var t4;\n  var tc;\n  var tem5;\n  var temp;\n  var tempa;\n  var tempe;\n  var templ;\n  var inclm;\n  var mm;\n  var nm;\n  var nodem;\n  var xincp;\n  var xlm;\n  var mp;\n  var nodep;\n  /* ------------------ set mathematical constants --------------- */\n  // sgp4fix divisor for divide by zero check on inclination\n  // the old check used 1.0 + cos(pi-1.0e-9), but then compared it to\n  // 1.5 e-12, so the threshold was changed to 1.5e-12 for consistency\n\n  var temp4 = 1.5e-12; // --------------------- clear sgp4 error flag -----------------\n\n  satrec.t = tsince;\n  satrec.error = 0; //  ------- update for secular gravity and atmospheric drag -----\n\n  var xmdf = satrec.mo + satrec.mdot * satrec.t;\n  var argpdf = satrec.argpo + satrec.argpdot * satrec.t;\n  var nodedf = satrec.nodeo + satrec.nodedot * satrec.t;\n  argpm = argpdf;\n  mm = xmdf;\n  var t2 = satrec.t * satrec.t;\n  nodem = nodedf + satrec.nodecf * t2;\n  tempa = 1.0 - satrec.cc1 * satrec.t;\n  tempe = satrec.bstar * satrec.cc4 * satrec.t;\n  templ = satrec.t2cof * t2;\n\n  if (satrec.isimp !== 1) {\n    delomg = satrec.omgcof * satrec.t; //  sgp4fix use mutliply for speed instead of pow\n\n    var delmtemp = 1.0 + satrec.eta * Math.cos(xmdf);\n    delm = satrec.xmcof * (delmtemp * delmtemp * delmtemp - satrec.delmo);\n    temp = delomg + delm;\n    mm = xmdf + temp;\n    argpm = argpdf - temp;\n    t3 = t2 * satrec.t;\n    t4 = t3 * satrec.t;\n    tempa = tempa - satrec.d2 * t2 - satrec.d3 * t3 - satrec.d4 * t4;\n    tempe += satrec.bstar * satrec.cc5 * (Math.sin(mm) - satrec.sinmao);\n    templ = templ + satrec.t3cof * t3 + t4 * (satrec.t4cof + satrec.t * satrec.t5cof);\n  }\n\n  nm = satrec.no;\n  var em = satrec.ecco;\n  inclm = satrec.inclo;\n\n  if (satrec.method === 'd') {\n    tc = satrec.t;\n    var dspaceOptions = {\n      irez: satrec.irez,\n      d2201: satrec.d2201,\n      d2211: satrec.d2211,\n      d3210: satrec.d3210,\n      d3222: satrec.d3222,\n      d4410: satrec.d4410,\n      d4422: satrec.d4422,\n      d5220: satrec.d5220,\n      d5232: satrec.d5232,\n      d5421: satrec.d5421,\n      d5433: satrec.d5433,\n      dedt: satrec.dedt,\n      del1: satrec.del1,\n      del2: satrec.del2,\n      del3: satrec.del3,\n      didt: satrec.didt,\n      dmdt: satrec.dmdt,\n      dnodt: satrec.dnodt,\n      domdt: satrec.domdt,\n      argpo: satrec.argpo,\n      argpdot: satrec.argpdot,\n      t: satrec.t,\n      tc: tc,\n      gsto: satrec.gsto,\n      xfact: satrec.xfact,\n      xlamo: satrec.xlamo,\n      no: satrec.no,\n      atime: satrec.atime,\n      em: em,\n      argpm: argpm,\n      inclm: inclm,\n      xli: satrec.xli,\n      mm: mm,\n      xni: satrec.xni,\n      nodem: nodem,\n      nm: nm\n    };\n    var dspaceResult = dspace(dspaceOptions);\n    em = dspaceResult.em;\n    argpm = dspaceResult.argpm;\n    inclm = dspaceResult.inclm;\n    mm = dspaceResult.mm;\n    nodem = dspaceResult.nodem;\n    nm = dspaceResult.nm;\n  }\n\n  if (nm <= 0.0) {\n    // printf(\"// error nm %f\\n\", nm);\n    satrec.error = 2; // sgp4fix add return\n\n    return [false, false];\n  }\n\n  var am = Math.pow(xke / nm, x2o3) * tempa * tempa;\n  nm = xke / Math.pow(am, 1.5);\n  em -= tempe; // fix tolerance for error recognition\n  // sgp4fix am is fixed from the previous nm check\n\n  if (em >= 1.0 || em < -0.001) {\n    // || (am < 0.95)\n    // printf(\"// error em %f\\n\", em);\n    satrec.error = 1; // sgp4fix to return if there is an error in eccentricity\n\n    return [false, false];\n  } //  sgp4fix fix tolerance to avoid a divide by zero\n\n\n  if (em < 1.0e-6) {\n    em = 1.0e-6;\n  }\n\n  mm += satrec.no * templ;\n  xlm = mm + argpm + nodem;\n  nodem %= twoPi;\n  argpm %= twoPi;\n  xlm %= twoPi;\n  mm = (xlm - argpm - nodem) % twoPi; // ----------------- compute extra mean quantities -------------\n\n  var sinim = Math.sin(inclm);\n  var cosim = Math.cos(inclm); // -------------------- add lunar-solar periodics --------------\n\n  var ep = em;\n  xincp = inclm;\n  argpp = argpm;\n  nodep = nodem;\n  mp = mm;\n  sinip = sinim;\n  cosip = cosim;\n\n  if (satrec.method === 'd') {\n    var dpperParameters = {\n      inclo: satrec.inclo,\n      init: 'n',\n      ep: ep,\n      inclp: xincp,\n      nodep: nodep,\n      argpp: argpp,\n      mp: mp,\n      opsmode: satrec.operationmode\n    };\n    var dpperResult = dpper(satrec, dpperParameters);\n    ep = dpperResult.ep;\n    nodep = dpperResult.nodep;\n    argpp = dpperResult.argpp;\n    mp = dpperResult.mp;\n    xincp = dpperResult.inclp;\n\n    if (xincp < 0.0) {\n      xincp = -xincp;\n      nodep += pi;\n      argpp -= pi;\n    }\n\n    if (ep < 0.0 || ep > 1.0) {\n      //  printf(\"// error ep %f\\n\", ep);\n      satrec.error = 3; //  sgp4fix add return\n\n      return [false, false];\n    }\n  } //  -------------------- long period periodics ------------------\n\n\n  if (satrec.method === 'd') {\n    sinip = Math.sin(xincp);\n    cosip = Math.cos(xincp);\n    satrec.aycof = -0.5 * j3oj2 * sinip; //  sgp4fix for divide by zero for xincp = 180 deg\n\n    if (Math.abs(cosip + 1.0) > 1.5e-12) {\n      satrec.xlcof = -0.25 * j3oj2 * sinip * (3.0 + 5.0 * cosip) / (1.0 + cosip);\n    } else {\n      satrec.xlcof = -0.25 * j3oj2 * sinip * (3.0 + 5.0 * cosip) / temp4;\n    }\n  }\n\n  var axnl = ep * Math.cos(argpp);\n  temp = 1.0 / (am * (1.0 - ep * ep));\n  var aynl = ep * Math.sin(argpp) + temp * satrec.aycof;\n  var xl = mp + argpp + nodep + temp * satrec.xlcof * axnl; // --------------------- solve kepler's equation ---------------\n\n  var u = (xl - nodep) % twoPi;\n  eo1 = u;\n  tem5 = 9999.9;\n  var ktr = 1; //    sgp4fix for kepler iteration\n  //    the following iteration needs better limits on corrections\n\n  while (Math.abs(tem5) >= 1.0e-12 && ktr <= 10) {\n    sineo1 = Math.sin(eo1);\n    coseo1 = Math.cos(eo1);\n    tem5 = 1.0 - coseo1 * axnl - sineo1 * aynl;\n    tem5 = (u - aynl * coseo1 + axnl * sineo1 - eo1) / tem5;\n\n    if (Math.abs(tem5) >= 0.95) {\n      if (tem5 > 0.0) {\n        tem5 = 0.95;\n      } else {\n        tem5 = -0.95;\n      }\n    }\n\n    eo1 += tem5;\n    ktr += 1;\n  } //  ------------- short period preliminary quantities -----------\n\n\n  var ecose = axnl * coseo1 + aynl * sineo1;\n  var esine = axnl * sineo1 - aynl * coseo1;\n  var el2 = axnl * axnl + aynl * aynl;\n  var pl = am * (1.0 - el2);\n\n  if (pl < 0.0) {\n    //  printf(\"// error pl %f\\n\", pl);\n    satrec.error = 4; //  sgp4fix add return\n\n    return [false, false];\n  }\n\n  var rl = am * (1.0 - ecose);\n  var rdotl = Math.sqrt(am) * esine / rl;\n  var rvdotl = Math.sqrt(pl) / rl;\n  var betal = Math.sqrt(1.0 - el2);\n  temp = esine / (1.0 + betal);\n  var sinu = am / rl * (sineo1 - aynl - axnl * temp);\n  var cosu = am / rl * (coseo1 - axnl + aynl * temp);\n  su = Math.atan2(sinu, cosu);\n  var sin2u = (cosu + cosu) * sinu;\n  var cos2u = 1.0 - 2.0 * sinu * sinu;\n  temp = 1.0 / pl;\n  var temp1 = 0.5 * j2 * temp;\n  var temp2 = temp1 * temp; // -------------- update for short period periodics ------------\n\n  if (satrec.method === 'd') {\n    cosisq = cosip * cosip;\n    satrec.con41 = 3.0 * cosisq - 1.0;\n    satrec.x1mth2 = 1.0 - cosisq;\n    satrec.x7thm1 = 7.0 * cosisq - 1.0;\n  }\n\n  var mrt = rl * (1.0 - 1.5 * temp2 * betal * satrec.con41) + 0.5 * temp1 * satrec.x1mth2 * cos2u; // sgp4fix for decaying satellites\n\n  if (mrt < 1.0) {\n    // printf(\"// decay condition %11.6f \\n\",mrt);\n    satrec.error = 6;\n    return {\n      position: false,\n      velocity: false\n    };\n  }\n\n  su -= 0.25 * temp2 * satrec.x7thm1 * sin2u;\n  var xnode = nodep + 1.5 * temp2 * cosip * sin2u;\n  var xinc = xincp + 1.5 * temp2 * cosip * sinip * cos2u;\n  var mvt = rdotl - nm * temp1 * satrec.x1mth2 * sin2u / xke;\n  var rvdot = rvdotl + nm * temp1 * (satrec.x1mth2 * cos2u + 1.5 * satrec.con41) / xke; // --------------------- orientation vectors -------------------\n\n  var sinsu = Math.sin(su);\n  var cossu = Math.cos(su);\n  var snod = Math.sin(xnode);\n  var cnod = Math.cos(xnode);\n  var sini = Math.sin(xinc);\n  var cosi = Math.cos(xinc);\n  var xmx = -snod * cosi;\n  var xmy = cnod * cosi;\n  var ux = xmx * sinsu + cnod * cossu;\n  var uy = xmy * sinsu + snod * cossu;\n  var uz = sini * sinsu;\n  var vx = xmx * cossu - cnod * sinsu;\n  var vy = xmy * cossu - snod * sinsu;\n  var vz = sini * cossu; // --------- position and velocity (in km and km/sec) ----------\n\n  var r = {\n    x: mrt * ux * earthRadius,\n    y: mrt * uy * earthRadius,\n    z: mrt * uz * earthRadius\n  };\n  var v = {\n    x: (mvt * ux + rvdot * vx) * vkmpersec,\n    y: (mvt * uy + rvdot * vy) * vkmpersec,\n    z: (mvt * uz + rvdot * vz) * vkmpersec\n  };\n  return {\n    position: r,\n    velocity: v\n  };\n  /* eslint-enable no-param-reassign */\n}\n\n/*-----------------------------------------------------------------------------\n *\n *                             procedure sgp4init\n *\n *  this procedure initializes variables for sgp4.\n *\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *  author        : david vallado                  719-573-2600   28 jun 2005\n *\n *  inputs        :\n *    opsmode     - mode of operation afspc or improved 'a', 'i'\n *    satn        - satellite number\n *    bstar       - sgp4 type drag coefficient              kg/m2er\n *    ecco        - eccentricity\n *    epoch       - epoch time in days from jan 0, 1950. 0 hr\n *    argpo       - argument of perigee (output if ds)\n *    inclo       - inclination\n *    mo          - mean anomaly (output if ds)\n *    no          - mean motion\n *    nodeo       - right ascension of ascending node\n *\n *  outputs       :\n *    rec      - common values for subsequent calls\n *    return code - non-zero on error.\n *                   1 - mean elements, ecc >= 1.0 or ecc < -0.001 or a < 0.95 er\n *                   2 - mean motion less than 0.0\n *                   3 - pert elements, ecc < 0.0  or  ecc > 1.0\n *                   4 - semi-latus rectum < 0.0\n *                   5 - epoch elements are sub-orbital\n *                   6 - satellite has decayed\n *\n *  locals        :\n *    cnodm  , snodm  , cosim  , sinim  , cosomm , sinomm\n *    cc1sq  , cc2    , cc3\n *    coef   , coef1\n *    cosio4      -\n *    day         -\n *    dndt        -\n *    em          - eccentricity\n *    emsq        - eccentricity squared\n *    eeta        -\n *    etasq       -\n *    gam         -\n *    argpm       - argument of perigee\n *    nodem       -\n *    inclm       - inclination\n *    mm          - mean anomaly\n *    nm          - mean motion\n *    perige      - perigee\n *    pinvsq      -\n *    psisq       -\n *    qzms24      -\n *    rtemsq      -\n *    s1, s2, s3, s4, s5, s6, s7          -\n *    sfour       -\n *    ss1, ss2, ss3, ss4, ss5, ss6, ss7         -\n *    sz1, sz2, sz3\n *    sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33        -\n *    tc          -\n *    temp        -\n *    temp1, temp2, temp3       -\n *    tsi         -\n *    xpidot      -\n *    xhdot1      -\n *    z1, z2, z3          -\n *    z11, z12, z13, z21, z22, z23, z31, z32, z33         -\n *\n *  coupling      :\n *    getgravconst-\n *    initl       -\n *    dscom       -\n *    dpper       -\n *    dsinit      -\n *    sgp4        -\n *\n *  references    :\n *    hoots, roehrich, norad spacetrack report #3 1980\n *    hoots, norad spacetrack report #6 1986\n *    hoots, schumacher and glover 2004\n *    vallado, crawford, hujsak, kelso  2006\n ----------------------------------------------------------------------------*/\n\nfunction sgp4init(satrec, options) {\n  /* eslint-disable no-param-reassign */\n  var opsmode = options.opsmode,\n      satn = options.satn,\n      epoch = options.epoch,\n      xbstar = options.xbstar,\n      xecco = options.xecco,\n      xargpo = options.xargpo,\n      xinclo = options.xinclo,\n      xmo = options.xmo,\n      xno = options.xno,\n      xnodeo = options.xnodeo;\n  var cosim;\n  var sinim;\n  var cc1sq;\n  var cc2;\n  var cc3;\n  var coef;\n  var coef1;\n  var cosio4;\n  var em;\n  var emsq;\n  var eeta;\n  var etasq;\n  var argpm;\n  var nodem;\n  var inclm;\n  var mm;\n  var nm;\n  var perige;\n  var pinvsq;\n  var psisq;\n  var qzms24;\n  var s1;\n  var s2;\n  var s3;\n  var s4;\n  var s5;\n  var sfour;\n  var ss1;\n  var ss2;\n  var ss3;\n  var ss4;\n  var ss5;\n  var sz1;\n  var sz3;\n  var sz11;\n  var sz13;\n  var sz21;\n  var sz23;\n  var sz31;\n  var sz33;\n  var tc;\n  var temp;\n  var temp1;\n  var temp2;\n  var temp3;\n  var tsi;\n  var xpidot;\n  var xhdot1;\n  var z1;\n  var z3;\n  var z11;\n  var z13;\n  var z21;\n  var z23;\n  var z31;\n  var z33;\n  /* ------------------------ initialization --------------------- */\n  // sgp4fix divisor for divide by zero check on inclination\n  // the old check used 1.0 + Math.cos(pi-1.0e-9), but then compared it to\n  // 1.5 e-12, so the threshold was changed to 1.5e-12 for consistency\n\n  var temp4 = 1.5e-12; // ----------- set all near earth variables to zero ------------\n\n  satrec.isimp = 0;\n  satrec.method = 'n';\n  satrec.aycof = 0.0;\n  satrec.con41 = 0.0;\n  satrec.cc1 = 0.0;\n  satrec.cc4 = 0.0;\n  satrec.cc5 = 0.0;\n  satrec.d2 = 0.0;\n  satrec.d3 = 0.0;\n  satrec.d4 = 0.0;\n  satrec.delmo = 0.0;\n  satrec.eta = 0.0;\n  satrec.argpdot = 0.0;\n  satrec.omgcof = 0.0;\n  satrec.sinmao = 0.0;\n  satrec.t = 0.0;\n  satrec.t2cof = 0.0;\n  satrec.t3cof = 0.0;\n  satrec.t4cof = 0.0;\n  satrec.t5cof = 0.0;\n  satrec.x1mth2 = 0.0;\n  satrec.x7thm1 = 0.0;\n  satrec.mdot = 0.0;\n  satrec.nodedot = 0.0;\n  satrec.xlcof = 0.0;\n  satrec.xmcof = 0.0;\n  satrec.nodecf = 0.0; // ----------- set all deep space variables to zero ------------\n\n  satrec.irez = 0;\n  satrec.d2201 = 0.0;\n  satrec.d2211 = 0.0;\n  satrec.d3210 = 0.0;\n  satrec.d3222 = 0.0;\n  satrec.d4410 = 0.0;\n  satrec.d4422 = 0.0;\n  satrec.d5220 = 0.0;\n  satrec.d5232 = 0.0;\n  satrec.d5421 = 0.0;\n  satrec.d5433 = 0.0;\n  satrec.dedt = 0.0;\n  satrec.del1 = 0.0;\n  satrec.del2 = 0.0;\n  satrec.del3 = 0.0;\n  satrec.didt = 0.0;\n  satrec.dmdt = 0.0;\n  satrec.dnodt = 0.0;\n  satrec.domdt = 0.0;\n  satrec.e3 = 0.0;\n  satrec.ee2 = 0.0;\n  satrec.peo = 0.0;\n  satrec.pgho = 0.0;\n  satrec.pho = 0.0;\n  satrec.pinco = 0.0;\n  satrec.plo = 0.0;\n  satrec.se2 = 0.0;\n  satrec.se3 = 0.0;\n  satrec.sgh2 = 0.0;\n  satrec.sgh3 = 0.0;\n  satrec.sgh4 = 0.0;\n  satrec.sh2 = 0.0;\n  satrec.sh3 = 0.0;\n  satrec.si2 = 0.0;\n  satrec.si3 = 0.0;\n  satrec.sl2 = 0.0;\n  satrec.sl3 = 0.0;\n  satrec.sl4 = 0.0;\n  satrec.gsto = 0.0;\n  satrec.xfact = 0.0;\n  satrec.xgh2 = 0.0;\n  satrec.xgh3 = 0.0;\n  satrec.xgh4 = 0.0;\n  satrec.xh2 = 0.0;\n  satrec.xh3 = 0.0;\n  satrec.xi2 = 0.0;\n  satrec.xi3 = 0.0;\n  satrec.xl2 = 0.0;\n  satrec.xl3 = 0.0;\n  satrec.xl4 = 0.0;\n  satrec.xlamo = 0.0;\n  satrec.zmol = 0.0;\n  satrec.zmos = 0.0;\n  satrec.atime = 0.0;\n  satrec.xli = 0.0;\n  satrec.xni = 0.0; // sgp4fix - note the following variables are also passed directly via satrec.\n  // it is possible to streamline the sgp4init call by deleting the \"x\"\n  // variables, but the user would need to set the satrec.* values first. we\n  // include the additional assignments in case twoline2rv is not used.\n\n  satrec.bstar = xbstar;\n  satrec.ecco = xecco;\n  satrec.argpo = xargpo;\n  satrec.inclo = xinclo;\n  satrec.mo = xmo;\n  satrec.no = xno;\n  satrec.nodeo = xnodeo; //  sgp4fix add opsmode\n\n  satrec.operationmode = opsmode; // ------------------------ earth constants -----------------------\n  // sgp4fix identify constants and allow alternate values\n\n  var ss = 78.0 / earthRadius + 1.0; // sgp4fix use multiply for speed instead of pow\n\n  var qzms2ttemp = (120.0 - 78.0) / earthRadius;\n  var qzms2t = qzms2ttemp * qzms2ttemp * qzms2ttemp * qzms2ttemp;\n  satrec.init = 'y';\n  satrec.t = 0.0;\n  var initlOptions = {\n    satn: satn,\n    ecco: satrec.ecco,\n    epoch: epoch,\n    inclo: satrec.inclo,\n    no: satrec.no,\n    method: satrec.method,\n    opsmode: satrec.operationmode\n  };\n  var initlResult = initl(initlOptions);\n  var ao = initlResult.ao,\n      con42 = initlResult.con42,\n      cosio = initlResult.cosio,\n      cosio2 = initlResult.cosio2,\n      eccsq = initlResult.eccsq,\n      omeosq = initlResult.omeosq,\n      posq = initlResult.posq,\n      rp = initlResult.rp,\n      rteosq = initlResult.rteosq,\n      sinio = initlResult.sinio;\n  satrec.no = initlResult.no;\n  satrec.con41 = initlResult.con41;\n  satrec.gsto = initlResult.gsto;\n  satrec.error = 0; // sgp4fix remove this check as it is unnecessary\n  // the mrt check in sgp4 handles decaying satellite cases even if the starting\n  // condition is below the surface of te earth\n  // if (rp < 1.0)\n  // {\n  //   printf(\"// *** satn%d epoch elts sub-orbital ***\\n\", satn);\n  //   satrec.error = 5;\n  // }\n\n  if (omeosq >= 0.0 || satrec.no >= 0.0) {\n    satrec.isimp = 0;\n\n    if (rp < 220.0 / earthRadius + 1.0) {\n      satrec.isimp = 1;\n    }\n\n    sfour = ss;\n    qzms24 = qzms2t;\n    perige = (rp - 1.0) * earthRadius; // - for perigees below 156 km, s and qoms2t are altered -\n\n    if (perige < 156.0) {\n      sfour = perige - 78.0;\n\n      if (perige < 98.0) {\n        sfour = 20.0;\n      } // sgp4fix use multiply for speed instead of pow\n\n\n      var qzms24temp = (120.0 - sfour) / earthRadius;\n      qzms24 = qzms24temp * qzms24temp * qzms24temp * qzms24temp;\n      sfour = sfour / earthRadius + 1.0;\n    }\n\n    pinvsq = 1.0 / posq;\n    tsi = 1.0 / (ao - sfour);\n    satrec.eta = ao * satrec.ecco * tsi;\n    etasq = satrec.eta * satrec.eta;\n    eeta = satrec.ecco * satrec.eta;\n    psisq = Math.abs(1.0 - etasq);\n    coef = qzms24 * Math.pow(tsi, 4.0);\n    coef1 = coef / Math.pow(psisq, 3.5);\n    cc2 = coef1 * satrec.no * (ao * (1.0 + 1.5 * etasq + eeta * (4.0 + etasq)) + 0.375 * j2 * tsi / psisq * satrec.con41 * (8.0 + 3.0 * etasq * (8.0 + etasq)));\n    satrec.cc1 = satrec.bstar * cc2;\n    cc3 = 0.0;\n\n    if (satrec.ecco > 1.0e-4) {\n      cc3 = -2.0 * coef * tsi * j3oj2 * satrec.no * sinio / satrec.ecco;\n    }\n\n    satrec.x1mth2 = 1.0 - cosio2;\n    satrec.cc4 = 2.0 * satrec.no * coef1 * ao * omeosq * (satrec.eta * (2.0 + 0.5 * etasq) + satrec.ecco * (0.5 + 2.0 * etasq) - j2 * tsi / (ao * psisq) * (-3.0 * satrec.con41 * (1.0 - 2.0 * eeta + etasq * (1.5 - 0.5 * eeta)) + 0.75 * satrec.x1mth2 * (2.0 * etasq - eeta * (1.0 + etasq)) * Math.cos(2.0 * satrec.argpo)));\n    satrec.cc5 = 2.0 * coef1 * ao * omeosq * (1.0 + 2.75 * (etasq + eeta) + eeta * etasq);\n    cosio4 = cosio2 * cosio2;\n    temp1 = 1.5 * j2 * pinvsq * satrec.no;\n    temp2 = 0.5 * temp1 * j2 * pinvsq;\n    temp3 = -0.46875 * j4 * pinvsq * pinvsq * satrec.no;\n    satrec.mdot = satrec.no + 0.5 * temp1 * rteosq * satrec.con41 + 0.0625 * temp2 * rteosq * (13.0 - 78.0 * cosio2 + 137.0 * cosio4);\n    satrec.argpdot = -0.5 * temp1 * con42 + 0.0625 * temp2 * (7.0 - 114.0 * cosio2 + 395.0 * cosio4) + temp3 * (3.0 - 36.0 * cosio2 + 49.0 * cosio4);\n    xhdot1 = -temp1 * cosio;\n    satrec.nodedot = xhdot1 + (0.5 * temp2 * (4.0 - 19.0 * cosio2) + 2.0 * temp3 * (3.0 - 7.0 * cosio2)) * cosio;\n    xpidot = satrec.argpdot + satrec.nodedot;\n    satrec.omgcof = satrec.bstar * cc3 * Math.cos(satrec.argpo);\n    satrec.xmcof = 0.0;\n\n    if (satrec.ecco > 1.0e-4) {\n      satrec.xmcof = -x2o3 * coef * satrec.bstar / eeta;\n    }\n\n    satrec.nodecf = 3.5 * omeosq * xhdot1 * satrec.cc1;\n    satrec.t2cof = 1.5 * satrec.cc1; // sgp4fix for divide by zero with xinco = 180 deg\n\n    if (Math.abs(cosio + 1.0) > 1.5e-12) {\n      satrec.xlcof = -0.25 * j3oj2 * sinio * (3.0 + 5.0 * cosio) / (1.0 + cosio);\n    } else {\n      satrec.xlcof = -0.25 * j3oj2 * sinio * (3.0 + 5.0 * cosio) / temp4;\n    }\n\n    satrec.aycof = -0.5 * j3oj2 * sinio; // sgp4fix use multiply for speed instead of pow\n\n    var delmotemp = 1.0 + satrec.eta * Math.cos(satrec.mo);\n    satrec.delmo = delmotemp * delmotemp * delmotemp;\n    satrec.sinmao = Math.sin(satrec.mo);\n    satrec.x7thm1 = 7.0 * cosio2 - 1.0; // --------------- deep space initialization -------------\n\n    if (2 * pi / satrec.no >= 225.0) {\n      satrec.method = 'd';\n      satrec.isimp = 1;\n      tc = 0.0;\n      inclm = satrec.inclo;\n      var dscomOptions = {\n        epoch: epoch,\n        ep: satrec.ecco,\n        argpp: satrec.argpo,\n        tc: tc,\n        inclp: satrec.inclo,\n        nodep: satrec.nodeo,\n        np: satrec.no,\n        e3: satrec.e3,\n        ee2: satrec.ee2,\n        peo: satrec.peo,\n        pgho: satrec.pgho,\n        pho: satrec.pho,\n        pinco: satrec.pinco,\n        plo: satrec.plo,\n        se2: satrec.se2,\n        se3: satrec.se3,\n        sgh2: satrec.sgh2,\n        sgh3: satrec.sgh3,\n        sgh4: satrec.sgh4,\n        sh2: satrec.sh2,\n        sh3: satrec.sh3,\n        si2: satrec.si2,\n        si3: satrec.si3,\n        sl2: satrec.sl2,\n        sl3: satrec.sl3,\n        sl4: satrec.sl4,\n        xgh2: satrec.xgh2,\n        xgh3: satrec.xgh3,\n        xgh4: satrec.xgh4,\n        xh2: satrec.xh2,\n        xh3: satrec.xh3,\n        xi2: satrec.xi2,\n        xi3: satrec.xi3,\n        xl2: satrec.xl2,\n        xl3: satrec.xl3,\n        xl4: satrec.xl4,\n        zmol: satrec.zmol,\n        zmos: satrec.zmos\n      };\n      var dscomResult = dscom(dscomOptions);\n      satrec.e3 = dscomResult.e3;\n      satrec.ee2 = dscomResult.ee2;\n      satrec.peo = dscomResult.peo;\n      satrec.pgho = dscomResult.pgho;\n      satrec.pho = dscomResult.pho;\n      satrec.pinco = dscomResult.pinco;\n      satrec.plo = dscomResult.plo;\n      satrec.se2 = dscomResult.se2;\n      satrec.se3 = dscomResult.se3;\n      satrec.sgh2 = dscomResult.sgh2;\n      satrec.sgh3 = dscomResult.sgh3;\n      satrec.sgh4 = dscomResult.sgh4;\n      satrec.sh2 = dscomResult.sh2;\n      satrec.sh3 = dscomResult.sh3;\n      satrec.si2 = dscomResult.si2;\n      satrec.si3 = dscomResult.si3;\n      satrec.sl2 = dscomResult.sl2;\n      satrec.sl3 = dscomResult.sl3;\n      satrec.sl4 = dscomResult.sl4;\n      sinim = dscomResult.sinim;\n      cosim = dscomResult.cosim;\n      em = dscomResult.em;\n      emsq = dscomResult.emsq;\n      s1 = dscomResult.s1;\n      s2 = dscomResult.s2;\n      s3 = dscomResult.s3;\n      s4 = dscomResult.s4;\n      s5 = dscomResult.s5;\n      ss1 = dscomResult.ss1;\n      ss2 = dscomResult.ss2;\n      ss3 = dscomResult.ss3;\n      ss4 = dscomResult.ss4;\n      ss5 = dscomResult.ss5;\n      sz1 = dscomResult.sz1;\n      sz3 = dscomResult.sz3;\n      sz11 = dscomResult.sz11;\n      sz13 = dscomResult.sz13;\n      sz21 = dscomResult.sz21;\n      sz23 = dscomResult.sz23;\n      sz31 = dscomResult.sz31;\n      sz33 = dscomResult.sz33;\n      satrec.xgh2 = dscomResult.xgh2;\n      satrec.xgh3 = dscomResult.xgh3;\n      satrec.xgh4 = dscomResult.xgh4;\n      satrec.xh2 = dscomResult.xh2;\n      satrec.xh3 = dscomResult.xh3;\n      satrec.xi2 = dscomResult.xi2;\n      satrec.xi3 = dscomResult.xi3;\n      satrec.xl2 = dscomResult.xl2;\n      satrec.xl3 = dscomResult.xl3;\n      satrec.xl4 = dscomResult.xl4;\n      satrec.zmol = dscomResult.zmol;\n      satrec.zmos = dscomResult.zmos;\n      nm = dscomResult.nm;\n      z1 = dscomResult.z1;\n      z3 = dscomResult.z3;\n      z11 = dscomResult.z11;\n      z13 = dscomResult.z13;\n      z21 = dscomResult.z21;\n      z23 = dscomResult.z23;\n      z31 = dscomResult.z31;\n      z33 = dscomResult.z33;\n      var dpperOptions = {\n        inclo: inclm,\n        init: satrec.init,\n        ep: satrec.ecco,\n        inclp: satrec.inclo,\n        nodep: satrec.nodeo,\n        argpp: satrec.argpo,\n        mp: satrec.mo,\n        opsmode: satrec.operationmode\n      };\n      var dpperResult = dpper(satrec, dpperOptions);\n      satrec.ecco = dpperResult.ep;\n      satrec.inclo = dpperResult.inclp;\n      satrec.nodeo = dpperResult.nodep;\n      satrec.argpo = dpperResult.argpp;\n      satrec.mo = dpperResult.mp;\n      argpm = 0.0;\n      nodem = 0.0;\n      mm = 0.0;\n      var dsinitOptions = {\n        cosim: cosim,\n        emsq: emsq,\n        argpo: satrec.argpo,\n        s1: s1,\n        s2: s2,\n        s3: s3,\n        s4: s4,\n        s5: s5,\n        sinim: sinim,\n        ss1: ss1,\n        ss2: ss2,\n        ss3: ss3,\n        ss4: ss4,\n        ss5: ss5,\n        sz1: sz1,\n        sz3: sz3,\n        sz11: sz11,\n        sz13: sz13,\n        sz21: sz21,\n        sz23: sz23,\n        sz31: sz31,\n        sz33: sz33,\n        t: satrec.t,\n        tc: tc,\n        gsto: satrec.gsto,\n        mo: satrec.mo,\n        mdot: satrec.mdot,\n        no: satrec.no,\n        nodeo: satrec.nodeo,\n        nodedot: satrec.nodedot,\n        xpidot: xpidot,\n        z1: z1,\n        z3: z3,\n        z11: z11,\n        z13: z13,\n        z21: z21,\n        z23: z23,\n        z31: z31,\n        z33: z33,\n        ecco: satrec.ecco,\n        eccsq: eccsq,\n        em: em,\n        argpm: argpm,\n        inclm: inclm,\n        mm: mm,\n        nm: nm,\n        nodem: nodem,\n        irez: satrec.irez,\n        atime: satrec.atime,\n        d2201: satrec.d2201,\n        d2211: satrec.d2211,\n        d3210: satrec.d3210,\n        d3222: satrec.d3222,\n        d4410: satrec.d4410,\n        d4422: satrec.d4422,\n        d5220: satrec.d5220,\n        d5232: satrec.d5232,\n        d5421: satrec.d5421,\n        d5433: satrec.d5433,\n        dedt: satrec.dedt,\n        didt: satrec.didt,\n        dmdt: satrec.dmdt,\n        dnodt: satrec.dnodt,\n        domdt: satrec.domdt,\n        del1: satrec.del1,\n        del2: satrec.del2,\n        del3: satrec.del3,\n        xfact: satrec.xfact,\n        xlamo: satrec.xlamo,\n        xli: satrec.xli,\n        xni: satrec.xni\n      };\n      var dsinitResult = dsinit(dsinitOptions);\n      satrec.irez = dsinitResult.irez;\n      satrec.atime = dsinitResult.atime;\n      satrec.d2201 = dsinitResult.d2201;\n      satrec.d2211 = dsinitResult.d2211;\n      satrec.d3210 = dsinitResult.d3210;\n      satrec.d3222 = dsinitResult.d3222;\n      satrec.d4410 = dsinitResult.d4410;\n      satrec.d4422 = dsinitResult.d4422;\n      satrec.d5220 = dsinitResult.d5220;\n      satrec.d5232 = dsinitResult.d5232;\n      satrec.d5421 = dsinitResult.d5421;\n      satrec.d5433 = dsinitResult.d5433;\n      satrec.dedt = dsinitResult.dedt;\n      satrec.didt = dsinitResult.didt;\n      satrec.dmdt = dsinitResult.dmdt;\n      satrec.dnodt = dsinitResult.dnodt;\n      satrec.domdt = dsinitResult.domdt;\n      satrec.del1 = dsinitResult.del1;\n      satrec.del2 = dsinitResult.del2;\n      satrec.del3 = dsinitResult.del3;\n      satrec.xfact = dsinitResult.xfact;\n      satrec.xlamo = dsinitResult.xlamo;\n      satrec.xli = dsinitResult.xli;\n      satrec.xni = dsinitResult.xni;\n    } // ----------- set variables if not deep space -----------\n\n\n    if (satrec.isimp !== 1) {\n      cc1sq = satrec.cc1 * satrec.cc1;\n      satrec.d2 = 4.0 * ao * tsi * cc1sq;\n      temp = satrec.d2 * tsi * satrec.cc1 / 3.0;\n      satrec.d3 = (17.0 * ao + sfour) * temp;\n      satrec.d4 = 0.5 * temp * ao * tsi * (221.0 * ao + 31.0 * sfour) * satrec.cc1;\n      satrec.t3cof = satrec.d2 + 2.0 * cc1sq;\n      satrec.t4cof = 0.25 * (3.0 * satrec.d3 + satrec.cc1 * (12.0 * satrec.d2 + 10.0 * cc1sq));\n      satrec.t5cof = 0.2 * (3.0 * satrec.d4 + 12.0 * satrec.cc1 * satrec.d3 + 6.0 * satrec.d2 * satrec.d2 + 15.0 * cc1sq * (2.0 * satrec.d2 + cc1sq));\n    }\n    /* finally propogate to zero epoch to initialize all others. */\n    // sgp4fix take out check to let satellites process until they are actually below earth surface\n    // if(satrec.error == 0)\n\n  }\n\n  sgp4(satrec, 0, 0);\n  satrec.init = 'n';\n  /* eslint-enable no-param-reassign */\n}\n\n/* -----------------------------------------------------------------------------\n *\n *                           function twoline2rv\n *\n *  this function converts the two line element set character string data to\n *    variables and initializes the sgp4 variables. several intermediate varaibles\n *    and quantities are determined. note that the result is a structure so multiple\n *    satellites can be processed simultaneously without having to reinitialize. the\n *    verification mode is an important option that permits quick checks of any\n *    changes to the underlying technical theory. this option works using a\n *    modified tle file in which the start, stop, and delta time values are\n *    included at the end of the second line of data. this only works with the\n *    verification mode. the catalog mode simply propagates from -1440 to 1440 min\n *    from epoch and is useful when performing entire catalog runs.\n *\n *  author        : david vallado                  719-573-2600    1 mar 2001\n *\n *  inputs        :\n *    longstr1    - first line of the tle\n *    longstr2    - second line of the tle\n *    typerun     - type of run                    verification 'v', catalog 'c',\n *                                                 manual 'm'\n *    typeinput   - type of manual input           mfe 'm', epoch 'e', dayofyr 'd'\n *    opsmode     - mode of operation afspc or improved 'a', 'i'\n *    whichconst  - which set of constants to use  72, 84\n *\n *  outputs       :\n *    satrec      - structure containing all the sgp4 satellite information\n *\n *  coupling      :\n *    getgravconst-\n *    days2mdhms  - conversion of days to month, day, hour, minute, second\n *    jday        - convert day month year hour minute second into julian date\n *    sgp4init    - initialize the sgp4 variables\n *\n *  references    :\n *    norad spacetrack report #3\n *    vallado, crawford, hujsak, kelso  2006\n --------------------------------------------------------------------------- */\n\n/**\n * Return a Satellite imported from two lines of TLE data.\n *\n * Provide the two TLE lines as strings `longstr1` and `longstr2`,\n * and select which standard set of gravitational constants you want\n * by providing `gravity_constants`:\n *\n * `sgp4.propagation.wgs72` - Standard WGS 72 model\n * `sgp4.propagation.wgs84` - More recent WGS 84 model\n * `sgp4.propagation.wgs72old` - Legacy support for old SGP4 behavior\n *\n * Normally, computations are made using letious recent improvements\n * to the algorithm.  If you want to turn some of these off and go\n * back into \"afspc\" mode, then set `afspc_mode` to `True`.\n */\n\nfunction twoline2satrec(longstr1, longstr2) {\n  var opsmode = 'i';\n  var xpdotp = 1440.0 / (2.0 * pi); // 229.1831180523293;\n\n  var year = 0;\n  var satrec = {};\n  satrec.error = 0;\n  satrec.satnum = longstr1.substring(2, 7);\n  satrec.epochyr = parseInt(longstr1.substring(18, 20), 10);\n  satrec.epochdays = parseFloat(longstr1.substring(20, 32));\n  satrec.ndot = parseFloat(longstr1.substring(33, 43));\n  satrec.nddot = parseFloat(\".\".concat(parseInt(longstr1.substring(44, 50), 10), \"E\").concat(longstr1.substring(50, 52)));\n  satrec.bstar = parseFloat(\"\".concat(longstr1.substring(53, 54), \".\").concat(parseInt(longstr1.substring(54, 59), 10), \"E\").concat(longstr1.substring(59, 61))); // satrec.satnum = longstr2.substring(2, 7);\n\n  satrec.inclo = parseFloat(longstr2.substring(8, 16));\n  satrec.nodeo = parseFloat(longstr2.substring(17, 25));\n  satrec.ecco = parseFloat(\".\".concat(longstr2.substring(26, 33)));\n  satrec.argpo = parseFloat(longstr2.substring(34, 42));\n  satrec.mo = parseFloat(longstr2.substring(43, 51));\n  satrec.no = parseFloat(longstr2.substring(52, 63)); // ---- find no, ndot, nddot ----\n\n  satrec.no /= xpdotp; //   rad/min\n  // satrec.nddot= satrec.nddot * Math.pow(10.0, nexp);\n  // satrec.bstar= satrec.bstar * Math.pow(10.0, ibexp);\n  // ---- convert to sgp4 units ----\n\n  satrec.a = Math.pow(satrec.no * tumin, -2.0 / 3.0);\n  satrec.ndot /= xpdotp * 1440.0; // ? * minperday\n\n  satrec.nddot /= xpdotp * 1440.0 * 1440; // ---- find standard orbital elements ----\n\n  satrec.inclo *= deg2rad;\n  satrec.nodeo *= deg2rad;\n  satrec.argpo *= deg2rad;\n  satrec.mo *= deg2rad;\n  satrec.alta = satrec.a * (1.0 + satrec.ecco) - 1.0;\n  satrec.altp = satrec.a * (1.0 - satrec.ecco) - 1.0; // ----------------------------------------------------------------\n  // find sgp4epoch time of element set\n  // remember that sgp4 uses units of days from 0 jan 1950 (sgp4epoch)\n  // and minutes from the epoch (time)\n  // ----------------------------------------------------------------\n  // ---------------- temp fix for years from 1957-2056 -------------------\n  // --------- correct fix will occur when year is 4-digit in tle ---------\n\n  if (satrec.epochyr < 57) {\n    year = satrec.epochyr + 2000;\n  } else {\n    year = satrec.epochyr + 1900;\n  }\n\n  var mdhmsResult = days2mdhms(year, satrec.epochdays);\n  var mon = mdhmsResult.mon,\n      day = mdhmsResult.day,\n      hr = mdhmsResult.hr,\n      minute = mdhmsResult.minute,\n      sec = mdhmsResult.sec;\n  satrec.jdsatepoch = jday(year, mon, day, hr, minute, sec); //  ---------------- initialize the orbit at sgp4epoch -------------------\n\n  sgp4init(satrec, {\n    opsmode: opsmode,\n    satn: satrec.satnum,\n    epoch: satrec.jdsatepoch - 2433281.5,\n    xbstar: satrec.bstar,\n    xecco: satrec.ecco,\n    xargpo: satrec.argpo,\n    xinclo: satrec.inclo,\n    xmo: satrec.mo,\n    xno: satrec.no,\n    xnodeo: satrec.nodeo\n  });\n  return satrec;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction propagate() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  // Return a position and velocity vector for a given date and time.\n  var satrec = args[0];\n  var date = Array.prototype.slice.call(args, 1);\n  var j = jday.apply(void 0, _toConsumableArray(date));\n  var m = (j - satrec.jdsatepoch) * minutesPerDay;\n  return sgp4(satrec, m);\n}\n\nfunction dopplerFactor(location, position, velocity) {\n  var currentRange = Math.sqrt(Math.pow(position.x - location.x, 2) + Math.pow(position.y - location.y, 2) + Math.pow(position.z - location.z, 2));\n  var nextPos = {\n    x: position.x + velocity.x,\n    y: position.y + velocity.y,\n    z: position.z + velocity.z\n  };\n  var nextRange = Math.sqrt(Math.pow(nextPos.x - location.x, 2) + Math.pow(nextPos.y - location.y, 2) + Math.pow(nextPos.z - location.z, 2));\n  var rangeRate = nextRange - currentRange;\n\n  function sign(value) {\n    return value >= 0 ? 1 : -1;\n  }\n\n  rangeRate *= sign(rangeRate);\n  var c = 299792.458; // Speed of light in km/s\n\n  return 1 + rangeRate / c;\n}\n\nfunction radiansToDegrees(radians) {\n  return radians * rad2deg;\n}\nfunction degreesToRadians(degrees) {\n  return degrees * deg2rad;\n}\nfunction degreesLat(radians) {\n  if (radians < -pi / 2 || radians > pi / 2) {\n    throw new RangeError('Latitude radians must be in range [-pi/2; pi/2].');\n  }\n\n  return radiansToDegrees(radians);\n}\nfunction degreesLong(radians) {\n  if (radians < -pi || radians > pi) {\n    throw new RangeError('Longitude radians must be in range [-pi; pi].');\n  }\n\n  return radiansToDegrees(radians);\n}\nfunction radiansLat(degrees) {\n  if (degrees < -90 || degrees > 90) {\n    throw new RangeError('Latitude degrees must be in range [-90; 90].');\n  }\n\n  return degreesToRadians(degrees);\n}\nfunction radiansLong(degrees) {\n  if (degrees < -180 || degrees > 180) {\n    throw new RangeError('Longitude degrees must be in range [-180; 180].');\n  }\n\n  return degreesToRadians(degrees);\n}\nfunction geodeticToEcf(geodetic) {\n  var longitude = geodetic.longitude,\n      latitude = geodetic.latitude,\n      height = geodetic.height;\n  var a = 6378.137;\n  var b = 6356.7523142;\n  var f = (a - b) / a;\n  var e2 = 2 * f - f * f;\n  var normal = a / Math.sqrt(1 - e2 * (Math.sin(latitude) * Math.sin(latitude)));\n  var x = (normal + height) * Math.cos(latitude) * Math.cos(longitude);\n  var y = (normal + height) * Math.cos(latitude) * Math.sin(longitude);\n  var z = (normal * (1 - e2) + height) * Math.sin(latitude);\n  return {\n    x: x,\n    y: y,\n    z: z\n  };\n}\nfunction eciToGeodetic(eci, gmst) {\n  // http://www.celestrak.com/columns/v02n03/\n  var a = 6378.137;\n  var b = 6356.7523142;\n  var R = Math.sqrt(eci.x * eci.x + eci.y * eci.y);\n  var f = (a - b) / a;\n  var e2 = 2 * f - f * f;\n  var longitude = Math.atan2(eci.y, eci.x) - gmst;\n\n  while (longitude < -pi) {\n    longitude += twoPi;\n  }\n\n  while (longitude > pi) {\n    longitude -= twoPi;\n  }\n\n  var kmax = 20;\n  var k = 0;\n  var latitude = Math.atan2(eci.z, Math.sqrt(eci.x * eci.x + eci.y * eci.y));\n  var C;\n\n  while (k < kmax) {\n    C = 1 / Math.sqrt(1 - e2 * (Math.sin(latitude) * Math.sin(latitude)));\n    latitude = Math.atan2(eci.z + a * C * e2 * Math.sin(latitude), R);\n    k += 1;\n  }\n\n  var height = R / Math.cos(latitude) - a * C;\n  return {\n    longitude: longitude,\n    latitude: latitude,\n    height: height\n  };\n}\nfunction ecfToEci(ecf, gmst) {\n  // ccar.colorado.edu/ASEN5070/handouts/coordsys.doc\n  //\n  // [X]     [C -S  0][X]\n  // [Y]  =  [S  C  0][Y]\n  // [Z]eci  [0  0  1][Z]ecf\n  //\n  var X = ecf.x * Math.cos(gmst) - ecf.y * Math.sin(gmst);\n  var Y = ecf.x * Math.sin(gmst) + ecf.y * Math.cos(gmst);\n  var Z = ecf.z;\n  return {\n    x: X,\n    y: Y,\n    z: Z\n  };\n}\nfunction eciToEcf(eci, gmst) {\n  // ccar.colorado.edu/ASEN5070/handouts/coordsys.doc\n  //\n  // [X]     [C -S  0][X]\n  // [Y]  =  [S  C  0][Y]\n  // [Z]eci  [0  0  1][Z]ecf\n  //\n  //\n  // Inverse:\n  // [X]     [C  S  0][X]\n  // [Y]  =  [-S C  0][Y]\n  // [Z]ecf  [0  0  1][Z]eci\n  var x = eci.x * Math.cos(gmst) + eci.y * Math.sin(gmst);\n  var y = eci.x * -Math.sin(gmst) + eci.y * Math.cos(gmst);\n  var z = eci.z;\n  return {\n    x: x,\n    y: y,\n    z: z\n  };\n}\n\nfunction topocentric(observerGeodetic, satelliteEcf) {\n  // http://www.celestrak.com/columns/v02n02/\n  // TS Kelso's method, except I'm using ECF frame\n  // and he uses ECI.\n  var longitude = observerGeodetic.longitude,\n      latitude = observerGeodetic.latitude;\n  var observerEcf = geodeticToEcf(observerGeodetic);\n  var rx = satelliteEcf.x - observerEcf.x;\n  var ry = satelliteEcf.y - observerEcf.y;\n  var rz = satelliteEcf.z - observerEcf.z;\n  var topS = Math.sin(latitude) * Math.cos(longitude) * rx + Math.sin(latitude) * Math.sin(longitude) * ry - Math.cos(latitude) * rz;\n  var topE = -Math.sin(longitude) * rx + Math.cos(longitude) * ry;\n  var topZ = Math.cos(latitude) * Math.cos(longitude) * rx + Math.cos(latitude) * Math.sin(longitude) * ry + Math.sin(latitude) * rz;\n  return {\n    topS: topS,\n    topE: topE,\n    topZ: topZ\n  };\n}\n/**\n * @param {Object} tc\n * @param {Number} tc.topS Positive horizontal vector S due south.\n * @param {Number} tc.topE Positive horizontal vector E due east.\n * @param {Number} tc.topZ Vector Z normal to the surface of the earth (up).\n * @returns {Object}\n */\n\n\nfunction topocentricToLookAngles(tc) {\n  var topS = tc.topS,\n      topE = tc.topE,\n      topZ = tc.topZ;\n  var rangeSat = Math.sqrt(topS * topS + topE * topE + topZ * topZ);\n  var El = Math.asin(topZ / rangeSat);\n  var Az = Math.atan2(-topE, topS) + pi;\n  return {\n    azimuth: Az,\n    elevation: El,\n    rangeSat: rangeSat // Range in km\n\n  };\n}\n\nfunction ecfToLookAngles(observerGeodetic, satelliteEcf) {\n  var topocentricCoords = topocentric(observerGeodetic, satelliteEcf);\n  return topocentricToLookAngles(topocentricCoords);\n}\n\nexport { constants, propagate, sgp4, twoline2satrec, gstime, jday, invjday, dopplerFactor, radiansToDegrees, degreesToRadians, degreesLat, degreesLong, radiansLat, radiansLong, geodeticToEcf, eciToGeodetic, eciToEcf, ecfToEci, ecfToLookAngles };","import * as satellite from './satellite';\n\nfunction deg2rad(deg) {\n    return deg * (Math.PI / 180);\n}\n\nfunction rad2deg(rad) {\n    return rad * (180 / Math.PI);\n}\n\nfunction computeSatrec(tleLine1, tleLine2) {\n    return satellite.twoline2satrec(tleLine1, tleLine2);\n}\n\nfunction getOrbitPositionWithPositionalData(satrec, date) {\n\n    var positionEci = getPositionEci(satrec, date);\n    var gmst = getGmst(date);\n    var position_gd = satellite.eciToGeodetic(positionEci, gmst);\n    var latitude = satellite.degreesLat(position_gd.latitude);\n    var longitude = satellite.degreesLong(position_gd.longitude);\n    var altitude = position_gd.height * 1000;\n\n    return {\n        position_eci: positionEci,\n        gmst: gmst,\n        position: {latitude, longitude, altitude}\n    };\n}\n\n\nfunction getOrbitPosition(satrec, date) {\n\n    var positionEci = getPositionEci(satrec, date);\n    var gmst = getGmst(date);\n    var position_gd = satellite.eciToGeodetic(positionEci, gmst);\n    var latitude = satellite.degreesLat(position_gd.latitude);\n    var longitude = satellite.degreesLong(position_gd.longitude);\n    var altitude = position_gd.height * 1000;\n\n    return {latitude, longitude, altitude};\n}\n\nfunction getElevationWithPositionalData(position_eci, gmst, observerGd) {\n    var positionEcf = satellite.eciToEcf(position_eci, gmst);\n    var lookAngles = satellite.ecfToLookAngles(observerGd, positionEcf);\n    return lookAngles.elevation;\n}\n\nfunction getPositionEci(satrec, date) {\n    var positionAndVelocity = satellite.propagate(\n        satrec,\n        date.getUTCFullYear(),\n        date.getUTCMonth() + 1,\n        date.getUTCDate(),\n        date.getUTCHours(),\n        date.getUTCMinutes(),\n        date.getUTCSeconds()\n    );\n\n    return positionAndVelocity.position;\n}\n\nfunction getGmst(date) {\n    return satellite.gstime(\n        date.getUTCFullYear(),\n        date.getUTCMonth() + 1,\n        date.getUTCDate(),\n        date.getUTCHours(),\n        date.getUTCMinutes(),\n        date.getUTCSeconds()\n    );\n}\n\nfunction headingAngleRadians(latStart, longStart, latEnd, longEnd) {\n    var headingAngle = 0;\n\n    var northPoleCurrentPositionDiff = pointToPointDistance(\n        {latitude: 90, longitude: 0},\n        {latitude: latStart, longitude: longStart}\n    );\n\n    var nextPositionCurrentPositionDiff = pointToPointDistance(\n        {latitude: latStart, longitude: longStart},\n        {latitude: latEnd, longitude: longEnd}\n    );\n\n    if (nextPositionCurrentPositionDiff != 0) {\n        var northPoleNextPositionDiff = pointToPointDistance(\n            {latitude: 90, longitude: 0},\n            {latitude: latEnd, longitude: longEnd}\n        );\n\n        var cosAngleCurrentPosition = (nextPositionCurrentPositionDiff * nextPositionCurrentPositionDiff +\n            northPoleCurrentPositionDiff * northPoleCurrentPositionDiff -\n            northPoleNextPositionDiff * northPoleNextPositionDiff) /\n            (2 * nextPositionCurrentPositionDiff * northPoleCurrentPositionDiff);\n\n        headingAngle = Math.abs(Math.acos(cosAngleCurrentPosition));\n    }\n\n    return headingAngle;\n}\n\nfunction pointToPointDistance(point1, point2) {\n    var lat1 = point1.latitude;\n    var lon1 = point1.longitude;\n    var lat2 = point2.latitude;\n    var lon2 = point2.longitude;\n\n    return getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2);\n}\n\nfunction getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {\n    var R = 6371; // Radius of the earth in km\n    var dLat = deg2rad(lat2 - lat1);\n    var dLon = deg2rad(lon2 - lon1);\n    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n        Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n        Math.sin(dLon / 2) * Math.sin(dLon / 2);\n\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    var d = R * c; // Distance in km\n\n    return d;\n}\n\n\nfunction projectPosition(origin, heading, distance) {\n    var coordinate = {};\n    var rtd = 180.0 / Math.PI;\n    var dtr = Math.PI / 180.0;\n    var brng = dtr * heading;\n    var lat1 = dtr * origin.latitude;\n    var lon1 = dtr * origin.longitude;\n    var kLatLonEarthRadius = 6371.0;\n\n    var lat2 = Math.asin(Math.sin(lat1) * Math.cos(distance / kLatLonEarthRadius) +\n        Math.cos(lat1) * Math.sin(distance / kLatLonEarthRadius) * Math.cos(brng));\n    var lon2 = lon1 + Math.atan2(Math.sin(brng) * Math.sin(distance / kLatLonEarthRadius) * Math.cos(lat1),\n        Math.cos(distance / kLatLonEarthRadius) - Math.sin(lat1) * Math.sin(lat2));\n    lon2 = fmod(lon2 + Math.PI, 2.0 * Math.PI) - Math.PI;\n\n    if (!isNaN(lat2) && !isNaN(lon2)) {\n        coordinate.latitude = lat2 * rtd;\n        coordinate.longitude = lon2 * rtd;\n        coordinate.altitude = 0;\n    }\n\n    return coordinate;\n}\n\nfunction fmod(a, b) {\n    return Number((a - (Math.floor(a / b) * b)).toPrecision(8));\n}\n\nexport default {\n    computeSatrec,\n    deg2rad,\n    getElevationWithPositionalData,\n    getOrbitPosition,\n    getOrbitPositionWithPositionalData,\n    headingAngleRadians,\n    projectPosition,\n    rad2deg\n};","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nimport utils from './utils/eo/utils';\nconst {\n    RenderableLayer,\n    Color,\n} = WorldWind;\n\nconst {\n    SwathCone\n} = WordWindX;\n\nconst getParams = (satName, type) => {\n\n    let translateDistance = null;\n\n    //swath width - so that the swath is the same width as the acq plan\n    let swathWidth;\n\n    //controls how big the swath is, higher values means a smaller swath\n    const swathHeight = 35;\n\n    if (satName === 's1a' || satName === 's1b') {\n        if (type === 'IW') {\n            //red\n            translateDistance = 490;\n            swathWidth = 130;\n        }\n        else if (type === 'EW') {\n            //green\n            translateDistance = 435;\n            swathWidth = 210;\n        }\n        else if (type === 'SM') {\n            //black\n            translateDistance = 308;\n            swathWidth = 41;\n        }\n        else {\n            return;\n        }\n    }\n    else if (satName === 's2a' || satName === 's2b') {\n        swathWidth = 145;\n        translateDistance = undefined;\n    }\n\n    return {\n        swathWidth,\n        swathHeight,\n        translateDistance,\n    }\n}\n\n/**\n * Class extending WorldWind.RenderableLayer. Layer can render only one model of satellite. It`s possible to set position data of model.\n * @param options {Object}\n * @param options.key {String}\n * @param options.time {String}\n * @param options.tle {String}\n * @augments WorldWind.RenderableLayer\n * @constructor\n */\nclass SwathLayer extends RenderableLayer {\n\tconstructor(options) {\n        super(options);\n        this._rerenderMap = null;\n        this.key = options.key;\n        this.satName = options.satName;\n        this.time = options.time;\n        this.Tle = options.tle;\n        this.swath = null;\n        this.type = null;\n        this.color = Color.RED;\n    };\n\n    /**\n     * @param position {Array.<lte>} Lte.\n     */\n    setTle(Tle) {\n        if(Tle) {\n            this.Tle = Tle;\n            this.update();\n        }\n    }\n\n    /**\n     * @param type {string}\n     */\n    setType(type) {\n        if(type) {\n            this.type = type;\n            this.update();\n        }\n    }\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    setTime(time) {\n        if(time) {\n            this.time = time;\n            this.update();\n        }\n    }\n\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    setVisible(visible) {\n        if(visible === true) {\n            this.visible = true;\n        } else {\n            this.visible = false;\n        }\n        this.update();\n    }\n\n    /**\n     * @param time {Date} Time of the satellite.\n     */\n    update() {\n        this.removeAllRenderables();\n        if(this.visible && this.time && this.Tle && this.type) {\n            const satRec = utils.computeSatrec(...this.Tle);\n\n            const currentPosition = utils.getOrbitPosition(satRec, this.time);\n            \n            const nextPosition = utils.getOrbitPosition(satRec, new Date(this.time.getTime() + 10000));\n            const nNextPosition = utils.getOrbitPosition(satRec, new Date(this.time.getTime() + 20000));\n            const headingRad = utils.headingAngleRadians(currentPosition.latitude, currentPosition.longitude, nextPosition.latitude, nextPosition.longitude);\n            const currentHeading = utils.rad2deg(headingRad);\n            const nextHeadingRad = utils.headingAngleRadians(nextPosition.latitude, nextPosition.longitude, nNextPosition.latitude, nNextPosition.longitude);\n            const nextHeading = utils.rad2deg(nextHeadingRad);\n\n            const {swathWidth, swathHeight, translateDistance} = getParams(this.satName, this.type);\n            if(swathWidth && swathHeight) {\n                this.swath = new SwathCone({\n                    currentPosition,\n                    nextPosition,\n                    currentHeading,\n                    nextHeading\n                }, this.color, translateDistance, swathWidth, swathHeight);\n    \n                this.addRenderable(this.swath);\n            }\n        }\n        this.doRerender();\n    }\n    \n\tsetRerender(rerenderer) {\n\t\tif(typeof rerenderer === 'function') {\n\t\t\tthis._rerenderMap = rerenderer;\n\t\t}\n\t}\n    \n\tsetColor(color) {\n        this.color = color;\n\t}\n\n\tdoRerender() {\n\t\tif(typeof this._rerenderMap === 'function') {\n\t\t\tthis._rerenderMap();\n\t\t}\n\t}\n}\n\nexport default SwathLayer;\n\n","import WorldWind from 'webworldwind-esa';\n\nconst {\n    ShapeAttributes,\n    Color,\n} = WorldWind;\n\nconst addBoundariesAltitude = (boundaries = [], altitude = 0) => {\n    return boundaries.map((bs) => {\n        if(bs && Array.isArray(bs)) {\n            return addBoundariesAltitude(bs, altitude);\n        } else {\n            return new WorldWind.Position(bs.latitude, bs.longitude, altitude);\n        }\n    })\n}\n\nexport const productBounds = (boundaries) => {\n    const polygon = new WorldWind.Polygon(addBoundariesAltitude(boundaries, 100), null);\n    polygon.altitudeMode = WorldWind.RELATIVE_TO_GROUND;\n    polygon.extrude = false; // extrude the polygon edges to the ground\n\n    const polygonAttributes = new WorldWind.ShapeAttributes(null);\n    polygonAttributes.drawInterior = false;\n    polygonAttributes.drawOutline = true;\n    polygonAttributes.outlineColor = WorldWind.Color.BLUE;\n    polygonAttributes.drawVerticals = polygon.extrude;\n    polygonAttributes.applyLighting = false;\n    polygon.attributes = polygonAttributes;\n    return polygon;\n}\n\nexport const productAttributes = () => {\n    const shapeAttributes = new ShapeAttributes(null);\n    shapeAttributes.drawOutline = true;\n    shapeAttributes.drawInterior = false;\n    shapeAttributes.outlineColor = new Color(1, 0, 0, 1);\n    shapeAttributes.outlineWidth = 1;\n    return shapeAttributes;\n}\nexport const getBoundaries = (product) => {\n    return product && product.boundaries;\n}","import WorldWind from 'webworldwind-esa';\nconst {\n        WmsCapabilities,\n        WmsLayer\n    } = WorldWind;\n\n\nconst getLayerFromCapabilitiesUrl = async (url, layerName) => {\n    //get capabilities\n    try{\n        const capabilities = await fetch(url).then(res => res.text());\n        const wmsCapabilities = parseCapabilities(capabilities);\n        const wmsLayerCapabilities = wmsCapabilities.getNamedLayer(layerName);\n        const wmsConfig = WmsLayer.formLayerConfiguration(wmsLayerCapabilities);\n        return wmsConfig;\n    } catch (e) {\n        console.log('Failed getting WMS capabilities', e);\n    }\n}\n\nconst parseCapabilities = (xml) => {\n    const xmlDom = new DOMParser().parseFromString(xml, 'text/xml');\n    const wmsCapabilities = new WmsCapabilities(xmlDom);\n    return wmsCapabilities;\n}\n\nexport default {\n    getLayerFromCapabilitiesUrl,\n    parseCapabilities\n}","const modelsCache = new Map();\n\nexport const getModel = (path, key) => {\n\tconst loader = new Promise((resolve,reject) => {\n\t\tconst cached = modelsCache.has(key);\n\t\tif(cached) {\n\t\t\tresolve(modelsCache.get(key))\n\t\t} else {\n\t\t\tfetch(path).then(response => {\n\t\t\t\treturn response.json();\n\t\t\t}).then((model) => {\n\t\t\t\tmodel.key = key;\n\t\t\t\tresolve(model);\n\t\t\t});\n\t\t}\n\t});\n\treturn loader;\n}","export default class QuickLook {\r\n    constructor(iconUrl, fetch) {\r\n        this._icon = iconUrl;\r\n        this._fetch = fetch;\r\n\r\n        this._image = null;\r\n    }\r\n\r\n    /**\r\n     * Loads icon for the specific QuickLook in the form of image. Once the image was loaded, it is cached.\r\n     * @returns {Promise<Image>}\r\n     */\r\n    async icon() {\r\n        if(this._image) {\r\n            return this._image;\r\n        }\r\n        try {\r\n            // The request needs to be authorized\r\n            const response = await this._fetch(this._icon, {\r\n                headers: {\r\n                    \"Accept\": \"blob\",\r\n                }\r\n            });\r\n            if(!response.ok) {\r\n                throw new Error('ERROR QuickLook#icon Status: ' + response.status);\r\n            }\r\n            const blobData = await response.blob();\r\n            const url = window.URL.createObjectURL(blobData);\r\n            const image = await this.createImage(url);\r\n            window.URL.revokeObjectURL(url);\r\n    \r\n            this._image = image;\r\n            return image;    \r\n        } catch (err) {\r\n            throw new Error('ERROR QuickLook#icon Status: ' + err.message);\r\n        }\r\n    }\r\n\r\n    async createImage(url) {\r\n        return new Promise((resolve, reject) => {\r\n            const imageOfQuickLook = new Image();\r\n            imageOfQuickLook.addEventListener('load', () => {\r\n                resolve(imageOfQuickLook);\r\n            }, false);\r\n            imageOfQuickLook.src = url;\r\n        });\r\n    }\r\n}","import QuickLook from \"./QuickLook\";\r\nimport WorldWind from 'webworldwind-esa';\r\nimport TexturedSurfacePolygon from '../textured/TexturedSurfacePolygon';\r\n\r\nconst {\r\n    Color,\r\n    ShapeAttributes,\r\n    Wkt\r\n} = WorldWind;\r\n\r\nexport default class Product {\r\n    constructor(fetch, entry) {\r\n        if(!entry || !entry.id || !fetch) {\r\n            throw new Error(`Product#constructor Provided entry is either null or invalid. Entry ${entry}`);\r\n        }\r\n\r\n        this._id = entry.id;\r\n        this._entry = entry;\r\n\r\n        // Renderable related information\r\n        this._footprint = entry.str && entry.str.footprint && entry.str.footprint || null;\r\n        const icons = entry.link && entry.link.length > 0 &&\r\n            entry.link.filter(link => link.rel && link.rel === 'icon') || [];\r\n        const iconUrl = icons.length > 0 && icons[0].href || null;\r\n        if(iconUrl) {\r\n            this._icon = new QuickLook(iconUrl, fetch);\r\n        } else {\r\n            this._icon = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Unique identifier of the specific product\r\n     * @returns {String} UUID of the given product\r\n     */\r\n    id() {\r\n        return this._id;\r\n    }\r\n\r\n    /**\r\n     * The whole entry related to this product.\r\n     * @returns {Object} Entry representing the product.\r\n     */\r\n    metadata() {\r\n        return this._entry;\r\n    }\r\n\r\n    /**\r\n     * Renderable for displaying this Product including QuickLook or null, if this wouldn't make any sense.\r\n     * It doesn't make sense when no footprint is provided.\r\n     * @returns {Promise<Renderable>}\r\n     */\r\n    async renderable() {\r\n        if(!this._footprint) {\r\n            return Promise.resolve(null);\r\n        }\r\n\r\n        let boundaries = [];\r\n        new Wkt(this._footprint).load((wkt, objects) => {\r\n            objects.forEach(object => {\r\n                object.shapes().forEach(shape => {\r\n                    boundaries = shape._boundaries;\r\n                });\r\n            });\r\n        });\r\n        const renderable = new TexturedSurfacePolygon(boundaries, this.footprintAttributes());\r\n        if(this._icon) {\r\n            try {\r\n                renderable.image = await this._icon.icon();\r\n            } catch (e) {\r\n                console.log('ERROR: Product#renderable ', e);\r\n                renderable.error = e;\r\n            }\r\n        }\r\n        return renderable;\r\n    }\r\n\r\n    /**\r\n     * The default attributes to be used for the Footprint.\r\n     * @return {ShapeAttributes} Attributes for the footprint shapes\r\n     */\r\n    footprintAttributes() {\r\n        const shapeAttributes = new ShapeAttributes(null);\r\n        shapeAttributes.drawOutline = true;\r\n        shapeAttributes.drawInterior = true;\r\n        shapeAttributes.outlineColor = new Color(1, 0, 0, .5);\r\n        shapeAttributes.outlineWidth = 4;\r\n        return shapeAttributes;\r\n    }\r\n}","export default class Query {\r\n    /**\r\n     * Representation of the query for the SciHub.\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @param startIndex {Number} Index of the first returned results\r\n     */\r\n    constructor({shortName, products = [], location, beginTime, endTime, startIndex} = {}) {\r\n        this._shortName = shortName;\r\n        this._products = products;\r\n        this._location = location;\r\n        this._beginTime = beginTime;\r\n        this._endTime = endTime;\r\n        this._startIndex = startIndex;\r\n    }\r\n\r\n    /**\r\n     * URL representation of the query for the SciHub.\r\n     * @returns {string} query part of the URL for the SciHub request.\r\n     */\r\n    url() {\r\n        let toSerialize = [];\r\n\r\n        if(this._location){\r\n            toSerialize.push(serializeLocation(this._location));\r\n        }\r\n        if(this._beginTime && this._endTime) {\r\n            toSerialize.push(serializeTime(this._beginTime, this._endTime));\r\n        }\r\n\r\n        const platformNameQuery = '(filename:(' + serializeFileName(this._shortName) + '))';\r\n        const productsQuery = serializeProductType(this._products);\r\n        toSerialize.push(platformNameQuery, productsQuery);\r\n        const queryValue = toSerialize.join('AND');\r\n\r\n        return `?q=${encodeURIComponent(queryValue)}&rows=100&start=${this._startIndex}&orderby=${encodeURIComponent('beginposition desc')}`;\r\n    }\r\n}\r\n\r\nconst serializeProductType = (products) => {\r\n    const productsString = products.join(' OR ');\r\n    return '(producttype:(' + productsString + '))';\r\n};\r\n\r\nconst serializeLocation = ({latitude, longitude}) => {\r\n    return '(footprint:\"intersects(' + latitude + ', ' + longitude + ')\")';\r\n};\r\n\r\nconst serializeFileName = (shortSatName) => {\r\n    if (shortSatName === 'S-1A') {\r\n        return 'S1A_*';\r\n    }\r\n    if (shortSatName === 'S-2A') {\r\n        return 'S2A_*';\r\n    }\r\n    if (shortSatName === 'S-3A') {\r\n        return 'S3A_*';\r\n    }\r\n    if (shortSatName === 'S-1B') {\r\n        return 'S1B_*';\r\n    }\r\n    if (shortSatName === 'S-2B') {\r\n        return 'S2B_*';\r\n    }\r\n    if (shortSatName === 'S-5P') {\r\n        return '';\r\n    }\r\n    if (shortSatName === 'S-3B') {\r\n        return 'S3B_*';\r\n    }\r\n};\r\n\r\nconst serializeTime = (startTime, endTime) => {\r\n    return `(beginposition: [${startTime.toISOString()} TO ${endTime.toISOString()}])`;\r\n};","import moment from 'moment';\r\nimport Product from './Product';\r\nimport Query from './Query';\r\nimport {xml2js} from 'xml-js';\r\n\r\nconst getProductsInTime = (products, startDate, endDate) => {\r\n    const startDateMoment = moment.utc(startDate);\r\n    const endDateMoment = moment.utc(endDate);\r\n\r\n    return products.filter((product) => {\r\n        const metadata = product.metadata();\r\n        const beginpositionDate = metadata.date.find((d) => {\r\n            return d._attributes.name === 'beginposition'\r\n        })\r\n        const beginposition = beginpositionDate && beginpositionDate._text && moment.utc(beginpositionDate._text)\r\n\r\n        const endpositionDate = metadata.date.find((d) => {\r\n            return d._attributes.name === 'endposition'\r\n        })\r\n        const endposition = endpositionDate && endpositionDate._text && moment.utc(endpositionDate._text)\r\n\r\n        return beginposition.isBetween(startDateMoment, endDateMoment) || endposition.isBetween(startDateMoment, endDateMoment)\r\n    });\r\n}\r\n\r\nconst getCacheID = (shortName, products, location, hour) => {\r\n    return `${shortName}-${products}-${location}-${hour}`;\r\n}\r\n\r\nexport const parseEntry = (entry) => {\r\n    if(entry && entry.id) {\r\n        const parsedEntry = {\r\n            title:{...entry.title},\r\n            link:[...entry.link],\r\n            id:{...entry.id},\r\n            summary:{...entry.summary},\r\n            date:[...entry.date],\r\n        };\r\n\r\n        parsedEntry.id = entry.id._text;\r\n\r\n        const str = {};\r\n        entry.str.forEach(element => {\r\n            const name = element._attributes.name;\r\n            str[name] = element._text;\r\n        });\r\n        parsedEntry.str = str;\r\n\r\n        parsedEntry.link = entry.link.map(element => {\r\n            return {\r\n                rel: element._attributes.rel,\r\n                href: element._attributes.href\r\n            };\r\n        });\r\n        return parsedEntry;\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default class Products {\r\n    /**\r\n     * Products represents collection of the products from different satellites. The Query is focused on the SciHub.\r\n     * @param cache {Map} Cache to be used for storing the retrieved products.\r\n     * @param fetch {Function} Function with provided defaults for making requests.\r\n     * @param baseUrl {String} Optional. Optional URL for the retrieval of the products. Default is SciHub\r\n     */\r\n    constructor(cache, searchCache, fetch, baseUrl = 'https://scihub.copernicus.eu/apihub/search') {\r\n        this._baseUrl = baseUrl;\r\n        this._cache = cache;\r\n        this._searchCache = searchCache;\r\n\r\n        this._fetch = fetch;\r\n    }\r\n\r\n    parseSearchResults(hours, beginTime, endTime) {\r\n        let filteredProducts = [];\r\n        for(const [key, value] of hours.entries()) {\r\n            const processed = this.processProducts(value);\r\n            filteredProducts = [...filteredProducts, ...processed];\r\n        };\r\n        return getProductsInTime(filteredProducts, beginTime, endTime)\r\n    }\r\n\r\n    loadSearch(hours, shortName, products, location) {\r\n        // load unloaded hour\r\n        for(const [hour, search] of hours.entries()) {\r\n            if(!search) {\r\n                const hourLoader = this.loadSearchByHour(shortName, products, location, hour);\r\n                hours.set(hour, hourLoader);\r\n            }\r\n        };\r\n\r\n        //wait until all hours loads\r\n        const promises = []\r\n        for(const [hour, search] of hours.entries()) { \r\n            const isPromise = typeof search.then === 'function';\r\n            if(isPromise) {\r\n                promises.push(search);\r\n            }\r\n        };\r\n\r\n        return Promise.all(promises).then(searchResults => {\r\n            for (const result of searchResults) {\r\n                this._searchCache.set(getCacheID(shortName, products, location, result.hour), result.search);\r\n                hours.set(result.hour, result.search);\r\n            }\r\n            return searchResults;\r\n        });\r\n    }\r\n\r\n    getChachedSearch(hours, shortName, products, location) {\r\n        // get hours from cache\r\n        for(const hour of hours.keys()) {\r\n            hours.set(hour, this._searchCache.get(getCacheID(shortName, products, location, hour)));\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Retrieve the product information from the SciHub. The process has two parts.\r\n     *   The first part is retrieving the products available for given combination of the parameters.\r\n     *   The second part is to retrieve the actual quicklooks for all the products not already stored in cache.\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @returns {Promise<Product[]>} Product for further use.\r\n     */\r\n    async products({shortName, products = [], location, beginTime, endTime} = {}) {\r\n        const momentBeginTime = moment.utc(beginTime).startOf('hour');\r\n        const momentEndTime = moment.utc(endTime).endOf('hour');\r\n        const diff = momentEndTime.diff(momentBeginTime);\r\n        const duration = moment.duration(diff);\r\n        const durationInHours = Math.ceil(duration.asHours());\r\n\r\n        const hours = new window.Map();\r\n        for (let i = 0; i < durationInHours; i++) {\r\n            const time = moment.utc(momentBeginTime).add(i, 'hour');\r\n            hours.set(time.format('YYYY-MM-DD-HH'));\r\n        }\r\n\r\n        this.getChachedSearch(hours, shortName, products, location);\r\n\r\n        return this.loadSearch(hours, shortName, products, location).then((results) => {\r\n            const hoursString = [...hours.keys()].sort();\r\n            const firstHour = hoursString[0];\r\n            const lastHour = hoursString[hoursString.length - 1];\r\n            const beforeFirstHour = moment.utc(firstHour, 'YYYY-MM-DD-HH').subtract(1, 'hour').startOf('hour').format('YYYY-MM-DD-HH');\r\n            const afterLastHour = moment.utc(lastHour, 'YYYY-MM-DD-HH').add(1, 'hour').startOf('hour').format('YYYY-MM-DD-HH');\r\n\r\n            const marginHours = new window.Map();\r\n            marginHours.set(beforeFirstHour);\r\n            marginHours.set(afterLastHour);\r\n\r\n            this.getChachedSearch(marginHours, shortName, products, location);\r\n            this.loadSearch(marginHours, shortName, products, location)\r\n            return this.parseSearchResults(hours, beginTime, endTime)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Retrieve the product information from the SciHub. The process has two parts.\r\n     *   The first part is retrieving the products available for given combination of the parameters.\r\n     *   The second part is to retrieve the actual quicklooks for all the products not already stored in cache.\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @returns {Promise<Product[]>} Product for further use.\r\n     */\r\n    async loadSearchByHour(shortName, products, location, hour) {\r\n        const beginTime = moment.utc(hour, 'YYYY-MM-DD-HH').startOf('hour');\r\n        const endTime = moment.utc(hour, 'YYYY-MM-DD-HH').endOf('hour');\r\n        const resultsPerPage = 100;\r\n        let startIndex = 0;\r\n        let currentPage;\r\n        do {\r\n            currentPage = await this.load({shortName, products, location, beginTime: beginTime.toDate(), endTime: endTime.toDate(), startIndex});\r\n            startIndex += resultsPerPage;\r\n\r\n            // const processed = this.processProducts(currentPage);\r\n            // filteredProducts.push.apply(filteredProducts, processed);\r\n        } while(currentPage.next);\r\n\r\n        return {\r\n            hour,\r\n            search: currentPage\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Retrieve the product information from the SciHub. The process has two parts.\r\n     *   The first part is retrieving the products available for given combination of the parameters.\r\n     *   The second part is to retrieve the actual quicklooks for all the products not already stored in cache.\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @returns {Promise<Object>}\r\n     *   errors contains array of errors happening during creation of the renderables.\r\n     *   total represents the total amount of products\r\n     *   renderables the renderables tobe displayed\r\n     */\r\n    async renderables({shortName, products = [], location, beginTime, endTime} = {}) {\r\n        const productsLocal = await this.products({shortName, products, location, beginTime, endTime});\r\n        const renderables = [];\r\n        const errors = [];\r\n        for(let productIndex = 0; productIndex < productsLocal.length; productIndex++) {\r\n            try {\r\n                const renderable = await productsLocal[productIndex].renderable();\r\n                if(renderable.error) {\r\n                    errors.push(renderable.error);\r\n                }\r\n                renderables.push(renderable);\r\n            } catch(e) {\r\n                console.log('Products#renderables', e);\r\n                errors.push(e);\r\n            }\r\n        }\r\n        return {\r\n            errors: errors,\r\n            renderables: renderables,\r\n            total: productsLocal.length\r\n        };\r\n    }\r\n\r\n    /**\r\n     * From the entries received from Sci Hub creates relevant products with all necessary information for further\r\n     * processing and visualization.\r\n     * @private\r\n     * @param feed {Object} Atom feed with the information about the products.\r\n     * @returns {Array<Product>} Valid products\r\n     */\r\n    processProducts(feed) {\r\n        if(feed.entry && feed.entry.length > 0) {\r\n            return feed.entry.map(entry => {\r\n                const parsedEntry = parseEntry(entry);\r\n                if(parsedEntry && parsedEntry.id) {\r\n                    const id = parsedEntry.id;\r\n                    const cached = this._cache.get(id);\r\n                    if(!cached) {\r\n                        const product = new Product(this._fetch, parsedEntry);\r\n                        this._cache.set(product.id(), product);\r\n                        return product;\r\n                    } else {\r\n                        return cached;\r\n                    }\r\n                } else {\r\n                    return null;\r\n                }\r\n            }).filter(product => product);\r\n        } else {\r\n            return [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load feed with the products from the remote source.\r\n     * @private\r\n     * @param shortName {String} Short name of the satellite for which to query the data.\r\n     * @param products {String[]} Array of the products to query for.\r\n     * @param location {Object} Latitude, Longitude of specific point.\r\n     * @param beginTime {Date} From when we want the data\r\n     * @param endTime {Date} Until when we want the data\r\n     * @param startIndex {Number} The index of the first result to query for.\r\n     * @returns {Promise<Object>} Feed from the response.\r\n     */\r\n    async load({shortName, products = [], location, beginTime, endTime, startIndex} = {}) {\r\n        //tady seskládat \r\n        const query = new Query({shortName, products, location, beginTime, endTime, startIndex});\r\n        const url = this._baseUrl + query.url();\r\n        const cached = this._cache.get(url);\r\n        if(cached) {\r\n            return JSON.parse(cached);\r\n        }\r\n\r\n        try {\r\n            const response = await this._fetch(url, {\r\n                headers: {\r\n                    'Accept': 'application/json'\r\n                }\r\n            });\r\n\r\n            const atomFeed = await response.text();\r\n\r\n            \r\n            const root = xml2js(atomFeed, {compact: true});\r\n            const feed = root.feed;\r\n            if(feed.entry && typeof feed.entry.length === 'undefined') {\r\n                feed.entry = [feed.entry];\r\n            }\r\n\r\n            // Here it is necessary to decide whether there are more results.\r\n            const totalResults = Number(feed['opensearch:totalResults']._text);\r\n            const itemsPerPage = Number(feed['opensearch:itemsPerPage']._text);\r\n\r\n            feed.next = (startIndex + itemsPerPage) < totalResults;\r\n            this._cache.set(url, JSON.stringify(feed));\r\n            return feed;\r\n        } catch (error) {\r\n            throw (new Error('Error in loading products list'));\r\n        }\r\n    }\r\n}","import WorldWind from 'webworldwind-esa';\nimport WordWindX from 'webworldwind-x';\nimport createCachedSelector from 're-reselect';\nimport './style.css';\nimport SatelliteModelLayer from './SatelliteModelLayer';\nimport OrbitLayer from './OrbitLayer';\nimport SentinelCloudlessLayer from './SentinelCloudlessLayer';\nimport SentinelTopologyLayer from './SentinelTopologyLayer';\nimport AcquisitionPlanLayer from './AcquisitionPlanLayer';\nimport SwathLayer from './SwathLayer';\nimport {getPlansKeys} from '../../utils/acquisitionPlans';\nimport wmsLayerUtils from './utils/wmsLayer';\nimport {getBoundaries, productBounds} from '../../utils/product';\nimport {getModel} from './satellitesModels';\nimport SciHubProducts from '../../worldwind/products/Products';\nimport {hubPassword, hubUsername} from \"../../config\";\n\nconst {\n    StarFieldLayer,\n    EoUtils,\n} = WordWindX;\n\nconst {\n    RenderableLayer,\n    SurfacePolygon,\n    AtmosphereLayer,\n} = WorldWind;\n\nconst {getLayerFromCapabilitiesUrl} = wmsLayerUtils;\nconst csiRenderablesCache = new window.Map();\nconst searchCache = new window.Map();\nconst layersCache = new window.Map();\nconst productsScihub = new SciHubProducts(csiRenderablesCache, searchCache, fetchWithCredentials);\nconst defaultBackgroundLayer = new SentinelCloudlessLayer();\nconst defaultStarfieldLayer = new StarFieldLayer();\nconst defaultAtmosphereLayer = new AtmosphereLayer('./images/dnb_land_ocean_ice_2012.png');\nconst productsRequests = new window.Map();\nconst defaultTopologyLayer = new SentinelTopologyLayer();\n\nexport function getLayerKeyFromConfig (layerConfig) {\n    return `${layerConfig.satKey}-${layerConfig.layerKey}`;   \n}\n\nexport function getLayerKeySCIHubResult (layerConfig) {\n    return `${layerConfig.id._text}`;\n}\n\nexport function getLayerIdFromConfig (layerConfig) {\n    if(layerConfig.satKey && layerConfig.layerKey && layerConfig.beginTime && layerConfig.endTime) {\n        return `${layerConfig.satKey}-${layerConfig.layerKey}-${layerConfig.beginTime.toString()}-${layerConfig.endTime.toString()}`;   \n    } else {\n        return layerConfig.key;\n    }\n}\n\nexport function getProductByKey (productKey) {\n    return csiRenderablesCache.get(productKey);\n}\n\nconst filterOrbitLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'orbit');\n}\n\nconst filterAcquisitionPlanLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'acquisitionPlan');\n}\n\nconst filterSatelliteLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'satellite');\n}\n\nconst filterSentinelDataLayersConfigs = (layersConfig) => {\n    return layersConfig.filter(l => l.type === 'sentinelData');\n}\n\nexport function getLayerByName (name, layers) {\n    return layers.find(l => l.displayName === name);\n}\n\nfunction fetchWithCredentials (url, options = {}) {\n    if (!options.headers) {\n        options.headers = {};\n    }\n    options.headers.Authorization = `Basic ${window.btoa(`${hubUsername}:${hubPassword}`)}`;\n\n    const fetch = window.fetch(url, options);\n    return fetch;\n};\n\nconst getSentinelLayer = (layerConfig) => {\n    const layerKey = getLayerKeyFromConfig(layerConfig);\n    const cacheLayer = layersCache.get(layerKey);\n    if(cacheLayer) {\n        return cacheLayer;\n    } else {\n        const layer = new RenderableLayer(layerKey);\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getFootprintLayer = (layerConfig) => {\n    const layerKey = getLayerKeySCIHubResult(layerConfig);\n    const cacheLayer = layersCache.get(layerKey);\n    \n    if(cacheLayer) {\n        return cacheLayer;\n    } else {\n        const layer = new RenderableLayer(layerKey);\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getOrbitLayer = (layerConfig, time = new Date(), wwd, currentTime) => {\n    const layerKey = layerConfig.key;\n    const cacheLayer = layersCache.get(layerKey);\n\n    //set specs\n\n    if(cacheLayer) {\n        if(time.toString() !== cacheLayer.selectTime.toString() || currentTime.toString() !== cacheLayer.currentTime.toString()) {\n            cacheLayer.setTime(new Date(currentTime), new Date(time));\n        }\n\n        if(layerConfig.specs[0] !== (cacheLayer.satRec && cacheLayer.satRec[0]) || layerConfig.specs[1] !== (cacheLayer.satRec && cacheLayer.satRec[1])) {\n            cacheLayer.setSatRec(layerConfig.specs);\n        }\n\n        return cacheLayer;\n    } else {\n        const layer = new OrbitLayer({key: layerKey, satRec: layerConfig.specs, time, currentTime});\n        layer.setRerender(() => wwd.redraw());\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getAcquisitionPlanLayer = (layerConfig, wwd, time, onLayerChanged) => {\n    const layerKey = layerConfig.key;\n    const cacheLayer = layersCache.get(layerKey);\n    const plans = layerConfig.plans;\n\n    if(cacheLayer) {\n        const plansKeys = getPlansKeys(plans);\n        const cacheLayerPlansKeys = getPlansKeys(cacheLayer.plans);\n        \n        if(plansKeys !== cacheLayerPlansKeys) {\n            cacheLayer.setPlans(plans);\n        }\n\n        if(time.getTime() !== cacheLayer.time.getTime()) {\n            cacheLayer.setTime(time);\n        }\n        return cacheLayer;\n    } else {\n        const layer = new AcquisitionPlanLayer({key: layerKey, satName: layerConfig.satName, time: time, onLayerChanged, range: layerConfig.range});\n        layer.setPlans(plans);\n        layer.setRerender(() => wwd.redraw());\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getSwathLayer = (layerConfig, wwd, time) => {\n    const layerKey = `swath_${layerConfig.key}`;\n    const layerAcquisitionKey = layerConfig.key;\n    const cacheLayer = layersCache.get(layerKey);\n    const cacheLayerAcquisition = layersCache.get(layerAcquisitionKey);\n    // const plans = layerConfig.plans;\n\n    if(cacheLayer) {\n        //if changed TLE in config\n        if((layerConfig.tle && layerConfig.tle[0]) !== (cacheLayer.Tle && cacheLayer.Tle[0]) || (layerConfig.tle && layerConfig.tle[1]) !== (cacheLayer.Tle && cacheLayer.Tle[1])) {\n            cacheLayer.setTle(layerConfig.tle);\n        }\n\n        if(time.toString() !== cacheLayer.time.toString()) {\n            cacheLayer.setTime(time);\n            const swath = cacheLayerAcquisition.getFootprints(0);\n            swath.then(data => {\n                //FIXME - remove\n                // console.log(data && data.outlines);\n                if(data && data.outlines && data.outlines.length > 0) {\n                    const color = data.interiors[0].attributes.interiorColor;\n                    const type = data.interiors[0].kmlProps.Mode;\n                    cacheLayer.setType(type);\n                    cacheLayer.setColor(color);\n                    cacheLayer.setVisible(true);\n                } else {\n                    cacheLayer.setVisible(false);\n                }\n            })\n        }\n\n        return cacheLayer;\n    } else {\n        const layer = new SwathLayer({key: layerKey, satName: layerConfig.satName, time: time, tle: layerConfig.tle});\n        layer.setRerender(() => wwd.redraw());\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nconst getSatelliteLayer = (layerConfig, time, wwd) => {\n    const layerKey = layerConfig.key;\n    const cacheLayer = layersCache.get(layerKey);\n    if(cacheLayer) {\n        //upadte time on change\n        if(time.toString() !== cacheLayer.time.toString()) {\n            cacheLayer.setTime(time);\n        }\n\n        //if changed TLE in config\n        if((layerConfig.tle && layerConfig.tle[0]) !== (cacheLayer.Tle && cacheLayer.Tle[0]) || (layerConfig.tle && layerConfig.tle[1]) !== (cacheLayer.Tle && cacheLayer.Tle[1])) {\n            cacheLayer.setTle(layerConfig.tle);\n        }\n\n        return cacheLayer;\n    } else {\n        const options = {\n            rotations: layerConfig.satData.rotations,\n            preRotations: layerConfig.satData.preRotations,\n            scale: layerConfig.satData.scale,\n            translations: layerConfig.satData.translations,\n            ignoreLocalTransforms: layerConfig.satData.ignoreLocalTransforms,\n        }\n        const layer = new SatelliteModelLayer({key: layerKey, time: time}, options);\n        layer.setRerender(() => wwd.redraw());\n        getModel(`${layerConfig.satData.filePath}${layerConfig.satData.fileName}`, layerKey).then(\n            (model) => {\n                const satrec = EoUtils.computeSatrec(layerConfig.satData.tleLineOne, layerConfig.satData.tleLineTwo);\n                const position = EoUtils.getOrbitPosition(satrec, new Date(time));\n                layer.setModel(model, options, position)\n                layer.setTle([layerConfig.satData.tleLineOne, layerConfig.satData.tleLineTwo]);\n            }\n        );\n        layersCache.set(layerKey, layer);\n        return layer;\n    }\n}\n\nexport const getLayers = createCachedSelector([\n    (layersConfig) => layersConfig,\n    (layersConfig, time) => time,\n    (layersConfig, time, wwd) => wwd,\n    (layersConfig, time, wwd, onLayerChanged) => onLayerChanged,\n    (layersConfig, time, wwd, onLayerChanged, currentTime) => currentTime,\n    (layersConfig, time, wwd, onLayerChanged, currentTime, searchResult) => searchResult,\n], (layersConfig, time, wwd, onLayerChanged, currentTime, searchResult) => {\n    defaultStarfieldLayer.time = time;\n    defaultAtmosphereLayer.time = time;\n    const layers = [\n        defaultStarfieldLayer,\n        defaultBackgroundLayer,\n        defaultAtmosphereLayer,\n        defaultTopologyLayer\n    ];\n\n    const sentinelDataLayersConfigs = filterSentinelDataLayersConfigs(layersConfig);\n    const sentinelLayers = sentinelDataLayersConfigs.map(getSentinelLayer);\n    \n    const orbitLayersConfigs = filterOrbitLayersConfigs(layersConfig);\n    const orbitLayers = orbitLayersConfigs.map((o) => getOrbitLayer(o, time, wwd, currentTime));\n    const satellitesLayersConfigs = filterSatelliteLayersConfigs(layersConfig);\n    const satelliteLayers = satellitesLayersConfigs.map((s) => getSatelliteLayer(s, time, wwd));\n    const acquisitionPlanLayersConfigs = filterAcquisitionPlanLayersConfigs(layersConfig);\n    const acquisitionPlanLayers = acquisitionPlanLayersConfigs.map((s) => getAcquisitionPlanLayer(s, wwd, time, onLayerChanged));\n    const swathLayers = acquisitionPlanLayersConfigs.map((s) => getSwathLayer(s, wwd, time));\n    const searchLayer = searchResult ? [getFootprintLayer(searchResult)] : [];\n    return [...searchLayer, ...layers, ...sentinelLayers, ...orbitLayers, ...satelliteLayers, ...acquisitionPlanLayers, ...swathLayers];\n})((layersConfig, time, wwd, onLayerChanged, currentTime, searchResult) => {\n    const stringTime = time ? time.toString() : '';\n    const stringCurrentTime = currentTime ? currentTime.toString() : '';\n    const sentinelDataLayersConfigs = filterSentinelDataLayersConfigs(layersConfig);\n    const orbitLayersConfigs = filterOrbitLayersConfigs(layersConfig);\n    const satellitesLayersConfigs = filterSatelliteLayersConfigs(layersConfig);\n\n    const acquisitionPlanLayers = filterAcquisitionPlanLayersConfigs(layersConfig);\n\n    const orbitKeys = orbitLayersConfigs.map(l => l.key).join(',');\n    const satellitesKeys = satellitesLayersConfigs.map(l => l.key).join(',');\n    const activeLayersKeys = sentinelDataLayersConfigs.map((layerConfig) => `${getLayerKeyFromConfig(layerConfig)}-${layerConfig.beginTime.toString()}-${layerConfig.endTime.toString()}`).join(',');\n    const acquisitionPlanLayersKeys = acquisitionPlanLayers.map((aps) => `${aps.key}_${getPlansKeys(aps.plans)}`);\n    const searchLayerKey = searchResult  ? getLayerKeySCIHubResult(searchResult) : '';\n    const cacheKey = `${searchLayerKey}-${stringTime}-${stringCurrentTime}-${satellitesKeys}-${orbitKeys}-${activeLayersKeys}-${acquisitionPlanLayersKeys}`;\n    return cacheKey;\n});\n\nconst getSciProducts = async (layerConfig) => {\n    try {\n        let beginTime = layerConfig.beginTime;\n        let endTime = layerConfig.endTime;\n\n        const productsLocal = productsScihub.products({\n            shortName: layerConfig.satData.shortName,\n            products: [layerConfig.layerKey],\n            beginTime: beginTime,\n            endTime: endTime\n        });\n        return await productsLocal;\n    } catch {\n        console.error('Can not get products.')\n    }\n}\n\nexport const setRenderablesFromConfig = async (layer, layerConfig, redrawCallback, onLayerChanged, cancelled) => {\n    let rejected = false;\n    cancelled.catch(() => {\n        rejected = true;\n    })\n    //return promise\n    const msg = {\n        status: 'ok',\n        loadedCount: null,\n        totalCount: null,\n    }\n    const requests = [];\n    const status = 'loading';\n    let loadedCount = 0;\n    let errors = [];\n    let totalCount = 0;\n    redrawCallback();\n    // const changedLayer = {\n    //     satKey: layerConfig.satKey,\n    //     layerKey: layerConfig.layerKey\n    // }\n    // onLayerChanged(changedLayer, {status, loadedCount, totalCount})\n\n    const products = productsScihub.processProducts({entry: layerConfig.results})\n\n    // const products = await getSciProducts(layerConfig);\n    totalCount = products.length;\n    if(rejected) {\n        return\n    }\n\n    const productsIDs = products.map(p => p.id());\n\n    const renderablesToRemove = [];\n    const renderedRenderables = [];\n    layer.renderables.forEach((r => {\n        const id = r && r.userProperties && r.userProperties.key;\n        renderedRenderables.push(id);\n        if(!productsIDs.includes(id)) {\n            renderablesToRemove.push(r) ;\n        }\n    }))\n\n    //remove renderables\n    renderablesToRemove.forEach(r => layer.removeRenderable(r));\n\n    //identify new renderables\n    const newRenderables = products.filter((p) => {\n        const productID = p.id();\n        return !renderedRenderables.includes(productID);\n    })\n\n    loadedCount = layer.renderables.length;\n\n    for(let productIndex = 0; productIndex < newRenderables.length; productIndex++) {\n        const key = newRenderables[productIndex].id();\n        const request = newRenderables[productIndex].renderable().then((result) => {\n            \n            \n            if(rejected) {\n                return\n            }\n            const boundaries = getBoundaries(result);\n\n            let uncompleateBoundaries = false;\n            if(boundaries && boundaries.length > 0 && boundaries[0].length < 4) {\n                uncompleateBoundaries = true;\n            }\n            const error = result.error instanceof Error;\n\n            if(!error && !uncompleateBoundaries) {\n                loadedCount++;\n                result['userProperties'] = {\n                    key\n                }\n                layer.addRenderable(result);\n                redrawCallback();\n                // onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n            } else {\n                //Add also not loaded footprints\n                loadedCount++;\n                const polygon = productBounds(boundaries);\n                polygon['userProperties'] = {\n                    key\n                }\n\n\n                layer.addRenderable(polygon);\n\n                errors.push(error);\n                redrawCallback();\n                // onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n\n            }\n        }, (err) => {\n            // debugger\n        });\n        requests.push(request);\n    }\n\n    await Promise.all(requests.map(p => p.catch(e => e)));\n    // onLayerChanged(changedLayer, {status: 'ok', loadedCount, totalCount});\n\n    return msg;\n}\n\nexport const setRenderables = async (layer, layerConfig, redrawCallback, onLayerChanged, cancelled) => {\n    let rejected = false;\n    cancelled.catch(() => {\n        rejected = true;\n    })\n    //return promise\n    const msg = {\n        status: 'ok',\n        loadedCount: null,\n        totalCount: null,\n    }\n    const requests = [];\n    const status = 'loading';\n    let loadedCount = 0;\n    let errors = [];\n    let totalCount = 0;\n    redrawCallback();\n    const changedLayer = {\n        satKey: layerConfig.satKey,\n        layerKey: layerConfig.layerKey\n    }\n    onLayerChanged(changedLayer, {status, loadedCount, totalCount})\n\n    const products = await getSciProducts(layerConfig);\n    totalCount = products.length;\n    if(rejected) {\n        return\n    }\n\n    const productsIDs = products.map(p => p.id());\n\n    const renderablesToRemove = [];\n    const renderedRenderables = [];\n    layer.renderables.forEach((r => {\n        const id = r && r.userProperties && r.userProperties.key;\n        renderedRenderables.push(id);\n        if(!productsIDs.includes(id)) {\n            renderablesToRemove.push(r) ;\n        }\n    }))\n\n    //remove renderables\n    renderablesToRemove.forEach(r => layer.removeRenderable(r));\n\n    //identify new renderables\n    const newRenderables = products.filter((p) => {\n        const productID = p.id();\n        return !renderedRenderables.includes(productID);\n    })\n\n    loadedCount = layer.renderables.length;\n\n    for(let productIndex = 0; productIndex < newRenderables.length; productIndex++) {\n        const key = newRenderables[productIndex].id();\n        const request = newRenderables[productIndex].renderable().then((result) => {\n            \n            \n            if(rejected) {\n                return\n            }\n            const boundaries = getBoundaries(result);\n\n            let uncompleateBoundaries = false;\n            if(boundaries && boundaries.length > 0 && boundaries[0].length < 4) {\n                uncompleateBoundaries = true;\n            }\n            const error = result.error instanceof Error;\n\n            if(!error && !uncompleateBoundaries) {\n                loadedCount++;\n                result['userProperties'] = {\n                    key\n                }\n\n                layer.addRenderable(result);\n                redrawCallback();\n                onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n            } else {\n                //Add also not loaded footprints\n                loadedCount++;\n                const polygon = productBounds(boundaries);\n                polygon['userProperties'] = {\n                    key\n                }\n\n\n                layer.addRenderable(polygon);\n\n                errors.push(error);\n\n                redrawCallback();\n                // onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n\n            }\n        }, (err) => {\n            // debugger\n        });\n        requests.push(request);\n    }\n\n    await Promise.all(requests.map(p => p.catch(e => e)));\n    onLayerChanged(changedLayer, {status: 'ok', loadedCount, totalCount});\n\n    return msg;\n}\n\nexport const setFootprintRenderables = async (layer, layerConfig, redrawCallback, onLayerChanged, cancelled) => {\n    let rejected = false;\n    cancelled.catch(() => {\n        rejected = true;\n    })\n    //return promise\n    const msg = {\n        status: 'ok',\n        loadedCount: null,\n        totalCount: null,\n    }\n    const requests = [];\n    const status = 'loading';\n    let loadedCount = 0;\n    let errors = [];\n    let totalCount = 0;\n    redrawCallback();\n    const changedLayer = {\n        satKey: layerConfig.satKey,\n        layerKey: layerConfig.layerKey\n    }\n    onLayerChanged(changedLayer, {status, loadedCount, totalCount})\n\n    const products = await getSciProducts(layerConfig);\n    totalCount = products.length;\n    if(rejected) {\n        return\n    }\n\n    const productsIDs = products.map(p => p.id());\n\n    const renderablesToRemove = [];\n    const renderedRenderables = [];\n    layer.renderables.forEach((r => {\n        const id = r && r.userProperties && r.userProperties.key;\n        renderedRenderables.push(id);\n        if(!productsIDs.includes(id)) {\n            renderablesToRemove.push(r) ;\n        }\n    }))\n\n    //remove renderables\n    renderablesToRemove.forEach(r => layer.removeRenderable(r));\n\n    //identify new renderables\n    const newRenderables = products.filter((p) => {\n        const productID = p.id();\n        return !renderedRenderables.includes(productID);\n    })\n\n    loadedCount = layer.renderables.length;\n\n    for(let productIndex = 0; productIndex < newRenderables.length; productIndex++) {\n        const key = newRenderables[productIndex].id();\n        const request = newRenderables[productIndex].renderable().then((result) => {\n            \n            \n            if(rejected) {\n                return\n            }\n            const boundaries = getBoundaries(result);\n\n            let uncompleateBoundaries = false;\n            if(boundaries && boundaries.length > 0 && boundaries[0].length < 4) {\n                uncompleateBoundaries = true;\n            }\n            const error = result.error instanceof Error;\n\n            if(!error && !uncompleateBoundaries) {\n                loadedCount++;\n                result['userProperties'] = {\n                    key\n                }\n\n                layer.addRenderable(result);\n                redrawCallback();\n                onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n            } else {\n                //Add also not loaded footprints\n                loadedCount++;\n                const polygon = productBounds(boundaries);\n                polygon['userProperties'] = {\n                    key\n                }\n\n\n                layer.addRenderable(polygon);\n\n                errors.push(error);\n\n                redrawCallback();\n                // onLayerChanged(changedLayer, {status, loadedCount, totalCount});\n\n            }\n        }, (err) => {\n            // debugger\n        });\n        requests.push(request);\n    }\n\n    await Promise.all(requests.map(p => p.catch(e => e)));\n    onLayerChanged(changedLayer, {status: 'ok', loadedCount, totalCount});\n\n    return msg;\n}\n\nexport const reloadLayer = async (layerCfg, wwdLayer, wwd, onLayerChanged) => {\n\n    const layerKey = getLayerKeyFromConfig(layerCfg);\n    let rejected = false;\n    const activeRequestReject = productsRequests.get(layerKey);\n    if(activeRequestReject) {\n        //reject pending request\n        activeRequestReject();\n        rejected = true;\n        productsRequests.delete(layerKey);\n    }\n\n    const cancelled = new Promise((resolve, reject) => {\n        productsRequests.set(layerKey, reject);\n    });\n\n    const dispatchChange = (layerKey, change) => {\n        if(!rejected) {\n            onLayerChanged(layerKey, change);\n        }\n    }\n\n    try {\n        await setRenderables(wwdLayer, layerCfg, wwd.redraw.bind(wwd), dispatchChange, cancelled);\n        productsRequests.delete(layerKey);\n    } catch (err) {\n        if (err.message === \"Cancelled\") {\n            console.log(\"Connection was closed\");\n        } else {\n            console.log(\"Unexpected error:\", err.stack);\n        }\n    }\n}\n\nexport const reloadFootprint = async (layerCfg, wwdLayer, wwd, onLayerChanged) => {\n\n    const layerKey = getLayerKeySCIHubResult(layerCfg.results[0]);\n    let rejected = false;\n    const activeRequestReject = productsRequests.get(layerKey);\n    if(activeRequestReject) {\n        //reject pending request\n        activeRequestReject();\n        rejected = true;\n        productsRequests.delete(layerKey);\n    }\n\n    const cancelled = new Promise((resolve, reject) => {\n        productsRequests.set(layerKey, reject);\n    });\n\n    const dispatchChange = (layerKey, change) => {\n        if(!rejected) {\n            onLayerChanged(layerKey, change);\n        }\n    }\n\n    try {\n        await setRenderablesFromConfig(wwdLayer, layerCfg, wwd.redraw.bind(wwd), dispatchChange, cancelled);\n        productsRequests.delete(layerKey);\n    } catch (err) {\n        if (err.message === \"Cancelled\") {\n            console.log(\"Connection was closed\");\n        } else {\n            console.log(\"Unexpected error:\", err.stack);\n        }\n    }\n}\n\nexport const reloadLayersRenderable = (layers, wwdLayers, wwd, onLayerChanged) => {\n    layers.forEach((layerCfg) => {\n        //reload only sentinel data\n        if(layerCfg.type === 'sentinelData') {\n            const layerKey = getLayerKeyFromConfig(layerCfg);\n            const wwdLayer = getLayerByName(layerKey, wwdLayers);   \n            reloadLayer(layerCfg, wwdLayer, wwd, onLayerChanged);\n        }\n\n        if(layerCfg.type === 'sentinelFootprint') {\n            const layerKey = getLayerKeySCIHubResult(layerCfg.results[0]);\n            const wwdLayer = getLayerByName(layerKey, wwdLayers);   \n            reloadFootprint(layerCfg, wwdLayer, wwd, onLayerChanged);\n        }\n    });\n}\n\nexport default {\n    getLayers,\n    getLayerKeyFromConfig,\n    getLayerKeySCIHubResult,\n    getLayerByName,\n    reloadLayersRenderable,\n}","export const hubUsername = 'copapps';\nexport const hubPassword = 'C9C-2EZ-gQ4-ezY';\n","import React from 'react';\nimport Presentation from './presentation';\nimport {withContext} from '../../context/withContext';\nimport {getProductByKey} from '../../components/WorldWindMap/layers';\n// import Icon from '../Icon';\nimport {\n    updateInfoModal,\n    setActiveInfoModal,\n} from '../../context/actions';\nimport select from '../../context/selectors/';\n\n\n// ReactModal.setAppElement('#root');\n\nconst ProductsModal = (props) => {\n    // const {modalKey, isOpen, content, onClose, header} = props;\n    const {dispatch, state} = props;\n    \n    //info modal state\n    const activeInfoModalKey = select.rootSelectors.getActiveInfoModalKey(state);\n    const activeInfoModal = select.rootSelectors.getInfoModal(state, activeInfoModalKey);\n    const visible = !!activeInfoModalKey && activeInfoModal.type === 'PRODUCTS';\n    let products = visible ? activeInfoModal.products.map((key) => getProductByKey(key).metadata()) : null;\n    const onInfoModalClose = () => {\n        dispatch(updateInfoModal(activeInfoModalKey, {open: false}));\n        dispatch(setActiveInfoModal(null));\n    }\n\n    return (\n        visible ? <Presentation \n            visible={visible}\n            onClose={onInfoModalClose}\n            showProducts={activeInfoModal.products}\n            products={products}\n            modalKey={activeInfoModalKey}\n            /> : null\n    )\n}\n\nexport default withContext(ProductsModal);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\n\nimport Icon from '../Icon';\n\nimport './style.scss';\n\nclass Button extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\tcircular: PropTypes.bool,\n\t\tclassName: PropTypes.string,\n\t\tdisabled: PropTypes.bool,\n\t\tghost: PropTypes.bool,\n\t\ticon: PropTypes.string,\n\t\tinverted: PropTypes.bool,\n\t\tinvisible: PropTypes.bool,\n\t\tlarge: PropTypes.bool,\n\t\tonClick: PropTypes.func.isRequired,\n\t\tprimary: PropTypes.bool,\n\t\tsecondary: PropTypes.bool,\n\t\tside: PropTypes.string,\n\t\tsmall: PropTypes.bool,\n\t\ttitle: PropTypes.string,\n\t\tunfocusable: PropTypes.bool\n\t};\n\n\tstatic defaultProps = {\n\t\tdisabled: false\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tfocused: false,\n\t\t\tmenuOpen: false\n\t\t};\n\n\t\tthis.onBlur = this.onBlur.bind(this);\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.onKeyPress = this.onKeyPress.bind(this);\n\t}\n\n\n\tonClick(e) {\n\t\tif (!this.props.disabled) {\n\t\t\tif (this.props.onClick) {\n\t\t\t\tthis.props.onClick(e);\n\t\t\t}\n\t\t\tthis.setState({\n\t\t\t\tmenuOpen: !this.state.menuOpen\n\t\t\t});\n\t\t}\n\t}\n\n\tonBlur() {\n\t\tthis.setState({\n\t\t\tmenuOpen: false\n\t\t});\n\t}\n\n\tonKeyPress(e) {\n\t\tif(e.charCode === 32) {\n\t\t\tthis.onClick(e);\n\t\t} else if (e.charCode === 13){\n\t\t\tthis.onClick(e);\n\t\t}\n\t}\n\n\n\trender() {\n\n\t\tlet iconInsert = null;\n\t\tif (this.props.icon) {\n\t\t\t// determine icon\n\t\t\ticonInsert = (\n\t\t\t\t<Icon icon={this.props.icon} />\n\t\t\t);\n\t\t}\n\n\t\tlet hasContent = false;\n\t\tlet content = React.Children.map(this.props.children, child => {\n\t\t\tif (child) {\n\t\t\t\tif (typeof child === 'string') {\n\t\t\t\t\thasContent = true;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"ptr-button-caption\">{child}</div>\n\t\t\t\t\t);\n\t\t\t\t} else if (typeof child === 'object' && child.type === React.Fragment) {\n\t\t\t\t\thasContent = true;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"ptr-button-content\">{child}</div>\n\t\t\t\t\t);\n\t\t\t\t} else if (React.isValidElement(child)) {\n\t\t\t\t\treturn React.cloneElement(child);\n\t\t\t\t} else {\n\t\t\t\t\thasContent = true;\n\t\t\t\t\treturn child;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tlet classes = classNames(\n\t\t\t'ptr-button', {\n\t\t\t\tcircular: !!this.props.circular,\n\t\t\t\tdisabled: this.props.disabled,\n\t\t\t\tghost: !!this.props.ghost,\n\t\t\t\ticon: !!iconInsert && !hasContent,\n\t\t\t\tinvisible: !!this.props.invisible,\n\t\t\t\tinverted: !!this.props.inverted,\n\t\t\t\tlarge: !!this.props.large,\n\t\t\t\tprimary: !!this.props.primary,\n\t\t\t\tsecondary: !!this.props.secondary,\n\t\t\t\tside: !!this.props.side,\n\t\t\t\t'side-left': this.props.side === 'left',\n\t\t\t\t'side-right': this.props.side === 'right',\n\t\t\t\t'side-top': this.props.side === 'top',\n\t\t\t\t'side-bottom': this.props.side === 'bottom',\n\t\t\t\tsmall: this.props.small,\n\t\t\t},\n\t\t\tthis.props.className\n\t\t);\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={classes}\n\t\t\t\tid={this.props.id}\n\t\t\t\tonBlur={this.onBlur}\n\t\t\t\tonClick={this.onClick}\n\t\t\t\tonKeyPress={this.onKeyPress}\n\t\t\t\ttabIndex={(this.props.disabled || this.props.unfocusable) ? \"-1\" : \"0\"}\n\t\t\t\ttitle={this.props.title}\n\t\t\t>\n\t\t\t\t{iconInsert}\n\t\t\t\t{content}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Button;\n\nexport const Buttons =  ({vertical, children}) => (<div className={classNames(\"ptr-buttons\", {vertical})}>{children}</div>);\nexport const ButtonGroup =  ({vertical, children}) => (<div className={classNames(\"ptr-button-group\", {vertical})}>{children}</div>);\n","import React from 'react';\n\nconst copy = (text, e) => {\n\tnavigator.clipboard.writeText(text);\n\te.stopPropagation();\n};\n\nexport default props => {\n\tif (!props.value || typeof props.value !== \"string\") return null;\n\n\tlet shortKey = props.value.substring(0, 4);\n\treturn (\n\t\t<span\n\t\t\tclassName=\"option-id\"\n\t\t\ttitle={props.value}\n\t\t\tonClick={copy.bind(null, props.value)}\n\t\t>\n\t\t\t{shortKey}\n\t  </span>\n\t);\n}","import React from 'react';\n// import i18n from 'i18next';\n\nimport _ from 'lodash';\n\n// import period, {toString as periodToString} from './period';\n// import {replaceIdWithKey, removeDuplicities} from './models';\n\n\nexport default {\n\n\t// period: period,\n\t// periodToString: periodToString,\n\n\t// addI18nResources: function(namespace, resources){\n\t// \t_.forIn(resources, (resource, language) => {\n\t// \t\ti18n.addResourceBundle(language, namespace, resource, true, true);\n\t// \t});\n\t// },\n\n\tdeepClone: function (data) {\n\t\tvar clone = data;\n\t\tif (_.isObject(data) && !React.Component.isPrototypeOf(data)) {\n\n\t\t\tclone = _.clone(data);\n\n\t\t\t_.each(clone, function (value, key) {\n\t\t\t\tclone[key] = this.deepClone(value);\n\t\t\t}, this);\n\n\t\t}\n\n\t\treturn clone;\n\t},\n\n\tdeepCloneKeepModels: function (data) {\n\t\tvar clone = data;\n\t\tif (\n\t\t\t_.isObject(data) && !React.Component.isPrototypeOf(data)\n\t\t//&& !(data instanceof GeneralModel)\n\t\t) {\n\n\t\t\tclone = _.clone(data);\n\n\t\t\t_.each(clone, function (value, key) {\n\t\t\t\tclone[key] = this.deepCloneKeepModels(value);\n\t\t\t}, this);\n\n\t\t}\n\n\t\treturn clone;\n\t},\n\n\tclone: function (data) {\n\t\tvar clone = data;\n\t\tif (\n\t\t\t_.isObject(data) && !React.Component.isPrototypeOf(data)\n\t\t) {\n\n\t\t\tclone = _.clone(data);\n\n\t\t\t_.each(clone, function (value, key) {\n\t\t\t\tclone[key] = this.deepCloneKeepModels(value);\n\t\t\t}, this);\n\n\t\t}\n\n\t\treturn clone;\n\t},\n\n\t/**\n\t * Generates v4 compliant UUID\n\t * @returns {string|*|void}\n\t */\n\tuuid() {\n\t\treturn ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\n\t\t\t(c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n\t\t)\n\t},\n\n\t/**\n\t * DEPRECATED!\n\t * Generates pseudo-uuid string\n\t * @returns {string}\n\t */\n\tguid() {\n\t\tfunction s4() {\n\t\t\treturn Math.floor((1 + Math.random()) * 0x10000)\n\t\t\t\t.toString(16)\n\t\t\t\t.substring(1);\n\t\t}\n\n\t\treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n\t\t\ts4() + '-' + s4() + s4() + s4();\n\t},\n\n\t/**\n\t * Generates random string of specified length.\n\t * @param length\n\t * @returns {string}\n\t */\n\trandomString: length => ((Math.random() * Math.pow(36, length) >> 0).toString(36)),\n\n\tgetRemSize: () => parseFloat(getComputedStyle(document.documentElement).fontSize),\n\n\t/**\n\t * Promise.all() for objects (instead of arrays)\n\t * @param object of promises\n\t * @returns promise of object of resolved values\n\t */\n\tpromiseAll(object) {\n\n\t\tlet promisedProperties = [];\n\t\tconst objectKeys = Object.keys(object);\n\n\t\tobjectKeys.forEach((key) => promisedProperties.push(object[key]));\n\n\t\treturn Promise.all(promisedProperties)\n\t\t\t.then((resolvedValues) => {\n\t\t\t\treturn resolvedValues.reduce((resolvedObject, property, index) => {\n\t\t\t\t\tresolvedObject[objectKeys[index]] = property;\n\t\t\t\t\treturn resolvedObject;\n\t\t\t\t}, object);\n\t\t\t});\n\n\t},\n\n\tcollectionsAreEqual (collection1, collection2, sortBy) {\n\t\t// Sort conditions so the arrays match up.\n\t\tsortBy = sortBy || 'id';\n\t\tcollection1 = _.sortBy(collection1, sortBy);\n\t\tcollection2 = _.sortBy(collection2, sortBy);\n\t\treturn JSON.stringify(collection1) === JSON.stringify(collection2);\n\t},\n\n\tscrollTo(elementId, containerId, duration){\n\t\tlet animationDuration = duration ? duration : 200;\n\t\tlet container = document.getElementById(containerId);\n\t\tlet element = document.getElementById(elementId);\n\n\t\tlet elementOffset = element.offsetTop;\n\t\tlet elementHeight = element.offsetHeight;\n\t\tlet containerHeight = container.offsetHeight;\n\t\tlet scroll = elementOffset + elementHeight - containerHeight + 10;\n\n\t\tdocument.getElementById(containerId).scrollTop = elementOffset;\n\t},\n\n\trenderParagraphWithSeparatedLines(text) {\n\t\tif (text && typeof text === \"string\"){\n\t\t\tlet splittedText = text.split(\"\\n\");\n\t\t\treturn (\n\t\t\t\t<p>\n\t\t\t\t\t{splittedText.map((rec, index) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<span key={index}>\n\t\t\t\t\t\t\t{rec}{index === (splittedText.length - 1) ? null : <br/>}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)})\n\t\t\t\t\t}\n\t\t\t\t</p>\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\n\t/**\n\t * Get json-like formatted string\n\t * @param json {JSON | string | null}\n\t * @return {string}\n\t */\n\tgetStringFromJson (json) {\n\t\tif (json && typeof json === \"object\") {\n\t\t\treturn JSON.stringify(json, null, 2)  ;\n\t\t} else {\n\t\t\treturn json;\n\t\t}\n\t},\n\n\t/**\n\t * Takes deep object and returns it with values containing path to that key in the object (where value isn't a nested object).\n\t * e.g. {a: null, b: {c: null, d: null}} => {a: 'a', b: {c: 'b.c', d: 'b.d'}}\n\t * Used for constants.\n\t * @param object - input object or nested object when called recursively\n\t * @param path - path to nested object when called recursively\n\t * @returns object\n\t */\n\tdeepKeyMirror(object, path) {\n\t\tif (_.isObjectLike(object)) {\n\t\t\treturn _.mapValues(object, (value, key) => {\n\t\t\t\treturn this.deepKeyMirror(value, path ? path + '.' + key : key);\n\t\t\t});\n\t\t} else {\n\t\t\treturn path;\n\t\t}\n\t},\n\n\n\tstringToNumHash(string) {\n\t\tstring = '' + string;\n\t\tif (typeof string !== 'string') throw new Error('stringToNumHash: argument must be a string');\n\t\tlet hash = 1;\n\t\tfor (let i = 0; i < string.length; i++) {\n\t\t\thash = Math.imul(hash + string.charCodeAt(i) | 0, 265443576107);\n\t\t}\n\t\treturn (hash ^ hash >>> 17) >>> 0;\n\t},\n\n\t/**\n\t * Deterministic colour set based on input string.\n\t * @param string - input string\n\t * @param count - number of colours\n\t * @param options - hue, saturation and lightness ranges\n\t * @returns {Array} css hsl codes\n\t */\n\tstringToColours(string, count, options) {\n\t\tlet hash = this.stringToNumHash(string);\n\t\tlet colours = [];\n\t\tlet defaults = {\n\t\t\thue: [0,360],\n\t\t\tsaturation: [35,65],\n\t\t\tlightness: [40,60]\n\t\t};\n\t\toptions = {...defaults, ...options};\n\t\tlet h, s, l;\n\t\tlet hueRange = options.hue[1] - options.hue[0];\n\t\tlet saturationRange = options.saturation[1] - options.saturation[0];\n\t\tlet lightnessRange = options.lightness[1] - options.lightness[0];\n\t\tfor (let i = 0; i < (count || 1); i++) {\n\t\t\th = hash % hueRange + options.hue[0];\n\t\t\thash = (hash ^ hash >>> 17) >>> 0;\n\t\t\ts = hash % saturationRange + options.saturation[0];\n\t\t\thash = (hash ^ hash >>> 17) >>> 0;\n\t\t\tl = hash % lightnessRange + options.lightness[0];\n\t\t\thash = (hash ^ hash >>> 17) >>> 0;\n\t\t\tcolours.push('hsl(' + h + ',' + s + '%,' + l + '%)');\n\t\t}\n\t\treturn colours;\n\t}\n}\n\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport SelectBase from 'react-select';\n// import CreatableSelect from 'react-select';\nimport classnames from 'classnames';\nimport _ from 'lodash';\n\nimport './select.scss';\nimport Key from \"./Key\";\nimport utils from \"../../../utils/utils\";\n\nclass Select extends React.PureComponent {\n\n    static propTypes = {\n        className: PropTypes.string, // className for the outer element\n        clearable: PropTypes.bool,\n        components: PropTypes.object,\n        disabled: PropTypes.bool,\n        formatOptionLabel: PropTypes.func, // custom option rendering\n        multi: PropTypes.bool,\n        onChange: PropTypes.func, // onChange handler: function (newValue) {}\n        options: PropTypes.array,\n        optionLabel: PropTypes.string, // path to label\n        optionValue: PropTypes.string, // path to value\n        type: PropTypes.string,\n        placeholder: PropTypes.string,\n        unfocusable: PropTypes.bool,\n        value: PropTypes.oneOfType([\n            PropTypes.object,\n            PropTypes.array,\n            PropTypes.string\n        ]),\n        valueIsTitle: PropTypes.bool,\n        withKeyPrefix: PropTypes.bool,\n\n        // creatable\n        onCreate: PropTypes.func,\n\n        // id of the element where menu will be rendered\n        menuPortalTarget: PropTypes.string\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.getLabel = this.getLabel.bind(this);\n        this.onChange = this.onChange.bind(this);\n        this.onCreate = this.onCreate.bind(this);\n    }\n\n    getFormattedOptions() {\n        return this.props.options.map(option => {\n        \tlet label = option;\n        \tlet value = option;\n\n        \tif (this.props.optionValue) {\n        \t\tvalue = _.get(option, this.props.optionValue);\n\t\t\t}\n\n        \tif (this.props.optionLabel) {\n        \t\tlabel = _.get(option, this.props.optionLabel)\n\t\t\t}\n\n            return {value, label, isDisabled: option.isDisabled};\n        });\n    }\n\n    onChange(selectedObject) {\n        // multiselect\n        if (_.isArray(selectedObject)){\n            if (_.isEmpty(selectedObject)) {\n                this.props.onChange(null);\n            } else if (this.props.optionValue) {\n                let selected = [];\n                _.forEach(selectedObject, (item) => {\n                    let originalObject = _.find(this.props.options, (option) => {return ((item && item.value) === (_.get(option, this.props.optionValue)))});\n                    if (originalObject) {\n                        selected.push(originalObject);\n                    }\n                });\n                this.props.onChange(selected);\n            } else {\n                let values = selectedObject.map(object => object.value);\n                this.props.onChange(values);\n            }\n        }\n\n        else {\n            if (this.props.optionValue) {\n                let selected =  _.find(this.props.options, (option) => {\n                    return (_.get(option, this.props.optionValue) === (selectedObject && selectedObject.value))\n                });\n                if (selected) {\n                    this.props.onChange(selected);\n                } else {\n                    this.props.onChange(null);\n                }\n            } else {\n                this.props.onChange(selectedObject ? selectedObject.value : null);\n            }\n        }\n    }\n\n    onCreate(label) {\n        let key = utils.uuid();\n        if (this.props.optionValue && this.props.optionLabel) {\n            let data = {};\n            _.set(data, this.props.optionValue, key);\n            _.set(data, this.props.optionLabel, label);\n            this.props.onCreate(data);\n        } else {\n            this.props.onCreate(label);\n        }\n    }\n    \n    render() {\n        let props = {...this.props};\n\n        // prepare options\n        if (!props.options) {\n            props.options = [];\n        } else {\n            props.options = this.getFormattedOptions();\n        }\n\n        // prepare selected value\n        if (props.value && typeof props.value === 'string') {\n            props.value = _.find(props.options, {value: props.value});\n        } else if (props.value && props.optionValue && !_.isArray(props.value)) {\n        \tprops.value = _.find(props.options, {value: _.get(props.value, props.optionValue)})\n\t\t} else if (_.isArray(props.value)) {\n            props.value = _.filter(props.options, (option) => {\n                return !!_.find(props.value, value => {\n                    if (typeof value === 'string') {\n                        return value === option.value;\n                    } else {\n                        return _.get(value, props.optionValue) === option.value;\n                    }\n                });\n            });\n        }\n\n        const classes = classnames(`ptr-select-container ${this.props.className ? this.props.className : \"\"}`, {\n            'value-is-title': !!this.props.valueIsTitle,\n            'disabled': this.props.disabled,\n            'clearable': this.props.clearable,\n            'multi': this.props.multi\n        });\n\n        switch (this.props.type) {\n            case 'creatable':\n                return this.renderCreatable(props, classes);\n            default:\n                return this.renderBase(props, classes);\n        }\n    }\n\n    renderBase(props, classes) {\n        return (\n            <SelectBase\n                placeholder={this.props.placeholder}\n                className={classes}\n                classNamePrefix={'ptr-select'}\n                clearable={this.props.clearable}\n                components={props.components}\n                formatOptionLabel={this.getLabel}\n                hideSelectedOptions={props.hideSelectedOptions}\n                isClearable={this.props.clearable}\n                isDisabled={this.props.disabled}\n                isOptionDisabled={(option) => option.isDisabled}\n                isMulti={this.props.multi}\n                onChange={this.onChange}\n                options={props.options}\n                tabIndex={props.unfocusable ? -1 : 0}\n                value={props.value}\n                title={props.value}\n                styles={{ menuPortal: base => {\n                        const { zIndex, ...rest } = base;  // remove zIndex from base by destructuring\n                        return { ...rest, zIndex: 9999 };\n                    }}}\n                menuPortalTarget={document.getElementById(this.props.menuPortalTarget || \"ptr-app\")}\n            />\n        );\n    }\n\n    renderCreatable(props, classes) {\n        return (\n            <SelectBase\n                className={classes}\n                classNamePrefix={'ptr-select'}\n                components={props.components}\n                formatOptionLabel={this.getLabel}\n                hideSelectedOptions={props.hideSelectedOptions}\n                isClearable={this.props.clearable}\n                isDisabled={this.props.disabled}\n                isOptionDisabled={(option) => option.isDisabled}\n                isMulti={this.props.multi}\n                onChange={this.onChange}\n                onCreateOption={this.onCreate}\n                options={props.options}\n                tabIndex={props.unfocusable ? -1 : 0}\n                value={props.value}\n                title={props.value}\n                styles={{ menuPortal: base => {\n                        const { zIndex, ...rest } = base;  // remove zIndex from base by destructuring\n                        return { ...rest, zIndex: 9999 };\n                    }}}\n                menuPortalTarget={document.getElementById(this.props.menuPortalTarget || \"ptr-app\")}\n            />\n        )\n    }\n\n    getLabel(option) {\n        if (this.props.formatOptionLabel) {\n            if (this.props.optionValue) {\n                let selected =  _.find(this.props.options, (opt) => {\n                    return (_.get(opt, this.props.optionValue) === option.value)\n                });\n                if (selected) {\n                    return this.props.formatOptionLabel(selected);\n                } else {\n                    throw new Error('Select#Selected option was not found in original options.');\n                }\n            } else {\n                return this.props.formatOptionLabel(option.label);\n            }\n        } else {\n            let labelPrefix = null;\n            let labelText = option.label;\n\n            if (this.props.withKeyPrefix) {\n                labelPrefix = (<Key value={option.value}/>)\n            }\n\n            return (\n                <div className=\"label\" key='label'>\n                    {labelPrefix}\n                    {labelText}\n                </div>\n            );\n        }\n    }\n}\n\nexport default Select;","import React, { useState } from 'react';\nimport Button from '../../../atoms/Button';\nimport Icon from '../../../atoms/Icon';\nimport Select from '../../../atoms/Select/Select';\nimport moment from 'moment';\n\nimport './style.scss';\n\nconst SearchForm = ({coordinates, satellites, search, previousResultIndex, nextResultIndex, changeActiveResultIndex, result, time}) => {\n    const [selectedSatellite, setSelectedSatellite] = useState(null);\n    const [selectedProduct, setSelectedProduct] = useState(null);\n\n    const satellitesOptions = [...satellites].map((sat) => ({\n        value: sat.id,\n        label: sat.name,\n    }));\n\n    const productsOptions = selectedSatellite ? satellites.find(s => s.id === selectedSatellite.value).layers.map(l => ({\n        value: l,\n        label: l,\n    })) : [];\n\n    const onSearchClick = () => {\n        search(selectedSatellite.value, selectedProduct.value, coordinates, new Date(time), 0);\n    };\n\n    const displayMoveButtons = Number.isInteger(previousResultIndex) ||  Number.isInteger(nextResultIndex);\n\n    return (\n        <div className={'ptr-search-form'}>\n            <div className={'ptr-search-form-selects'}>\n                <Button ghost onClick={() => {}}>\n                    <Icon icon='clock' />{moment(time).format('YYYY-MM-DD')}\n                </Button>\n                <Button ghost onClick={() => {}}>\n                    <Icon icon='location' />{`${Math.round(coordinates.longitude * 100) / 100} , ${Math.round(coordinates.latitude * 100) / 100}`}\n                </Button>\n                <Select\n                    options={satellitesOptions}\n                    onChange={(sat) => {setSelectedSatellite(sat); setSelectedProduct(null)}}\n                    value={selectedSatellite}\n                    placeholder={'Satellite'}\n                    optionLabel='label'\n                    optionValue='value'\n                    />\n\n                <Select\n                    options={productsOptions}\n                    onChange={(sat) => setSelectedProduct(sat)}\n                    value={selectedProduct}\n                    disabled={!selectedSatellite}\n                    placeholder={'Product'}\n                    optionLabel='label'\n                    optionValue='value'\n                    />\n            </div>\n\n            <div className={'ptr-search-form-navigation'}>\n                <Button \n                    ghost\n                    onClick={onSearchClick}\n                    disabled={!selectedProduct || !selectedSatellite}\n                    >\n                    Search\n                </Button>\n                {   \n                    displayMoveButtons ?\n                    <Button \n                        ghost\n                        onClick={() => changeActiveResultIndex(previousResultIndex)}\n                        disabled = {!Number.isInteger(previousResultIndex)}\n                        >\n                        Previous\n                    </Button> : null\n                }\n                {   \n                    displayMoveButtons ?\n                    <Button \n                        ghost\n                        onClick={() => changeActiveResultIndex(nextResultIndex)}\n                        disabled = {!Number.isInteger(nextResultIndex)}\n                        >\n                        Next\n                    </Button> : null\n                }\n            </div>\n\n        </div>\n    )\n}\n\nexport default SearchForm;","import SciHubProducts from '../../../../worldwind/products/Products';\nimport {hubPassword, hubUsername} from \"../../../../config\";\nimport types from '../../../types';\n\nconst searchCache = new window.Map();\nconst csiRenderablesCache = new window.Map();\n\nconst productsScihub = new SciHubProducts(csiRenderablesCache, searchCache, fetchWithCredentials);\n\nfunction fetchWithCredentials (url, options = {}) {\n    if (!options.headers) {\n        options.headers = {};\n    }\n    options.headers.Authorization = `Basic ${window.btoa(`${hubUsername}:${hubPassword}`)}`;\n\n    const fetch = window.fetch(url, options);\n    return fetch;\n};\n\nexport const loadLatestProducts = async (shortName, products, location, beginTime, endTime, startIndex) => {\n    const feed = await productsScihub.load({shortName, products, location, beginTime, endTime, startIndex});\n    if(feed.entry && feed.entry.length > 0) {\n        return feed.entry\n    } else {\n        return null\n    }\n};\n\nexport const setSearchResults = (results) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: 'search',\n        path: 'results',\n        value: results,\n    };\n};\n\nexport const setSearchTime = (time) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: 'search',\n        path: 'filterTime',\n        value: time,\n    };\n};\n\nexport const setActiveResultIndex = (index) => {\n    return {\n        type: types.COMPONENT.SET,\n        component: 'search',\n        path: 'activeResultIndex',\n        value: index,\n    };\n};","import React from 'react';\nimport Presentation from './presentation';\nimport select from '../../../../context/selectors/';\nimport {withContext} from '../../../../context/withContext';\nimport {\n    loadLatestProducts,\n    setSearchResults,\n    setActiveResultIndex,\n    setSearchTime,\n} from '../../../../context/actions/components/searchForm/actions';\n\nconst getPreviousIndex = (curIndex, minIndex = 0) => {\n    if(Number.isInteger(curIndex) && curIndex - 1 >= minIndex) {\n        return curIndex - 1;\n    } else {\n        return null;\n    }\n}\n\nconst getNextIndex = (curIndex, maxIndex) => {\n    if(Number.isInteger(curIndex) && curIndex + 1 <= maxIndex) {\n        return curIndex + 1;\n    } else {\n        return null;\n    }\n}\n\nconst SetalliteSelect = (props) => {\n    const {dispatch, state} = props;\n\n    const activeInfoModalKey = select.rootSelectors.getActiveInfoModalKey(state);\n    const activeInfoModal = select.rootSelectors.getInfoModal(state, activeInfoModalKey);\n    const visible = !!activeInfoModalKey && activeInfoModal.type === 'SEARCH';\n    const coordinates = visible ? activeInfoModal.coordinates : null;\n    const satellites = select.data.satellites.getSubstate(state);\n    const results = select.components.search.getResults(state) || [];\n    const activeResultIndex = select.components.search.getActiveResultIndex(state);\n    const filterTime = select.components.search.getFilterTime(state);\n    const result = (Number.isInteger(activeResultIndex) && results[activeResultIndex]) || null;\n    const nextResultIndex = getNextIndex(activeResultIndex, results.length);\n    const previousResultIndex = getPreviousIndex(activeResultIndex);\n    const selectedTime = filterTime || select.rootSelectors.getSelectTime(state);\n    \n    const searchCoords = async(satelliteId, productId, location, time, statrIndex) => {\n        // setLoading(false);\n        try {\n            const shortName = `${satelliteId[0].toUpperCase()}-${satelliteId.substring(1,3).toUpperCase()}`;\n            const endTime = time;\n            const beginTime = new Date(new Date(endTime).setYear(endTime.getUTCFullYear() - 1));\n            dispatch(setSearchTime(time))\n            const results = await loadLatestProducts(shortName, [productId], location, beginTime, endTime, statrIndex);\n            dispatch(setSearchResults(results))\n            if(results && results.length > 0) {\n                dispatch(setActiveResultIndex(0))\n            }\n        } catch (e) {\n            // setError(e.message || 'Unexpected error');\n        }\n        // setLoading(false);\n    };\n\n    const changeActiveResultIndex = (index) => dispatch(setActiveResultIndex(index));\n\n\n    return (\n        <Presentation \n            time={selectedTime}\n            coordinates={coordinates}\n            satellites={satellites}\n            search={searchCoords}\n            activeResultIndex={activeResultIndex}\n            nextResultIndex={nextResultIndex}\n            previousResultIndex={previousResultIndex}\n            changeActiveResultIndex={changeActiveResultIndex}\n            result={result}\n            />\n    )\n}\n\nexport default withContext(SetalliteSelect);","import React, { useState } from 'react';\nimport moment from 'moment';\nimport Button from '../../../atoms/Button';\nimport Icon from '../../../atoms/Icon';\nimport Select from '../../../atoms/Select/Select';\nimport {parseEntry} from '../../../../worldwind/products/Products';\nimport ProductInformation from '../../../ProductsModal/productInformation';\n\nimport './style.scss';\n\nconst Result = ({result}) => {\n    console.log(result);\n    \n    const parsedResult = parseEntry(result);\n    const date = result && parsedResult ? moment(parsedResult.date[0]._text) : ''\n    const heading = date ? `${date.format('YYYY-MM-DD')} ${parsedResult.str.platformname} - ${parsedResult.str.producttype}` : '';\n    return (\n        <div>\n            {!result ? <div>Search in SCI Hub.</div> : null}\n            {result ? <ProductInformation key={parsedResult.id} product={parsedResult} heading={heading} /> : null}\n        </div>\n    )\n}\n\nexport default Result;","import React from 'react';\nimport Presentation from './presentation';\nimport select from '../../../../context/selectors/';\nimport {withContext} from '../../../../context/withContext';\n\nconst Result = (props) => {\n    const {dispatch, state} = props;\n    const results = select.components.search.getResults(state);\n    const activeResultIndex = select.components.search.getActiveResultIndex(state);\n    const result = (Number.isInteger(activeResultIndex) && results[activeResultIndex]) || null;\n\n    return (\n        <Presentation \n            result={result}\n            />\n    )\n}\n\nexport default withContext(Result);","import React from 'react';\nimport PropTypes from \"prop-types\";\nimport Modal from '../Modal';\nimport {withContext} from '../../context/withContext';\nimport SearchForm from './components/searchForm';\nimport Result from './components/result';\nimport './style.scss';\n\nconst ProductsModal = (props) => {\n    const {visible, onClose, coordinates, modalKey} = props;\n\n    // const content = products.map((product) => {\n    //     return (<ProductInformation key={product.id} product={product} />)\n    // })\n\n    const header = <SearchForm />;\n    const content = (<div className={'modal-content'}><Result /></div>);\n    return (\n        visible ? <Modal \n                modalKey = {modalKey}\n                isOpen = {visible}\n                header = {header}\n                content = {content}\n                onClose = {onClose}\n                /> : null\n    )\n}\n\nProductsModal.propTypes = {\n    coordinates:PropTypes.object,\n    visible:PropTypes.bool,\n    onClose:PropTypes.func,\n    modalKey:PropTypes.string,\n  }\n\n  ProductsModal.defaultProps = {\n    visible:false,\n    onClose:() => {},\n    coordinates: {},\n    modalKey: '',\n  }\n\nexport default withContext(ProductsModal);","import React from 'react';\nimport Presentation from './presentation';\nimport {withContext} from '../../context/withContext';\nimport {getProductByKey} from '../../components/WorldWindMap/layers';\n// import Icon from '../Icon';\nimport {\n    updateInfoModal,\n    setActiveInfoModal,\n} from '../../context/actions';\nimport select from '../../context/selectors/';\n\n\n// ReactModal.setAppElement('#root');\n\nconst ProductsModal = (props) => {\n    // const {modalKey, isOpen, content, onClose, header} = props;\n    const {dispatch, state} = props;\n    \n    //info modal state\n    const activeInfoModalKey = select.rootSelectors.getActiveInfoModalKey(state);\n    const activeInfoModal = select.rootSelectors.getInfoModal(state, activeInfoModalKey);\n    const visible = !!activeInfoModalKey && activeInfoModal.type === 'SEARCH';\n    const coordinates = visible ? activeInfoModal.coordinates : null;\n    const onInfoModalClose = () => {\n        dispatch(updateInfoModal(activeInfoModalKey, {open: false}));\n        dispatch(setActiveInfoModal(null));\n    }\n\n    return (\n        visible ? <Presentation \n            visible={visible}\n            onClose={onInfoModalClose}\n            // showProducts={activeInfoModal.products}\n            coordinates={coordinates}\n            modalKey={activeInfoModalKey}\n            /> : null\n    )\n}\n\nexport default withContext(ProductsModal);","import WorldWind from 'webworldwind-esa';\n\nconst {\n    ArcBallCamera,\n    ArgumentError,\n    BasicWorldWindowController,\n    DrawContext,\n    EarthElevationModel,\n    FrameStatistics,\n    Frustum,\n    Globe,\n    Globe2D,\n    GoToAnimator,\n    GpuResourceCache,\n    Line,\n    Logger,\n    LookAtNavigator,\n    Matrix,\n    Navigator,\n    PickedObjectList,\n    Position,\n    Rectangle,\n    Sector,\n    SurfaceShape,\n    SurfaceShapeTileBuilder,\n    Terrain,\n    Vec2,\n    Vec3,\n    WWMath\n} = WorldWind;\n\n\n/**\n * Constructs a WorldWind window for an HTML canvas.\n * @alias WorldWindow\n * @constructor\n * @classdesc Represents a WorldWind window for an HTML canvas.\n * @param {String|HTMLCanvasElement} canvasElem The ID assigned to the HTML canvas in the document or the canvas\n * element itself.\n * @param {ElevationModel} elevationModel An optional argument indicating the elevation model to use for the World\n * Window. If missing or null, a default elevation model is used.\n * @throws {ArgumentError} If there is no HTML element with the specified ID in the document, or if the\n * HTML canvas does not support WebGL.\n */\nclass WorldWindow {\n    constructor(canvasElem, elevationModel, controllerConstructor, cameraConstructor) {\n        if (!(window.WebGLRenderingContext)) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"constructor\", \"webglNotSupported\"));\n        }\n\n        // Get the actual canvas element either directly or by ID.\n        var canvas;\n        if (canvasElem instanceof HTMLCanvasElement) {\n            canvas = canvasElem;\n        } else {\n            // Attempt to get the HTML canvas with the specified ID.\n            canvas = document.getElementById(canvasElem);\n\n            if (!canvas) {\n                throw new ArgumentError(\n                    Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"constructor\",\n                        \"The specified canvas ID is not in the document.\"));\n            }\n        }\n\n        // Create the WebGL context associated with the HTML canvas.\n        var gl = this.createContext(canvas);\n        if (!gl) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"constructor\", \"webglNotSupported\"));\n        }\n\n        // Internal. Intentionally not documented.\n        this.drawContext = new DrawContext(gl);\n\n        // Internal. Intentionally not documented. Must be initialized before the navigator is created.\n        this.eventListeners = {};\n\n        // Internal. Intentionally not documented. Initially true in order to redraw at least once.\n        this.redrawRequested = true;\n\n        // Internal. Intentionally not documented.\n        this.redrawRequestId = null;\n\n        // Internal. Intentionally not documented.\n        this.scratchModelview = Matrix.fromIdentity();\n\n        // Internal. Intentionally not documented.\n        this.scratchProjection = Matrix.fromIdentity();\n\n        // Internal. Intentionally not documented.\n        this.hasStencilBuffer = gl.getContextAttributes().stencil;\n\n        /**\n         * The HTML canvas associated with this WorldWindow.\n         * @type {HTMLElement}\n         * @readonly\n         */\n        this.canvas = canvas;\n\n        /**\n         * The number of bits in the depth buffer associated with this WorldWindow.\n         * @type {number}\n         * @readonly\n         */\n        this.depthBits = gl.getParameter(gl.DEPTH_BITS);\n\n        /**\n         * The current viewport of this WorldWindow.\n         * @type {Rectangle}\n         * @readonly\n         */\n        this.viewport = new Rectangle(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n        /**\n         * The globe displayed.\n         * @type {Globe}\n         */\n        this.globe = new Globe(elevationModel || new EarthElevationModel());\n\n        /**\n         * The layers to display in this WorldWindow.\n         * This property is read-only. Use [addLayer]{@link WorldWindow#addLayer} or\n         * [insertLayer]{@link WorldWindow#insertLayer} to add layers to this WorldWindow.\n         * Use [removeLayer]{@link WorldWindow#removeLayer} to remove layers from this WorldWindow.\n         * @type {Layer[]}\n         * @readonly\n         */\n        this.layers = [];\n\n        /**\n         * The navigator used to manipulate the globe.\n         * @type {Navigator}\n         * @default [Navigator]{@link Navigator}\n         */\n        this.navigator = new Navigator(cameraConstructor && new cameraConstructor(this) || new ArcBallCamera(this));\n\n\n        /**\n         * The controller used to manipulate the globe.\n         * @type {WorldWindowController}\n         * @default [BasicWorldWindowController]{@link BasicWorldWindowController}\n         */\n        this.worldWindowController = controllerConstructor && new controllerConstructor(this) || new BasicWorldWindowController(this);\n\n        /**\n         * The vertical exaggeration to apply to the terrain.\n         * @type {Number}\n         */\n        this.verticalExaggeration = 1;\n\n        /**\n         * Indicates that picking will return all objects at the pick point, if any. The top-most object will have\n         * its isOnTop flag set to true.\n         * If deep picking is false, the default, only the top-most object is returned, plus\n         * the picked-terrain object if the pick point is over the terrain.\n         * @type {boolean}\n         * @default false\n         */\n        this.deepPicking = false;\n\n        /**\n         * Indicates whether this WorldWindow should be configured for sub-surface rendering. If true, shapes\n         * below the terrain can be seen when the terrain is made transparent. If false, sub-surface shapes are\n         * not visible, however, performance is slightly increased.\n         * @type {boolean}\n         * @default false\n         */\n        this.subsurfaceMode = false;\n\n        /**\n         * The opacity to apply to terrain and surface shapes. This property is typically used when viewing\n         * the sub-surface. It modifies the opacity of the terrain and surface shapes as a whole. It should be\n         * a number between 0 and 1. It is compounded with the individual opacities of the image layers and\n         * surface shapes on the terrain.\n         * @type {Number}\n         * @default 1\n         */\n        this.surfaceOpacity = 1;\n\n        /**\n         * Performance statistics for this WorldWindow.\n         * @type {FrameStatistics}\n         */\n        this.frameStatistics = new FrameStatistics();\n\n        /**\n         * The {@link GoToAnimator} used by this WorldWindow to respond to its goTo method.\n         * @type {GoToAnimator}\n         */\n        this.goToAnimator = new GoToAnimator(this);\n\n        // Documented with its property accessor below.\n        this._redrawCallbacks = [];\n\n        // Documented with its property accessor below.\n        this._orderedRenderingFilters = [\n            function (dc) {\n                thisWindow.declutter(dc, 1);\n            },\n            function (dc) {\n                thisWindow.declutter(dc, 2);\n            }\n        ];\n\n        // Intentionally not documented.\n        this.pixelScale = 1;\n\n        // Prevent the browser's default actions in response to mouse and touch events, which interfere with\n        // navigation. Register these event listeners  before any others to ensure that they're called last.\n        function preventDefaultListener(event) {\n            event.preventDefault();\n        }\n\n        this.addEventListener(\"mousedown\", preventDefaultListener);\n        this.addEventListener(\"touchstart\", preventDefaultListener);\n        this.addEventListener(\"contextmenu\", preventDefaultListener);\n        this.addEventListener(\"wheel\", preventDefaultListener);\n\n        var thisWindow = this;\n\n        // Redirect various UI interactions to the appropriate handler.\n        function onGestureEvent(event) {\n            thisWindow.onGestureEvent(event);\n        }\n\n        if (window.PointerEvent) {\n            // Prevent the browser's default actions in response to pointer events which interfere with navigation.\n            // This CSS style property is configured here to ensure that it's set for all applications.\n            this.canvas.style.setProperty(\"touch-action\", \"none\");\n\n            this.addEventListener(\"pointerdown\", onGestureEvent, false);\n            window.addEventListener(\"pointermove\", onGestureEvent, false); // get pointermove events outside event target\n            window.addEventListener(\"pointercancel\", onGestureEvent, false); // get pointercancel events outside event target\n            window.addEventListener(\"pointerup\", onGestureEvent, false); // get pointerup events outside event target\n        } else {\n            this.addEventListener(\"mousedown\", onGestureEvent, false);\n            window.addEventListener(\"mousemove\", onGestureEvent, false); // get mousemove events outside event target\n            window.addEventListener(\"mouseup\", onGestureEvent, false); // get mouseup events outside event target\n            this.addEventListener(\"touchstart\", onGestureEvent, false);\n            this.addEventListener(\"touchmove\", onGestureEvent, false);\n            this.addEventListener(\"touchend\", onGestureEvent, false);\n            this.addEventListener(\"touchcancel\", onGestureEvent, false);\n        }\n\n        // Register wheel event listeners on the WorldWindow's canvas.\n        this.addEventListener(\"wheel\", function (event) {\n            onGestureEvent(event);\n        });\n\n        // Set up to handle WebGL context lost events.\n        function handleContextLost(event) {\n            thisWindow.handleContextLost(event);\n        }\n\n        this.canvas.addEventListener(\"webglcontextlost\", handleContextLost, false);\n\n        // Set up to handle WebGL context restored events.\n        function handleContextRestored(event) {\n            thisWindow.handleContextRestored(event);\n        }\n\n        this.canvas.addEventListener(\"webglcontextrestored\", handleContextRestored, false);\n\n        // Set up to handle WebGL context events and WorldWind redraw request events. Imagery uses the canvas\n        // redraw events because images are generally specific to the WebGL context associated with the canvas.\n        // Elevation models use the global window redraw events because they can be shared among WorldWindows.\n        function handleRedrawEvent(event) {\n            thisWindow.handleRedrawEvent(event)\n        }\n\n        this.canvas.addEventListener(WorldWind.REDRAW_EVENT_TYPE, handleRedrawEvent, false);\n        window.addEventListener(WorldWind.REDRAW_EVENT_TYPE, handleRedrawEvent, false);\n\n        // Render to the WebGL context in an animation frame loop until the WebGL context is lost.\n        this.animationFrameLoop();\n    };\n\n\n    /**\n     * An array of functions to call during ordered rendering prior to rendering the ordered renderables.\n     * Each function is passed one argument, the current draw context. The function may modify the\n     * ordered renderables in the draw context's ordered renderable list, which has been sorted from front\n     * to back when the filter function is called. Ordered rendering filters are typically used to apply\n     * decluttering. The default set of filter functions contains one function that declutters shapes with\n     * declutter group ID of 1 ({@link GeographicText} by default) and one function that declutters shapes\n     * with declutter group ID 2 ({@link Placemark} by default). Applications can add functions to this\n     * array or remove them.\n     * @type {Function[]}\n     * @default [WorldWindow.declutter]{@link WorldWindow#declutter} with a group ID of 1\n     * @readonly\n     * @memberof WorldWindow.prototype\n     */\n    orderedRenderingFilters() {\n        return this._orderedRenderingFilters;\n    }\n\n    /**\n     * The list of callbacks to call immediately before and immediately after performing a redraw. The callbacks\n     * have two arguments: this WorldWindow and the redraw stage, e.g., <code style='white-space:nowrap'>redrawCallback(worldWindow, stage);</code>.\n     * The stage will be either WorldWind.BEFORE_REDRAW or WorldWind.AFTER_REDRAW indicating whether the\n     * callback has been called either immediately before or immediately after a redraw, respectively.\n     * Applications may add functions to this array or remove them.\n     * @type {Function[]}\n     * @readonly\n     * @memberof WorldWindow.prototype\n     */\n    redrawCallbacks() {\n        return this._redrawCallbacks;\n    }\n\n    /**\n     * Converts window coordinates to coordinates relative to this WorldWindow's canvas.\n     * @param {Number} x The X coordinate to convert.\n     * @param {Number} y The Y coordinate to convert.\n     * @returns {Vec2} The converted coordinates.\n     */\n    canvasCoordinates(x, y) {\n        var bbox = this.canvas.getBoundingClientRect(),\n            xc = x - (bbox.left + this.canvas.clientLeft),// * (this.canvas.width / bbox.width),\n            yc = y - (bbox.top + this.canvas.clientTop);// * (this.canvas.height / bbox.height);\n\n        return new Vec2(xc, yc);\n    };\n\n    onGestureEvent(event) {\n        this.worldWindowController.onGestureEvent(event);\n    };\n\n    /**\n     * Registers an event listener for the specified event type on this WorldWindow's canvas. This function\n     * delegates the processing of events to the WorldWindow's canvas. For details on this function and its\n     * arguments, see the W3C [EventTarget]{@link https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-EventTarget}\n     * documentation.\n     *\n     * Registering event listeners using this function enables applications to prevent the WorldWindow's default\n     * navigation behavior. To prevent default navigation behavior, call the [Event]{@link https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-Event}'s\n     * preventDefault method from within an event listener for any events the navigator should not respond to.\n     *\n     * When an event occurs, this calls the registered event listeners in order of reverse registration. Since the\n     * WorldWindow registers its navigator event listeners first, application event listeners are called before\n     * navigator event listeners.\n     *\n     * @param type The event type to listen for.\n     * @param listener The function to call when the event occurs.\n     * @throws {ArgumentError} If any argument is null or undefined.\n     */\n    addEventListener(type, listener) {\n        if (!type) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"addEventListener\", \"missingType\"));\n        }\n\n        if (!listener) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"addEventListener\", \"missingListener\"));\n        }\n\n        var thisWorldWindow = this;\n        var entry = this.eventListeners[type];\n        if (!entry) {\n            entry = {\n                listeners: [],\n                callback: function (event) { // calls listeners in reverse registration order\n                    event.worldWindow = thisWorldWindow;\n                    for (var i = 0, len = entry.listeners.length; i < len; i++) {\n                        entry.listeners[i](event);\n                    }\n                }\n            };\n            this.eventListeners[type] = entry;\n        }\n\n        var index = entry.listeners.indexOf(listener);\n        if (index == -1) { // suppress duplicate listeners\n            entry.listeners.splice(0, 0, listener); // insert the listener at the beginning of the list\n\n            if (entry.listeners.length == 1) { // first listener added, add the event listener callback\n                this.canvas.addEventListener(type, entry.callback, false);\n            }\n        }\n    };\n\n    /**\n     * Removes an event listener for the specified event type from this WorldWindow's canvas. The listener must be\n     * the same object passed to addEventListener. Calling removeEventListener with arguments that do not identify a\n     * currently registered listener has no effect.\n     *\n     * @param type Indicates the event type the listener registered for.\n     * @param listener The listener to remove. Must be the same function object passed to addEventListener.\n     * @throws {ArgumentError} If any argument is null or undefined.\n     */\n    removeEventListener(type, listener) {\n        if (!type) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"removeEventListener\", \"missingType\"));\n        }\n\n        if (!listener) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"removeEventListener\", \"missingListener\"));\n        }\n\n        var entry = this.eventListeners[type];\n        if (!entry) {\n            return; // no entry for the specified type\n        }\n\n        var index = entry.listeners.indexOf(listener);\n        if (index != -1) {\n            entry.listeners.splice(index, 1); // remove the listener from the list\n\n            if (entry.listeners.length == 0) { // last listener removed, remove the event listener callback\n                this.canvas.removeEventListener(type, entry.callback, false);\n            }\n        }\n    };\n\n    /**\n     * Causes this WorldWindow to redraw itself at the next available opportunity. The redraw occurs on the main\n     * thread at a time of the browser's discretion. Applications should call redraw after changing the World\n     * Window's state, but should not expect that change to be reflected on screen immediately after this function\n     * returns. This is the preferred method for requesting a redraw of the WorldWindow.\n     */\n    redraw() {\n        this.redrawRequested = true; // redraw during the next animation frame\n    };\n\n    /**\n     * Requests the WorldWind objects displayed at a specified screen-coordinate point.\n     *\n     * If the point intersects the terrain, the returned list contains an object identifying the associated geographic\n     * position. This returns an empty list when nothing in the WorldWind scene intersects the specified point.\n     *\n     * @param pickPoint The point to examine in this WorldWindow's screen coordinates.\n     * @returns {PickedObjectList} A list of picked WorldWind objects at the specified pick point.\n     * @throws {ArgumentError} If the specified pick point is null or undefined.\n     */\n    pick(pickPoint) {\n        if (!pickPoint) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"pick\", \"missingPoint\"));\n        }\n\n        // Suppress the picking operation and return an empty list when the WebGL context has been lost.\n        if (this.drawContext.currentGlContext.isContextLost()) {\n            return new PickedObjectList();\n        }\n\n        this.resize();\n        this.resetDrawContext();\n        this.drawContext.pickingMode = true;\n        this.drawContext.pickPoint = pickPoint;\n        this.drawContext.pickRay = this.rayThroughScreenPoint(pickPoint);\n        this.drawFrame();\n\n        return this.drawContext.objectsAtPickPoint;\n    };\n\n    /**\n     * Requests the position of the WorldWind terrain at a specified screen-coordinate point. If the point\n     * intersects the terrain, the returned list contains a single object identifying the associated geographic\n     * position. Otherwise this returns an empty list.\n     * @param pickPoint The point to examine in this WorldWindow's screen coordinates.\n     * @returns {PickedObjectList} A list containing the picked WorldWind terrain position at the specified point,\n     * or an empty list if the point does not intersect the terrain.\n     * @throws {ArgumentError} If the specified pick point is null or undefined.\n     */\n    pickTerrain(pickPoint) {\n        if (!pickPoint) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"pickTerrain\", \"missingPoint\"));\n        }\n\n        // Suppress the picking operation and return an empty list when the WebGL context has been lost.\n        if (this.drawContext.currentGlContext.isContextLost()) {\n            return new PickedObjectList();\n        }\n\n        this.resize();\n        this.resetDrawContext();\n        this.drawContext.pickingMode = true;\n        this.drawContext.pickTerrainOnly = true;\n        this.drawContext.pickPoint = pickPoint;\n        this.drawContext.pickRay = this.rayThroughScreenPoint(pickPoint);\n        this.drawFrame();\n\n        return this.drawContext.objectsAtPickPoint;\n    };\n\n    /**\n     * Requests the WorldWind objects displayed within a specified screen-coordinate region. This returns all\n     * objects that intersect the specified region, regardless of whether or not an object is actually visible, and\n     * marks objects that are visible as on top.\n     * @param {Rectangle} rectangle The screen coordinate rectangle identifying the region to search.\n     * @returns {PickedObjectList} A list of visible WorldWind objects within the specified region.\n     * @throws {ArgumentError} If the specified rectangle is null or undefined.\n     */\n    pickShapesInRegion(rectangle) {\n        if (!rectangle) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"pickShapesInRegion\", \"missingRectangle\"));\n        }\n\n        // Suppress the picking operation and return an empty list when the WebGL context has been lost.\n        if (this.drawContext.currentGlContext.isContextLost()) {\n            return new PickedObjectList();\n        }\n\n        this.resize();\n        this.resetDrawContext();\n        this.drawContext.pickingMode = true;\n        this.drawContext.regionPicking = true;\n        this.drawContext.pickRectangle =\n            new Rectangle(rectangle.x, this.canvas.height - rectangle.y, rectangle.width, rectangle.height);\n        this.drawFrame();\n\n        return this.drawContext.objectsAtPickPoint;\n    };\n\n    // Internal function. Intentionally not documented.\n    createContext(canvas) {\n        // Request a WebGL context with antialiasing is disabled. Antialiasing causes gaps to appear at the edges of\n        // terrain tiles.\n        var glAttrs = { antialias: false, stencil: true },\n            gl = canvas.getContext(\"webgl\", glAttrs);\n        if (!gl) {\n            gl = canvas.getContext(\"experimental-webgl\", glAttrs);\n        }\n\n        // uncomment to debug WebGL\n        //var gl = WebGLDebugUtils.makeDebugContext(this.canvas.getContext(\"webgl\"),\n        //        this.throwOnGLError,\n        //        this.logAndValidate\n        //);\n\n        return gl;\n    };\n\n    // Internal function. Intentionally not documented.\n    handleContextLost(event) {\n        Logger.log(Logger.LEVEL_INFO, \"WebGL context event: \" + event.statusMessage);\n        // Inform WebGL that we handle context restoration, enabling the context restored event to be delivered.\n        event.preventDefault();\n        // Notify the draw context that the WebGL rendering context has been lost.\n        this.drawContext.contextLost();\n        // Stop the rendering animation frame loop, resuming only if the WebGL context is restored.\n        window.cancelAnimationFrame(this.redrawRequestId);\n    };\n\n    // Internal function. Intentionally not documented.\n    handleContextRestored(event) {\n        Logger.log(Logger.LEVEL_INFO, \"WebGL context event: \" + event.statusMessage);\n        // Notify the draw context that the WebGL rendering context has been restored.\n        this.drawContext.contextRestored();\n        // Resume the rendering animation frame loop until the WebGL context is lost.\n        this.redraw();\n        this.animationFrameLoop();\n    };\n\n    // Internal function. Intentionally not documented.\n    handleRedrawEvent(event) {\n        this.redraw(); // redraw in the next animation frame\n    };\n\n    // Internal function. Intentionally not documented.\n    animationFrameLoop() {\n        // Render to the WebGL context as needed.\n        this.redrawIfNeeded();\n\n        // Continue the animation frame loop until the WebGL context is lost.\n        var thisWindow = this;\n\n        function animationFrameCallback() {\n            thisWindow.animationFrameLoop();\n        }\n\n        this.redrawRequestId = window.requestAnimationFrame(animationFrameCallback);\n    };\n\n    // Internal function. Intentionally not documented.\n    redrawIfNeeded() {\n        // Check if the drawing buffer needs to resize to match its screen size, which requires a redraw.\n        this.resize();\n\n        // Redraw the WebGL drawing buffer only when necessary.\n        if (!this.redrawRequested) {\n            return;\n        }\n\n        try {\n            // Prepare to redraw and notify the redraw callbacks that a redraw is about to occur.\n            this.redrawRequested = false;\n            this.drawContext.previousRedrawTimestamp = this.drawContext.timestamp;\n            this.callRedrawCallbacks(WorldWind.BEFORE_REDRAW);\n            // Redraw the WebGL drawing buffer.\n            this.resetDrawContext();\n            this.drawFrame();\n        } catch (e) {\n            Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"redrawIfNeeded\",\n                \"Exception occurred during redrawing.\\n\" + e.toString());\n        } finally {\n            // Notify the redraw callbacks that a redraw has completed.\n            this.callRedrawCallbacks(WorldWind.AFTER_REDRAW);\n            // Handle rendering code redraw requests.\n            if (this.drawContext.redrawRequested) {\n                this.redrawRequested = true;\n            }\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    resize() {\n        var gl = this.drawContext.currentGlContext,\n            width = gl.canvas.clientWidth * this.pixelScale,\n            height = gl.canvas.clientHeight * this.pixelScale;\n\n        if (gl.canvas.width != width ||\n            gl.canvas.height != height) {\n\n            // Make the canvas drawing buffer size match its screen size.\n            gl.canvas.width = width;\n            gl.canvas.height = height;\n\n            // Set the WebGL viewport to match the canvas drawing buffer size.\n            gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n            this.viewport = new Rectangle(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n            // Cause this WorldWindow to redraw with the new size.\n            this.redrawRequested = true;\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    computeViewingTransform(projection, modelview) {\n        if (!modelview) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"computeViewingTransform\", \"missingModelview\"));\n        }\n\n        var globe = this.globe;\n        this.navigator.camera.createViewMatrix(modelview);\n\n        if (projection) {\n            projection.setToIdentity();\n            var globeRadius = WWMath.max(globe.equatorialRadius, globe.polarRadius),\n                eyePoint = modelview.extractEyePoint(new Vec3(0, 0, 0)),\n                eyePos = globe.computePositionFromPoint(eyePoint[0], eyePoint[1], eyePoint[2], new Position(0, 0, 0)),\n                eyeHorizon = WWMath.horizonDistanceForGlobeRadius(globeRadius, eyePos.altitude),\n                atmosphereHorizon = WWMath.horizonDistanceForGlobeRadius(globeRadius, 160000),\n                viewport = this.viewport;\n\n            // Set the far clip distance to the smallest value that does not clip the atmosphere.\n            // TODO adjust the clip plane distances based on the navigator's orientation - shorter distances when the\n            // TODO horizon is not in view\n            // TODO parameterize the object altitude for horizon distance\n            var farDistance = eyeHorizon + atmosphereHorizon;\n            if (farDistance < 1e3)\n                farDistance = 1e3;\n\n            // Compute the near clip distance in order to achieve a desired depth resolution at the far clip distance.\n            // This computed distance is limited such that it does not intersect the terrain when possible and is never\n            // less than a predetermined minimum (usually one). The computed near distance automatically scales with the\n            // resolution of the WebGL depth buffer.\n            var nearDistance = WWMath.perspectiveNearDistanceForFarDistance(farDistance, 10, this.depthBits);\n\n            // Prevent the near clip plane from intersecting the terrain.\n            var distanceToSurface = eyePos.altitude - globe.elevationAtLocation(eyePos.latitude, eyePos.longitude);\n            if (distanceToSurface > 0) {\n                var maxNearDistance = WWMath.perspectiveNearDistance(viewport.width, viewport.height, distanceToSurface);\n                if (nearDistance > maxNearDistance) {\n                    nearDistance = maxNearDistance;\n                }\n            }\n\n            if (nearDistance < 1) {\n                nearDistance = 1;\n            }\n\n            // Compute the current projection matrix based on this navigator's perspective properties and the current\n            // WebGL viewport.\n            projection.setToPerspectiveProjection(viewport.width, viewport.height, nearDistance, farDistance);\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    computePixelMetrics(projection) {\n        var projectionInv = Matrix.fromIdentity();\n        projectionInv.invertMatrix(projection);\n\n        // Compute the eye coordinate rectangles carved out of the frustum by the near and far clipping planes, and\n        // the distance between those planes and the eye point along the -Z axis. The rectangles are determined by\n        // transforming the bottom-left and top-right points of the frustum from clip coordinates to eye\n        // coordinates.\n        var nbl = new Vec3(-1, -1, -1),\n            ntr = new Vec3(+1, +1, -1),\n            fbl = new Vec3(-1, -1, +1),\n            ftr = new Vec3(+1, +1, +1);\n        // Convert each frustum corner from clip coordinates to eye coordinates by multiplying by the inverse\n        // projection matrix.\n        nbl.multiplyByMatrix(projectionInv);\n        ntr.multiplyByMatrix(projectionInv);\n        fbl.multiplyByMatrix(projectionInv);\n        ftr.multiplyByMatrix(projectionInv);\n\n        var nrRectWidth = WWMath.fabs(ntr[0] - nbl[0]),\n            frRectWidth = WWMath.fabs(ftr[0] - fbl[0]),\n            nrDistance = -nbl[2],\n            frDistance = -fbl[2];\n\n        // Compute the scale and offset used to determine the width of a pixel on a rectangle carved out of the\n        // frustum at a distance along the -Z axis in eye coordinates. These values are found by computing the scale\n        // and offset of a frustum rectangle at a given distance, then dividing each by the viewport width.\n        var frustumWidthScale = (frRectWidth - nrRectWidth) / (frDistance - nrDistance),\n            frustumWidthOffset = nrRectWidth - frustumWidthScale * nrDistance;\n\n        return {\n            pixelSizeFactor: frustumWidthScale / this.viewport.width,\n            pixelSizeOffset: frustumWidthOffset / this.viewport.height\n        };\n    };\n\n    /**\n     * Computes the approximate size of a pixel at a specified distance from the eye point.\n     * <p>\n     * This method assumes rectangular pixels, where pixel coordinates denote\n     * infinitely thin spaces between pixels. The units of the returned size are in model coordinates per pixel\n     * (usually meters per pixel). This returns 0 if the specified distance is zero. The returned size is undefined\n     * if the distance is less than zero.\n     *\n     * @param {Number} distance The distance from the eye point at which to determine pixel size, in model\n     * coordinates.\n     * @returns {Number} The approximate pixel size at the specified distance from the eye point, in model\n     * coordinates per pixel.\n     */\n    pixelSizeAtDistance(distance) {\n        this.computeViewingTransform(this.scratchProjection, this.scratchModelview);\n        var pixelMetrics = this.computePixelMetrics(this.scratchProjection);\n        return pixelMetrics.pixelSizeFactor * distance + pixelMetrics.pixelSizeOffset;\n    };\n\n    // Internal. Intentionally not documented.\n    computeDrawContext() {\n        var dc = this.drawContext;\n\n        this.computeViewingTransform(dc.projection, dc.modelview);\n        dc.viewport = this.viewport;\n        dc.eyePoint = dc.modelview.extractEyePoint(new Vec3(0, 0, 0));\n\n        dc.modelviewProjection.setToIdentity();\n        dc.modelviewProjection.setToMultiply(dc.projection, dc.modelview);\n\n        var pixelMetrics = this.computePixelMetrics(dc.projection);\n        dc.pixelSizeFactor = pixelMetrics.pixelSizeFactor;\n        dc.pixelSizeOffset = pixelMetrics.pixelSizeOffset;\n\n        // Compute the inverse of the modelview, projection, and modelview-projection matrices. The inverse matrices\n        // are used to support operations on navigator state.\n        var modelviewInv = Matrix.fromIdentity();\n        modelviewInv.invertOrthonormalMatrix(dc.modelview);\n\n        dc.modelviewNormalTransform = Matrix.fromIdentity().setToTransposeOfMatrix(modelviewInv.upper3By3());\n\n        // Compute the frustum in model coordinates. Start by computing the frustum in eye coordinates from the\n        // projection matrix, then transform this frustum to model coordinates by multiplying its planes by the\n        // transpose of the modelview matrix. We use the transpose of the modelview matrix because planes are\n        // transformed by the inverse transpose of a matrix, and we want to transform from eye coordinates to model\n        // coordinates.\n        var modelviewTranspose = Matrix.fromIdentity();\n        modelviewTranspose.setToTransposeOfMatrix(dc.modelview);\n        dc.frustumInModelCoordinates = Frustum.fromProjectionMatrix(dc.projection);\n        dc.frustumInModelCoordinates.transformByMatrix(modelviewTranspose);\n        dc.frustumInModelCoordinates.normalize();\n    };\n\n    // Internal. Intentionally not documented.\n    resetDrawContext() {\n        this.globe.offset = 0;\n\n        var dc = this.drawContext;\n        dc.reset();\n        dc.globe = this.globe;\n        dc.navigator = this.navigator;\n        dc.layers = this.layers.slice();\n        dc.layers.push(dc.screenCreditController);\n        this.computeDrawContext();\n        dc.verticalExaggeration = this.verticalExaggeration;\n        dc.surfaceOpacity = this.surfaceOpacity;\n        dc.deepPicking = this.deepPicking;\n        dc.frameStatistics = this.frameStatistics;\n        dc.pixelScale = this.pixelScale;\n        dc.update();\n    };\n\n    /* useful stuff to debug WebGL */\n    /*\n        function logGLCall(functionName, args) {\n        console.log(\"gl.\" + functionName + \"(\" +\n        WebGLDebugUtils.glFunctionArgsToString(functionName, args) + \")\");\n        };\n    \n        function validateNoneOfTheArgsAreUndefined(functionName, args) {\n        for (var ii = 0; ii < args.length; ++ii) {\n        if (args[ii] === undefined) {\n        console.error(\"undefined passed to gl.\" + functionName + \"(\" +\n        WebGLDebugUtils.glFunctionArgsToString(functionName, args) + \")\");\n        }\n        }\n        };\n    \n        logAndValidate logAndValidate(functionName, args) {\n        logGLCall(functionName, args);\n        validateNoneOfTheArgsAreUndefined (functionName, args);\n        };\n    \n        throwOnGLError throwOnGLError(err, funcName, args) {\n        throw WebGLDebugUtils.glEnumToString(err) + \" was caused by call to: \" + funcName;\n        };\n        */\n\n    // Internal function. Intentionally not documented.\n    drawFrame() {\n        try {\n            this.drawContext.frameStatistics.beginFrame();\n            this.beginFrame();\n\n            if (this.drawContext.globe.is2D() && this.drawContext.globe.continuous) {\n                this.do2DContiguousRepaint();\n            } else {\n                this.doNormalRepaint();\n            }\n\n        } finally {\n            this.endFrame();\n            this.drawContext.frameStatistics.endFrame();\n            //console.log(this.drawContext.frameStatistics.frameTime);\n        }\n    };\n\n    doNormalRepaint() {\n        this.createTerrain();\n        this.clearFrame();\n        this.deferOrderedRendering = false;\n        if (this.drawContext.pickingMode) {\n            if (this.drawContext.makePickFrustum()) {\n                this.doPick();\n                this.resolvePick();\n            }\n        } else {\n            this.doDraw();\n            if (this.subsurfaceMode && this.hasStencilBuffer) {\n                this.redrawSurface();\n                this.drawScreenRenderables();\n            }\n        }\n    };\n\n    do2DContiguousRepaint() {\n        this.createTerrain2DContiguous();\n        this.clearFrame();\n        if (this.drawContext.pickingMode) {\n            if (this.drawContext.makePickFrustum()) {\n                this.pick2DContiguous();\n                this.resolvePick();\n            }\n        } else {\n            this.draw2DContiguous();\n        }\n    };\n\n    resolvePick() {\n        if (this.drawContext.pickTerrainOnly) {\n            this.resolveTerrainPick();\n        } else if (this.drawContext.regionPicking) {\n            this.resolveRegionPick();\n        } else {\n            this.resolveTopPick();\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    beginFrame() {\n        var gl = this.drawContext.currentGlContext;\n        gl.enable(gl.BLEND);\n        gl.enable(gl.CULL_FACE);\n        gl.enable(gl.DEPTH_TEST);\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n        gl.depthFunc(gl.LEQUAL);\n\n        if (this.drawContext.pickingMode) {\n            this.drawContext.makePickFramebuffer();\n            this.drawContext.bindFramebuffer(this.drawContext.pickFramebuffer);\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    endFrame() {\n        var gl = this.drawContext.currentGlContext;\n        gl.disable(gl.BLEND);\n        gl.disable(gl.CULL_FACE);\n        gl.disable(gl.DEPTH_TEST);\n        gl.blendFunc(gl.ONE, gl.ZERO);\n        gl.depthFunc(gl.LESS);\n        gl.clearColor(0, 0, 0, 1);\n\n        this.drawContext.bindFramebuffer(null);\n        this.drawContext.bindProgram(null);\n    };\n\n    // Internal function. Intentionally not documented.\n    clearFrame() {\n        var dc = this.drawContext,\n            gl = dc.currentGlContext;\n\n        gl.clearColor(dc.clearColor.red, dc.clearColor.green, dc.clearColor.blue, dc.clearColor.alpha);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    };\n\n    // Internal function. Intentionally not documented.\n    doDraw() {\n        this.drawContext.renderShapes = true;\n\n        if (this.subsurfaceMode && this.hasStencilBuffer) {\n            // Draw the surface and collect the ordered renderables.\n            this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST);\n            this.drawContext.surfaceShapeTileBuilder.clear();\n            this.drawLayers(true);\n            this.drawSurfaceRenderables();\n            this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n\n            if (!this.deferOrderedRendering) {\n                // Clear the depth and stencil buffers prior to rendering the ordered renderables. This allows\n                // sub-surface renderables to be drawn beneath the terrain. Turn on stenciling to capture the\n                // fragments that ordered renderables draw. The terrain and surface shapes will be subsequently\n                // drawn again, and the stencil buffer will ensure that they are drawn only where they overlap\n                // the fragments drawn by the ordered renderables.\n                this.drawContext.currentGlContext.clear(\n                    this.drawContext.currentGlContext.DEPTH_BUFFER_BIT | this.drawContext.currentGlContext.STENCIL_BUFFER_BIT);\n                this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST);\n                this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS, 1, 1);\n                this.drawContext.currentGlContext.stencilOp(\n                    this.drawContext.currentGlContext.REPLACE, this.drawContext.currentGlContext.REPLACE, this.drawContext.currentGlContext.REPLACE);\n                this.drawOrderedRenderables();\n            }\n        } else {\n            this.drawContext.surfaceShapeTileBuilder.clear();\n            this.drawLayers(true);\n            this.drawSurfaceRenderables();\n            this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n\n            if (!this.deferOrderedRendering) {\n                this.drawOrderedRenderables();\n                this.drawScreenRenderables();\n            }\n        }\n    };\n\n    redrawSurface() {\n        // Draw the terrain and surface shapes but only where the current stencil buffer is non-zero.\n        // The non-zero fragments are from drawing the ordered renderables previously.\n        this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST);\n        this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.EQUAL, 1, 1);\n        this.drawContext.currentGlContext.stencilOp(\n            this.drawContext.currentGlContext.KEEP, this.drawContext.currentGlContext.KEEP, this.drawContext.currentGlContext.KEEP);\n        this.drawContext.surfaceShapeTileBuilder.clear();\n        this.drawLayers(false);\n        this.drawSurfaceRenderables();\n        this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n        this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST);\n    };\n\n    // Internal function. Intentionally not documented.\n    doPick() {\n        if (this.drawContext.terrain) {\n            this.drawContext.terrain.pick(this.drawContext);\n        }\n\n        if (!this.drawContext.pickTerrainOnly) {\n            if (this.subsurfaceMode && this.hasStencilBuffer) {\n                // Draw the surface and collect the ordered renderables.\n                this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST);\n                this.drawContext.surfaceShapeTileBuilder.clear();\n                this.drawLayers(true);\n                this.drawSurfaceRenderables();\n                this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n\n                if (!this.deferOrderedRendering) {\n                    // Clear the depth and stencil buffers prior to rendering the ordered renderables. This allows\n                    // sub-surface renderables to be drawn beneath the terrain. Turn on stenciling to capture the\n                    // fragments that ordered renderables draw. The terrain and surface shapes will be subsequently\n                    // drawn again, and the stencil buffer will ensure that they are drawn only where they overlap\n                    // the fragments drawn by the ordered renderables.\n                    this.drawContext.currentGlContext.clear(\n                        this.drawContext.currentGlContext.DEPTH_BUFFER_BIT | this.drawContext.currentGlContext.STENCIL_BUFFER_BIT);\n                    this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST);\n                    this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS, 1, 1);\n                    this.drawContext.currentGlContext.stencilOp(\n                        this.drawContext.currentGlContext.REPLACE, this.drawContext.currentGlContext.REPLACE, this.drawContext.currentGlContext.REPLACE);\n                    this.drawOrderedRenderables();\n                    this.drawContext.terrain.pick(this.drawContext);\n                    this.drawScreenRenderables();\n                }\n            } else {\n                this.drawContext.surfaceShapeTileBuilder.clear();\n\n                this.drawLayers(true);\n                this.drawSurfaceRenderables();\n\n                this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext);\n\n                if (!this.deferOrderedRendering) {\n                    this.drawOrderedRenderables();\n                    this.drawScreenRenderables();\n                }\n            }\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    createTerrain() {\n        var dc = this.drawContext;\n        dc.terrain = this.globe.tessellator.tessellate(dc);\n        dc.frameStatistics.setTerrainTileCount(dc.terrain ? dc.terrain.surfaceGeometry.length : 0);\n    };\n\n    makeCurrent(offset) {\n        var dc = this.drawContext;\n        dc.globe.offset = offset;\n        dc.globeStateKey = dc.globe.stateKey;\n\n        switch (offset) {\n            case -1:\n                dc.terrain = this.terrainLeft;\n                break;\n\n            case 0:\n                dc.terrain = this.terrainCenter;\n                break;\n\n            case 1:\n                dc.terrain = this.terrainRight;\n                break;\n        }\n    };\n\n    createTerrain2DContiguous() {\n        var dc = this.drawContext;\n\n        this.terrainCenter = null;\n        dc.globe.offset = 0;\n        dc.globeStateKey = dc.globe.stateKey;\n        if (dc.globe.intersectsFrustum(dc.frustumInModelCoordinates)) {\n            this.terrainCenter = dc.globe.tessellator.tessellate(dc);\n        }\n\n        this.terrainRight = null;\n        dc.globe.offset = 1;\n        dc.globeStateKey = dc.globe.stateKey;\n        if (dc.globe.intersectsFrustum(dc.frustumInModelCoordinates)) {\n            this.terrainRight = dc.globe.tessellator.tessellate(dc);\n        }\n\n        this.terrainLeft = null;\n        dc.globe.offset = -1;\n        dc.globeStateKey = dc.globe.stateKey;\n        if (dc.globe.intersectsFrustum(dc.frustumInModelCoordinates)) {\n            this.terrainLeft = dc.globe.tessellator.tessellate(dc);\n        }\n    };\n\n    draw2DContiguous() {\n        var drawing = \"\";\n\n        if (this.terrainCenter) {\n            drawing += \" 0 \";\n            this.makeCurrent(0);\n            this.deferOrderedRendering = this.terrainLeft || this.terrainRight;\n            this.doDraw();\n        }\n\n        if (this.terrainRight) {\n            drawing += \" 1 \";\n            this.makeCurrent(1);\n            this.deferOrderedRendering = this.terrainLeft || this.terrainLeft;\n            this.doDraw();\n        }\n\n        this.deferOrderedRendering = false;\n\n        if (this.terrainLeft) {\n            drawing += \" -1 \";\n            this.makeCurrent(-1);\n            this.doDraw();\n        }\n        //\n        //console.log(drawing);\n\n        if (this.subsurfaceMode && this.hasStencilBuffer) {\n            this.deferOrderedRendering = true;\n\n            if (this.terrainCenter) {\n                drawing += \" 0 \";\n                this.makeCurrent(0);\n                this.redrawSurface();\n            }\n\n            if (this.terrainRight) {\n                drawing += \" 1 \";\n                this.makeCurrent(1);\n                this.redrawSurface();\n            }\n\n            if (this.terrainLeft) {\n                drawing += \" -1 \";\n                this.makeCurrent(-1);\n                this.redrawSurface();\n            }\n        }\n\n        this.drawScreenRenderables();\n    };\n\n    pick2DContiguous() {\n        if (this.terrainCenter) {\n            this.makeCurrent(0);\n            this.deferOrderedRendering = this.terrainLeft || this.terrainRight;\n            this.doPick();\n        }\n\n        if (this.terrainRight) {\n            this.makeCurrent(1);\n            this.deferOrderedRendering = this.terrainLeft || this.terrainLeft;\n            this.doPick();\n        }\n\n        this.deferOrderedRendering = false;\n\n        if (this.terrainLeft) {\n            this.makeCurrent(-1);\n            this.doPick();\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    drawLayers(accumulateOrderedRenderables) {\n        // Draw all the layers attached to this WorldWindow.\n\n        var beginTime = Date.now(),\n            dc = this.drawContext,\n            layers = dc.layers,\n            layer;\n\n        dc.accumulateOrderedRenderables = accumulateOrderedRenderables;\n\n        for (var i = 0, len = layers.length; i < len; i++) {\n            layer = layers[i];\n            if (layer) {\n                dc.currentLayer = layer;\n                try {\n                    layer.render(dc);\n                } catch (e) {\n                    Logger.log(Logger.LEVEL_SEVERE, \"Error while rendering layer \" + layer.displayName + \".\\n\"\n                        + e.toString());\n                    // Keep going. Render the rest of the layers.\n                }\n            }\n        }\n        dc.currentLayer = null;\n        var now = Date.now();\n        dc.frameStatistics.layerRenderingTime = now - beginTime;\n    };\n\n    /**\n     * Adds a specified layer to the end of this WorldWindow.\n     * @param {Layer} layer The layer to add. May be null or undefined, in which case this WorldWindow is not\n     * modified.\n     */\n    addLayer(layer) {\n        if (layer) {\n            this.layers.push(layer);\n        }\n    };\n\n    /**\n     * Removes the first instance of a specified layer from this WorldWindow.\n     * @param {Layer} layer The layer to remove. May be null or undefined, in which case this WorldWindow is not\n     * modified. This WorldWindow is also not modified if the specified layer does not exist in this WorldWindow's\n     * layer list.\n     */\n    removeLayer(layer) {\n        var index = this.indexOfLayer(layer);\n        if (index >= 0) {\n            this.layers.splice(index, 1);\n        }\n    };\n\n    /**\n     * Inserts a specified layer at a specified position in this WorldWindow.\n     * @param {Number} index The index at which to insert the layer. May be negative to specify the position\n     * from the end of the array.\n     * @param {Layer} layer The layer to insert. May be null or undefined, in which case this WorldWindow is not\n     * modified.\n     */\n    insertLayer(index, layer) {\n        if (layer) {\n            this.layers.splice(index, 0, layer);\n        }\n    };\n\n    /**\n     * Returns the index of a specified layer in this WorldWindow.\n     * @param {Layer} layer The layer to search for.\n     * @returns {Number} The index of the specified layer or -1 if it doesn't exist in this WorldWindow.\n     */\n    indexOfLayer(layer) {\n        return this.layers.indexOf(layer);\n    };\n\n    // Internal function. Intentionally not documented.\n    drawSurfaceRenderables() {\n        var dc = this.drawContext,\n            sr;\n\n        dc.reverseSurfaceRenderables();\n\n        while (sr = dc.popSurfaceRenderable()) {\n            try {\n                sr.renderSurface(dc);\n            } catch (e) {\n                Logger.logMessage(Logger.LEVEL_WARNING, \"WorldWindow\", \"drawSurfaceRenderables\",\n                    \"Error while rendering a surface renderable.\\n\" + e.message);\n                // Keep going. Render the rest of the surface renderables.\n            }\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    drawOrderedRenderables() {\n        var beginTime = Date.now(),\n            dc = this.drawContext,\n            or;\n\n        dc.sortOrderedRenderables();\n\n        if (this._orderedRenderingFilters) {\n            for (var f = 0; f < this._orderedRenderingFilters.length; f++) {\n                this._orderedRenderingFilters[f](this.drawContext);\n            }\n        }\n\n        dc.orderedRenderingMode = true;\n\n        while (or = dc.popOrderedRenderable()) {\n            try {\n                or.renderOrdered(dc);\n            } catch (e) {\n                Logger.logMessage(Logger.LEVEL_WARNING, \"WorldWindow\", \"drawOrderedRenderables\",\n                    \"Error while rendering an ordered renderable.\\n\" + e.message);\n                // Keep going. Render the rest of the ordered renderables.\n            }\n        }\n\n        dc.orderedRenderingMode = false;\n        dc.frameStatistics.orderedRenderingTime = Date.now() - beginTime;\n    };\n\n    drawScreenRenderables() {\n        var dc = this.drawContext,\n            or;\n\n        while (or = dc.nextScreenRenderable()) {\n            try {\n                or.renderOrdered(dc);\n            } catch (e) {\n                Logger.logMessage(Logger.LEVEL_WARNING, \"WorldWindow\", \"drawOrderedRenderables\",\n                    \"Error while rendering a screen renderable.\\n\" + e.message);\n                // Keep going. Render the rest of the screen renderables.\n            }\n        }\n    };\n\n    // Internal function. Intentionally not documented.\n    resolveTopPick() {\n        if (this.drawContext.objectsAtPickPoint.objects.length == 0) {\n            return; // nothing picked; avoid calling readPickColor unnecessarily\n        }\n\n        // Make a last reading to determine what's on top.\n\n        var pickedObjects = this.drawContext.objectsAtPickPoint,\n            pickColor = this.drawContext.readPickColor(this.drawContext.pickPoint),\n            topObject = null,\n            terrainObject = null;\n\n        if (pickColor) {\n            // Find the picked object with the top color code and set its isOnTop flag.\n            for (var i = 0, len = pickedObjects.objects.length; i < len; i++) {\n                var po = pickedObjects.objects[i];\n\n                if (po.isTerrain) {\n                    terrainObject = po;\n                }\n\n                if (po.color.equals(pickColor)) {\n                    po.isOnTop = true;\n                    topObject = po;\n\n                    if (terrainObject) {\n                        break; // no need to search for more than the top object and the terrain object\n                    }\n                }\n            }\n\n            // In single-pick mode provide only the top-most object and the terrain object, if any.\n            if (!this.drawContext.deepPicking) {\n                pickedObjects.clear();\n                if (topObject) {\n                    pickedObjects.add(topObject);\n                }\n                if (terrainObject && terrainObject != topObject) {\n                    pickedObjects.add(terrainObject);\n                }\n            }\n        } else {\n            pickedObjects.clear(); // nothing drawn at the pick point\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    resolveTerrainPick() {\n        var pickedObjects = this.drawContext.objectsAtPickPoint,\n            po;\n\n        // Mark the first picked terrain object as \"on top\". The picked object list should contain only one entry\n        // indicating the picked terrain object, but we iterate over the list contents anyway.\n        for (var i = 0, len = pickedObjects.objects.length; i < len; i++) {\n            po = pickedObjects.objects[i];\n            if (po.isTerrain) {\n                po.isOnTop = true;\n                break;\n            }\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    resolveRegionPick() {\n        if (this.drawContext.objectsAtPickPoint.objects.length == 0) {\n            return; // nothing picked; avoid calling readPickColors unnecessarily\n        }\n\n        // Mark every picked object with a color in the pick buffer as \"on top\".\n\n        var pickedObjects = this.drawContext.objectsAtPickPoint,\n            uniquePickColors = this.drawContext.readPickColors(this.drawContext.pickRectangle),\n            po,\n            color;\n\n        for (var i = 0, len = pickedObjects.objects.length; i < len; i++) {\n            po = pickedObjects.objects[i];\n            if (!po) continue;\n            var poColor = po.color.toByteString();\n            color = uniquePickColors[poColor];\n            if (color) {\n                po.isOnTop = true;\n            } else if (po.userObject instanceof SurfaceShape) {\n                // SurfaceShapes ALWAYS get added to the pick list, since their rendering is deferred\n                // until the tile they are cached by is rendered. So a SurfaceShape may be in the pick list\n                // but is not seen in the pick rectangle.\n                //\n                // Remove the SurfaceShape that was not visible to the pick rectangle.\n                pickedObjects.objects.splice(i, 1);\n                i -= 1;\n            }\n        }\n    };\n\n    // Internal. Intentionally not documented.\n    callRedrawCallbacks(stage) {\n        for (var i = 0, len = this._redrawCallbacks.length; i < len; i++) {\n            try {\n                this._redrawCallbacks[i](this, stage);\n            } catch (e) {\n                Logger.log(Logger.LEVEL_SEVERE, \"Exception calling redraw callback.\\n\" + e.toString());\n                // Keep going. Execute the rest of the callbacks.\n            }\n        }\n    };\n\n    /**\n     * Moves this WorldWindow's navigator to a specified location or position.\n     * @param {Location | Position} position The location or position to move the navigator to. If this\n     * argument contains an \"altitude\" property, as {@link Position} does, the end point of the navigation is\n     * at the specified altitude. Otherwise the end point is at the current altitude of the navigator.\n     *\n     * This function uses this WorldWindow's {@link GoToAnimator} property to perform the move. That object's\n     * properties can be specified by the application to modify its behavior during calls to this function.\n     * It's cancel method can also be used to cancel the move initiated by this function.\n     * @param {Function} completionCallback If not null or undefined, specifies a function to call when the\n     * animation completes. The completion callback is called with a single argument, this animator.\n     * @throws {ArgumentError} If the specified location or position is null or undefined.\n     */\n    goTo(position, completionCallback) {\n        this.goToAnimator.goTo(position, completionCallback);\n    };\n\n    /**\n     * Declutters the current ordered renderables with a specified group ID. This function is not called by\n     * applications directly. It's meant to be invoked as an ordered rendering filter in this WorldWindow's\n     * [orderedRenderingFilters]{@link WorldWindow#orderedRenderingFilters} property.\n     * <p>\n     * The function operates by setting the target visibility of occluded shapes to 0 and unoccluded shapes to 1.\n     * @param {DrawContext} dc The current draw context.\n     * @param {Number} groupId The ID of the group to declutter. Must not be null, undefined or 0.\n     * @throws {ArgumentError} If the specified group ID is null, undefined or 0.\n     */\n    declutter(dc, groupId) {\n        if (!groupId) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"declutter\",\n                    \"Group ID is null, undefined or 0.\"));\n        }\n\n        // Collect all the declutterables in the specified group.\n        var declutterables = [];\n        for (var i = 0; i < dc.orderedRenderables.length; i++) {\n            var orderedRenderable = dc.orderedRenderables[i].orderedRenderable;\n            if (orderedRenderable.declutterGroup === groupId) {\n                declutterables.push(orderedRenderable);\n            }\n        }\n\n        // Filter the declutterables by determining which are partially occluded. Since the ordered renderable\n        // list was already sorted from front to back, the front-most will represent an entire occluded group.\n        var rects = [];\n        for (var j = 0; j < declutterables.length; j++) {\n            var declutterable = declutterables[j],\n                screenBounds = declutterable.screenBounds;\n\n            if (screenBounds && screenBounds.intersectsRectangles(rects)) {\n                declutterable.targetVisibility = 0;\n            } else {\n                declutterable.targetVisibility = 1;\n                if (screenBounds) {\n                    rects.push(screenBounds);\n                }\n            }\n        }\n    };\n\n    /**\n     * Computes a ray originating at the eyePoint and extending through the specified point in window\n     * coordinates.\n     * <p>\n     * The specified point is understood to be in the window coordinate system of the WorldWindow, with the origin\n     * in the top-left corner and axes that extend down and to the right from the origin point.\n     * <p>\n     * The results of this method are undefined if the specified point is outside of the WorldWindow's\n     * bounds.\n     *\n     * @param {Vec2} point The window coordinates point to compute a ray for.\n     * @returns {Line} A new Line initialized to the origin and direction of the computed ray, or null if the\n     * ray could not be computed.\n     */\n    rayThroughScreenPoint(point) {\n        if (!point) {\n            throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"WorldWindow\", \"rayThroughScreenPoint\",\n                \"missingPoint\"));\n        }\n\n        // Convert the point's xy coordinates from window coordinates to WebGL screen coordinates.\n        var screenPoint = new Vec3(point[0], this.viewport.height - point[1], 0),\n            nearPoint = new Vec3(0, 0, 0),\n            farPoint = new Vec3(0, 0, 0);\n\n        this.computeViewingTransform(this.scratchProjection, this.scratchModelview);\n        var modelviewProjection = Matrix.fromIdentity();\n        modelviewProjection.setToMultiply(this.scratchProjection, this.scratchModelview);\n        var modelviewProjectionInv = Matrix.fromIdentity();\n        modelviewProjectionInv.invertMatrix(modelviewProjection);\n\n        // Compute the model coordinate point on the near clip plane with the xy coordinates and depth 0.\n        if (!modelviewProjectionInv.unProject(screenPoint, this.viewport, nearPoint)) {\n            return null;\n        }\n\n        // Compute the model coordinate point on the far clip plane with the xy coordinates and depth 1.\n        screenPoint[2] = 1;\n        if (!modelviewProjectionInv.unProject(screenPoint, this.viewport, farPoint)) {\n            return null;\n        }\n\n        var eyePoint = this.scratchModelview.extractEyePoint(new Vec3(0, 0, 0));\n\n        // Compute a ray originating at the eye point and with direction pointing from the xy coordinate on the near\n        // plane to the same xy coordinate on the far plane.\n        var origin = new Vec3(eyePoint[0], eyePoint[1], eyePoint[2]),\n            direction = new Vec3(farPoint[0], farPoint[1], farPoint[2]);\n\n        direction.subtract(nearPoint);\n        direction.normalize();\n\n        return new Line(origin, direction);\n    };\n}\n\nexport default WorldWindow;","const CLICK_DELAY = 200; //ms\nconst CLICK_MIN_TIME = 50; //ms\nconst TYPE_TIMEOUT = 'timeoutClick';\nconst TYPE_COMMON = 'commonClick';\n/**\n * @exports ClickPickController\n */\nclass ClickPickController {\n\t/**\n\t * Constructs a ClickPickController.\n\t * @alias ClickPickController\n\t * @constructor\n\t * @classdesc The ClickPickController\n\t * @param {WorldWindow} wwd The WorldWindow instance.\n\t * @param {Function} cb A callback function to call with the current clicked renderables after mouseUp/touchEnd.\n\t * @param {number} clickDelay Ignore click longer than clickDelay\n\t * @param {number} minClickTime Minimum click time to be registered\n\t * @param {number} clickTimeout After this time will be triggered callback\n\t */\n\tconstructor(wwd, cb, clickDelay = CLICK_DELAY, minClickTime = CLICK_MIN_TIME, clickTimeout) {\n\t\tthis.clickTimeout = clickTimeout;\n\t\tthis.clickDelay = clickDelay;\n\t\tthis.minClickTime = minClickTime;\n        this.mouseDown = false;\n        this.tpCache = [];\n        this.clickTimeoutKey = null;\n\t\tthis.eventListener = this.eventListener.bind(this, wwd, cb);\n\n\t\tconst events = ['mousedown', 'mouseup', 'mousemove', 'touchstart', 'touchend', 'touchmove'];\n\t\tevents.forEach(event => {\n\t\t\twwd.addEventListener(event, this.eventListener);\n\t\t});\n\t}\n\n\teventListener(wwd, cb, event) {\n\t\tswitch (event.type) {\n\t\t\tcase 'touchmove':\n\t\t\t\tthis.onTouchMove(cb, event);\n\t\t\t\treturn;\n\t\t\tcase 'mousemove':\n\t\t\t\tthis.onMouseMove(wwd, cb, event, true);\n\t\t\t\treturn;\n\t\t\tcase 'touchstart':\n                this.onTouchStart(wwd, cb, event);\n                return;\n\t\t\tcase 'mousedown':\n\t\t\t\tthis.onMouseDown(wwd, cb, event);\n\t\t\t\treturn;\n\t\t\tcase 'touchend':\n\t\t\t\tthis.onTouchEnd(wwd, cb, event);\n\t\t\t\treturn;\t\n\t\t\tcase 'mouseup':\n\t\t\t\tthis.onMouseUp(wwd, cb, event);\n\t\t\t\treturn;\n\t\t}\n\t}\n\n\tgetRenderablesByMouse(wwd, cb, event, x, y, type) {\n\t\t\tconst pickList = wwd.pick(wwd.canvasCoordinates(x, y));\n\n\t\t\tif (cb) {\n\t\t\t\tconst timeDiff = this.getClickTime();\n\t\t\t\tcb(pickList, event, x, y, timeDiff, type);\n\t\t\t}\n\t}\n\n\tgetClickTime() {\n\t\tif(this.clickTimeoutKey && this.clickTimeoutKey.time) {\n\t\t\tconst curTime = new Date().getTime();\n\t\t\tconst timeDiff = curTime - this.clickTimeoutKey.time;\n\t\t\treturn timeDiff;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Check if minClickTime is set and if click is longer than it.\n\t */\n\tcouldClick() {\n\t\tif(this.minClickTime && typeof this.minClickTime === 'number') {\n\t\t\tconst timeDiff = this.getClickTime();\n\t\t\tif(timeDiff > this.minClickTime) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n    onClick(wwd, cb, evt, x, y, type) {\n        this.getRenderablesByMouse(wwd, cb, evt, x, y, type);\n    }\n\n\tclearTouchEventCache() {\n\t\tthis.tpCache = [];\n\t}\n\n\tremoveTouchEventByIdentifier(identifier) {\n\t\tthis.tpCache = this.tpCache.filter((ev) => {\n\t\t\treturn ev.identifier !== identifier;\n\t\t});\n    }\n    \n\tcacheEvents(evts) {\n\t\tfor (let i=0; i < evts.length; i++) {\n\t\t\tthis.tpCache.push(evts[i]);\n\t\t}\n    }\n\n    resetClickTimeout() {\n        if(this.clickTimeoutKey && this.clickTimeoutKey.key) {\n            window.clearTimeout(this.clickTimeoutKey.key);\n            this.clickTimeoutKey = null;\n        }\n    }\n\n    setClickTimeout(key) {\n        if(key) {\n            this.clickTimeoutKey = {\n\t\t\t\tkey,\n\t\t\t\ttime: new Date().getTime()\n\t\t\t};\n        }\n    }\n\n    setPointerDownTimeout(wwd, cb, evt) {\n        const clickKey = window.setTimeout(() => {\n\t\t\tthis.resetClickTimeout();\n        }, this.clickDelay);\n\n\t\tthis.setClickTimeout(clickKey);\n\t\t\n\n\t\tif(this.clickTimeout && typeof this.clickTimeout === 'number') {\n\t\t\tlet x,y;\n\t\t\tif(evt.changedTouches && evt.changedTouches.length === 1 && this.clickTimeoutKey) {\n\t\t\t\tx = evt.changedTouches[0].clientX;\n\t\t\t\ty = evt.changedTouches[0].clientY;\n\t\t\t} else {\n\t\t\t\tx = evt.clientX;\n\t\t\t\ty = evt.clientY;\n\t\t\t}\n\n\t\t\twindow.setTimeout(() => {\n\t\t\t\tif(this.couldClick() && this.clickTimeoutKey) {\n\t\t\t\t\tthis.onClick(wwd, cb, evt, x, y, TYPE_TIMEOUT);\n\t\t\t\t}\t\n\t\t\t}, this.clickTimeout);\n\t\n\t\t}\n    }\n\n\tonTouchStart(wwd, cb, evt) {\n        if(this.tpCache.length > 0) {\n\t\t\tfor (let i = 0; i < evt.touches.length; i++) {\n\t\t\t\tthis.removeTouchEventByIdentifier(evt.touches[i].identifier);\n\t\t\t}\n\t\t}\n\t\t// Cache the touch points for later processing of 2-touch pinch/zoom\n\t\tthis.cacheEvents(evt.touches);\n\n        //clear clickTimeoutKey\n        this.resetClickTimeout();\n\n        if(evt.touches.length === 1) {\n            this.setPointerDownTimeout(wwd, cb, evt);\n        }\n\t}\n\tonTouchEnd(wwd, cb, evt) {\n\n\t\t//remove from cache by identifier\t\t\n\t\tfor (let i = 0; i < evt.changedTouches.length; i++) {\n\t\t\tthis.removeTouchEventByIdentifier(evt.changedTouches[i].identifier);\n\t\t}\n\n\t\t//FIX - sometime touchend or touchcancel is not called and touch stick in cache \n\t\tif(evt.touches.length === 0 && this.tpCache.length > 0) {\n\t\t\tthis.clearTouchEventCache();\n        }\n\n        if(evt.changedTouches.length === 1 && this.clickTimeoutKey) {\n\t\t\tconst x = evt.changedTouches[0].clientX;\n\t\t\tconst y = evt.changedTouches[0].clientY;\n\t\t\t//kontrola timeoutu\n\t\t\tif(this.couldClick()) {\n\t\t\t\tthis.onClick(wwd, cb, evt, x, y, TYPE_COMMON);\n\t\t\t}\n\t\t\tthis.resetClickTimeout();\n        }\n\n    }\n    \n\tonTouchMove(cb, event) {\n        //identify touch by one touch\n        if(this.tpCache.length === 1) {\n            this.clearTouchEventCache();\n            this.resetClickTimeout();\n        }\n    }\n\n\tonMouseDown(wwd, cb, evt) {\n        this.resetClickTimeout();\n        this.setPointerDownTimeout(wwd, cb, evt);\n\t}\n\tonMouseUp(wwd, cb, evt) {\n        if(this.clickTimeoutKey) {\n\t\t\tconst x = evt.clientX;\n\t\t\tconst y = evt.clientY;\n\t\t\t//kontrola timeoutu\n\t\t\tif(this.couldClick()) {\n\t\t\t\tthis.onClick(wwd, cb, evt, x, y, TYPE_COMMON);\n\t\t\t}\n\t\t\tthis.resetClickTimeout();\n        }\n    }\n\n\tonMouseMove() {\n        this.resetClickTimeout();\n    }\n}\n\nexport default ClickPickController;","\"use strict\";\r\n\r\nimport WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    BEGAN,\r\n    CHANGED,\r\n    Vec2,\r\n    WWMath\r\n} = WorldWind;\r\n\r\n/**\r\n * Alternative controller for World wind, which controls the globe via user interaction as if the user was moving around\r\n * a different center of the view then the center of the globe.\r\n * Using wheel of the mouse moves the user nearer and further away from the chosen point.\r\n * Using the mouse to move in the x and y moves the camera on the surface of the sphere. After this movement is applied,\r\n *   all the other attributes of the camera are updated so that the camera points in the center of the controller.\r\n * @param worldWindow {WorldWindow} WorldWindow this controller is associated with.\r\n * @param point {Position} The Point which serves as the center of the controller.\r\n * @constructor\r\n */\r\nclass FixedPointController  {\r\n    constructor(worldWindow) {\r\n        /**\r\n         * WorldWindow associated with the current Controller. There is 1:1 relationship between controller and\r\n         * WorldWindow\r\n         * @type {WorldWindow}\r\n         */\r\n        this.worldWindow = worldWindow;\r\n\r\n        /**\r\n         * Internal representation of current location of the viewer.\r\n         * @type {Object}\r\n         */\r\n        this.lookAt = this.worldWindow.navigator;\r\n\r\n        /**\r\n         * Object containing different types of recognizers. This is basically stored for the preparation of the\r\n         * deconstruction of the Controller.\r\n         * @type {Object}\r\n         */\r\n        this.recognizers = {};\r\n\r\n        /**\r\n         * It contains starting point of the users interaction with the globe.\r\n         * @type {Vec2}\r\n         */\r\n        this.lastPoint = new Vec2(0, 0);\r\n\r\n        /**\r\n         * It contains starting range for the case when user starts pinch gesture.\r\n         * @type {Number}\r\n         */\r\n        this.beginRange = 0;\r\n\r\n        this.sign = 1;\r\n    }\r\n\r\n    get navigator() {\r\n        return this.worldWindow.navigator;\r\n    }\r\n\r\n    get globe() {\r\n        return this.worldWindow.globe;\r\n    }\r\n\r\n    handlePanOrDrag (recognizer) {\r\n        var state = recognizer.state,\r\n            speedFactor = 20,\r\n            lookAt = this.lookAt;\r\n\r\n        // Speed should depend on the distance compared to the lastPoint.\r\n\r\n        if (state === BEGAN) {\r\n            this.lastPoint.set(recognizer.clientX, recognizer.clientY);\r\n\r\n            this.previousX = recognizer.clientX;\r\n            this.previousY = recognizer.clientY;\r\n        } else if (state === CHANGED) {\r\n            if((Math.abs(recognizer.clientX - this.previousX) < 1) && (Math.abs(recognizer.clientY - this.previousY) < 1)) {\r\n                this.previousX = recognizer.clientX;\r\n                this.previousY = recognizer.clientY;\r\n\r\n                return;\r\n            }\r\n\r\n            this.previousX = recognizer.clientX;\r\n            this.previousY = recognizer.clientY;\r\n\r\n            var canvas = this.worldWindow.canvas,\r\n                distance = WWMath.max(1, lookAt.range), // The distance should be relevant only with respect to the range object we are using.\r\n                metersPerPixel = WWMath.perspectivePixelSize(canvas.clientWidth, canvas.clientHeight, distance),\r\n                forwardDegrees = ((recognizer.clientX - this.lastPoint[0]) * metersPerPixel / distance) * speedFactor, // 5 is speed factor.\r\n                sideDegrees = ((recognizer.clientY - this.lastPoint[1]) * metersPerPixel / distance) * speedFactor;\r\n\r\n            lookAt.heading += forwardDegrees;\r\n            lookAt.tilt += (sideDegrees * this.sign);\r\n\r\n            this.applyLimits(lookAt);\r\n            this.worldWindow.redraw();\r\n        }\r\n    };\r\n\r\n    handleFling(recognizer) {\r\n    }\r\n\r\n    /**\r\n     * This function handles the behavior of the Navigator on the wheel event. In this case it is zooming in or out from\r\n     * the fixed point.\r\n     * @param recognizer\r\n     */\r\n    handleWheelEvent (event) {\r\n        const lookAt = this.lookAt;\r\n        // Normalize the wheel delta based on the wheel delta mode. This produces a roughly consistent delta across\r\n        // browsers and input devices.\r\n        var normalizedDelta;\r\n        if (event.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {\r\n            normalizedDelta = event.deltaY;\r\n        } else if (event.deltaMode === WheelEvent.DOM_DELTA_LINE) {\r\n            normalizedDelta = event.deltaY * 40;\r\n        } else if (event.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\r\n            normalizedDelta = event.deltaY * 400;\r\n        }\r\n\r\n        // Compute a zoom scale factor by adding a fraction of the normalized delta to 1. When multiplied by the\r\n        // navigator's range, this has the effect of zooming out or zooming in depending on whether the delta is\r\n        // positive or negative, respectfully.\r\n        var scale = 1 + (normalizedDelta / 1000);\r\n\r\n        // Apply the scale to this navigator's properties.\r\n        lookAt.range *= scale;\r\n\r\n        this.applyLimits(lookAt);\r\n        this.worldWindow.redraw();\r\n    };\r\n\r\n    handleRotation(recognizer) {\r\n    }\r\n\r\n    handleTilt(recognizer) {\r\n    }\r\n\r\n    /**\r\n     * Basically it handles a pinch gesture done by touching the screen.\r\n     * @param recognizer\r\n     */\r\n    handlePinch(recognizer) {};\r\n\r\n    /**\r\n     * Heading must always remain in the bounds: -2PI, 2PI\r\n     * Tilt must always remain in the bounds: -PI, PI\r\n     * @param state\r\n     */\r\n    applyLimits(state) {\r\n        if(state.tilt < 0) {\r\n            state.heading -= 180;\r\n            state.tilt = 0 - state.tilt;\r\n            this.sign = -this.sign;\r\n\r\n            if(state.roll === 180) {\r\n                state.roll = 0;\r\n            } else {\r\n                state.roll = 180;\r\n            }\r\n        } else if (state.tilt > 180) {\r\n            state.heading -= 180;\r\n            state.tilt = 180 - (state.tilt - 180);\r\n            this.sign = -this.sign;\r\n\r\n            if(state.roll === 180) {\r\n                state.roll = 0;\r\n            } else {\r\n                state.roll = 180;\r\n            }\r\n        } else if (state.tilt > 100) {\r\n            state.tilt = 100;\r\n        }\r\n\r\n        if(state.heading < 0) {\r\n            state.heading += 360;\r\n        } else if(state.heading > 360) {\r\n            state.heading -= 360;\r\n        }\r\n\r\n        if(state.roll > 180) {\r\n            state.roll -=  180;\r\n        } else if (state.roll < 0) {\r\n            state.roll += 180;\r\n        }\r\n\r\n        if(state.range >= (40 * state.lookAtLocation.altitude)) {\r\n            state.range = 40 * state.lookAtLocation.altitude;\r\n        }\r\n\r\n        if(state.range <= 230000) {\r\n            state.range = 230000;\r\n        }\r\n    };\r\n}\r\n\r\nexport default FixedPointController;","import WorldWind from 'webworldwind-esa';\r\nimport FixedPointController from \"./FixedPointController\";\r\n\r\nconst {\r\n    BasicWorldWindowController\r\n} = WorldWind;\r\n\r\nclass EnabledController extends BasicWorldWindowController {\r\n    constructor(worldWindow) {\r\n        super(worldWindow);\r\n\r\n        this._enabled = true;\r\n        this._isFixed = false;\r\n\r\n        this.fixedController = new FixedPointController(worldWindow);\r\n    }\r\n\r\n    enable() {\r\n        this._enabled = true;\r\n    }\r\n\r\n    disable() {\r\n        this._enabled = false;\r\n    }\r\n\r\n    handlePanOrDrag(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handlePanOrDrag(recognizer);\r\n            } else {\r\n                this.fixedController.handlePanOrDrag(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleFling(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleFling(recognizer);\r\n            } else {\r\n                this.fixedController.handleFling(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handlePinch(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handlePinch(recognizer);\r\n            } else {\r\n                this.fixedController.handlePinch(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleSecondaryDrag(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleSecondaryDrag(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleRotation(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleRotation(recognizer);\r\n            } else {\r\n                this.fixedController.handleRotation(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleTilt(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleTilt(recognizer);\r\n            } else {\r\n                this.fixedController.handleTilt(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleWheelEvent(recognizer) {\r\n        if(this._enabled) {\r\n            if(!this._isFixed) {\r\n                super.handleWheelEvent(recognizer);\r\n            } else {\r\n                this.fixedController.handleWheelEvent(recognizer);\r\n            }\r\n        }\r\n    }\r\n\r\n    applyLimits() {\r\n        if(!this._isFixed) {\r\n            super.applyLimits()\r\n        } else {\r\n            this.fixedController.applyLimits(this.wwd.navigator);\r\n        }\r\n    }\r\n}\r\n\r\nexport default EnabledController;","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    Angle,\r\n    ArcBallCamera,\r\n    WWMath\r\n} = WorldWind;\r\n\r\nclass FreeCamera extends ArcBallCamera {\r\n    constructor(wwd) {\r\n        super(wwd);\r\n\r\n        this._isFixed = false;\r\n    }\r\n\r\n    applyLimits() {\r\n        // Clamp latitude to between -90 and +90, and normalize longitude to between -180 and +180.\r\n        this.position.latitude = WWMath.clamp(this.position.latitude, -90, 90);\r\n        this.position.longitude = Angle.normalizedDegreesLongitude(this.position.longitude);\r\n\r\n        // Clamp altitude to values greater than 0 in order to prevent looking undergound.\r\n        this.position.altitude = WWMath.clamp(this.position.altitude, 0, Number.MAX_VALUE);\r\n\r\n        // Normalize heading to between -180 and +180.\r\n        this.heading = Angle.normalizedDegrees(this.heading);\r\n\r\n        if(!this._isFixed) {\r\n            // Clamp tilt to between 0 and +90 to prevent the viewer from going upside down.\r\n            this.tilt = WWMath.clamp(this.tilt, 0, 90);\r\n        } else {\r\n            this.tilt = WWMath.clamp(this.tilt, 0, 180);\r\n        }\r\n\r\n        // Normalize roll to between -180 and +180.\r\n        this.roll = Angle.normalizedDegrees(this.roll);\r\n    }\r\n}\r\n\r\nexport default FreeCamera;","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    ArgumentError,\r\n    Location,\r\n    Logger,\r\n    Position,\r\n    Vec3\r\n} = WorldWind;\r\n\r\nclass Animator {\r\n    /**\r\n     * Constructs a GoTo animator.\r\n     * @alias GoToAnimator\r\n     * @constructor\r\n     * @classdesc Incrementally and smoothly moves a {@link Navigator} to a specified position.\r\n     * @param {WorldWindow} worldWindow The WorldWindow in which to perform the animation.\r\n     * @throws {ArgumentError} If the specified WorldWindow is null or undefined.\r\n     */\r\n    constructor(worldWindow) {\r\n        if (!worldWindow) {\r\n            throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"GoToAnimator\", \"constructor\",\r\n                \"missingWorldWindow\"));\r\n        }\r\n\r\n        /**\r\n         * The WorldWindow associated with this animator.\r\n         * @type {WorldWindow}\r\n         * @readonly\r\n         */\r\n        this.wwd = worldWindow;\r\n\r\n        /**\r\n         * The frequency in milliseconds at which to animate the position change.\r\n         * @type {Number}\r\n         * @default 20\r\n         */\r\n        this.animationFrequency = 20;\r\n\r\n        /**\r\n         * The animation's duration, in milliseconds. When the distance is short, less than twice the viewport\r\n         * size, the travel time is reduced proportionally to the distance to travel. It therefore takes less\r\n         * time to move shorter distances.\r\n         * @type {Number}\r\n         * @default 3000\r\n         */\r\n        this.travelTime = 3000;\r\n\r\n        /**\r\n         * Indicates whether the current or most recent animation has been cancelled. Use the cancel() function\r\n         * to cancel an animation.\r\n         * @type {Boolean}\r\n         * @default false\r\n         * @readonly\r\n         */\r\n        this.cancelled = false;\r\n    }\r\n\r\n    cancel() {\r\n        this.cancelled = true;\r\n    }\r\n\r\n    /**\r\n     * Moves the navigator to a specified location or position.\r\n     * @param {Location | Position} position The location or position to move the navigator to. If this\r\n     * argument contains an \"altitude\" property, as {@link Position} does, the end point of the navigation is\r\n     * at the specified altitude. Otherwise the end point is at the current altitude of the navigator.\r\n     * @param fromSatellite\r\n     * @param toSatellite\r\n     * @param {Function} completionCallback If not null or undefined, specifies a function to call when the\r\n     * animation completes. The completion callback is called with a single argument, this animator.\r\n     * @throws {ArgumentError} If the specified location or position is null or undefined.\r\n     */\r\n    goTo(position, finalRange, completionCallback) {\r\n        if (!position) {\r\n            throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE, \"GoToAnimator\", \"goTo\",\r\n                \"missingPosition\"));\r\n        }\r\n\r\n        // I need to build a simple navigator, which takes the Great Circle Distance between the current state and\r\n        // the next state and then gradually moves to the new state. It will be done in a simple linear way.\r\n\r\n        // What is the difference between\r\n        const heading = this.wwd.navigator.heading;\r\n        const rotation = this.wwd.navigator.roll;\r\n        const tilt = this.wwd.navigator.tilt;\r\n        const range = finalRange - this.wwd.navigator.range;\r\n        this.finalRange = finalRange;\r\n\r\n        // Get gradually to the range that represents the altitude of the satellite.\r\n\r\n        this.completionCallback = completionCallback;\r\n\r\n        // Reset the cancellation flag.\r\n        this.cancelled = false;\r\n\r\n        this.wwd.navigator.lookAtLocation.altitude = position.altitude || 0;\r\n\r\n        // Capture the target position and determine its altitude.\r\n        this.targetPosition = new Position(position.latitude, position.longitude, this.wwd.navigator.range);\r\n\r\n        // Capture the start position and start time.\r\n        this.startPosition = new Position(\r\n            this.wwd.navigator.lookAtLocation.latitude,\r\n            this.wwd.navigator.lookAtLocation.longitude,\r\n            this.wwd.navigator.lookAtLocation.altitude + this.wwd.navigator.range);\r\n        this.startTime = Date.now();\r\n\r\n        // Determination of the pan and range velocities requires the distance to be travelled.\r\n        var animationDuration = this.travelTime,\r\n            panDistance = Location.greatCircleDistance(this.startPosition, this.targetPosition),\r\n            rangeDistance;\r\n\r\n        // Determine how high we need to go to give the user context. The max altitude computed is approximately\r\n        // that needed to fit the start and end positions in the same viewport assuming a 45 degree field of view.\r\n        var pA = this.wwd.globe.computePointFromLocation(\r\n            this.startPosition.latitude, this.startPosition.longitude, new Vec3(0, 0, 0)),\r\n            pB = this.wwd.globe.computePointFromLocation(\r\n                this.targetPosition.latitude, this.targetPosition.longitude, new Vec3(0, 0, 0));\r\n        this.maxAltitude = pA.distanceTo(pB);\r\n\r\n        // Determine an approximate viewport size in radians in order to determine whether we actually change\r\n        // the range as we pan to the new location. We don't want to change the range if the distance between\r\n        // the start and target positions is small relative to the current viewport.\r\n        var viewportSize = this.wwd.pixelSizeAtDistance(this.startPosition.altitude)\r\n            * this.wwd.canvas.clientWidth / this.wwd.globe.equatorialRadius;\r\n\r\n        if (panDistance <= 2 * viewportSize) {\r\n            // Start and target positions are close, so don't back out.\r\n            this.maxAltitude = this.startPosition.altitude;\r\n        }\r\n\r\n        // We need to capture the time the max altitude is reached in order to begin decreasing the range\r\n        // midway through the animation. If we're already above the max altitude, then that time is now since\r\n        // we don't back out if the current altitude is above the computed max altitude.\r\n        this.maxAltitudeReachedTime = this.maxAltitude <= this.wwd.navigator.range ? Date.now() : null;\r\n\r\n        // Compute the total range to travel since we need that to compute the range velocity.\r\n        // Note that the range velocity and pan velocity are computed so that the respective animations, which\r\n        // operate independently, finish at the same time.\r\n        if (this.maxAltitude > this.startPosition.altitude) {\r\n            rangeDistance = Math.max(0, this.maxAltitude - this.startPosition.altitude);\r\n            rangeDistance += Math.abs(this.targetPosition.altitude - this.maxAltitude);\r\n        } else {\r\n            rangeDistance = Math.abs(this.targetPosition.altitude - this.startPosition.altitude);\r\n        }\r\n\r\n        // Determine which distance governs the animation duration.\r\n        var animationDistance = Math.max(panDistance, rangeDistance / this.wwd.globe.equatorialRadius);\r\n        if (animationDistance === 0) {\r\n            return; // current and target positions are the same\r\n        }\r\n\r\n        if (animationDistance < 2 * viewportSize) {\r\n            // Start and target positions are close, so reduce the travel time based on the\r\n            // distance to travel relative to the viewport size.\r\n            animationDuration = Math.min((animationDistance / viewportSize) * this.travelTime, this.travelTime);\r\n        }\r\n\r\n        // Don't let the animation duration go to 0.\r\n        animationDuration = Math.max(1, animationDuration);\r\n\r\n        // Determine the pan velocity, in radians per millisecond.\r\n        this.panVelocity = panDistance / animationDuration;\r\n\r\n        // Determine the range velocity, in meters per millisecond.\r\n        this.rangeVelocity = rangeDistance / animationDuration; // meters per millisecond\r\n\r\n        this.headingVelocity = heading / animationDuration;\r\n        this.rotationVelocity = rotation / animationDuration;\r\n        this.tiltVelocity = tilt / animationDuration;\r\n        this.rangeVelocity = range / animationDuration;\r\n\r\n        // Set up the animation timer.\r\n        var thisAnimator = this;\r\n        var timerCallback = function () {\r\n            if (thisAnimator.cancelled) {\r\n                if (thisAnimator.completionCallback) {\r\n                    thisAnimator.completionCallback(thisAnimator);\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (thisAnimator.update()) {\r\n                setTimeout(timerCallback, thisAnimator.animationFrequency);\r\n            } else if (thisAnimator.completionCallback) {\r\n                thisAnimator.completionCallback(thisAnimator);\r\n            }\r\n        };\r\n        setTimeout(timerCallback, this.animationFrequency); // invoke it the first time\r\n    };\r\n\r\n    // Intentionally not documented.\r\n    update() {\r\n        // This is the timer callback function. It invokes the range animator and the pan animator.\r\n\r\n        var currentPosition = new Position(\r\n            this.wwd.navigator.lookAtLocation.latitude,\r\n            this.wwd.navigator.lookAtLocation.longitude,\r\n            this.wwd.navigator.range);\r\n\r\n        var continueAnimation = this.updateRange(currentPosition);\r\n        continueAnimation = this.updateLocation(currentPosition) || continueAnimation;\r\n        continueAnimation = this.updateTilt() || continueAnimation;\r\n        continueAnimation = this.updateHeading() || continueAnimation;\r\n        continueAnimation = this.updateRotation() || continueAnimation;\r\n\r\n        this.wwd.redraw();\r\n\r\n        return continueAnimation;\r\n    };\r\n\r\n    updateTilt() {\r\n        this.wwd.navigator.tilt -= this.tiltVelocity;\r\n\r\n        return this.wwd.navigator.tilt > 0;\r\n    }\r\n\r\n    updateHeading() {\r\n        this.wwd.navigator.heading -= this.headingVelocity;\r\n\r\n        return this.wwd.navigator.heading > 0;\r\n    }\r\n\r\n    updateRotation() {\r\n        this.wwd.navigator.roll -= this.rotationVelocity;\r\n\r\n        return this.wwd.navigator.roll > 0;\r\n    }\r\n\r\n    // This breaks something and I have no idea why.\r\n    updateRange() {\r\n        this.wwd.navigator.range -= this.rangeVelocity;\r\n\r\n        return Math.abs(this.finalRange - this.wwd.navigator.range) < 10;\r\n    }\r\n\r\n    // Gradually change the tilt, heading and rotation to 0. Even during the short time.\r\n    // Intentionally not documented.\r\n    updateRange(currentPosition) {\r\n        // This function animates the range.\r\n        var continueAnimation = false,\r\n            nextRange, elapsedTime;\r\n\r\n        // If we haven't reached the maximum altitude, then step-wise increase it. Otherwise step-wise change\r\n        // the range towards the target altitude.\r\n        if (!this.maxAltitudeReachedTime) {\r\n            elapsedTime = Date.now() - this.startTime;\r\n            nextRange = Math.min(this.startPosition.altitude + this.rangeVelocity * elapsedTime, this.maxAltitude);\r\n            // We're done if we get withing 1 meter of the desired range.\r\n            if (Math.abs(this.wwd.navigator.range - nextRange) < 1) {\r\n                this.maxAltitudeReachedTime = Date.now();\r\n            }\r\n            this.wwd.navigator.range = nextRange;\r\n            continueAnimation = true;\r\n        } else {\r\n            elapsedTime = Date.now() - this.maxAltitudeReachedTime;\r\n            if (this.maxAltitude > this.targetPosition.altitude) {\r\n                nextRange = this.maxAltitude - (this.rangeVelocity * elapsedTime);\r\n                nextRange = Math.max(nextRange, this.targetPosition.altitude);\r\n            } else {\r\n                nextRange = this.maxAltitude + (this.rangeVelocity * elapsedTime);\r\n                nextRange = Math.min(nextRange, this.targetPosition.altitude);\r\n            }\r\n            this.wwd.navigator.range = nextRange;\r\n            // We're done if we get withing 1 meter of the desired range.\r\n            continueAnimation = Math.abs(this.wwd.navigator.range - this.targetPosition.altitude) > 1;\r\n        }\r\n\r\n        return continueAnimation;\r\n    };\r\n\r\n    // Intentionally not documented.\r\n    updateLocation(currentPosition) {\r\n        // This function animates the pan to the desired location.\r\n        var elapsedTime = Date.now() - this.startTime,\r\n            distanceTravelled = Location.greatCircleDistance(this.startPosition, currentPosition),\r\n            distanceRemaining = Location.greatCircleDistance(currentPosition, this.targetPosition),\r\n            azimuthToTarget = Location.greatCircleAzimuth(currentPosition, this.targetPosition),\r\n            distanceForNow = this.panVelocity * elapsedTime,\r\n            nextDistance = Math.min(distanceForNow - distanceTravelled, distanceRemaining),\r\n            nextLocation = Location.greatCircleLocation(currentPosition, azimuthToTarget, nextDistance,\r\n                new Location(0, 0)),\r\n            locationReached = false;\r\n\r\n        this.wwd.navigator.lookAtLocation.latitude = nextLocation.latitude;\r\n        this.wwd.navigator.lookAtLocation.longitude = nextLocation.longitude;\r\n\r\n        // We're done if we're within a meter of the desired location.\r\n        if (nextDistance < 1 / this.wwd.globe.equatorialRadius) {\r\n            locationReached = true;\r\n        }\r\n\r\n        return !locationReached;\r\n    };\r\n}\r\n\r\nexport default Animator;","import React, { Component } from 'react';\r\nimport PropTypes from \"prop-types\";\r\nimport WorldWindow from '../../worldwind/WorldWindow';\r\nimport WorldWind from 'webworldwind-esa';\r\nimport ClickPickController from './utils/ClickPickController';\r\nimport {isEqual} from 'lodash';\r\nimport {\r\n    getLayers,\r\n    getLayerKeyFromConfig,\r\n    getLayerIdFromConfig,\r\n    reloadLayersRenderable,\r\n    reloadFootprintLayersRenderable,\r\n    getLayerKeySCIHubResult,\r\n} from './layers';\r\nimport './style.css';\r\nimport EnabledController from \"../../worldwind/EnabledController\";\r\nimport FreeCamera from '../../worldwind/FreeCamera';\r\nimport Animator from '../../worldwind/Animator';\r\n\r\nconst {\r\n    EarthElevationModel\r\n} = WorldWind;\r\n\r\n\r\n/**\r\n * This component displays Web World Wind in the application. In order to decide what will the map look like and what\r\n * should be displayed on top of that it is possible to work with the wwd inside of the copmonentDidMount, where the\r\n * Web World Wind instance is also created.\r\n */\r\nclass Map extends Component {\r\n    static propsTypes = {\r\n        onLayerChanged: PropTypes.func,\r\n        onProductsClick: PropTypes.func,\r\n        searchOnCoords: PropTypes.func,\r\n        layers: PropTypes.array,\r\n        searchLayers: PropTypes.array,\r\n        preventReload: PropTypes.bool,\r\n        time: PropTypes.object, //select time\r\n        currentTime: PropTypes.object, //current time\r\n    }\r\n\r\n    static defaultProps = {    \r\n        onLayerChanged: () => {},\r\n        onProductsClick: () => {},\r\n        searchOnCoords: () => {},\r\n        layers: [],\r\n        searchLayers: null,\r\n    }\r\n    constructor(props){\r\n        super(props);\r\n        this.wwd = null;\r\n        this.wwdCreated = false;\r\n    }\r\n    shouldComponentUpdate(nextProps) {\r\n        const layersChanged = nextProps.layers !== this.props.layers;\r\n        const preventMovingChanged = nextProps.preventReload !== this.props.preventReload;\r\n\r\n        return layersChanged || preventMovingChanged;\r\n    }\r\n    componentDidUpdate (prevProps) {\r\n        const {time, focusedSatellite, currentTime, searchLayers} = this.props;\r\n\r\n        if(focusedSatellite !== prevProps.focusedSatellite) {\r\n            console.log(\"focused satellite changed\", focusedSatellite)\r\n        }\r\n        \r\n        const enabledLayersKeys = this.props.layers.filter(l => !l.disabled);\r\n\r\n        if(prevProps.layers !== this.props.layers || prevProps.searchLayers !== searchLayers) {\r\n            //pridat search\r\n            const prevVisibleLayers = new Set([\r\n                ...prevProps.layers.map((l) => getLayerKeyFromConfig(l)).sort(),\r\n            ])\r\n\r\n            const visibleLayers = new Set([\r\n                ...this.props.layers.map((l) => getLayerKeyFromConfig(l)).sort(),\r\n            ])\r\n            \r\n            // layer ID is composed by layer, satellite, end date, start date\r\n            const prevLayers = new Set([\r\n                ...prevProps.layers.map((l) => getLayerIdFromConfig(l)).sort(),\r\n            ]);\r\n\r\n            const Layers = new Set([\r\n                this.props.layers.map((l) => getLayerIdFromConfig(l)).sort(),\r\n            ])\r\n\r\n            \r\n            if(prevProps.searchLayers) {\r\n                prevVisibleLayers.add(getLayerKeySCIHubResult(prevProps.searchLayers));\r\n                prevLayers.add(getLayerIdFromConfig(prevProps.searchLayers));\r\n            }\r\n\r\n            if(searchLayers) {\r\n                visibleLayers.add(getLayerKeySCIHubResult(searchLayers));\r\n                Layers.add(getLayerIdFromConfig(searchLayers));\r\n            }\r\n            \r\n            // layer ID is composed by layer, satellite, end date, start date\r\n            const disabledPrevLayers = new Set(prevProps.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l)).sort())\r\n            const disabledLayers = new Set(this.props.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l)).sort())\r\n\r\n            const visibilityChanged = !isEqual(prevVisibleLayers, visibleLayers);\r\n            const newlyEnabledLayersKeys = [...visibleLayers].filter(l => !prevVisibleLayers.has(l));\r\n            //check visibility change\r\n            if(visibilityChanged && !newlyEnabledLayersKeys.some(lk => disabledLayers.has(lk))) {\r\n                //visibility changed\r\n                const wwdLayers = getLayers(enabledLayersKeys, time, this.wwd, this.props.onLayerChanged, currentTime, searchLayers);\r\n                this.handleLayers(wwdLayers);\r\n                \r\n                //start loading layer\r\n                //reload only new layers\r\n                \r\n                const newlyEnabledLayersCfg = this.props.layers.filter((cfg) => newlyEnabledLayersKeys.includes(getLayerKeyFromConfig(cfg)));\r\n                reloadLayersRenderable(newlyEnabledLayersCfg, wwdLayers, this.wwd, this.props.onLayerChanged);\r\n            }  else if(!isEqual(disabledPrevLayers, disabledLayers)) {\r\n                //disabled changed\r\n                const disabledLayersKeys = this.props.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l));\r\n                const disabledPrevLayersKeys = prevProps.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l));\r\n                const enabledLayersKeys = this.props.layers.filter(l => !l.disabled).map((l) => getLayerKeyFromConfig(l));\r\n                const newlyEnabledLayersKeys = disabledPrevLayersKeys.filter(l => enabledLayersKeys.includes(l));\r\n                const wwdLayers = getLayers(this.props.layers, time, this.wwd, this.props.onLayerChanged, currentTime, searchLayers);\r\n\r\n                wwdLayers.forEach(l => {\r\n                    if(newlyEnabledLayersKeys.includes(l.displayName)) {\r\n                        l.enabled = true;\r\n                    };\r\n\r\n                    if(disabledLayersKeys.includes(l.displayName)) {\r\n                        l.enabled = false;\r\n                    };\r\n                    //redraw\r\n                    this.wwd.redraw();\r\n                })\r\n            } else if(time.toString() !== prevProps.time.toString() || currentTime.toString() !== prevProps.currentTime.toString()) {\r\n                const notDisabledLayers = this.props.layers.filter(l => !l.disabled);\r\n                const wwdLayers = getLayers(notDisabledLayers, time, this.wwd, this.props.onLayerChanged, currentTime, searchLayers);\r\n                this.handleLayers(wwdLayers);\r\n                \r\n            }\r\n            \r\n            if(!visibilityChanged && !isEqual(prevLayers, Layers)) {\r\n                //layers date changed\r\n                //TODO reload only changed layers\r\n                const wwdLayers = getLayers(enabledLayersKeys, time, this.wwd, this.props.onLayerChanged, currentTime, searchLayers);\r\n                if(!this.props.preventReload) {\r\n                    reloadLayersRenderable(enabledLayersKeys, wwdLayers, this.wwd, this.props.onLayerChanged);\r\n                }\r\n            }\r\n        }\r\n        \r\n        if(prevProps.preventReload !== this.props.preventReload && !this.props.preventReload) {\r\n            const disabledLayersKeys = this.props.layers.filter(l => l.disabled).map((l) => getLayerKeyFromConfig(l));\r\n            const wwdLayers = getLayers(enabledLayersKeys, time, this.wwd, this.props.onLayerChanged, currentTime, searchLayers);\r\n            //dont reload disabled layers\r\n            reloadLayersRenderable(enabledLayersKeys.filter(lk => !disabledLayersKeys.includes(lk)), wwdLayers, this.wwd, this.props.onLayerChanged);\r\n        }\r\n    }\r\n\r\n    handleLayers(nextLayersData = []) {\r\n        if(nextLayersData !== this.wwd.layers) {\r\n            this.wwd.layers = nextLayersData;\r\n            this.wwd.redraw();\r\n        }\r\n\t}\r\n\r\n    longClickHandler(clickedRenderables = [], evt, x, y, time, type) {\r\n        const {searchOnCoords} = this.props;\r\n        const terrainPick = this.wwd.pickTerrain([evt.screenX, evt.screenY]);\r\n        if(type === 'timeoutClick' && terrainPick && terrainPick.objects && terrainPick.objects[0]){\r\n            const terrainCoords = terrainPick.objects[0].position;\r\n            //searchOnCoords\r\n            console.log(terrainCoords);   \r\n            searchOnCoords(terrainCoords);\r\n        }\r\n    }\r\n\r\n    clickHandler(clickedRenderables = [], evt) {\r\n        const renderables = clickedRenderables.objects.filter(r => {\r\n\t\t\treturn !r.isTerrain;\r\n        }).reverse();\r\n        const products = new Set();\r\n\r\n        renderables.forEach(r => {\r\n            // products.add(r.parentLayer.displayName);\r\n            products.add(r.userObject.userProperties.key);\r\n        })\r\n\r\n        if(products.size > 0) {\r\n            this.props.onProductsClick([...products]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * In this method we create the Web World Wind component itself and store it in the state for the later usage.\r\n     */\r\n    componentDidMount(){\r\n        const {time, currentTime, searchLayers} = this.props;\r\n        if(!this.wwdCreated) {\r\n            const elevationModel = new EarthElevationModel();\r\n            this.wwd = new WorldWindow(\"wwd-results\", elevationModel, EnabledController, FreeCamera);\r\n            this.wwd.animator = new Animator(this.wwd);\r\n            this.wwd.deepPicking = true;\r\n\r\n            window.wwd = this.wwd;\r\n            this.pickController = new ClickPickController(this.wwd, this.clickHandler.bind(this));\r\n            this.longClickPickController = new ClickPickController(this.wwd, this.longClickHandler.bind(this), 3000, 1500, 1500);\r\n            this.wwdCreated=true;\r\n            const enabledLayers = this.props.layers.filter(l => !l.disabled);\r\n            const wwdLayers = getLayers(enabledLayers, time, this.wwd, this.props.onLayerChanged, currentTime, searchLayers);\r\n            this.handleLayers(wwdLayers);\r\n            this.props.onWwdCreated(this.wwd);\r\n        }\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div id=\"map\">\r\n                <canvas id=\"wwd-results\" style={{\r\n                    width: \"100%\",\r\n                    height: \"100%\"\r\n                }}></canvas>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Map;","import React from 'react';\r\nimport Presentation from './presentation';\r\nimport select from '../../context/selectors/';\r\nimport {withContext} from '../../context/withContext';\r\nimport {\r\n    updateActiveLayer,\r\n    updateInfoModal,\r\n    setActiveInfoModal,\r\n    setWwd,\r\n    dataUpdateAcquisitionPlan,\r\n    dataAcquisitionPlanSetVisibleCount,\r\n    setComponent,\r\n    clearComponent,\r\n} from '../../context/actions';\r\n\r\nconst WorldWindMap = (props) => {\r\n    const {dispatch, state} = props;\r\n\r\n    const onLayerChanged = (layerKey, change) => {\r\n        if(layerKey && layerKey.layerKey && layerKey.layerKey.indexOf('acquisitionPlans_') === 0) {\r\n            if(change.plans && change.plans.length > 0) {\r\n                change.plans.forEach((url) => {\r\n                    dispatch(dataUpdateAcquisitionPlan(layerKey, change.sat, url, change.update));\r\n                });\r\n            };\r\n\r\n            if(change.hasOwnProperty('count')) {\r\n                dispatch(dataAcquisitionPlanSetVisibleCount(change.sat, change.count));\r\n            }\r\n        } else {\r\n            dispatch(updateActiveLayer(layerKey, change))\r\n        }     \r\n    }\r\n\r\n    const onProductsClick = (products) => {\r\n        const {state} = props;\r\n        const modalKey = products.join(',');\r\n        const modalState = select.rootSelectors.getInfoModal(state, modalKey)\r\n        const open = modalState && modalState.open ? false : true;\r\n        const modalContent = {\r\n            type: 'PRODUCTS',\r\n            products,\r\n            open,\r\n        };\r\n        dispatch(updateInfoModal(modalKey, modalContent));\r\n        dispatch(setActiveInfoModal(modalKey));\r\n    }\r\n\r\n    const searchOnCoords = (coordinates) => {\r\n        const {state} = props;\r\n        const modalKey = `${coordinates.longitude}-${coordinates.latitude}`;\r\n        const modalState = select.rootSelectors.getInfoModal(state, modalKey)\r\n        const open = modalState && modalState.open ? false : true;\r\n        const modalContent = {\r\n            type: 'SEARCH',\r\n            coordinates,\r\n            open,\r\n        };\r\n\r\n        //clear previous state\r\n        dispatch(clearComponent('search'));\r\n\r\n        const geometry = {\r\n            latitude:coordinates.latitude,\r\n            longitude:coordinates.longitude,\r\n            altitude:coordinates.altitude\r\n        }\r\n\r\n        dispatch(setComponent('search', 'geometry', {\r\n            latitude:coordinates.latitude,\r\n            longitude:coordinates.longitude,\r\n            altitude:coordinates.altitude\r\n        }));\r\n        \r\n        // search catalogue\r\n        // dispatch(searchCatalogue(modalKey, modalContent));\r\n\r\n        dispatch(updateInfoModal(modalKey, modalContent));\r\n        dispatch(setActiveInfoModal(modalKey));\r\n    }\r\n\r\n    const onWwdCreated = (wwd) => {\r\n        dispatch(setWwd(wwd));\r\n    };\r\n\r\n    // prevent reloading layers while moving timeline\r\n    const timelineState = select.components.timeline.getSubstate(state);\r\n    const preventReloadLayers = select.rootSelectors.getPreventReloadLayers(state) || timelineState.moving;\r\n    const selectTime = new Date(select.rootSelectors.getSelectTime(state));\r\n    const currentTime = new Date(select.rootSelectors.getCurrentTime(state));\r\n    const focusedSatellite = select.rootSelectors.getFocusedSattelite(state);\r\n    const layers = select.rootSelectors.getActiveLayers(state, selectTime);\r\n    const searchLayers = select.components.search.getSearchLayer(state);\r\n\r\n    return (\r\n        <Presentation \r\n            time={selectTime}\r\n            currentTime={currentTime}\r\n            layers = {layers}\r\n            focusedSatellite = {focusedSatellite}\r\n            onLayerChanged={onLayerChanged}\r\n            onProductsClick={onProductsClick}\r\n            searchOnCoords={searchOnCoords}\r\n            onWwdCreated={onWwdCreated}\r\n            preventReload={preventReloadLayers}\r\n            searchLayers={searchLayers}\r\n            />\r\n    )\r\n}\r\n\r\nexport default withContext(WorldWindMap);","import React from 'react';// import { jsx } from '@emotion/core';\n\nconst SatelliteGroupOption = (props) => {\n  const {\n    children,\n    className,\n    cx,\n    getStyles,\n    Heading,\n    headingProps,\n    label,\n    theme,\n    selectProps,\n    data\n  } = props;\n  return (\n    <div style={getStyles('group', props)} className={cx({ group: true }, className)} >\n      <Heading\n        {...headingProps}\n        selectProps={selectProps}\n        theme={theme}\n        getStyles={getStyles}\n        cx={cx}\n        groupData={data.groupData}\n      >\n        {label}\n      </Heading>\n      <div>\n        {children}\n      </div>\n    </div>\n  );\n};\n\nexport const GroupHeading = (props) => {\n  const { className, cx, getStyles, theme, selectProps, ...cleanProps } = props;\n  return (\n    <div\n      css={getStyles('groupHeading', { theme, ...cleanProps })}\n      className={cx({ 'group-heading': true }, className)}\n      {...cleanProps}\n    />\n  );\n};\n\nexport default SatelliteGroupOption;","import React from 'react';\nimport './loaderStyle.css';\n\nconst Loader = (props) => {\n    return (<div className=\"loader\"></div>);\n}\n\nexport default React.memo(Loader)\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst styles = {\n  container: {},\n\n  badge: {\n    WebkitTransition: 'all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms',\n    MozTransition: 'all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms',\n    msTransition: 'all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms',\n    transition: 'all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms',\n    display: 'inline-block',\n    position: 'absolute',\n    minWidth: '10px',\n    padding: '3px 7px',\n    fontSize: '12px',\n    fontWeight: '700',\n    lineHeight: '1',\n    color: '#fff',\n    textAlign: 'center',\n    whiteSpace: 'nowrap',\n    verticalAlign: 'baseline',\n    backgroundColor: 'rgba(212, 19, 13, 1)',\n    borderRadius: '10px',\n    top: '-1px',\n  },\n};\n\nclass NotificationBadge extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    const badgeStyle = this.merge(styles.badge, this.props.style);\n    const containerStyle = this.merge(styles.container, this.props.containerStyle);\n    const value = this.props.label || this.props.count;\n\n    return (\n      <div style={containerStyle}>\n        <span style={badgeStyle} className={this.props.className}>\n            {value}\n        </span>\n      </div>\n    );\n  }\n\n  merge(obj1, obj2) {\n    const obj = {};\n    for (const attrname1 in obj1) {\n      if (obj1.hasOwnProperty(attrname1)) {\n        obj[attrname1] = obj1[attrname1];\n      }\n    }\n    for (const attrname2 in obj2) {\n      if (obj2.hasOwnProperty(attrname2)) {\n        obj[attrname2] = obj2[attrname2];\n      }\n    }\n    return obj;\n  }\n}\n\nNotificationBadge.propTypes = {\n  containerStyle: PropTypes.object,\n  count: PropTypes.number,\n  label: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n  ]),\n  style: PropTypes.object,\n  className: PropTypes.string,\n  effect: PropTypes.array,\n  fps: PropTypes.number,\n  frameLength: PropTypes.number,\n};\n\nNotificationBadge.defaultProps = {\n  count: 0,\n  style: {},\n  containerStyle: {},\n};\n\nexport default NotificationBadge;","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { components } from 'react-select';\nimport Icon from '../atoms/Icon';\nimport Loader from './Loader';\nimport NotificationBadge from '../NotificationBadge';\n\nconst LayerOption = (props) => {\n    props.innerProps.onClick = props.onClick;\n\n    //TODO extract into file\n    // const maxHeight = '32px'\n\n    // const iconsWrapperStyle = {\n    //     flex: '0 1 auto',\n    //     maxHeight: maxHeight,\n    //     display: 'flex',\n    //     alignItems: 'center',\n    // }\n\n    const dataInfoWrapperStyle = {\n        display: 'flex',\n        justifyContent: 'left',\n        minWidth: '2rem',\n        height: '100%',\n        flex: '0 0 auto',\n        maxHeight: '32px',\n        alignItems: 'center',\n    }\n\n    // const infoIconStyle = css({\n    //     cursor: 'pointer',\n    //     maxWidth: '1.25rem',\n    //     ':hover,:focus': {\n    //         fill: 'rgb(255, 255, 255)',\n    //         stroke: 'rgb(255, 255, 255)',\n    //     }\n    //   })\n\n    const layerLabelStyle = {\n        flex: '1 1 auto',\n        marginLeft: '0.5rem',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n    }\n\n    const badgeLabel = props.data.totalCount === props.data.loadedCount ? props.data.totalCount : `${props.data.loadedCount}/${props.data.totalCount}`\n    const CountBadge = <NotificationBadge label={badgeLabel} style={{position: 'relative'}} containerStyle={{position: 'relative'}}/>;\n    return (\n        <>\n            <components.Option {...props} isFocused={false}>\n                <div style={dataInfoWrapperStyle}>\n                    {!props.data.disabled && props.data.active ? CountBadge : null}\n                </div>\n                <span style={layerLabelStyle}>\n                    {props.data.label}\n                </span>\n                {/* <span style={iconsWrapperStyle}  onClick={(evt) => {evt.preventDefault();evt.stopPropagation();props.onInfoClick(props.data)}}> */}\n                    {/* <Icon icon='info' className='ptr-icon-warning' css={infoIconStyle}/> */}\n                    {/* <Icon icon='warning' className='ptr-icon-warning' style={infoIconStyle}/> */}\n                {/* </span> */}\n            </components.Option>\n            <div style={{position:'relative', height: '1px'}}>\n                {props.data.status === 'loading' ? <Loader lkey={props.data.label}/> : null}\n            </div>\n        </>\n    );\n};\n\nconst CachedLayerOption = React.memo(LayerOption);\n\nconst getLayerOption = (onClick) => {    \n    return (props) => {\n        return <CachedLayerOption {...props} onClick={() => onClick(props.data)} />\n    } \n}\n\nexport {\n    getLayerOption,\n}","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { components } from 'react-select';\nimport Icon from '../atoms/Icon';\nimport Loader from './Loader';\nimport NotificationBadge from '../NotificationBadge';\n\nconst AcquisitionPlanOption = (props) => {\n    props.innerProps.onClick = props.onClick;\n\n    //TODO extract into file\n    // const maxHeight = '32px'\n\n    // const iconsWrapperStyle = {\n    //     flex: '0 1 auto',\n    //     maxHeight: maxHeight,\n    //     display: 'flex',\n    //     alignItems: 'center',\n    // }\n\n    const dataInfoWrapperStyle = {\n        display: 'flex',\n        justifyContent: 'left',\n        minWidth: '2rem',\n        height: '100%',\n        flex: '0 0 auto',\n        maxHeight: '32px',\n        alignItems: 'center',\n    }\n\n    // const infoIconStyle = css({\n    //     cursor: 'pointer',\n    //     maxWidth: '1.25rem',\n    //     ':hover,:focus': {\n    //         fill: 'rgb(255, 255, 255)',\n    //         stroke: 'rgb(255, 255, 255)',\n    //     }\n    //   })\n\n    const layerLabelStyle = {\n        flex: '1 1 auto',\n        marginLeft: '0.5rem',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n    }\n\n    const badgeLabel = `${props.data.loadedCount}`;\n    const CountBadge = <NotificationBadge label={badgeLabel} style={{position: 'relative'}} containerStyle={{position: 'relative'}}/>;\n    return (\n        <>\n            <components.Option {...props} isFocused={false}>\n                <div style={dataInfoWrapperStyle}>\n                    {!props.data.disabled && props.data.active ? CountBadge : null}\n                </div>\n                <span style={layerLabelStyle}>\n                    {props.data.label}\n                </span>\n                {/* <span style={iconsWrapperStyle}  onClick={(evt) => {evt.preventDefault();evt.stopPropagation();props.onInfoClick(props.data)}}> */}\n                    {/* <Icon icon='info' className='ptr-icon-warning' css={infoIconStyle}/> */}\n                    {/* <Icon icon='warning' className='ptr-icon-warning' style={infoIconStyle}/> */}\n                {/* </span> */}\n            </components.Option>\n            <div style={{position:'relative', height: '1px'}}>\n                {props.data.status === 'loading' ? <Loader lkey={props.data.label}/> : null}\n            </div>\n        </>\n    );\n};\n\nconst CachedAcquisitionPlanOption = React.memo(AcquisitionPlanOption);\n\nconst getAcquisitionPlanOption = (onClick) => {    \n    return (props) => {\n        return <CachedAcquisitionPlanOption {...props} onClick={() => {onClick(props.data.satKey)}} />\n    } \n}\n\nexport {\n    getAcquisitionPlanOption,\n}","/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {getLayerOption} from './LayerOption'\nimport {getAcquisitionPlanOption} from './AcquisitionPlanOption'\n\nconst getOption = ({onLayerClick, onAcquisitionPlanClick}) => {    \n    return (props) => {\n        if(props.data.type === 'product') {\n            const Option = getLayerOption(onLayerClick);\n            return <Option {...props} />\n        };\n\n        if(props.data.type === 'acquisitionPlan') {\n            const Option = getAcquisitionPlanOption(onAcquisitionPlanClick);\n            return <Option {...props} />\n        };\n\n        return null;\n    } \n}\n\nexport {\n    getOption,\n}","import React from 'react';\n// this comment tells babel to convert jsx to calls to a function called jsx instead of React.createElement\n/** @jsx jsx */\nimport { css, jsx } from '@emotion/core'\nimport PropTypes from 'prop-types';\nimport { components } from 'react-select';\nimport Loader from './Loader';\n\nimport Icon from '../atoms/Icon';\n\nconst SatelliteGroupHeading = props => {\n    const {\n        className,\n        cx,\n        getStyles,\n        theme,\n        selectProps,\n        groupData,\n        restProps,\n        onClick,\n        onAcquisitionPlanClick,\n      } = props;\n\n    const active = groupData.active;\n    const disabled = groupData.disabled;\n    const activeAPS = groupData.activeAPS;\n    const availableAPS = groupData.availableAPS;\n\n    //TODO -> extract into file\n    const color = 'rgb(189, 189, 189)';\n    const activeColor = 'rgb(93, 93, 253)';\n    const activeGreenColor = '#0f9914';\n    const activeStyle = {\n        color: activeColor,\n        fill: activeColor,\n        stroke: activeColor,\n    }\n\n    const activeAPSStyle = {\n        color: activeGreenColor,\n        fill: activeGreenColor,\n        stroke: activeGreenColor,\n    }\n\n    const satIconStyle = {\n        flex: '1 1 auto',\n        maxWidth: '32px',\n        color,\n        fill: color,\n        ...(active && activeStyle)\n    }\n\n    const labelStyle = {\n        flex: '1 1 auto',\n        marginLeft: '.25rem',\n        fontSize: '1.25rem',\n        color,\n        ...(active && activeStyle)\n    }\n\n    const posIconStyle = {\n        flex: '2 2 auto',\n        maxWidth: '1.25rem',\n        color,\n        fill: color,\n        stroke: color,\n        ...(active && activeStyle)\n    }\n\n    const apsWrapStyle = {\n        flex: '2 2 auto',\n        maxWidth: '1.25rem',\n        maxHeight: '2rem',\n        marginLeft: '0.25rem',\n    }\n\n    const apsIconStyle = {\n        maxWidth: '1.25rem',\n        color,\n        fill: color,\n        stroke: color,\n        '&:hover': activeAPSStyle,\n        ...(activeAPS && activeAPSStyle),\n    }\n    \n    return (\n              <div css={{...getStyles('groupHeading', { theme, ...restProps, disabled }),...(active && activeStyle)}} className={cx({ 'group-heading': true }, `${className || ''} ${active ? 'active' : ''} ${disabled ? 'disabled' : ''}`)} onClick={() => {!disabled && onClick(groupData.value)}} >\n                    <div style={{display: \"flex\",minWidth: '100%'}}>\n                        <Icon icon={groupData.icon} style={satIconStyle}/>\n                        <span style={labelStyle}>\n                            {props.children}\n                        </span>\n                        <Icon icon={'location'} style={posIconStyle}/>\n                        {availableAPS ? <div style={apsWrapStyle} onClick={(e) => {\n                            console.log(\"on click\");\n                            \n                            e.stopPropagation();e.preventDefault();onAcquisitionPlanClick(groupData.value)}\n                            }>\n                            <Icon icon={'clock'} style={apsIconStyle}/>\n                        </div> : null}\n                    </div>\n                    {groupData.loading ? <div style={{minWidth: '100%'}}>\n                        <div style={{position: 'absolute',height: '1px',minWidth: '100%', marginLeft: '-12px'}}>\n                            <Loader lkey={groupData.value}/>\n                        </div>\n                    </div> : null}\n            </div>\n    );\n};\n\nconst getSatelliteGroupHeading = (onClick, onAcquisitionPlanClick) => {\n    return (props) => {\n        return <SatelliteGroupHeading {...props} onAcquisitionPlanClick={onAcquisitionPlanClick} onClick={onClick} />\n    } \n}\nexport default SatelliteGroupHeading;\nexport {\n    getSatelliteGroupHeading,\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport SelectBase, { components } from 'react-select';\nimport SatelliteGroupOption from './SatelliteGroupOption';\nimport {getOption} from './OptionFactory';\nimport {getSatelliteGroupHeading} from './SatelliteGroupHeading';\n\nconst ValueContainer = ({ children, ...props }) => (\n    <components.ValueContainer {...props}><span>Products</span></components.ValueContainer>\n);\n\nconst SelectContainer = ({ children, ...props }) => (\n    // <div onClick={() => {console.log('on click')}}>\n    <div>\n        <components.SelectContainer {...props}>\n            {children}\n        </components.SelectContainer>\n    </div>\n);\n  \nclass Select extends React.PureComponent {\n    static defaultProps = {\n        onLayerClick: () => {},\n        onCollapsClick: () => {},\n        onSatteliteClick: () => {},\n        onAcquisitionPlanClick: () => {},\n    }\n\n    static propTypes = {\n        options: PropTypes.array,\n        open: PropTypes.bool,\n        selectedLayers: PropTypes.array,\n        onLayerClick: PropTypes.func,\n        onInfoClick: PropTypes.func,\n        onCollapsClick: PropTypes.func,\n        onSatteliteClick: PropTypes.func,\n        onAcquisitionPlanClick: PropTypes.func,\n        onReleaseCamera: PropTypes.func,\n        onFixCamera: PropTypes.func,\n    }\n\n    render() {\n        const {open, options, onCollapsClick, onSatteliteClick, maxHeight, onLayerClick, onAcquisitionPlanClick} = this.props;\n\n        // style\n        //TODO -> extract style to file\n        const color = 'rgb(189, 189, 189)';\n        const activeColor = 'rgb(235, 235, 235)';\n        const activeBackgroundColor = 'rgb(93, 93, 253)';\n        const disabledBackgroundColor = 'rgba(175, 175, 179, 0.4)';\n        const disabledActiveBackgroundColor = 'rgba(93, 93, 253, 0.4)';\n        const hoverBackgroundColor = 'rgba(139, 139, 208, 0.6)';\n        // const menuBackgroundColor = 'rgba(42, 46, 52, 0.64)';\n        const menuContainerBackgroundColor = 'rgba(0, 0, 0, 0.7)';\n        const menuBackgroundColor = 'rgba(0, 0, 0, 0.6)';\n        // end style\n\n        const customStyles = {\n            menu: (provided, state) => ({\n              ...provided,\n              backgroundColor: menuBackgroundColor,\n            }),\n            menuList: (provided, state) => ({\n              ...provided,\n              maxHeight: maxHeight,\n            }),\n            container: (provided, state) => ({\n              ...provided,\n              position: 'absolute',\n              top: '0.5rem',\n              left: '0.5rem',\n              width: '200px',\n            }),\n            valueContainer: (provided, state) => ({\n                ...provided,\n                color: 'rgb(237, 237, 237)',\n            }),\n            control: (provided, state) => ({\n                ...provided,\n                backgroundColor: menuContainerBackgroundColor,\n                borderColor: 'rgba(236, 235, 255, 0.66)',\n            }),\n            groupHeading:(provided, state) => {\n                const disabled = state.disabled;\n                const disabledStyle = {\n                    backgroundColor: disabledBackgroundColor,\n                    color: activeColor,\n                    fill: activeColor,\n                    stroke: activeColor,\n                    cursor: 'not-allowed',\n                }\n\n                const style = {\n                    ...provided,\n                    alignItems: 'center',\n                    cursor: 'pointer',\n                    display: 'flex',\n                    flexFlow: 'column',\n                    padding: '0 .75rem',\n                    '&:hover': {\n                        backgroundColor: hoverBackgroundColor\n                    },\n                    ...(disabled && disabledStyle),\n                  }\n\n                  return style;\n            },\n            dropdownIndicator: (provided, state) => {\n                const style = {\n                    ...provided,\n                    cursor: 'pointer',\n                }\n                return style;\n            },\n            option: (provided, state) => {\n\n                const activeStyle = {\n                    backgroundColor: activeBackgroundColor,\n                    color: activeColor,\n                    fill: activeColor,\n                    stroke: activeColor,\n                }\n\n                const disabledStyle = {\n                    backgroundColor: disabledBackgroundColor,\n                    color: activeColor,\n                    fill: activeColor,\n                    stroke: activeColor,\n                    cursor: 'not-allowed',\n                }\n\n                // const disabledActiveStyle = {\n                //     backgroundColor: disabledActiveBackgroundColor,\n                // }\n\n                const active = state.data.active;\n                const disabled = state.data.disabled;\n                const style = {\n                    ...provided,\n                    paddingTop: '0px',\n                    paddingBottom: '0px',\n                    cursor: 'pointer',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'space-between',\n                    color: color,\n                    fill: color,\n                    stroke: color,\n                    ':hover': {\n                        backgroundColor: hoverBackgroundColor\n                    },\n                    ...(active && activeStyle),\n                    // ...(disabled && disabledStyle),\n                    // ...(disabled && active && disabledActiveStyle),\n                  }\n\n                  return style;\n            },\n          }\n\n        const components = {\n            ValueContainer: ValueContainer,\n            Option: getOption({onLayerClick, onAcquisitionPlanClick}),\n            GroupHeading: getSatelliteGroupHeading(onSatteliteClick),\n            Group: SatelliteGroupOption,\n            SelectContainer,\n        }\n\n        return (\n            <SelectBase\n                className={'ptr-satellite-selector'}\n                classNamePrefix={'ptr-select-satellite'}\n                styles={customStyles}\n                hideSelectedOptions={true}\n                title={'Satellites'}\n                components={components}\n                options={options}\n                menuIsOpen={open}\n                closeMenuOnSelect={false}\n                blurInputOnSelect={false}\n                onMenuClose={onCollapsClick}\n                onMenuOpen={onCollapsClick}\n            />\n        );\n    }\n\n}\n\nexport default Select;","import React from 'react';\nimport Presentation from './presentation';\nimport select from '../../context/selectors/';\nimport {withContext} from '../../context/withContext';\nimport {\n    toggleLayer,\n    toggleAcquisitionPlan,\n    updateComponent,\n    toggleSatelliteFocus,\n} from '../../context/actions';\n\nconst SetalliteSelect = (props) => {\n    const {dispatch, state, maxHeight} = props;\n\n    const satelliteSelectState = select.components.satelliteSelect.getSubstate(state);\n    const selectTime = new Date(select.rootSelectors.getSelectTime(state));\n    const sateliteOptions = select.components.satelliteSelect.getSatelitesSelectOptions(state, selectTime);\n\n    const onLayerClick = (evt) => {\n        dispatch(toggleLayer(evt.satKey, evt.id))\n    }\n\n    const onAcquisitionPlanClick = (satKey) => {\n        const {state} = props;\n        dispatch(toggleAcquisitionPlan(state, satKey));\n    }\n\n    const onSatteliteClick = (satKey) => {\n        const {state} = props;\n        dispatch(toggleSatelliteFocus(satKey, state))\n    }\n\n    const onSatelliteCollapsClick = (evt) => {\n        const {state} = props;\n        const satelliteSelectState = select.components.satelliteSelect.getSubstate(state);\n        if(satelliteSelectState.open) {\n            dispatch(updateComponent('satelliteSelect', {open: false}))\n        } else {\n            dispatch(updateComponent('satelliteSelect', {open: true}))\n        }\n    }\n\n    return (\n        <Presentation \n            options={sateliteOptions}\n            open={satelliteSelectState.open}\n            onLayerClick={onLayerClick}\n            onSatteliteClick={onSatteliteClick}\n            onAcquisitionPlanClick={onAcquisitionPlanClick}\n            onCollapsClick={onSatelliteCollapsClick}\n            maxHeight = {maxHeight}\n            />\n    )\n}\n\nexport default withContext(SetalliteSelect);","import React from \"react\";\n\nexport default React.createContext(null);","import React from 'react';\n\nimport hoverContext from '../HoverHandler/context';\n\n\nclass TimelineHover extends React.PureComponent {\n\tstatic contextType = hoverContext;\n\tconstructor (props) {\n\t\tsuper(props);\n\t\tthis.onHover = this.onHover.bind(this);\n\t}\n\n\tonHover(evt) {\n\t\tif(evt) {\n\t\t\tthis.context.onHover('timeline', {\n\t\t\t\tpopup: {\n\t\t\t\t\tx: evt.x,\n\t\t\t\t\ty: evt.y,\n\t\t\t\t\tcontent: this.props.getHoverContent(evt.x, evt.time) || null\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\tthis.context.onHoverOut()\n\t\t}\n\t}\n\n\trender() {\n\t\tconst children = React.Children.map(this.props.children, child =>\n\t\t\tReact.cloneElement(child, { ...child.props,  onHover: this.onHover}));\n\n\t\treturn (<>{children}</>)\n\t}\n\n}\n\nexport default TimelineHover;\n","const getAbsoluteElementPosition = (element) => {\n\tconst rect = element.getBoundingClientRect();\n\tconst docEl = document.documentElement;\n\tconst top = rect.top + window.pageYOffset - docEl.clientTop;\n\tconst left = rect.left + window.pageXOffset - docEl.clientLeft;;\n\n\treturn {\n\t\ttop,\n\t\tleft,\n\t}\n}\n\n//top\nconst getTopPossition = (origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint) => {\n\tconst top = hoveredElemen ? hoveredElemen.getBoundingClientRect().top : origPosY;\n\tconst posY = top - padding - height;\n\tconst topAbsoplute = hoveredElemen ? getAbsoluteElementPosition(hoveredElemen).top : origPosY;\n\tconst posYAbsoplute = topAbsoplute - padding - height;\n\tlet posX;\n\tlet posXIncrement;\n\tswitch (referencePoint) {\n\t\tcase 'center':\n\t\t\tposXIncrement = -(width / 2);\n\t\t\tbreak;\n\t\tcase 'corner':\n\t\t\tposXIncrement = 0; //left top/bottom corner\n\t\t\tbreak;\n\t};\n\n\tconst overflowRight = (origPosX + posXIncrement + width + padding) >  BBox[1];\n\tconst overflowLeft = (origPosX + posXIncrement - padding) <  BBox[3];\n\n\tif(overflowRight) {\n\t\tposX = BBox[1] - padding - width;\n\t} else if(overflowLeft) {\n\t\tposX = BBox[3] + padding;\n\t} else {\n\t\tposX = origPosX + posXIncrement;\n\t}\n\n\tconst boundingRect = [posYAbsoplute, posX + width, posYAbsoplute + height, posX];\n\n\t// return [posX, posY]\n\treturn {\n\t\tposition: {posX: posX - BBox[3], posY: posY},\n\t\tboundingRect,\n\t}\n}\n\n//bottom\nconst getBottomPossition = (origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint) => {\n\tconst bottom = hoveredElemen ? hoveredElemen.getBoundingClientRect().top + hoveredElemen.offsetHeight : origPosY;\n\tconst posY = bottom + padding;\n\tconst bottomAbsoplute = hoveredElemen ? getAbsoluteElementPosition(hoveredElemen).top + hoveredElemen.offsetHeight : origPosY;\n\tconst posYAbsoplute = bottomAbsoplute + padding;\n\tlet posX;\n\tlet posXIncrement;\n\tswitch (referencePoint) {\n\t\tcase 'center':\n\t\t\tposXIncrement = -(width / 2);\n\t\t\tbreak;\n\t\tcase 'corner':\n\t\t\tposXIncrement = 0; //left top/bottom corner\n\t\t\tbreak;\n\t}\n\n\tconst overflowRight = (origPosX + posXIncrement + width + padding) >  BBox[1];\n\tconst overflowLeft = (origPosX + posXIncrement - padding) <  BBox[3];\n\n\tif(overflowRight) {\n\t\tposX = BBox[1] - padding - width;\n\t} else if(overflowLeft) {\n\t\tposX = BBox[3] + padding;\n\t} else {\n\t\tposX = origPosX + posXIncrement;\n\t}\n\n\tconst boundingRect = [posYAbsoplute, posX + width, posYAbsoplute + height, posX];\n\n\treturn {\n\t\tposition: {posX: posX - BBox[3], posY: posY},\n\t\tboundingRect,\n\t}\n}\n\n//right\nconst getRightPossition = (origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint) => {\n\tconst rightAbsoplute = hoveredElemen ? getAbsoluteElementPosition(hoveredElemen).left + hoveredElemen.offsetWidth : origPosX;\n\tconst posXAbsoplute = rightAbsoplute + padding;\n\tlet posY;\n\tlet posYIncrement;\n\tswitch (referencePoint) {\n\t\tcase 'center':\n\t\t\t\tposYIncrement = -(height / 2)\n\t\t\tbreak;\n\t\tcase 'corner':\n\t\t\t\tposYIncrement = 0; //left/right top corner\n\t\t\tbreak;\n\t}\n\n\tconst overflowTop = (origPosY + posYIncrement - padding) <  BBox[0];\n\tconst overflowBottom = (origPosY + posYIncrement + height + padding) >  BBox[2];\n\n\tif(overflowTop) {\n\t\tposY = BBox[0] + padding;\n\t} else if(overflowBottom) {\n\t\tposY = BBox[2] - padding - height;\n\t} else {\n\t\tposY = origPosY + posYIncrement;\n\t}\n\n\tconst boundingRect = [posY + height, posXAbsoplute + width, posY, posXAbsoplute];\n\n\treturn {\n\t\tposition: {posX: posXAbsoplute - BBox[3], posY: posY - BBox[0]},\n\t\tboundingRect,\n\t}\n}\n\n//left\nconst getLeftPossition = (origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint) => {\n\tconst leftAbsoplute = hoveredElemen ? getAbsoluteElementPosition(hoveredElemen).left : origPosX;\n\tconst posXAbsoplute = leftAbsoplute - padding - width;\n\tlet posY;\n\tlet posYIncrement;\n\tswitch (referencePoint) {\n\t\tcase 'center':\n\t\t\t\tposYIncrement = -(height / 2)\n\t\t\tbreak;\n\t\tcase 'corner':\n\t\t\t\tposYIncrement = 0; //left/right top corner\n\t\t\tbreak;\n\t}\n\n\tconst overflowTop = (origPosY + posYIncrement - padding) <  BBox[0];\n\tconst overflowBottom = (origPosY + posYIncrement + height + padding) >  BBox[2];\n\n\tif(overflowTop) {\n\t\tposY = BBox[0] + padding;\n\t} else if(overflowBottom) {\n\t\tposY = BBox[2] - padding - height;\n\t} else {\n\t\tposY = origPosY + posYIncrement;\n\t}\n\n\tconst boundingRect = [posY + height, posXAbsoplute + width, posY, posXAbsoplute];\n\n\treturn {\n\t\tposition: {posX: posXAbsoplute - BBox[3], posY: posY - BBox[0]}, //relative to element\n\t\tboundingRect,\n\t}\n}\n\nconst checkBoundatiesConflict = (innerBoundingRect, padding, BBox) => {\n\tconst topInside = innerBoundingRect[0] - padding >= BBox[0];\n\tconst rightInside = innerBoundingRect[1] + padding <= BBox[1];\n\tconst bottomInside = innerBoundingRect[2] + padding <= BBox[2];\n\tconst leftInside = innerBoundingRect[3] - padding >= BBox[3];\n\treturn !(topInside && rightInside && bottomInside && leftInside);\n}\n\nconst getTootlipPosition = (referencePoint, positions, BBox, padding) => {\n    const getPosition = (position, origPosX, origPosY, width, height, hoveredElemen) => {\n        let conflict = true;\n        let pos = null;\n        switch (position) {\n            case 'top':\n                const topPos = getTopPossition(origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint);\n                conflict = checkBoundatiesConflict(topPos.boundingRect, padding, BBox);\n                pos = {\n                    'position': topPos,\n                    conflict\n                }\n                break;\n            case 'bottom':\n                const bottomPos = getBottomPossition(origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint);\n                conflict = checkBoundatiesConflict(bottomPos.boundingRect, padding, BBox);\n                pos = {\n                    'position': bottomPos,\n                    conflict\n                }\n                break;\n            case 'left':\n                const leftPos = getLeftPossition(origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint);\n                conflict = checkBoundatiesConflict(leftPos.boundingRect, padding, BBox);\n                pos = {\n                    'position': leftPos,\n                    conflict\n                }\n                break;\n            case 'right':\n                const rightPos = getRightPossition(origPosX, origPosY, width, height, hoveredElemen, padding, BBox, referencePoint);\n                conflict = checkBoundatiesConflict(rightPos.boundingRect, padding, BBox);\n                pos = {\n                    'position': rightPos,\n                    conflict\n                }\n                break;\n            default:\n                break;\n        }\n        return pos;\n    }\n\n    return (origPosX, origPosY, width, height, hoveredElemen) => {\n\n        let validPosition = null;\n\n        for (const position of positions) {\n            const pos = getPosition(position, origPosX, origPosY, width, height, hoveredElemen);\n\n            if(!pos.conflict) {\n                validPosition = {\n                    top: pos.position.position.posY,\n                    left: pos.position.position.posX,\n                    width\n                };\n                break;\n            }\n        }\n\n\n        if(!validPosition) {\n            const pos = getPosition(positions[0], origPosX, origPosY, width, height, hoveredElemen);\n            \n            validPosition = {\n                top: pos.position.position.posY,\n                left: pos.position.position.posX,\n                width\n            };\n        }\n\n        return validPosition;\n    }\n}\n\n\nexport {\n\tgetTootlipPosition,\n\tgetAbsoluteElementPosition,\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {getTootlipPosition} from '../position';\n\nimport './style.css';\n\nconst WIDTH = 250;\nconst HEIGHT = 50;\nconst TOOLTIP_PADDING = 15;\n\nconst getTooltipStyle = () => {\n\t// bbox for tooltip default defined by window\n\tconst windowScrollTop = window.document.documentElement.scrollTop;\n\tconst windowScrollLeft = window.document.documentElement.scrollLeft;\n\tconst windowHeight = window.document.documentElement.clientHeight;\n\tconst windowWidth = window.document.documentElement.clientWidth;\n\tconst windowBBox = [windowScrollTop, windowScrollLeft + windowWidth, windowScrollTop + windowHeight, windowScrollLeft];\n\n\treturn getTootlipPosition('corner', ['right', 'left', 'top', 'bottom'], windowBBox, TOOLTIP_PADDING);\n}\n\nclass Popup extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\tx: PropTypes.number,\n\t\ty: PropTypes.number,\n\t\tmaxX: PropTypes.number,\n\t\tcontent: PropTypes.element,\n\t\tgetStyle: PropTypes.func,\n\t\thoveredElemen: PropTypes.oneOfType([\n\t\t\tPropTypes.element,\n\t\t\tPropTypes.object,\n\t\t  ]),\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.ref = React.createRef();\n\t}\n\n\trender() {\n\t\tlet posX = this.props.x;\n\t\tlet posY = this.props.y;\n\n\t\tlet width = this.ref.current && this.ref.current.offsetWidth ? this.ref.current.offsetWidth : WIDTH;\n\t\tlet height = this.ref.current && this.ref.current.offsetHeight ? this.ref.current.offsetHeight : HEIGHT;\n\n\t\tlet style;\n\n\t\tif(typeof this.props.getStyle === 'function' && this.props.hoveredElemen) {\n\t\t\tstyle = this.props.getStyle()(posX, posY, width, height, this.props.hoveredElemen);\n\t\t} else {\n\t\t\t//right corner on mouse position\n\t\t\tstyle = getTooltipStyle()(posX, posY, width, height);\n\t\t}\n\n\t\treturn (\n\t\t\t<div style={style} className={\"ptr-popup\"} ref={this.ref}>\n\t\t\t\t{this.props.content ? React.cloneElement(this.props.content) : this.props.children}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Popup;\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport _ from 'lodash';\n\nimport HoverContext from './context';\nimport Popup from \"./Popup/Popup\";\n\nclass HoverHandler extends React.PureComponent {\n\tstatic propTypes = {\n\t\tgetStyle: PropTypes.func,\n\t}\n\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.ref = React.createRef();\n\t\tthis.state = {\n\t\t\thoveredItems: null,\n\t\t\tpopup: null\n\t\t};\n\n\t\tthis.onHover = this.onHover.bind(this);\n\t\tthis.onHoverOut = this.onHoverOut.bind(this);\n\t}\n\n\tonHover(hoveredItems, options) {\n\t\tlet update = {};\n\n\t\tif (hoveredItems) {\n\t\t\tupdate.hoveredItems = hoveredItems;\n\t\t}\n\n\t\tif (options && options.popup) {\n\t\t\tupdate.popup = options.popup;\n\t\t}\n\n\t\tif (!_.isEmpty(update)) {\n\t\t\tthis.setState(update);\n\t\t}\n\t}\n\n\tonHoverOut() {\n\t\tthis.setState({\n\t\t\thoveredItems: null,\n\t\t\tpopup: null\n\t\t});\n\t}\n\n\trender() {\n\t\tconst {children} = this.props;\n\t\tconst {popup, hoveredItems} = this.state;\n\t\treturn (\n\t\t\t<HoverContext.Provider value={{\n\t\t\t\thoveredItems: hoveredItems,\n\t\t\t\tonHover: this.onHover,\n\t\t\t\tonHoverOut: this.onHoverOut\n\t\t\t}}>\n\t\t\t\t<div ref={this.ref} style={{height: '100%',width: '100%'}}>\n\t\t\t\t\t{children}\n\t\t\t\t\t{popup ? this.renderPopup() : null}\n\t\t\t\t</div>\n\t\t\t</HoverContext.Provider>\n\t\t);\n\t}\n\n\trenderPopup() {\n\t\tconst {getStyle} = this.props;\n\t\tconst {popup} = this.state;\n\n\t\treturn <Popup\n\t\t\t\t\tx={popup.x}\n\t\t\t\t\ty={popup.y}\n\t\t\t\t\tcontent={popup.content}\n\t\t\t\t\tgetStyle={getStyle}\n\t\t\t\t\thoveredElemen={this.ref.current}\n\t\t\t\t/>\n\t}\n}\n\nexport default HoverHandler;\n","import React from 'react';\nimport './picker.css';\nimport PropTypes from 'prop-types';\n\nclass Picker extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\twidth: PropTypes.number\n\t};\n\n\trender() {\n\t\tconst {width, height, vertical} = this.props;\n\t\tconst indicatorWidth = 10;\n\t\tif (width) {\n\t\t\tconst position = width / 2;\n\t\t\tconst x = vertical ? 0 : position - indicatorWidth;\n\t\t\tconst y = vertical ? position - indicatorWidth : 0;\n\t\t\tconst eHeight = vertical ? indicatorWidth * 2 + 1 : height;\n\t\t\tconst eWidth = vertical ? height : indicatorWidth * 2 + 1;\n\n\t\t\treturn (\n\t\t\t\t<g\n\t\t\t\t\tclassName=\"ptr-timeline-picker\"\n\t\t\t\t>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tx={x}\n\t\t\t\t\t\twidth={eWidth}\n\t\t\t\t\t\ty={y}\n\t\t\t\t\t\theight={eHeight}\n\t\t\t\t\t/>\n\t\t\t\t\t<line\n\t\t\t\t\t\tx1={vertical ? 0 : position + 0.5}\n\t\t\t\t\t\tx2={vertical ? height : position + 0.5}\n\t\t\t\t\t\ty1={vertical ? position + 0.5 : 0}\n\t\t\t\t\t\ty2={vertical ? position + 0.5 : height}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n}\n\nPicker.propTypes = {\n\theight: PropTypes.number,\n\twidth: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nPicker.defaultProps = {\n\tvertical: false,\n}\n\nexport default Picker;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css'\n\nconst Mouse = (props) => {\n\tconst {mouseX, mouseBufferWidth, height, vertical} = props;\n\tif (mouseX) {\n\t\tconst x = vertical ? 0 : mouseX - mouseBufferWidth;\n\t\tconst y = vertical ? mouseX - mouseBufferWidth : 0;\n\t\tconst eHeight = vertical ? mouseBufferWidth * 2 + 1 : height;\n\t\tconst width = vertical ? height : mouseBufferWidth * 2 + 1;\n\n\t\treturn (\n\t\t\t<g\n\t\t\t\tclassName=\"ptr-timeline-mouse\"\n\t\t\t>\n\t\t\t\t<rect\n\t\t\t\t\tx={x}\n\t\t\t\t\twidth={width}\n\t\t\t\t\ty={y}\n\t\t\t\t\theight={eHeight}\n\t\t\t\t/>\n\t\t\t\t<line\n\t\t\t\t\tx1={vertical ? 0 : mouseX + 0.5}\n\t\t\t\t\tx2={vertical ? height : mouseX + 0.5}\n\t\t\t\t\ty1={vertical ? mouseX + 0.5 : 0}\n\t\t\t\t\ty2={vertical ? mouseX + 0.5 : height}\n\t\t\t\t/>\n\t\t\t</g>\n\t\t);\n\t} else {\n\t\treturn null;\n\t}\n};\n\nMouse.propTypes = {\n\tmouseX: PropTypes.number,\n\tmouseBufferWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nMouse.defaultProps = {\n\tvertical: false,\n}\n\nexport default Mouse;","import moment from 'moment';\n\nexport const getYears = (start, end) => {\n    const years = [];\n    let current = moment(start);\n\n    while (end > current || current.format('YYYY') === end.format('YYYY')) {\n        years.push({\n            year: current.format('YYYY'),\n            start: (current.format('YYYY') === start.format('YYYY')) ? start : moment(current).startOf('year'),\n            end: (current.format('YYYY') === end.format('YYYY')) ? end : moment(current).endOf('year')\n        });\n        current.add(1,'year');\n    }\n    return years;\n}\nexport const getMonths = (start, end) => {\n    const months = [];\n    let current = moment(start);\n\n    while (end > current || current.format('YYYY-MM') === end.format('YYYY-MM')) {\n        months.push({\n            year: current.format('YYYY'),\n            month: current.format('MM'),\n            start: (current.format('YYYY-MM') === start.format('YYYY-MM')) ? start : moment(current).startOf('month'),\n            end: (current.format('YYYY-MM') === end.format('YYYY-MM')) ? end : moment(current).endOf('month')\n        });\n        current.add(1,'month');\n    }\n\n    return months;\n}\n\nexport const getDays = (start, end) => {\n    const days = [];\n    let current = moment(start);\n\n    while (end > current || current.format('D') === end.format('D')) {\n        days.push({\n            year: current.format('YYYY'),\n            month: current.format('MM'),\n            day: current.format('DD'),\n            start: (current.format('YYYY-MM-DD') === start.format('YYYY-MM-DD')) ? start : moment(current).startOf('day'),\n            end: (current.format('YYYY-MM-DD') === end.format('YYYY-MM-DD')) ? end : moment(current).endOf('day')\n        });\n        current.add(1,'day');\n    }\n\n    return days;\n}\n\nexport const getHours = (start, end) => {\n    const hours = [];\n    let current = moment(start);\n\n    while (end > current || current.format('HH') === end.format('HH')) {\n        hours.push({\n            year: current.format('YYYY'),\n            month: current.format('MM'),\n            day: current.format('DD'),\n            hour: current.format('HH'),\n            start: (current.format('YYYY-MM-DD-HH') === start.format('YYYY-MM-DD-HH')) ? start : moment(current).startOf('hour'),\n            end: (current.format('YYYY-MM-DD-HH') === end.format('YYYY-MM-DD-HH')) ? end : moment(current).endOf('hour')\n        });\n        current.add(1,'hour');\n    }\n    return hours;\n}\n\nexport const getMinutes = (start, end) => {\n    const minutes = [];\n    let current = moment(start);\n\n    while (end > current || current.format('mm') === end.format('mm')) {\n        minutes.push({\n            year: current.format('YYYY'),\n            month: current.format('MM'),\n            day: current.format('DD'),\n            hour: current.format('HH'),\n            minute: current.format('mm'),\n            start: (current.format('YYYY-MM-DD-HH-mm') === start.format('YYYY-MM-DD-HH-mm')) ? start : moment(current).startOf('minute'),\n            end: (current.format('YYYY-MM-DD-HH-mm') === end.format('YYYY-MM-DD-HH-mm')) ? end : moment(current).endOf('minute')\n        });\n        current.add(1,'minute');\n    }\n    return minutes;\n}\n\n/**\n * \n * @param {Moment} periodStart - visible periodLimit\n * @param {Moment} periodEnd - visible periodLimit\n * @param {Moment} periodLimitStart - visible periodLimit\n * @param {Moment} periodLimitEnd - visible periodLimit\n */\nexport const getPeriodLimits = (periodStart, periodEnd, periodLimitStart, periodLimitEnd) => {\n    const periodStartMom = moment(periodStart)\n    const periodEndMom = moment(periodEnd)\n    const periodLimitStartMom = moment(periodLimitStart)\n    const periodLimitEndMom = moment(periodLimitEnd)\n\n    const periodLimitsCfg = [];\n\n    if(periodLimitStartMom.isBefore(periodStartMom)) {\n        periodLimitsCfg.push({\n            key: 'before',\n            start: periodLimitStartMom,\n            end: periodStartMom,\n        })\n    }\n\n    if(periodLimitEndMom.isAfter(periodEndMom)) {\n        periodLimitsCfg.push({\n            key: 'after',\n            start: periodEndMom,\n            end: periodLimitEndMom,\n        })\n    }\n\n    return periodLimitsCfg;\n}\n\n/**\n * \n * @param {Moment} periodStart - visible periodLimit\n * @param {Moment} periodEnd - visible periodLimit\n * @param {Array} overlays \n *  overlay.label\n *  overlay.key\n *  overlay.classes\n *  overlay.height\n *  overlay.backdroundColor\n *  overlay.top\n */\nexport const getOverlays = (periodStart, periodEnd, overlays) => {\n    const periodLimitStart = moment(periodStart)\n    const periodLimitEnd = moment(periodEnd)\n    const overlaysCfg = [];\n    for (const overlay of overlays) {\n        const start = moment(overlay.start);\n        const end = moment(overlay.end);\n\n        if(end.isAfter(periodLimitStart) && start.isBefore(periodLimitEnd)) {\n            overlaysCfg.push(\n                {\n                    label: overlay.label,\n                    key: overlay.key,\n                    classes: overlay.classes,\n                    height: overlay.height,\n                    top: overlay.top || 0,\n                    backgound: overlay.backdroundColor,\n                    start: start.isBefore(periodLimitStart) ? periodLimitStart : start,\n                    end: end.isAfter(periodLimitEnd) ? periodLimitEnd : end,\n                }\n            )\n        }\n    }\n    return overlaysCfg;\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {getOverlays} from '../utils/interval';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport moment from 'moment';\nimport './style.css';\n\nconst Overlay = (props) => {\n\tconst {period, overlays, getX, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\t\n\tconst overlaysCfg = getOverlays(periodStart, periodEnd, overlays);\n\n\tconst overlaysElms = _.map(overlaysCfg, overlay => {\n\t\tconst start = getX(overlay.start);\n\t\tconst end = getX(overlay.end);\n\t\tlet label = null\n\t\t\n\t\tconst diff = end-start > 2 ? end-start : 2;\n\t\tconst x = vertical ? overlay.top : start;\n\t\tconst yL = vertical ? start : (overlay.top + overlay.height - 2);\n\t\tconst yR = vertical ? start : overlay.top;\n\t\tconst eHeight = vertical ? diff : overlay.height;\n\t\tconst width = vertical ? overlay.height : diff;\n\n\t\t//TODO - solve label in vertical\n\t\tif(overlay.label && !vertical) {\n\t\t\tlabel = (\n\t\t\t\t<text\n\t\t\t\t\tx={x}\n\t\t\t\t\ty={yL}\n\t\t\t\t\tclassName=\"ptr-timeline-overlay-label\"\n\t\t\t\t>\n\t\t\t\t\t{overlay.label}\n\t\t\t\t</text>\n\t\t\t);\n\t\t}\n\t\treturn (\n\t\t\t<g\n\t\t\t\tkey={`${overlay.key}`}\n\t\t\t\tclassName={classNames(\"ptr-timeline-overlay\", overlay.classes)}\n\t\t\t>\n\t\t\t\t<rect\n\t\t\t\t\tx={x}\n\t\t\t\t\twidth={width}\n\t\t\t\t\ty={yR}\n\t\t\t\t\theight={eHeight}\n\t\t\t\t\tfill={overlay.backgound}\n\t\t\t\t/>\n\t\t\t\t{label}\n\t\t\t</g>\n\t\t);\n\t});\n\n\treturn (\n\t\t<g>\n\t\t\t{overlaysElms}\n\t\t</g>\n\t);\n};\n\n\nOverlay.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}),\n\tgetX: PropTypes.func,\n\toverlays: PropTypes.array.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nOverlay.defaultProps = {\n\tvertical: false,\n}\n\nexport default Overlay;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {getPeriodLimits} from '../utils/interval';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport moment from 'moment';\nimport './style.css';\n\nclass PeriodLimit extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\tperiodLimit: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}),\n\t\tperiod: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}),\n\t\tgetX: PropTypes.func,\n\t\theight: PropTypes.number,\n\t\tvertical: PropTypes.bool,\n\t};\n\n\tstatic defaultProps = {\n\t\tvertical: false,\n\t};\n\n\trender() {\n\t\tconst {periodLimit, period, getX, height, vertical} = this.props;\n\t\tconst periodStart = moment(periodLimit.start);\n        const periodEnd = moment(periodLimit.end);\n\t\tconst periodLimitStart = moment(period.start);\n        const periodLimitEnd = moment(period.end);\n        \n\t\tconst periodLimitCfg = getPeriodLimits(periodStart, periodEnd, periodLimitStart, periodLimitEnd);\n\t\tconst periodLimitsElms = _.map(periodLimitCfg, limit => {\n\t\t\tconst start = getX(limit.start);\n\t\t\tconst end = getX(limit.end);\n\t\t\t\n\t\t\tconst x = vertical ? 0 : start;\n\t\t\tconst y = vertical ? start : 0;\n\t\t\tconst eHeight = vertical ? end-start : height;\n\t\t\tconst width = vertical ? height : end-start;\n            \n\t\t\treturn (\n\t\t\t\t<g\n\t\t\t\t\tkey={`${limit.key}`}\n\t\t\t\t\tclassName={classNames(\"ptr-timeline-periodLimit-limit\")}\n\t\t\t\t>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tx={x}\n\t\t\t\t\t\twidth={width}\n\t\t\t\t\t\ty={y}\n\t\t\t\t\t\theight={eHeight}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t);\n\t\t});\n\n\t\treturn React.createElement('g', null, (<>{periodLimitsElms}</>));\n\t}\n\n}\n\nexport default PeriodLimit;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass TextLabel extends React.PureComponent {\n\n    static propTypes = {\n        label: PropTypes.string.isRequired,\n        className: PropTypes.string,\n        x: PropTypes.number.isRequired,\n        height: PropTypes.number.isRequired,\n        vertical: PropTypes.bool,\n    };\n\n    static defaultProps = {\n        vertical: false,\n        className: '',\n    }\n\n\tconstructor(props){\n        super(props);\n\t\tthis.node = React.createRef();\n        this.state = {\n            elHeight: 0,\n            elWidth: 0,\n        };\n    }\n    \n    componentDidMount() {\n        const elHeight = this.node.current.getBoundingClientRect().height;\n        const elWidth = this.node.current.getBoundingClientRect().width;\n        this.setState({elHeight, elWidth});\n    }\n\n\trender() {\n        const {label, vertical, height, x, className} = this.props;\n        const {elHeight, elWidth} = this.state;\n        \n        const xTransform = vertical ? -height + 3 : x + 3;\n        const yTransform = vertical ? x + elHeight + 3 : height - 2;\n        const transform = vertical ? `scale(-1,1)` : '';\n        // const xTransform = vertical ? x + elHeight + 3 : x + 3;\n        // const transform = vertical ? `rotate(270, ${xTransform}, ${height})` : ''\n\t\treturn (\n            <g>\n                <rect \n                    transform={transform}\n                    x={xTransform}\n                    y={yTransform - elHeight + 3}\n                    width={elWidth}\n                    height={elHeight}\n                    style={{stroke: 'none'}}\n                    >\n                </rect>\n                <text\n                    ref={this.node}\n                    transform={transform}\n                    x={xTransform}\n                    y={yTransform}\n                    className={className}>\n                    {label}\n                </text>\n            </g>\n\t\t);\n\t}\n}\n\nexport default TextLabel;\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nexport const D1 = (props) => {\n    const {x, height, vertical} = props;\n    const width = 0.7;\n    const dHeight = height || '100%';\n    return (\n        <line\n            x1={vertical ? 0 : x + width}\n            x2={vertical ? dHeight : x + width}\n            y1={vertical ? x + width : 0 }\n            y2={vertical ? x + width : dHeight }\n            />\n    );\n}\n\nD1.propTypes = {\n\tx: PropTypes.number.isRequired,\n\theight: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nD1.defaultProps = {\n\tvertical: false,\n}\nexport const D2 = (props) => {\n    const {x, height, vertical} = props;\n    const width = 0.7;\n    const dHeight = height || '50%';\n    return (\n        <line\n            x1={vertical ? dHeight : x + width}\n            x2={vertical ? 0 : x + width}\n            y1={vertical ? x + width : 0 }\n            y2={vertical ? x + width : dHeight }\n            />\n    );\n}\n\n\nD2.propTypes = {\n\tx: PropTypes.number.isRequired,\n\theight: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nD2.defaultProps = {\n\tvertical: false,\n}\nexport const D3 = (props) => {\n    const {x, height, vertical} = props;\n    const width = 0.7;\n    const dHeight = height || '33%';\n    return (\n        <line\n            x1={vertical ? 0 : x + width}\n            x2={vertical ? dHeight : x + width}\n            y1={vertical ? x + width : 0 }\n            y2={vertical ? x + width : dHeight }\n            />\n    );\n}\n\nD3.propTypes = {\n\tx: PropTypes.number.isRequired,\n\theight: PropTypes.number,\n\tvertical: PropTypes.bool,\n  }\n\nD3.defaultProps = {\n\tvertical: false,\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1} from '../utils/dash';\n\nconst YearsDash = (props) => {\n\tconst {x, label, vertical} = props;\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-year'}\n\t\t>\n\t\t\t<D1 x={x} vertical={vertical}/>\n\t\t\t{label}\n\t\t</g>\n\t);\n};\n\n\nYearsDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nYearsDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default YearsDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1, D2} from '../utils/dash';\n\nconst MonthDash = (props) => {\n\tconst {x, label, vertical, height} = props;\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-month'}\n\t\t>\n\t\t\t{height === 2 ? <D2 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 1 ? <D1 x={x} vertical={vertical}/> : null}\n\t\t\t{label}\n\t\t</g>\n\t);\n} ;\n\nMonthDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nMonthDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default MonthDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Label from '../utils/textLabel';\nimport YearDash from './YearDash';\nimport MonthDash from '../months/MonthDash';\nimport {getYears, getMonths} from '../utils/interval';\nimport './style.css';\n\nimport _ from 'lodash';\nimport moment from 'moment';\n\nexport const Years = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst yearsCfg = getYears(periodStart, periodEnd);\n\t\n\tconst years = _.map(yearsCfg, year => {\n\t\tlet x = getX(year.start);\n\t\tlet label = <Label label={year.year} vertical={vertical} x={x} height={height} className={'ptr-timeline-year-label'} />\n\t\treturn (<YearDash key={year.year} label={label} x={x} vertical={vertical}/>);\n\t});\n\n\n\tlet months = [];\n\n\t//render every sixth month without label\n\tif(dayWidth > 0.7) {\n\t\tconst monthsCfg = getMonths(periodStart, periodEnd);\n\t\tmonths = _.map(monthsCfg, month => {\n\t\t\tif(month.month === '07') {\n\t\t\t\tlet x = getX(month.start);\n\t\t\t\treturn (<MonthDash key={`${month.year}-${month.month}`} x={x} vertical={vertical}/>);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn (\n\t\t<g className={'levels'}>\n\t\t\t{months}{years.reverse()}\n\t\t</g>\n\t)\n}\n\nYears.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nYears.defaultProps = {\n\tvertical: false,\n}\n\nexport default Years;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Label from '../utils/textLabel';\nimport MonthDash from './MonthDash';\nimport YearDash from '../years/YearDash';\nimport {getYears, getMonths} from '../utils/interval';\nimport './style.css';\n\nimport map from 'lodash/map';\nimport moment from 'moment';\n\nconst Months = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst monthsCfg = getMonths(periodStart, periodEnd);\n\tconst yearsCfg = getYears(periodStart, periodEnd);\n\n\tconst months = map(monthsCfg, month => {\n\t\tif(month.month !== '01') {\n\t\t\tlet x = getX(month.start);\n\t\t\tlet label = null;\n\t\t\tif (dayWidth > 1.5) {\n\t\t\t\tlabel = (\n\t\t\t\t\t<Label label={month.month} vertical={vertical} x={x} height={height} className={'ptr-timeline-month-label'} />\n\t\t\t\t);\n\t\t\t}\n\t\n\t\t\treturn (<MonthDash key={`${month.year}-${month.month}`} x={x} label={label} vertical={vertical} height={2}/>);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\tconst years = map(yearsCfg, year => {\n\t\tlet x = getX(year.start);\n\t\tlet label = <Label label={year.year} vertical={vertical} x={x} height={height} className={'ptr-timeline-year-label'} />\n\t\treturn (<YearDash key={year.year} label={label} x={x} vertical={vertical}/>);\n\t});\n\n\treturn (\n\t\t<g className={'levels'}>\n\t\t\t{months}{years.reverse()}\n\t\t</g>\n\t)\n}\n\n\nMonths.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nMonths.defaultProps = {\n\tvertical: false,\n}\n\nexport default Months;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1, D2, D3} from '../utils/dash';\n\nconst HoursDash = (props) => {\n\tconst {x, label, vertical, height} = props;\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-hour'}\n\t\t>\n\t\t\t{height === 1 ? <D1 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 2 ? <D2 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 3 ? <D3 x={x} vertical={vertical}/> : null}\n\t\t\t{label}\n\t\t</g>\n\t);\n} ;\n\n\nHoursDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nHoursDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default HoursDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1, D2} from '../utils/dash';\n\nconst DaysDash = (props) => {\n\tconst {x, label, vertical, height} = props;\n\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-day'}\n\t\t>\n\t\t\t{height === 1 ? <D1 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 2 ? <D2 x={x} vertical={vertical}/> : null}\n\t\t\t{label}\n\t\t</g>\n\t);\n} ;\n\n\nDaysDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nDaysDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default DaysDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\nimport map from 'lodash/map';\nimport moment from 'moment';\nimport {getYears, getMonths, getDays, getHours} from '../utils/interval';\nimport Label from '../utils/textLabel';\nimport HourDash from '../hours/HourDash';\nimport DayDash from './DayDash';\nimport MonthDash from '../months/MonthDash';\nimport YearDash from '../years/YearDash';\n\nconst Days = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst daysCfg = getDays(periodStart, periodEnd);\n\tconst monthsCfg = getMonths(periodStart, periodEnd);\n\tconst yearsCfg = getYears(periodStart, periodEnd);\n\n\tconst months = map(monthsCfg, month => {\n\t\tif(month.month !== '01') {\n\t\t\tlet x = getX(month.start);\n\t\t\tlet label = (<Label label={month.month} vertical={vertical} x={x} height={height} className={'ptr-timeline-month-label'} />);\n\t\t\treturn (<MonthDash key={`${month.year}-${month.month}`} x={x} label={label} vertical={vertical} height={1}/>);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\tconst years = map(yearsCfg, year => {\n\t\tlet x = getX(year.start);\n\t\tlet label = <Label label={year.year} vertical={vertical} x={x} height={height} className={'ptr-timeline-year-label'} />\n\t\treturn (<YearDash key={year.year} label={label} x={x} vertical={vertical}/>);\n\t});\n\n\tconst days = map(daysCfg, day => {\n\t\tlet x = getX(day.start);\n\t\tlet label = null;\n\t\tif (dayWidth > 17) {\n\t\t\tlabel = (\n\t\t\t\t<Label label={day.day} vertical={vertical} x={x} height={height} className={'ptr-timeline-day-label'} />\n\t\t\t);\n\t\t}\n\t\treturn (<DayDash key={`${day.year}-${day.month}-${day.day}`} label={label} x={x} vertical={vertical} height={2}/>);\n\t});\n\t\n\tlet hours = null;\n\tif (dayWidth > 150) {\n\t\tconst hoursCfg = getHours(periodStart, periodEnd);\n\t\thours = map(hoursCfg, hour => {\n\t\t\tif(hour.hour === '12') {\n\t\t\t\tlet x = getX(hour.start);\n\t\t\t\treturn (<HourDash key={`${hour.year}-${hour.month}-${hour.day}-${hour.hour}`} x={x} vertical={vertical} height={3}/>);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn(\n\t\t<g className={'levels'}>\n\t\t\t{hours}{days}{months}{years.reverse()}\n\t\t</g>\n\t);\n};\n\n\nDays.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nDays.defaultProps = {\n\tvertical: false,\n}\n\n\nexport default Days;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {D1, D2, D3} from '../utils/dash';\n\nconst MinutesDash = (props) => {\n\tconst {x, label, vertical, height} = props;\n\treturn (\n\t\t<g\n\t\t\tclassName={'ptr-timeline-minute'}\n\t\t>\n\t\t\t{height === 1 ? <D1 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 2 ? <D2 x={x} vertical={vertical}/> : null}\n\t\t\t{height === 3 ? <D3 x={x} vertical={vertical}/> : null}\n\t\t\t{label}\n\t\t</g>\n\t);\n} ;\n\nMinutesDash.propTypes = {\n\tx: PropTypes.number.isRequired,\n\tlabel: PropTypes.element,\n\tvertical: PropTypes.bool,\n  }\n\nMinutesDash.defaultProps = {\n\tvertical: false,\n\tlabel: null,\n}\n\nexport default MinutesDash;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport map from 'lodash/map';\nimport moment from 'moment';\nimport {getMinutes, getDays, getHours} from '../utils/interval';\nimport Label from '../utils/textLabel';\nimport MinuteDash from '../minutes/MinuteDash';\nimport HourDash from './HourDash';\nimport DayDash from '../days/DayDash';\nimport './style.css';\n\nconst Hours = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst hoursCfg = getHours(periodStart, periodEnd);\n\tconst daysCfg = getDays(periodStart, periodEnd);\n\n\tlet days = map(daysCfg, day => {\n\t\tconst x = getX(day.start);\n\t\tconst label = (\n\t\t\t<Label label={day.day} vertical={vertical} x={x} height={height} className={'ptr-timeline-month-label'} />\n\t\t);\n\t\treturn (<DayDash key={`${day.year}-${day.month}-${day.day}`} label={label} x={x} vertical={vertical} height={1}/>);\n\t});\n\n\tlet hours = map(hoursCfg, hour => {\n\t\tlet x = getX(hour.start);\n\n\t\tlet label = null\n\t\tif (dayWidth > 580) {\n\t\t\tlabel = (\n\t\t\t\t<Label label={hour.hour} vertical={vertical} x={x} height={height} className={'ptr-timeline-day-label'} />\n\t\t\t);\n\t\t}\n\n\t\treturn (<HourDash key={`hours-${hour.year}-${hour.month}-${hour.day}-${hour.hour}`} label={label} x={x} vertical={vertical} height={2}/>);\n\t});\n\n\tlet minutes = null;\n\tif (dayWidth > 4000) {\n\t\tconst minutesCfg = getMinutes(periodStart, periodEnd);\n\t\tminutes = map(minutesCfg, minute => {\n\t\t\tif(dayWidth > 7000) {\n\t\t\t\tlet x = getX(minute.start);\n\t\t\t\treturn (<MinuteDash key={`${minute.year}-${minute.month}-${minute.day}-${minute.hour}-${minute.minute}`} x={x} vertical={vertical} height={3}/>);\n\t\t\t} else if(minute.minute === '30') {\n\t\t\t\tlet x = getX(minute.start);\n\t\t\t\treturn (<MinuteDash key={`${minute.year}-${minute.month}-${minute.day}-${minute.hour}-${minute.minute}`} x={x} vertical={vertical} height={3}/>);\n\t\t\t} else if(dayWidth > 6000 && (minute.minute === '15' || minute.minute === '45')) {\n\t\t\t\tlet x = getX(minute.start);\n\t\t\t\treturn (<MinuteDash key={`${minute.year}-${minute.month}-${minute.day}-${minute.hour}-${minute.minute}`} x={x} vertical={vertical} height={3}/>);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t}\n\treturn (\n\t\t<g className={'levels'}>\n\t\t\t{minutes}{hours}{days.reverse()}\n\t\t</g>\n\t)\n}\n\nHours.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nHours.defaultProps = {\n\tvertical: false,\n}\n\nexport default Hours;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport map from 'lodash/map';\nimport moment from 'moment';\nimport {getMinutes, getHours} from '../utils/interval';\nimport Label from '../utils/textLabel';\nimport MinuteDash from './MinuteDash';\nimport HourDash from '../hours/HourDash';\nimport './style.css';\n\nconst Minutes = (props) => {\n\tconst {period, getX, dayWidth, height, vertical} = props;\n\tconst periodStart = moment(period.start);\n\tconst periodEnd = moment(period.end);\n\tconst hoursCfg = getHours(periodStart, periodEnd);\n\tconst minutesCfg = getMinutes(periodStart, periodEnd);\n\n\tlet hours = map(hoursCfg, hour => {\n\t\tlet x = getX(hour.start);\n\t\tconst label = (\n\t\t\t\t<Label label={hour.hour} vertical={vertical} x={x} height={height} className={'ptr-timeline-day-label'} />\n\t\t\t);\n\t\treturn (<HourDash key={`minutes-${hour.year}-${hour.month}-${hour.day}-${hour.hour}`} label={label} x={x} vertical={vertical} height={1}/>);\n\t});\n\n\tconst minutes = map(minutesCfg, minute => {\n\t\tlet x = getX(minute.start);\n\t\tlet label = null\n\t\t\n\t\tif(dayWidth > 20000) {\n\t\t\tlabel = (\n\t\t\t\t<Label label={`${minute.hour} : ${minute.minute}`} vertical={vertical} x={x} height={height} className={'ptr-timeline-day-label'} />\n\t\t\t);\n\t\t}\n\n\t\treturn (<MinuteDash key={`minutes-${minute.year}-${minute.month}-${minute.day}-${minute.hour}-${minute.minute}`} label={label} x={x} vertical={vertical} height={3}/>);\n\t});\n\treturn (\n\t\t<g className={'levels'}>\n\t\t\t{minutes}{hours.reverse()}\n\t\t</g>\n\t)\n}\n\nMinutes.propTypes = {\n    period: PropTypes.shape({\n\t\tstart: PropTypes.string,\n\t\tend: PropTypes.string,\n\t}).isRequired,\n\tgetX: PropTypes.func.isRequired,\n\tdayWidth: PropTypes.number.isRequired,\n\theight: PropTypes.number.isRequired,\n\tvertical: PropTypes.bool,\n  }\n\nMinutes.defaultProps = {\n\tvertical: false,\n}\n\nexport default Minutes;\n","import React, {createContext} from 'react'\r\nexport const Context = createContext({\r\n    updateContext: null,\r\n    width: null,\r\n    height: null,\r\n    getX: null,\r\n    getTime: null,\r\n    centerTime: null,\r\n    centerTimeUtc: null,\r\n    getActiveLevel: null,\r\n    dayWidth: null,\r\n    maxDayWidth: null,\r\n    minDayWidth: null,\r\n    periodLimit: null,\r\n    period: null,\r\n    mouseX: null,\r\n    activeLevel: null,\r\n    periodLimitVisible: null,\r\n    onClick: null,\r\n    onHover: null,\r\n    vertical: null,\r\n    periodLimitOnCenter: null,\r\n    selectMode: null,\r\n    moving: null,\r\n});\r\n\r\nexport const ContextProvider = (props) => {\r\n    // const [state, dispatch] =  React.useReducer(reducer, initialState);\r\n    // const value = {state, dispatch};\r\n    const {children, ...propsWithoutChildren} = props;\r\n    return <Context.Provider value={{...propsWithoutChildren.value}}>{children}</Context.Provider>;\r\n}","import React from 'react';\nimport moment from 'moment';\nimport {Context as TimeLineContext} from './context';\n\n/**\n * \n * @param {Event} evt \n * @param {boolean} vertical \n */\nconst getPageXFromEvent = (evt, vertical = false, targetBoudingBox) => {\n\tlet clientX;\n\tconst touch = (evt.touches && evt.touches[0]) || (evt.changedTouches && evt.changedTouches[0])\n\tconst scrollLeft = window.document.documentElement.scrollLeft;\n\tconst scrollTop = window.document.documentElement.scrollTop;\n\tif(touch) {\n\t\tclientX = vertical ? touch.pageY - scrollTop : touch.pageX - scrollLeft;\n\t} else {\n\t\tclientX = vertical ? evt.pageY - scrollTop : evt.pageX - scrollLeft;\n\t}\n\n\tif(vertical) {\n\t\tclientX = clientX - targetBoudingBox.top;  //y position within the element.\n\t} else {\n\t\tclientX = clientX - targetBoudingBox.left;  //y position within the element.\n\t}\n\n\treturn clientX;\n}\n\nconst calculateEventDistance = (point1, point2) => {\n\treturn Math.hypot(point1.clientX - point2.clientX, point1.clientY - point2.clientY)\n}\n\nconst getPoint = (index, cachedEvents, tpCache, targetTouches) => {\n\tconst identifier = tpCache[index].identifier;\n\tlet evIndex = null;\n\tfor (let i = 0; i < targetTouches.length; i++) {\n\t\tconst equals = targetTouches[i].identifier === identifier;\n\t\tif(equals) {\n\t\t\tevIndex = i;\n\t\t}\n\t}\n\n\tif(evIndex) {\n\t\treturn targetTouches[evIndex]\n\t} else {\n\t\treturn tpCache[index];\n\t}\n}\n\nclass TimelineEventsWrapper extends React.PureComponent {\n\tstatic contextType = TimeLineContext;\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.node = React.createRef();\n\t\tthis._drag = null;\n\t\tthis._lastX = null;\n\t\tthis._mouseDownX = null;\n\t\tthis.decelerating = false;\n\t\tthis._pointerLastX = null;\n\t\tthis.multiplier = 5;\n\t\tthis.friction = 0.91; //default 0.92\n\t\tthis.stopThreshold = 0.3;\n\t\tthis.targetX = 0;\n\t\tthis.trackingPoints = [];\n\t\tthis.decVelX = 0;\n\n\t\tthis.onWheel = this.onWheel.bind(this);\n\t\tthis.onPinch = this.onPinch.bind(this);\n\t\tthis.onDrag = this.onDrag.bind(this);\n\t\tthis.onMouseDown = this.onMouseDown.bind(this);\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.onMouseUp = this.onMouseUp.bind(this);\n\t\tthis.onMouseMove = this.onMouseMove.bind(this);\n\t\tthis.onMouseLeave = this.onMouseLeave.bind(this);\n\t\t\n\t\tthis.start_handler = this.start_handler.bind(this);\n\t\tthis.end_handler = this.end_handler.bind(this);\n\t\tthis.move_handler = this.move_handler.bind(this);\n\n\t\t// Global vars to cache event state\n\t\tthis.tpCache = [];\n\t\tthis.prevDiff = -1;\n\t}\n\tcomponentDidMount() {\n\t\tthis.node.current.addEventListener('touchstart', this.start_handler);\n\t\tthis.node.current.addEventListener('touchmove', this.move_handler);\n\t\tthis.node.current.addEventListener('touchend', this.end_handler);\n\t\tthis.node.current.addEventListener('touchcancel', this.end_handler);\n\t}\n\t\n\tcomponentWillUnmount() {\n\t\tthis.node.current.removeEventListener('touchstart', this.start_handler);\n\t\tthis.node.current.removeEventListener('touchmove', this.move_handler);\n\t\t\n\t\tthis.node.current.removeEventListener('touchend', this.end_handler);\n\t\tthis.node.current.removeEventListener('touchcancel', this.end_handler);\n\t}\n\n\tend_handler(ev) {\n\t\tconst {vertical} = this.context;\n\t\tev.preventDefault();\n\t\tconst clientX = getPageXFromEvent(ev, vertical, this.node.current.getBoundingClientRect());\n\t\t\n\t\t//identify stop touch move by one touch\n\t\tif(ev.changedTouches.length === 1 && this.tpCache.length === 1) {\n\t\t\tthis.onPointerUp(clientX)\n\t\t}\n\n\t\t//remove from cache by identifier\t\t\n\t\tfor (let i = 0; i < ev.changedTouches.length; i++) {\n\t\t\tthis.removeTouchEventByIdentifier(ev.changedTouches[i].identifier);\n\t\t}\n\n\t\t//FIX - sometime touchend or touchcancel is not called and touch stick in cache \n\t\tif(ev.touches.length === 0 && this.tpCache.length > 0) {\n\t\t\tthis.clearTouchEventCache();\n\t\t}\n\t}\n\n\tclearTouchEventCache() {\n\t\tthis.tpCache = [];\n\t}\n\n\tremoveTouchEventByIdentifier(identifier) {\n\t\tthis.tpCache = this.tpCache.filter((ev) => {\n\t\t\treturn ev.identifier !== identifier;\n\t\t});\n\t}\n\n\tcacheEvents(evts) {\n\t\tfor (let i=0; i < evts.length; i++) {\n\t\t\tthis.tpCache.push(evts[i]);\n\t\t}\n\t}\n\n\tstart_handler(ev) {\n\t\tconst {vertical} = this.context;\n\t\t// If the user makes simultaneious touches, the browser will fire a \n\t\t// separate touchstart event for each touch point. Thus if there are \n\t\t// three simultaneous touches, the first touchstart event will have \n\t\t// targetTouches length of one, the second event will have a length \n\t\t// of two, and so on.\n\t\tev.preventDefault();\n\t\tif(this.tpCache.length > 0) {\n\t\t\tfor (let i = 0; i < ev.touches.length; i++) {\n\t\t\t\tthis.removeTouchEventByIdentifier(ev.touches[i].identifier);\n\t\t\t}\n\t\t}\n\t\t// Cache the touch points for later processing of 2-touch pinch/zoom\n\t\tthis.cacheEvents(ev.touches);\n\n\t\t//identify only one touch\n\t\tthis.trackingPoints = [];\n\t\tthis._pointerLastX = null;\n\t\tthis.resetMouseTouchProps();\n\t\tif(this.tpCache.length === 1) {\n\t\t\tconst clientX = getPageXFromEvent(ev, vertical, this.node.current.getBoundingClientRect());\n\t\t\tthis.onPointerDown(clientX);\n\t\t}\n\t   }\n\n\tmove_handler(ev) {\n\t\tconst {vertical} = this.context;\n\t\tev.preventDefault();\n\t\t\n\t\t//identify pinch/zoom touch\n\t\tif(this.tpCache.length === 2) {\n\t\t\tthis.handle_pinch_zoom(ev.touches);\n\t\t}\n\t\t\n\t\t//identify touch by one touch\n\t\tif(this.tpCache.length === 1) {\n\t\t\tconst clientX = getPageXFromEvent(ev, vertical, this.node.current.getBoundingClientRect());\n\t\t\tthis.onPointerMove(clientX);\n\n\t\t\tthis.clearTouchEventCache();\n\t\t\t// Cache the touch points for later processing\n\t\t\tthis.cacheEvents([ev.touches[0]]);\n\t   }\n\t}\n\n\tonPointerMove(clientX) {\n\t\tconst distance = clientX - this._lastX;\n\t\tif(distance !== 0) {\n\t\t\tthis.onDrag({\n\t\t\t\tdistance: Math.abs(distance),\n\t\t\t\tdirection: distance < 0 ? 'future': 'past'\n\t\t\t});\n\t\t\tthis.registerMovements(clientX);\n\t\t}\n\t}\n\n\tsetMoving(moving = false) {\n\t\tconst {updateContext} = this.context;\n\t\tupdateContext({\n\t\t\tmoving: moving,\n\t\t});\n\n\t}\n\n\tonPointerDown(clientX) {\n\t\tthis.setMoving(true);\n\t\tthis._drag = true;\n\t\tthis.trackingPoints = [];\n\t\tthis._lastX = clientX;\n\t\tthis._pointerLastX = clientX;\n\t\tthis._mouseDownX = clientX;\n\t\tthis.addTrackingPoint(this._pointerLastX);\n\t}\n\n\tonPointerUp(clientX) {\n\t\tconst isClick = Math.abs(this._mouseDownX - clientX) < 1;\n\t\tthis.resetMouseTouchProps()\n\t\tif (isClick) {\n\t\t\tthis.onClick(clientX)\n\t\t}\n\n\t\tthis.stopTracking();\n\t}\n\n\t// This is a very basic 2-touch move/pinch/zoom handler that does not include\n\t// error handling, only handles horizontal moves, etc.\n\thandle_pinch_zoom(touches) {\n\t\tconst cachedEvents = [];\n\n\t\tfor(let i = 0; i < touches.length; i++) {\n\t\t\tconst found = this.tpCache.findIndex(e => e.identifier === touches[i].identifier);\n\t\t\tif(found > -1) {\n\t\t\t\tcachedEvents[i] = found;\n\t\t\t}\n\t\t}\n\n\t\tconst prevPoint1 = this.tpCache[0];\n\t\tconst prevPoint2 = this.tpCache[1];\n\t\tconst point1 = getPoint(0, cachedEvents, this.tpCache, touches);\n\t\tconst point2 = getPoint(1, cachedEvents, this.tpCache, touches);\n\t\tconst prevDist = calculateEventDistance(prevPoint1, prevPoint2);\n\t\tconst dist = calculateEventDistance(point1, point2);\n\n\t\tthis.clearTouchEventCache();\n\n\t\t// Cache the touch points for later processing of 2-touch pinch/zoom\n\t\tthis.cacheEvents([point1, point2]);\n\t\tconst targetBox = this.node.current.getBoundingClientRect();\n\t\tconst centerPoint = [((point1.clientX + point2.clientX) / 2) - targetBox.left, ((point1.clientY + point2.clientY) / 2) - targetBox.top];\n\t\tthis.onPinch(dist/prevDist, centerPoint)\n   }\n\n   resetMouseTouchProps() {\n\t\tthis._drag = false;\n\t\tthis._lastX = null;\n\t\tthis._mouseDownX = null;\n   }\n\n\tonMouseUp(e) {\t\t\n\t\tconst {vertical} = this.context;\n\t\tconst clientX = getPageXFromEvent(e, vertical, this.node.current.getBoundingClientRect());\n\t\tthis.onPointerUp(clientX);\n\t}\n\n\tonMouseDown(e) {\n\t\tconst {vertical} = this.context;\n\t\tconst clientX = getPageXFromEvent(e, vertical, this.node.current.getBoundingClientRect());\n\t\tthis.onPointerDown(clientX);\n\t}\n\n\tonClick(clientX) {\n\t\tconst {onClick, getTime} = this.context;\n\n\t\tonClick({\n\t\t\ttype: 'time',\n\t\t\tx: clientX,\n\t\t\ttime: getTime(clientX)\n\t\t})\n\t}\n\n\tonMouseMove(e) {\n\t\tconst {vertical, getTime, updateContext, onHover} = this.context;\n\t\tconst clientX = getPageXFromEvent(e, vertical, this.node.current.getBoundingClientRect());\n\t\n\t\tonHover({\n\t\t\tx: e.pageX,\n\t\t\ty: e.pageY,\n\t\t\ttime: getTime(clientX),\n\t\t\tvertical: vertical\n\t\t})\n\t\t\n\t\tupdateContext({\n\t\t\tmouseX: clientX,\n\t\t\tmouseTime: getTime(clientX).toDate()\n\t\t});\n\t\t\n\t\tif(this._drag) {\n\t\t\tthis.onPointerMove(clientX);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\n\t/**\n\t * When the user drags the timeline, if it is still permitted, it updates the available and visible periodLimit and\n\t * therefore redraws the information.\n\t * @param dragInfo {Object}\n\t * @param dragInfo.distance {Number} Amount of pixels to move in given direction\n\t * @param dragInfo.direction {String} Either past or future. Based on this.\n\t */\n\tonDrag(dragInfo) {\n\t\tconst {dayWidth, periodLimit, period, width, updateContext, periodLimitOnCenter} = this.context;\n\t\tconst allDays = width / dayWidth;\n\t\tconst periodStart = moment(periodLimit.start);\n    \tconst periodEnd = moment(periodLimit.end);\n\t\tlet periodLimitStart =  moment(period.start)\n\t\tlet periodLimitEnd = moment(period.end)\n\t\t\n\t\t//center time\n\t\tconst halfDays = allDays / 2;\n\t\tlet periodLimitCenter = moment(period.end).subtract(halfDays * (60 * 60 * 24 * 1000), 'ms')\n\n    \t// Either add  to start and end.\n\t\tlet daysChange = Math.abs(dragInfo.distance) / dayWidth;\n\t\tif(dragInfo.direction === 'past') {\n\t\t\tperiodLimitStart.subtract(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t    \tperiodLimitEnd.subtract(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t\t\tif(periodLimitOnCenter) {\n\t\t\t\tperiodLimitCenter.subtract(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t\t\t\t\n\t\t\t\tif(periodLimitCenter.isBefore(periodStart)) {\n\t\t\t\t\t//use last periodLimit limit\n\t\t\t\t\tperiodLimitStart = moment(period.start);\n\t\t\t\t\tperiodLimitEnd = moment(period.end);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(periodLimitStart.isBefore(periodStart)) {\n\t\t\t\t\t//use last periodLimit limit\n\t\t\t\t\tperiodLimitStart = moment(period.start);\n\t\t\t\t\tperiodLimitEnd = moment(period.end);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t} else {\n\t\t\tperiodLimitStart.add(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t\t\tperiodLimitEnd.add(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\t\t\tperiodLimitCenter.add(daysChange * (60 * 60 * 24 * 1000), 'ms');\n\n\t\t\tif(periodLimitOnCenter) {\n\t\t\t\tif(periodLimitCenter.isAfter(periodEnd)) {\n\t\t\t\t\t//use last periodLimit limit\n\t\t\t\t\tperiodLimitStart = moment(period.start);\n\t\t\t\t\tperiodLimitEnd = moment(period.end);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(periodLimitEnd.isAfter(periodEnd)) {\n\t\t\t\t\t//use last periodLimit limit\n\t\t\t\t\tperiodLimitStart = moment(period.start);\n\t\t\t\t\tperiodLimitEnd = moment(period.end);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet widthOfTimeline = width;\n\t\t// If the result is smaller than width of the timeline\n\t\tlet widthOfResult = (periodLimitEnd.diff(periodLimitStart, 'ms') / (60 * 60 * 24 * 1000)) * dayWidth;\n\t\t// Make sure that we stay within the limits.\n\t\tif(widthOfResult < widthOfTimeline) {\n\t\t\tlet daysNeededToUpdate = (widthOfTimeline - widthOfResult) / dayWidth;\n\t\t\tif(dragInfo.direction === 'past') {\n\t\t\t\tperiodLimitEnd.add(daysNeededToUpdate * (60 * 60 * 24 * 1000), 'ms');\n\t\t\t} else {\n\t\t\t\tperiodLimitStart.subtract(daysNeededToUpdate * (60 * 60 * 24 * 1000), 'ms');\n\t\t\t}\n\t\t}\n\n\t\tupdateContext({\n\t\t\tperiod: {\n\t\t\t\tend: periodLimitEnd.toDate().toString(),\n\t\t\t\tstart: periodLimitStart.toDate().toString()\n\t\t\t}\n\t\t});\n\t}\n\n\n\t/**\n\t * Handles move events\n\t * @param  {clientX} ev Normalized event\n\t */\n \t registerMovements(clientX) {\n\t\tthis._lastX = clientX;\n\t\tif (this._drag) {\n\t\t\tthis.addTrackingPoint(this._lastX);\n\t\t}\n\n\t\tconst pointerChangeX = this._lastX - this._pointerLastX;\n\n\t\tthis.targetX += pointerChangeX * this.multiplier;\n\n\t\tthis._pointerLastX = this._lastX;\n\t}\n\n\n\t/**\n\t * Records movement for the last 100ms\n\t * @param {number} x\n\t */\n\taddTrackingPoint(x) {\n\t\tconst time = Date.now();\n\t\twhile (this.trackingPoints.length > 0) {\n\t\t\tif (time - this.trackingPoints[0].time <= 100) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.trackingPoints.shift();\n\t\t}\n\n\t\tthis.trackingPoints.push({x, time});\n\t}\n\n\t/**\n\t * Stops movement tracking, starts animation\n\t */\n\tstopTracking() {\n\t\tthis.addTrackingPoint(this._pointerLastX);\n\t\t\n\t\tthis.startDecelAnim();\n\t}\n\n\n    /**\n     * Initialize animation of values coming to a stop\n     */\n    startDecelAnim() {\n\t\tconst firstPoint = this.trackingPoints[0];\n\t\tconst lastPoint = this.trackingPoints[this.trackingPoints.length - 1];\n  \n\t\tconst xOffset = lastPoint.x - firstPoint.x;\n\t\tconst timeOffset = lastPoint.time - firstPoint.time;\n  \n\t\tconst D = (timeOffset / 15) / this.multiplier;\n  \n\t\tthis.decVelX = (xOffset / D) || 0; // prevent NaN\n  \n\t\t//check difference start/stop\n\t\tif ((Math.abs(this.decVelX) > 1)) {\n\t\t\tthis.decelerating = true;\n\t\t\t// end\n\t\t\trequestAnimFrame(() => this.stepDecelAnim());\n\t\t} else {\n\t\t  this.clearScroll()\n\t\t}\n\t}\n\n\n  /**\n   * Animates values slowing down\n   */\n  stepDecelAnim() {\n    if (!this.decelerating) {\n        return;\n    }\n\n    this.decVelX *= this.friction;\n\n    this.targetX += this.decVelX;\n    \n    if (Math.abs(this.decVelX) > this.stopThreshold) {\n\n\t\tthis.onDrag({\n\t\t\tdistance: Math.abs(this.decVelX),\n\t\t\tdirection: this.decVelX < 0 ? 'future': 'past'\n\t\t});\n\n        requestAnimFrame(this.stepDecelAnim.bind(this));\n    } else {\n        this.clearScroll();\n    }\n  }\n\n\tclearScroll() {\n\t\tthis.setMoving(false);\n\t\tthis.decelerating = false;\n\t  }\n\n\tonMouseLeave(e) {\n\t\tconst {onHover, updateContext} = this.context;\n\t\tthis._drag = false;\n\t\tthis._lastX = null;\n\t\tthis._mouseDownX = null;\n\n\t\tonHover(null);\n\n\t\tupdateContext({\n\t\t\tmouseX: null,\n\t\t\tmouseTime: null\n\t\t});\n\n\t}\n\n\t/**\n\t * Based on the amount of pixels the wheel moves update the size of the visible pixels.\n\t * @param e {SyntheticEvent}\n\t *\n\t */\n\tonWheel(e) {\n\t\tconst {dayWidth} = this.context;\n\t\te.preventDefault();\n\t\tlet change;\n\n\t\tif (e.deltaY > 0) {\n\t\t\t// zoom out\n\t\t\tchange = 1 - Math.abs(e.deltaY / (10 * 100));\n\t\t} else {\n\t\t\t// zoom in\n\t\t\tchange = 1 + Math.abs(e.deltaY / (10 * 100));\n\t\t}\n\n\t\tlet newDayWidth = dayWidth * change;\n\t\tthis.zoom(newDayWidth);\n\t}\n\n\tonPinch(scale, point) {\n\t\tconst {vertical, dayWidth} = this.context;\n\t\tlet zoomX;\n\t\tif(vertical) {\n\t\t\tzoomX = point[1];\n\t\t} else {\n\t\t\tzoomX = point[0];\n\t\t}\n\t\t\n\t\tlet change;\n\t\tif (scale === 1) {\n\t\t\tchange = 1;\n\t\t} else if (scale > 1) {\n\t\t\t// zoom out\n\t\t\tchange = 1 + scale / 10;\n\t\t} else {\n\t\t\t// zoom in\n\t\t\tchange = 1 - scale / 10;\n\t\t}\n\n\t\tlet newDayWidth = dayWidth * change;\n\t\tthis.zoom(newDayWidth, zoomX);\n\t}\n\n\tzoom(newDayWidth, x) {\n\t\tconst {mouseX, getTime, updateContext, periodLimit, period, periodLimitOnCenter, selectMode, maxDayWidth, minDayWidth, width} = this.context;\n\t\tconst zoomX = x || mouseX;\n\t\tconst centerX = width/2;\n\t\tconst mouseTime = zoomX ? getTime(zoomX) : getTime(mouseX);\n\t\tconst centerTime = getTime(centerX);\n\t\tconst periodLimitStart =  moment(period.start)\n\t\tconst periodLimitEnd = moment(period.end)\n\n\t\t\n\t\tif(newDayWidth > maxDayWidth) {\n\t\t\tnewDayWidth = maxDayWidth;\n\t\t}\n\n\t\t//don't allow zoom out outside initial zoom\n\t\tif (newDayWidth < minDayWidth) {\n\t\t\tnewDayWidth = minDayWidth;\n\t\t}\n\n\t\tconst allDays = width / newDayWidth;\n\t\tlet start;\n\t\tlet end;\n\t\tlet beforeMouseDays;\n\t\t\n\t\t\n\t\tif(selectMode) {\n\t\t\tbeforeMouseDays = zoomX / newDayWidth;\n\t\t\tstart = moment(mouseTime).subtract(moment.duration(beforeMouseDays * (60 * 60 * 24 * 1000), 'ms'));\n\t\t\tend = moment(start).add(moment.duration(allDays * (60 * 60 * 24 * 1000), 'ms'));\n\t\t} else {\n\t\t\tbeforeMouseDays = centerX / newDayWidth;\n\t\t\tstart = moment(centerTime).subtract(moment.duration(beforeMouseDays * (60 * 60 * 24 * 1000), 'ms'));\n\t\t\tend = moment(start).add(moment.duration(allDays * (60 * 60 * 24 * 1000), 'ms'));\n\t\t}\n\t\t\n\t\tconst center = moment(start).add(moment.duration((allDays / 2) * (60 * 60 * 24 * 1000), 'ms'));\n\t\t\n\t\t//Don't allow zoom center out of periodLimit\n\t\tif(periodLimitOnCenter) {\n\t\t\tif(center.isBefore(periodLimit.start)) {\n\t\t\t\tconst diff = moment(periodLimit.start).diff(center, 'ms');\n\t\t\t\tstart.add(diff, 'ms')\n\t\t\t\tend.add(diff, 'ms')\n\t\t\t}\n\n\t\t\tif(center.isAfter(periodLimit.end)) {\n\t\t\t\tconst diff = moment(periodLimit.end).diff(center, 'ms');\n\t\t\t\tstart.add(diff, 'ms')\n\t\t\t\tend.add(diff, 'ms')\n\t\t\t}\n\t\t} else {\n\t\t\t//Don`t allow show date out of periodLimit\n\t\t\tif(start.isBefore(periodLimit.start)) {\n\t\t\t\tconst diff = moment(periodLimit.start).diff(periodLimitStart, 'ms');\n\t\t\t\tstart.add(diff, 'ms')\n\t\t\t\tend.add(diff, 'ms')\n\t\t\t}\n\n\t\t\tif(end.isAfter(periodLimit.end)) {\n\t\t\t\tconst diff = moment(periodLimit.end).diff(periodLimitEnd, 'ms');\n\t\t\t\tstart.add(diff, 'ms')\n\t\t\t\tend.add(diff, 'ms')\n\t\t\t}\n\t\t}\n\n\t\tupdateContext({\n\t\t\tperiod: {\n\t\t\t\tstart: start.toDate().toString(),\n\t\t\t\tend: end.toDate().toString()\n\t\t\t},\n\t\t\t//Its possible, that center for new limit is not same as current centerTime because rounding. New center time is usualy lower by one second.\n\t\t\t//this option lock modify select time on zoom when periodLimitOnCenter is set to true.\n\t\t\tlockCenter: periodLimitOnCenter,\n\t\t});\n\t}\n\n\n\trender() {\n\t\tconst {children} = this.props;\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tref={this.node}\n\t\t\t\tonMouseLeave={this.onMouseLeave}\n\t\t\t\tonWheel={this.onWheel}\n\t\t\t\tonMouseDown={this.onMouseDown}\n\t\t\t\tonMouseUp={this.onMouseUp}\n\t\t\t\tonMouseMove={this.onMouseMove}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t);\n\t}\n\n}\n\n\n\n/**\n * @see http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\nconst requestAnimFrame = (function(){\n\treturn window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(callback) {\n\t\twindow.setTimeout(callback, 1000 / 60);\n\t};\n  })();\n  \n\nexport default TimelineEventsWrapper;\n","import React from 'react';\n\nimport {Context as TimeLineContext} from './context';\n\nimport TimelineEventsWrapper from './TimelineEventsWrapper';\n\nimport './style.css';\n\nclass TimelineContent extends React.PureComponent {\n\tstatic contextType = TimeLineContext;\n\n\trender() {\n\t\tconst {periodLimit, height, width,dayWidth, period, mouseX, vertical, activeLevel} = this.context;\n\t\tconst {children} = this.props;\n\n\t\tconst elementWidth = vertical ? height : width;\n\t\tconst elementHeight = vertical ? width : height;\n\t\tconst transform = vertical ? `scale(-1,1) translate(-${height},0)` : '';\n\n\t\tconst childrenWithProps = [];\n\t\tif(children && children.length > 0) {\n\t\t\tchildren.forEach(child => {\n\t\t\t\tconst {children, ...propsWithoutChildren} = this.props;\n\t\n\t\t\t\tchildrenWithProps.push(React.cloneElement(child, {\n\t\t\t\t\t...propsWithoutChildren,\n\t\t\t\t\tperiod: period,\n\t\t\t\t\tperiodLimit: periodLimit,\n\t\t\t\t\tgetX: (dayWidth) => this.context.getX(dayWidth),\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width,\n\t\t\t\t\tdayWidth: dayWidth,\n\t\t\t\t\tvertical: vertical,\n\t\t\t\t\tmouseX: mouseX,\n\t\t\t\t\tactiveLevel: activeLevel,\n\t\t\t\t}))\n\t\t\t})\n\t\t}\n\n\t\treturn (\n\t\t\t\t<TimelineEventsWrapper>\n\t\t\t\t\t<div className=\"ptr-timeline-content\">\n\t\t\t\t\t\t<svg version={\"1.1\"}\n\t\t\t\t\t\t\txmlns={\"http://www.w3.org/2000/svg\"}\n\t\t\t\t\t\t\txmlnsXlink={\"http://www.w3.org/1999/xlink\"} \n     \t\t\t\t\t\twidth={elementWidth}\n\t\t\t\t\t\t\theight={elementHeight}>\n\t\t\t\t\t\t\t<g transform={transform}>\n\t\t\t\t\t\t\t\t{childrenWithProps}\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t</TimelineEventsWrapper>\n\t\t);\n\t}\n\n}\n\nexport default TimelineContent;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport {withResizeDetector} from 'react-resize-detector';\n\nimport {ContextProvider} from './context';\nimport TimelineContent from './timelineContent';\n\nconst CONTROLS_WIDTH = 0;\n\nexport const LEVELS = [\n\t{\n\t\tend: 1,\n\t\tlevel: 'year',\n\t},\n\t{\n\t\tend: 10,\n\t\tlevel: 'month',\n\t},\n\t{\n\t\tend: 250,\n\t\tlevel: 'day',\n\t},\n\t{\n\t\tend: 15000,\n\t\tlevel: 'hour',\n\t},\n\t{\n\t\tend: 70000,\n\t\tlevel: 'minute',\n\t}\n]\n\nconst DEFAULT_VERTICAL_HEIGHT = 70;\nconst DEFAULT_HORIZONTAL_HEIGHT = 45;\n\nclass Timeline extends React.PureComponent {\n\n\tstatic propTypes = {\n\t\tperiodLimit: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}).isRequired,\n\t\tperiod: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}),\n\t\tdayWidth: PropTypes.number,\n\t\tcenterTime: PropTypes.func,\n\t\tcontentHeight: PropTypes.number,\n\t\twidth: PropTypes.number,\n\t\theight: PropTypes.number,\n\t\t\n\t\tonHover: PropTypes.func,\n\t\tonClick: PropTypes.func,\n\n\t\tperiodLimitOnCenter: PropTypes.bool,\n\t\tvertical: PropTypes.bool,\n\t\t\n\t\tlevels: PropTypes.arrayOf(PropTypes.shape({\n\t\t\tend: PropTypes.number,\n\t\t\tlevel: PropTypes.string\n\t\t})),\t\t\t\t\t\t\t\t\t\t//ordered levels by higher level.end \n\t\tonChange: PropTypes.func,\n\t\tselectMode: PropTypes.bool,\t\t\t\t\t//whether change time while zoom \n\t};\n\n\tstatic defaultProps = {\n\t\tdayWidth: 1.5,\n\t\tlevels: LEVELS,\n\t\tonHover: () => {},\n\t\tonClick: () => {},\n\t\twidth: 100,\n\t\theight: 100,\n\t\tselectMode: false,\n\t}\n\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.updateContext = this.updateContext.bind(this);\n\t\tthis.getX = this.getX.bind(this);\n\t\tthis.getTime = this.getTime.bind(this);\n\t\tthis.getActiveLevel = this.getActiveLevel.bind(this);\n\n\n\t\tconst state = this.getStateUpdate({\n\t\t\tperiodLimit: props.periodLimit,\n\t\t\tperiod: props.period || props.periodLimit,\n\t\t\tcenterTime: props.time,\n\t\t})\n\n\t\tthis.state = state;\n\n\t\tif(typeof props.onChange === 'function') {\n\t\t\tprops.onChange(this.state)\n\t\t}\n\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tconst {dayWidth, time, width, height, periodLimit} = this.props;\n\t\t//if parent component set dayWidth\n\t\tif(prevProps.dayWidth !== dayWidth && this.state.dayWidth !== dayWidth) {\n\t\t\tthis.updateContext({dayWidth, centerTime: time})\n\t\t}\n\t\n\t\t//if parent component set time\n\t\tif(prevProps.time && time && (prevProps.time.toString() !== time.toString()) && (this.state.centerTime.toString() !== time.toString())) {\n\n\t\t\tconst period = this.getPeriodLimitByTime(time);\n\n\t\t\t//zoom to dayWidth\n\t\t\tthis.updateContext({period, centerTime: time})\n\t\t}\n\n\t\t//if parent component set time\n\t\tif((prevProps.width !== width) || (prevProps.height !== height)) {\n\t\t\t//přepočítat day width aby bylo v periodě\n\n\t\t\t//todo take time from state\n\t\t\t// const period = this.getPeriodLimitByTime(time);\n\t\t\tconst xAxis = this.getXAxisWidth();\n\t\t\tconst minPeriodDayWidth = this.getDayWidthForPeriod(periodLimit, xAxis);\n\t\t\tlet dayWidth = this.state.dayWidth;\n\t\t\tif(minPeriodDayWidth >= this.state.dayWidth) {\n\t\t\t\tdayWidth = minPeriodDayWidth;\n\t\t\t}\n\t\t\tconst period = this.getPeriodLimitByTime(this.state.centerTime, xAxis, periodLimit, dayWidth)\n\n\t\t\t//zoom to dayWidth\n\t\t\tthis.updateContext({period})\n\t\t}\n\t}\n\n\tgetPeriodLimitByTime(time, axesWidth = this.getXAxisWidth(), periodLimit = this.state.periodLimit, dayWidth = this.state.dayWidth) {\n\t\tconst allDays = axesWidth / dayWidth;\n\t\tlet setTime = moment(time);\n\n\t\t//check if setTime is in periodLimit\n\t\tif (setTime.isBefore(periodLimit.start)){\n\t\t\tsetTime = periodLimit.start\n\t\t}\n\n\t\tif (setTime.isAfter(periodLimit.end)){\n\t\t\tsetTime = periodLimit.end\n\t\t}\n\n\t\tconst halfDays = allDays / 2;\n\t\tconst start = moment(setTime).subtract(moment.duration(halfDays * (60 * 60 * 24 * 1000), 'ms')).toDate().toString();\n\t\tconst end = moment(setTime).add(moment.duration(halfDays * (60 * 60 * 24 * 1000), 'ms')).toDate().toString();\n\t\treturn {\n\t\t\tstart,\n\t\t\tend\n\t\t}\n\t}\n\n\tgetX(date) {\n\t\tdate = moment(date);\n\t\tlet diff = date.unix() - moment(this.state.period.start).unix();\n\t\tlet diffDays = diff / (60 * 60 * 24);\n\t\treturn diffDays * this.state.dayWidth;\n\t}\n\n\tgetTime(x, dayWidth = this.state.dayWidth, startTime = this.state.period.start) {\n\t\tlet diffDays = x / dayWidth;\n\t\tlet diff = diffDays * (60 * 60 * 24 * 1000);\n\t\treturn moment(startTime).add(moment.duration(diff, 'ms'));\n\t}\n\n\t//Find first level with smaller start level.\n\tgetActiveLevel(dayWidth) {\n\t\tconst {levels} = this.props;\n\t\treturn levels.find((l) => dayWidth <= l.end)\n\t}\n\n\n\tgetDayWidthForPeriod(periodLimit, axesWidth, maxDayWidth = this.getMaxDayWidth()) {\n\t\tconst start = moment(periodLimit.start);\n\t\tconst end = moment(periodLimit.end);\n\n\t\tconst diff = end.diff(start, 'ms');\n\t\tconst diffDays = diff / (60 * 60 * 24 * 1000);\n\n\t\tlet dayWidth = (axesWidth - CONTROLS_WIDTH) / diffDays;\n\t\tif(dayWidth > maxDayWidth) {\n\t\t\tdayWidth = maxDayWidth;\n\t\t}\n\n\t\treturn dayWidth;\n\t}\n\n\tgetPeriodLimitByDayWidth(dayWidth) {\n\t\tconst {centerTime} = this.state;\n\n\t\tconst allDays = this.getXAxisWidth() / dayWidth;\n\t\tconst halfMouseDays = allDays / 2;\n\n\t\tconst start = moment(centerTime).subtract(moment.duration(halfMouseDays * (60 * 60 * 24 * 1000), 'ms')).toDate().toString();\n\t\tconst end = moment(centerTime).add(moment.duration(halfMouseDays * (60 * 60 * 24 * 1000), 'ms')).toDate().toString();\n\t\treturn {\n\t\t\tstart,\n\t\t\tend\n\t\t}\n\t}\n\n\tupdateContext(options) {\n\t\tif (options) {\n\t\t\tconst stateUpdate = this.getStateUpdate(options);\n\t\t\tthis.setState(stateUpdate, () => {\n\t\t\t\tif(typeof this.props.onChange === 'function') {\n\t\t\t\t\tthis.props.onChange(this.state);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tgetStateUpdate(options) {\n\t\tconst {levels, periodLimit} = this.props;\n\n\t\tif (options) {\n\t\t\tconst updateContext = {};\n\t\t\tObject.assign(updateContext, {...options});\n\t\t\t\n\t\t\t//on change dayWidth calculate period\n\t\t\tif(options.dayWidth) {\n\t\t\t\tObject.assign(updateContext, {period: this.getPeriodLimitByDayWidth(options.dayWidth)})\n\t\t\t}\n\t\t\t\n\t\t\t//on change period calculate dayWidth\n\t\t\tif(options.period) {\n\t\t\t\tObject.assign(updateContext, {dayWidth: this.getDayWidthForPeriod(options.period, this.getXAxisWidth())})\n\t\t\t}\n\n\t\t\tif(updateContext.dayWidth) {\n\t\t\t\tObject.assign(updateContext, {activeLevel: this.getActiveLevel(updateContext.dayWidth, levels).level})\n\t\t\t}\n\n\t\t\tif(updateContext.dayWidth && !options.centerTime && !options.lockCenter) {\n\t\t\t\tObject.assign(updateContext, {centerTime: this.getTime(this.getXAxisWidth() / 2, updateContext.dayWidth, updateContext.period.start).toDate()})\n\t\t\t}\n\n\t\t\tif(options.centerTime && !updateContext.period) {\n\t\t\t\tObject.assign(updateContext, {period: this.getPeriodLimitByTime(options.centerTime, this.getXAxisWidth(), periodLimit, updateContext.dayWidth)})\n\t\t\t}\n\n\t\t\tif(updateContext.centerTime) {\n\t\t\t\tconst utcTime = new Date(updateContext.centerTime);\n\t\t\t\tutcTime.setTime( utcTime.getTime() - utcTime.getTimezoneOffset()*60*1000 )\n\t\t\t\tObject.assign(updateContext, {centerTimeUtc:utcTime.toUTCString()})\n\t\t\t}\n\t\t\treturn updateContext\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t}\n\n\tgetMaxDayWidth(levels = this.props.levels) {\n\t\tconst lastLevel = levels[levels.length - 1];\n\t\tconst maxDayWidth = lastLevel.end;\n\t\treturn maxDayWidth;\n\t}\n\n\tgetXAxisWidth() {\n\t\tconst {width, height, vertical} = this.props;\n\t\treturn vertical ? height : width;\n\t}\n\n\tgetContentHeight() {\n\t\tconst {contentHeight, vertical} = this.props;\n\t\treturn contentHeight || (vertical ? DEFAULT_VERTICAL_HEIGHT : DEFAULT_HORIZONTAL_HEIGHT);\n\t}\n\n\trender() {\n\t\tconst {levels, periodLimit, onHover, onClick, vertical, children, periodLimitOnCenter, selectMode} = this.props;\n\t\tconst {dayWidth, period, mouseX, moving} = this.state;\n\n\t\tconst maxDayWidth = this.getMaxDayWidth();\n\t\tconst activeDayWidth = dayWidth >= maxDayWidth ? maxDayWidth : dayWidth;\n\t\tconst activeLevel = this.getActiveLevel(activeDayWidth, levels).level;\n\t\tconst minDayWidth = this.getDayWidthForPeriod(periodLimit, this.getXAxisWidth())\n\t\treturn (\n\t\t\t<ContextProvider value={{\n\t\t\t\tupdateContext: this.updateContext,\n\t\t\t\twidth: this.getXAxisWidth(),\n\t\t\t\theight: this.getContentHeight(),\n\t\t\t\tgetX: this.getX,\n\t\t\t\tgetTime: this.getTime,\n\t\t\t\tcenterTime: this.state.centerTime,\n\t\t\t\tgetActiveLevel: this.getActiveLevel,\n\t\t\t\tdayWidth,\n\t\t\t\tmaxDayWidth,\n\t\t\t\tminDayWidth,\n\t\t\t\tperiodLimit,\n\t\t\t\tperiod,\n\t\t\t\tmouseX,\n\t\t\t\tactiveLevel,\n\t\t\t\tperiodLimitVisible: true,\n\t\t\t\tonClick,\n\t\t\t\tonHover,\n\t\t\t\tvertical,\n\t\t\t\tperiodLimitOnCenter,\n\t\t\t\tselectMode,\n\t\t\t\tmoving,\n\t\t\t\t}}>\n\t\t\t\t<TimelineContent>\n\t\t\t\t\t{children}\n\t\t\t\t</TimelineContent>\n\t\t\t</ContextProvider>\n\t\t);\n\n\t}\n\n}\n\nexport default withResizeDetector(Timeline);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\n\nimport TimeLineHover from '../TimeLine/TimeLineHover';\nimport HoverHandler from '../HoverHandler/HoverHandler';\nimport {getTootlipPosition} from \"../HoverHandler/position\";\nimport {isInside} from '../../utils/period';\n\nimport Picker from '../TimeLine/centerPicker';\nimport Mouse from '../TimeLine/mouse';\nimport Overlays from '../TimeLine/overlay';\nimport PeriodLimit from '../TimeLine/periodLimit';\n\nimport Years from '../TimeLine/years';\nimport Months from '../TimeLine/months';\nimport Days from '../TimeLine/days';\nimport Hours from '../TimeLine/hours';\nimport Minutes from '../TimeLine/minutes';\nimport Timeline from '../TimeLine';\n\nconst TOOLTIP_PADDING = 5;\nconst MOUSE_BUFFER_WIDTH = 5;\n\nconst LevelElement = (props) => {\n\tconst {activeLevel} = props;\n\tswitch (activeLevel) {\n\t\tcase 'year':\n\t\t\treturn React.createElement(Years, props);\n\t\tcase 'month':\n\t\t\treturn React.createElement(Months, props);\n\t\tcase 'day':\n\t\t\treturn React.createElement(Days, props);\n\t\tcase 'hour':\n\t\t\treturn React.createElement(Hours, props);\n\t\tcase 'minute':\n\t\t\treturn React.createElement(Minutes, props);\n\t\tdefault:\n\t\t\treturn React.createElement(Years, props);\n\t}\n}\n\nclass MapsTimeline extends React.PureComponent {\n\tconstructor (props) {\n\t\tsuper(props);\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.getHoverContent = this.getHoverContent.bind(this);\n\t\tthis.getTooltipStyle = this.getTooltipStyle.bind(this);\n\t}\n\n\tstatic propTypes = {\n\t\tperiod: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}).isRequired,\n\t\tinitialPeriod: PropTypes.shape({\n\t\t\tstart: PropTypes.string,\n\t\t\tend: PropTypes.string\n\t\t}).isRequired,\n\t\tdayWidth: PropTypes.number, //1.5\n\t\t// layers: , //for tooltip\n\t\tcontainerWidth: PropTypes.number,\n\t\tcontainerHeight: PropTypes.number,\n\t\tonChange: PropTypes.func,\n\t\tactiveLevel: PropTypes.string,\n\t\tonTimeClick: PropTypes.func,\n\t\tvertical: PropTypes.bool,\n\t};\n\n\tonClick(evt) {\n\t\tconst {onTimeClick, onClick} = this.props\n\t\tswitch (evt.type) {\n\t\t\tcase 'time':\n\t\t\t\tif(typeof onTimeClick === 'function') {\n\t\t\t\t\tonTimeClick(evt);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif(typeof onClick === 'function') {\n\t\t\t\t\tonClick(evt);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonTimelineChange(timelineState) {\n\t\tif(typeof this.props.onChange === 'function') {\n\t\t\tthis.props.onChange(timelineState);\n\t\t}\n\t}\n\n\tgetOverlaysContent(x, time) {\n\t\tconst {overlays} = this.props;\n\n\t\tconst content = []\n\t\tconst hoveredOverlays = overlays.filter(o => isInside(o, time));\n\t\tconst hoveredOverlaysContent = hoveredOverlays.map(o => {\n\t\t\treturn (<div className={'hover-overlay'} key={o.key}>\n\t\t\t\t\t\t<span className=\"dot\" style={{backgroundColor: o.backdroundColor}}></span>\n\t\t\t\t\t\t<span>{o.label}</span>\n\t\t\t\t\t</div>)\n\t\t})\n\n\t\tcontent.push(...hoveredOverlaysContent);\n\t\treturn content;\n\t}\n\n\tgetHoverContent(x, time) {\n\t\tconst overlaysContent = this.getOverlaysContent(x, time);\n\t\treturn (\n\t\t\t<div>\n\t\t\t\ttime: {` ${time.format(\"YYYY MM D H:mm:ss\")}`}\n\t\t\t\t{overlaysContent}\n\t\t\t</div>\n\t\t)\n\t}\n\n\tgetTooltipStyle() {\n\t\tconst referencePoint = 'center';\n\t\treturn () => {\n\t\t\tconst windowScrollTop = window.document.documentElement.scrollTop;\n\t\t\tconst windowScrollLeft = window.document.documentElement.scrollLeft;\n\t\t\tconst windowHeight = window.document.documentElement.clientHeight;\n\t\t\tconst windowWidth = window.document.documentElement.clientWidth;\n\t\t\tconst windowBBox = [windowScrollTop, windowScrollLeft + windowWidth, windowScrollTop + windowHeight, windowScrollLeft];\n\t\t\treturn getTootlipPosition(referencePoint, ['left', 'top', 'right', 'bottom'], windowBBox, TOOLTIP_PADDING)\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {activeLevel, time, overlays, LEVELS, containerWidth, containerHeight, dayWidth, period, initialPeriod, vertical} = this.props; // consume unneeded props (though we'll probably use them in the future)\n\n\t\treturn (\n\t\t\t<div className={'ptr-timeline-container'}>\n\t\t\t\t<HoverHandler getStyle={this.getTooltipStyle()}>\n\t\t\t\t\t<TimeLineHover getHoverContent={this.getHoverContent}>\n\t\t\t\t\t\t<Timeline \n\t\t\t\t\t\t\tdayWidth={dayWidth}\n\t\t\t\t\t\t\tperiodLimit={period}\n\t\t\t\t\t\t\tmouseBufferWidth= {MOUSE_BUFFER_WIDTH}\n\t\t\t\t\t\t\tselectedDate= {null}\n\t\t\t\t\t\t\tonChange= {(timelineState) => {this.onTimelineChange(timelineState)}}\n\t\t\t\t\t\t\tactiveLevel={activeLevel}\n\t\t\t\t\t\t\ttime={time}\n\t\t\t\t\t\t\tLEVELS={LEVELS}\n\t\t\t\t\t\t\tcontainerWidth={containerWidth}\n\t\t\t\t\t\t\tcontainerHeight={containerHeight}\n\t\t\t\t\t\t\tonClick= {this.onClick}\n\t\t\t\t\t\t\tvertical={vertical}\n\t\t\t\t\t\t\tperiod={initialPeriod}\n\t\t\t\t\t\t\tperiodLimitOnCenter={true}\n\t\t\t\t\t\t\tselectMode={false}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<PeriodLimit key=\"periodLimit\"/>\n\t\t\t\t\t\t\t<Overlays overlays={overlays} key=\"overlays\"/>\n\t\t\t\t\t\t\t<LevelElement key=\"levelElement\"/>\n\t\t\t\t\t\t\t<Picker key=\"picker\"/>\n\t\t\t\t\t\t\t<Mouse mouseBufferWidth={20} key=\"mouse\"/>\n\t\t\t\t\t\t</Timeline>\n\t\t\t\t\t</TimeLineHover>\n\t\t\t\t</HoverHandler>\t\t\t\t\n\t\t\t</div>\n\t\t)\n\t}\n\n}\n\nexport default MapsTimeline;\n","import React from 'react';\nimport Presentation from './presentation';\nimport select from '../../context/selectors/';\nimport {withContext} from '../../context/withContext';\nimport {convertToUTC} from '../../utils/date';\nimport {LEVELS} from '../TimeLine';\nimport moment from 'moment';\nimport {\n    setPreventReloadLayers,\n    updateComponent,\n    scrollToTime,\n    changeSelectTime,\n    stopFollowNow,\n    stopTimer,\n} from '../../context/actions';\n\n\nimport period from '../../utils/period'\nimport {getNowUTCString} from '../../utils/date'\n\nconst now = moment(getNowUTCString());\nconst start = now.clone().subtract(1, 'w');\nconst end = now.clone().add(1, 'w');\nconst initialTimelinePeriod = period(`${start.format('YYYY-MM-DD')}/${end.format('YYYY-MM-DD')}`);\nconst strInitialTimelinePeriod = {\n\tstart: initialTimelinePeriod.start.toDate().toUTCString(),\n\tend: initialTimelinePeriod.end.toDate().toUTCString(),\n}\n\n\nconst MapsTimeline = (props) => {\n    const {dispatch, state} = props;\n\n\tconst vertical = select.rootSelectors.getLandscape(state);\n\tconst periodLimit = select.rootSelectors.getPeriodLimit(state);\n\tconst timelineState = select.components.timeline.getSubstate(state);\n    const timelineOverlays = select.components.timeline.getOverlays(state);\n    const selectTime = select.rootSelectors.getSelectTime(state)\n    const time = selectTime ? convertToUTC(new Date(selectTime)) : null;\n\tconst onTimeChange = (timelineState) => {\n        const {state} = props;\n        const curTimelineState = select.components.timeline.getSubstate(state);\n        \n        if(timelineState.moving !== curTimelineState.moving) {\n            dispatch(updateComponent('timeline', {moving: timelineState.moving}))\n        }\n        \n        if(selectTime && timelineState.centerTimeUtc && timelineState.centerTimeUtc !== selectTime) {\n            dispatch(stopFollowNow());\n            dispatch(stopTimer());\n            dispatch(changeSelectTime(timelineState.centerTimeUtc, dispatch, selectTime, state));\n        }\n\n        if(timelineState.activeLevel && timelineState.activeLevel !== curTimelineState.activeTimeLevel) {\n            dispatch(updateComponent('timeline', {activeTimeLevel: timelineState.activeLevel}))\n        }\n\n        if(timelineState.mouseTime !== curTimelineState.mouseTime) {\n            dispatch(updateComponent('timeline', {mouseTime: timelineState.mouseTime ? timelineState.mouseTime.getTime() - timelineState.mouseTime.getTimezoneOffset()*60*1000 : null}))\n        }\n\n        if(timelineState.dayWidth && timelineState.dayWidth !== curTimelineState.dayWidth) {\n            dispatch(updateComponent('timeline', {dayWidth: timelineState.dayWidth}))\n        }\n\t}\n\n\tconst onTimeClick = (evt) => {\n        const {state} = props;\n        const periodLimit = select.rootSelectors.getPeriodLimit(state);\n        dispatch(stopFollowNow());\n        dispatch(stopTimer());\n\n        dispatch(setPreventReloadLayers(true));\n        scrollToTime(state, dispatch, new Date(select.rootSelectors.getSelectTime(state)), moment(evt.time.toDate().getTime() - evt.time.toDate().getTimezoneOffset()*60*1000), periodLimit, () => {\n            dispatch(setPreventReloadLayers(false));\n        });\n\t}\n\n    return (\n        <Presentation \n\t\t\tactiveLevel={timelineState.activeTimeLevel}\n\t\t\tvertical = {vertical}\n\t\t\tperiod = {periodLimit}\n\t\t\tinitialPeriod = {strInitialTimelinePeriod}\n\t\t\t// onLayerPeriodClick: this.onLayerPeriodClick,\n\t\t\tonChange = {onTimeChange}\n\t\t\ttime={time}\n\t\t\toverlays={timelineOverlays}\n\t\t\tLEVELS={LEVELS}\n\t\t\tdayWidth={timelineState.dayWidth}\n\t\t\tonTimeClick={onTimeClick}\n            />\n    )\n}\n\nexport default withContext(MapsTimeline);","import React from 'react';\nimport moment from 'moment';\nimport classnames from 'classnames';\nimport './style.css';\n\nclass TimeWidget extends React.PureComponent{\n    constructor(props) {\n        super(props);\n        this.state = {\n            timer: null,\n        }\n\n        this.tick = this.tick.bind(this);\n        this.stopTimer = this.stopTimer.bind(this);\n        this.startTimer = this.startTimer.bind(this);\n    }\n\n    tick() {\n        const {onSetTime, trackTimeActive, time} = this.props;\n        const selectTime = time ? moment(time).utc() : null;\n\n        if(trackTimeActive && selectTime && this.state.timer) {\n            onSetTime(selectTime.add(1, 'second').toDate().toUTCString());\n        }\n    }\n\n    stopTimer() {\n        const {onStopTimer,onStopFollowNow, nowActive} = this.props;\n        if(nowActive) {\n            onStopFollowNow();\n        }\n        if(this.state.timer) {\n            window.clearInterval(this.state.timer);\n            this.setState({timer: null});\n            onStopTimer();\n        }\n    }\n    startTimer() {\n        const {onStartTimer} = this.props;\n        if(this.state.timer) {\n            this.stopTimer();\n        }\n        const timer = window.setInterval(this.tick, 1000);\n        this.setState({timer});\n        onStartTimer();\n    }\n\n    render() {\n        const {time, mouseTime, nowActive, active, onSelectActive, onStartFollowNow, onStopFollowNow, trackTimeActive} = this.props;\n        const currentTime = time ? moment(time) : null;\n        const mouseTimeMom = mouseTime ? moment(mouseTime) : null;\n        const timeMom = mouseTimeMom || currentTime;\n        if(timeMom) {\n            timeMom.utc();\n        }\n        const classes = classnames('time-widget', {\n            'mouse-time': mouseTimeMom\n        })\n        return (\n            <div className={classes}>\n                {timeMom ?\n                <>\n                    <div onClick={() => (trackTimeActive || nowActive) ? this.stopTimer() : this.startTimer()} className={`now time-cell ${(trackTimeActive || nowActive) ? 'active' : '' }`}>\n                        Play\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n                    <div onClick={() => nowActive ? onStopFollowNow() : onStartFollowNow()} className={`now time-cell ${nowActive ? 'active' : '' }`}>\n                        NOW\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n                    <div className={`time-cell ${active === 'month' ? 'active' : '' }`} onClick={() => onSelectActive('month')}>\n                        <span className={'month'}>\n                            {timeMom.format('MMM')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n\n                    <div className={`time-cell ${active === 'day' ? 'active' : '' }`} onClick={() => onSelectActive('day')}>\n                        <span className={'day'}>\n                            {timeMom.format('DD')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n\n                    <div className={`time-cell ${active === 'year' ? 'active' : '' }`} onClick={() => onSelectActive('year')}>\n                        <span className={'year'}>\n                            {timeMom.format('YYYY')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>\n\n                    <div className={`time-cell ${active === 'hour' ? 'active' : '' }`} onClick={() => onSelectActive('hour')}>\n                        <span>\n                            {timeMom.format('HH')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>:\n\n                    <div className={`time-cell ${active === 'minute' ? 'active' : '' }`} onClick={() => onSelectActive('minute')}>\n                        <span>\n                            {timeMom.format('mm')}\n                        </span>\n                        <span className={'indicator'}>\n                        </span>\n                    </div>:\n\n                    <div>\n                        <span>\n                            {timeMom.format('ss')}\n                        </span>\n                    </div>\n                </> : null}\n            </div>\n        )\n    }\n}\n\nexport default TimeWidget;","import React from 'react';\nimport moment from 'moment';\nimport Presentation from './presentation';\nimport select from '../../context/selectors/';\nimport {withContext} from '../../context/withContext';\nimport {LEVELS} from '../TimeLine';\nimport {getNowUTCString} from '../../utils/date'\nimport {\n    setFollowNow,\n    scrollToTime,\n    zoomToTimeLevel,\n    changeSelectTime,\n    stopTimer,\n    startTimer,\n    stopFollowNow,\n} from '../../context/actions';\n\nconst TimeWidget = (props) => {\n    const {dispatch, state} = props;\n    const timelineState = select.components.timeline.getSubstate(state);\n\n    const onSetActiveTimeLevel = (level) => {\n        const {state} = props;\n        const timelineState = select.components.timeline.getSubstate(state);\n        const timeLevelDayWidth = LEVELS.find(l => l.level === level).end;\n        zoomToTimeLevel(dispatch, level, timeLevelDayWidth, timelineState.dayWidth);\n    }\n\n    const onSetTime = (time) => {\n        dispatch(changeSelectTime(time, dispatch, select.rootSelectors.getSelectTime(state), state));\n    }\n\n    const onStartFollowNow = () => {\n        const {state} = props;\n        const selectTime = select.rootSelectors.getSelectTime(state);\n        const periodLimit = select.rootSelectors.getPeriodLimit(state);\n        const scrollTime = selectTime ? moment(selectTime) : getNowUTCString();\n        dispatch(stopTimer());\n        dispatch(setFollowNow(true));\n        scrollToTime(state, dispatch, scrollTime, moment(getNowUTCString()), periodLimit, () => {\n            dispatch(setFollowNow(true));\n        });\n    }\n\n    const onStopFollowNow = () => {\n        dispatch(stopFollowNow());\n    }\n\n    const onStartTimer = () => {\n        dispatch(startTimer());\n    }\n\n    const onStopTimer = () => {\n        dispatch(stopTimer());\n    }    \n\n    return (\n        <Presentation \n            time={select.rootSelectors.getSelectTime(state)}\n            active={timelineState.activeTimeLevel}\n            onSelectActive={onSetActiveTimeLevel}\n            onSetTime={onSetTime}\n            onStartFollowNow={onStartFollowNow}\n            onStopFollowNow={onStopFollowNow}\n            onStartTimer={onStartTimer}\n            onStopTimer={onStopTimer}\n            nowActive={select.rootSelectors.getFollowNow(state)}\n            trackTimeActive={select.rootSelectors.getTrackTimeActive(state)}\n            mouseTime={timelineState.mouseTime}\n            />\n    )\n\n}\n\nexport default withContext(TimeWidget);","import React from 'react';\nimport ReactResizeDetector from 'react-resize-detector';\nimport className from 'classnames';\n\nimport {Context} from './context/context';\nimport {\n    startTrackNowTime,\n    setOrientation,\n    updateTleData,\n    updateApsData,\n    changeSelectTime,\n    setFollowNow,\n} from './context/actions';\nimport select from './context/selectors/';\nimport ProductsModal from './components/ProductsModal/';\nimport SearchModal from './components/SearchModal/';\nimport WorldWindMap from './components/WorldWindMap';\nimport SatelliteSelect from './components/SatelliteSelect';\nimport MapsTimeline from './components/MapsTimeline';\nimport TimeWidget from './components/TimeWidget/';\nimport {getNowUTCString} from './utils/date';\n\nclass App extends React.PureComponent {\n    static contextType = Context\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            height: 0\n        }\n\n        this.onResize = this.onResize.bind(this);\n    }\n\n    componentDidMount() {\n        const {state, dispatch} = this.context;\n        startTrackNowTime(state, dispatch);\n        const initTime = getNowUTCString();\n        changeSelectTime(initTime, dispatch, initTime)\n        //set Tle data\n        updateTleData(dispatch, initTime);\n        \n        //set Acquisition plans data\n        updateApsData(dispatch);\n\n        //Re-set follow now, because setting time in timeline set followNow to false.\n        setTimeout(() => {\n            dispatch(setFollowNow(true));\n        }, 500)\n    }\n\n    onResize(width, height) {\n        const {state, dispatch} = this.context;\n        let landscape = true;\n        if(window.innerHeight > window.innerWidth){\n            landscape = false;\n        }\n        \n        if (select.rootSelectors.getLandscape(state) !== landscape) {\n            dispatch(setOrientation(landscape));\n        }\n\n        this.setState({height});\n    }\n\n    getMaxSatelliteSelectHeight() {\n        const {state} = this.context;\n        const vertical = select.rootSelectors.getLandscape(state);\n        const windowHeight = this.state.height;\n        const timelineHeight = 45;\n        const timeWidgetHeight = 46;\n        const satelliteSelectHeight = 38;\n        const satelliteSelectMargin = 2*8;\n        const satelliteSelectTop = 8;\n        const maxSelectHeight = !vertical ?  (windowHeight - timelineHeight - timeWidgetHeight - satelliteSelectHeight - satelliteSelectMargin - satelliteSelectTop) : (windowHeight - satelliteSelectHeight - satelliteSelectMargin - satelliteSelectTop)\n        return maxSelectHeight;\n    }\n\n    render() {\n        const {state} = this.context;\n        const vertical = select.rootSelectors.getLandscape(state);\n        const maxSelectHeight = this.getMaxSatelliteSelectHeight();\n\n        return (\n            <div className={'app'}>\n                <ReactResizeDetector\n                    onResize = {this.onResize}\n                    handleWidth\n                    handleHeight />                \n                <ProductsModal />\n                <SearchModal />\n                <SatelliteSelect  \n                    maxHeight = {maxSelectHeight}\n                    />\n                <div className={className('timelineWrapper', {\n                    vertical: vertical,\n                    horizontal: !vertical,\n                })}>\n                    <MapsTimeline />\n                </div>\n                <div className={className('time-widget-wrapper', {\n                    vertical: vertical,\n                    horizontal: !vertical,\n                })}>\n                    <TimeWidget />\n                </div>\n                <WorldWindMap />\n            </div>\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import './worldwind/www-overrides/SurfaceShapeTileBuilder';\nimport './worldwind/www-overrides/SurfaceShapeTile';\nimport './worldwind/www-overrides/TiledImageLayer';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {ContextProvider} from './context/context';\nimport {forceSetPassiveEvents} from './utils/events';\n\nimport './styles/reset.css';\nimport './styles/index.scss';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\ndocument.getElementsByTagName('body')[0].classList.add('ptr-dark');\n\n//Fix for passive events\nforceSetPassiveEvents();\n\nReactDOM.render(\n    <ContextProvider>\n        <App/>\n    </ContextProvider>,\n    document.getElementById('root')\n);\n\nconst setPageHeight = () => {\n    window.setTimeout(() => {\n        let vh = window.innerHeight * 0.01;\n        document.documentElement.style.setProperty('--vh', `${vh}px`);\n    }, 50)\n}\n\n// We listen to the resize event\nwindow.addEventListener('resize', setPageHeight)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// \n// Chrome 73 breaks wheel events.\n// url: https://github.com/facebook/react/issues/14856\n// \nexport function forceSetPassiveEvents() {\n    const PASSIVE_EVENTS = ['touchstart', 'touchmove', 'touchend', 'touchcancel', 'wheel'];\n\n    const checkType = (type, options) => {\n        if (!PASSIVE_EVENTS.includes(type)) return null;\n    \n        const modOptions = {\n            boolean: {\n                capture: options,\n                passive: false,\n            },\n            object: {\n                ...options,\n                passive: false,\n            },\n        };\n    \n        return modOptions[typeof options];\n    };\n    \n    const addEventListener = document.addEventListener.bind();\n    document.addEventListener = (type, listener, options, wantsUntrusted) => (\n        addEventListener(type, listener, checkType(type, options) || options, wantsUntrusted)\n    );\n    \n    const removeEventListener = document.removeEventListener.bind();\n    document.removeEventListener = (type, listener, options) => (\n        removeEventListener(type, listener, checkType(type, options) || options)\n    );\n}"],"sourceRoot":""}